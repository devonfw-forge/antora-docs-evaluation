<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Devonfw.github.io Docs</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">Devonfw.github.io Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="cobigen" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">Cobigen</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../architecture-guidelines/1.0/index.html">Architecture-guidelines</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../architecture-guidelines/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../cicdgen/1.0/index.html">Cicdgen</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../cicdgen/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="index.html">Cobigen</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../dashboard/1.0/index.html">Dashboard</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../dashboard/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4j/1.0/index.html">Devon4j</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4j/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4net/1.0/index.html">Devon4net</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4net/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4ng/1.0/index.html">Devon4ng</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4ng/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4node/1.0/index.html">Devon4node</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4node/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4quarkus/1.0/index.html">Devon4quarkus</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4quarkus/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4ts/1.0/index.html">Devon4ts</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4ts/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devonfw.github.io/1.0/index.html">devonfw.github.io</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devonfw.github.io/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../getting-started/1.0/index.html">Getting-started</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../getting-started/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../github/1.0/index.html">Github</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../github/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../hangar/1.0/index.html">Hangar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hangar/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../ide/1.0/index.html">IDE</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../ide/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jump-the-queue/1.0/index.html">Jump-the-queue</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../jump-the-queue/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../mrchecker/1.0/index.html">Mrchecker</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../mrchecker/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../my-thai-star/1.0/index.html">My-thai-star</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../my-thai-star/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../production-line/1.0/index.html">Production-line</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../production-line/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../shop-floor/1.0/index.html">Shop-floor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../shop-floor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../solicitor/1.0/index.html">Solicitor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../solicitor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../sonar-devon4j-plugin/1.0/index.html">Sonar-devon4j-plugin</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../sonar-devon4j-plugin/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../devonfw.github.io/1.0/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/MarvDan/cobigen/edit/master/modules/ROOT/pages/master-cobigen.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="paragraph">
<p>==CobiGen&#8201;&#8212;&#8201;Code-based incremental Generator
:title-logo-image: images/logo/cobigen_logo.png</p>
</div>
<div class="sect1">
<h2 id="_document_description"><a class="anchor" href="#_document_description"></a>Document Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document contains the documentation of the CobiGen core module as well as all CobiGen plug-ins and the CobiGen eclipse integration.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>DISCLAIMER: All CobiGen plugins are compatible with the latest release of Devonfw unless otherwise denoted.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Current versions:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>CobiGen - Eclipse Plug-in v7.1.0</p>
</li>
<li>
<p>CobiGen - Maven Build Plug-in v7.1.0</p>
</li>
<li>
<p>CobiGen CLI v1.2.0</p>
</li>
</ul>
</div>
<hr>
<div class="ulist">
<ul>
<li>
<p>CobiGen v7.1.0</p>
</li>
<li>
<p>CobiGen - Java Plug-in v7.1.0</p>
</li>
<li>
<p>CobiGen - XML Plug-in v7.0.0</p>
</li>
<li>
<p>CobiGen - TypeScript Plug-in v7.1.0</p>
</li>
<li>
<p>CobiGen - Property Plug-in v7.1.0</p>
</li>
<li>
<p>CobiGen - Text Merger v7.1.1</p>
</li>
<li>
<p>CobiGen - JSON Plug-in v7.0.0</p>
</li>
<li>
<p>CobiGen - HTML Plug-in v7.0.0</p>
</li>
<li>
<p>CobiGen - Open API Plug-in v7.1.0</p>
</li>
<li>
<p>CobiGen - FreeMarker Template Engine v7.0.0</p>
</li>
<li>
<p>CobiGen - Velocity Template Engine v7.0.0</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Authors:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>* Malte Brunnlieb
* Jaime Diaz Gonzalez
* Steffen Holzer
* Ruben Diaz Martinez
* Joerg Hohwiller
* Fabian Kreis
* Lukas Goerlach
* Krati Shah
* Christian Richter
* Erik Grüner
* Mike Schumacher
* Marco Rose
* Mohamed Ghanmi</code></pre>
</div>
</div>
<div class="paragraph">
<p>==Guide to the Reader</p>
</div>
<div class="paragraph">
<p>Dependent on the intention you are reading this document, you might be most interested in the following chapters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If this is <strong>your first contact with CobiGen</strong>, you will be interested in the <a href="home.adoc">general purpose</a> of CobiGen, in the <a href="mgmt_license-agreement.adoc">licensing of CobiGen</a>, as well as in the <a href="mgmt_shared-service.adoc">Shared Service</a> provided for CobiGen. Additionally, there are some <a href="cobigen-usecases.adoc">general use cases</a>, which are currently implemented and maintained to be used out of the box.</p>
</li>
<li>
<p>As a <strong>user of the CobiGen Eclipse integration</strong>, you should focus on the <a href="cobigen-eclipse_installation">Installation</a> and <a href="cobigen-eclipse_usage">Usage</a> chapters to get a good introduction about how to use CobiGen in eclipse.</p>
</li>
<li>
<p>As a <strong>user of the Maven integration</strong>, you should focus on the <a href="cobigen-maven_configuration">Maven configuration</a> chapter, which guides you through the integration of CobiGen into your build configuration.</p>
</li>
<li>
<p>If you like to <strong>adapt the configuration of CobiGen</strong>, you have to step deeper into the <a href="cobigen-core_configuration.adoc">configuration guide</a> as well as into the plug-in configuration extensions for the <a href="cobigen-javaplugin.adoc">Java Plug-in</a>, <a href="cobigen-xmlplugin.adoc">XML-Plugin</a>, <a href="cobigen-propertyplugin.adoc">Java Property Plug-in</a>, as well as for the <a href="cobigen-textmerger.adoc">Text-Merger Plug-in</a>.</p>
</li>
<li>
<p>Finally, if you want to <strong>develop your own templates</strong>, you will be thankful for <a href="cobigen-templates_helpful-links.adoc">helpful links</a> in addition to the plug-ins documentation as referenced in the previous point.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/master-cobigen.adoc - include::Home.adoc[]</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==General use cases</p>
</div>
<div class="paragraph">
<p>In addition to the <a href="Home#selection-of-current-and-past-cobigen-applications">selection of CobiGen applications</a> introduced before, this chapter provides a more detailed overview about the currently implemented and maintained general use cases. These can be used by any project following a supported reference architecture as e.g. the <a href="https://github.com/devonfw">devonfw</a> or <a href="http://www.bva.bund.de/SharedDocs/Downloads/DE/BIT/RegisterFactory/Whitepaper_Register_Factory.html">Register Factory</a>.</p>
</div>
<div class="sect4">
<h5 id="_devon4j"><a class="anchor" href="#_devon4j"></a>devon4j</h5>
<div class="paragraph">
<p>With our templates for <a href="https://github.com/devonfw/devon4j">devon4j</a>, you can generate a whole CRUD application from a single Entity class. You save the effort for creating, DAOs, Transfer Objects, simple CRUD use cases with REST services and even the client application can be generated.</p>
</div>
<div class="sect5">
<h6 id="_crud_server_application_for_devon4j"><a class="anchor" href="#_crud_server_application_for_devon4j"></a>CRUD server application for devon4j</h6>
<div class="paragraph">
<p>For the server, the required files for all architectural layers (Data access, logic, and service layer) can be created based on your Entity class. After the generation, you have CRUD functionality for the entity from bottom to top which can be accessed via a RESTful web service. Details are provided in the <a href="https://github.com/devonfw/devon/wiki/tutorial-devon-generator">devonfw wiki</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_crud_client_application_for_devon4ng"><a class="anchor" href="#_crud_client_application_for_devon4ng"></a>CRUD client application for devon4ng</h6>
<div class="paragraph">
<p>Based on the REST services on the server, you can also generate an <a href="https://angularjs.org/">Angular</a> client based on <a href="https://github.com/devonfw/devon4ng">devon4ng</a>. With the help of <a href="https://nodejs.org/">Node.js</a>, you have a working client application for displaying your entities within minutes!</p>
</div>
</div>
<div class="sect5">
<h6 id="_test_data_builder_for_devon4j"><a class="anchor" href="#_test_data_builder_for_devon4j"></a>Test data Builder for devon4j</h6>
<div class="paragraph">
<p>Generating a builder pattern for POJOs to easily create test data in your tests. CobiGen is not only able to generate a plain builder pattern but rather builder, which follow a specific concept to minimize test data generation efforts in your unit tests. The following <code>Person</code> class as an example:</p>
</div>
<div class="listingblock">
<div class="title">Person class</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Person {

    private String firstname;
    private String lastname;
    private int birthyear;
    @NotNull
    private Address address;

    @NotNull
    public String getFirstname() {
        return this.firstname;
    }

    // additional default setter and getter
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is a simple POJO with a validation annotation, to indicate, that <code>firstname</code> should never be <code>null</code>. Creating this object in a test would imply to call every setter, which is kind of nasty. Therefore, the Builder Pattern has been introduced for quite a long time in software engineering, allowing to easily create POJOs with a fluent API. See below.</p>
</div>
<div class="listingblock">
<div class="title">Builder pattern example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Person person = new PersonBuilder()
                .firstname("Heinz")
                .lastname("Erhardt")
                .birthyear(1909)
                .address(
                    new AddressBuilder().postcode("22222")
                        .city("Hamburg").street("Luebecker Str. 123")
                        .createNew())
                .addChild(
                    new PersonBuilder()[...].createNew()).createNew();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Builder API generated by CobiGen allows you to set any setter accessible field of a POJO in a fluent way. But in addition lets assume a test, which should check the birth year as precondition for any business operation. So specifying all other fields of <code>Person</code>, especially <code>firstname</code> as it is mandatory to enter business code, would not make sense. The test behavior should just depend on the specification of the birth year and on no other data. So we would like to just provide this data to the test.</p>
</div>
<div class="paragraph">
<p>The Builder classes generated by CobiGen try to tackle this inconvenience by providing the ability to declare default values for any mandatory field due to validation or database constraints.</p>
</div>
<div class="listingblock">
<div class="title">Builder Outline</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class PersonBuilder {

    private void fillMandatoryFields() {
        firstname("lasdjfaöskdlfja");
        address(new AddressBuilder().createNew());
    };
    private void fillMandatoryFields_custom() {...};

    public PersonBuilder firstname(String value);
    public PersonBuilder lastname(String value);
    ...

    public Person createNew();
    public Person persist(EntityManager em);
    public List&lt;Person&gt; persistAndDuplicate(EntityManager em, int count);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Looking at the plotted builder API generated by CobiGen, you will find two <code>private</code> methods. The method <code>fillMandatoryFields</code> will be generated by CobiGen and regenerated every time CobiGen generation will be triggered for the <code>Person</code> class. This method will set every automatically detected field with not <code>null</code> constraints to a default value. However, by implementing <code>fillMandatoryFields_custom</code> on your own, you can reset these values or even specify more default values for any other field of the object. Thus, running <code>new PersonBuilder().birthyear(1909).createNew();</code> will create a valid object of <code>Person</code>, which is already pre-filled such that it does not influence the test execution besides the fact that it circumvents database and validation issues.</p>
</div>
<div class="paragraph">
<p>This even holds for complex data structures as indicated by <code>address(new AddressBuilder().createNew());</code>. Due to the use of the <code>AddressBuilder</code> for setting the default value for the field <code>address</code>, also the default values for <code>Address</code> will be set automatically.</p>
</div>
<div class="paragraph">
<p>Finally, the builder API provides different methods to create new objects.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>createNew()</code> just creates a new object from the builder specification and returns it.</p>
</li>
<li>
<p><code>persist(EntityManager)</code> will create a new object from the builder specification and persists it to the database.</p>
</li>
<li>
<p><code>persistAndDuplicate(EntityManager, int)</code> will create the given amount of objects form the builder specification and persists all of these. After the initial generation of each builder, you might want to adapt the method body as you will most probably not be able to persist more than one object with the same field assignments to the database due to <code>unique</code> constraints. Thus, please see the generated comment in the method to adapt <code>unique</code> fields accordingly before persisting to the database.</p>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="_custom_builder_for_business_needs"><a class="anchor" href="#_custom_builder_for_business_needs"></a>Custom Builder for Business Needs</h7>
<div class="paragraph">
<p>CobiGen just generates basic builder for any POJO. However, for project needs you probably would like to have even more complex builders, which enable the easy generation of more complex test data which are encoded in a large object hierarchy. Therefore, the generated builders can just be seen as a tool to achieve this. You can define your own business driven builders in the same way as the generated builders, but explicitly focusing on your business needs. Just take this example as a demonstration of that idea:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  University uni = new ComplexUniversityBuilder()
    .withStudents(200)
    .withProfessors(4)
    .withExternalStudent()
    .createNew();</code></pre>
</div>
</div>
<div class="paragraph">
<p>E.g. the method <code>withExternalStudent()</code> might create a person, which is a student and is flagged to be an external student. Basing this implementation on the generated builders will even assure that you would benefit from any default values you have set before. In addition, you can even imagine any more complex builder methods setting values driven your reusable testing needs based on the specific business knowledge.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_register_factory"><a class="anchor" href="#_register_factory"></a>Register Factory</h5>
<div class="sect5">
<h6 id="_crud_server_application"><a class="anchor" href="#_crud_server_application"></a>CRUD server application</h6>
<div class="paragraph">
<p>Generates a CRUD application with persistence entities as inputs. This includes DAOs, TOs, use cases, as well as a CRUD JSF user interface if needed.</p>
</div>
</div>
<div class="sect5">
<h6 id="_test_data_builder"><a class="anchor" href="#_test_data_builder"></a>Test data Builder</h6>
<div class="paragraph">
<p>Analogous to <a href="#testdata-builder-for-devon4j">Test data Builder for devon4J</a></p>
</div>
</div>
<div class="sect5">
<h6 id="_test_documentation"><a class="anchor" href="#_test_documentation"></a>Test documentation</h6>
<div class="paragraph">
<p>Generate test documentation from test classes. The input are the doclet tags of several test classes, which e.g. can specify a description, a cross-reference, or a test target description. The result currently is a csv file, which lists all tests with the corresponding meta-information. Afterwards, this file might be styled and passed to the customer if needed and it will be up-to-date every time!</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cobigen"><a class="anchor" href="#_cobigen"></a>CobiGen</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="paragraph">
<p>==Configuration</p>
</div>
<div class="paragraph">
<p>CobiGen is maintaining a home directory further referenced in this documentation as <code>$cghome</code>, which is used to maintain temporary or transient data. The home folder is determined with the following location fall-back:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>System environment variable <code>COBIGEN_HOME</code> (e.g. <code>C:\project\ide\conf\cobigen-home</code>)</p>
</li>
<li>
<p><code>.cobigen</code> directory in OS user home (e.g. <code>~/.cobigen</code>)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The actual configuration of CobiGen is maintained by a single folder or jar. The location can be configured with respect to the implemented configuration fall-back mechanism. CobiGen will search for the location of the configuration in the following order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A configuration jar or directory, which is passed to CobiGen by the Maven or Eclipse integration or any other program using the CobiGen programming interface:
1.1. the Maven integration allows to configure a jar dependency to be included in the currently running classpath <em>(of interest for <a href="cobigen-maven_configuration#plugin-injection-since-v3.adoc">maven configuration</a></em>
1.2. the Eclipse integration allows to specify a <code>CobiGen_Templates</code> project in the eclipse workspace</p>
</li>
<li>
<p>The file <code>$cghome/.cobigen</code> exists and the property <code>templates</code> is set to a valid configuration (e.g. <code>templates=C:\project\ide\conf\templates</code> or <code>templates=C:\project\ide\conf\templates.jar</code>) <em>Hint: Check for log entry like <code>Value of property templates in $cghome/.cobigen is invalid</code> to identify an invalid configuration which is not taken up as expected</em></p>
</li>
<li>
<p>The folder <code>$cghome/templates/CobiGen_Templates</code> exists</p>
</li>
<li>
<p>The lexicographical sorted first configuration jar of the following path pattern <code>$cghome/templates/templates-([^-]+)-(\\d+\\.?)+.jar</code> if exists (e.g. <code>templates-devon4j-2020.04.001</code>)</p>
</li>
<li>
<p>CobiGen will automatically download the latest jar configuration from maven central with <code>groupId</code> <code>com.devonfw.cobigen</code> and <code>artifactId</code> <code>templates-devon4j</code> and take it like described in 4.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Within the configuration jar or directory you will find the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>CobiGen_Templates
 |- templateFolder1
    |- templates.xml
 |- templateFolder2
    |- templates.xml
 |- context.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Find some examples <a href="https://github.com/devonfw/cobigen/tree/master/cobigen-templates">here</a>.</p>
</div>
<div class="sect4">
<h5 id="_context_configuration"><a class="anchor" href="#_context_configuration"></a>Context Configuration</h5>
<div class="paragraph">
<p>The context configuration (<code>context.xml</code>) always has the following root structure:</p>
</div>
<div class="listingblock">
<div class="title">Context Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;contextConfiguration xmlns="http://capgemini.com"
                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                      version="1.0"&gt;
    &lt;triggers&gt;
        ...
    &lt;/triggers&gt;
&lt;/contextConfiguration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The context configuration has a <code>version</code> attribute, which should match the XSD version the context configuration is an instance of. It should not state the version of the currently released version of CobiGen. This attribute should be maintained by the context configuration developers. If configured correctly, it will provide a better feedback for the user and thus higher user experience. Currently there is only the version v1.0. For further version there will be a changelog later on.</p>
</div>
<div class="sect5">
<h6 id="_trigger_node"><a class="anchor" href="#_trigger_node"></a>Trigger Node</h6>
<div class="paragraph">
<p>As children of the <code>&lt;triggers&gt;</code> node you can define different triggers. By defining a <code>&lt;trigger&gt;</code> you declare a mapping between special inputs and a <code>templateFolder</code>, which contains all templates, which are worth to be generated with the given input.</p>
</div>
<div class="listingblock">
<div class="title">trigger configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="..." templateFolder="..." inputCharset="UTF-8" &gt;
    ...
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The attribute <code>id</code> should be unique within an context configuration. It is necessary for efficient internal processing.</p>
</li>
<li>
<p>The attribute <code>type</code> declares a specific <em>trigger interpreter</em>, which might be provided by additional plug-ins. A <em>trigger interpreter</em> has to provide an <em>input reader</em>, which reads specific inputs and creates a template object model out of it to be processed by the FreeMarker template engine later on. Have a look at the plug-in&#8217;s documentation of your interest and see, which trigger types and thus inputs are currently supported.</p>
</li>
<li>
<p>The attribute <code>templateFolder</code> declares the relative path to the template folder, which will be used if the trigger gets activated.</p>
</li>
<li>
<p>The attribute <code>inputCharset</code> <em>(optional)</em> determines the charset to be used for reading any input file.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_matcher_node"><a class="anchor" href="#_matcher_node"></a>Matcher Node</h6>
<div class="paragraph">
<p>A trigger will be activated if its matchers hold the following formula:</p>
</div>
<div class="paragraph">
<p><code>!(NOT || &#8230;&#8203; || NOT) &amp;&amp; AND &amp;&amp; &#8230;&#8203; &amp;&amp; AND &amp;&amp; (OR || &#8230;&#8203; || OR)</code></p>
</div>
<div class="paragraph">
<p>Whereas NOT/AND/OR describes the <code>accumulationType</code> of a <em>matcher</em> (see below) and e.g. <code>NOT</code> means 'a <em>matcher</em> with <code>accumulationType</code> NOT matches a given input'. Thus additionally to an <em>input reader</em>, a <em>trigger interpreter</em> has to define at least one set of <em>matchers</em>, which are satisfiable, to be fully functional. A <code>&lt;matcher&gt;</code> node declares a specific characteristics a valid input should have.</p>
</div>
<div class="listingblock">
<div class="title">Matcher Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;matcher type="..." value="..." accumulationType="..."&gt;
    ...
&lt;/matcher&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The attribute <code>type</code> declares a specific type of <em>matcher</em>, which has to be provided by the surrounding <em>trigger interpreter</em>. Have a look at the plug-in&#8217;s documentation, which also provides the used trigger type for more information about valid matcher and their functionalities.</p>
</li>
<li>
<p>The attribute <code>value</code> might contain any information necessary for processing the <em>matcher&#8217;s</em> functionality. Have a look at the relevant plug-in&#8217;s documentation for more detail.</p>
</li>
<li>
<p>The attribute <code>accumulationType</code> <em>(optional)</em> specifies how the matcher will influence the trigger activation. Valid values are:</p>
<div class="ulist">
<ul>
<li>
<p>OR (default): if any matcher of accumulation type OR <em>matches</em>, the trigger will be activated as long as there are no further matchers with different accumulation types</p>
</li>
<li>
<p>AND: if any matcher with AND accumulation type does <em>not match</em>, the trigger will <em>not</em> be activated</p>
</li>
<li>
<p>NOT: if any matcher with NOT accumulation type <em>matches</em>, the trigger will <em>not</em> be activated</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_variable_assignment_node"><a class="anchor" href="#_variable_assignment_node"></a>Variable Assignment Node</h6>
<div class="paragraph">
<p>Finally, a <code>&lt;matcher&gt;</code> node can have multiple <code>&lt;variableAssignment&gt;</code> nodes as children. <em>Variable assignments</em> allow to parametrize the generation by additional values, which will be added to the object model for template processing. The variables declared using <em>variable assignments</em>, will be made accessible in the templates.xml as well in the object model for template processing via the namespace <code>variables.*</code>.</p>
</div>
<div class="listingblock">
<div class="title">Complete Configuration Pattern</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;contextConfiguration xmlns="http://capgemini.com"
                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                      version="1.0"&gt;
    &lt;triggers&gt;
        &lt;trigger id="..." type="..." templateFolder="..."&gt;
            &lt;matcher type="..." value="..."&gt;
                &lt;variableAssignment type="..." key="..." value="..." /&gt;
            &lt;/matcher&gt;
        &lt;/trigger&gt;
    &lt;/triggers&gt;
&lt;/contextConfiguration&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The attribute <code>type</code> declares the type of <em>variable assignment</em> to be processed by the <em>trigger interpreter</em> providing plug-in. This attribute enables <em>variable assignments</em> with different dynamic value resolutions.</p>
</li>
<li>
<p>The attribute <code>key</code> declares the namespace under which the resolved value will be accessible later on.</p>
</li>
<li>
<p>The attribute <code>value</code> might declare a constant value to be assigned or any hint for value resolution done by the <em>trigger interpreter</em> providing plug-in. For instance, if <code>type</code> is <code>regex</code>, then on <code>value</code> you will assign the matched group number by the regex (1, 2, 3&#8230;&#8203;)</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_container_matcher_node"><a class="anchor" href="#_container_matcher_node"></a>Container Matcher Node</h6>
<div class="paragraph">
<p>The <code>&lt;containerMatcher&gt;</code> node is an additional matcher for matching containers of multiple input objects.
Such a container might be a package, which encloses multiple types or---more generic---a model, which encloses multiple elements. A container matcher can be declared side by side with other matchers:</p>
</div>
<div class="listingblock">
<div class="title"><code>ContainerMatcher</code> Declaration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;contextConfiguration xmlns="http://capgemini.com"
                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                      version="1.0"&gt;
    &lt;triggers&gt;
        &lt;trigger id="..." type="..." templateFolder="..." &gt;
            &lt;containerMatcher type="..." value="..." retrieveObjectsRecursively="..." /&gt;
            &lt;matcher type="..." value="..."&gt;
                &lt;variableAssignment type="..." variable="..." value="..." /&gt;
            &lt;/matcher&gt;
        &lt;/trigger&gt;
    &lt;/triggers&gt;
&lt;/contextConfiguration&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The attribute <code>type</code> declares a specific type of <em>matcher</em>, which has to be provided by the surrounding <em>trigger interpreter</em>. Have a look at the plug-in&#8217;s documentation, which also provides the used trigger type for more information about valid matcher and their functionalities.</p>
</li>
<li>
<p>The attribute <code>value</code> might contain any information necessary for processing the <em>matcher&#8217;s</em> functionality. Have a look at the relevant plug-in&#8217;s documentation for more detail.</p>
</li>
<li>
<p>The attribute <code>retrieveObjectsRecursively</code> <em>(optional boolean)</em> states, whether the children of the input should be retrieved recursively to find matching inputs for generation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The semantics of a container matchers are the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>&lt;containerMatcher&gt;</code> does not declare any <code>&lt;variableAssignment&gt;</code> nodes</p>
</li>
<li>
<p>A <code>&lt;containerMatcher&gt;</code> matches an input if and only if one of its enclosed elements satisfies a set of <code>&lt;matcher&gt;</code> nodes of the same <code>&lt;trigger&gt;</code></p>
</li>
<li>
<p>Inputs, which match a <code>&lt;containerMatcher&gt;</code> will cause a generation for each enclosed element</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_templates_configuration"><a class="anchor" href="#_templates_configuration"></a>Templates Configuration</h5>
<div class="paragraph">
<p>The template configuration (<code>templates.xml</code>) specifies, which templates exist and under which circumstances it will be generated. There are two possible configuration styles:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure the template meta-data for each template file by <a href="#template-node">template nodes</a></p>
</li>
<li>
<p><code><em>(since cobigen-core-v1.2.0)</em></code>: Configure <code><a href="#templatescan-node">templateScan nodes</a></code> to automatically retrieve a default configuration for all files within a configured folder and possibly modify the automatically configured templates using <a href="#templateextension-node"><code>templateExtension</code> nodes</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To get an intuition of the idea, the following will initially describe the first (more extensive) configuration style. Such an configuration root structure looks as follows:</p>
</div>
<div class="listingblock">
<div class="title">Extensive Templates Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;templatesConfiguration xmlns="http://capgemini.com"
                        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                        version="1.0" templateEngine="FreeMarker"&gt;
    &lt;templates&gt;
            ...
    &lt;/templates&gt;
    &lt;increments&gt;
            ...
    &lt;/increments&gt;
&lt;/templatesConfiguration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The root node <code>&lt;templatesConfiguration&gt;</code> specifies two attributes. The attribute <code>version</code> provides further usability support and will be handled analogous to the <code>version</code> attribute of the <a href="#context-configuration">context configuration</a>. The optional attribute <code>templateEngine</code> specifies the template engine to be used for processing the templates (<em>since `cobigen-core-4.0.0`</em>). By default it is set to FreeMarker.</p>
</div>
<div class="paragraph">
<p>The node <code>&lt;templatesConfiguration&gt;</code> allows two different grouping nodes as children. First, there is the <code>&lt;templates&gt;</code> node, which groups all declarations of templates. Second, there is the <code>&lt;increments&gt;</code> node, which groups all declarations about increments.</p>
</div>
<div class="sect5">
<h6 id="_template_node"><a class="anchor" href="#_template_node"></a>Template Node</h6>
<div class="paragraph">
<p>The <code>&lt;templates&gt;</code> node groups multiple <code>&lt;template&gt;</code> declarations, which enables further generation. Each template file should be registered at least once as a template to be considered.</p>
</div>
<div class="listingblock">
<div class="title">Example Template Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;templates&gt;
    &lt;template name="..." destinationPath="..." templateFile="..." mergeStrategy="..." targetCharset="..." /&gt;
    ...
&lt;/templates&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>A template declaration consist of multiple information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The attribute <code>name</code> specifies an unique ID within the templates configuration, which will later be reused in the <a href="#increment-node">increment definitions</a>.</p>
</li>
<li>
<p>The attribute <code>destinationPath</code> specifies the destination path the template will be generated to. It is possible to use all variables defined by <a href="#variableassignment-node">variable assignments</a> within the path declaration using the FreeMarker syntax <code>${variables.*}</code>. While resolving the variable expressions, each dot within the value will be automatically replaced by a slash. This behavior is accounted for by the transformations of Java packages to paths as CobiGen has first been developed in the context of the Java world. Furthermore, the destination path variable resolution provides the following additional built-in operators analogue to the FreeMarker syntax:</p>
<div class="ulist">
<ul>
<li>
<p><code>?cap_first</code> analogue to <a href="http://freemarker.org/docs/ref_builtins_string.html#ref_builtin_cap_first">FreeMarker</a></p>
</li>
<li>
<p><code>?uncap_first</code> analogue to <a href="http://freemarker.org/docs/ref_builtins_string.html#ref_builtin_uncap_first">FreeMarker</a></p>
</li>
<li>
<p><code>?lower_case</code> analogue to <a href="http://freemarker.org/docs/ref_builtins_string.html#ref_builtin_lower_case">FreeMarker</a></p>
</li>
<li>
<p><code>?upper_case</code> analogue to <a href="http://freemarker.org/docs/ref_builtins_string.html#ref_builtin_upper_case">FreeMarker</a></p>
</li>
<li>
<p><code>?replace(regex, replacement)</code> - Replaces all occurrences of the regular expression <code>regex</code> in the variable&#8217;s value with the given <code>replacement</code> string. (since <code>cobigen-core v1.1.0</code>)</p>
</li>
<li>
<p><code>?removeSuffix(suffix)</code> - Removes the given <code>suffix</code> in the variable&#8217;s value iff the variable&#8217;s value ends with the given <code>suffix</code>. Otherwise nothing will happen. (since <code>cobigen-core v1.1.0</code>)</p>
</li>
<li>
<p><code>?removePrefix(prefix)</code> - Analogue to <code>?removeSuffix</code> but removes the prefix of the variable&#8217;s value. (since <code>cobigen-core v1.1.0</code>)</p>
</li>
</ul>
</div>
</li>
<li>
<p>The attribute <code>templateFile</code> describes the relative path dependent on the template folder specified in the <a href="#trigger-node">trigger</a> to the template file to be generated.</p>
</li>
<li>
<p>The attribute <code>mergeStrategy</code> <em>(optional)</em> can be <em>optionally</em> specified and declares the type of merge mechanism to be used, when the <code>destinationPath</code> points to an already existing file. CobiGen by itself just comes with a <code>mergeStrategy</code> <code>override</code>, which enforces file regeneration in total. Additional available merge strategies have to be obtained from the different plug-in&#8217;s documentations (see here for <a href="cobigen-javaplugin#merger-extensions.adoc">java</a>, <a href="cobigen-xmlplugin#merger-extensions.adoc">XML</a>, <a href="cobigen-propertyplugin#merger-extensions.adoc">properties</a>, and <a href="cobigen-textmerger#merger-extensions.adoc">text</a>). Default: <em>not set</em> (means not mergeable)</p>
</li>
<li>
<p>The attribute <code>targetCharset</code> <em>(optional)</em> can be <em>optionally</em> specified and declares the encoding with which the contents will be written into the destination file. This also includes reading an existing file at the destination path for merging its contents with the newly generated ones. Default: <em>UTF-8</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>(Since version 4.1.0)</em> It is possible to reference external <code>template</code> (templates defined on another trigger), thanks to using <code>&lt;incrementRef &#8230;&#8203;&gt;</code> that are explained <a href="#increment-node">here</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_template_scan_node"><a class="anchor" href="#_template_scan_node"></a>Template Scan Node</h6>
<div class="paragraph">
<p><em>(since <code>cobigen-core-v1.2.0</code>)</em></p>
</div>
<div class="paragraph">
<p>The second configuration style for template meta-data is driven by initially scanning all available templates and automatically configure them with a default set of meta-data. A scanning configuration might look like this:</p>
</div>
<div class="listingblock">
<div class="title">Example of Template-scan configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;templatesConfiguration xmlns="http://capgemini.com"
                        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                        version="1.2"&gt;
    &lt;templateScans&gt;
        &lt;templateScan templatePath="templates" templateNamePrefix="prefix_" destinationPath="src/main/java"/&gt;
    &lt;/templateScans&gt;
&lt;/templatesConfiguration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can specify multiple <code>&lt;templateScan &#8230;&#8203;&gt;</code> nodes for different <code>templatePaths</code> and different <code>templateNamePrefixes</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>name</code> can be specified to later on reference the templates found by a template-scan within an <a href="#increment-node">increment</a>. <em>(since <code>cobigen-core-v2.1.</code>)</em></p>
</li>
<li>
<p>The <code>templatePath</code> specifies the relative path from the <code>templates.xml</code> to the root folder from which the template scan should be performed.</p>
</li>
<li>
<p>The <code>templateNamePrefix</code> <em>(optional)</em> defines a common id prefix, which will be added to all found and automatically configured templates.</p>
</li>
<li>
<p>The <code>destinationPath</code> defines the root folder all found templates should be generated to, whereas the root folder will be a prefix for all found and automatically configured templates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <code>templateScan</code> will result in the following <strong>default configuration of templates</strong>. For each file found, new <a href="#template-node">template</a> will be created virtually with the following default values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>id</code>: file name without <code>.ftl</code> extension prefixed by <code>templateNamePrefix</code> from <code>template-scan</code></p>
</li>
<li>
<p><code>destinationPath</code>: relative file path of the file found with the prefix defined by <code>destinationPath</code> from <code>template-scan</code>. Furthermore,</p>
<div class="ulist">
<ul>
<li>
<p>it is possible to use the syntax for accessing and modifying variables as described for the attribute <code>destinationPath</code> of the <a href="#template-node">template node</a>, besides the only difference, that due to file system restrictions you have to replace all <code>?</code>-signs (for built-ins) with <code>#</code>-signs.</p>
</li>
<li>
<p>the files to be scanned, should provide their final file extension by the following file naming convention: <code>&lt;filename&gt;.&lt;extension&gt;.ftl</code> Thus the file extension <code>.ftl</code> will be removed after generation.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>templateFile</code>: relative path to the file found</p>
</li>
<li>
<p><code>mergeStrategy</code>: <em>(optional)</em> not set means not mergeable</p>
</li>
<li>
<p><code>targetCharset</code>:  <em>(optional)</em> defaults to UTF-8</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>(Since version 4.1.0)</em> It is possible to reference external <code>templateScan</code> (<code>templateScans</code> defined on another trigger), thanks to using <code>&lt;incrementRef &#8230;&#8203;&gt;</code> that are explained <a href="#increment-node">here</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_template_extension_node"><a class="anchor" href="#_template_extension_node"></a>Template Extension Node</h6>
<div class="paragraph">
<p><em>(since <code>cobigen-core-v1.2.0</code>)</em></p>
</div>
<div class="paragraph">
<p>Additionally to the <code><a href="#templatescan-node">templateScan declaration</a></code> it is easily possible to rewrite specific attributes for any scanned and automatically configured template.</p>
</div>
<div class="listingblock">
<div class="title">Example Configuration of a <code>TemplateExtension</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;templates&gt;
    &lt;templateExtension ref="prefix_FooClass.java" mergeStrategy="javamerge" /&gt;
&lt;/templates&gt;

&lt;templateScans&gt;
    &lt;templateScan templatePath="foo" templateNamePrefix="prefix_" destinationPath="src/main/java/foo"/&gt;
&lt;/templateScans&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Lets assume, that the above example declares a <code>template-scan</code> for the folder <code>foo</code>, which contains a file <code>FooClass.java.ftl</code> in any folder depth. Thus the template scan will automatically create a virtual <a href="#template-node">template</a> declaration with <code>id=prefix_FooClass.java</code> and further <code><a href="#templatescan-node">default configuration</a></code>.</p>
</div>
<div class="paragraph">
<p>Using the <code>templateExtension</code> declaration above will reference the scanned template by the attribute <code>ref</code> and overrides the <code>mergeStrategy</code> of the automatically configured template by the value <code>javamerge</code>. Thus we are able to minimize the needed templates configuration.</p>
</div>
<div class="paragraph">
<p><em>(Since version 4.1.0)</em> It is possible to reference external <code>templateExtension</code> (<code>templateExtensions</code> defined on another trigger), thanks to using <code>&lt;incrementRef &#8230;&#8203;&gt;</code> that are explained <a href="#increment-node">here</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_increment_node"><a class="anchor" href="#_increment_node"></a>Increment Node</h6>
<div class="paragraph">
<p>The <code>&lt;increments&gt;</code> node groups multiple <code>&lt;increment&gt;</code> nodes, which can be seen as a collection of templates to be generated. An increment will be defined by a unique <code>id</code> and a human readable <code>description</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;increments&gt;
    &lt;increment id="..." description="..."&gt;
        &lt;incrementRef ref="..." /&gt;
        &lt;templateRef ref="..." /&gt;
        &lt;templateScanRef ref="..." /&gt;
    &lt;/increment&gt;
&lt;/increments&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>An increment might contain multiple increments and/or templates, which will be referenced using <code>&lt;incrementRef &#8230;&#8203;&gt;</code>, <code>&lt;templateRef &#8230;&#8203;&gt;</code>, resp. <code>&lt;templateScanRef &#8230;&#8203;&gt;</code> nodes. These nodes only declare the attribute <code>ref</code>, which will reference an increment, a template, or a template-scan by its <code>id</code> or <code>name</code>.</p>
</div>
<div class="paragraph">
<p><em>(Since version 4.1.0)</em>  An special case of <code>&lt;incrementRef &#8230;&#8203;&gt;</code> is the external <code>incrementsRef</code>. By default, <code>&lt;incrementRef &#8230;&#8203;&gt;</code> are used to reference increments defined in the same <code>templates.xml</code> file. So for example, we could have:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;increments&gt;
    &lt;increment id="incA" description="..."&gt;
        &lt;incrementRef ref="incB" /&gt;
    &lt;/increment&gt;
    &lt;increment id="incB" description="..."&gt;
        &lt;templateRef .... /&gt;
        &lt;templateScan .... /&gt;
    &lt;/increment&gt;
&lt;/increments&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, if we want to reference an increment that it is not defined inside our <code>templates.xml</code> (an increment defined for another trigger), then we can use external <code>incrementRef</code> as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;increment name="..." description="..."&gt;
    &lt;incrementRef ref="trigger_id::increment_id"/&gt;
&lt;/increment&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The ref string is split using as delimiter <code>::</code>. The first part of the string, is the <code>trigger_id</code> to reference. That trigger contains an <code>increment_id</code>. Currently, this functionality only works when both templates use the same kind of input file.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_java_template_logic"><a class="anchor" href="#_java_template_logic"></a>Java Template Logic</h5>
<div class="paragraph">
<p><em>since <code>cobigen-core-3.0.0</code> which is included in the Eclipse and Maven Plugin since version 2.0.0</em>
In addition, it is possible to implement more complex template logic by custom Java code. To enable this feature, you can simply import the the <code>CobiGen_Templates</code> by clicking on <em>Adapt Templates</em>, turn it into a simple maven project (if it is not already) and implement any Java logic in the common maven layout (e.g. in the source folder <code>src/main/java</code>). Each Java class will be instantiated by CobiGen for each generation process. Thus, you can even store any state within a Java class instance during generation. However, there is currently no guarantee according to the template processing order.</p>
</div>
<div class="paragraph">
<p>As a consequence, you have to implement your Java classes with a public default (non-parameter) constructor to be used by any template. Methods of the implemented Java classes can be called within templates by the simple standard FreeMarker expression for calling Bean methods: <code>SimpleType.methodName(param1)</code>. Until now, CobiGen will shadow multiple types with the same simple name non-deterministically. So please prevent yourself from that situation.</p>
</div>
<div class="paragraph">
<p>Finally, if you would like to do some reflection within your Java code accessing any type of the template project or any type referenced by the input, you should load classes by making use of the classloader of the util classes. CobiGen will take care of the correct classloader building including the classpath of the input source as well as of the classpath of the template project. If you use any other classloader or build it by your own, there will be no guarantee, that generation succeeds.</p>
</div>
</div>
<div class="sect4">
<h5 id="_template_properties"><a class="anchor" href="#_template_properties"></a>Template Properties</h5>
<div class="paragraph">
<p><em>since <code>cobigen-core-4.0.0`</em>
Using a configuration with `<a href="#templatescan-node">template scan</a></code>, you can make use of properties in templates specified in property files named <code>cobigen.properties</code> next to the templates. The property files are specified as <a href="https://en.wikipedia.org/wiki/.properties">Java property files</a>. Property files can be nested in sub-folders. Properties will be resolved including property shading. Properties defined nearest to the template to be generated will take precedence.
In addition, a <code>cobigen.properties</code> file can be specified in the target folder root (in eclipse plugin, this is equal to the source project root). These properties take precedence over template properties specified in the template folder.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is not allowed to override context variables in <code>cobigen.properties</code> specifications as we have not found any interesting use case. This is most probably an error of the template designer, CobiGen will raise an error in this case.
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="_multi_module_support_or_template_target_path_redirects"><a class="anchor" href="#_multi_module_support_or_template_target_path_redirects"></a>Multi module support or template target path redirects</h6>
<div class="paragraph">
<p><em>since <code>cobigen-core-4.0.0`</em>
One special property you can specify in the template properties is the property `relocate</code>. It will cause the current folder and its sub-folders to be relocated at destination path resolution time. Take the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>folder
  - sub1
    Template.java.ftl
    cobigen.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let the <code>cobigen.properties</code> file contain the line <code>relocate=../sub2/${cwd}</code>. Given that, the relative destination path of <code>Template.java.ftl</code> will be resolved to <code>folder/sub2/Template.java</code>. Compare <code><a href="#templatescan-node">template scan</a></code> configuration for more information about basic path resolution. The <code>relocate</code> property specifies a relative path from the location of the <code>cobigen.properties</code>. The <code>${cwd}</code> placeholder will contain the remaining relative path from the <code>cobigen.properties</code> location to the template file. In this basic example it just contains <code>Template.java.ftl</code>, but it may even be any relative path including sub-folders of sub1 and its templates.
Given the <code>relocate</code> feature, you can even step out of the root path, which in general is the project/maven module the input is located in. This enables template designers to even address, e.g., maven modules located next to the module the input is coming from.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_basic_template_model"><a class="anchor" href="#_basic_template_model"></a>Basic Template Model</h5>
<div class="paragraph">
<p>In addition to what is served by the different model builders of the different plug-ins, CobiGen provides a minimal model based on context variables as well as CobiGen properties. The following model is independent of the input format and will be served as a template model all the time:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>variables</p>
<div class="ulist">
<ul>
<li>
<p>all triggered <code><a href="#variableassignment-node.adoc" class="page unresolved">context variables</a></code> mapped to its assigned/mapped value</p>
</li>
<li>
<p>all <a href="#template-properties.adoc" class="page unresolved">template properties</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>all simple names of <a href="#java-template-logic.adoc" class="page unresolved">Java template logic</a> implementation classes</p>
</li>
<li>
<p>all full qualified names of <a href="#java-template-logic.adoc" class="page unresolved">Java template logic</a> implementation classes</p>
</li>
<li>
<p>further input related model, e.g. <a href="cobigen-javaplugin#template-object-model.adoc">model from Java inputs</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_plugin_mechanism"><a class="anchor" href="#_plugin_mechanism"></a>Plugin Mechanism</h5>
<div class="paragraph">
<p>Since <code>cobigen-core 4.1.0</code>, we changed the plug-in discovery mechanism. So far it was necessary to register new plugins programmatically, which introduces the need to let every tool integration, i.e. for eclipse or maven, be dependent on every plug-in, which should be released. This made release cycles take long time as all plug-ins have to be integrated into a final release of maven or eclipse integration.</p>
</div>
<div class="paragraph">
<p>Now, plug-ins are automatically discovered by the Java <a href="https://docs.oracle.com/javase/tutorial/ext/basics/spi.html">Service Loader</a> mechanism from the classpath. This also effects the setup of <a href="cobigen-eclipse_installation#upgrading-to-v3.adoc">eclipse</a> and <a href="cobigen-maven_configuration#additions-since-v3.adoc">maven</a> integration to allow modular releases of CobiGen in future. We are now able to provide faster rollouts of bug-fixes in any of the plug-ins as they can be released completely independently.</p>
</div>
</div>
<div class="sect2">
<h3 id="_plug_ins"><a class="anchor" href="#_plug_ins"></a>Plug-ins</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Java Plug-in
The CobiGen Java Plug-in comes with a new input reader for java artifacts, new java related trigger and matchers, as well as a merging mechanism for Java sources.</p>
</div>
<div class="sect5">
<h6 id="_trigger_extension"><a class="anchor" href="#_trigger_extension"></a>Trigger extension</h6>
<div class="paragraph">
<p>The Java Plug-in provides a new trigger for Java related inputs. It accepts different representations as inputs (see <a href="#java-input-reader">Java input reader</a>) and provides additional matching and variable assignment mechanisms. The configuration in the <code>context.xml</code> for this trigger looks like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'java'</p>
<div class="listingblock">
<div class="title">Example of a java trigger definition</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    ...
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger type enables Java elements as inputs.</p>
</div>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="_matcher_types"><a class="anchor" href="#_matcher_types"></a>Matcher types</h7>
<div class="paragraph">
<p>With the trigger you might define matchers, which restrict the input upon specific aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type <code>fqn</code> &#8594; full qualified name matching</p>
<div class="listingblock">
<div class="title">Example of a java trigger definition with a full qualified name matcher</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    &lt;matcher type="fqn" value="(.+)\.persistence\.([^\.]+)\.entity\.([^\.]+)"&gt;
        ...
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger will be enabled if the full qualified name (<code>fqn</code>) of the declaring input class matches the given regular expression (<code>value</code>).</p>
</div>
</li>
<li>
<p>type 'package' &#8594; package name of the input</p>
<div class="listingblock">
<div class="title">Example of a java trigger definition with a package name matcher</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    &lt;matcher type="package" value="(.+)\.persistence\.([^\.]+)\.entity"&gt;
        ...
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger will be enabled if the package name (<code>package</code>) of the declaring input class matches the given regular expression (<code>value</code>).</p>
</div>
</li>
<li>
<p>type 'expression'</p>
<div class="listingblock">
<div class="title">Example of a java trigger definition with a package name matcher</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    &lt;matcher type="expression" value="instanceof java.lang.String"&gt;
        ...
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger will be enabled if the expression evaluates to true. Valid expressions are</p>
</div>
</li>
<li>
<p><code>instanceof fqn</code>: checks an 'is a' relation of the input type</p>
</li>
<li>
<p><code>isAbstract</code>: checks, whether the input type is declared abstract</p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="_container_matcher_types"><a class="anchor" href="#_container_matcher_types"></a>Container Matcher types</h7>
<div class="paragraph">
<p>Additionally, the java plugin provides the ability to match packages (containers) as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'package'</p>
<div class="listingblock">
<div class="title">Example of a java trigger definition with a container matcher for packages</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    &lt;containerMatcher type="package" value="com\.example\.app\.component1\.persistence.entity" /&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The container matcher matches packages provided by the type <code>com.capgemini.cobigen.javaplugin.inputreader.to.PackageFolder</code> with a regular expression stated in the <code>value</code> attribute. (See <a href="cobigen-core_configuration#containermatcher-node.adoc"><code>containerMatcher</code> semantics</a> to get more information about <code>containerMatchers</code> itself.)</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="_variable_assignment_types"><a class="anchor" href="#_variable_assignment_types"></a>Variable Assignment types</h7>
<div class="paragraph">
<p>Furthermore, it provides the ability to extract information from each input for further processing in the templates. The values assigned by variable assignments will be made available in template and the <code>destinationPath</code> of <code>context.xml</code> through the namespace <code>variables.&lt;key&gt;</code>. The Java Plug-in currently provides two different mechanisms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'regex' &#8594; regular expression group</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    &lt;matcher type="fqn" value="(.+)\.persistence\.([^\.]+)\.entity\.([^\.]+)"&gt;
        &lt;variableAssignment type="regex" key="rootPackage" value="1" /&gt;
        &lt;variableAssignment type="regex" key="component" value="2" /&gt;
        &lt;variableAssignment type="regex" key="pojoName" value="3" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This variable assignment assigns the value of the given regular expression group number to the given <code>key</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'constant' &#8594; constant parameter</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    &lt;matcher type="fqn" value="(.+)\.persistence\.([^\.]+)\.entity\.([^\.]+)"&gt;
        &lt;variableAssignment type="constant" key="domain" value="restaurant" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This variable assignment assigns the <code>value</code> to the <code>key</code> as a constant.</p>
</div>
</div>
<div class="sect6">
<h7 id="_java_input_reader"><a class="anchor" href="#_java_input_reader"></a>Java input reader</h7>
<div class="paragraph">
<p>The CobiGen Java Plug-in implements an input reader for parsed java sources as well as for java <code>Class&lt;?&gt;</code> objects (loaded by reflection). So API user can pass <code>Class&lt;?&gt;</code> objects as well as <code>JavaClass</code> objects for generation. The latter depends on <a href="https://github.com/paul-hammant/qdox">QDox</a>, which will be used for parsing and merging java sources. For getting the right parsed java inputs you can easily use the <code>JavaParserUtil</code>, which provides static functionality to parse java files and get the appropriate <code>JavaClass</code> object.</p>
</div>
<div class="paragraph">
<p>Furthermore, due to restrictions on both inputs according to model building (see below), it is also possible to provide an array of length two as an input, which contains the <code>Class&lt;?&gt;</code> as well as the <code>JavaClass</code> object of the same class.</p>
</div>
<div class="sect7">
<h8 id="_template_object_model"><a class="anchor" href="#_template_object_model"></a>Template object model</h8>
<div class="paragraph">
<p>No matter whether you use reflection objects or parsed java classes as input, you will get the following object model for template creation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>classObject</code></strong> ('Class' :: Class object of the Java input)</p>
</li>
<li>
<p><strong>POJO</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> ('String' :: Simple name of the input class)</p>
</li>
<li>
<p><strong>package</strong> ('String' :: Package name of the input class)</p>
</li>
<li>
<p><strong><code>canonicalName</code></strong> ('String' :: Full qualified name of the input class)</p>
</li>
<li>
<p><strong>annotations</strong> ('Map&lt;String, Object&gt;' :: Annotations, which will be represented by a mapping of the full qualified type of an annotation to its value. To gain template compatibility, the key will be stored with '_' instead of '.' in the full qualified annotation type. Furthermore, the annotation might be recursively defined and thus be accessed using the same type of mapping. Example <code>${pojo.annotations.javax_persistence_Id}</code>)</p>
</li>
<li>
<p><strong>JavaDoc</strong> ('Map&lt;String, Object&gt;') :: A generic way of addressing all available JavaDoc doclets and comments. The only fixed variable is <code>comment</code> (see below). All other provided variables depend on the doclets found while parsing. The value of a doclet can be accessed by the doclets name (e.g. <code>${&#8230;&#8203;JavaDoc.author}</code>). In case of doclet tags that can be declared multiple times (currently <code>@param</code> and <code>@throws</code>), you will get a map, which you access in a specific way (see below).</p>
<div class="ulist">
<ul>
<li>
<p><strong>comment</strong> ('String' :: JavaDoc comment, which does not include any doclets)</p>
</li>
<li>
<p><strong>params</strong> ('Map&lt;String,String&gt; :: JavaDoc parameter info. If the comment follows proper conventions, the key will be the name of the parameter and the value being its description. You can also access the parameters by their number, as in <code>arg0</code>, <code>arg1</code> etc, following the order of declaration in the signature, not in order of JavaDoc)</p>
</li>
<li>
<p><strong>throws</strong> ('Map&lt;String,String&gt; :: JavaDoc exception info. If the comment follows proper conventions, the key will be the name of the thrown exception and the value being its description)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>extendedType</code></strong> ('Map&lt;String, Object&gt;' :: The supertype, represented by a set of mappings <em>(since <code>cobigen-javaplugin v1.1.0</code>)</em></p>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> ('String' :: Simple name of the supertype)</p>
</li>
<li>
<p><strong><code>canonicalName</code></strong> ('String' :: Full qualified name of the supertype)</p>
</li>
<li>
<p><strong>package</strong> ('String' :: Package name of the supertype)</p>
</li>
</ul>
</div>
</li>
<li>
<p><code><strong>implementedTypes</strong></code> ('List&lt;Map&lt;String, Object&gt;&gt;' :: A list of all <code>implementedTypes</code> (interfaces) represented by a set of mappings <em>(since <code>cobigen-javaplugin v1.1.0</code>)</em></p>
<div class="ulist">
<ul>
<li>
<p><strong>interface</strong> ('Map&lt;String, Object&gt;' :: List element)</p>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> ('String' :: Simple name of the interface)</p>
</li>
<li>
<p><strong><code>canonicalName</code></strong> ('String' :: Full qualified name of the interface)</p>
</li>
<li>
<p><strong>package</strong> ('String' :: Package name of the interface)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>fields</strong> ('List&lt;Map&lt;String, Object&gt;&gt;' :: List of fields of the input class) <em>(renamed since <code>cobigen-javaplugin v1.2.0</code>; previously <strong>attributes</strong>)</em></p>
<div class="ulist">
<ul>
<li>
<p>field ('Map&lt;String, Object&gt;' :: List element)</p>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> ('String' :: Name of the Java field)</p>
</li>
<li>
<p><strong>type</strong> ('String' :: Type of the Java field)</p>
</li>
<li>
<p><code><strong>canonicalType</strong></code> ('String' :: Full qualified type declaration of the Java field&#8217;s type)</p>
</li>
<li>
<p>'<strong><code>isId</code></strong>' (<code>Deprecated</code> :: <code>boolean</code> :: true if the Java field or its setter or its getter is annotated with the <code>javax.persistence.Id</code> annotation, false otherwise. Equivalent to <code>${pojo.attributes[i].annotations.javax_persistence_Id?has_content}</code>)</p>
</li>
<li>
<p><strong>JavaDoc</strong> (see <code>pojo.JavaDoc</code>)</p>
</li>
<li>
<p><strong>annotations</strong> (see <code>pojo.annotations</code> with the remark, that for fields all annotations of its setter and getter will also be collected)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code><strong>methodAccessibleFields</strong></code> ('List&lt;Map&lt;String, Object&gt;&gt;' :: List of fields of the input class or its inherited classes, which are accessible using setter and getter methods)</p>
<div class="ulist">
<ul>
<li>
<p>same as for <em>field</em> (but without JavaDoc!)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>methods</strong> ('List&lt;Map&lt;String, Object&gt;&gt;' :: The list of all methods, whereas one method will be represented by a set of property mappings)</p>
<div class="ulist">
<ul>
<li>
<p>method ('Map&lt;String, Object&gt;' :: List element)</p>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> ('String' :: Name of the method)</p>
</li>
<li>
<p><strong>JavaDoc</strong> (see <code>pojo.JavaDoc</code>)</p>
</li>
<li>
<p><strong>annotations</strong> (see <code>pojo.annotations</code>)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Furthermore, when providing a <code>Class&lt;?&gt;</code> object as input, the Java Plug-in will provide additional functionalities as template methods <em>(deprecated)</em>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>isAbstract(String fqn)</code> (Checks whether the type with the given full qualified name is an abstract class. Returns a Boolean value.) <em>(since <code>cobigen-javaplugin v1.1.1</code>)</em>  <em>(deprecated)</em></p>
</li>
<li>
<p><code>isSubtypeOf(String subType, String superType)</code> (Checks whether the <code>subType</code> declared by its full qualified name is a sub type of the <code>superType</code> declared by its full qualified name. Equals the Java expression <code>subType instanceof superType</code> and so also returns a Boolean value.) <em>(since <code>cobigen-javaplugin v1.1.1</code>)</em>  <em>(deprecated)</em></p>
</li>
</ol>
</div>
</div>
<div class="sect7">
<h8 id="_model_restrictions"><a class="anchor" href="#_model_restrictions"></a>Model Restrictions</h8>
<div class="paragraph">
<p>As stated before both inputs (<code>Class&lt;?&gt;</code> objects and <code>JavaClass</code> objects ) have their restrictions according to model building. In the following these restrictions are listed for both models, the <code>ParsedJava</code> Model which results from an <code>JavaClass</code> input and the <code>ReflectedJava</code> Model, which results from a Class&lt;?&gt; input.</p>
</div>
<div class="paragraph">
<p>It is important to understand, that these restrictions are only present if you work with either Parsed Model <strong>OR</strong> the Reflected Model. If you use the <em>Maven Build Plug-in</em> or <em>Eclipse Plug-in</em> these two models are merged together so that they can mutually compensate their weaknesses.</p>
</div>
<div class="sect8">
<h9 id="_parsed_model"><a class="anchor" href="#_parsed_model"></a>Parsed Model</h9>
<div class="ulist">
<ul>
<li>
<p>annotations of the input&#8217;s supertype are not accessible due to restrictions in the <a href="https://github.com/paul-hammant/qdox">QDox</a> library. So <code>pojo.methodAccessibleFields[i].annotations</code> will always be empty for super type fields.</p>
</li>
<li>
<p>annotations' parameter values are available as Strings only (e.g. the Boolean value <code>true</code> is transformed into <code>"true"</code>). This also holds for the Reflected Model.</p>
</li>
<li>
<p>fields of "supertypes" of the input <code>JavaClass</code> are not available at all. So <code>pojo.methodAccessibleFields</code> will only contain the input type&#8217;s and the direct superclass&#8217;s fields.</p>
</li>
<li>
<p>[resolved, since <code>cobigen-javaplugin 1.3.1</code>] field types of supertypes are always canonical. So <code>pojo.methodAccessibleFields[i].type</code> will always provide the same value as <code>pojo.methodAccessibleFields[i].canonicalType</code> (e.g. <code>java.lang.String</code> instead of the expected <code>String</code>) for super type fields.</p>
</li>
</ul>
</div>
</div>
<div class="sect8">
<h9 id="_reflected_model"><a class="anchor" href="#_reflected_model"></a>Reflected Model</h9>
<div class="ulist">
<ul>
<li>
<p>annotations' parameter values are available as Strings only (e.g. the Boolean value <code>true</code> is transformed into <code>"true"</code>). This also holds for the Parsed Model.</p>
</li>
<li>
<p>annotations are only available if the respective annotation has <code>@Retention(value=RUNTIME)</code>, otherwise the annotations are to be discarded by the compiler or by the VM at run time. For more information see <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/annotation/RetentionPolicy.html">RetentionPolicy</a>.</p>
</li>
<li>
<p>information about generic types is lost. E.g. a field&#8217;s/ methodAccessibleField&#8217;s type for <code>List&lt;String&gt;</code> can only be provided as <code>List&lt;?&gt;</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_merger_extensions"><a class="anchor" href="#_merger_extensions"></a>Merger extensions</h6>
<div class="paragraph">
<p>The Java Plug-in provides two additional merging strategies for Java sources, which can be configured in the <code>templates.xml</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Merge strategy <code>javamerge</code> (merges two Java resources and keeps the existing Java elements on conflicts)</p>
</li>
<li>
<p>Merge strategy <code>javamerge_override</code> (merges two Java resources and overrides the existing Java elements on conflicts)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In general merging of two Java sources will be processed as follows:</p>
</div>
<div class="paragraph">
<p>Precondition of processing a merge of generated contents and existing ones is a common Java root class resp. surrounding class. If this is the case this class and all further inner classes will be merged recursively. Therefore, the following Java elements will be merged and conflicts will be resolved according to the configured merge strategy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>extends</code> and <code>implements</code> relations of a class: Conflicts can only occur for the extends relation.</p>
</li>
<li>
<p>Annotations of a class: Conflicted if an annotation declaration already exists.</p>
</li>
<li>
<p>Fields of a class: Conflicted if there is already a field with the same name in the existing sources. (Will be replaced / ignored in total, also including annotations)</p>
</li>
<li>
<p>Methods of a class: Conflicted if there is already a method with the same signature in the existing sources. (Will be replaced / ignored in total, also including annotations)</p>
</li>
</ul>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Property Plug-in
The CobiGen Property Plug-in currently only provides different merge mechanisms for documents written in <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Properties.html">Java property syntax</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_merger_extensions_2"><a class="anchor" href="#_merger_extensions_2"></a>Merger extensions</h6>
<div class="paragraph">
<p>There are two merge strategies for Java properties, which can be configured in the templates.xml:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Merge strategy <code>propertymerge</code> (merges two properties documents and keeps the existing properties on conflicts)</p>
</li>
<li>
<p>Merge strategy <code>propertymerge_override</code> (merges two properties documents and overrides the existing properties on conflicts)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both documents (base and patch) will be parsed using the <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Properties.html">Java 7 API</a> and will be compared according their keys. Conflicts will occur if a key in the patch already exists in the base document.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==XML Plug-in
The CobiGen XML Plug-in comes with an input reader for XML artifacts, XML related trigger and matchers and provides different merge mechanisms for XML result documents.</p>
</div>
</div>
<div class="sect5">
<h6 id="_trigger_extension_2"><a class="anchor" href="#_trigger_extension_2"></a>Trigger extension</h6>
<div class="paragraph">
<p><em>(since <code>cobigen-xmlplugin v2.0.0</code>)</em></p>
</div>
<div class="paragraph">
<p>The XML Plug-in provides a trigger for XML related inputs. It accepts XML documents as input (see <code><a href="#xml-input-reader">XML input reader</a></code>) and provides additional matching and variable assignment mechanisms. The configuration in the <code>context.xml</code> for this trigger looks like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'xml'</p>
<div class="listingblock">
<div class="title">Example of a XML trigger definition.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="xml" templateFolder="..."&gt;
    ...
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger type enables XML documents as inputs.</p>
</div>
</li>
<li>
<p>type <code>xpath</code></p>
<div class="listingblock">
<div class="title">Example of a <code>xpath</code> trigger definition.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="xpath" templateFolder="..."&gt;
    ...
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger type enables XML documents as container inputs, which consists of several sub-documents.</p>
</div>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="_container_matcher_type"><a class="anchor" href="#_container_matcher_type"></a>Container Matcher type</h7>
<div class="paragraph">
<p>A <code>ContainerMatcher</code> check if the input is a valid container.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>xpath</code>: type: <code>xpath</code></p>
<div class="listingblock">
<div class="title">Example of a XML trigger definition with a node name matcher.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="xml" templateFolder="..."&gt;
    &lt;containerMatcher type="xpath" value="./uml:Model//packagedElement[@xmi:type='uml:Class']"&gt;
        ...
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Before applying any Matcher, this <code>containerMatcher</code> checks if the XML file contains a node <code>uml:Model</code> with a childnode <code>packagedElement</code> which contains an attribute <code>xmi:type</code> with the value <code>uml:Class</code>.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="_matcher_types_2"><a class="anchor" href="#_matcher_types_2"></a>Matcher types</h7>
<div class="paragraph">
<p>With the trigger you might define matchers, which restrict the input upon specific aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>XML: type <code>nodename</code> &#8594; document&#8217;s root name matching</p>
<div class="listingblock">
<div class="title">Example of a XML trigger definition with a node name matcher</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="xml" templateFolder="..."&gt;
    &lt;matcher type="nodename" value="\D\w*"&gt;
        ...
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger will be enabled if the root name of the declaring input document matches the given regular expression (<code>value</code>).</p>
</div>
</li>
<li>
<p><code>xpath</code>: type: <code>xpath</code> &#8594; matching a node with a <code>xpath</code> value</p>
<div class="listingblock">
<div class="title">Example of a <code>xpath</code> trigger definition with a <code>xpath</code> matcher.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="xml" templateFolder="..."&gt;
    &lt;matcher type="xpath" value="/packagedElement[@xmi:type='uml:Class']"&gt;
        ...
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger will be enabled if the XML file contains a node <code>/packagedElement</code> where the <code>xmi:type</code> property equals <code>uml:Class</code>.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="_variable_assignment_types_2"><a class="anchor" href="#_variable_assignment_types_2"></a>Variable Assignment types</h7>
<div class="paragraph">
<p>Furthermore, it provides the ability to extract information from each input for further processing in the templates. The values assigned by variable assignments will be made available in template and the <code>destinationPath</code> of <code>context.xml</code> through the namespace <code>variables.&lt;key&gt;</code>. The XML Plug-in currently provides only one mechanism:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'constant' &#8594; constant parameter</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="xml" templateFolder="..."&gt;
    &lt;matcher type="nodename" value="\D\w*"&gt;
        &lt;variableAssignment type="constant" key="domain" value="restaurant" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This variable assignment assigns the <code>value</code> to the <code>key</code> as a constant.</p>
</div>
</div>
<div class="sect6">
<h7 id="_xml_input_reader"><a class="anchor" href="#_xml_input_reader"></a>XML input reader</h7>
<div class="paragraph">
<p>The CobiGen XML Plug-in implements an input reader for parsed XML documents. So API user can pass <code>org.w3c.dom.Document</code> objects for generation. For getting the right parsed XML inputs you can easily use the <code>xmlplugin.util.XmlUtil</code>, which provides static functionality to parse XML files or input streams and get the appropriate <code>Document</code> object.</p>
</div>
<div class="sect7">
<h8 id="_template_object"><a class="anchor" href="#_template_object"></a>Template object</h8>
<div class="paragraph">
<p>Due to the heterogeneous structure an XML document can have, the XML input reader does not always create exactly the same model structure (in contrast to the java input reader). For example the model&#8217;s depth differs strongly, according to it&#8217;s input document. To allow navigational access to the nodes, the model also depends on the document&#8217;s element&#8217;s node names. All child elements with unique names, are directly accessible via their names. In addition it is possible to iterate over all child elements with held of the child list <code>Children</code>. So it is also possible to access child elements with non unique names.</p>
</div>
<div class="paragraph">
<p>The XML input reader will create the following object model for template creation (<code><sub>EXAMPLEROOT</sub>, <sub>EXAMPLENODE1</sub>, <sub>EXAMPLENODE2</sub>, <sub>EXAMPLEATTR1</sub>,&#8230;&#8203;</code> are just used here as examples. Of course they will be replaced later by the actual node or attribute names):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>~EXAMPLEROOT~</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>_nodeName_</code></strong> ('String' :: Simple name of the root node)</p>
</li>
<li>
<p><strong><code>_text_</code></strong> ('String' :: Concatenated text content (<code>PCDATA</code>) of the root node)</p>
</li>
<li>
<p><strong><code>TextNodes</code></strong> ('List&lt;String&gt;' :: List of all the root&#8217;s text node contents)</p>
</li>
<li>
<p><strong><code>_at_~EXAMPLEATTR1~</code></strong> ('String' :: String representation of the attribute&#8217;s value)</p>
</li>
<li>
<p><strong><code>_at_~EXAMPLEATTR2~</code></strong> ('String' :: String representation of the attribute&#8217;s value)</p>
</li>
<li>
<p><strong>_at_&#8230;&#8203;</strong></p>
</li>
<li>
<p><strong>Attributes</strong> ('List&lt;Map&lt;String, Object&gt;&gt;' :: List of the root&#8217;s attributes</p>
<div class="ulist">
<ul>
<li>
<p>at ('Map&lt;String, Object&gt;' :: List element)</p>
<div class="ulist">
<ul>
<li>
<p><code><strong>_attName_</strong> ('String' :: Name of the attribute)</code></p>
</li>
<li>
<p><code><strong>_attValue_</strong> ('String' :: String representation of the attribute&#8217;s value)</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Children</strong> ('List&lt;Map&lt;String, Object&gt;&gt;' :: List of the root&#8217;s child elements</p>
<div class="ulist">
<ul>
<li>
<p>child ('Map&lt;String, Object&gt;' :: List element)</p>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203;common element sub structure&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>~EXAMPLENODE1~</code></strong> ('Map&lt;String, Object&gt;' :: One of the root&#8217;s child nodes)</p>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203;common element structure&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>~EXAMPLENODE2~</code></strong> ('Map&lt;String, Object&gt;' :: One of the root&#8217;s child nodes)</p>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203;common element sub structure&#8230;&#8203;</p>
</li>
<li>
<p><strong><code>~EXAMPLENODE21~</code></strong> ('Map&lt;String, Object&gt;' :: One of the nodes' child nodes)</p>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203;common element structure&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>~EXAMPLENODE&#8230;&#8203;~</code></strong></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>~EXAMPLENODE&#8230;&#8203;~</code></strong></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In contrast to the java input reader, this XML input reader does currently not provide any additional template methods.</p>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_merger_extensions_3"><a class="anchor" href="#_merger_extensions_3"></a>Merger extensions</h6>
<div class="paragraph">
<p>The XML plugin uses the <a href="https://github.com/maybeec/lexeme"><code>LeXeMe</code></a> merger library to produce semantically correct merge products. The merge strategies can be found in the <a href="https://github.com/devonfw/cobigen/blob/master/cobigen/cobigen-xmlplugin/src/main/java/com/devonfw/cobigen/xmlplugin/merger/delegates/MergeType.java#L11"><code>MergeType enum</code></a> and can be configured in the <code>templates.xml</code> as a <code>mergeStrategy</code> attribute:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mergeStrategy xmlmerge</code></p>
<div class="listingblock">
<div class="title">Example of a template using the <code>mergeStrategy</code> <code>xmlmerge</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;templates&gt;
	&lt;template name="..." destinationPath="..." templateFile="..." mergeStrategy="xmlmerge"/&gt;
&lt;/templates&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Currently only the document types included in LeXeMe are supported.
On how the merger works consult the <a href="https://github.com/maybeec/lexeme/wiki">LeXeMe Wiki</a>.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Text Merger Plug-in
The Text Merger Plug-in enables merging result free text documents to existing free text documents. Therefore, the algorithms are also very rudimentary.</p>
</div>
</div>
<div class="sect5">
<h6 id="extensions"><a class="anchor" href="#extensions"></a>Merger extensions</h6>
<div class="paragraph">
<p>There are currently three main merge strategies that apply for the whole document:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>merge strategy <code>textmerge_append</code> (appends the text directly to the end of the existing document)
_Remark_: If no anchors are defined, this will simply append the patch.</p>
</li>
<li>
<p>merge strategy <code>textmerge_appendWithNewLine</code> (appends the text after adding a new line break to the existing document)
_Remark_: empty patches will not result in appending a new line any more since v1.0.1
<em>Remark</em>: Only suitable if no anchors are defined, otherwise it will simply act as <code>textmerge_append</code></p>
</li>
<li>
<p>merge strategy <code>textmerge_override</code> (replaces the contents of the existing file with the patch)
_Remark_: If anchors are defined, override is set as the default <code>mergestrategy</code> for every text block if not redefined in an anchor specification.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_anchor_functionality"><a class="anchor" href="#_anchor_functionality"></a>Anchor functionality</h6>
<div class="paragraph">
<p>If a template contains text that fits the definition of <code>anchor:${documentpart}:${mergestrategy}:anchorend</code> or more specifically the regular expression <code>(.*)anchor:([<sup>:]+):(newline_)?([</sup>:]+)(_newline)?:anchorend\\s*(\\r\\n|\\r|\\n)</code>, some additional functionality becomes available about specific parts of the incoming text and the way it will be merged with the existing text. These anchors always change things about the text to come up until the next anchor, text before it is ignored.</p>
</div>
<div class="paragraph">
<p>If no anchors are defined, the complete patch will be appended depending on your choice for the template in the file <code>templates.xml</code>.</p>
</div>
<div class="paragraph">
<p>[[<code>anchordef</code>]]</p>
</div>
<div class="sect6">
<h7 id="_anchor_definition"><a class="anchor" href="#_anchor_definition"></a>Anchor Definition</h7>
<div class="paragraph">
<p>Anchors should always be defined as a comment of the language the template results in, as you do not want them to appear in your readable version, but cannot define them as FreeMarker comments in the template, or the merger will not know about them.
Anchors will also be read when they are not comments due to the merger being able to merge multiple types of text-based languages, thus making it practically impossible to filter for the correct comment declaration. <strong>That is why anchors have to always be followed by line breaks</strong>. That way there is a universal way to filter anchors that should have anchor functionality and ones that should appear in the text.
<em>Remark:</em> If the resulting language has closing tags for comments, they have to appear in the next line.
<em>Remark:</em> If you do not put the anchor into a new line, all the text that appears before it will be added to the anchor.</p>
</div>
</div>
<div class="sect6">
<h7 id="_document_parts"><a class="anchor" href="#_document_parts"></a>Document parts</h7>
<div class="paragraph">
<p>In general, <code>${documentpart}</code> is an id to mark a part of the document, that way the merger knows what parts of the text to merge with which parts of the patch (e.g. if the existing text contains <code>anchor:table:${}:anchorend</code> that part will be merged with the part tagged <code>anchor:table:${}:anchorend</code> of the patch).</p>
</div>
<div class="paragraph">
<p>If the same <code>documentpart</code> is defined multiple times, it can lead to errors, so instead of defining <code>table</code> multiple times, use <code>table1</code>, <code>table2</code>, <code>table3</code> etc.</p>
</div>
<div class="paragraph">
<p>If a <code>${documentpart}</code> is defined in the document but not in the patch and they are in the same position, it is processed in the following way: If only the <code>documentparts header</code>, <code>test</code> and <code>footer</code> are defined in the document in that order, and the patch contains <code>header</code>, <code>order</code> and <code>footer</code>, the resulting order will be <code>header</code>, <code>test</code>, <code>order</code> then <code>footer</code>.</p>
</div>
<div class="paragraph">
<p>The following <code>documentparts</code> have default functionality:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>anchor:header:${mergestrategy}:anchorend</code> marks the beginning of a header, that will be added once when the document is created, but not again.
<em>Remark:</em> This is only done once, if you have <code>header</code> in another anchor, it will be ignored</p>
</li>
<li>
<p><code>anchor:footer:${mergestrategy}:anchorend</code> marks the beginning of a footer, that will be added once when the document is created, but not again. Once this is invoked, all following text will be included in the footer, including other anchors.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>[[<code>mergestrategies</code>]]</p>
</div>
</div>
<div class="sect6">
<h7 id="_mergestrategies"><a class="anchor" href="#_mergestrategies"></a><code>Mergestrategies</code></h7>
<div class="paragraph">
<p><code>Mergestrategies</code> are only relevant in the patch, as the merger is only interested in how text in the patch should be managed, not how it was managed in the past.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>anchor:${documentpart}::anchorend</code> will use the merge strategy from <code>templates.xml</code>, see <a href="#extensions">Merger-Extensions</a>.</p>
</li>
<li>
<p><code>anchor:${}:${mergestrategy}_newline:anchorend</code> or <code>anchor:${}:newline_${mergestrategy}:anchorend</code> states that a new line should be appended before or after this anchors text, depending on where the newline is (before or after the <code>mergestrategy</code>). <code>anchor:${documentpart}:newline:anchorend</code> puts a new line after the anchors text.
<em>Remark:</em> Only works with appending strategies, not merging/replacing ones. These strategies currently include: <code>appendbefore</code>, <code>append</code>/<code>appendafter</code></p>
</li>
<li>
<p><code>anchor:${documentpart}:override:anchorend</code> means that the new text of this <code>documentpart</code> will replace the existing one completely</p>
</li>
<li>
<p><code>anchor:${documentpart}:appendbefore:anchorend</code> or <code>anchor:${documentpart}:appendafter:anchorend</code>/<code>anchor:${documentpart}:append:anchorend</code> specifies whether the text of the patch should come before the existing text or after.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_usage_examples"><a class="anchor" href="#_usage_examples"></a>Usage Examples</h6>
<div class="sect6">
<h7 id="_general"><a class="anchor" href="#_general"></a>General</h7>
<div class="paragraph">
<p>Below you can see how a file with anchors might look like (using adoc comment tags), with examples of what you might want to use the different functions for.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>// anchor:header:append:anchorend

Table of contents
Introduction/Header

// anchor:part1:appendafter:anchorend

Lists
Table entries

// anchor:part2:nomerge:anchorend

Document Separators
adoc table definitions

// anchor:part3:override:anchorend

Anything that you only want once but changes from time to time

// anchor:footer:append:anchorend

Copyright Info
Imprint</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="_merging"><a class="anchor" href="#_merging"></a>Merging</h7>
<div class="paragraph">
<p>In this section you will see a comparison on what files look like before and after merging</p>
</div>
<div class="sect7">
<h8 id="_override"><a class="anchor" href="#_override"></a>override</h8>
<div class="listingblock">
<div class="title">Before</div>
<div class="content">
<pre>// anchor:part:override:anchorend
Lorem Ipsum</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Patch</div>
<div class="content">
<pre>// anchor:part:override:anchorend
Dolor Sit</pre>
</div>
</div>
<div class="listingblock">
<div class="title">After</div>
<div class="content">
<pre>// anchor:part:override:anchorend
Dolor Sit</pre>
</div>
</div>
</div>
<div class="sect7">
<h8 id="_appending"><a class="anchor" href="#_appending"></a>Appending</h8>
<div class="listingblock">
<div class="title">Before</div>
<div class="content">
<pre>// anchor:part:append:anchorend
Lorem Ipsum
// anchor:part2:appendafter:anchorend
Lorem Ipsum
// anchor:part3:appendbefore:anchorend
Lorem Ipsum</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Patch</div>
<div class="content">
<pre>// anchor:part:append:anchorend
Dolor Sit
// anchor:part2:appendafter:anchorend
Dolor Sit
// anchor:part3:appendbefore:anchorend
Dolor Sit</pre>
</div>
</div>
<div class="listingblock">
<div class="title">After</div>
<div class="content">
<pre>// anchor:part:append:anchorend
Lorem Ipsum
Dolor Sit
// anchor:part2:appendafter:anchorend
Lorem Ipsum
Dolor Sit
// anchor:part3:appendbefore:anchorend
Dolor Sit
Lorem Ipsum</pre>
</div>
</div>
</div>
<div class="sect7">
<h8 id="_newline"><a class="anchor" href="#_newline"></a>Newline</h8>
<div class="listingblock">
<div class="title">Before</div>
<div class="content">
<pre>// anchor:part:newline_append:anchorend
Lorem Ipsum
// anchor:part:append_newline:anchorend
Lorem Ipsum
(end of file)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Patch</div>
<div class="content">
<pre>// anchor:part:newline_append:anchorend
Dolor Sit
// anchor:part:append_newline:anchorend
Dolor Sit
(end of file)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">After</div>
<div class="content">
<pre>// anchor:part:newline_append:anchorend
Lorem Ipsum

Dolor Sit
// anchor:part:append_newline:anchorend
Lorem Ipsum
Dolor Sit

(end of file)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_error_list"><a class="anchor" href="#_error_list"></a>Error List</h6>
<div class="ulist">
<ul>
<li>
<p>If there are anchors in the text, but either base or patch do not start with one, the merging process will be aborted, as text might go missing this way.</p>
</li>
<li>
<p>Using <code>_newline</code> or <code>newline_</code> with <code>mergestrategies</code> that don&#8217;t support it , like <code>override</code>, will abort the merging process. See &lt;&lt;`mergestrategies`,Merge Strategies&gt;&gt; &#8594;2 for details.</p>
</li>
<li>
<p>Using undefined <code>mergestrategies</code> will abort the merging process.</p>
</li>
<li>
<p>Wrong anchor definitions, for example <code>anchor:${}:anchorend</code> will abort the merging process, see &lt;&lt;`anchordef`,Anchor Definition&gt;&gt; for details.</p>
</li>
</ul>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==JSON Plug-in
At the moment the plug-in can be used for merge generic JSON files depending on the merge strategy defined at the templates.</p>
</div>
</div>
<div class="sect5">
<h6 id="_merger_extensions_4"><a class="anchor" href="#_merger_extensions_4"></a>Merger extensions</h6>
<div class="paragraph">
<p>There are currently these merge strategies:</p>
</div>
<div class="paragraph">
<p><strong>Generic JSON Merge</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>merge strategy <code>jsonmerge</code>(add the new code respecting the existent is case of conflict)</p>
</li>
<li>
<p>merge strategy <code>jsonmerge_override</code> (add the new code overwriting the existent in case of conflict)</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>JsonArray&#8217;s</code> will be ignored / replaced in total</p>
</li>
<li>
<p><code>JsonObjects</code> in conflict will be processed recursively ignoring adding non existent elements.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_merge_process"><a class="anchor" href="#_merge_process"></a>Merge Process</h6>
<div class="sect6">
<h7 id="_generic_json_merging"><a class="anchor" href="#_generic_json_merging"></a>Generic JSON Merging</h7>
<div class="paragraph">
<p>The merge process will be:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add non existent JSON Objects from patch file to base file.</p>
</li>
<li>
<p>For existent object in both files, will add non existent keys from patch to base object. This process will be done recursively for all existent objects.</p>
</li>
<li>
<p>For JSON Arrays existent in both files, the arrays will be just concatenated.</p>
</li>
</ol>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==TypeScript Plug-in</p>
</div>
<div class="paragraph">
<p>The TypeScript Plug-in enables merging result TS files to existing ones. This plug-in is used at the moment for generate an Angular2 client with all CRUD functionalities enabled. The plug-in also generates i18n functionality just appending at the end of the word the <code>ES</code> or <code>EN</code> suffixes, to put into the developer knowledge that this words must been translated to the correspondent language. Currently, the generation of Angular2 client requires an <code>ETO</code> java object as input so, there is no need to implement an input reader for ts artifacts for the moment.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_trigger_extensions"><a class="anchor" href="#_trigger_extensions"></a>Trigger Extensions</h6>
<div class="paragraph">
<p>As for the Angular2 generation the input is a java object, the trigger expressions (including matchers and variable assignments) are implemented as <a href="https://github.com/devonfw/cobigen/wiki/cobigen-javaplugin#trigger-extension">Java</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_merger_extensions_5"><a class="anchor" href="#_merger_extensions_5"></a>Merger extensions</h6>
<div class="paragraph">
<p>This plugin uses the <a href="https://github.com/devonfw/ts-merger">TypeScript Merger</a> to merge files. There are currently two merge strategies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>merge strategy <code>tsmerge</code> (add the new code respecting the existing is case of conflict)</p>
</li>
<li>
<p>merge strategy <code>tsmerge_override</code> (add the new code overwriting the existent in case of conflict)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
The merge algorithm mainly handles the following <code>AST</code> nodes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>ImportDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>Will add non existent imports whatever the merge strategy is.</p>
</li>
<li>
<p>For different imports from same module, the import clauses will be merged.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import { a } from 'b';
import { c } from 'b';
//Result
import { a, c } from 'b';</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ClassDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>Adds non existent base properties from patch based on the name property.</p>
</li>
<li>
<p>Adds non existent base methods from patch based on the name signature.</p>
</li>
<li>
<p>Adds non existent annotations to class, properties and methods.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>PropertyDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>Adds non existent decorators.</p>
</li>
<li>
<p>Merge existent decorators.</p>
</li>
<li>
<p>With override strategy, the value of the property will be replaced by the patch value.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>MethodDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>With override strategy, the body will be replaced.</p>
</li>
<li>
<p>The parameters will be merged.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ParameterDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>Replace type and modifiers with override merge strategy, adding non existent from patch into base.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ConstructorDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>Merged in the same way as Method is.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>FunctionDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>Merged in the same way as Method is.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_input_reader"><a class="anchor" href="#_input_reader"></a>Input reader</h6>
<div class="paragraph">
<p>The TypeScript input reader is based on the one that the <a href="https://github.com/devonfw/ts-merger">TypeScript merger</a> uses. The current extensions are additional module fields giving from which library any entity originates.
<code>module: null</code> specifies a standard entity or type as <code>string</code> or <code>number</code>.</p>
</div>
<div class="sect6">
<h7 id="_object_model"><a class="anchor" href="#_object_model"></a>Object model</h7>
<div class="paragraph">
<p>To get a first impression of the created object after parsing, let us start with analyzing a small example, namely the parsing of a simple <a href="https://typeorm.io/#/">type-orm</a> model written in TypeScript.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Typescript hljs" data-lang="Typescript">import {Entity, PrimaryGeneratedColumn, Column} from "typeorm";

@Entity()
export class User {

    @PrimaryGeneratedColumn()
    id: number;

    @Column()
    firstName: string;

    @Column()
    lastName: string;

    @Column()
    age: number;

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The returned object has the following structure</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JSON hljs" data-lang="JSON">{
  "importDeclarations": [
    {
      "module": "typeorm",
      "named": [
        "Entity",
        "PrimaryGeneratedColumn",
        "Column"
      ],
      "spaceBinding": true
    }
  ],
  "classes": [
    {
      "identifier": "User",
      "modifiers": [
        "export"
      ],
      "decorators": [
        {
          "identifier": {
            "name": "Entity",
            "module": "typeorm"
          },
          "isCallExpression": true
        }
      ],
      "properties": [
        {
          "identifier": "id",
          "type": {
            "name": "number",
            "module": null
          },
          "decorators": [
            {
              "identifier": {
                "name": "PrimaryGeneratedColumn",
                "module": "typeorm"
              },
              "isCallExpression": true
            }
          ]
        },
        {
          "identifier": "firstName",
          "type": {
            "name": "string",
            "module": null
          },
          "decorators": [
            {
              "identifier": {
                "name": "Column",
                "module": "typeorm"
              },
              "isCallExpression": true
            }
          ]
        },
        {
          "identifier": "lastName",
          "type": {
            "name": "string",
            "module": null
          },
          "decorators": [
            {
              "identifier": {
                "name": "Column",
                "module": "typeorm"
              },
              "isCallExpression": true
            }
          ]
        },
        {
          "identifier": "age",
          "type": {
            "name": "number",
            "module": null
          },
          "decorators": [
            {
              "identifier": {
                "name": "Column",
                "module": "typeorm"
              },
              "isCallExpression": true
            }
          ]
        }
      ]
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we only consider the first level of the JSON response, we spot two lists of <code>imports</code> and <code>classes</code>, providing information about the only import statement and the only <strong>User</strong> class, respectively. Moving one level deeper we observe that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Every import statement is translated to an import declaration entry in the declarations list, containing the module name, as well as a list of entities imported from the given module.</p>
</li>
<li>
<p>Every class entry provides besides the class identifier, its decoration(s), modifier(s), as well as a list of properties that the original class contains.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that, for each given type, the module from which it is imported is also given as in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JSON hljs" data-lang="JSON">  "identifier": {
    "name": "Column",
    "module": "typeorm"
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returning to the general case, independently from the given TypeScript file, an object having the following Structure will be created.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>importDeclarations</code></strong>: A list of import statement as described above</p>
</li>
<li>
<p><strong><code>exportDeclarations</code></strong>: A list of export declarations</p>
</li>
<li>
<p><strong>classes</strong>: A list of classes extracted from the given file, where each entry is full of class specific fields, describing its properties and decorator for example.</p>
</li>
<li>
<p><strong>interfaces</strong>: A list of interfaces.</p>
</li>
<li>
<p><strong>variables</strong>: A list of variables.</p>
</li>
<li>
<p><strong>functions</strong>: A list of functions.</p>
</li>
<li>
<p><strong>enums</strong>: A list of enumerations.</p>
</li>
</ul>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==HTML Plug-in</p>
</div>
<div class="paragraph">
<p>The HTML Plug-in enables merging result HTML files to existing ones. This plug-in is used at the moment for generate an Angular2 client. Currently, the generation of Angular2 client requires an ETO java object as input so, there is no need to implement an input reader for ts artifacts for the moment.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_trigger_extensions_2"><a class="anchor" href="#_trigger_extensions_2"></a>Trigger Extensions</h6>
<div class="paragraph">
<p>As for the Angular2 generation the input is a java object, the trigger expressions (including matchers and variable assignments) are implemented as <a href="https://github.com/devonfw/cobigen/wiki/cobigen-javaplugin#trigger-extension">Java</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_merger_extensions_6"><a class="anchor" href="#_merger_extensions_6"></a>Merger extensions</h6>
<div class="paragraph">
<p>There are currently two merge strategies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>merge strategy <code>html-ng*</code> (add the new code respecting the existing is case of conflict)</p>
</li>
<li>
<p>merge strategy <code>html-ng*_override</code> (add the new code overwriting the existent in case of conflict)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The merging of two Angular2 files will be processed as follows:</p>
</div>
<div class="paragraph">
<p>The merge algorithm handles the following AST nodes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>md-nav-list</p>
</li>
<li>
<p>a</p>
</li>
<li>
<p>form</p>
</li>
<li>
<p>md-input-container</p>
</li>
<li>
<p>input</p>
</li>
<li>
<p>name (for name attribute)</p>
</li>
<li>
<p>ngIf</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Be aware, that the HTML merger is not generic and only handles the described tags needed for merging code of a basic Angular client implementation. For future versions, it is planned to implement a more generic solution.
</td>
</tr>
</table>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==OpenAPI Plug-in</p>
</div>
<div class="paragraph">
<p>The OpenAPI Plug-in enables the support for Swagger files that follows the <code>OpenAPI 3.0</code> standard as input for CobiGen. Until now, CobiGen was thought to follow a "code first" generation, with this plugin, now it can also follow the "contract first" strategy</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Code First</strong></p>
<div class="ulist">
<ul>
<li>
<p>Generating from a file with code (Java/XML code in our case)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Contract First</strong></p>
<div class="ulist">
<ul>
<li>
<p>Generation from a full definition file (Swagger in this case). This file contains all the information about entities, operations, etc&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are not a CobiGen developer, you will be more interested in <a href="#_usage">usage</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_trigger_extensions_3"><a class="anchor" href="#_trigger_extensions_3"></a>Trigger Extensions</h6>
<div class="paragraph">
<p>The OpenAPI Plug-in provides a new trigger for <code>Swagger OpenAPI 3.0</code> related inputs. It accepts different representations as inputs (see <a href="#OpenAPI-input-reader">OpenAPI input reader</a>) and provides additional matching and variable assignment mechanisms. The configuration in the <code>context.xml</code> for this trigger looks like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type <code>openapi</code></p>
<div class="listingblock">
<div class="title">Example of a OpenAPI trigger definition</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    ...
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger type enables OpenAPI elements as inputs.</p>
</div>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="_matcher_type"><a class="anchor" href="#_matcher_type"></a>Matcher type</h7>
<div class="paragraph">
<p>With the trigger you might define matchers, which restrict the input upon specific aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'element' &#8594; An object</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This trigger will be enabled if the element (Java Object) of the input file is and <code>EntityDef</code> (<code>value</code>).</p>
</div>
</div>
<div class="sect6">
<h7 id="_container_matcher_type_2"><a class="anchor" href="#_container_matcher_type_2"></a>Container Matcher type</h7>
<div class="paragraph">
<p>Additionally, the java plugin provides the ability to match packages (<code>containers</code>) as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'element'</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The container matcher matches elements as Java Objects, in this case will be always an <code>OpenAPIFile</code> object. (See <a href="cobigen-core_configuration#containermatcher-node.adoc"><code>containerMatcher</code> semantics</a> to get more information about <code>containerMatchers</code> itself.)</p>
</div>
</div>
<div class="sect6">
<h7 id="openapi-variable-assignment"><a class="anchor" href="#openapi-variable-assignment"></a>Variable Assignment types</h7>
<div class="paragraph">
<p>Furthermore, it provides the ability to extract information from each input for further processing in the templates. The values assigned by variable assignments will be made available in template and the <code>destinationPath</code> of context.xml through the namespace <code>variables.&lt;key&gt;</code>. The OpenAPI Plug-in currently provides two different mechanisms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'constant' &#8594; constant parameter</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    &lt;containerMatcher type="element" value="OpenApiFile"/&gt;
    &lt;matcher type="element" value="EntityDef"&gt;
        &lt;variableAssignment type="constant" key="rootPackage" value="com.capgemini.demo" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This variable assignment assigns the value of the given regular expression group number to the given <code>key</code>.
In this case, the constant type <code>variableAssignment</code> is used to specify the root package where the generate will place the files generated.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'extension' &#8594; Extraction of the info extensions and the extensions of each entity. (the tags that start with <code>"x-&#8230;&#8203;"</code>).</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">  &lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    &lt;containerMatcher type="element" value="OpenApiFile"/&gt;
    &lt;matcher type="element" value="EntityDef"&gt;
      &lt;variableAssignment type="extension" key="testingAttribute" value="x-test"/&gt;
      &lt;variableAssignment type="extension" key="rootPackage" value="x-rootpackage"/&gt;
      &lt;variableAssignment type="extension" key="globalVariable" value="x-global"/&gt;
    &lt;/matcher&gt;
  &lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The 'extension' variable assignment tries to find 'extensions' (tags that start with <code>"x-&#8230;&#8203;")</code> on the 'info'
part of your file and on the extensions of each entity. <code>value</code> is the extension that our plug-in will try to find on your OpenAPI file. The result will
be stored in the variable <code>key</code>.</p>
</div>
<div class="paragraph">
<p>As you will see on the figure below, there are two types of variables: The global ones, that are defined
on the 'info' part of the file, and the local ones, that are defined inside each entity.</p>
</div>
<div class="paragraph">
<p>Therefore, if you want to define the root package, then you will have to declare it on the 'info' part.
That way, all your entities will be generated under the same root package (e.g. com.devonfw.project).</p>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/howtos/openapi-gen/extensionPropertyFile.png"><img src="_images/images/howtos/openapi-gen/extensionPropertyFile.png" alt="Swagger at devon4j Project" height="520"></a></span></p>
</div>
<div class="paragraph">
<p>If no extension with that name was found, then an empty string will be assigned. In the case of not defining the root package, then the code will be generated into <code>src/main/java</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'property' &#8594; property of the Java Object</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    &lt;containerMatcher type="element" value="OpenApiFile"/&gt;
    &lt;matcher type="element" value="EntityDef"&gt;
        &lt;variableAssignment type="property" key="entityName" value="name" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The 'property' variable assignment tries to find the property <code>value</code> of the entities defined on the schema.
The value is assigned to the <code>key</code>. The current properties that you will able to get are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>ComponentDef <strong>component</strong></code>: It is an object that stores the configuration of an devon4j component. Its only
property is <code>List&lt;PathDef&gt; <strong>paths</strong></code> which contains the paths as the ones shown <a href="#paths">here</a>.</p>
</li>
<li>
<p><code>String <strong>componentName</strong></code>: Stores the name of the <code>x-component</code> tag for this entity.</p>
</li>
<li>
<p><code>String <strong>name</strong></code>: Name of this entity (as shown on the example above).</p>
</li>
<li>
<p><code>String <strong>description</strong></code>: Description of this entity.</p>
</li>
<li>
<p><code>List&lt;PropertyDef&gt; <strong>properties</strong></code>: List containing all the properties of this entity. <code>PropertyDef</code> is an object that has the next properties:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>String name.</p>
</li>
<li>
<p>String type.</p>
</li>
<li>
<p>String format.</p>
</li>
<li>
<p>String description.</p>
</li>
<li>
<p>Boolean <code>isCollection</code>.</p>
</li>
<li>
<p>Boolean <code>isEntity</code>.</p>
</li>
<li>
<p>Boolean required.</p>
</li>
<li>
<p>Map&lt;String, Object&gt; constraints</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>If no property with that name was found, then it will be set to <code>null</code>.</p>
</div>
</div>
<div class="sect6">
<h7 id="_full_trigger_configuration"><a class="anchor" href="#_full_trigger_configuration"></a>Full trigger configuration</h7>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    &lt;containerMatcher type="element" value="OpenApiFile"&gt;
    &lt;matcher type="element" value="EntityDef"&gt;
        &lt;variableAssignment type="constant" key="rootPackage" value="com.capgemini.demo" /&gt;
        &lt;variableAssignment type="property" key="component" value="componentName" /&gt;
        &lt;variableAssignment type="property" key="entityName" value="name" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="OpenAPI-input-reader"><a class="anchor" href="#OpenAPI-input-reader"></a>Input reader</h6>
<div class="paragraph">
<p>The CobiGen OpenAPI Plug-in implements an input reader for <code>OpenAPI 3.0</code> files. The XML input reader will create the following object model for template creation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>model</strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>header</strong> (<code>HeaderDef</code> :: Definition of the header found at the top of the file)</p>
</li>
<li>
<p><strong>name</strong> ('String' :: Name of the current Entity)</p>
</li>
<li>
<p><strong><code>componentName</code></strong> ('String' :: name of the component the entity belongs to)</p>
</li>
<li>
<p><strong>component</strong> (<code>ComponentDef</code> :: Full definition of the component that entity belongs to)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: Description of the Entity)</p>
</li>
<li>
<p><strong>properties</strong> (<code>List&lt;PropertyDef&gt;</code> :: List of properties the entity has)</p>
</li>
<li>
<p><strong><code>relationShips</code></strong> (<code>List&lt;RelationShip&gt;</code> :: List of Relationships the entity has)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>HeaderDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>info</strong> (<code>InfoDef</code> :: Definition of the info found in the header)</p>
</li>
<li>
<p><strong>servers</strong> (<code>List&lt;ServerDef&gt;</code> :: List of servers the specification uses)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>InfoDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>title</strong> ('String' :: The title of the specification)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: The description of the specification)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ServerDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>URI</code></strong> ('String' :: String representation of the Server location)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: description of the server)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ComponentDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>paths</strong> (<code>List&lt;PathDef&gt;</code> :: List of services for this component)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>PropertyDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> ('String' :: Name of the property)</p>
</li>
<li>
<p><strong>type</strong> ('String' :: type of the property)</p>
</li>
<li>
<p><strong>format</strong> ('String' :: format of the property (i.e. int64))</p>
</li>
<li>
<p><strong><code>isCollection</code></strong> (<code>boolean</code> :: <strong>true</strong> if the property is a collection, false by default)</p>
</li>
<li>
<p><strong><code>isEntity</code></strong> (<code>boolean</code> :: <strong>true</strong> if the property refers to another entity, false by default)</p>
</li>
<li>
<p><strong><code>sameComponent</code></strong> (<code>boolean</code> :: <strong>true</strong> if the entity that the property refers to belongs to the same component, false by default)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: Description of the property)</p>
</li>
<li>
<p><strong>required</strong> (<code>boolean</code> :: <strong>true</strong> if the property is set as required)</p>
</li>
<li>
<p><strong>constraints</strong> ('Map&lt;String, Object&gt;')</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>RelationShip</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>type</strong> ('String' :: type of the relationship (<code>OneToOne</code>, <code>ManyToMany</code>, etc&#8230;&#8203;))</p>
</li>
<li>
<p><strong>entity</strong> ('String' :: destination entity name)</p>
</li>
<li>
<p><strong><code>sameComponent</code></strong> (<code>boolean</code> :: <strong>true</strong> if the destination entity belongs to the same component of the source entity, false by default)</p>
</li>
<li>
<p><strong><code>unidirectional</code></strong> (<code>boolean</code> :: <strong>true</strong> if the relationship is unidirectional, false by default)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>PathDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>rootComponent</code></strong> ('String' :: the first segment of the path)</p>
</li>
<li>
<p><strong>version</strong> ('String' :: version of the service)</p>
</li>
<li>
<p><strong><code>pathURI</code></strong> ('String' :: URI of the path, the segment after the version)</p>
</li>
<li>
<p><strong>operations</strong> (<code>List&lt;OperationDef&gt;</code> :: List of operations for this path)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>OperationDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>type</strong> ('String' :: type of the operation (GET, PUT, etc&#8230;&#8203;))</p>
</li>
<li>
<p><strong>parameters</strong> (<code>List&lt;ParameterDef&gt;</code> :: List of parameters)</p>
</li>
<li>
<p><strong><code>operationId</code></strong> ('String' :: name of the operation prototype)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: <code>JavaDoc</code> Description of the operation)</p>
</li>
<li>
<p><strong>summary</strong> (<code>List&lt;PropertyDef&gt;</code> :: <code>JavaDoc</code> operation Summary)</p>
</li>
<li>
<p><strong>tags</strong> ('List&lt;String&gt;' :: List of different tags)</p>
</li>
<li>
<p><strong>responses</strong> (<code>List&lt;ResponseDef&gt;</code> :: Responses of the operation)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ParameterDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>isSearchCriteria</code></strong> (<code>boolean</code> :: <strong>true</strong> if the response is an <code>SearchCriteria</code> object)</p>
</li>
<li>
<p><strong><code>inPath</code></strong> (<code>boolean</code> :: <strong>true</strong> if this parameter is contained in the request path)</p>
</li>
<li>
<p><strong><code>inQuery</code></strong> (<code>boolean</code> :: <strong>true</strong> if this parameter is contained in a query)</p>
</li>
<li>
<p><strong><code>isBody</code></strong> (<code>boolean</code> :: <strong>true</strong> if this parameter is a response body)</p>
</li>
<li>
<p><strong><code>inHeader</code></strong> (<code>boolean</code> :: <strong>true</strong> if this parameter is contained in a header)</p>
</li>
<li>
<p><strong><code>mediaType</code></strong> ('String' :: String representation of the media type of the parameter)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ResponseDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>isArray</code></strong> (<code>boolean</code> :: <strong>true</strong> if the type of the response is an Array)</p>
</li>
<li>
<p><strong><code>isPaginated</code></strong> (<code>boolean</code> :: <strong>true</strong> if the type of the response is paginated)</p>
</li>
<li>
<p><strong><code>isVoid</code></strong> (<code>boolean</code> :: <strong>true</strong> if there is no type/an empty type)</p>
</li>
<li>
<p><strong><code>isEntity</code></strong> (<code>boolean</code> :: <strong>true</strong> if the type of the response is an Entity)</p>
</li>
<li>
<p><strong><code>entityRef</code></strong> (<code>EntityDef</code> :: Incomplete <code>EntityDef</code> containing the name and properties of the referenced Entity)</p>
</li>
<li>
<p><strong>type</strong> ('String' :: String representation of the attribute&#8217;s value)</p>
</li>
<li>
<p><strong>code</strong> ('String' :: String representation of the HTTP status code)</p>
</li>
<li>
<p><strong><code>mediaTypes</code></strong> ('List&lt;String&gt;' :: List of media types that can be returned)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: Description of the response)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_merger_extensions_7"><a class="anchor" href="#_merger_extensions_7"></a>Merger extensions</h6>
<div class="paragraph">
<p>This plugin only provides an input reader, there is no support for OpenAPI merging. Nevertheless, the files generated from an OpenAPI file will be Java, XML, JSON, TS, etc&#8230;&#8203; so,
for each file to be generated defined at templates.xml, must set the <code>mergeStrategy</code> for the specific language (<code>javamerge</code>, <code>javamerge_override</code>, <code>jsonmerge</code>, etc&#8230;&#8203;)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;templates&gt;
    ...
    &lt;templateExtension ref="${variables.entityName}.java" mergeStrategy="javamerge"/&gt;
    ...
    &lt;templateExtension ref="${variables.entityName}dataGrid.component.ts" mergeStrategy="tsmerge"/&gt;
    ...
    &lt;templateExtension ref="en.json" mergeStrategy="jsonmerge"/&gt;
&lt;/templates&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_usage"><a class="anchor" href="#_usage"></a>Usage</h6>
<div class="sect6">
<h7 id="_writing_openapi_3_0_contract_file"><a class="anchor" href="#_writing_openapi_3_0_contract_file"></a>Writing <code>OpenAPI 3.0</code> contract file</h7>
<div class="paragraph">
<p>The Swagger file must follow the <code>OpenAPI 3.0</code> standard to be readable by CobiGen, otherwise and error will be thrown.
A full documentation about how to follow this standard can be found <a href="https://swagger.io/docs/specification/about/">Swagger3 Docs</a>.</p>
</div>
<div class="paragraph">
<p>The Swagger file must be at the core folder of your devon4j project, like shown below:</p>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/howtos/openapi-gen/openapi_howto1.png"><img src="_images/images/howtos/openapi-gen/openapi_howto1.png" alt="Swagger at devon4j Project" width="450"></a></span></p>
</div>
<div class="paragraph">
<p>To be compatible with CobiGen and devon4j, it must follow some specific configurations. This configurations allows us to avoid redundant definitions as <code>SearchCriteria</code> and <code>PaginatedList</code> objects are used at the services definitions.</p>
</div>
</div>
<div class="sect6">
<h7 id="paths"><a class="anchor" href="#paths"></a>Paths</h7>
<div class="ulist">
<ul>
<li>
<p>Just adding the <em>tags</em> property at the end of the service definitions with the items <em>`SearchCriteria`</em> and/or <em>paginated</em> put into CobiGen knowledge that an standard devon4j <code>SearchCriteria</code> and/or <code>PaginateListTo</code> object must be generated. That way, the Swagger file will be easier to write and even more understandable.</p>
</li>
<li>
<p>The path must start with the component name, and define an <code>x-component</code> tag with the component name. That way this service will be included into the component services list.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">  /componentnamemanagement/v1/entityname/customOperation/:
    x-component: componentnamemanagement
    post:
      summary: 'Summary of the operation'
      description: Description of the operation.
      operationId: customOperation
      responses:
        '200':
          description: Description of the response.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/EntityName'
      requestBody:
        $ref: '#/components/requestBodies/EntityName'
      tags:
        - searchCriteria
        - paginated</code></pre>
</div>
</div>
<div class="paragraph">
<p>That way, CobiGen will be able to generate the endpoint (REST service) <code>customOperation</code> on <code>componentmanagement</code>. If you do not specify the component to generate to (the <code>x-component</code> tag) then this service will not be taken into account for generation.</p>
</div>
</div>
<div class="sect6">
<h7 id="service"><a class="anchor" href="#service"></a>Service based generation</h7>
<div class="paragraph">
<p>In previous CobiGen versions, we were able to generate code from a contract-first OpenAPI specification only when we defined components like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">components:
    schemas:
        Shop:
          x-component: shopmanagement
          description: Entity definition of Shop
          type: object
          properties:
            shopExample:
              type: string
              maxLength: 100
              minLength: 5
              uniqueItems: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>We could not generate services without the definition of those components.</p>
</div>
<div class="paragraph">
<p>In our current version, we have overcome it, so that now we are able to generate all the services independently. You just need to add an <code>x-component</code> tag with the name of the component that will make use of that service. See <a href="#paths">here</a>.</p>
</div>
<div class="paragraph">
<p>An small OpenAPI example defining only services can be found below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">openapi: 3.0.0
servers:
  - url: 'https://localhost:8081/server/services/rest'
    description: Just some data
info:
  title: Devon Example
  description: Example of a API definition
  version: 1.0.0
  x-rootpackage: com.capgemini.spoc.openapi
paths:
  /salemanagement/v1/sale/{saleId}:
    x-component: salemanagement
    get:
      operationId: findSale
      parameters:
        - name: saleId
          in: path
          required: true
          description: The id of the pet to retrieve
          schema:
            type: string
      responses:
        '200':
          description: Any
  /salemanagement/v1/sale/{bla}:
    x-component: salemanagement
    get:
      operationId: findSaleBla
      parameters:
        - name: bla
          in: path
          required: true
          schema:
            type: integer
            format: int64
            minimum: 10
            maximum: 200
      responses:
        '200':
          description: Any</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, the increment that you need to select for generating those services is <em>Crud devon4ng Service based Angular</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/howtos/openapi-gen/service_based.png"><img src="_images/images/howtos/openapi-gen/service_based.png" alt="Service based generation" width="450"></a></span></p>
</div>
</div>
<div class="sect6">
<h7 id="_full_example"><a class="anchor" href="#_full_example"></a>Full example</h7>
<div class="paragraph">
<p>This example yaml file can be download from <a href="files/devonfw.yml">here</a>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
As you will see on the file, "x-component" tags are obligatory if you want to generate components (entities). They have to be defined for each one.
In addition, you will find the global variable "x-rootpackage" that are explained &lt;&lt;,here&gt;&gt;.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">openapi: 3.0.0
servers:
  - url: 'https://localhost:8081/server/services/rest'
    description: Just some data
info:
  title: Devon Example
  description: Example of a API definition
  version: 1.0.0
  x-rootpackage: com.devonfw.angular.test
paths:
  /shopmanagement/v1/shop/{shopId}:
    x-component: shopmanagement
    get:
      operationId: findShop
      parameters:
        - name: shopId
          in: path
          required: true
          schema:
            type: integer
            format: int64
            minimum: 0
            maximum: 50
      responses:
        '200':
          description: Any
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Shop'
            text/plain:
              schema:
                type: string
        '404':
          description: Not found
  /salemanagement/v1/sale/{saleId}:
    x-component: salemanagement
    get:
      operationId: findSale
      parameters:
        - name: saleId
          in: path
          required: true
          description: The id of the pet to retrieve
          schema:
            type: string
      responses:
        '200':
          description: Any
  /salemanagement/v1/sale/:
    x-component: salemanagement
    post:
      responses:
        '200':
          description: Any
      requestBody:
        $ref: '#/components/requestBodies/SaleData'
      tags:
       - searchCriteria
  /shopmanagement/v1/shop/new:
    x-component: shopmanagement
    post:
      responses:
       '200':
          description: Any
      requestBody:
        $ref: '#/components/requestBodies/ShopData'
components:
    schemas:
        Shop:
          x-component: shopmanagement
          description: Entity definition of Shop
          type: object
          properties:
            shopExample:
              type: string
              maxLength: 100
              minLength: 5
              uniqueItems: true
            sales:
              type: array # Many to One relationship
              items:
                $ref: '#/components/schemas/Sale'
        Sale:
          x-component: salemanagement
          description: Entity definition of Shop
          type: object
          properties:
            saleExample:
              type: number
              format: int64
              maximum: 100
              minimum: 0
          required:
            - saleExample

    requestBodies:
        ShopData:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Shop'
          required: true
        SaleData:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Sale'
          required: true</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cobigen_cli"><a class="anchor" href="#_cobigen_cli"></a>CobiGen CLI</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="paragraph">
<p>==CobiGen CLI</p>
</div>
<div class="paragraph">
<p>The command line interface (CLI) for CobiGen enables the generation of code using few commands. This feature allows us to decouple CobiGen from Eclipse.</p>
</div>
<div class="sect4">
<h5 id="_install_cobigen_cli"><a class="anchor" href="#_install_cobigen_cli"></a>Install CobiGen CLI</h5>
<div class="paragraph">
<p>In order to install the CobiGen CLI you will need to use the <a href="https://github.com/devonfw/ide">devonfw/ide</a>. In a console run <code>devon cobigen</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_commands_and_options"><a class="anchor" href="#_commands_and_options"></a>Commands and options</h5>
<div class="paragraph">
<p>Using the following command and option you will be able to customize your generation as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cobigen, cg</code>:  Main entry point of the CLI. If no arguments are passed, man page will be printed.</p>
</li>
<li>
<p><code>[generate, g]</code>: Command used for code generation.</p>
<div class="ulist">
<ul>
<li>
<p><code>InputGlob</code>: Glob pattern of the input file or the whole path of the input file from which the code will be generated.</p>
</li>
<li>
<p><code>&lt; --increment, -i &gt;</code>  : Specifies an increment ID to be generated. You can also search increments by name and CobiGen will output the resultant list. If an exact match found, code generation will happen.</p>
</li>
<li>
<p><code>&lt; --template, -t &gt;</code> : specifies a template ID to be generated. You can also search templates by name and CobiGen will output the resultant list.</p>
</li>
<li>
<p><code>&lt; --outputRootPath, -out &gt;</code>: The project file path in which you want to generate your code. If no output path is given, CobiGen will use the project of your input file.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>[adapt-templates, a]</code>: Generates a new templates folder next to the CobiGen CLI and stores its location inside a configuration file. After executing this command, the CLI will attempt to use the specified Templates folder.</p>
</li>
<li>
<p><code>&lt; --verbose, -v &gt;</code> : Prints debug information, verbose log.</p>
</li>
<li>
<p><code>&lt; --help, -h &gt;</code> : Prints man page.</p>
</li>
<li>
<p><code>&lt; update, u&gt;</code> : This command compare the artificial pom plug-ins version with central latest version available and user can update any  outdated plug-ins version .</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_cli_execution_steps"><a class="anchor" href="#_cli_execution_steps"></a>CLI Execution steps:</h5>
<div class="paragraph">
<p>CobiGen CLI is installed inside your devonfw distribution. In order to execute it follow the next steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run <code>console.bat</code>, this will open a console.</p>
</li>
<li>
<p>Execute <code>cobigen</code> or <code>cg</code> and the man page should be printed.</p>
</li>
<li>
<p>Use a valid CobiGen input file and run <code>cobigen generate &lt;pathToInputFile&gt;</code>. <strong>Note:</strong> On the first execution of the CLI, CobiGen will download all the needed dependencies, please be patient.</p>
</li>
<li>
<p>A list of increments will be printed so that you can start the generation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Preview of the man page for <code>generate</code> command:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/CLI/WithoutParam.PNG"><img src="_images/images/howtos/CLI/WithoutParam.PNG" alt="Generation path"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_examples"><a class="anchor" href="#_examples"></a>Examples</h5>
<div class="paragraph">
<p>A selection of commands that you can use with the CLI:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cobigen generate foo\bar\EmployeeEntity.java</code>: As no output path has been defined, CobiGen will try to find the <code>pom.xml</code> of the current project in order to set the generation root path.</p>
</li>
<li>
<p><code>cobigen generate foo\bar\*.java --out other\project</code>: Will retrieve all the Java files on that input folder and generate the code on the path specified by <code>--out</code>.</p>
</li>
<li>
<p><code>cg g foo\bar\webServices.yml --increment TO</code>: Performs a string search using <code>TO</code> and will print the closest increments like in the following image:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/CLI/selectedIncr.PNG"><img src="_images/images/howtos/CLI/selectedIncr.PNG" alt="Generation path"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cg g foo\bar\webServices.yml -i 1,4,6</code>: Directly generates increments with IDs <code>1</code>, <code>4</code> and <code>6</code>. CobiGen will not request you any other input.</p>
</li>
<li>
<p><code>cg a</code>: Downloads the latest CobiGen_Templates and unpacks them next to the CLI. CobiGen will from now on use these unpacked Templates for generation.</p>
</li>
<li>
<p><code>cg a -cl C:\my\custom\location</code>: Downloads the latest CobiGen_Templates and unpacks them in <code>C:\my\custom\location</code>. CobiGen will from now on use these unpacked Templates for generation.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_cli_update_command"><a class="anchor" href="#_cli_update_command"></a>CLI update command</h5>
<div class="paragraph">
<p>Example of Update Command :</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/CLI/updateCommand.PNG"><img src="_images/images/howtos/CLI/updateCommand.PNG" alt="Generation path"></a>
</div>
</div>
<div class="paragraph">
<p>Select the plug-ins which you want to update like below :</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/CLI/updatePlugin.PNG"><img src="_images/images/howtos/CLI/updatePlugin.PNG" alt="Generation path"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_cli_custom_templates"><a class="anchor" href="#_cli_custom_templates"></a>CLI custom templates</h5>
<div class="paragraph">
<p>To use custom templates, it&#8217;s necessary to set up a custom configuration path as described <a href="cobigen-core_configuration">here</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_troubleshooting"><a class="anchor" href="#_troubleshooting"></a>Troubleshooting</h5>
<div class="paragraph">
<p>When generating code from a Java file, CobiGen makes use of Java reflection for generating templates. In order to do that, the CLI needs to find the compiled source code of your project.</p>
</div>
<div class="paragraph">
<p>If you find an error like <code>Compiled class foo\bar\EmployeeEntity.java has not been found</code>, it means you need to run <code>mvn clean install</code> on the input project so that a new <code>target</code> folder gets created with the needed compiled sources.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_maven_build_integration"><a class="anchor" href="#_maven_build_integration"></a>Maven Build Integration</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="paragraph">
<p>==Maven Build Integration</p>
</div>
<div class="paragraph">
<p>For maven integration of CobiGen you can include the following build plugin into your build:</p>
</div>
<div class="listingblock">
<div class="title">Build integration of CobiGen</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
      &lt;artifactId&gt;cobigen-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;VERSION-YOU-LIKE&lt;/version&gt;
      &lt;executions&gt;
        &lt;execution&gt;
          &lt;id&gt;cobigen-generate&lt;/id&gt;
          &lt;phase&gt;generate-resources&lt;/phase&gt;
          &lt;goals&gt;
            &lt;goal&gt;generate&lt;/goal&gt;
          &lt;/goals&gt;
        &lt;/execution&gt;
      &lt;/executions&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Available goals</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>generate</code>: Generates contents configured by the standard non-compiled configuration folder. Thus generation can be controlled/configured due to an location URI of the configuration and template or increment ids to be generated for a set of inputs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Available phases</strong> are all phases, which already provide compiled sources such that CobiGen can perform reflection on it. Thus possible phases are for example package, site.</p>
</div>
<div class="sect4">
<h5 id="_provide_template_set"><a class="anchor" href="#_provide_template_set"></a>Provide Template Set</h5>
<div class="paragraph">
<p>For generation using the CobiGen maven plug-in, the CobiGen configuration can be provided in two different styles:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>By a <code>configurationFolder</code>, which should be available on the file system whenever you are running the generation. The value of <code>configurationFolder</code> should correspond to the maven file path syntax.</p>
<div class="listingblock">
<div class="title">Provide CobiGen configuration by configuration folder (file)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      ...
      &lt;configuration&gt;
        &lt;configurationFolder&gt;cobigen-templates&lt;/configurationFolder&gt;
      &lt;/configuration&gt;
       ...
     &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>By maven dependency, whereas the maven dependency should stick on the same conventions as the configuration folder. This explicitly means that it should contain non-compiled resources as well as the <code>context.xml</code> on top-level.</p>
<div class="listingblock">
<div class="title">Provide CobiGen configuration by maven dependency (jar)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      ...
      &lt;dependencies&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
          &lt;artifactId&gt;templates-XYZ&lt;/artifactId&gt;
          &lt;version&gt;VERSION-YOU-LIKE&lt;/version&gt;
        &lt;/dependency&gt;
      &lt;/dependencies&gt;
      ...
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We currently provide a generic deployed version of the templates on the devonfw-nexus for Register Factory (<code>&lt;artifactId&gt;cobigen-templates-rf&lt;/artifactId&gt;</code>) and for the devonfw itself (<code>&lt;artifactId&gt;cobigen-templates-devonfw&lt;/artifactId&gt;</code>).</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="_build_configuration"><a class="anchor" href="#_build_configuration"></a>Build Configuration</h5>
<div class="paragraph">
<p>Using the following configuration you will be able to customize your generation as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;destinationRoot&gt;</code> specifies the root directory the relative <code>destinationPath</code> of <a href="cobigen-core_configuration#Templates-configuration.adoc">CobiGen templates configuration</a> should depend on. <em>Default ${basedir}</em></p>
</li>
<li>
<p><code>&lt;inputPackage&gt;</code> declares a package name to be used as input for batch generation. This refers directly to the CobiGen Java Plug-in <a href="cobigen-javaplugin#<code>ContainerMatcher</code>-types.adoc">container matchers of type package</a> configuration.</p>
</li>
<li>
<p><code>&lt;inputFile&gt;</code> declares a file to be used as input. The CobiGen maven plug-in will try to parse this file to get an appropriate input to be interpreted by any CobiGen plug-in.</p>
</li>
<li>
<p><code>&lt;increment&gt;</code> specifies an <a href="cobigen-core_configuration#increment-node.adoc">increment</a> ID to be generated. You can specify one single increment with content <code>ALL</code> to generate all increments matching the input(s).</p>
</li>
<li>
<p><code>&lt;template&gt;</code> specifies a <a href="cobigen-core_configuration#increment-node.adoc">template</a> ID to be generated. You can specify one single template with content <code>ALL</code> to generate all templates matching the input(s).</p>
</li>
<li>
<p><code>&lt;forceOverride&gt;</code> specifies an overriding behavior, which enables non-mergeable resources to be completely rewritten by generated contents. For mergeable resources this flag indicates, that conflicting fragments during merge will be replaced by generated content. <em>Default: false</em></p>
</li>
<li>
<p><code>&lt;failOnNothingGenerated&gt;</code> specifies whether the build should fail if the execution does not generate anything.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Example for a simple build configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
       ...
      &lt;configuration&gt;
        &lt;destinationRoot&gt;${basedir}&lt;/destinationRoot&gt;
        &lt;inputPackages&gt;
          &lt;inputPackage&gt;package.to.be.used.as.input&lt;/inputPackage&gt;
        &lt;/inputPackages&gt;
        &lt;inputFiles&gt;
          &lt;inputFile&gt;path/to/file/to/be/used/as/input&lt;/inputFile&gt;
        &lt;/inputFiles&gt;
        &lt;increments&gt;
          &lt;increment&gt;IncrementID&lt;/increment&gt;
        &lt;/increments&gt;
        &lt;templates&gt;
          &lt;template&gt;TemplateID&lt;/template&gt;
        &lt;/templates&gt;
        &lt;forceOverride&gt;false&lt;/forceOverride&gt;
      &lt;/configuration&gt;
        ...
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_plugin_injection_since_v3"><a class="anchor" href="#_plugin_injection_since_v3"></a>Plugin Injection Since v3</h5>
<div class="paragraph">
<p>Since version 3.0.0, the <a href="cobigen-core_configuration#plugin-mechanism.adoc">plug-in mechanism</a> has changed to support modular releases of the CobiGen plug-ins. Therefore, you need to add all plug-ins to be used for generation. Take the following example to get the idea:</p>
</div>
<div class="listingblock">
<div class="title">Example of a full configuration including plugins</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
      &lt;artifactId&gt;cobigen-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;VERSION-YOU-LIKE&lt;/version&gt;
      &lt;executions&gt;
        ...
      &lt;/executions&gt;
      &lt;configuration&gt;
        ...
      &lt;/configuration&gt;
      &lt;dependencies&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;groupId&gt;
          &lt;artifactId&gt;templates-devon4j&lt;/artifactId&gt;
          &lt;version&gt;2.0.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
          &lt;artifactId&gt;tempeng-freemarker&lt;/artifactId&gt;
          &lt;version&gt;1.0.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
          &lt;artifactId&gt;javaplugin&lt;/artifactId&gt;
          &lt;version&gt;1.6.0&lt;/version&gt;
        &lt;/dependency&gt;
      &lt;/dependencies&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_a_full_example"><a class="anchor" href="#_a_full_example"></a>A full example</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A complete maven configuration example</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
      &lt;artifactId&gt;cobigen-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;6.0.0&lt;/version&gt;
      &lt;executions&gt;
        &lt;execution&gt;
          &lt;id&gt;generate&lt;/id&gt;
          &lt;phase&gt;package&lt;/phase&gt;
          &lt;goals&gt;
            &lt;goal&gt;generate&lt;/goal&gt;
          &lt;/goals&gt;
        &lt;/execution&gt;
      &lt;/executions&gt;
      &lt;configuration&gt;
        &lt;inputFiles&gt;
          &lt;inputFile&gt;src/main/java/io/github/devonfw/cobigen/generator/dataaccess/api/InputEntity.java&lt;/inputFile&gt;
        &lt;/inputFiles&gt;
        &lt;increments&gt;
          &lt;increment&gt;dataaccess_infrastructure&lt;/increment&gt;
          &lt;increment&gt;daos&lt;/increment&gt;
        &lt;/increments&gt;
        &lt;failOnNothingGenerated&gt;false&lt;/failOnNothingGenerated&gt;
      &lt;/configuration&gt;
      &lt;dependencies&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
          &lt;artifactId&gt;templates-devon4j&lt;/artifactId&gt;
          &lt;version&gt;2.0.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
          &lt;artifactId&gt;tempeng-freemarker&lt;/artifactId&gt;
          &lt;version&gt;2.0.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
          &lt;artifactId&gt;javaplugin&lt;/artifactId&gt;
          &lt;version&gt;1.6.0&lt;/version&gt;
        &lt;/dependency&gt;
      &lt;/dependencies&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_eclipse_integration"><a class="anchor" href="#_eclipse_integration"></a>Eclipse Integration</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="paragraph">
<p>==Installation</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Remark:</strong> CobiGen is preinstalled in the <a href="https://github.com/devonfw/devon-ide">devonfw/devon-ide</a>.</p>
</div>
</blockquote>
</div>
<div class="sect4">
<h5 id="_preconditions"><a class="anchor" href="#_preconditions"></a>Preconditions</h5>
<div class="ulist">
<ul>
<li>
<p>Eclipse 4.x</p>
</li>
<li>
<p>Java 7 Runtime (for starting eclipse with CobiGen). This is independent from the target version of your developed code.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_installation_steps"><a class="anchor" href="#_installation_steps"></a>Installation steps</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the eclipse installation dialog<br>
menu bar &#8594; <em>Help</em> &#8594; <em>Install new Software&#8230;&#8203;</em></p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/installation/01-install-new-software.png" alt="01 install new software"></span></p>
</div>
</li>
<li>
<p>Open CobiGen&#8217;s update site<br>
Insert the update site of your interest into the filed <em>Work with</em> and press <em>Add &#8230;&#8203;</em><br>
Unless you know what you are doing we recommend you install every plugin as shown in the picture below.</p>
<div class="ulist">
<ul>
<li>
<p>Stable releases: <a href="https://devonfw.com/cobigen/updatesite/stable/" class="bare">https://devonfw.com/cobigen/updatesite/stable/</a><br>
<span class="image"><img src="_images/images/howtos/installation/02-select-update-site.png" alt="02 select update site"></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>Follow the installation wizard<br>
Select <em>CobiGen Eclipse Plug-in</em> &#8594; <em>Next</em> &#8594; <em>Next</em> &#8594; accept the license &#8594; <em>Finish</em> &#8594; <em>OK</em> &#8594; <em>Yes</em></p>
</li>
<li>
<p>Once installed, a new menu entry named "CobiGen" will show up in the <em>Package Explorer&#8217;s</em> context menu. In the sub menu there will the <em>Generate&#8230;&#8203;</em> command, which may ask you to update the templates, and then you can start the generation wizard of CobiGen. You can adapt the templates by clicking on <em>Adapt Templates</em> which will give you the possibility to import the <em>CobiGen_Templates</em> automatically so that you can modified them.</p>
</li>
<li>
<p>Checkout (clone) your project&#8217;s templates folder or use the current templates released with CobiGen (<a href="https://github.com/devonfw/cobigen/tree/master/cobigen-templates" class="bare">https://github.com/devonfw/cobigen/tree/master/cobigen-templates</a>) and then choose Import -&gt; General -&gt; Existing Projects into Workspace to import the templates into your workspace.<br></p>
</li>
<li>
<p>Now you can start generating. To get an introduction of CobiGen try the devon4j templates and work on the devon4j sample application. There you might want to start with Entity objects as a selection to run CobiGen with, which will give you a good overview of what CobiGen can be used for right out of the box in devon4j based development. If you need some more introduction in how to come up with your templates and increments, please be referred to the documentation of the <a href="cobigen-core_configuration#context-configuration.adoc">context configuration</a> and the <a href="cobigen-core_configuration#templates-configuration">templates configuration</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Dependent on your context configuration menu entry <em>Generate&#8230;&#8203;</em> may be gray out or not. See  for more information about valid selections for generation.</p>
</div>
</div>
<div class="sect4">
<h5 id="_updating"><a class="anchor" href="#_updating"></a>Updating</h5>
<div class="paragraph">
<p>In general updating CobiGen for eclipse is done via the update mechanism of eclipse directly, as shown on image below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/installation/03-update-software.png" alt="03 update software"></span></p>
</div>
<div class="paragraph">
<p>Upgrading eclipse CobiGen plug-in to v3.0.0 needs some more attention of the user due to a changed plug-in architecture of CobiGen&#8217;s <a href="cobigen-core_configuration#plugin-mechanism.adoc">core module</a> and the eclipse integration. Eventually, we were able to provide any plug-in of CobiGen separately as its own eclipse bundle (fragment), which is automatically discovered by the main CobiGen Eclipse plug-in after installation.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Usage</p>
</div>
<div class="paragraph">
<p>CobiGen has two different generation modes depending on the input selected for generation. The first one is the <em>simple mode</em>, which will be started if the input contains only one input artifact, e.g. for Java an input artifact currently is a Java file. The second one is the <em>batch  mode</em>, which will be started if the input contains multiple input artifacts, e.g. for Java this means a list of files. In general this means also that the batch mode might be started when selecting complex models as inputs, which contain multiple input artifacts. The latter scenario has only been covered in the research group,yet.</p>
</div>
</div>
<div class="sect4">
<h5 id="_simple_mode"><a class="anchor" href="#_simple_mode"></a>Simple Mode</h5>
<div class="paragraph">
<p>Selecting the menu entry <em>Generate&#8230;&#8203;</em> the generation wizard will be opened:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/generate_wizard_page1.png" alt="generate wizard page1"></span></p>
</div>
<div class="paragraph">
<p>The left side of the wizard shows all available increments, which can be selected to be generated. Increments are a container like concept encompassing multiple files to be generated, which should result in a semantically closed generation output.
On the right side of the wizard all files are shown, which might be effected by the generation - dependent on the increment selection of files on the left side. The type of modification of each file will be encoded into following color scheme if the files are selected for generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>green:</strong> files, which are currently non-existent in the file system. These files will be created during generation</p>
</li>
<li>
<p><strong>yellow:</strong> files, which are currently existent in the file system and which are configured to be merged with generated contents.</p>
</li>
<li>
<p><strong>red:</strong> files, which are currently existent in the file system. These files will be overwritten if manually selected.</p>
</li>
<li>
<p><strong>no color:</strong> files, which are currently existent in the file system. Additionally files, which were deselected and thus will be ignored during generation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Selecting an increment on the left side will initialize the selection of all shown files to be generated on the right side, whereas green and yellow categorized files will be selected initially. A manual modification of the pre-selection can be performed by switching to the customization tree using the <em>Customize</em> button on the right lower corner.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Optional:</strong> If you want to customize the generation object model of a Java input class, you might continue with the <em>Next &gt;</em> button instead of finishing the generation wizard. The next generation wizard page is currently available for Java file inputs and lists all non-static fields of the input. deselecting entries will lead to an adapted object model for generation, such that deselected fields will be removed in the object model for generation. By default all fields will be included in the object model.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Using the <em>Finish</em> button, the generation will be performed. Finally, CobiGen runs the eclipse internal <em>organize imports</em> and <em>format source code</em> for all generated sources and modified sources. Thus it is possible, that---especially <em>organize imports</em> opens a dialog if some types could not be determined automatically. This dialog can be easily closed by pressing on <em>Continue</em>. If the generation is finished, the <em>Success!</em> dialog will pop up.</p>
</div>
</div>
<div class="sect4">
<h5 id="_batch_mode"><a class="anchor" href="#_batch_mode"></a>Batch mode</h5>
<div class="paragraph">
<p>If there are multiple input elements selected, e.g., Java files, CobiGen will be started in batch mode. For the generation wizard dialog this means, that the generation preview will be constrained to the first selected input element. It does <em>not</em> preview the generation for each element of the selection or of a complex input. The selection of the files to be generated will be generated for each input element analogously afterwards.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/generate_wizard_page1_batch.png" alt="generate wizard page1 batch"></span></p>
</div>
<div class="paragraph">
<p>Thus the color encoding differs also a little bit:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>yellow:</strong> files, which are configured to be merged.</p>
</li>
<li>
<p><strong>red:</strong> files, which are not configured with any merge strategy and thus will be created if the file does not exist or overwritten if the file already exists</p>
</li>
<li>
<p><strong>no color:</strong> files, which will be ignored during generation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Initially all possible files to be generated will be selected.</p>
</div>
</div>
<div class="sect4">
<h5 id="_health_check"><a class="anchor" href="#_health_check"></a>Health Check</h5>
<div class="paragraph">
<p>To check whether CobiGen runs appropriately for the selected element(s) the user can perform a <em>Health Check</em> by activating the respective menu entry as shown below.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_menu_entry.png" alt="health check menu entry"></span></p>
</div>
<div class="paragraph">
<p>The simple <em>Health Check</em> includes 3 checks. As long as any of these steps fails, the <em>Generate</em> menu entry is grayed out.</p>
</div>
<div class="paragraph">
<p>The first step is to check whether the generation configuration is available at all. If this check fails you will see the following message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_no_templates.png" alt="health check no templates"></span></p>
</div>
<div class="paragraph">
<p>This indicates, that there is no Project named <em>CobiGen_Templates</em> available in the current workspace. To run CobiGen appropriately, it is necessary to have a configuration project named <em>CobiGen_Templates</em> imported into your workspace. For more information see chapter <a href="cobigen-eclipse_installation#Installation-steps.adoc">Eclipse Installation</a>.</p>
</div>
<div class="paragraph">
<p>The second step is to check whether the template project includes a valid <em>context.xml</em>. If this check fails, you will see the following message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_invalid_config.png" alt="health check invalid config"></span></p>
</div>
<div class="paragraph">
<p>This means that either your <em>context.xml</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p>does not exist (or has another name)</p>
</li>
<li>
<p>or it is not valid one in any released version of CobiGen</p>
</li>
<li>
<p>or there is simply no automatic routine of upgrading your context configuration to a valid state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If all this is not the case, such as, there is a <em>context.xml</em>, which can be successfully read by CobiGen, you might get the following information:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_old_context.png" alt="health check old context"></span></p>
</div>
<div class="paragraph">
<p>This means that your <em>context.xml</em> is available with the correct name but it is outdated (belongs to an older CobiGen version). In this case just click on <em>Upgrade Context Configuration</em> to get the latest version.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Remark:</strong> This will create a backup of your current context configuration and converts your old configuration to the new format. The upgrade will remove all comments from the file, which could be retrieved later on again from the backup.
If the creation of the backup fails, you will be asked to continue or to abort.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The third step checks whether there are templates for the selected element(s). If this check fails, you will see the following message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_no_matching_triggers.png" alt="health check no matching triggers"></span></p>
</div>
<div class="paragraph">
<p>This indicates, that there no trigger has been activated, which matches the current selection. The reason might be that your selection is faulty or that you imported the wrong template project (e.g. you are working on a devon4j project, but imported the Templates for the Register Factory). If you are a template developer, have a look at the  <a href="cobigen-core_configuration#trigger-node.adoc">trigger configuration</a> and at the corresponding available plug-in implementations of triggers, like e.g., <a href="cobigen-javaplugin#Trigger-extension.adoc">Java Plug-in</a> or <a href="cobigen-xmlplugin#Trigger-extension.adoc">XML Plug-in</a>.</p>
</div>
<div class="paragraph">
<p>If all the checks are passed you see the following message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_all_OK.png" alt="health check all OK"></span></p>
</div>
<div class="paragraph">
<p>In this case everything is OK and the <em>Generate</em> button is not grayed out anymore so that you are able to trigger it and see the <a href="#simple-mode">[simple-mode]</a>.</p>
</div>
<div class="paragraph">
<p>In addition to the basic check of the context configuration, you also have the opportunity to perform an  <em>Advanced Health Check</em>, which will check all available templates configurations (<em>templates.xml</em>) of path-depth=1 from the configuration project root according to their compatibility.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_advanced_up_to_date.png" alt="health check advanced up to date"></span></p>
</div>
<div class="paragraph">
<p>Analogous to the upgrade of the <em>context configuration</em>, the <em>Advanced Health Check</em> will also provide upgrade functionality for <em>templates configurations</em> if available.</p>
</div>
</div>
<div class="sect4">
<h5 id="_update_templates"><a class="anchor" href="#_update_templates"></a>Update Templates</h5>
<div class="paragraph">
<p>Update Template: Select Entity file and right click then select CobiGen Update Templates after that click on download then download successfully message will be come .</p>
</div>
</div>
<div class="sect4">
<h5 id="_adapt_templates"><a class="anchor" href="#_adapt_templates"></a>Adapt Templates</h5>
<div class="paragraph">
<p>Adapt Template: Select any file and right click, then select `cobigen &#8594; <em>Adapt Templates</em> `.If CobiGen templates jar is not available then it downloads them automatically. If CobiGen templates is already present then it will override existing template in workspace and click on OK then imported template successfully message will be come.</p>
</div>
<div class="paragraph">
<p>Finally, please change the Java version of the project to 1.8 so that you don&#8217;t have any compilation errors.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Logging</p>
</div>
<div class="paragraph">
<p>If you have any problem with the CobiGen eclipse plug-in, you might want to enable logging to provide more information for further problem analysis. This can be done easily by adding the <code>logback.xml</code> to the root of the CobiGen_templates configuration folder. The file should contain at least the following contents, whereas you should specify an absolute path to the target log file (at the <code>TODO</code>). If you are using the (<a href="https://github.com/devonfw/cobigen/tree/master/cobigen-templates">cobigen-templates</a> project, you might have the contents already specified but partially commented.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!-- This file is for logback classic. The file contains the configuration for sl4j logging --&gt;
&lt;configuration&gt;
    &lt;appender name="FILE" class="ch.qos.logback.core.FileAppender"&gt;
        &lt;file&gt;&lt;!-- TODO choose your log file location --&gt;&lt;/file&gt;
        &lt;encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder"&gt;
            &lt;Pattern&gt;%n%date %d{HH:mm:ss.SSS} [%thread] %-5level %logger - %msg%n
            &lt;/Pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;
    &lt;root level="DEBUG"&gt;
        &lt;appender-ref ref="FILE" /&gt;
    &lt;/root&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to"><a class="anchor" href="#_how_to"></a>How to</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="paragraph">
<p>==Enterprise Architect client generation</p>
</div>
<div class="paragraph">
<p>We are going to show you <strong>how to</strong> generate source code from an <a href="http://sparxsystems.com/products/ea/">Enterprise Architect</a> diagram
using CobiGen.</p>
</div>
<div class="sect4">
<h5 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h5>
<div class="paragraph">
<p>If <em>CobiGen_Templates</em> is not already imported into your workspace, follow the next steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Click on the Eclipse&#8217;s menu <em>File &gt; Import &gt; Existing Projects into Workspace</em> and browse to select the <code>workspaces/main/CobiGen_Templates</code> directory.</p>
</li>
<li>
<p>Click <em>Finish</em> and you should have the <em>CobiGen_Templates</em> as a new project in Eclipse&#8217;s workspace.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also verify that you have the <strong>latest templates of CobiGen</strong>. Your templates folder must contain the <code>crud_java_ea_uml</code> folder.
If you do not see it, please follow the next steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Download the <a href="https://e-3d.capgemini.com/sites/ESC113658/proj13658/Lists/REF_release/Attachments/2/win_accumulative_patch_22062018.zip">accumulative patch</a>.</p>
</li>
<li>
<p>Open the zip file and extract its content inside the root folder of your Devonfw distribution <strong>Devon-dist_2.4.0/</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After following those steps correctly, you should have the latest version of the templates ready to use.</p>
</div>
</div>
<div class="sect4">
<h5 id="_generation"><a class="anchor" href="#_generation"></a>Generation</h5>
<div class="paragraph">
<p>In this tutorial, we are going to generate the entity infrastructure using as input a class diagram, modelled with <a href="http://sparxsystems.com/products/ea/">Enterprise Architect</a> (EA). First, create a class diagram, an example is shown on figure below:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/EA-gen/classdiagram.png"><img src="_images/images/howtos/EA-gen/classdiagram.png" alt="Eclipse CobiGen generation" width="500"></a>
</div>
</div>
<div class="paragraph">
<p>When you are finished, you will have to export that UML diagram into an XMI version 2.1 file. This is the file format that CobiGen understands. See below a figure showing this process:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/EA-gen/exporting.png"><img src="_images/images/howtos/EA-gen/exporting.png" alt="Eclipse CobiGen generation" width="500"></a>
</div>
</div>
<div class="paragraph">
<p>To open that window, see <a href="http://sparxsystems.com/enterprise_architect_user_guide/13.5/model_publishing/exporttoxmi.html">this</a> tutorial.</p>
</div>
<div class="paragraph">
<p>After having that exported file, change its extension from <code>xmi</code> to <code>xml</code>. Then create an <a href="https://github.com/devonfw/devon4j/wiki/tutorial-newapp">devon4j project</a> and import the exported file into the <code>core</code> of your devon4j project.</p>
</div>
<div class="paragraph">
<p>Now we are going to start the generation, right-click your exported file and select  <em>CobiGen &gt; Generate</em>, finally select the entity infrastructure increment:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/EA-gen/generating.png"><img src="_images/images/howtos/EA-gen/generating.png" alt="Eclipse CobiGen generation" width="500"></a>
</div>
</div>
<div class="paragraph">
<p>After following all these steps, your generated files should be inside <code>src\main\java</code> folder. If you want an XMI example, you will find it <a href="https://github.com/devonfw/cobigen/blob/master/cobigen/cobigen-xmlplugin/src/test/resources/testdata/integrationtest/uml-classdiag/completeUmlXmi.xml">here</a>.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Angular 8 Client Generation</p>
</div>
<div class="paragraph">
<p>The generation can create a full Angular 8 client using the devon4ng-application-template package located at <code>workspaces/examples</code> folder of the distribution. For more details about this package, please refer <a href="https://github.com/devonfw/devon4ng-application-template">here</a>.</p>
</div>
<div class="paragraph">
<p>Take into account that the TypeScript merging for CobiGen needs Node 6 or higher to be installed at your machine.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is a short introduction to the Angular generation. For a deeper tutorial including the generation of the backend, we strongly recommend you to follow <a href="files/HOW-TO-devonfw-ide-CobiGen-PoC-E2E_v3.2.pdf">this document</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_requisites"><a class="anchor" href="#_requisites"></a>Requisites</h5>
<div class="paragraph">
<p>Install yarn globally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>npm install -g yarn</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_angular_8_workspace"><a class="anchor" href="#_angular_8_workspace"></a>Angular 8 workspace</h5>
<div class="paragraph">
<p>The output location of the generation can be defined editing the <code><strong><em>cobigen.properties</em></strong></code> file located at <strong><em>crud_angular_client_app/templates</em></strong> folder of the <strong><em>CobiGen_Templates</em></strong> project.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/angular4-gen/ng4gen_7.png"><img src="_images/images/howtos/angular4-gen/ng4gen_7.png" alt="`cobigen.properties file`" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>By default, the output path would be into the <em>devon4ng-application-template</em> folder at the root of the devon4j project parent folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>root/
 |- devon4ng-application-template/
 |- devon4j-project-parent/
   |- core/
   |- server/</pre>
</div>
</div>
<div class="paragraph">
<p>However, this path can be changed, for example to <code><em>src/main/client</em></code> folder of the devon4j project:</p>
</div>
<div class="paragraph">
<p><code>relocate: ./src/main/client/${cwd}</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>root/
 |- devon4j-project-parent/
   |- core/
      |- src
        |- main
          |- client
   |- server/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the output path is chosen, copy the files of <a href="https://github.com/devonfw/devon4ng-application-template"><code>DEVON4NG-APPLICATION-TEMPLATE</code></a> repository into this output path.</p>
</div>
</div>
<div class="sect4">
<h5 id="_install_node_dependencies"><a class="anchor" href="#_install_node_dependencies"></a>Install Node dependencies</h5>
<div class="paragraph">
<p>Open a terminal into devon4ng-application-template copied and just run the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">yarn</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will start the installation of all node packages needed by the project into the node_modules folder.</p>
</div>
</div>
<div class="sect4">
<h5 id="_generating"><a class="anchor" href="#_generating"></a>Generating</h5>
<div class="paragraph">
<p>From an ETO object, right click, CobiGen &#8594; Generate will show the CobiGen wizard relative to client generation:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/angular4-gen/ng4gen_1.png"><img src="_images/images/howtos/angular4-gen/ng4gen_1.png" alt="CobiGen Client Generation Wizard" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>Check all the increments relative to Angular:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Angular devon4j URL increment is only needed for the first generations however, checking it again on next generation will not cause any problem.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As we done on other generations, we click Next to choose which fields to include at the generation or simply clicking Finish will start the generation.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/angular4-gen/ng4gen_3.png"><img src="_images/images/howtos/angular4-gen/ng4gen_3.png" alt="CobiGen Client Generation Wizard 3" width="450"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_routing"><a class="anchor" href="#_routing"></a>Routing</h5>
<div class="paragraph">
<p>Due to the nature of the TypeScript merger, currently is not possible to merge properly the array of paths objects of the routings at app.routing.ts file so, this modification should be done by hand on this file. However, the import related to the new component generated is added.</p>
</div>
<div class="paragraph">
<p>This would be the generated <code>app-routing.module</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import { Routes, RouterModule } from '@angular/router';
import { LoginComponent } from './login/login.component';
import { AuthGuard } from './shared/security/auth-guard.service';
import { InitialPageComponent } from './initial-page/initial-page.component';
import { HomeComponent } from './home/home.component';
import { SampleDataGridComponent } from './sampledata/sampledata-grid/sampledata-grid.component';
//Routing array
const appRoutes: Routes = [{
    path: 'login',
    component: LoginComponent
}, {
    path: 'home',
    component: HomeComponent,
    canActivate: [AuthGuard],
    children: [{
        path: '',
        redirectTo: '/home/initialPage',
        pathMatch: 'full',
        canActivate: [AuthGuard]
    }, {
        path: 'initialPage',
        component: InitialPageComponent,
        canActivate: [AuthGuard]
    }]
}, {
    path: '**',
    redirectTo: '/login',
    pathMatch: 'full'
}];
export const routing = RouterModule.forRoot(appRoutes);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adding the following into the children object of <code>home</code>, will add into the side menu the entry for the component generated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">{
    path: 'sampleData',
    component: SampleDataGridComponent,
    canActivate: [AuthGuard],
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import { Routes, RouterModule } from '@angular/router';
import { LoginComponent } from './login/login.component';
import { AuthGuard } from './shared/security/auth-guard.service';
import { InitialPageComponent } from './initial-page/initial-page.component';
import { HomeComponent } from './home/home.component';
import { SampleDataGridComponent } from './sampledata/sampledata-grid/sampledata-grid.component';
//Routing array
const appRoutes: Routes = [{
    path: 'login',
    component: LoginComponent
}, {
    path: 'home',
    component: HomeComponent,
    canActivate: [AuthGuard],
    children: [{
        path: '',
        redirectTo: '/home/initialPage',
        pathMatch: 'full',
        canActivate: [AuthGuard]
    }, {
        path: 'initialPage',
        component: InitialPageComponent,
        canActivate: [AuthGuard]
    }, {
        path: 'sampleData',
        component: SampleDataGridComponent,
        canActivate: [AuthGuard],
    }]
}, {
    path: '**',
    redirectTo: '/login',
    pathMatch: 'full'
}];
export const routing = RouterModule.forRoot(appRoutes);</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/angular4-gen/ng4gen_6.png"><img src="_images/images/howtos/angular4-gen/ng4gen_6.png" alt="`APP SideMenu`" width="450"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_jwt_authentication"><a class="anchor" href="#_jwt_authentication"></a><code>JWT</code> Authentication</h5>
<div class="paragraph">
<p>If you are using a backend server with <code>JWT</code> Authentication (there is a sample in <code>workspaces/folder</code> called <code><strong>sampleJwt</strong></code>) you have to specify the Angular application to use this kind of authentication.</p>
</div>
<div class="paragraph">
<p>By default the variable is set to CSRF but you can change it to <code>JWT</code> by going to the <a href="https://github.com/devonfw/devon4ng-application-template/blob/develop/src/environments/environment.ts#L10">Enviroment.ts</a> and setting <code>security: 'jwt'</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_running"><a class="anchor" href="#_running"></a>Running</h5>
<div class="paragraph">
<p>First of all, run your devon4j java server by right clicking over <code>SpringBootApp.java</code> Run As &#8594; Java Application. This will start to run the <code>SpringBoot</code> server. Once you see the Started <code>SpringBoot</code> in <code>XX</code> seconds, the backend is running.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/angular4-gen/ng4gen_4.png"><img src="_images/images/howtos/angular4-gen/ng4gen_4.png" alt="Starting `SpringBoot`" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>Once the the server is running, open a Devon console at the output directory defined previously and run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng serve --open</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will run the Angular 8 application at:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:4200</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/angular4-gen/ng4gen_5.png"><img src="_images/images/howtos/angular4-gen/ng4gen_5.png" alt="Running Angular 8 app" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>Once finished, the browser will open automatically at the previous localhost URL showing the Angular 8 application, using the credentials set at the devon4j java server you will be able to access.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Ionic client generation</p>
</div>
<div class="paragraph">
<p>We are going to show you <strong>how to</strong> generate a CRUD Ionic application from an <strong>ETO</strong>
using CobiGen.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is a short introduction to the Ionic generation. For a deeper tutorial including the generation of the backend, we strongly recommend you to follow <a href="files/HOW-TO-devonfw-ide-CobiGen-PoC-E2E_v3.2.pdf">this document</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_prerequisites_2"><a class="anchor" href="#_prerequisites_2"></a>Prerequisites</h5>
<div class="paragraph">
<p>Before starting, make sure you already have in your computer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://ionicframework.com/docs/installation/cli">Ionic</a>: by following the steps defined on that page.
It includes installing:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://nodejs.org/en/">NodeJS</a>: We have to use "NPM" for downloading packages.</p>
</li>
<li>
<p>Ionic CLI.</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://capacitor.ionicframework.com/docs/getting-started/">Capacitor</a>: Necessary to access to native device features.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <em>CobiGen_Templates</em> are not already downloaded, follow the next steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Right click on any file of your workspace <em>CobiGen &gt; Update Templates</em> and now you are able to start the generation.</p>
</li>
<li>
<p>If you want to adapt them, click <em>Adapt Templates</em> and you should have the <em>CobiGen_Templates</em> as a new project in Eclipse&#8217;s workspace.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After following those steps correctly, you should have the latest version of the templates ready to use.</p>
</div>
</div>
<div class="sect4">
<h5 id="_generation_2"><a class="anchor" href="#_generation_2"></a>Generation</h5>
<div class="paragraph">
<p>We are going to generate the CRUD into a <strong>sample application</strong> that we have developed for
testing this functionality. It is present on your <code>workspaces/examples</code> folder (devon4ng-ionic-application-template). If you do not see it, you can clone or download it from <a href="https://github.com/devonfw/devon4ng-ionic-application-template">here</a>.</p>
</div>
<div class="paragraph">
<p>After having that sample app, please create an <a href="https://github.com/devonfw/devon4ng/wiki/tutorial-newapp">devon4j project</a> and then start implementing the ETO: You will find an example <a href="https://github.com/devonfw/devon4j/blob/develop/samples/core/src/main/java/io/devonfw/gastronomy/restaurant/tablemanagement/logic/api/to/TableEto.java">here</a>.</p>
</div>
<div class="paragraph">
<p>As you can see, <code>TableEto</code> contains 3 attributes: 2 of them are <code>Long</code> and the third one <code>TableState</code> is an enum that you will find
<a href="https://github.com/devonfw/devon4j/blob/develop/samples/core/src/main/java/io/devonfw/gastronomy/restaurant/tablemanagement/common/api/datatype/TableState.java">here</a>.
The Ionic generation works fine for any Java primitive attribute (Strings, floats, chars, boolean&#8230;&#8203;) and enums. However, if you want to use your own objects, you should
override the <code>toString()</code> method, as explained <a href="https://stackoverflow.com/questions/35361482/typescript-override-tostring">here</a>.</p>
</div>
<div class="paragraph">
<p>The attributes explained above will be used for generating a page that shows a list. Each item of that list
will show the values of those attributes.</p>
</div>
<div class="paragraph">
<p>For generating the files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Right click your ETO file and click on <em>CobiGen &gt; Generate</em> as shown on the figure below.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/rightClick.png"><img src="_images/images/howtos/ionic-gen/rightClick.png" alt="Eclipse CobiGen generation" width="500"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the Ionic increments for generating as shown below. <em>Increments group a set of templates for generating
different projects</em>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong><code>Ionic List</code></strong> used for generating the page containing the list.</p>
</li>
<li>
<p><strong><code>Ionic devon4ng environments</code></strong>  is for stating the server path.</p>
</li>
<li>
<p><strong><code>Ionic i18n</code></strong> used for generating the different language translations for the <em>`translationService`</em> (currently English and Spanish).</p>
</li>
<li>
<p><strong><code>Ionic routing</code></strong> adds an app-routing.module.ts file to allow navigation similar to the one available in Angular.</p>
</li>
<li>
<p><strong><code>Ionic theme</code></strong> generates the <code>variables.scss</code> file which contains variables to style the application.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/wizardCobiGen.png"><img src="_images/images/howtos/ionic-gen/wizardCobiGen.png" alt="CobiGen Ionic Wizard" width="500"></a>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default, the generated files will be placed inside "devon4ng-ionic-application-template", next to the root of your project&#8217;s folder.
See the image below to know where they are generated. For <strong>changing the generation path</strong> and the name of the application go to <code><em>CobiGen_Templates/crud_ionic_client_app/cobigen.properties</em></code>.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/pathOfGeneration.png"><img src="_images/images/howtos/ionic-gen/pathOfGeneration.png" alt="Generation path" width="500"></a>
</div>
</div>
<div class="paragraph">
<p>Now that we have generated the files, lets start testing them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First change the <strong>SERVER_URL</strong> of your application. For doing that, modify <code><em>src/environments/environments.ts</em></code>, also modify <code><em>src/environments/environments.android.ts</em></code> (android) and <code><em>src/environments/environments.prod.ts</em></code> (production) if you want to test in different environments.</p>
</li>
<li>
<p>Check that there are no duplicated imports. Sometimes there are duplicated imports in <code><em>src/app/app.module.ts</em></code>.
This happens because the merger of CobiGen prefers to duplicate rather than to delete.</p>
</li>
<li>
<p>Run <code>npm install</code> to install all the required dependencies.</p>
</li>
<li>
<p>Run <code>`ionic serve</code> on your console.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After following all these steps your application should start. However, remember that you will need your <strong>server</strong> to be running for access to the list page.</p>
</div>
</div>
<div class="sect4">
<h5 id="_running_it_on_android"><a class="anchor" href="#_running_it_on_android"></a>Running it on Android</h5>
<div class="paragraph">
<p>To run the application in an android emulated device, it is necessary to have Android Studio and Android SDK. After its installation, the following commands have to be run on your console:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>npx cap init "name-for-the-app (between quotes)" "id-for-the-app (between quotes)"</code></p>
</li>
<li>
<p><code>ionic build --configuration=android</code>. To use this command, you must add an android build configuration at angular.json</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>    "build": {
      ...
      "configurations": {
        ...
        "android": {
          "fileReplacements": [
            {
              "replace": "src/environments/environment.ts",
              "with": "src/environments/environment.android.ts"
            }
          ]
        },
      }
    }</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>npx cap add android</code></p>
</li>
<li>
<p><code>npx cap copy</code></p>
</li>
<li>
<p><code>npx cap open android</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The last steps are done in Android studio: make the project, make the app, build and APK and run in a device.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/and-vsc-make.png"><img src="_images/images/howtos/ionic-gen/and-vsc-make.png" alt="Click on make project" width="500"></a>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/and-vsc-make-app.png"><img src="_images/images/howtos/ionic-gen/and-vsc-make-app.png" alt="click on make app" width="500"></a>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/and-vsc-build-apk.png"><img src="_images/images/howtos/ionic-gen/and-vsc-build-apk.png" alt="click on build APK" width="500"></a>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/and-vsc-build-run.png"><img src="_images/images/howtos/ionic-gen/and-vsc-build-run.png" alt="click on running device" width="500"></a>
</div>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Implementing a new Plug-in</p>
</div>
<div class="paragraph">
<p>New plug-ins can implement an input reader, a merger, a matcher, a trigger interpreter, and/or a template engine as explained <a href="cobigen-core_development#extension-mechanism">here</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is discouraged to have <code>cobigen-core</code> dependencies at runtime, except for <code>cobigen-core-api</code> which definitely must be present.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_plugin_activator"><a class="anchor" href="#_plugin_activator"></a>Plugin Activator</h5>
<div class="paragraph">
<p>Each plug-in has to have an plug-in activator class implementing the interface <code>GeneratorPluginActivator</code> from the <code>core-api</code>. This class will be used to load the plug-in using the <code>PluginRegistry</code> as explained <a href="cobigen-core_development#loadplugin">here</a>. This class implements two methods:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>bindMerger()</code> &#8594; returns a mapping of merge strategies and its implementation to be registered.</p>
</li>
<li>
<p><code>bindTriggerInterpreter()</code>&#8594; returns the trigger interpreters to be provided by this plug-in.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Both methods create and register instances of mergers and trigger interpreters to be provided by the new plug-in.</p>
</div>
</div>
<div class="sect4">
<h5 id="_adding_trigger_interpreter"><a class="anchor" href="#_adding_trigger_interpreter"></a>Adding Trigger Interpreter</h5>
<div class="paragraph">
<p>The trigger interpreter has to implement the <code>TriggerInterpreter</code> interface from the core. The trigger interpreter defines the type for the new plugin and creates new <code>InputReader</code> and new Matcher objects.</p>
</div>
</div>
<div class="sect4">
<h5 id="_adding_input_reader"><a class="anchor" href="#_adding_input_reader"></a>Adding Input Reader</h5>
<div class="paragraph">
<p>The input reader is responsible of read the input object and parse it into
 FreeMarker models. The input reader must be implemented for the type of the
 input file. If there is any existent plugin that has the same file type as input,
 there will be no need to add a new input reader to the new plug-in.</p>
</div>
<div class="sect5">
<h6 id="_input_reader_interface"><a class="anchor" href="#_input_reader_interface"></a>Input Reader Interface</h6>
<div class="paragraph">
<p>The interface needed to add a new input reader is defined at the core. Each new
sub plug-in must implements this interface if is needed an input reader for it.</p>
</div>
<div class="paragraph">
<p>The interface implements the basic methods that an input reader must have,
but if additional methods are required, the developer must add a new interface
that extends the original interface <strong><em>`InputReader.java`</em></strong> from the <code>core-api</code>
and implement that on the sub plug-in.</p>
</div>
<div class="paragraph">
<p>The methods to be implemented by the input reader of the new sub plugin are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isValidInput(Object input)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>boolean</strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This function will be called if matching triggers or matching templates should be retrieved for a given input object.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>createModel(Object input)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Map&lt;String, Object&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This function should create the FreeMarker object model from the given input.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>combinesMultipleInputObjects(Object input)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>boolean</strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">States whether the given input object combines multiple input objects to be used for generation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getInputObjects(Object input, Charset inputCharset)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>List&lt;Object&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Will return the set of combined input objects if the given input combines multiple input objects.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getTemplateMethods(Object input)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Map&lt;String, Object&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This method returns available template methods from the plugins as Map. If the plugin which corresponds to the input does not provide any template methods an empty Map will be returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getInputObjectsRecursively(Object input, Charset inputCharset)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>List&lt;Object&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Will return the set of combined input objects if the given input combines multiple input objects.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="_model_constants"><a class="anchor" href="#_model_constants"></a>Model Constants</h6>
<div class="paragraph">
<p>The Input reader will create a model for FreeMarker. A FreeMarker model must
have variables to use them at the <code>.ftl</code> template file. Refer to <a href="cobigen-javaplugin#java-input-reader">Java Model</a> to see the FreeMarker model example for java input files.</p>
</div>
</div>
<div class="sect5">
<h6 id="_registering_the_input_reader"><a class="anchor" href="#_registering_the_input_reader"></a>Registering the Input Reader</h6>
<div class="paragraph">
<p>The input reader is an object that can be retrieved using the correspondent get
 method of the trigger interpreter object. The trigger interpreter object is
 loaded at the eclipse plug-in using the load plug-in method explained
 <a href="cobigen-core_development#loadplugin">here</a>.
 That way, when the core needs the input reader, only needs to call that <code>getInputReader</code> method.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_adding_matcher"><a class="anchor" href="#_adding_matcher"></a>Adding Matcher</h5>
<div class="paragraph">
<p>The matcher implements the <code>MatcherInterpreter</code> interface from the <code>core-api</code>.
Should be implemented for providing a new input matcher. Input matcher are
defined as part of a trigger and provide the ability to restrict specific
inputs to a set of templates.
This restriction is implemented with a <code>MatcherType</code> <code>enum</code>.</p>
</div>
<div class="paragraph">
<p>E.g <code>JavaPlugin</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private enum MatcherType {
    /** Full Qualified Name Matching */
    FQN,
    /** Package Name Matching */
    PACKAGE,
    /** Expression interpretation */
    EXPRESSION
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Furthermore, matchers may provide several variable assignments, which might be
dependent on any information of the matched input and thus should be resolvable
by the defined matcher.</p>
</div>
<div class="paragraph">
<p>E.g <code>JavaPlugin</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private enum VariableType {
    /** Constant variable assignment */
    CONSTANT,
    /** Regular expression group assignment */
    REGEX
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_adding_merger"><a class="anchor" href="#_adding_merger"></a>Adding Merger</h5>
<div class="paragraph">
<p>The merger is responsible to perform merge action between new output with the
existent data at the file if it already exists. Must implement the Merger
interface from the <code>core-api</code>.
The implementation of the Merge interface must override the following methods:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getType()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>String</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the type, this merger should handle.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>merge(File base, String patch, String targetCharset)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>String</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Merges the patch into the base file.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Is important to know that any exception caused by the merger must throw a <code>MergeException</code> from the <code>core-api</code> to the eclipse-plugin handle it.</p>
</div>
</div>
<div class="sect4">
<h5 id="_changes_since_eclipse_maven_3_x"><a class="anchor" href="#_changes_since_eclipse_maven_3_x"></a>Changes since Eclipse / Maven 3.x</h5>
<div class="paragraph">
<p>Since version 3.x the Eclipse and Maven plugins of CobiGen utilize the Java <code>ServiceLoader</code> mechanic to find and register plugins at runtime. To enable a new plugin to be discovered by this mechanic the following steps are needed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>create the file <code>META-INF/services/com.devonfw.cobigen.api.extension.GeneratorPluginActivator</code> containing just the full qualified name of the class implementing the <code>GeneratorPluginActivator</code> interface, if the plugin provides a <code>Merger</code> and/or a <code>TriggerInterpreter</code></p>
</li>
<li>
<p>create the file <code>META-INF/services/com.devonfw.cobigen.api.extension.TextTemplateEngine</code> containing just the full qualified name of the class implementing the <code>TextTemplateEngine</code> interface, if provided by the plugin</p>
</li>
<li>
<p>include <code>META-INF</code> into the target bundle (i.e. the folder <code>META-INF</code> has to be present in the target jar file)</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Example: Java Plugin</div>
<div class="paragraph">
<p>The java plugin provides both a <code>Merger</code> and a <code>TriggerInterpreter</code>. It contains therefore a <code>com.devonfw.cobigen.api.extension.GeneratorPluginActivator</code> file with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>com.devonfw.cobigen.javaplugin.JavaPluginActivator</code></pre>
</div>
</div>
<div class="paragraph">
<p>This makes the <code>JavaPluginActivator</code> class discoverable by the <code>ServiceLoader</code> at runtime.</p>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>to properly include the plugin into the current system and use existing infrastructure, you need to add the plugin as a module in <code>/cobigen/pom.xml</code> (in case of a <code>Merger</code>/<code>TriggerInterpreter</code> providing plugin) and declare that as the plugin&#8217;s parent in it&#8217;s own <code>pom.xml</code> via</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;parent&gt;
    &lt;groupId&gt;com.devonfw&lt;/groupId&gt;
    &lt;artifactId&gt;cobigen-parent&lt;/artifactId&gt;
    &lt;version&gt;dev-SNAPSHOT&lt;/version&gt;
&lt;/parent&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>or <code>/cobigen/cobigen-templateengines/pom.xml</code> (in case of a <code>Merger</code>/<code>TriggerInterpreter</code> providing plugin) and declare that as the plugin&#8217;s parent in it&#8217;s own <code>pom.xml</code> via</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;parent&gt;
    &lt;groupId&gt;com.devonfw&lt;/groupId&gt;
    &lt;artifactId&gt;cobigen-tempeng-parent&lt;/artifactId&gt;
    &lt;version&gt;dev-SNAPSHOT&lt;/version&gt;
&lt;/parent&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the plugin provides both just use the <code>/cobigen/pom.xml</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The dependencies of the plugin are included in the bundle</p>
</li>
<li>
<p>To make the plugin available to the Eclipse plugin it must be included into the current <code>compositeContent.xml</code> and <code>compositeArtifacts.xml</code> files. Both files are located in <a href="https://github.com/devonfw/cobigen/tree/gh-pages/updatesite/stable"><code>https://github.com/devonfw/cobigen/tree/gh-pages/updatesite/{test|stable}</code></a>. To do so, add an <code>&lt;child&gt;</code> entry to the <code>&lt;children&gt;</code> tag in both files and adapt the <code>size</code> attribute to match the new number of references. The <code>location</code> attribute of the new <code>&lt;child&gt;</code> tag needs to be the artifact id of the plugins <code>pom.xml</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Example: Java Plugin</div>
<div class="paragraph">
<p>In case of the Java plugin, the entry is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;child location="cobigen-javaplugin"/&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_deployment"><a class="anchor" href="#_deployment"></a>Deployment</h6>
<div class="paragraph">
<p>If you want to create a test release of eclipse you need to run the command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">sh deploy.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>on the cloned CobiGen repository while making sure, that your current version of CobiGen cloned is a snapshot version. This will automatically be detected by the deploy script.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Introduction to CobiGen external plug-ins</p>
</div>
<div class="paragraph">
<p>Since September of 2019, a major change on CobiGen has taken place. CobiGen is written in Java code and previously, it was very hard for developers to create new plug-ins in other languages.</p>
</div>
<div class="paragraph">
<p>Creating a new plug-in means:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Being able to parse a file in that language.</p>
</li>
<li>
<p>Create a human readable model that can be used to generate templates (by retrieving properties from the model).</p>
</li>
<li>
<p>Enable merging files, so that user&#8217;s code does not get removed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the Java plug-in it was relatively easy. As you are inside the Java world, you can use multiple utilities or libraries in order to get the <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">AST</a> or to merge Java code. With this new feature, we wanted that behaviour to be possible for any programming language.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_general_intuition"><a class="anchor" href="#_general_intuition"></a>General intuition</h5>
<div class="paragraph">
<p>Below you will find a very high level description of how CobiGen worked in previous versions:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/oldCobiGen.png"><img src="_images/images/howtos/todo-plugin/oldCobiGen.png" alt="Old CobiGen" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>Basically, when a new input file was sent to CobiGen, it called the input reader to create a model of it (see <a href="https://github.com/devonfw/cobigen/wiki/cobigen-tsplugin#object-model">here</a> an example of a model). That model was sent to the template engine.</p>
</div>
<div class="paragraph">
<p>Afterwards, the template engine generated a new file which had to be merged with the original one. All this code was implemented in Java.</p>
</div>
<div class="paragraph">
<p>On the new version, we have implemented a handler (<code>ExternalProcessHandler</code>) which connects through TCP/IP connection to a server (normally on localhost:5000). This server can be implemented in any language (.Net, Node.js, Python&#8230;&#8203;) it just needs to implement a REST API defined <a href="https://github.com/devonfw/cobigen-template-plugin/blob/master/APIContract.yml">here</a>. The most important services are the input reading and merging:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/newCobiGen.png"><img src="_images/images/howtos/todo-plugin/newCobiGen.png" alt="New CobiGen" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>CobiGen acts as a client that sends requests to the server in order to read the input file and create a model. The model is returned to the template engine so that it generates a new file. Finally, it is sent back to get merged with the original file.</p>
</div>
</div>
<div class="sect4">
<h5 id="_how_to_create_new_external_plug_in"><a class="anchor" href="#_how_to_create_new_external_plug_in"></a>How to create new external plug-in</h5>
<div class="paragraph">
<p>The creation of a new plug-in consists mainly in three steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creation of the server (external process).</p>
</li>
<li>
<p>Creation of a CobiGen plug-in.</p>
</li>
<li>
<p>Creation of templates.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_server_external_process"><a class="anchor" href="#_server_external_process"></a>Server (external process)</h6>
<div class="paragraph">
<p>The server can be programmed in any language that is able to implement REST services endpoints. The API that needs to implement is defined with <a href="https://github.com/devonfw/cobigen-template-plugin/blob/master/APIContract.yml">this contract</a>. You can paste the content to <a href="https://editor.swagger.io/" class="bare">https://editor.swagger.io/</a> for a better look.</p>
</div>
<div class="paragraph">
<p>We have already created a NestJS server that implements the API defined above. You can find the code <a href="https://github.com/devonfw/cobigen-devon4node-server/blob/master/cobigen-nest-server/src/processmanagement/processmanagement.controller.ts">here</a> which you can use as an example.</p>
</div>
<div class="paragraph">
<p>As you can see, the endpoints have the following naming convention: <code>processmanagement/todoplugin/nameOfService</code> where you will have to change <code>todo</code> to your plug-in name (e.g. <code>rustplugin</code>, <code>pyplugin</code>, <code>goplugin</code>&#8230;&#8203;)</p>
</div>
<div class="paragraph">
<p>When implementing service <code>getInputModel</code> which returns a model from the input file there are only two restrictions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>path</code> key must be added. Its value can be the full path of the input file or just the file name. It is needed because in CobiGen there is a <a href="https://github.com/devonfw/cobigen/wiki/eclipse-plugin_development#batch-mode">batch mode</a>, in which you can have multiple input objects inside the same input file. You do not need to worry about batch mode for now.</p>
</li>
<li>
<p>On the root of your model, for each found key that is an object (defined with brackets <code>[{}]</code>), CobiGen will try to use it as an input object. For example, this could be a valid model:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JSON hljs" data-lang="JSON">{
  "path": "example/path/employee.entity.ts"
  "classes": [
    {
      "identifier": "Employee",
      "modifiers": [
        "export"
      ],
      "decorators": [
        {
          "identifier": {
            "name": "Entity",
            "module": "typeorm"
          },
          "isCallExpression": true
        }
      ],
      "properties": [
        {
          "identifier": "id",
    ...
    ...
    ...
    }]
    "interfaces": [{
        ...
    }]
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For this model, CobiGen would use as input objects all the <code>classes</code> and <code>interfaces</code> defined. On the templates we would be able to do <code>model.classes[0].identifier</code> to get the class name. These input objects depend on the language, therefore you can use any key.</p>
</div>
<div class="paragraph">
<p>In order to test the server, you will have to deploy it on your local machine (localhost), default port is 5000. If that port is already in use, you can deploy it on higher port values (5001, 5002&#8230;&#8203;). Nevertheless, we explain <a href="#testing_phase">later</a> the testing process as you need to complete the next step before.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Your server must accept one argument when running it. The argument will be the port number (as an integer). This will be used for CobiGen in order to handle blocked ports when deploying your server. Check this <a href="https://github.com/devonfw/cobigen-devon4node-server/blob/master/cobigen-nest-server/src/main.ts#L47">code</a> to see how we implemented that argument on our NestJS server.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_cobigen_plug_in"><a class="anchor" href="#_cobigen_plug_in"></a>CobiGen plug-in</h6>
<div class="paragraph">
<p>You will have to create a new CobiGen plug-in that connects to the server. But <strong>do not worry</strong>, you will not have to implement anything new. We have a CobiGen plug-in template available, the only changes needed are renaming files and setting some properties on the pom.xml. Please follow these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Get the CobiGen plug-in template from <a href="https://github.com/devonfw/cobigen-template-plugin">here</a>. It is a template repository (new GitHub feature), so you can click on "Use this template" as shown below:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/usePluginTemplate.png"><img src="_images/images/howtos/todo-plugin/usePluginTemplate.png" alt="Plugin CobiGen template" width="550"></a>
</div>
</div>
</li>
<li>
<p>Name your repo as <code>cobigen-name-plugin</code> where <code>name</code> can be python, rust, go&#8230;&#8203; In our case we will create a <code>nest</code> plug-in. It will create a repo with only one commit which contains all the needed files.</p>
</li>
<li>
<p>Clone your just created repo and import folder <code>cobigen-todoplugin</code> as a Maven project on any Java IDE, though we recommend you devonfw ;)</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/importPluginEclipse.png"><img src="_images/images/howtos/todo-plugin/importPluginEclipse.png" alt="Import plugin" width="450"></a>
</div>
</div>
</li>
<li>
<p>Rename all the <code>todoplugin</code> folders, files and class names to <code>nameplugin</code>. In our case <code>nestplugin</code>. In Eclipse you can easily rename by right clicking and then refactor &#8594; rename:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/renamePlugin.png"><img src="_images/images/howtos/todo-plugin/renamePlugin.png" alt="Rename plugin" width="450"></a>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We recommend you to select all the checkboxes
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/renameCheckbox.png"><img src="_images/images/howtos/todo-plugin/renameCheckbox.png" alt="Rename checkbox" width="450"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Remember to change in <code>src/main/java</code> and <code>src/test/java</code> all the package, files and class names to use your plug-in name. The final result would be:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/packageStructure.png"><img src="_images/images/howtos/todo-plugin/packageStructure.png" alt="Package structure" width="300"></a>
</div>
</div>
</li>
<li>
<p>Now we just need to change some strings, this is needed for CobiGen to register all the different plugins (they need unique names). In class <code>TodoPluginActivator</code> (in our case <code>NestPluginActivator</code>), change all the <code>todo</code> to your plug-in name. See below the 3 strings that need to be changed:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/pluginActivator.png"><img src="_images/images/howtos/todo-plugin/pluginActivator.png" alt="Plugin activator" width="450"></a>
</div>
</div>
</li>
<li>
<p>Finally, we will change some properties from the <code>pom.xml</code> of the project. These properties define the server (external process) that is going to be used:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Inside <code>pom.xml</code>, press <em>Ctrl + F</em> to perform a find and replace operation. Replace all <code>todo</code> with your plugin name:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/setPomProperties.png"><img src="_images/images/howtos/todo-plugin/setPomProperties.png" alt="Pom properties" width="550"></a>
</div>
</div>
</li>
<li>
<p>We are going to explain the server properties:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>artifactId</code>: This is the name of your plug-in, that will be used for a future release on Maven Central.</p>
</li>
<li>
<p>plugin.name: does not need to be changed as it uses the property from the <code>artifactId</code>. When connecting to the server, it will send a request to <code>localhost:5000/{plugin.name}plugin/isConnectionReady</code>, that is why it is important to use an unique name for the plug-in.</p>
</li>
<li>
<p>server.name: This defines how the server executable (<em>.exe</em>) file will be named. This <em>.exe</em> file contains all the needed resources for deploying the server. You can use any name you want.</p>
</li>
<li>
<p>server.version: You will specify here the server version that needs to be used. The <em>.exe</em> file will be named as <code>{server.name}-{server.version}.exe</code>.</p>
</li>
<li>
<p>server.url: This will define from where to download the server. We <strong>really</strong> recommend you using NPM which is a package manager we know it works well. We explain <a href="#release_server">here</a> how to release the server on NPM. This will download the <em>.exe</em> file for Windows.</p>
</li>
<li>
<p>server.url.linux: Same as before, but this should download the <em>.exe</em> file for Linux systems. If you do not want to implement a Linux version of the plug-in, just use the same URL from Windows or MacOS.</p>
</li>
<li>
<p>server.url.macos: Same as before, but this should download the <em>.exe</em> file for MacOS systems. If you do not want to implement a MacOS version of the plug-in, just use the same URL from Linux or Windows.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="testing_phase"><a class="anchor" href="#testing_phase"></a>Testing phase</h5>
<div class="paragraph">
<p>Now that you have finished with the implementation of the server and the creation of a new CobiGen plug-in, we are going to explain how you can test that everything works fine:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy the server on port 5000.</p>
</li>
<li>
<p>Run <code>mvn clean test</code> on the CobiGen-plugin or run the JUnit tests directly on Eclipse.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If the server and the plug-in are working properly, some tests will pass and other will fail (we need to tweak them).</p>
</li>
<li>
<p>If every test fails, something is wrong in your code.</p>
</li>
</ol>
</div>
</li>
<li>
<p>In order to fix the failing tests, go to <code>src/test/java</code>. The failing tests make use of sample input files that we added in sake of example:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/failingTest.png"><img src="_images/images/howtos/todo-plugin/failingTest.png" alt="Pom properties" width="550"></a>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Replace those files (on <code>src/test/resources/testadata/unittest/files/&#8230;&#8203;</code>) with the correct input files for your server.</p>
</div>
</div>
<div class="sect4">
<h5 id="_releasing"><a class="anchor" href="#_releasing"></a>Releasing</h5>
<div class="paragraph">
<p>Now that you have already tested that everything works fine, we are going to explain how to release the server and the plug-in.</p>
</div>
<div class="sect5">
<h6 id="release_server"><a class="anchor" href="#release_server"></a>Release the server</h6>
<div class="paragraph">
<p>We are going to use <a href="https://www.npmjs.com/">NPM</a> to store the executable of our server. Even though NPM is a package manager for JavaScript, it can be used for our purpose.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Get the CobiGen server template from <a href="https://github.com/devonfw/cobigen-template-server">here</a>. It is a template repository (new GitHub feature), so you can click on "Use this template" as shown below:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/useServerTemplate.png"><img src="_images/images/howtos/todo-plugin/useServerTemplate.png" alt="Server CobiGen template" width="550"></a>
</div>
</div>
</li>
<li>
<p>Name your repo as <code>cobigen-name-server</code> where <code>name</code> can be python, rust, go&#8230;&#8203; In our case we will create a <code>nest</code> plug-in. It will create a repo with only one commit which contains all the needed files.</p>
</li>
<li>
<p>Clone your just created repo and go to folder <code>cobigen-todo-server</code>. It will just contain two files: <em>ExternalProcessContract.yml</em> is the OpenAPI definition which you can modify with your own server definition (this step is optional), and <em>package.json</em> is a file needed for NPM in order to define where to publish this package:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JSON hljs" data-lang="JSON">{
  "name": "@devonfw/cobigen-todo-server",
  "version": "1.0.0",
  "description": "Todo server to implement the input reader and merger for CobiGen",
  "author": "CobiGen Team",
  "license": "Apache"
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Those are the default properties. This would push a new package <code>cobigen-todo-server</code> on the <code>devonfw</code> organization, with version 1.0.0. We have no restrictions here, you can use any organization, though we always recommend devonfw.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Remember to change all the <code>todo</code> to your server name.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Add your executable file into the <code>cobigen-todo-server</code> folder, just like below. As we said previously, this <em>.exe</em> is the server ready to be deployed.</p>
<div class="listingblock">
<div class="content">
<pre>cobigen-template-server/
 |- cobigen-todo-server/
   |- ExternalProcessContract.yml
   |- package.json
   |- todoserver-1.0.0.exe</pre>
</div>
</div>
</li>
<li>
<p>Finally, we have to publish to NPM. If you have never done it, you can follow this <a href="https://www.freecodecamp.org/news/how-to-make-a-beautiful-tiny-npm-package-and-publish-it-2881d4307f78/">tutorial</a>. Basically you need to login into NPM and run:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cmd hljs" data-lang="cmd">cd cobigen-todo-server/
npm publish --access=public</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To release Linux and MacOS versions of your plug-in, just add the suffix into the package name (e.g. <code>@devonfw/cobigen-todo-server-linux</code>)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That&#8217;s it! You have published the first version of your server. Now you just need to modify the properties defined on the pom of your CobiGen plug-in. Please see next section for more information.</p>
</div>
</div>
<div class="sect5">
<h6 id="_releasing_cobigen_plug_in"><a class="anchor" href="#_releasing_cobigen_plug_in"></a>Releasing CobiGen plug-in</h6>
<div class="ulist">
<ul>
<li>
<p>Change the pom.xml to define all the properties. You can see below a final example for <code>nest</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">...
   &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
   &lt;artifactId&gt;nestplugin&lt;/artifactId&gt;
   &lt;name&gt;CobiGen - Nest Plug-in&lt;/name&gt;
   &lt;version&gt;1.0.0&lt;/version&gt;
   &lt;packaging&gt;jar&lt;/packaging&gt;
   &lt;description&gt;CobiGen - nest Plug-in&lt;/description&gt;

   &lt;properties&gt;
      &lt;!-- External server properties --&gt;
      &lt;plugin.name&gt;${project.artifactId}&lt;/plugin.name&gt;
      &lt;server.name&gt;nestserver&lt;/server.name&gt;
      &lt;server.version&gt;1.0.0&lt;/server.version&gt;
      &lt;server.url&gt;https\://registry.npmjs.org/@devonfw/cobigen-nest-server/-/cobigen-nest-server-${server.version}.tgz&lt;/server.url&gt;
      &lt;server.url.linux&gt;https\://registry.npmjs.org/@devonfw/cobigen-nest-server-linux/-/cobigen-nest-server-linux-${server.version}.tgz&lt;/server.url.linux&gt;
      &lt;server.url.macos&gt;https\://registry.npmjs.org/@devonfw/cobigen-nest-server-macos/-/cobigen-nest-server-macos-${server.version}.tgz&lt;/server.url.macos&gt;
...</code></pre>
</div>
</div>
</li>
<li>
<p>Deploy to Maven Central.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_templates_creation"><a class="anchor" href="#_templates_creation"></a>Templates creation</h5>
<div class="paragraph">
<p>After following above steps, we now have a CobiGen plug-in that connects to a server (external process) which reads your input files, returns a model and is able to merge files.</p>
</div>
<div class="paragraph">
<p>However, we need a key component for our plug-in to be useful. We need to define templates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fork our CobiGen main repository, from <a href="https://github.com/devonfw/cobigen.git">here</a> and clone it into your PC. Stay in the <code>master</code> branch and import into your IDE <code>cobigen-templates\templates-devon4j</code>. Set the Java version of the project to 1.8 if needed.</p>
</li>
<li>
<p>Create a new folder on <code>src/main/templates</code>, this will contain all your templates. You can use any name, but please use underscores as separators. In our case, we created a folder <code>crud_typescript_angular_client_app</code> to generate an Angular client from a TypeORM entity (NodeJS entity).</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/templatesProject.png"><img src="_images/images/howtos/todo-plugin/templatesProject.png" alt="Templates project" width="450"></a>
</div>
</div>
</li>
<li>
<p>Inside your folder, create a <code>templates</code> folder. As you can see below, the folder structure of the generated files starts here (the sources). Also we need a configuration file <code>templates.xml</code> that should be on the same level as <code>templates/</code> folder. For now, copy and paste a <code>templates.xml</code> file from any of the templates folder.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/templatesInside.png"><img src="_images/images/howtos/todo-plugin/templatesInside.png" alt="Templates project" width="450"></a>
</div>
</div>
</li>
<li>
<p>Start creating your own templates. Our default templates language is Freemarker, but you can also use Velocity. Add the extension to the file (<code>.ftl</code>) and start developing templates! You can find useful documentation <a href="https://github.com/devonfw/cobigen/wiki/cobigen-templates_helpful-links">here</a>.</p>
</li>
<li>
<p>After creating all the templates, you need to modify <code>context.xml</code> which is located on the root of <code>src/main/templates</code>. There you need to define a trigger, which is used for CobiGen to know when to trigger a plug-in. I recommend you to copy and paste the following trigger:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">  &lt;trigger id="crud_typescript_angular_client_app" type="nest" templateFolder="crud_typescript_angular_client_app"&gt;
    &lt;matcher type="fqn" value="([^\.]+).entity.ts"&gt;
      &lt;variableAssignment type="regex" key="entityName" value="1"/&gt;
      &lt;variableAssignment type="regex" key="component" value="1"/&gt;
      &lt;variableAssignment type="constant" key="domain" value="demo"/&gt;
    &lt;/matcher&gt;
  &lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Change <code>templateFolder</code> to your templates folder name. <code>id</code> you can use any, but it is recommendable to use the same as the template folder name. <code>type</code> is the <code>TRIGGER_TYPE</code> we defined above on the <code>NestPluginActivator</code> class. On <code>matcher</code> just change the <code>value</code>: <code>([^\.]+).entity.ts</code> means that we will only accept input files that contain <code>anyString.entity.ts</code>. This improves usability, so that users only generate using the correct input files. You will find more info about <code>variableAssignment</code> <a href="https://github.com/devonfw/cobigen/wiki/cobigen-core_configuration#variableassignment-node">here</a>.</p>
</li>
<li>
<p>Finally, is time to configure <code>templates.xml</code>. It is needed for organizing templates into increments, please take a look into this <a href="https://github.com/devonfw/cobigen/wiki/cobigen-core_configuration#templates-configuration">documentation</a>.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="_testing_templates"><a class="anchor" href="#_testing_templates"></a>Testing templates</h6>
<div class="ulist">
<ul>
<li>
<p>When you have finished your templates you will like to test them. On the templates-devon4j <code>pom.xml</code> remove the SNAPSHOT from the version (in our case the version will be 3.1.8). Run <code>mvn clean install -DskipTests</code> on the project. We skip tests because you need special permissions to download artifacts from our Nexus. Remember the version that has just been installed:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/templatesSnapshot.png"><img src="_images/images/howtos/todo-plugin/templatesSnapshot.png" alt="Templates snapshot version" width="550"></a>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We always recommend using the devonfw console, which already contains a working Maven version.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Now we have your last version of the templates ready to be used. We need to use that latest version in CobiGen. We will use the CobiGen CLI that you will find in your cloned repo, at <code>cobigen-cli/cli</code>. Import the project into your IDE.</p>
</li>
<li>
<p>Inside the project, go to <code>src/main/resources/pom.xml</code>. This pom.xml is used on runtime in order to install all the CobiGen plug-ins and templates. Add there your latest templates version and the previously created plug-in:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/cliPom.png"><img src="_images/images/howtos/todo-plugin/cliPom.png" alt="CLI pom" width="450"></a>
</div>
</div>
</li>
<li>
<p>Afterwards, run <code>mvn clean install -DskipTests</code> and CobiGen will get your plug-ins. Now you have three options to test templates:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Using Eclipse run as:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Inside Eclipse, you can run the CobiGen-CLI as a Java application. Right click class <code>CobiGenCLI.java</code> &#8594; run as &#8594; run configurations&#8230;&#8203; and create a new Java application as shown below:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/runConfigurations.png"><img src="_images/images/howtos/todo-plugin/runConfigurations.png" alt="Create configuration" width="450"></a>
</div>
</div>
</li>
<li>
<p>That will create a <code>CobiGenCLI</code> configuration where we can set arguments to the CLI. Let&#8217;s first begin with showing the CLI version, which should print a list of all plug-ins, including ours.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/runAsArgs.png"><img src="_images/images/howtos/todo-plugin/runAsArgs.png" alt="Run version" width="450"></a>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Text hljs" data-lang="Text"> ...
 name:= propertyplugin version = 2.0.0
 name:= jsonplugin version = 2.0.0
 name:= templates-devon4j version = 3.1.8
 name:= nestplugin version = 1.0.0
 ...</code></pre>
</div>
</div>
</li>
<li>
<p>If that worked, now you can send any arguments to the CLI in order to generate with your templates. Please follow <a href="https://github.com/devonfw/cobigen/wiki/howto_Cobigen-CLI-generation">this guide</a> that explains all the CLI commands.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Modify the already present JUnit tests on the CLI project: They test the generation of templates from multiple plug-ins, you can add your own tests and input files.</p>
</li>
<li>
<p>Use the CLI jar to execute commands:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>mvn clean install -DskipTests</code> command will have created a Cobigen.jar inside your target folder (<em>cobigen-cli/cli/target</em>). Open the jar with any unzipper and extract to the current location <em>class-loader-agent.jar</em>, <em>cobigen.bat</em> and <em>cg.bat</em>:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/extractFilesCLI.png"><img src="_images/images/howtos/todo-plugin/extractFilesCLI.png" alt="Extract files" width="450"></a>
</div>
</div>
</li>
<li>
<p>Now you can run any CobiGen CLI commands using a console. <a href="https://github.com/devonfw/cobigen/wiki/howto_Cobigen-CLI-generation">This guide</a> explains all the CLI commands.</p>
<div class="imageblock">
<div class="content">
<a class="image" href=""images/howtos/todo-plugin/runningCLI.png"><img src="_images/images/howtos/todo-plugin/runningCLI.png" alt="Run CLI" width="450"></a>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect4">
<h5 id="_devon4net_cobigen_guide"><a class="anchor" href="#_devon4net_cobigen_guide"></a><span class="navy">devon4net CobiGen Guide</span></h5>
<div class="sect5">
<h6 id="_overview"><a class="anchor" href="#_overview"></a><span class="navy">Overview</span></h6>
<div class="paragraph">
<p>In this guide we will explain how to generate a new <code>WebAPI</code> project from an OpenAPI 3.0.0 specification. This  means that we are going to use a “contract first” strategy. This is going to be possible due to these type of files that contain all the information about entities, operations, etc…</p>
</div>
<div class="paragraph">
<p>In order to make it work we are using <a href="https://github.com/devonfw/cobigen">CobiGen</a>, a powerful tool for generating source code. CobiGen allows users to generate all the structure and code of the components, helping to save a lot of time otherwise wasted on repetitive tasks.</p>
</div>
</div>
<div class="sect5">
<h6 id="_getting_things_ready"><a class="anchor" href="#_getting_things_ready"></a><span class="navy">Getting things ready</span></h6>
<div class="sect6">
<h7 id="_devonfw_ide"><a class="anchor" href="#_devonfw_ide"></a><span class="navy">devonfw-IDE</span></h7>
<div class="paragraph">
<p>First, we will install the devonfw-IDE. It is a tool that will setup your IDE within minutes. Please follow the install guide <a href="https://github.com/devonfw/ide/blob/master/documentation/setup.adoc">here</a>.</p>
</div>
</div>
<div class="sect6">
<h7 id="_devon4net_templates"><a class="anchor" href="#_devon4net_templates"></a><span class="navy">devon4net Templates</span></h7>
<div class="paragraph">
<p>We are going to use the template of devon4net as a base to generate all the code, so what we have to do now is to download said template using the following steps.</p>
</div>
<div class="paragraph">
<p>First of all you have to set up all the environment for .NET, you can do this using <a href="https://devon4net.github.io/environment.html">the following tutorial</a>. Next we are going to create a new folder where we want to have the <code>WebAPI</code> project, lastly we are going to open the terminal there.</p>
</div>
<div class="paragraph">
<p>Type the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`dotnet new -i Devon4Net.WebAPI.Template`</pre>
</div>
</div>
<div class="paragraph">
<p>and then:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`dotnet new Devon4NetAPI`</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="_openapi_file"><a class="anchor" href="#_openapi_file"></a><span class="navy">OpenAPI File</span></h7>
<div class="paragraph">
<p>In order to let CobiGen generate all the files, we first have to make some modifications to our OpenAPI file.</p>
</div>
<div class="paragraph">
<p>It is obligatory to put the <em>“x-rootpackage”</em> tag to indicate where CobiGen will place the generated files as well as the <em>"x-component"</em> tags for each component, keep in mind that due to CobiGen&#8217;s limitations each component <strong><em>must</em></strong> have its own entity.</p>
</div>
<div class="paragraph">
<p>You can read more information about how to configure your OpenAPI file and a working example <a href="https://github.com/devonfw/cobigen/wiki/cobigen-openapiplugin#full-example">here</a>.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_generating_files"><a class="anchor" href="#_generating_files"></a><span class="navy">Generating files</span></h6>
<div class="paragraph">
<p>CobiGen allow us to generate the files in two different ways. One of them is using Eclipse which it can be done by using the its graphical interface. The other way to generate the code is using the CobiGen CLI tool.</p>
</div>
<div class="sect6">
<h7 id="_generating_files_through_eclipse"><a class="anchor" href="#_generating_files_through_eclipse"></a><span class="navy">Generating files through Eclipse</span></h7>
<div class="paragraph">
<p>In order to generate the files using Eclipse we need to follow some simple steps.</p>
</div>
<div class="paragraph">
<p>First we are going to import our basic devon4net <code>WebAPI</code> Project into Eclipse. to do so open Eclipse with the “eclipse-main.bat” file that can be found in the devon distribution root folder. Once we are inside of Eclipse we go to <strong>File &gt; Open projects from file system&#8230;&#8203;</strong> and, under "Directory", search for your project.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="="images/howtos/devon4net/Project_selection.png""><img src="_images/images/howtos/devon4net/Project_selection.png" alt="CobiGen" width="="600""></a>
</div>
</div>
<div class="paragraph">
<p>Next we copy our OpenAPI file into the root folder of the project.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="="images/howtos/devon4net/OpenAPI_file_root_folder.png""><img src="_images/images/howtos/devon4net/OpenAPI_file_root_folder.png" alt="CobiGen" width="="300""></a>
</div>
</div>
<div class="paragraph">
<p>And then we right click on OpenAPI file and then select <strong>CobiGen &gt; Generate&#8230;&#8203;</strong> It will display a window like this:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="="images/howtos/devon4net/cobigen_generate0.png""><img src="_images/images/howtos/devon4net/cobigen_generate0.png" alt="CobiGen" width="="800""></a>
</div>
</div>
<div class="paragraph">
<p>To select all .NET features choose <strong>CRUD devon4net Server</strong> otherwise you can select only those that interest you.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="="images/howtos/devon4net/cobigen_generate1.png"><img src="_images/images/howtos/devon4net/cobigen_generate1.png" alt="CobiGen" width="="800""></a>
</div>
</div>
<div class="paragraph">
<p>Ones you select all the files that you want to generate, click on the <em>“Finish”</em> button to generate all the source code.</p>
</div>
</div>
<div class="sect6">
<h7 id="_generating_files_through_cobigen_cli"><a class="anchor" href="#_generating_files_through_cobigen_cli"></a><span class="navy">Generating files through CobiGen CLI</span></h7>
<div class="paragraph">
<p>In order to generate the files using the CobiGen CLI it is needed to do the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to devonfw distribution folder</p>
</li>
<li>
<p>Run <strong>console.bat</strong>, this will open a console.</p>
</li>
<li>
<p>Go to the folder you downloaded the <strong>devon4net template</strong> and your <strong>yml</strong> file.</p>
</li>
<li>
<p>Run the command:</p>
<div class="literalblock">
<div class="content">
<pre>`cobigen generate {yourOpenAPIFile}.yml`</pre>
</div>
</div>
</li>
<li>
<p>A list of increments will be printed so that you can start the generation. It has to be selected <strong>CRUD devon4net Server</strong> increment.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_configuration"><a class="anchor" href="#_configuration"></a><span class="navy">Configuration</span></h6>
<div class="sect6">
<h7 id="_data_base"><a class="anchor" href="#_data_base"></a><span class="navy">Data base</span></h7>
<div class="paragraph">
<p>CobiGen is generating an empty context that has to be filled with manually in order to be able to work with the database. The context can be found in <code><strong>[Project_Name]/Devon4Net.WebAPI.Implementation/Domain/Database/CobigenContext.cs</strong></code>.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="="images/howtos/devon4net/CobigenContextLocation.png"><img src="_images/images/howtos/devon4net/CobigenContextLocation.png" alt="CobiGen" width="="350""></a>
</div>
</div>
</div>
<div class="sect6">
<h7 id="_run_the_application"><a class="anchor" href="#_run_the_application"></a><span class="navy">Run the application</span></h7>
<div class="paragraph">
<p>After the configuration of the database, open a terminal in path: <code><strong>[Project_Name]/Devon4Net.Application.WebAPI</strong></code> and then type:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`dotnet run`</pre>
</div>
</div>
<div class="paragraph">
<p>This will deploy our application in our localhost with the port 8082, so when you click <a href="https://localhost:8082/swagger/index.html">here</a> (<a href="https://localhost:8082/swagger" class="bare">https://localhost:8082/swagger</a>) you can see, in swagger, all the services and the data model.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==How to update CobiGen</p>
</div>
<div class="paragraph">
<p>In order to update CobiGen from our devonfw distribution, we have two options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open Eclipse, click on <em>Help</em> &#8594; <em>Check for updates</em></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/update_CobiGen/check_updates.png"><img src="_images/images/howtos/update_CobiGen/check_updates.png" alt="Check updates" width="450"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select all the CobiGen plugins listed and click on <em>Next</em>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/update_CobiGen/all_updates.png"><img src="_images/images/howtos/update_CobiGen/all_updates.png" alt="All the updates" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>If this option is not working properly, then you can try the second option:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open Eclipse, click on <em>Help</em> &#8594; <em>About Eclipse IDE</em>:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/update_CobiGen/about_eclipse.png"><img src="_images/images/howtos/update_CobiGen/about_eclipse.png" alt="About Eclipse" width="450"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Click on <em>Installation details</em>:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/update_CobiGen/installation_details.png"><img src="_images/images/howtos/update_CobiGen/installation_details.png" alt="Installation details" width="350"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select all the CobiGen plugins and click on <em>Update</em>:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/update_CobiGen/details_all_udpates.png"><img src="_images/images/howtos/update_CobiGen/details_all_udpates.png" alt="All updates details" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>After the update process finishes, remember to restart Eclipse.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_updating_templates"><a class="anchor" href="#_updating_templates"></a>Updating templates:</h5>
<div class="paragraph">
<p>To update your CobiGen templates to the latest version, you just need to do one step:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Right click any file on your package explorer, click on <em>CobiGen</em> &#8594; <em>Update templates</em>, then click on <em>download</em>:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/update_CobiGen/update_templates.png"><img src="_images/images/howtos/update_CobiGen/update_templates.png" alt="Update templates" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>Now you will have the latest templates ready!</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/master-cobigen.adoc - include::howto-Cobigen-CLI-generation.adoc[]</p>
</div>
<!-- toc disabled -->
<div class="paragraph text-center">
<p>==End to End POC Code generation using Entity class
This article helps to create a sample application using cobigen.</p>
</div>
</div>
<div class="sect4">
<h5 id="_prerequisites_3"><a class="anchor" href="#_prerequisites_3"></a>Prerequisites</h5>
<div class="paragraph">
<p>Download and install devonnfw IDE <a href="https://devonfw.com/website/pages/docs/devonfw-ide-introduction.adoc.html#setup.adoc">here</a>,</p>
</div>
</div>
<div class="sect4">
<h5 id="_steps_to_create_a_sample_project_using_cobigen"><a class="anchor" href="#_steps_to_create_a_sample_project_using_cobigen"></a>Steps to create a Sample Project using Cobigen</h5>
<div class="paragraph">
<p>The HOW_TO is divided in 2 parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>BE-Back End generator (DB + DAO + services) – CONTRACT FIRST APPROACH</p>
</li>
<li>
<p>FE-Front End generator (Web App Angular + Ionic App) – CONTRACT FIRST APPROACH</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image9.png" alt="cobigen ionic code genartion"></span></p>
</div>
<div class="paragraph">
<p>So, ready to go! We’re going to start from the BE part …</p>
</div>
<div class="sect5">
<h6 id="_back_end"><a class="anchor" href="#_back_end"></a>Back End</h6>
<div class="paragraph">
<p>run \devonfw-ide-scripts-3.2.4\eclipse-main.bat</p>
</div>
<div class="paragraph">
<p>It will open eclipse</p>
</div>
<div class="paragraph">
<p>create a project using below command from the command prompt</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">devon java create com.example.domain.myapp</code></pre>
</div>
</div>
<div class="paragraph">
<p>Import the project to eclipse as maven project
<span class="image"><img src="_images/images/howtos/e2e_gen/image14.png" alt="eclipse devon"></span></p>
</div>
<div class="paragraph">
<p>Click <strong>FINISH</strong></p>
</div>
<div class="paragraph">
<p>Now We have the following 4 projects.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image15.png" alt="eclipse package explorer"></span></p>
</div>
<div class="paragraph">
<p><strong>BEFORE to start to create an Entity class, remember to create the tables !</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Create a new <strong>SQL</strong> <strong>file</strong> (i.e: V0005<em>CreateTables-ItaPoc.sql) inside </em>myapp-__core and insert the following script:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE TABLE EMPLOYEE (
id BIGINT auto_increment, modificationCounter INTEGER NOT NULL,
employeeid BIGINT auto_increment,
name VARCHAR(255),
surname VARCHAR(255),
email VARCHAR(255),
PRIMARY KEY (employeeid)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><em>WARNING</em></strong>: please note that there are 2 underscore in the name !</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image16.png" alt="sql file"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Now create another SQL file (i.e: V0006__PopulateTables-ItaPoc.sql) and add following script about the INSERT in order to populate the table created before</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong><em>WARNING</em></strong>: please note that there are 2 underscore in the name !</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO EMPLOYEE (id, modificationCounter, employeeid, name, surname,email) VALUES (1, 1, 1, 'Albert','Miller','albert.miller@capgemini.com');
INSERT INTO  EMPLOYEE (id, modificationCounter, employeeid, name, surname,email) VALUES (2, 2, 2, 'Wills','Smith', 'wills.smith@capgemini.com');
INSERT INTO EMPLOYEE (id, modificationCounter, employeeid, name, surname,email) VALUES (3, 3, 3, 'Jaime','Thomas', 'jaime.thomas@capgemini.com');</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image17.png" alt="sql insert"></span></p>
</div>
<div class="paragraph">
<p><strong>Let&#8217;s create the Entity Class for the code generation</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Create a package <strong>employeemanagement.dataaccess.api</strong> under the folder myapp-core. Note: It is important to follow this naming convention for CobiGen to work properly.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/poc-entity-package.png" alt="package"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Now create a JPA Entity class in this package</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Column;
@Entity
@javax.persistence.Table(name = "EMPLOYEE")
public class EmployeeEntity {
  @Column(name = "EMPLOYEEID")
  @GeneratedValue(strategy = GenerationType.IDENTITY)
  private Long employeeId;
  @Column(name = "NAME")
  private String name;
  @Column(name = "SURNAME")
  private String surname;
  @Column(name = "EMAIL")
  private String email;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>then generate getters and setters  for all attributes …</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>Use Cobigen to generate code. Right click on EmployeeEntity. CobiGen &#8594; Generate</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It will ask you to download the templates, click on <em>update</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image19.png" alt="cobigen generate"></span></p>
</div>
<div class="paragraph">
<p>It will automatically download the latest version of <em>CobiGen_Templates</em>.</p>
</div>
<div class="paragraph">
<p><strong>Attention:</strong> If you want to adapt the CobiGen_Templates, (normally this is not neccessary), you will find at the end of this document a tutorial on how to import them and adapt them!</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p>Click on all the option selected as below:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image20.png" alt="cobigen option selection"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="12">
<li>
<p>Click on finish. Below Screen would be seen. Click on continue</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image21.png" alt="cobigen finish"></span></p>
</div>
<div class="paragraph">
<p><strong>The entire <span class="underline">BE layer</span> structure having CRUD operation methods will be auto generated.</strong></p>
</div>
<div class="paragraph">
<p>Some classes will be generated on the api part (<em>myapp-api)</em>, normally it will be interfaces, as shown below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image22.png" alt="be layer"></span></p>
</div>
<div class="paragraph">
<p>Some other classes will be generated on the core part (<em>myapp-core)</em>, normally it will be implementations as shown below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image23.png" alt="core folder"></span></p>
</div>
<div class="paragraph">
<p><strong>BEFORE to generate the FE</strong>, please start the Tomcat server to check that BE Layer has been generated properly.</p>
</div>
<div class="paragraph">
<p>To start a server you just have to right click on <em>SpringBootApp.java</em> &#8594; <em>run as &#8594; Spring Boot app</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image24.png" alt="Eclipse run as"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image25.png" alt="Spring boot run"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image26.png" alt="Spring boot run"></span></p>
</div>
<div class="paragraph">
<p><strong>BE DONE</strong></p>
</div>
<div class="paragraph">
<p>Last but not least: We make a quick REST services test !</p>
</div>
<div class="paragraph">
<p>See in the application.properties the TCP Port and the PATH</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image27.png" alt="application properties"></span></p>
</div>
<div class="paragraph">
<p>Now compose the Rest service URL:</p>
</div>
<div class="paragraph">
<p>service class path&gt;/&lt;service method path&gt;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;server&gt; refers to server with port no. (ie: localhost:8081)</p>
</li>
<li>
<p>&lt;app&gt; is in the application.propeeties (empty in our case, see above)</p>
</li>
<li>
<p>&lt;rest service class path&gt; refers to EmployeemanagementRestService: (i.e: /employeemanagement/v1)</p>
</li>
<li>
<p>&lt;service method path&gt;/employee/{id}  (i.e: for  getEmployee method)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image28.png" alt="url mapping"></span></p>
</div>
<div class="paragraph">
<p>URL of getEmployee for this example is:</p>
</div>
<div class="paragraph">
<p>for all employees</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:8081/services/rest/employeemanagement/v1/employee/search</code></pre>
</div>
</div>
<div class="paragraph">
<p>for the specific employee</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:8081/services/rest/employeemanagement/v1/employee/1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now download <a href="https://www.getpostman.com/apps">Postman</a> to test the rest services.</p>
</div>
<div class="paragraph">
<p>Once done, you have to create a POST Request for the LOGIN and insert in the body the JSON containing the username and password <em>waiter</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image29.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Once done with success (<strong>Status: 200 OK</strong>) …</p>
</div>
<div class="paragraph">
<p>… We create a NEW GET Request in order to get one employee</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image30.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Now you can click <span class="image"><img src="_images/images/howtos/e2e_gen/image34.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Now you ‘ve to check that response has got Status: 200 OK and to see the below Employee</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image31.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Now that We have successfully tested the BE is time to go to create the FE !</p>
</div>
</div>
<div class="sect5">
<h6 id="_front_end"><a class="anchor" href="#_front_end"></a>Front End</h6>
<div class="paragraph">
<p>Let’s start now with angular Web and then Ionic app.</p>
</div>
<div class="sect6">
<h7 id="_angular_web_app"><a class="anchor" href="#_angular_web_app"></a>Angular Web App</h7>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To generate angular structure, download or clone <strong>devon4ng-application-template</strong> from</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/devon4ng-application-template</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image36.png" alt="devon dist folder"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Once done, right click on EmployeeEto.java  file present under the package <em>com.devonfw.poc.employeemanagement.logic.api.to</em></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image37.png" alt="eclipse generate"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click on Finish</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image38.png" alt="eclipse"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>The entire ANGULAR structure has been auto generated. The generated code will be merged to the existing.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image39.png" alt="angular ee layer"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>IMPORTANT now you have to add in the <strong><em>app-routing.module.ts</em></strong> file the next content, as a child of HomeComponent, in order to enable the route of the new generated component</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">,\{
path: 'employee',
component: EmployeeGridComponent,
canActivate: [AuthGuard],
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>Following picture explain where to place the above content:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image40.png" alt="routes"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Open the command prompt and execute <em>devon yarn install</em> from the base folder, which would download all the required libraries..</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Check the file <strong>environment.ts</strong> if the server path is correct. (for production you will have to change also the environment.prod.ts file)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image42.png" alt="environment"></span></p>
</div>
<div class="paragraph">
<p>In order to do that it’s important to look at the application.properties to see the values as PATH, TCP port etc …</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image43.png" alt="configure"></span></p>
</div>
<div class="paragraph">
<p>For example in this case the URL should be since the context path is empty the server URLS should be like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export const environment = {
production: false,
restPathRoot: 'http://localhost:8081/',
restServiceRoot: 'http://localhost:8081/services/rest/',
security: 'jwt'
};</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Warning</strong>: REMEMBER to set security filed to <strong>jwt</strong> , if it is not configured already.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Now run the <strong>ng serve -o</strong> command to run the Angular Application.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image44.png" alt="image44"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>If the command execution is <strong>successful</strong>, the below screen will <strong>appear</strong> and it would be automatically redirected to the url:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:4200/login</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image45.png" alt="image45"></span></p>
</div>
<div class="paragraph">
<p><strong>WebApp DONE</strong></p>
</div>
</div>
<div class="sect6">
<h7 id="_ionic_mobile_app"><a class="anchor" href="#_ionic_mobile_app"></a>Ionic Mobile App</h7>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To generate Ionic structure, download or clone <strong>devon4ng-application-template</strong> from</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/devon4ng-ionic-application-template</code></pre>
</div>
</div>
</li>
<li>
<p>Once done, Right click on the <strong>EmployeeEto</strong> as you already did before in order to use CobiGen.</p>
</li>
<li>
<p>Click on the selected options as seen in the screenshot:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image46.png" alt="image46"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click on Finish</p>
</li>
<li>
<p>The entire ionic structure will be auto generated.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image47.png" alt="image47"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Change the server url (with correct serve url) in environment.ts, environment.prod.ts and environment.android.ts files (i.e: itapoc\devon4ng-ionic-application-template\src\environments\).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The angular.json file inside the project has already a build configuration for android.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image48.png" alt="image48"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Run npm install in the root folder to download the dependecies</p>
</li>
<li>
<p>Run ionic serve</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image49.png" alt="image49"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p></p>
<div class="paragraph">
<p>Once the execution is successful</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image50.png" alt="image50"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mobile App DONE*</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So: well done</p>
</div>
<div class="paragraph">
<p>Starting from an Entity class you’ve successfully generated the Back-End layer (REST, SOAP, DTO, Spring services, Hibernate DAO), the Angular Web App and the Ionic mobile App!</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image51.png" alt="image51"></span></p>
</div>
<div class="sect7">
<h8 id="_build_apk"><a class="anchor" href="#_build_apk"></a>Build APK</h8>
<div class="paragraph">
<p>Since We’re going to create apk remember the following pre-conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://gradle.org/install/">Gradle</a></p>
</li>
<li>
<p><a href="https://developer.android.com/studio">Android Studio</a></p>
</li>
<li>
<p><a href="https://developer.android.com/studio/#command-tools">Android sdk</a></p>
</li>
<li>
<p><a href="https://capacitor.ionicframework.com/docs/getting-started/">Capacitor</a></p>
</li>
</ul>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Now, open cmd and type the path where your <em>devon4ng-ionic-application-template</em> project is present.</p>
</li>
<li>
<p>Run the following commands:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>npx cap init</p>
</li>
<li>
<p>ionic build --configuration=android</p>
</li>
<li>
<p>npx cap add android</p>
</li>
<li>
<p>npx cap copy</p>
</li>
<li>
<p>npx cap open android</p>
</li>
</ol>
</div>
</li>
<li>
<p>Build the APK using Android studio.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image52.png" alt="image52"></span>
<span class="image"><img src="_images/images/howtos/e2e_gen/image53.png" alt="image53"></span>
<span class="image"><img src="_images/images/howtos/e2e_gen/image54.png" alt="image54"></span>
<span class="image"><img src="_images/images/howtos/e2e_gen/image55.png" alt="image55"></span></p>
</div>
<div class="paragraph">
<p>You can find your apk file in</p>
</div>
<div class="paragraph">
<p>/devon4ng-ionic-application-template/android/app/build/outputs/apk/debug</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_adapt_cobigen_templates"><a class="anchor" href="#_adapt_cobigen_templates"></a>Adapt CobiGen_Templates</h5>
<div class="paragraph">
<p>After following this tutorial, you will have the CobiGen_Templates downloaded on your local machine. To import these templates you need to do the following:</p>
</div>
<div class="paragraph">
<p>Right click in any part of the package explorer, then click on CobiGen &#8594; Adapt templates</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image56.png" alt="image56"></span></p>
</div>
<div class="paragraph">
<p>Click <em>Ok</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image57.png" alt="image57"></span></p>
</div>
<div class="paragraph">
<p>Now the CobiGen_Templates project will be automatically imported into your workspace, as shown on the image below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image58.png" alt="image58"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image59.png" alt="image59"></span></p>
</div>
<div class="paragraph">
<p>Now you just need to change the Java version of the project to JRE 1.8. Right click on the JRE system library, and then on <em>Properties:</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image60.png" alt="image60"></span></p>
</div>
<div class="paragraph">
<p>Now change the version to Java 1.8
<span class="image"><img src="_images/images/howtos/e2e_gen/image61.png" alt="image61"></span></p>
</div>
<div class="paragraph">
<p>Now you have successfully imported the CobiGen templates. If you want to edit them, you will find them in the folder <em>src/main/templates.</em> For instance, the Java templates are located here:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image62.png" alt="image62"></span></p>
</div>
<div class="paragraph">
<p>Now you can adapt the templates as much as you want. Documentation about this can be found on:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/tools-cobigen/wiki/Guide-to-the-Reader</code></pre>
</div>
</div>
<!-- toc disabled -->
<!-- toc disabled -->
<div class="paragraph text-center">
<p>==End to End POC Code generation using OpenAPI
This article helps to create a sample application using cobigen.</p>
</div>
</div>
<div class="sect4">
<h5 id="_prerequisites_4"><a class="anchor" href="#_prerequisites_4"></a>Prerequisites</h5>
<div class="paragraph">
<p>Download and install devonnfw IDE <a href="https://devonfw.com/website/pages/docs/devonfw-ide-introduction.adoc.html#setup.adoc">here</a>,</p>
</div>
</div>
<div class="sect4">
<h5 id="_steps_to_create_a_sample_project_using_cobigen_2"><a class="anchor" href="#_steps_to_create_a_sample_project_using_cobigen_2"></a>Steps to create a Sample Project using Cobigen</h5>
<div class="paragraph">
<p>The HOW_TO is divided in 2 parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>BE-Back End generator (DB + DAO + services) – CONTRACT FIRST APPROACH</p>
</li>
<li>
<p>FE-Front End generator (Web App Angular + Ionic App) – CONTRACT FIRST APPROACH</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image9.png" alt="cobigen ionic code genartion"></span></p>
</div>
<div class="paragraph">
<p>So, ready to go! We’re going to star</p>
</div>
<div class="paragraph">
<p>t from the BE part …</p>
</div>
<div class="sect5">
<h6 id="_back_end_2"><a class="anchor" href="#_back_end_2"></a>Back End</h6>
<div class="paragraph">
<p>run \devonfw-ide-scripts-3.2.4\eclipse-main.bat</p>
</div>
<div class="paragraph">
<p>It will open eclipse</p>
</div>
<div class="paragraph">
<p>create a project using below command from the command prompt</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">devon java create com.example.domain.myapp</code></pre>
</div>
</div>
<div class="paragraph">
<p>Import the project to eclipse as maven project
<span class="image"><img src="_images/images/howtos/e2e_gen/image14.png" alt="eclipse devon"></span></p>
</div>
<div class="paragraph">
<p>Click <strong>FINISH</strong></p>
</div>
<div class="paragraph">
<p>Now We have the following 4 projects.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image15.png" alt="eclipse package explorer"></span></p>
</div>
<div class="paragraph">
<p><strong>BEFORE to start to create an Entity class, remember to create the tables !</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Create a new <strong>SQL</strong> <strong>file</strong> (i.e: V0005<em>CreateTables_ItaPoc.sql) inside </em>jwtsample-__core and insert the following script:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE TABLE EMPLOYEE (
id BIGINT auto_increment, modificationCounter *INTEGER* *NOT* *NULL*,
employeeid BIGINT auto_increment,
name VARCHAR(255),
surname VARCHAR(255),
email VARCHAR(255),
PRIMARY KEY (employeeid)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><em>WARNING</em></strong>: please note that there are 2 underscore in the name !</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image16.png" alt="sql file"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Now create another SQL file (i.e: V0006__PopulateTables-ItaPoc.sql) and add following script about the INSERT in order to populate the table created before</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong><em>WARNING</em></strong>: please note that there are 2 underscore in the name !</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO EMPLOYEE (id, modificationCounter, employeeid, name, surname,email) VALUES (1, 1, 1, 'Stefano','Rossini','stefano.rossini@capgemini.com');
INSERT INTO EMPLOYEE (id, modificationCounter, employeeid, name, surname,email) VALUES (2, 2, 2, 'Angelo','Muresu', 'angelo.muresu@capgemini.com');
INSERT INTO EMPLOYEE (id, modificationCounter, employeeid, name, surname,email) VALUES (3, 3, 3, 'Jaime','Gonzalez', 'jaime.diaz-gonzalez@capgemini.com');</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image17.png" alt="sql insert"></span></p>
</div>
<div class="paragraph">
<p><strong>Let&#8217;s create the yml file for the code generation</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Now create a new file <em>devonfw.yml</em> in the root of your core folder. This will be our OpenAPI contract, like shown below. Then, copy the contents of <a href="https://github.com/devonfw/tools-cobigen/blob/master/documentation/files/devonfw_employee.yml">this file</a> into your OpenAPI. It defines some REST service endpoints and a <em>EmployeeEntity</em> with its properties defined.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Important:</strong> if you want to know how to write an OpenAPI contract compatible with CobiGen, please read <a href="https://github.com/devonfw/tools-cobigen/wiki/cobigen-openapiplugin#usage">this tutorial</a>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image18.png" alt="Swagger at OASP4J Project"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>Right click <em>devonfw.yml</em>. CobiGen &#8594; Generate</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It will ask you to download the templates, click on <em>update</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image19.png" alt="cobigen generate"></span></p>
</div>
<div class="paragraph">
<p>It will automatically download the latest version of <em>CobiGen_Templates</em>.</p>
</div>
<div class="paragraph">
<p><strong>Attention:</strong> If you want to adapt the CobiGen_Templates, (normally this is not neccessary), you will find at the end of this document a tutorial on how to import them and adapt them!</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p>Click on all the option selected as below:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image20.png" alt="cobigen option selection"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="12">
<li>
<p>Click on finish. Below Screen would be seen. Click on continue</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image21.png" alt="cobigen finish"></span></p>
</div>
<div class="paragraph">
<p><strong>The entire <span class="underline">BE layer</span> structure having CRUD operation methods will be auto generated.</strong></p>
</div>
<div class="paragraph">
<p>Some classes will be generated on the api part (<em>jwtsample-api)</em>, normally it will be interfaces, as shown below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image22.png" alt="be layer"></span></p>
</div>
<div class="paragraph">
<p>Some other classes will be generated on the core part (<em>jwtsample-core)</em>, normally it will be implementations as shown below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image23.png" alt="core folder"></span></p>
</div>
<div class="paragraph">
<p><strong>BEFORE to generate the FE</strong>, please start the Tomcat server to check that BE Layer has been generated properly.</p>
</div>
<div class="paragraph">
<p>To start a server you just have to right click on <em>SpringBootApp.java</em> &#8594; <em>run as &#8594; Spring Boot app</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image24.png" alt="Eclipse run as"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image25.png" alt="Spring boot run"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image26.png" alt="Spring boot run"></span></p>
</div>
<div class="paragraph">
<p><strong>BE DONE</strong></p>
</div>
<div class="paragraph">
<p>Last but not least: We make a quick REST services test !</p>
</div>
<div class="paragraph">
<p>See in the application.properties the TCP Port and the PATH</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image27.png" alt="application properties"></span></p>
</div>
<div class="paragraph">
<p>Now compose the Rest service URL:</p>
</div>
<div class="paragraph">
<p>service class path&gt;/&lt;service method path&gt;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;server&gt; refers to server with port no. (ie: localhost:8081)</p>
</li>
<li>
<p>&lt;app&gt; is in the application.propeeties (empty in our case, see above)</p>
</li>
<li>
<p>&lt;rest service class path&gt; refers to EmployeemanagementRestService: (i.e: /employeemanagement/v1)</p>
</li>
<li>
<p>&lt;service method path&gt;/employee/{id}  (i.e: for  getEmployee method)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image28.png" alt="url mapping"></span></p>
</div>
<div class="paragraph">
<p>URL of getEmployee for this example is:</p>
</div>
<div class="paragraph">
<p>For all employees</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:8081/services/rest/employeemanagement/v1/employee/search</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the specific employee</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:8081/services/rest/employeemanagement/v1/employee/1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now download <a href="https://www.getpostman.com/apps">Postman</a> to test the rest services.</p>
</div>
<div class="paragraph">
<p>Once done, you have to create a POST Request for the LOGIN and insert in the body the JSON containing the username and password <em>waiter</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image29.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Once done with success (<strong>Status: 200 OK</strong>) …</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image30.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>… We create a NEW POST Request and We copy the Authorization Bearer field (see above) and We paste it in the Token field (see below)</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image31.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>and specific the JSON parameters for the pagination of the Request that We’re going to send:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image32.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image33.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Now you can click <span class="image"><img src="_images/images/howtos/e2e_gen/image34.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Now you ‘ve to check that response has got <strong>Status: 200 OK</strong> and to see the below list of Employee</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image35.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Now that We have successfully tested the BE is time to go to create the FE !</p>
</div>
</div>
<div class="sect5">
<h6 id="_front_end_2"><a class="anchor" href="#_front_end_2"></a>Front End</h6>
<div class="paragraph">
<p>Let’s start now with angular Web and then Ionic app.</p>
</div>
<div class="sect6">
<h7 id="_angular_web_app_2"><a class="anchor" href="#_angular_web_app_2"></a>Angular Web App</h7>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To generate angular structure, download or clone <em>*devon4ng-application-template*</em> from</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/devon4ng-application-template</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image36.png" alt="devon dist folder"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Once done, right click on <em>devonfw.yml</em> again (the OpenAPI contract). CobiGen &#8594; Generate</p>
</li>
<li>
<p>Click on the selected options as seen in the screenshot:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image37.png" alt="eclipse generate"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click on Finish</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image38.png" alt="eclipse"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>The entire ANGULAR structure has been auto generated. The generated code will be merged to the existing.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image39.png" alt="angular ee layer"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>IMPORTANT now you have to add in the <strong><em>app-routing.module.ts</em></strong> file the next content, as a child of HomeComponent, in order to enable the route of the new generated component</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">,\{
path: 'employee',
component: EmployeeGridComponent,
canActivate: [AuthGuard],
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>Following picture explain where to place the above content:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image40.png" alt="routes"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Open the command prompt and execute <em>devon yarn install</em> from the base folder, which would download all the required libraries..</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Check the file <strong>environment.ts</strong> if the server path is correct. (for production you will have to change also the environment.prod.ts file)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image42.png" alt="environment"></span></p>
</div>
<div class="paragraph">
<p>In order to do that it’s important to look at the application.properties to see the values as PATH, TCP port etc …</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image43.png" alt="configure"></span></p>
</div>
<div class="paragraph">
<p>For example in this case the URL should be since the context path is empty the server URLS should be like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export const environment = {
production: false,
restPathRoot: 'http://localhost:8081/',
restServiceRoot: 'http://localhost:8081/services/rest/',
security: 'jwt'
};</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Warning</strong>: REMEMBER to set security filed to <strong>jwt</strong> , if it is not configured already.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Now run the <em>*ng serve -o*</em> command to run the Angular Application.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image44.png" alt="image44"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>If the command execution is <strong>successful</strong>, the below screen will <strong>appear</strong> and it would be automatically redirected to the url:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:4200/login</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image45.png" alt="image45"></span></p>
</div>
<div class="paragraph">
<p><strong>WebApp DONE</strong></p>
</div>
</div>
<div class="sect6">
<h7 id="_ionic_mobile_app_2"><a class="anchor" href="#_ionic_mobile_app_2"></a>Ionic Mobile App</h7>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To generate Ionic structure, download or clone <em>*devon4ng-application-template*</em> from</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/devon4ng-ionic-application-template</code></pre>
</div>
</div>
</li>
<li>
<p>Once done, Right click on the <strong><em>devonfw.yml</em></strong> as you already did before in order to use CobiGen.</p>
</li>
<li>
<p>Click on the selected options as seen in the screenshot:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image46.png" alt="image46"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click on Finish</p>
</li>
<li>
<p>The entire ionic structure will be auto generated.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image47.png" alt="image47"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Change the server url (with correct serve url) in environment.ts, environment.prod.ts and environment.android.ts files (i.e: itapoc\devon4ng-ionic-application-template\src\environments\).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The angular.json file inside the project has already a build configuration for android.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image48.png" alt="image48"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Run npm install in the root folder to download the dependecies</p>
</li>
<li>
<p>Run ionic serve</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image49.png" alt="image49"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p></p>
<div class="paragraph">
<p>Once the execution is successful</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image50.png" alt="image50"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mobile App DONE*</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So: well done</p>
</div>
<div class="paragraph">
<p>Starting from an Entity class you’ve successfully generated the Back-End layer (REST, SOAP, DTO, Spring services, Hibernate DAO), the Angular Web App and the Ionic mobile App!</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image51.png" alt="image51"></span></p>
</div>
<div class="sect7">
<h8 id="_build_apk_2"><a class="anchor" href="#_build_apk_2"></a>Build APK</h8>
<div class="paragraph">
<p>Since We’re going to create apk remember the following pre-conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://gradle.org/install/">Gradle</a></p>
</li>
<li>
<p><a href="https://developer.android.com/studio">Android Studio</a></p>
</li>
<li>
<p><a href="https://developer.android.com/studio/#command-tools">Android sdk</a></p>
</li>
<li>
<p><a href="https://capacitor.ionicframework.com/docs/getting-started/">Capacitor</a></p>
</li>
</ul>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Now, open cmd and type the path where your <em>devon4ng-ionic-application-template</em> project is present.</p>
</li>
<li>
<p>Run the following commands:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>npx cap init</p>
</li>
<li>
<p>ionic build --configuration=android</p>
</li>
<li>
<p>npx cap add android</p>
</li>
<li>
<p>npx cap copy</p>
</li>
<li>
<p>npx cap open android</p>
</li>
</ol>
</div>
</li>
<li>
<p>Build the APK using Android studio.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image52.png" alt="image52"></span>
<span class="image"><img src="_images/images/howtos/e2e_gen/image53.png" alt="image53"></span>
<span class="image"><img src="_images/images/howtos/e2e_gen/image54.png" alt="image54"></span>
<span class="image"><img src="_images/images/howtos/e2e_gen/image55.png" alt="image55"></span></p>
</div>
<div class="paragraph">
<p>You can find your apk file in</p>
</div>
<div class="paragraph">
<p>/devon4ng-ionic-application-template/android/app/build/outputs/apk/debug</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_adapt_cobigen_templates_2"><a class="anchor" href="#_adapt_cobigen_templates_2"></a>Adapt CobiGen_Templates</h5>
<div class="paragraph">
<p>After following this tutorial, you will have the CobiGen_Templates downloaded on your local machine. To import these templates you need to do the following:</p>
</div>
<div class="paragraph">
<p>Right click in any part of the package explorer, then click on CobiGen &#8594; Adapt templates</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image56.png" alt="image56"></span></p>
</div>
<div class="paragraph">
<p>Click <em>Ok</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image57.png" alt="image57"></span></p>
</div>
<div class="paragraph">
<p>Now the CobiGen_Templates project will be automatically imported into your workspace, as shown on the image below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image58.png" alt="image58"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image59.png" alt="image59"></span></p>
</div>
<div class="paragraph">
<p>Now you just need to change the Java version of the project to JRE 1.8. Right click on the JRE system library, and then on <em>Properties:</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image60.png" alt="image60"></span></p>
</div>
<div class="paragraph">
<p>Now change the version to Java 1.8
<span class="image"><img src="_images/images/howtos/e2e_gen/image61.png" alt="image61"></span></p>
</div>
<div class="paragraph">
<p>Now you have successfully imported the CobiGen templates. If you want to edit them, you will find them in the folder <em>src/main/templates.</em> For instance, the Java templates are located here:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image62.png" alt="image62"></span></p>
</div>
<div class="paragraph">
<p>Now you can adapt the templates as much as you want. Documentation about this can be found on:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/tools-cobigen/wiki/Guide-to-the-Reader</code></pre>
</div>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Adapt Templates from CobiGen</p>
</div>
</div>
<div class="sect4">
<h5 id="_adapt_cobigen_templates_3"><a class="anchor" href="#_adapt_cobigen_templates_3"></a>Adapt CobiGen_Templates</h5>
<div class="paragraph">
<p>After following this tutorial, you will have the CobiGen_Templates downloaded on your local machine. To import these templates you need to do the following:</p>
</div>
<div class="paragraph">
<p>Right click in any part of the package explorer, then click on CobiGen &#8594; Adapt templates</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image56.png" alt="image56"></span></p>
</div>
<div class="paragraph">
<p>Click OK:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image57.png" alt="image57"></span></p>
</div>
<div class="paragraph">
<p>Now the CobiGen_Templates project will be automatically imported into your workspace, as shown on the image below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image58.png" alt="image58"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image59.png" alt="image59"></span></p>
</div>
<div class="paragraph">
<p>Now you just need to change the Java version of the project to JRE 1.8. Right click on the JRE system library, and then on <em>Properties:</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image60.png" alt="image60"></span></p>
</div>
<div class="paragraph">
<p>Now change the version to Java 1.8
<span class="image"><img src="_images/images/howtos/e2e_gen/image61.png" alt="image61"></span></p>
</div>
<div class="paragraph">
<p>Now you have successfully imported the CobiGen templates. If you want to edit them, you will find them in the folder <code><em>src/main/templates.</em></code> For instance, the Java templates are located here:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image62.png" alt="image62"></span></p>
</div>
<div class="paragraph">
<p>Now you can adapt the templates as much as you want. Documentation about this can be found on:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/tools-cobigen/wiki/Guide-to-the-Reader</code></pre>
</div>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Enable Composite Primary Keys in Entity</p>
</div>
<div class="paragraph">
<p>In order to enable Composite Primary Keys in entity in CobiGen, the below approach is suggested</p>
</div>
<div class="paragraph">
<p>The templates in CobiGen have been enhanced to support Composite primary keys while still supporting the default <code>devonfw/Cobigen</code> values with Long id.</p>
</div>
<div class="paragraph">
<p>Also, the current generation from Entity still holds good - right click from an Entity object, CobiGen &#8594; Generate will show the CobiGen wizard relative to the entity generation.</p>
</div>
<div class="paragraph">
<p>After generating, below example shows how composite primary keys can be enabled.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Entity
@Table(name = "employee")
public class EmployeeEntity {
	private CompositeEmployeeKey id;
	private String name;
	private String lastName;
	@Override
	@EmbeddedId
	public CompositeEmployeeKey getId() {
		return id;
	}
	@Override
	public void setId(CompositeEmployeeKey id) {
		this.id = id;
	}
	.
	.
	.</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class CompositeEmployeeKey implements Serializable {
  private String companyId;
  private String employeeId;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the generation is complete, implement <code>PersistenceEntity&lt;ID&gt;</code>.java in the <code>EmployeeEntity</code> and pass the composite primary key object which is <code>CompositeEmployeeKey</code> in this case as the parameter <code>ID</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import com.devonfw.module.basic.common.api.entity.PersistenceEntity;
@Entity
@Table(name = "employee")
public class EmployeeEntity implements PersistenceEntity&lt;CompositeEmployeeKey&gt; {
	private CompositeEmployeeKey id;
	private String name;
	private String lastName;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, the <code>modificationCounter</code> methods needs to be implemented from the interface <code>PersistenceEntity&lt;ID&gt;</code>. The sample implementation of the modification counter can be referred below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
  public int getModificationCounter() {
    if (this.persistentEntity != null) {
      // JPA implementations will update modification counter only after the transaction has been committed.
      // Conversion will typically happen before and would result in the wrong (old) modification counter.
      // Therefore we update the modification counter here (that has to be called before serialization takes
      // place).
      this.modificationCounter = this.persistentEntity.getModificationCounter();
    }
    return this.modificationCounter;
  }
  @Override
  public void setModificationCounter(int version) {
    this.modificationCounter = version;
  }</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_template_development"><a class="anchor" href="#_template_development"></a>Template Development</h2>
<div class="sectionbody">
<div class="sect4">
<h5 id="_helpful_links_for_template_development"><a class="anchor" href="#_helpful_links_for_template_development"></a>Helpful links for template development</h5>
<div class="ulist">
<ul>
<li>
<p><a href="http://freemarker.org/">FreeMarker Root Page</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="http://freemarker.org/docs/dgui_template_exp.html#exp_cheatsheet">Expressions Cheat Sheet</a></p>
</li>
<li>
<p><a href="http://freemarker.org/docs/ref.html">Complete Language reference</a></p>
</li>
<li>
<p><a href="https://try.freemarker.apache.org/">FreeMarker Template Tester</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="cobigen-javaplugin#template-object-model.adoc">Variables to access Java source model</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
