<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Devonfw.github.io Docs</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">Devonfw.github.io Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="production-line" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">Production-line</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../architecture-guidelines/1.0/index.html">Architecture-guidelines</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../architecture-guidelines/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../cicdgen/1.0/index.html">Cicdgen</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../cicdgen/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../cobigen/1.0/index.html">Cobigen</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../cobigen/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../dashboard/1.0/index.html">Dashboard</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../dashboard/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4j/1.0/index.html">Devon4j</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4j/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4net/1.0/index.html">Devon4net</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4net/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4ng/1.0/index.html">Devon4ng</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4ng/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4node/1.0/index.html">Devon4node</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4node/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4quarkus/1.0/index.html">Devon4quarkus</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4quarkus/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4ts/1.0/index.html">Devon4ts</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4ts/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devonfw.github.io/1.0/index.html">devonfw.github.io</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devonfw.github.io/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../getting-started/1.0/index.html">Getting-started</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../getting-started/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../github/1.0/index.html">Github</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../github/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../hangar/1.0/index.html">Hangar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hangar/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../ide/1.0/index.html">IDE</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../ide/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jump-the-queue/1.0/index.html">Jump-the-queue</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../jump-the-queue/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../mrchecker/1.0/index.html">Mrchecker</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../mrchecker/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../my-thai-star/1.0/index.html">My-thai-star</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../my-thai-star/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="index.html">Production-line</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../shop-floor/1.0/index.html">Shop-floor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../shop-floor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../solicitor/1.0/index.html">Solicitor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../solicitor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../sonar-devon4j-plugin/1.0/index.html">Sonar-devon4j-plugin</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../sonar-devon4j-plugin/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../devonfw.github.io/1.0/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/MarvDan/production-line/edit/master/modules/ROOT/pages/initialize-instance.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#initialize-instance-template-for-production-line">Initialize Instance Template for Production Line</a></li>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#template">Template</a></li>
<li><a href="#parameters">Parameters</a></li>
<li><a href="#execution">Execution</a></li>
<li><a href="#the-result">The result</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="initialize-instance-template-for-production-line"><a class="anchor" href="#initialize-instance-template-for-production-line"></a>Initialize Instance Template for Production Line</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Production Line Templates allows you to create/configure certain task. In order to work properly, Production Line Templates needs some previous configurations. You can do it <a href="initialize-instance-manually">manually</a> or executing the Initialize Instance Template.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to be able to start this template, you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://github.com/devonfw/production-line-shared-lib">Production Line Shared Lib</a> added in Jenkins</p>
</li>
<li>
<p>The following plugins:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Custom+Tools+Plugin">Custom Tools Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/HTTP+Request+Plugin">HTTP Request Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Job+DSL+Plugin">Job DSL Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/SonarQube+plugin">SonarQube plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Pipeline+Maven+Plugin">Pipeline Maven Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/NodeJS+Plugin">NodeJS Plugin</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>A service account added in the LAM</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Production Line provides by default the Shared Lib and the plugins, so no actions are required. The only thing that you need to do manually is the creation of the service account.</p>
</div>
<div class="paragraph">
<p>In order to create the service account you need:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the LAM</p>
</li>
<li>
<p>Press the <code>New User</code> button</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/initialize-instance/create-account.png" alt="create account">
</div>
</div>
</li>
<li>
<p>Enter the required parameters</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/initialize-instance/create-account2.png" alt="create account2">
</div>
</div>
</li>
<li>
<p>Change to <code>Unix</code> tab and enter the required parameters</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/initialize-instance/create-account3.png" alt="create account3">
</div>
</div>
<div class="paragraph">
<p>The user name will be used later in order to login. As this user will do some configuration changes, its primary group must be admins.</p>
</div>
</li>
<li>
<p>Set a password for the user.</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/initialize-instance/create-account4.png" alt="create account4">
</div>
</div>
</li>
<li>
<p>Press the <code>Save</code> button</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/initialize-instance/create-account5.png" alt="create account5">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="template"><a class="anchor" href="#template"></a>Template</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to execute this template, you need to add it into Jenkins manually. In order to do that, you can follow <a href="how-to-add-a-template">this guide</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="parameters"><a class="anchor" href="#parameters"></a>Parameters</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The required parameters are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>svcaccount</code>: The service account created as prerequisite. It must be added as a Jenkins credential.</p>
</li>
<li>
<p><code>installDeploymentPlugins</code>: With this parameter you can install extra plugins into Jenkins. Also, you can add extra template utils.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="execution"><a class="anchor" href="#execution"></a>Execution</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Press the Build with Parameters button</p>
</li>
<li>
<p>Insert the parameters.</p>
</li>
<li>
<p>If the service account is not added as credential, please add a new entry.</p>
</li>
<li>
<p>Press the <code>Build</code> button.</p>
</li>
<li>
<p>Wait until the pipeline ends.</p>
</li>
</ol>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
if any plugin is installed, Jenkins will be restarted and the pipeline will fail. You need to execute it again with the same parameters.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/initialize-instance/initialize-instance.png" alt="initialize instance">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/initialize-instance/initialize-instance2.png" alt="initialize instance2">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-result"><a class="anchor" href="#the-result"></a>The result</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Install plugins stage</p>
<div class="paragraph">
<p>In this stage the following plugins will be installed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/SSH+Credentials+Plugin">SSH Credentials Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Custom+Tools+Plugin">Custom Tools Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/HTTP+Request+Plugin">HTTP Request Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Job+DSL+Plugin">Job DSL Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/SonarQube+plugin">SonarQube plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Ansible+Plugin">Ansible Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Pipeline+Maven+Plugin">Pipeline Maven Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/NodeJS+Plugin">NodeJS Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/GitLab+Plugin">GitLab Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/OWASP+Dependency-Check+Plugin">OWASP Dependency-Check Plugin</a></p>
</li>
<li>
<p>If <code>installDeploymentPlugins</code> is <code>Docker</code> or <code>Docker+Openshift</code>, extra plugins will be installed:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Docker+Plugin">Docker Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Docker+build+step+plugin">Docker build step plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/Docker+Pipeline+Plugin">Docker Pipeline Plugin</a></p>
</li>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/JClouds+Plugin">JClouds Plugin</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>installDeploymentPlugins</code> is <code>Openshift</code> or <code>Docker+Openshift</code>, extra plugins will be installed:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://wiki.jenkins.io/display/JENKINS/OpenShift+Client+Plugin">OpenShift Client Plugin</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Configure SonarQube stage</p>
<div class="paragraph">
<p>This stage is the responsible of configure the Jenkins-SonarQube integration. It will:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Generate a SonarQube API token for the user <code>Admin</code></p>
</li>
<li>
<p>Register the token in Jenkins as credential with the id <code>sonar-token</code></p>
</li>
<li>
<p>Add the SonarQube server in Jenkins &#8594; Manage Jenkins &#8594; Configure System &#8594; SonarQube servers. The values used are:</p>
<div class="ulist">
<ul>
<li>
<p>Name: <code>SonarQube</code></p>
</li>
<li>
<p>Server URL: <a href="http://sonarqube-core:9000/sonarqube" class="bare">http://sonarqube-core:9000/sonarqube</a> (default Production Line SonarQube URL)</p>
</li>
<li>
<p>Server authentication token: <code>sonar-token</code> (generated in the previous step)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Add a webhook in SonarQube:</p>
<div class="ulist">
<ul>
<li>
<p>Name: <code>jenkins</code></p>
</li>
<li>
<p>URL: <code><a href="http://jenkins-core:8080/jenkins/sonarqube-webhook/" class="bare">http://jenkins-core:8080/jenkins/sonarqube-webhook/</a></code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Install the following SonarQube plugins:</p>
<div class="ulist">
<ul>
<li>
<p>java</p>
</li>
<li>
<p>javascript</p>
</li>
<li>
<p>typescript</p>
</li>
<li>
<p>csharp</p>
</li>
<li>
<p>web</p>
</li>
<li>
<p>cssfamily</p>
</li>
<li>
<p>jacoco</p>
</li>
<li>
<p>checkstyle</p>
</li>
<li>
<p>cobertura</p>
</li>
<li>
<p>smells</p>
</li>
<li>
<p>findbugs</p>
</li>
<li>
<p>scmgit</p>
</li>
<li>
<p>ansible</p>
</li>
<li>
<p>sonar-dependency-check-plugin</p>
</li>
</ul>
</div>
</li>
<li>
<p>Restart the SonarQube server in order to enable the plugins installed.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Create UTIL templates stage</p>
<div class="paragraph">
<p>Some templates needs that Jenkins has installed some plugins. If the plugins are not installed, the template will fail. In order to prevent this behaviour, we use the <code>initialize-instance</code> to install all plugins required in order templates. Then, we create another templates that will use the plugins installed by <code>initialize-instance</code>. In this stage we create some template utils to configure Jenkins after all required plugins are installed. Those templates are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="install-sonar-plugin">Install_SonarQube_Plugin</a></p>
</li>
<li>
<p>If <code>installDeploymentPlugins</code> is <code>Docker</code> or <code>Docker+Openshift</code>: <a href="docker-configuration.adoc">Docker_Configuration</a></p>
</li>
<li>
<p>If <code>installDeploymentPlugins</code> is <code>Openshift</code> or <code>Docker+Openshift</code>: <a href="openshift-configuration.adoc">Openshift_Configuration</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Configure Nexus 3 stage</p>
<div class="paragraph">
<p>This stage will configure the Production Line Nexus3</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enable anonymous access</p>
</li>
<li>
<p>Add a internal user to download/upload docker images</p>
<div class="ulist">
<ul>
<li>
<p>username: <code>nexus-api</code></p>
</li>
<li>
<p>password: The same as the service account created in LAM</p>
</li>
</ul>
</div>
</li>
<li>
<p>Create the maven repositories: maven-central, maven-snapshots, maven-release, maven-plugin</p>
</li>
<li>
<p>Create the docker repository</p>
</li>
<li>
<p>Create the npmjs repositories: npmjs, npm-registry, npm</p>
</li>
<li>
<p>Create in Jenkins a new credential with the id <code>nexus-api</code> with the username and password created in nexus3</p>
</li>
</ul>
</div>
</li>
<li>
<p>Configure Maven File stage</p>
<div class="paragraph">
<p>This stage adds the nexus3 credentials created in the previous stage to the maven global configuration file with the id <code>pl-nexus</code></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/initialize-instance/maven-config.png" alt="maven config">
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now, you are able to execute other templates adding them manually or using the Production Line Market Place.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
