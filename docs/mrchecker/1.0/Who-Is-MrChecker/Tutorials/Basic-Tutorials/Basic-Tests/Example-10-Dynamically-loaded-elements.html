<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Devonfw.github.io Docs</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../../../..">Devonfw.github.io Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="mrchecker" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">Mrchecker</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../../../architecture-guidelines/1.0/index.html">Architecture-guidelines</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../architecture-guidelines/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../cicdgen/1.0/index.html">Cicdgen</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../cicdgen/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../cobigen/1.0/index.html">Cobigen</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../cobigen/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../dashboard/1.0/index.html">Dashboard</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../dashboard/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../devon4j/1.0/index.html">Devon4j</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../devon4j/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../devon4net/1.0/index.html">Devon4net</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../devon4net/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../devon4ng/1.0/index.html">Devon4ng</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../devon4ng/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../devon4node/1.0/index.html">Devon4node</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../devon4node/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../devon4quarkus/1.0/index.html">Devon4quarkus</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../devon4quarkus/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../devon4ts/1.0/index.html">Devon4ts</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../devon4ts/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../devonfw.github.io/1.0/index.html">devonfw.github.io</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../devonfw.github.io/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../getting-started/1.0/index.html">Getting-started</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../getting-started/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../github/1.0/index.html">Github</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../github/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../hangar/1.0/index.html">Hangar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../hangar/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../ide/1.0/index.html">IDE</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../ide/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../jump-the-queue/1.0/index.html">Jump-the-queue</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../jump-the-queue/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../../index.html">Mrchecker</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../../index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../my-thai-star/1.0/index.html">My-thai-star</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../my-thai-star/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../production-line/1.0/index.html">Production-line</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../production-line/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../shop-floor/1.0/index.html">Shop-floor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../shop-floor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../solicitor/1.0/index.html">Solicitor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../solicitor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../sonar-devon4j-plugin/1.0/index.html">Sonar-devon4j-plugin</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../sonar-devon4j-plugin/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../../../devonfw.github.io/1.0/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/MarvDan/mrchecker/edit/develop/modules/ROOT/pages/Who-Is-MrChecker/Tutorials/Basic-Tutorials/Basic-Tests/Example-10-Dynamically-loaded-elements.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="paragraph">
<p>This example shows how to test a page with dynamically loading content. Some elements don&#8217;t load during page loading, but  during JavaScript execution.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/images/example23.png" alt="example23">
</div>
</div>
<div class="paragraph">
<p>Go to Example 1:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/images/example24.png" alt="example24">
</div>
</div>
<div class="paragraph">
<p>Click "start" and see what happens:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/images/example25.png" alt="example25">
</div>
</div>
<div class="paragraph">
<p>When loading ends, you should see the following message:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/images/example26.png" alt="example26">
</div>
</div>
<div class="paragraph">
<p>In the developer mode, you can see that the element with the "Hello World!" message exists in page DOM but it&#8217;s not displayed. However, the loading bar does not exist there - it&#8217;s created by JavaScript. The script is also visible in developer mode:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/images/example27.png" alt="example27">
</div>
</div>
<div class="paragraph">
<p>After clicking the "Start" button, the element "Loading" is created by the script, and the "Start" button becomes invisible. When loading ends, "Hello World" message is  displayed and the loading bar is hidden. Follow the changes the in developer mode:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/images/example28.png" alt="example28">
</div>
</div>
<div class="paragraph">
<p>Go to example 2:
From a user perspective, there is no difference in page functioning. However, in this case the element with the "Hello World!" message does not exist on the page before clicking "Start". It&#8217;s created by the script.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/images/example29.png" alt="example29">
</div>
</div>
<div class="paragraph">
<p>After clicking "Start", the element with the loading bar is been created.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/images/example30.png" alt="example30">
</div>
</div>
<div class="paragraph">
<p>After a certain time, the loading bar becomes invisible, and then the script creates "Hello World!" element and displays it.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../../_images/images/example31.png" alt="example31">
</div>
</div>
<div class="sect1">
<h2 id="_page_class"><a class="anchor" href="#_page_class"></a>== Page Class</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre>public class DynamicLoadingPage extends BasePage {

    private static final By selectorExampleOneLink     =
            By.cssSelector("a[href*='dynamic_loading/1']");
    private static final By selectorExampleTwoLink     =
            By.cssSelector("a[href*='dynamic_loading/2']");
    private static final By selectorDynamicLoadingText = By.cssSelector("div#content h3");
    private static final By selectorStartButton        = By.cssSelector("div#start button");
    private static final By selectorLoadingBar         = By.cssSelector("div#loading");
    private static final By selectorExampleText        = By.cssSelector("div#finish h4");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.DYNAMIC_LOADING.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Dynamically Loaded Page Elements' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.DYNAMIC_LOADING.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Returns information if dynamic loading message is visible or not.
     *
     * @return true if dynamic loading message was found on web page.
     */
    public boolean isDynamicLoadingMessageVisible() {
        return getDriver().findElementDynamic(selectorDynamicLoadingText)
                .isDisplayed();
    }

    /**
     * Clicks Example 1 link.
     */
    public void clickExampleOneLink() {
        getDriver().findElementDynamic(selectorExampleOneLink)
                .click();
    }

    /**
     * Clicks Example 2 link.
     */
    public void clickExampleTwoLink() {
        getDriver().findElementDynamic(selectorExampleTwoLink)
                .click();
    }

    /**
     * Returns information if Start button is visible or not.
     *
     * @return true if Start button was found on web page.
     */
    public boolean isStartButtonVisible() {
        return getDriver().findElementDynamic(selectorStartButton)
                .isDisplayed();
    }

    /**
     * Clicks Start button.
     */
    public void clickStartButton() {
        getDriver().findElementDynamic(selectorStartButton)
                .click();
    }

    /**
     * Waits until WebElement representing waiting bar disappears and returns example text.
     *
     * @param waitTime The amount of time designated for waiting until waiting bar disappears.
     * @return String representing example's text.
     */
    public String getExampleOneDynamicText(int waitTime) {
        WebDriverWait wait = new WebDriverWait(getDriver(), waitTime);
        wait.until((Function&lt;? super WebDriver, Boolean&gt;)
                ExpectedConditions.invisibilityOfElementLocated(selectorLoadingBar));
        return getDriver().findElementDynamic(selectorExampleText)
                .getText();
    }

    /**
     * Returns example text.
     * &lt;p&gt;
     * Waits until WebElement representing waiting bar disappear. Then waits until example text
     * shows up.
     * And after that returns example text.
     * &lt;/p&gt;
     *
     * @param waitTime The amount of time designated for waiting until waiting bar disappears and
     * example text shows.
     * @return String representing example's text.
     */
    public String getExampleTwoDynamicText(int waitTime) {
        WebDriverWait wait = new WebDriverWait(getDriver(), waitTime);
        wait.until((Function&lt;? super WebDriver, Boolean&gt;)
                ExpectedConditions.invisibilityOfElementLocated(selectorLoadingBar));
        wait.until((Function&lt;? super WebDriver, WebElement&gt;)
                ExpectedConditions.visibilityOfElementLocated(selectorExampleText));
        return getDriver().findElementDynamic(selectorExampleText)
                .getText();
    }

}</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_webdriverwait"><a class="anchor" href="#_webdriverwait"></a>== WebDriverWait</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This class performs waiting for actions using Selenium Web Driver:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>WebDriverWait(WebDriver driver, long timeOutInSeconds) - constructor, first parameter takes WebDriver, in a second you can specify a timeout in seconds.
FluentWait method:</p>
</li>
<li>
<p>until(Function&lt;? super T, V&gt; isTrue) - waits until condition function given as parameter returns expected value. If waiting time reaches timeout, it throws timeoutException.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>MrChecker implements various condition functions in the ExpectedConditions class :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>visibilityOfElementLocated(By selector) - returns WebElement if it&#8217;s visible</p>
</li>
<li>
<p>invisibilityOfElementLocated(By selector) - returns true if Element under given selector is invisible</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>WebDriver also has methods which wait for some conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>waitForElement(By selector)</p>
</li>
<li>
<p>waitForElementVisible(By selector)</p>
</li>
<li>
<p>waitUntilElementClickable(By selector)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It&#8217;s possible to write your own condition function e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  public static ExpectedCondition&lt;Boolean&gt; invisibilityOfElementLocated(final By locator) {
    return new ExpectedCondition&lt;Boolean&gt;() {
      @Override
      public Boolean apply(WebDriver driver) {
        try {
          return !(findElement(locator, driver).isDisplayed());
        } catch (NoSuchElementException e) {
          return true;
        } catch (StaleElementReferenceException e) {
          return true;
        }
      }
    };
  }</pre>
</div>
</div>
<div class="paragraph">
<p>Or as a lambda expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>        WebDriverWait wait = new WebDriverWait(getDriver(), waitTime);
        wait.until((WebDriver driver) -&gt; {
            try {
                return !(driver.findElement(selectorExampleText)
                        .isDisplayed());
            } catch (NoSuchElementException e) {
                return true;
            } catch (StaleElementReferenceException e) {
                return true;
            }
        });</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_class"><a class="anchor" href="#_test_class"></a>== Test Class</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Case 1 steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Click Dynamic Loading link and go to a subpage with examples</p>
</li>
<li>
<p>Check if the page is loaded and "Dynamically Loaded Page Elements" header is visible</p>
</li>
<li>
<p>Click Example 1 link and load site</p>
</li>
<li>
<p>Verify if the "Start" button is visible</p>
</li>
<li>
<p>Click "Start"</p>
</li>
<li>
<p>Wait for the loading bar to disappear and check if the displayed message is as it should be</p>
</li>
<li>
<p>Go back to Dynamic Loading page</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Case 2 steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check if the page is loaded and "Dynamically Loaded Page Elements" header is visible</p>
</li>
<li>
<p>Click Example 2 link and load site</p>
</li>
<li>
<p>Verify if the "Start" button is visible</p>
</li>
<li>
<p>Click "Start"</p>
</li>
<li>
<p>Wait for the loading bar to disappear</p>
</li>
<li>
<p>Wait for the message to appear and check if it is as it should be</p>
</li>
<li>
<p>Go back to Dynamic Loading page</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class DynamicLoadingTest extends TheInternetBaseTest {

    private static final int    EXAMPLE_WAITING_TIME = 30;
    private static final String EXAMPLE_TEXT         = "Hello World!";

    private static DynamicLoadingPage dynamicLoadingPage;

    @BeforeClass
    public static void setUpBeforeClass() {
        dynamicLoadingPage = shouldTheInternetPageBeOpened().clickDynamicLoadingLink();
    }

    @Override
    public void setUp() {

        logStep("Verify if Dynamic Loading page is opened");
        assertTrue("Unable to open Dynamic Loading page", dynamicLoadingPage.isLoaded());

        logStep("Verify if dynamic loading message is visible");
        assertTrue("Dynamic loading message is invisible",
                dynamicLoadingPage.isDynamicLoadingMessageVisible());
    }

    @Test
    public void shouldExampleTextBeDisplayedAterRunExampleOne() {
        logStep("Click Example 1 link");
        dynamicLoadingPage.clickExampleOneLink();

        logStep("Verify if Example 1 link opened content");
        assertTrue("Fail to load Example 1 content", dynamicLoadingPage.isStartButtonVisible());

        logStep("Click Start button");
        dynamicLoadingPage.clickStartButton();

        logStep("Verify if expected text is displayed on the screen");
        assertEquals("Fail to display example text", EXAMPLE_TEXT,
                dynamicLoadingPage.getExampleOneDynamicText(EXAMPLE_WAITING_TIME));
    }

    @Test
    public void shouldExampleTextBeDisplayedAterRunExampleTwo() {
        logStep("Click Example 2 link");
        dynamicLoadingPage.clickExampleTwoLink();

        logStep("Verify if Example 2 link opened content");
        assertTrue("Fail to load Example 2 content", dynamicLoadingPage.isStartButtonVisible());

        logStep("Click Start button");
        dynamicLoadingPage.clickStartButton();

        logStep("Verify if expected text is displayed on the screen");
        assertEquals("Fail to display example text", EXAMPLE_TEXT,
                dynamicLoadingPage.getExampleTwoDynamicText(EXAMPLE_WAITING_TIME));
    }

    @Override
    public void tearDown() {
        logStep("Click back to reset Dynamic Loading page");
        BasePage.navigateBack();
    }

}</pre>
</div>
</div>
<div class="paragraph">
<p>Perform both cases running Test Class as JUnit Test.</p>
</div>
<div class="paragraph">
<p><strong>WARNING:</strong> In this example, there is a visible loading bar signalizing that content is loading.On many websites elements are created by scripts without clear communique. This may cause problems with test stability. When your tests aren&#8217;t finding page elements, try to add wait functions with a short timeout.</p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../../../../_/js/site.js"></script>
<script async src="../../../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
