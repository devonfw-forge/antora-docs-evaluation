<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Devonfw.github.io Docs</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">Devonfw.github.io Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="devonfw.github.io" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">devonfw.github.io</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../architecture-guidelines/1.0/index.html">Architecture-guidelines</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../architecture-guidelines/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../cicdgen/1.0/index.html">Cicdgen</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../cicdgen/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../cobigen/1.0/index.html">Cobigen</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../cobigen/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../dashboard/1.0/index.html">Dashboard</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../dashboard/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4j/1.0/index.html">Devon4j</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4j/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4net/1.0/index.html">Devon4net</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4net/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4ng/1.0/index.html">Devon4ng</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4ng/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4node/1.0/index.html">Devon4node</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4node/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4quarkus/1.0/index.html">Devon4quarkus</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4quarkus/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devon4ts/1.0/index.html">Devon4ts</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devon4ts/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="index.html">devonfw.github.io</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../getting-started/1.0/index.html">Getting-started</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../getting-started/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../github/1.0/index.html">Github</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../github/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../hangar/1.0/index.html">Hangar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../hangar/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../ide/1.0/index.html">IDE</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../ide/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../jump-the-queue/1.0/index.html">Jump-the-queue</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../jump-the-queue/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../mrchecker/1.0/index.html">Mrchecker</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../mrchecker/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../my-thai-star/1.0/index.html">My-thai-star</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../my-thai-star/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../production-line/1.0/index.html">Production-line</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../production-line/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../shop-floor/1.0/index.html">Shop-floor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../shop-floor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../solicitor/1.0/index.html">Solicitor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../solicitor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../sonar-devon4j-plugin/1.0/index.html">Sonar-devon4j-plugin</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../sonar-devon4j-plugin/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="index.html" class="home-link is-current"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/marvdan/devonfw.github.io/edit/developAntoraGhPage/docs/modules/ROOT/pages/index.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="sect1">
<h2 id="_devonfw_guide"><a class="anchor" href="#_devonfw_guide"></a>devonfw guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Updated at 2022-03-16 13:27:49 UTC
:toc:
:idprefix:
:idseparator: -
:reproducible:
:source-highlighter: rouge
:listing-caption: Listing
:sectnums:
:chapter-label:
:partnums:</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started"><a class="anchor" href="#_getting_started"></a>Getting Started</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>Introduction</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="what-is-devonfw"><a class="anchor" href="#what-is-devonfw"></a>What is devonfw?</h4>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="https://devonfw.com/"><img src="_images/images/introduction/devonfw-small.png" alt="devonfw small" width="250"></a>
</div>
</div>
<div class="paragraph">
<p>Welcome to the <strong>devonfw</strong> platform. This is a product of the CSD (Custom Solution Development) industrialization effort to establish a standardized platform for custom software development within Capgemini APPS2. This platform is aimed at engagements, in which clients don&#8217;t specify the use of a predefined technology stack. In these cases we can offer a proven alternative as a result of our experience as a group.</p>
</div>
<div class="paragraph">
<p>devonfw is a development platform aiming for the standardization of processes and the boosting of productivity. It provides an architecture blueprint for server and client applications, alongside a set of tools to deliver a fully functional, <em>out-of-the-box</em> development environment.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The devonfw <em>name</em> is a registered trademark of <span class="image"><a class="image" href="https://www.capgemini.com/"><img src="_images/images/introduction/Capgemini_Logo_Small.png" alt="Capgemini Logo Small" width="80" height="Capgemini"></a></span>, but the software and documentation included in <em>devonfw</em> are fully open source. Please refer to our <a href="https://github.com/devonfw/devonfw-guide/blob/master/general/oss-compliance.adoc">OSS Compliance</a> section for more information.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="building-blocks-of-the-platform"><a class="anchor" href="#building-blocks-of-the-platform"></a>Building Blocks of the Platform</h4>
<div class="imageblock">
<div class="content">
<a class="image" href="images/introduction/devonfwcatalog.png"><img src="_images/images/introduction/devonfwcatalog.png" alt="devonfwcatalog" width="650" height="devonfw Building blocks"></a>
</div>
</div>
<div class="paragraph">
<p><em>devonfw</em> uses a state-of-the-art, open source, core reference architecture for the server (these days considered a commodity in the IT-industry) and on top of that an ever increasing number of high-value assets, which are developed by Capgemini.</p>
</div>
</div>
<div class="sect3">
<h4 id="the-devonfw-technology-stack"><a class="anchor" href="#the-devonfw-technology-stack"></a>The devonfw Technology Stack</h4>
<div class="paragraph">
<p>devonfw is fully open source and consists of the following technology stacks:</p>
</div>
</div>
<div class="sect3">
<h4 id="back-end-solutions"><a class="anchor" href="#back-end-solutions"></a>Back-End Solutions</h4>
<div class="paragraph">
<p>For server applications, <em>devonfw</em> includes the following solutions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4j">devon4j</a>: Server implementation based on Java, <a href="https://spring.io/">Spring</a> and <a href="https://projects.spring.io/spring-boot/">Spring Boot</a>.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4net">devon4net</a>: Server implementation based on <a href="https://dotnet.microsoft.com/">.NET</a>.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4node">devon4node</a>: Server implementation based on <a href="https://nestjs.com/">NestJS</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="front-end-solutions"><a class="anchor" href="#front-end-solutions"></a>Front-End solutions</h4>
<div class="paragraph">
<p>For client applications, <em>devonfw</em> includes two solutions based on <em>TypeScript</em>, <em>JavaScript</em>, <em>C#</em> and <em>.NET</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4ng">devon4ng</a>: Frontend implementation based on <a href="https://angular.io/">Angular</a> and a hybrid mobile implementation based on <a href="https://ionicframework.com/">Ionic</a>.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4x">devon4X</a>: Mobile implementation based on <a href="https://docs.microsoft.com/xamarin/">Xamarin</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="custom-tools"><a class="anchor" href="#custom-tools"></a>Custom Tools</h4>

</div>
<div class="sect3">
<h4 id="devonfw-ide"><a class="anchor" href="#devonfw-ide"></a>devonfw-ide</h4>
<div class="paragraph">
<p>The <a href="https://github.com/devonfw/ide/wiki#devonfw-ide">devonfw-ide</a> is <em>not</em> one monolithic program that is installed with a traditional executable; rather it&#8217;s a collection of scripts which are invoked via command line to automate several, repetetive development tasks. These scripts then interact with other tools, frameworks, and third-party IDEs to streamline the development workflow.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/introduction/devonfw-ide.png"><img src="_images/images/introduction/devonfw-ide.png" alt="devonfw ide" width="550"></a>
</div>
</div>
<div class="paragraph">
<p>The advantage of this approach is, that you can have as many instances of the <em>devonfw-ide</em> on your machine as you need&#8201;&#8212;&#8201;for different projects with different tools, tool versions and configurations. No need for a physical installation and no tweaking of your operating system required!</p>
</div>
<div class="paragraph">
<p>Instances of the devonfw-ide do not interfere with each other, nor with other installed software. The package size of the <em>devonfw-ide</em> is initally very small, the setup is simple, and the included software is portable.</p>
</div>
</div>
<div class="sect3">
<h4 id="ides"><a class="anchor" href="#ides"></a>==  IDEs</h4>
<div class="paragraph">
<p>It supports the following IDEs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.eclipse.org/ide/">Eclipse</a></p>
</li>
<li>
<p><a href="https://code.visualstudio.com/">Visual Studio Code</a></p>
</li>
<li>
<p><a href="https://www.jetbrains.com/idea/">IntelliJ IDEA</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="platforms"><a class="anchor" href="#platforms"></a>==  Platforms</h4>
<div class="paragraph">
<p>It supports the following platforms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://go.java/index.html">Java</a> (see also <a href="https://github.com/devonfw/devon4j/wiki">devon4j</a>)</p>
</li>
<li>
<p><a href="https://nodejs.org/en/">Node.js</a> (see also <a href="https://github.com/devonfw/devon4node/wiki/">devon4node</a>)</p>
</li>
<li>
<p><a href="https://angular.io/">Angular</a> (see also <a href="https://github.com/devonfw/devon4ng/wiki">devon4ng</a>)</p>
</li>
<li>
<p><a href="https://docs.microsoft.com/en-us/dotnet/csharp/">C#</a> (see also <a href="https://github.com/devonfw/devon4net/wiki">devon4net</a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="build-systems"><a class="anchor" href="#build-systems"></a>==  Build-Systems</h4>
<div class="paragraph">
<p>It supports the following build-systems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://maven.apache.org/">Maven</a></p>
</li>
<li>
<p><a href="https://www.npmjs.com/">NPM</a></p>
</li>
<li>
<p><a href="https://gradle.org/">Gradle</a></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Other IDEs, platforms, or tools can easily be integrated as <a href="https://github.com/devonfw/ide/wiki/cli#commandlets">commandlets</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="cobigen"><a class="anchor" href="#cobigen"></a>CobiGen</h4>
<div class="paragraph">
<p><a href="https://github.com/devonfw/cobigen/wiki#architecture">CobiGen</a> is a code generator included in the <em>devonfw-ide</em>, that allows users to generate the project structure and large parts of the application component code. This saves a lot of time, which is usually wasted on repetitive engineering tasks and/or writing boilerplate code.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/introduction/cobigen.png"><img src="_images/images/introduction/cobigen.png" alt="cobigen" width="550"></a>
</div>
</div>
<div class="paragraph">
<p>Following the same philosophy as the devonfw-ide, <em>CobiGen</em> bundles a new command line interface (CLI), that enables the generation of code using only a few commands. This approach also allows us to decouple CobiGen from <em>Eclipse</em> and use it alongside <em>VS Code</em> or <em>IntelliJ IDEA</em>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="why-should-i-use-devonfw"><a class="anchor" href="#why-should-i-use-devonfw"></a>Why should I use devonfw?</h4>
<div class="paragraph">
<p>devonfw aims to provide a framework for the development of web applications based on the Java EE programming model. It uses the Spring framework as its Java EE default implementation.</p>
</div>
</div>
<div class="sect3">
<h4 id="objectives"><a class="anchor" href="#objectives"></a>Objectives</h4>

</div>
<div class="sect3">
<h4 id="standardization"><a class="anchor" href="#standardization"></a>Standardization</h4>
<div class="paragraph">
<p>We don&#8217;t want to keep reinventing the wheel for thousands of projects, for hundreds of customers, across dozens of countries. For this reason, we aim to rationalize, harmonize and standardize the development assets for software projects and industrialize the software development process.</p>
</div>
</div>
<div class="sect3">
<h4 id="industrialization-of-innovative-technologies-digital"><a class="anchor" href="#industrialization-of-innovative-technologies-digital"></a>Industrialization of Innovative Technologies &amp; “Digital”</h4>
<div class="paragraph">
<p>devonfw&#8217;s goal is to standardize &amp; industrialize. But this applies not only to large volume, “traditional” custom software development projects. devonfw also aims to offer a standardized platform which contains a range of state-of-the-art methodologies and technology stacks. devonfw supports agile development by small teams utilizing the latest technologies for projects related to Mobile, IoT and the Cloud.</p>
</div>
</div>
<div class="sect3">
<h4 id="deliver-improve-business-value"><a class="anchor" href="#deliver-improve-business-value"></a>Deliver &amp; Improve Business Value</h4>
<div class="imageblock">
<div class="content">
<a class="image" href="images/introduction/devon_quality_agility.png"><img src="_images/images/introduction/devon_quality_agility.png" alt="devon quality agility" width="300"></a>
</div>
</div>
</div>
<div class="sect3">
<h4 id="efficiency"><a class="anchor" href="#efficiency"></a>Efficiency</h4>
<div class="ulist">
<ul>
<li>
<p>Up to 20% reduction in time to market, with faster delivery due to automation and reuse.</p>
</li>
<li>
<p>Up to 25% less implementation efforts due to code generation and reuse.</p>
</li>
<li>
<p>Flat pyramid and rightshore, ready for junior developers.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="quality"><a class="anchor" href="#quality"></a>Quality</h4>
<div class="ulist">
<ul>
<li>
<p>State-of-the-art architecture and design.</p>
</li>
<li>
<p>Lower cost on maintenance and warranty.</p>
</li>
<li>
<p>Technical debt reduction by reuse.</p>
</li>
<li>
<p>Risk reduction due to continuous improvement of individual assets.</p>
</li>
<li>
<p>Standardized, automated quality checks.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="agility"><a class="anchor" href="#agility"></a>Agility</h4>
<div class="ulist">
<ul>
<li>
<p>Focus on business functionality, not on technicalities.</p>
</li>
<li>
<p>Shorter release cycles.</p>
</li>
<li>
<p>DevOps by design&#8201;&#8212;&#8201;Infrastructure as Code.</p>
</li>
<li>
<p>Continuous Delivery pipeline.</p>
</li>
<li>
<p>On- and off-premise flexibility.</p>
</li>
<li>
<p>PoCs and prototypes in days not months.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="features"><a class="anchor" href="#features"></a>Features</h4>

</div>
<div class="sect3">
<h4 id="everything-in-a-single-zip"><a class="anchor" href="#everything-in-a-single-zip"></a>Everything in a Single ZIP</h4>
<div class="paragraph">
<p>The devonfw distributions is packaged in a ZIP file that includes all the custom tools, software and configurations.</p>
</div>
<div class="paragraph">
<p>Having all the dependencies self-contained in the distribution&#8217;s ZIP file, users don&#8217;t need to install or configure anything. Just extracting the ZIP content is enough to have a fully functional <em>devonfw</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="devonfwthe-package"><a class="anchor" href="#devonfwthe-package"></a>devonfw&#8201;&#8212;&#8201;The Package</h4>
<div class="paragraph">
<p>The devonfw platform provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implementation blueprints for a modern cloud-ready server and a choice on JS-Client technologies (either open source Angular or a very rich and impressive solution based on commercial Sencha UI).</p>
</li>
<li>
<p>Quality documentation and step-by-step quick start guides.</p>
</li>
<li>
<p>Highly integrated and packaged development environment based around Eclipse and Jenkins. You will be ready to start implementing your first customer-specific use case in 2h time.</p>
</li>
<li>
<p>Iterative eclipse-based code-generator that understands "Java" and works on higher architectural concepts than Java-classes.</p>
</li>
<li>
<p>An example application as a reference implementation.</p>
</li>
<li>
<p>Support through a large community + industrialization services (Standard Platform as a Service) available in the iProd service catalog.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devonfw-ide-download-and-setup"><a class="anchor" href="#devonfw-ide-download-and-setup"></a>devonfw-ide Download and Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please refer to our <a href="#devonfw-ide-introduction.adoc#setup.adoc" class="page unresolved">devonfw-ide Setup</a> section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="guides"><a class="anchor" href="#guides"></a>Guides</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Our goal is to provide a smooth starting experience to all users of <em>devonfw</em>, no matter how experienced they are or what their stakeholder role is. To achieve this, we provide a list of recommended guides here:</p>
</div>
<div class="paragraph">
<p><strong>For Students and Junior Engineers:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-sample-application">Explore the devonfw sample application.</a></p>
</li>
<li>
<p><a href="guide-first-application">Build your first application with <strong>devon4j/devon4ng</strong>.</a></p>
</li>
<li>
<p><a href="samples-step-by-step">Create an application with <strong>devon4node</strong>.</a></p>
</li>
<li>
<p><a href="howto">Create an application with <strong>devon4net</strong>.</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>For Senior Engineers and Architects:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-sample-application.adoc">Explore the devonfw sample application.</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>For Team Leaders and Product Ambassadors:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/solicitor">License management for OSS projects.</a></p>
</li>
</ul>
</div>
<!-- toc disabled -->
<div class="sect3">
<h4 id="build-your-first-devonfw-application"><a class="anchor" href="#build-your-first-devonfw-application"></a>Build Your First devonfw Application</h4>
<div class="paragraph">
<p><a href="https://github.com/devonfw/jump-the-queue">JumpTheQueue</a> is a small application based on the devonfw framework, which you can create yourself by following our simple step-by-step tutorial. By doing so, you will learn about the app development workflow and gain insight into the design of a professional business information system. Please visit the JumpTheQueue wiki and start working trough the tutorial <a href="https://github.com/devonfw/jump-the-queue/wiki"><strong>HERE</strong></a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The tutorial assumes you have successfully set up the <a href="https://github.com/devonfw/ide/wiki/setup">devonfw-ide</a> previously.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also clone the project and explore the finished source code via:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git clone https://github.com/devonfw/jump-the-queue.git</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/guide/jtq-screens.png" alt="JumpTheQueue Screenshots">
</div>
</div>
<div class="paragraph">
<p>Another way to check out the JumpTheQueue-Application is to try our interactive katacoda scenario where you set up the application step by step.</p>
</div>
<div class="paragraph katacoda-links">
<p><a href="https://katacoda.com/devonfw/scenarios/jump-the-queue">JumpTheQueue Katacoda Scenario</a></p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="explore-our-devonfw-sample-application"><a class="anchor" href="#explore-our-devonfw-sample-application"></a>Explore Our devonfw Sample Application</h4>
<div class="paragraph">
<p><a href="https://github.com/devonfw/my-thai-star">MyThaiStar</a> is a complex sample app, that demonstrates the full capabilities of our framework. On this page we will describe how to download and launch the app on your system, so you can test the various functionalities it offers and explore its code.</p>
</div>
<div class="paragraph">
<p>You can also check out the interactive katacoda scenario for setting up and trying out the MyThaiStar-Application.</p>
</div>
<div class="paragraph katacoda-links">
<p><a href="https://katacoda.com/devonfw/scenarios/my-thai-star-java">MyThaiStar Katacoda Scenario</a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We assume you have successfully set up the <a href="https://github.com/devonfw/ide/wiki/setup">devonfw-ide</a> previously.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the root directory of a <em>devonfw-ide</em> directory, right click and select "<strong>Open Devon CMD shell here</strong>" from the Windows Explorer context menu. Then navigate to the main workspace and checkout the MyThaiStar Git repository like this:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd workspaces/main
git clone https://github.com/devonfw/my-thai-star.git</code></pre>
</div>
</div>
</li>
<li>
<p>Perform: <code>cd my-thai-star</code></p>
</li>
<li>
<p>Execute: <code>devon eclipse ws-up</code></p>
</li>
<li>
<p>Execute: <code>devon eclipse create-script</code></p>
</li>
<li>
<p>Go to the root folder of the distribution and run <code>eclipse-main.bat</code></p>
</li>
<li>
<p>In Eclipse navigate to <code>File &gt; Import &gt; Maven &gt; Existing Maven Projects</code>, then import the cloned project from your workspace by clicking the "Browse" button and selecting <code>/workspaces/my-thai-star/java/mtsj/</code>.</p>
</li>
<li>
<p>Run the backend by right-clicking <code>SpringBootApp.java</code> and selecting <code>Run as &gt; Java Application</code> in the context menu. The backend will start up and create log entries in the Eclipse Console tab.</p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/guide/run-mythaistar.png" alt="Running the MyThaiStar Backend"></span></p>
</div>
</li>
<li>
<p>Return to your command shell and perform: <code>cd angular</code></p>
</li>
<li>
<p>Execute: <code>npm install</code></p>
</li>
<li>
<p>Execute: <code>ng serve</code></p>
</li>
<li>
<p>Once started, the frontend will be available at <a href="http://localhost:4200/restaurant">localhost:4200/restaurant</a>. Login with the username and password <code>waiter</code> and take a look at the various functionalities provided by MyThaiStar.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You should now take a look at both the front- and backend code and familiarize yourself with its structure and concepts, since most devonfw projects follow this exemplary implementation. Please visit the <em>architecture overview</em> pages of <a href="https://github.com/devonfw/devon4ng/wiki/architecture">devon4ng</a> and <a href="https://github.com/devonfw/devon4j/wiki/architecture">devon4j</a> to learn more about the internal workings of front- and backend.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="further-information"><a class="anchor" href="#further-information"></a>Further Information</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="repository-overview"><a class="anchor" href="#repository-overview"></a>Repository Overview</h4>
<div class="paragraph">
<p>The GitHub repositories within the <a href="https://github.com/devonfw">devonfw organization</a> contain the source code and documentation for official devonfw projects.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/further-info/devonfw-org.png" alt="devonfw Repository Overview">
</div>
<div class="title">An overview of the devonfw organization repositories.</div>
</div>
<div class="paragraph">
<p>The most relevant repositories here are the individual devonfw technology stacks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4j">devon4j</a> (for Java)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4ng">devon4ng</a> (for Angular)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4net">devon4net</a> (for .NET)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4node">devon4node</a> (for Node.js)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4x">devon4x</a> (for Xamarin)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Our framework also delivers a number of tools and plug-ins that aim to accelerate and streamline the development process, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide">devonfw-ide</a> (for environment/workspace setup)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen">CobiGen</a> (for automated code generation)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin">devon4j-sonar-plugin</a> (for architecture validation)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/mrchecker">MrChecker</a> (for E2E test automation)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We also provide educational material and reference implementations to aid new users and drive the adoption of our framework, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/jump-the-queue">JumpTheQueue</a> (simple, step-by-step app creation tutorial)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/my-thai-star">MyThaiStar</a> (well documented, complex reference application)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-shop-floor">devonfw-shop-floor</a> (tools and tutorials for CI/CD efforts)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/accelerated-solution-design">accelerated-solution-design</a> (work-methodology for faster app design)</p>
</li>
<li>
<p>and many more &#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Projects in early development and prototypes are located in the <a href="https://github.com/devonfw-forge">devonfw forge</a> repository. They usually remain there until they are ready for broader release or use in production.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="links-to-our-community"><a class="anchor" href="#links-to-our-community"></a>Links to our Community</h4>
<div class="paragraph">
<p>We strive to foster an active, diverse and dynamic community around devonfw and are relying on modern collaboration tools to do so. Please note that some resources listed here might only be accessible to members or partners of Capgemini.</p>
</div>
</div>
<div class="sect3">
<h4 id="microsoft-teams"><a class="anchor" href="#microsoft-teams"></a>Microsoft Teams</h4>
<div class="paragraph">
<p>The devonfw public channel is accessible to everyone who has a Microsoft Teams account. You can find the latest discussions on ongoing development topics here, as well as new commits and pull requests to our repos.</p>
</div>
<div class="paragraph">
<p>Join us to stay in the loop, and feel free to post your questions regarding devonfw here.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/further-info/teams.png" alt="Microsoft Teams Icon" width="25"></span> <a href="https://teams.microsoft.com/l/team/19%3af92c481ec30345a28a5434bc530a882a%40thread.skype/conversations?groupId=503df57a-d454-4eec-b3bc-d6d87c7c24f8&amp;tenantId=76a2ae5a-9f00-4f6b-95ed-5d33d77c4d61">devonfw Public Channel</a></p>
</div>
</div>
<div class="sect3">
<h4 id="yammer"><a class="anchor" href="#yammer"></a>Yammer</h4>
<div class="paragraph">
<p>Our corporate Yammer channel is accessible to Capgemini employees and members. If you are looking for information or feedback on current and planned projects regarding devonfw, we reccomend you ask around here first.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/further-info/yammer.png" alt="Yammer Icon" width="25"></span> <a href="https://www.yammer.com/capgemini.com/#/threads/inGroup?type=in_group&amp;feedId=5030942">devonfw Corporate Yammer</a></p>
</div>
</div>
<div class="sect3">
<h4 id="e-mail"><a class="anchor" href="#e-mail"></a>E-Mail</h4>
<div class="paragraph">
<p>You can reach our dedicated iCSD Support Team via e-mail at:</p>
</div>
<div class="paragraph">
<p><a href="mailto:icsddevonfwsupport.apps2@capgemini.com">icsddevonfwsupport.apps2@capgemini.com</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributing"><a class="anchor" href="#contributing"></a>Contributing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please refer to our <a href="master-contributing.adoc">Contributing</a> section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="code-of-conduct"><a class="anchor" href="#code-of-conduct"></a>Code of Conduct</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please refer to our <a href="CODE_OF_CONDUCT.adoc">Code of Conduct</a> section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devonfw-ide-2"><a class="anchor" href="#devonfw-ide-2"></a>devonfw-ide</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h3>
<div class="paragraph">
<p><a href="http://devonfw.com">devonfw</a> provides a solution to building applications which combine best-in-class frameworks and libraries
as well as industry proven practices and code conventions.
It massively speeds up development, reduces risks and helps deliver better results.</p>
</div>
<div class="paragraph">
<p>This document contains the instructions for the tool <code>devonfw-ide</code> to set up and maintain your development tools including your favorite IDE (integrated development environment).</p>
</div>
<!-- toc disabled -->
<div class="sect3">
<h4 id="features-2"><a class="anchor" href="#features-2"></a>Features</h4>
<div class="paragraph">
<p>Every developer needs great tools to work efficiently. Setting up these tools manually can be tedious and error-prone. Furthermore, some projects may require different versions and configurations of such tools. Especially configurations like code-formatters should be consistent within a project to avoid diff-wars.</p>
</div>
<div class="paragraph">
<p>The <code>devonfw-ide</code> will solve these issues. Here are the features you will find through <code>devonfw-ide</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Efficient</strong><br>
Set up your IDE within minutes tailored for the requirements of your project.</p>
</li>
<li>
<p><strong>Automated</strong><br>
Automate the setup and update, avoid manual steps and mistakes.</p>
</li>
<li>
<p><strong>Simple</strong><br>
KISS (Keep It Small and Simple), no native installers that globally mess your OS or tool-integration that break with every release. Instead, use templates and simple shell scripts.</p>
</li>
<li>
<p><strong>Configurable</strong><br>
You can change the <a href="configuration">configuration</a> depending on your needs. Furthermore, the <a href="settings">settings</a> contain configuration templates for the different tools (see <a href="configurator">configurator</a>).</p>
</li>
<li>
<p><strong>Maintainable</strong><br>
For your project you should copy these <a href="settings">settings</a> to an own git repository that can be maintained and updated to manage the tool configurations during the project lifecycle. If you use GitHub or GitLab every developer can easily suggest changes and improvements to these <a href="settings">settings</a> via pull/merge requests, which is easier to manage with big teams.</p>
</li>
<li>
<p><strong>Customizable</strong><br>
Do you need an additional tool you had never heard of before? Put it in the <code>software</code> folder of the <a href="structure">structure</a>. The <code>devon</code> <a href="cli">CLI</a> will then automatically add it to your <code>PATH</code> variable.<br>
Further you can create your own <a href="cli#commandlets">commandlet</a> for your additional tool. For closed-source tools you can create your own archive and distribute it to your team members as long as you care about the terms and licenses of these tools.</p>
</li>
<li>
<p><strong>Multi-platform</strong><br>
It works on all major platforms: Windows, Mac and Linux.</p>
</li>
<li>
<p><strong>Multi-tenancy</strong><br>
You can have several instances of the <code>devonfw-ide</code> "<a href="setup">installed</a>" on your machine for different projects with different tools, tool versions and configurations. You won’t need to set up any physical installation nor changing your operating system. "Installations" of <code>devonfw-ide</code> do not interfere with each other nor with other installed software.</p>
</li>
<li>
<p><strong>Multiple Workspaces</strong><br>
It supports working with different <a href="workspaces">workspaces</a> on different branches. You can create and update new workspaces with a few clicks. You can see the workspace name in the title-bar of your IDE so you do not get confused and work on the right branch.</p>
</li>
<li>
<p><strong>Free</strong><br>
The <code>devonfw-ide</code> is free just like everything from <a href="https://devonfw.com">devonfw</a>. See <a href="license">LICENSE</a> for details.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="ides-2"><a class="anchor" href="#ides-2"></a>IDEs</h4>
<div class="paragraph">
<p>We support the following IDEs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="eclipse">Eclipse</a></p>
</li>
<li>
<p><a href="vscode">Visual Studio Code</a></p>
</li>
<li>
<p><a href="intellij">IntelliJ</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="platforms-2"><a class="anchor" href="#platforms-2"></a>Platforms</h4>
<div class="paragraph">
<p>We support the following platforms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="java">java</a> (see also <a href="https://github.com/devonfw/devon4j/wiki">devon4j</a>)</p>
</li>
<li>
<p><a href="cs">C#</a> (see <a href="https://devon4net.github.io/">devon4net</a>)</p>
</li>
<li>
<p><a href="node">node</a>, <a href="ng">angular</a> and <a href="ionic">ionic</a> (see <a href="https://github.com/devonfw/devon4ng/wiki">devon4ng</a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="build-systems-2"><a class="anchor" href="#build-systems-2"></a>Build-Systems</h4>
<div class="paragraph">
<p>We support the following build-systems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="mvn">mvn</a> (maven)</p>
</li>
<li>
<p><a href="npm">npm</a></p>
</li>
<li>
<p><a href="gradle">gradle</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, also other IDEs, platforms, or tools can be easily integrated as <a href="cli#commandlet">commandlet</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="motivation"><a class="anchor" href="#motivation"></a>Motivation</h4>
<div class="paragraph">
<p><code>TL;DR</code>? Lets talk to developers a correct language. Here are some examples with <code>devonfw-ide</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">[/]$ devon
You are not inside a devonfw-ide installation: /
[/]$ cd /projects/devonfw
[devonfw]$ mvn
zsh: command not found: mvn
[devonfw]$ devon
devonfw-ide environment variables have been set for /projects/devonfw in workspace main
[devonfw]$ mvn -v
Apache Maven 3.6.0 (97c98ec64a1fdfee7767ce5ffb20918da4f719f3; 2018-10-24T20:41:47+02:00)
Maven home: /projects/devonfw/software/maven
Java version: 1.8.0_191, vendor: Oracle Corporation, runtime: /projects/devonfw/software/java
Default locale: en_DE, platform encoding: UTF-8
OS name: "mac os x", version: "10.14.3", arch: "x86_64", family: "mac"
[devonfw]$ cd /projects/ide-test/workspaces/test/my-project
[my-project]$ devon
devonfw-ide environment variables have been set for /projects/ide-test in workspace test
[my-project]$ mvn -v
Apache Maven 3.6.0 (97c98ec64a1fdfee7767ce5ffb20918da4f719f3; 2018-10-24T20:41:47+02:00)
Maven home: /projects/ide-test/software/maven
Java version: 11.0.2, vendor: Oracle Corporation, runtime: /projects/ide-test/software/jdk/Contents/Home
Default locale: en_DE, platform encoding: UTF-8
OS name: "mac os x", version: "10.14.3", arch: "x86_64", family: "mac"
[ide-test]$ devon eclipse
launching Eclipse for workspace test...
[my-project]$ devon build
[INFO] Scanning for projects...
...
[INFO] BUILD SUCCESS</code></pre>
</div>
</div>
<div class="paragraph">
<p>This was just a very simple demo of what <code>devonfw-ide</code> can do. For further details have a look at our <a href="cli">CLI documentation</a>.</p>
</div>
<div class="paragraph">
<p>Now you might ask:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>But I use Windows/Linux/MacOS/… - it works on all platforms!</p>
</li>
<li>
<p>But how about Windows CMD or Power-Shell? - it works!</p>
</li>
<li>
<p>But what if I use cygwin or git-bash on windows? - it works!</p>
</li>
<li>
<p>But I love to use ConEmu or Commander - it works with full integration!</p>
</li>
<li>
<p>How about macOS Terminal or iTerm2? - it works with full integration!</p>
</li>
<li>
<p>But I use Zsh  - it works!</p>
</li>
<li>
<p>&#8230;&#8203;? - it works!</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Wow! So let&#8217;s get started with <a href="setup">download &amp; setup</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="setup"><a class="anchor" href="#setup"></a>Setup</h4>

</div>
<div class="sect3">
<h4 id="prerequisites"><a class="anchor" href="#prerequisites"></a>Prerequisites</h4>
<div class="paragraph">
<p>We try to make it as simple as possible for you. However, there are some minimal prerequisites:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You need to have a tool to extract <code>*.tar.gz</code> files (<code>tar</code> and <code>gzip</code>). On Windows before Version 10 (1803) use <a href="https://www.7-zip.org/">7-zip</a>. On all other platforms this comes out of the box.</p>
</li>
<li>
<p>You need to have <a href="https://git-scm.com">git</a> and <a href="https://curl.haxx.se/">curl</a> installed.</p>
<div class="ulist">
<ul>
<li>
<p>On Windows you only need to  download and install <a href="https://git-scm.com/download/win">git for windows</a>. This also ships with <code>bash</code> and <code>curl</code>.</p>
</li>
<li>
<p>On Linux you might need to install the above tools in case they are not present (e.g. <code>sudo apt-get install git curl</code> or <code>sudo yum install git-core curl</code>)</p>
</li>
<li>
<p>On MacOS you only need to download and install <a href="https://git-scm.com/download/mac">git for mac</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="download"><a class="anchor" href="#download"></a>Download</h4>
<div class="paragraph">
<p>The latest release of <code>devonfw-ide</code> can be downloaded from <a href="https://repository.sonatype.org/service/local/artifact/maven/redirect?r=central-proxy&amp;g=com.devonfw.tools.ide&amp;a=devonfw-ide-scripts&amp;v=LATEST&amp;p=tar.gz">here</a> (You can find all releases in <a href="https://repo.maven.apache.org/maven2/com/devonfw/tools/ide/devonfw-ide-scripts/">maven central</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="install"><a class="anchor" href="#install"></a>Install</h4>
<div class="paragraph">
<p>Create a central folder like <code>C:\projects</code> or <code>/projects</code>. Inside this folder, create a sub-folder for your new project such as <code>my-project</code> and extract the contents of the downloaded archive (<code>devonfw-ide-scripts-*.tar.gz</code>) to this new folder. Run the command <code>setup</code> in this folder (on windows double clicking on <code>setup.bat</code>).
That&#8217;s all. To get started read the <a href="usage">usage</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="uninstall"><a class="anchor" href="#uninstall"></a>Uninstall</h4>
<div class="paragraph">
<p>To "uninstall" your <code>devonfw-ide</code> you only need to call the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon ide uninstall</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you can delete the <code>devonfw-ide</code> top-level folder(s) (<a href="variables">${DEVON_IDE_HOME}</a>).</p>
</div>
<div class="paragraph">
<p>The <code>devonfw-ide</code> is designed to be <strong>non-invasive</strong> to your operating system and computer. Therefore it is not "installed" on your system in a classical way. Instead you just create a folder and extract the <a href="#download">downloaded</a> archive to it. You only have to install regularly in advance some specific prerequisites like git. All the other softwares remain locally in your devonfw-ide folder. However, there are the following excuses (what is reverted by <code>devon ide uninstall</code>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>devon</code> command is copied to your home directory (<code>~/.devon/devon</code>)</p>
</li>
<li>
<p>The <code>devon</code> alias is added to your shell config (<code>~/.bashrc</code> and <code>~/.zshrc</code>, search for <code>alias devon="source ~/.devon/devon"</code>).</p>
</li>
<li>
<p>On Windows the <code>devon.bat</code> command is copied to your home directory (<code>%USERPROFILE%\scripts\devon.bat</code>)</p>
</li>
<li>
<p>On Windows this <code>%USERPROFILE%\scripts</code> directory is added to the <code>PATH</code> of your user.</p>
</li>
<li>
<p>The <code>devonfw-ide</code> will download a third party software to your <code>~/Downloads/devonfw-ide</code> folder to reduce redundant storage. You have to delete this folder manually as we do not want to be responsible for data-loss in case users manually put files here.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="testing-snapshot-releases"><a class="anchor" href="#testing-snapshot-releases"></a>Testing SNAPSHOT releases</h4>
<div class="paragraph">
<p>Whenever a story in devonfw-ide is completed by merging a <a href="https://docs.github.com/en/github/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-pull-requests">PR</a>,
our <a href="https://github.com/features/actions">github actions</a> will build a new SNAPSHOT release and on success deploy it to nexus on OSSRH.
You can therefore find the latest devonfw SNAPSHOT releases <a href="https://s01.oss.sonatype.org/content/repositories/snapshots/com/devonfw/tools/ide/devonfw-ide-scripts/">here</a>.
Simply choose the latest SNAPSHOT version folder and then inside the <code>*.tar.gz</code> file for the latest version.
Once downloaded, you can proceed as with official releases (see <a href="#install">install</a>).</p>
</div>
<div class="paragraph">
<p>If you test the latest SNAPSHOT please also give feedback to bug or feature tickets to let us know if things are working or not.
Thanks for your testing, support and help to make devonfw better!</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="usage"><a class="anchor" href="#usage"></a>Usage</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>This section explains the usage of <code>devonfw-ide</code> according to your role:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Everybody should read and follow the usage for a <a href="#developer">developer</a>.</p>
</li>
<li>
<p>In case you want to administrate <code>devonfw-ide</code> settings for your project, you should also read the usage for the <a href="#admin">ide-admin</a>.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="developer"><a class="anchor" href="#developer"></a>Developer</h4>
<div class="paragraph">
<p>As a developer you are supported to <a href="setup">setup</a> your IDE automated and fast while you can have a nice cup of coffee (after you provided <code>settings-URL</code> and accepted the license).
You only need the settings URL from your <a href="#admin">ide-admin</a>.
Experienced developers can directly call <code>setup «settings-URL»</code>.
Otherwise if you just call <code>setup</code> (e.g. by double-clicking it), you can enter it when you are prompted for <code>Settings URL</code> (using copy&amp;paste to avoid typos).</p>
</div>
<div class="paragraph">
<p>Note: devonfw-ide supports autocompletion (since <code>2021.04.001</code>). Currently this only works in bash (on windows use git bash). Simply type <code>devon</code> and hit <code>[Tab]</code> to get completion.</p>
</div>
</div>
<div class="sect3">
<h4 id="update"><a class="anchor" href="#update"></a>Update</h4>
<div class="paragraph">
<p>To update your IDE (if instructed by your <a href="#admin">ide-admin</a>), you only need to run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon ide update</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that windows is using file-locking what can have ugly side-effects.
To be safe, you should have your IDE tools shut down before invoking the above update command.
E.g. if a tool needs to be updated, the old installation folder will be moved to a backup and the new version is installed on top.
If there are windows file locks in place this can fail and mess up things.
You can still delete the according installation from your <code>software</code> folder and rerun <code>devon ide update</code> if you ran into this error.</p>
</div>
</div>
<div class="sect3">
<h4 id="working-with-multiple-workspaces"><a class="anchor" href="#working-with-multiple-workspaces"></a>Working with multiple workspaces</h4>
<div class="paragraph">
<p>If you are working on different branches in parallel you typically want to use multiple workspaces.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to the <a href="workspaces">workspaces</a> folder in your <a href="variables">${DEVON_IDE_HOME}</a> and create a new folder with the name of your choice (e.g. <code>release2.1</code>).</p>
</li>
<li>
<p>Check out (<code>git clone &#8230;&#8203;</code>) the according projects and branch into that workspace folder.</p>
</li>
<li>
<p>Open a shell in that new workspace folder (<code>cd</code> to it) and according to your IDE run e.g. <a href="eclipse">eclipse</a>, <a href="vscode">vscode</a>, or <a href="intellij">intellij</a> to create your workspace and launch the IDE. You can also add the parameter <code>create-script</code> to the IDE <a href="cli#commandlets">commandlet</a> in order to create a launch-script for your IDE.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can have multiple instances of eclipse running for each workspace in parallel. To distinguish these instances you will find the workspace name in the title of eclipse.</p>
</div>
</div>
<div class="sect3">
<h4 id="admin"><a class="anchor" href="#admin"></a>Admin</h4>
<div class="paragraph">
<p>You can easily customize and <a href="configuration">configure</a> <code>devonfw-ide</code> for the requirements of your project.
In order to do so, you need to create your own project-specific settings git repository and provide the URL to all developers for the <a href="setup">setup</a>.
With tools such as gitlab, bitbucket or github every developer can easily propose changes and improvements.
However, we suggest that one team member is responsible to ensure that everything stays consistent and works.
We will call this person the <em>ide-admin</em> of your project.</p>
</div>
<div class="paragraph">
<p>The following are the suggested step-by-step instructions how an <em>ide-admin</em> should prepare <code>devonfw-ide</code> for his new project:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Fork <a href="https://github.com/devonfw/ide-settings.git">ide-settings</a> to a git repository specific for your project (e.g. a new project in the <code>gitlab</code> of your <code>production-line</code> instance). In case you are using github, all you need to do is use the <code>Fork</code> button. In other cases simply create a new and empty git repository and clone this to your machine. Then add the default ide-settings as origin, fetch and pull from it:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>git remote add upstream https://github.com/devonfw/ide-settings.git
git fetch upstream
git pull upstream master
git push</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you should have a full fork as a copy of the <code>settings</code> git repo with all its history that is ready for upstream merges.</p>
</div>
</li>
<li>
<p>Study the <a href="settings#structure">structure</a> of this git repository to understand where to find which configuration.</p>
</li>
<li>
<p>Study the <a href="configuration">configuration</a> and understand that general settings can be tweaked in the toplevel <code>devon.properties</code> file of your settings git repository.</p>
</li>
<li>
<p>Configure the tools and their versions for your project. Here is an example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>DEVON_IDE_TOOLS=(java mvn eclipse)
ECLIPSE_VERSION=2020-06
##use e.g. 8u242b08 for Java 8
#JAVA_VERSION=8u242b08
JAVA_VERSION=11.0.5_10
MAVEN_VERSION=3.6.2</code></pre>
</div>
</div>
<div class="paragraph">
<p>This way you will take over control of the tools and their versions for every developer in your project team and ensure that things get reproducible.</p>
</div>
</li>
<li>
<p>In case you need a proprietary or unsupported tool, you can study <a href="software#custom">how to include custom tools</a>.</p>
</li>
<li>
<p>In case you have very restrictive policies about downloading tools from the internet, you can create and configure a <a href="software#repository">software repository</a> for your project or company.</p>
</li>
<li>
<p>Some of the tools (especially the actual IDEs) allow extensions via plugins. You can customize them to your needs for <a href="eclipse#plugins">eclipse</a>, <a href="vscode#plugins">VS code</a>, or <a href="intellij#plugins">intelliJ</a>.</p>
</li>
<li>
<p>In your <code>settings</code> git repository you will find a <code>projects</code> folder. Here you will find configurations files for every git project relevant for your actual project. Feel free to create new projects for your needs and delete the <code>devonfw</code> specific default projects. The <a href="projects">projects</a> documentation will explain you how to do this.</p>
</li>
<li>
<p>For every IDE you will also find an according folder in your <code>settings</code> git repository. Here are the individual configuration settings for that IDE. You can change them by directly editing the according configuration files directly with a text-editor in your <code>settings</code> git repository. However, this is a really complex way and will take you a lot of time to find the right file and property to tweak for your actual need. Instead we suggest to study
<a href="configurator#how-to-customize">how to customize IDE specific settings</a>.</p>
</li>
<li>
<p>You may also create new sub-folders in your <code>settings</code> git repository and put individual things according to your needs. E.g. you could add scripts for <a href="https://addons.mozilla.org/de/firefox/addon/greasemonkey">greasemonkey</a> or <a href="https://www.tampermonkey.net/">tampermonkey</a>, as well as scripts for your database or whatever may be useful and worth to share in your team. However, to share and maintain knowledge we recommend to use a wiki instead.</p>
</li>
<li>
<p>You may want to customize the <a href="eclipse#dictionary">Eclipse spellchecker dictionary</a> for your project and your language.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>All described in the above steps (except the first one) can be used to manage and update the configuration during the project lifecycle.
However, when you have done changes especially in a larger project, please consider the following best-practices to avoid that a large teams gets blocked by a non-functional IDE:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Commit your changes to a feature-branch.</p>
</li>
<li>
<p>First test the changes yourself.</p>
</li>
<li>
<p>If all works as expected, pick a pilot user of the team to test the changes from the feature branch (go to <code>settings</code> folder, <code>git fetch</code>, <code>git checkout -t origin/feature/«name»</code>, <code>devon ide update</code>).</p>
</li>
<li>
<p>Only after that works well for a couple of days, inform the entire team to update.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="announce-changes-to-your-team"><a class="anchor" href="#announce-changes-to-your-team"></a>Announce changes to your team</h4>
<div class="paragraph">
<p>In order to roll out the perfectly configured <code>devonfw-ide</code> to your project initially or when new members join, you only have to provide the <code>Settings URL</code> to the <a href="#developer">developers</a> of your team.
You can also provide a specific branch with <code>Settings URL#branch</code> to use variations of common settings or to test new settings before making them public to the team.</p>
</div>
<div class="paragraph">
<p>After you changed and tested your <code>settings</code> git repository (main branch), you only need to announce this to your <a href="#developer">developers</a> (e.g. via email or some communication tool) so that they will can <code>devon ide update</code> and automatically get up-to-date with the latest changes (see <a href="#update">update</a>).</p>
</div>
<div class="paragraph">
<p>In case you want to go to a new version of <code>devonfw-ide</code> itself, <a href="#developer">developers</a> have to call <code>devon ide update scripts</code>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="configuration"><a class="anchor" href="#configuration"></a>Configuration</h4>
<div class="paragraph">
<p>The <code>devonfw-ide</code> aims to be highly configurable and flexible. The configuration of the <a href="cli">devon</a> command and environment variables takes place via <code>devon.properties</code> files. The following list shows these configuration files in the order they are loaded so files can override variables from files above in the list:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>build in defaults (for <code>JAVA_VERSION</code>, <code>ECLIPSE_PLUGINS</code>, etc.)</p>
</li>
<li>
<p><code>~/devon.properties</code> - user specific global defaults (on windows in <code>%USERPROFILE%/devon.properties</code>)</p>
</li>
<li>
<p><code><a href="https://github.com/devonfw/ide/blob/master/scripts/src/main/resources/scripts/devon.properties">scripts/devon.properties</a></code> - defaults provided by <code>devonfw-ide</code>. Never directly modify this file!</p>
</li>
<li>
<p><code>devon.properties</code> - vendor variables for custom distributions of <code><a href="scripts">devonfw-ide-scripts</a></code>, may e.g. tweak <code>SETTINGS_PATH</code> or predefine <code>SETTINGS_URL</code>.</p>
</li>
<li>
<p><code><a href="https://github.com/devonfw/ide-settings/blob/master/devon.properties">settings/devon.properties</a></code> (<code>${SETTINGS_PATH}/devon.properties</code>) - project specific configurations from <a href="settings">settings</a>.</p>
</li>
<li>
<p><code>workspaces/${WORKSPACE}/devon.properties</code> - optional workspace specific configurations (especially helpful in projects using docker).</p>
</li>
<li>
<p><code><a href="https://github.com/devonfw/ide-settings/blob/master/devon/conf/devon.properties">conf/devon.properties</a></code> - user specific configurations (e.g. <code>M2_REPO=~/.m2/repository</code>). During setup this file is created by copying a template from <code>${SETTINGS_PATH}/devon/conf/devon.properties</code>.</p>
</li>
<li>
<p><code><a href="https://github.com/devonfw/ide-settings/tree/master/projects">settings/projects/*.properties</a></code>- properties to configure <a href="projects">project checkout and import</a></p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="devon-properties"><a class="anchor" href="#devon-properties"></a>devon.properties</h4>
<div class="paragraph">
<p>The <code>devon.properties</code> files allow to define environment variables in a simple and OS independent way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code># comments begin with a hash sign (#) and are ignored</code></p>
</li>
<li>
<p><code>variable_name=variable_value with space etc.</code></p>
</li>
<li>
<p><code>variable_name=${predefined_variable}/folder_name</code></p>
<div class="paragraph">
<p>variable values can refer to other variables that are already defined, which will be resolved to their value. You have to used <code>${&#8230;&#8203;}</code> syntax to make it work on all platforms (never use <code>%&#8230;&#8203;%</code>, <code>$&#8230;&#8203;</code>, or <code>$(&#8230;&#8203;)</code> syntax in <code>devon.properties</code> files).</p>
</div>
</li>
<li>
<p><code>export exported_variable=this value will be exported in bash, in windows CMD the export prefix is ignored</code></p>
</li>
<li>
<p><code>variable_name=</code></p>
<div class="paragraph">
<p>this will unset the specified variable</p>
</div>
</li>
<li>
<p><code>variable_name=~/some/path/and.file</code></p>
<div class="paragraph">
<p>tilde is resolved to your personal home directory on any OS including windows.</p>
</div>
</li>
<li>
<p><code>array_variable=(value1 value2 value3)</code></p>
<div class="paragraph">
<p>This will only work properly in bash worlds but as no arrays are used in CMD world of <code>devonfw-ide</code> it does not hurt on windows.</p>
</div>
</li>
<li>
<p>Please never surround values with quotes (<code>var="value"</code>)</p>
</li>
<li>
<p>This format is similar to Java <code>*.properties</code> but does not support advanced features as unicode literals, multi-lined values, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to know what to configure, have a look at the available <a href="variables">variables</a>.</p>
</div>
<div class="paragraph">
<p>Please only tweak configurations that you need to change and take according responsibility. There is a price to pay for flexibility, which means you have to be careful what you do.</p>
</div>
<div class="paragraph">
<p>Further, you can configure <a href="mvn">maven</a> via <code>conf/settings.xml</code>. To configure your IDE such as <a href="eclipse">eclipse</a> or <a href="vscode">vscode</a> you can tweak the <a href="settings">settings</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="variables"><a class="anchor" href="#variables"></a>Variables</h4>
<div class="paragraph">
<p>The <code>devonfw-ide</code> defines a set of standard variables to your environment for <a href="configuration">configuration</a> via <code>variables[.bat]</code> files.
These environment variables are described by the following table.
Those variables printed <strong>bold</strong> are also exported in your shell (except for windows CMD that does not have such concept). Variables with the value <code>-</code> are not set by default but may be set via <a href="configuration">configuration</a> to override defaults.
Please note that we are trying to minimize any potential side-effect from <code>devonfw-ide</code> to the outside world by reducing the number of variables and only exporting those that are required.</p>
</div>
<div class="paragraph">
<div class="title">Variables of devonfw-ide</div>
<p>|== == == == == == == == == == == =
|<strong>Variable</strong>|<strong>Value</strong>|<strong>Meaning</strong>
|<code>DEVON_IDE_HOME</code>|e.g. <code>/projects/my-project</code>|The top level directory of your <code>devonfw-ide</code> <a href="structure">structure</a>.
|<code>PATH</code>|<code>$PATH:$DEVON_IDE_HOME/software/java:&#8230;&#8203;</code>|You system path is adjusted by <code>devon</code> <a href="cli">command</a>.
|<code>DEVON_HOME_DIR</code>|<code>~</code>|The platform independent home directory of the current user. In some edge-cases (e.g. in cygwin) this differs from <code>~</code> to ensure a central home directory for the user on a single machine in any context or environment.
|<code>DEVON_IDE_TOOLS</code>|<code>(java mvn node npm)</code>|List of tools that should be installed and upgraded by default for your current IDE.
|<code>DEVON_IDE_CUSTOM_TOOLS</code>|<code>-</code>|List of custom tools that should be installed additionally. See <a href="software#custom">software</a> for further details.
|<code>DEVON_CREATE_START_SCRIPTS</code>|<code>(eclipse vscode)</code>|List of IDEs that shall be used by developers in the project and therefore start-scripts are created on setup.
|<strong><code>DEVON_OLD_PATH</code></strong>|<code>&#8230;&#8203;</code>|A "backup" of <code>PATH</code> before it was extended by <code>devon</code> to allow recovering it. Internal variable that should never be set or tweaked.
|<strong><code>WORKSPACE</code></strong>|<code>main</code>|The <a href="workspaces">workspace</a> you are currently in. Defaults to <code>main</code> if you are not inside a <a href="workspaces">workspace</a>. Never touch this variable in any <code>variables</code> file.
|<code>WORKSPACE_PATH</code>|<code>$DEVON_IDE_HOME/workspaces/$WORKSPACE</code>|Absolute path to current <a href="workspaces">workspace</a>. Never touch this variable in any <code>variables</code> file.
|<strong><code>JAVA_HOME</code></strong>|<code>$DEVON_IDE_HOME/software/java</code>|Path to JDK
|<code>SETTINGS_PATH</code>|<code>$DEVON_IDE_HOME/settings</code>|Path to your <a href="settings">settings</a>. To keep <code>oasp4j-ide</code> legacy behaviour set this to <code>$DEVON_IDE_HOME/workspaces/main/development/settings</code>.
|<strong><code>M2_REPO</code></strong>|<code>$DEVON_IDE_HOME/conf/.m2/repository</code>|Path to your local maven repository. For projects without high security demands, you may change this to the maven default <code>~/.m2/repository</code> and share your repository among multiple projects.
|<strong><code>MAVEN_HOME</code></strong>|<code>$DEVON_IDE_HOME/software/maven</code>|Path to Maven
|<strong><code>MAVEN_OPTS</code></strong>|<code>-Xmx512m -Duser.home=$DEVON_IDE_HOME/conf</code>|Maven options
|<code>DEVON_SOFTWARE_REPOSITORY</code>|<code>-</code>|Project specific or custom <a href="software#repository">software-repository</a>.
|<code>DEVON_SOFTWARE_PATH</code>|<code>-</code>|Globally shared user-specific <a href="software#shared">local software installation location</a>.
|<code>ECLIPSE_VMARGS</code>|<code>-Xms128M -Xmx768M -XX:MaxPermSize=256M</code>|JVM options for Eclipse
|deprecated: <code>ECLIPSE_PLUGINS</code>|<code>-</code>|Array with "feature groups" and "update site URLs" to customize required <a href="eclipse#plugins">eclipse plugins</a>. Deprecated - see <a href="eclipse#plugins">Eclipse plugins</a>.
|<code>«TOOL»_VERSION</code>|<code>-</code>|The version of the tool <code>«TOOL»</code> to install and use (e.g. <code>ECLIPSE_VERSION</code> or <code>MAVEN_VERSION</code>).
|<code>EXTRA_JAVA_VERSION</code>|<code>-</code>|An additional (newer) version of <a href="java">java</a> that will be used to run java-based IDEs (e.g. <a href="eclipse">eclipse</a> or <a href="intellij">intellij</a>).
|<code>«TOOL»_BUILD_OPTS</code>|e.g.<code>clean install</code>|The arguments provided to the build-tool <code>«TOOL»</code> in order to run a build.
|<code>«TOOL»_RELEASE_OPTS</code>|e.g.<code>clean deploy -Dchangelist= -Pdeploy</code>|The arguments provided to the build-tool <code>«TOOL»</code> in order to perform a release build.
|<code>DEVON_IDE_TRACE</code>||If value is not an empty string, the <code>devonfw-ide</code> scripts will trace each script line executed. For bash two lines output: before and again after expansion. <strong>ATTENTION:</strong> This is not a regular variable working via <code>devon.properties</code>. Instead manually do <code>export DEVON_IDE_TRACE=true</code> in bash or <code>DEVON_IDE_TRACE=true</code> in windows CMD before running a devon command to get a trace log that you can provide to experts in order to trace down a bug and see what went wrong.
|== == == == == == == == == == == =</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="devon-cli"><a class="anchor" href="#devon-cli"></a>Devon CLI</h4>
<div class="paragraph">
<p>The <code>devonfw-ide</code> is shipped with a central command <code>devon</code>. The <a href="setup">setup</a> will automatically register this command so it is available in any shell on your system. This page describes the Command Line Interface (CLI) of this command.</p>
</div>
</div>
<div class="sect3">
<h4 id="devon"><a class="anchor" href="#devon"></a>Devon</h4>
<div class="paragraph">
<p>Without any argument the <code>devon</code> command will determine your <code>DEVON_IDE_HOME</code> and setup your <a href="variables">environment variables</a> automatically. In case you are not inside of a <code>devonfw-ide</code> folder the command will echo a message and do nothing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">[/]$ devon
You are not inside a devon IDE installation: /
[/]$ cd /projects/my-project/workspaces/test/my-git-repo
[my-git-repo]$ devon
devonfw-ide has environment variables have been set for /projects/my-project in workspace main
[my-git-repo]$ echo $DEVON_IDE_HOME
/projects/devon
[my-git-repo]$ echo $JAVA_HOME
/projects/my-project/software/java</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="commandlets"><a class="anchor" href="#commandlets"></a>Commandlets</h4>
<div class="paragraph">
<p>The <code>devon</code> command supports a pluggable set of <em>commandlets</em>. Such commandlet is provided as first argument to the devon command and may take additional arguments:</p>
</div>
<div class="paragraph">
<p><code>devon «commandlet» [«arg»]*</code></p>
</div>
<div class="paragraph">
<p>Technically, a commandlet is a bash script located in <code>$DEVON_IDE_HOME/scripts/command</code>. So if you want to integrate another tool with <code>devonfw-ide</code> we are awaiting your pull-request.
Every commandlet takes the following generic arguments:</p>
</div>
<div class="paragraph">
<div class="title">Generic arguments of every commandlet</div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>     |<strong>Meaning</strong>
|<code>-b</code> or <code>--batch</code> |run in non-interactive mode (do not ask any questions).
|<code>-q</code> or <code>--quiet</code> |be quiet and avoid output.
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect3">
<h4 id="command-wrapper"><a class="anchor" href="#command-wrapper"></a>Command-wrapper</h4>
<div class="paragraph">
<p>For many commandlets the <code>devon</code> command acts as a wrapper.
Similar to <code>mvnw</code> or <code>gradlew</code> you can use it as a proxy command.
Therefore <code>devon mvn clean install</code> will be the same as <code>mvn clean install</code>.
The benefit when using <code>devon</code> as wrapper is that it will even work when the command (<code>mvn</code>, <code>node</code>, <code>npm</code>, etc.) is not on your <code>PATH</code> variable or even not yet installed.
We see the main benefit in this for writing portable scripts that you may commit to your git repository and that will then run everywhere and will lazily install the required tools on the fly.
In your daily usage you can and surely should avoid to always type <code>devon</code> as prefix to every command.
However, when you automate and want to avoid "command not found" errors, you can simply prefix the command with <code>devon</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="commandlet-overview"><a class="anchor" href="#commandlet-overview"></a>Commandlet overview</h4>
<div class="paragraph">
<p>The following commandlets are currently available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="build">build</a></p>
</li>
<li>
<p><a href="cobigen">cobigen</a></p>
</li>
<li>
<p><a href="docker">docker</a></p>
</li>
<li>
<p><a href="eclipse">eclipse</a></p>
</li>
<li>
<p><a href="gradle">gradle</a></p>
</li>
<li>
<p><a href="help">help</a></p>
</li>
<li>
<p><a href="ide">ide</a></p>
</li>
<li>
<p><a href="intellij">intellij</a></p>
</li>
<li>
<p><a href="ionic">ionic</a></p>
</li>
<li>
<p><a href="jasypt">jasypt</a></p>
</li>
<li>
<p><a href="java">java</a></p>
</li>
<li>
<p><a href="jenkins">jenkins</a></p>
</li>
<li>
<p><a href="kubernetes">kubernetes</a></p>
</li>
<li>
<p><a href="mvn">mvn</a></p>
</li>
<li>
<p><a href="ng">ng</a></p>
</li>
<li>
<p><a href="node">node</a></p>
</li>
<li>
<p><a href="npm">npm</a></p>
</li>
<li>
<p><a href="release">release</a></p>
</li>
<li>
<p><a href="sonar">sonar</a></p>
</li>
<li>
<p><a href="vscode">vscode</a></p>
</li>
<li>
<p><a href="yarn">yarn</a></p>
</li>
</ul>
</div>
<!-- toc disabled -->
<div class="sect4">
<h5 id="build"><a class="anchor" href="#build"></a>build</h5>
<div class="paragraph">
<p>The <code>build</code> commandlet is an abstraction of build systems like <a href="mvn">maven</a>, <a href="gradle">gradle</a>, <a href="npm">yarn</a>, <a href="npm">npm</a>, etc.
It will auto-detect your build-system (via existence of files like <code>pom.xml</code>, <code>package.json</code>, etc.). According to this detection, it will simply delegate to the according commandlet of the specific build system. If that build-system is not yet available it will be downloaded and installed automatically.</p>
</div>
<div class="paragraph">
<p>So <code>devon build</code> allows users to build any project without bothering about the build-system. Further specific build options can be configured per project. This makes <code>devon build</code> a universal part of every <em>definition of done</em>. Before pushing your changes, please always run the following command to verify the build:</p>
</div>
<div class="paragraph">
<p><code>devon build</code></p>
</div>
<div class="paragraph">
<p>You may also supply additional arguments as <code>devon build «args»</code>. This will simply delegate these arguments to the detected build command (e.g. call <code>mvn «args»</code>).</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="docker"><a class="anchor" href="#docker"></a>Docker</h5>
<div class="paragraph">
<p>The Docker commandlet allows to install and use <a href="https://www.docker.com/">Docker</a>.
On Windows <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">WSL 2</a>(Windows Subsystem for Linux) has to be installed properly as a prerequisite.</p>
</div>
<div class="paragraph">
<p><strong>ATTENTION:</strong>
Currently this feature is new and therefore experimental.
It may change in incompatible ways in the next releases until we reach a stable state.
We hope that all is working fine for you.
However, do not expect everything to work out of the box.
In case you are facing issues (e.g. network problems with Cisco AnyConnect, etc.) please give us feedback so we can improve.</p>
</div>
<div class="paragraph">
<p>The arguments (<code>devon docker «args»</code>) are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon docker</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>             |<strong>Meaning</strong>
|<code>setup</code>                   |setup Docker (install and verify) as per above flow.
|<code>«args»</code>                  |call docker with the specified arguments. Call <code>docker help</code> for details or use docker directly as preferred." (<code>«args»</code>)
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect4">
<h5 id="setup-2"><a class="anchor" href="#setup-2"></a>setup</h5>
<div class="paragraph">
<p>The Docker commandlet will install Docker automatically.
Please note that besides the sandbox concept of devonfw-ide this is a global installation on your system.
When uninstalling devonfw-ide, you may have to manually uninstall Docker and Kubernetes if you do not need it anymore.</p>
</div>
</div>
<div class="sect4">
<h5 id="requirements"><a class="anchor" href="#requirements"></a>requirements</h5>
<div class="paragraph">
<p>Running Docker and especially <a href="kubectl">Kubernetes</a> on your machine in the background will require quite some resources.
This will allocate at least 2GB of additional RAM.</p>
</div>
<div class="paragraph">
<p>You will need at least 8GB of total RAM while we recommend to use 16GB+.</p>
</div>
<div class="paragraph">
<p>You may also tune and scale it to your needs.
When using Docker Desktop (Windows or MacOS) simply go to the <a href="https://docs.docker.com/docker-for-windows/#resources">resources tab in the settings</a>.
It will depend on your usage frequency if you want to have it running in the background all the time.
This is a balance between resource utilization and convenience.
If you use Docker and Kubernetes on your local machine on a daily basis this makes sense.</p>
</div>
<div class="paragraph">
<p>In case you only use Docker rarely, you can save resources by stopping it when not needed after it has been installed.</p>
</div>
</div>
<div class="sect4">
<h5 id="windows-and-macos"><a class="anchor" href="#windows-and-macos"></a>Windows and macOS</h5>
<div class="paragraph">
<p>To enable or disable autostart, you can launch Docker Desktop on Windows or MacOS got to the <code>Preferences</code> (gear icon in the title bar). Then in the <code>General</code> tab you can check or uncheck the option <code>Start Docker Desktop when you login</code> (see also <a href="https://docs.docker.com/docker-for-windows/#general">here</a>). When autostart is disabled and you launch Docker Desktop it will notice and ask your to start the service or do this automatically for you.
On Windows you can also manually tweak this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hit <code>[windows][r]</code></p>
</li>
<li>
<p>Enter <code>services.msc</code></p>
</li>
<li>
<p>Confirm with <code>OK</code></p>
</li>
<li>
<p>In the services app search for the Docker Desktop Service in the list and select it.</p>
</li>
<li>
<p>Now you can start or stop the service by clicking on the according link text.</p>
</li>
<li>
<p>Also when right clicking on Docker Desktop Service and selecting <code>Options</code> from the context-menu, you can change the start type to <code>automatic</code> or <code>manual</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="mac-a1"><a class="anchor" href="#mac-a1"></a>==  Mac A1</h5>
<div class="paragraph">
<p>In case you have a new Mac with A1 CPU, we automatically download and install the according ARM version of Docker Desktop for macOS.
However, if you use Docker and search for images you may end up with errors like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>docker: no matching manifest for linux/arm64/v8 in the manifest list entries.</code></pre>
</div>
</div>
<div class="paragraph">
<p>So with A1 CPU you may need to add <code>--platform linux/x86_64</code> as option to your Docker command to find the expected container image.</p>
</div>
</div>
<div class="sect4">
<h5 id="linux"><a class="anchor" href="#linux"></a>Linux</h5>
<div class="paragraph">
<p>There is no Docker Desktop for Linux.
As Docker initially comes from the Linux world, it is easy to set it up on a Linux machine and use it from the commandline.
Therefore we do not install a GUI for you in case you are a Linux user.
In case you need a GUI for Docker and Kubernetes on Linux you can choose from the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://dockstation.io/">DockStation</a></p>
</li>
<li>
<p><a href="https://portainer.io/">Portainer</a></p>
</li>
<li>
<p><a href="https://kitematic.com/">Kitematic</a></p>
</li>
<li>
<p><a href="https://shipyard-project.com/">Shipyard</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="usage-2"><a class="anchor" href="#usage-2"></a>usage</h5>
<div class="paragraph">
<p>Once installed via setup, you can run Docker directly from any shell of your OS directly.
Run <code>docker help</code> to get started and use the online documentations and resources on the web to get familiar with Docker.
It is not our intention to repeat this here.</p>
</div>
<div class="paragraph">
<p>Please note that the <code>docker</code> commandlet is a <a href="cli#command-wrapper">command wrapper</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="eclipse"><a class="anchor" href="#eclipse"></a>eclipse</h5>
<div class="paragraph">
<p>The eclipse commandlet allows to install, configure, and launch the <a href="https://eclipse.org/">Eclipse IDE</a>.
To launch eclipse for your current workspace and devonfw-ide installation simply run:
<code>devon eclipse</code></p>
</div>
<div class="paragraph">
<p>You may also supply additional arguments as <code>devon eclipse «args»</code>. These are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon eclipse</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>   |<strong>Meaning</strong>
|<code>--all</code>                  |if provided as first arg then to command will be invoked for each workspace
|<code>setup</code>                  |setup Eclipse (install or update)
|<code>add-plugin «id» [«url»]</code>|install an additional plugin
|<code>run</code>                    |launch Eclipse (default if no argument is given)
|<code>start</code>                  |same as <code>run</code>
|<code>ws-up[date]</code>            |update workspace
|<code>ws-re[verse]</code>           |reverse merge changes from workspace into settings
|<code>ws-reverse-add</code>         |reverse merge adding new properties
|<code>create-script</code>          |create launch script for this IDE, your current workspace and your OS
|== == == == == == == == == == == =</p>
</div>
<div class="paragraph">
<p>There are <a href="variables">variables</a> that can be used for Eclipse. These are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Variables of devonfw-ide for Eclipse</div>
<p>|== == == == == == == == == == == =
|<strong>Variable</strong>|<strong>Meaning</strong>
|<strong><code>ECLIPSE_VERSION</code></strong>|The version of the tool Eclipse to install and use.
|<strong><code>ECLIPSE_EDITION_TYPE</code></strong>|The edition of the tool Eclipse to install and use. You can choose between Java for standard edition or JEE for enterprise edition.
|*<code>EXTRA_JAVA_VERSION</code>|You can set this to a different (newer) version of Java used to launch your IDE (other than <code>JAVA_VERSION</code> that is used to build your project)
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect4">
<h5 id="plugins"><a class="anchor" href="#plugins"></a>plugins</h5>
<div class="paragraph">
<p>To be productive with Eclipse you need plugins. Of course <code>devonfw-ide</code> can automate this for your:
In your <a href="settings">settings</a> git repository create a folder <a href="https://github.com/devonfw/ide-settings/tree/master/eclipse/plugins">eclipse/plugins</a> (click on this link to see more examples and see which plugins come by default).
Here you can create a properties file for each plugin. This is an example <a href="https://github.com/devonfw/ide-settings/blob/master/eclipse/plugins/tmterminal.properties">tmterminal.properties</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>plugin_url=http://download.eclipse.org/tm/terminal/marketplace
plugin_id=org.eclipse.tm.terminal.feature.feature.group,org.eclipse.tm.terminal.view.feature.feature.group,org.eclipse.tm.terminal.control.feature.feature.group,org.eclipse.tm.terminal.connector.ssh.feature.feature.group,org.eclipse.tm.terminal.connector.telnet.feature.feature.group
plugin_active=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>The variables are defined as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>plugin_url</code> defines the URL of the Eclipse update site of the plugin</p>
</li>
<li>
<p><code>plugin_id</code> defines the feature group ID(s) to install. To install multiple features/plugins provide a coma-separated list of IDs. If you want to customize <code>devonfw-ide</code> with new plugins you can first install them manually and then go to <code>About Eclipse &gt; Installation Details</code> then you can filter for your newly installed plugin and find the values in the <code>Id</code> column. Copy &amp; paste them from here to make up your own custom config.</p>
</li>
<li>
<p><code>plugin_active</code> is an optional parameter. If it is <code>true</code> (default) the plugin will be installed automatically during the project <a href="setup">setup</a> for all developers in your team. Otherwise, developers can still install the plugin manually via <code>devon eclipse add-plugin «plugin-name»</code> from the config file <code>settings/eclipse/plugins/«plugin-name».properties</code>. See the <code>settings/eclipse/plugins</code> folder for possible values of «plugin-name».</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In general you should try to stick with the configuration pre-defined by your project. But some plugins may be considered as personal flavor and are typically not predefined by the project config. This e.g. applies for devstyle that allows a real dark mode for eclipse and tunes the theming and layout of Eclipse in general. Such plugins should be shipped with your <a href="settings">settings</a> as described above with <code>plugin_active=false</code> allowing you to easily install it manually.</p>
</div>
<div class="paragraph">
<p>As the maintainer of the <a href="settings">settings</a> for your project you should avoid to ship too many plugins that may waste resources but are not used by every developer. By configuring additional plugins with <code>plugin_active=false</code> you can give your developers the freedom to install some additional plugins easily.</p>
</div>
</div>
<div class="sect4">
<h5 id="legacy-plugin-config"><a class="anchor" href="#legacy-plugin-config"></a>legacy plugin config</h5>
<div class="paragraph">
<p>For downward compatibility we still support the deprecated legacy configuration if the folder <code>settings/eclipse/plugins</code> does not exist:
The project <a href="configuration">configuration</a> typically defines the plugins that will be installed via <code>ECLIPSE_PLUGINS</code> <a href="variables">variable</a>. Otherwise defaults from this <code>eclipse</code> <a href="cli#commandlets">commandlet</a> will apply.
Be aware that this comes at your own risk and sometimes plugins can conflict and break your IDE.</p>
</div>
<div class="paragraph">
<p>Here is an example how a project can configure the plugins in its <code>devon.properties</code> inside the <a href="settings">settings</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ECLIPSE_PLUGINS=("AnyEditTools.feature.group" "https://raw.githubusercontent.com/iloveeclipse/plugins/latest/" "com.ess.regexutil.feature.group" "http://regex-util.sourceforge.net/update/")</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the above listed plugins you can also use the short form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ECLIPSE_PLUGINS=("anyedit" "" "regexutil" "")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course you may also mix plugin IDs with fully qualified plugins.</p>
</div>
</div>
<div class="sect4">
<h5 id="dictionary"><a class="anchor" href="#dictionary"></a>dictionary</h5>
<div class="paragraph">
<p>Eclipse already comes with a build-in spellchecker. This is very helpful when writing comments. The default settings of <code>devonfw-ide</code> ship with a project specific <a href="https://github.com/devonfw/ide-settings/blob/master/eclipse/project.dictionary">dictionary file</a> and according configurations to enable spellchecking and configuring this dictionary.
When typing JavaDoc, inline comments or other texts the spellchecker will underline unknown words in red.
If your cursor is located at such a word you can hit <code>[Ctrl][1]</code> to get a context menu with additional options.
There you can either choose similar correct words to correct a typo or you may even add the word (maybe a new business term) to your local dictionary.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/eclipse-spellcheck.png" alt="&quot;Eclipse spellchecker”">
</div>
</div>
<div class="paragraph">
<p>In the latter case, you should commit the changes to your <a href="settings">settings</a> so that it will be available to your entire team.
For further details about committing changes to the settings please consult the <a href="usage#admin">admin usage</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="non-english-dictionary"><a class="anchor" href="#non-english-dictionary"></a>non-english dictionary</h5>
<div class="paragraph">
<p>In case your project has to write documentation or text in languages other than English, you might want to prefill your project dictionary for that language.
Here we collect a list of such dictionaries that you can download and merge into your project dictionary:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>German: <a href="https://sourceforge.net/projects/germandict/" class="bare">https://sourceforge.net/projects/germandict/</a> (has to be converted to UTF-8 e.g. with <a href="advanced-tooling-windows#real-text-editor">Notepad++</a> via <code>Encoding &gt; Convert to UTF-8</code>)</p>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="gradle"><a class="anchor" href="#gradle"></a>gradle</h5>
<div class="paragraph">
<p>The <code>gradle</code> commandlet allows to install, configure, and launch <a href="https://gradle.org/">gradle</a>. It is similar to <a href="https://docs.gradle.org/5.3.1/userguide/gradle_wrapper.html">gradle-wrapper</a>. So calling <code>devon gradle «args»</code> is more or less the same as calling <code>gradle «args»</code> but with the benefit that the version of gradle preferred by your project is used (and will be installed if not yet available).</p>
</div>
<div class="paragraph">
<p>The arguments (<code>devon gradle «args»</code>) are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon gradle</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>   |<strong>Meaning</strong>
|<code>setup</code>         |setup gradle (install and verify), <a href="configuration">configurable</a> via <code>GRADLE_VERSION</code>
|<code>«args»</code>        |run gradle with the given arguments (<code>«args»</code>)
|== == == == == == == == == == == =</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="help"><a class="anchor" href="#help"></a>help</h5>
<div class="paragraph">
<p>The <code>help</code> commandlet provides help for the <a href="cli">CLI</a>.</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon help</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>   |<strong>Meaning</strong>
|                |Print general help
|<code>«command»</code>     |Print help for the <a href="cli#commandlets">commandlet</a> <code>«command»</code>.
|== == == == == == == == == == == =</p>
</div>
<div class="paragraph">
<p>Please note that <code>devon help «command»</code> will do the same as <code>devon «command» help</code>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="ide"><a class="anchor" href="#ide"></a>ide</h5>
<div class="paragraph">
<p>The <code>ide</code> commandlet manages your <code>devonfw-ide</code>.
You need to supply additional arguments as <code>devon ide «args»</code>. These are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon ide</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>                   |<strong>Meaning</strong>
|<code>setup [«SETTINGS_URL»]</code>        |setup devonfw-ide (cloning the settings from the given URL, optionally from specific branch URL#branch)
|<code>update [«package»]</code>            |update devonfw-ide
|<code>update scripts [to «version»]</code> |update devonfw-ide
|<code>uninstall</code>                     |uninstall devonfw-ide (if you want remote it entirely from your system)
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect4">
<h5 id="setup-3"><a class="anchor" href="#setup-3"></a>setup</h5>
<div class="paragraph">
<p>Run <code>devon ide setup</code> to initially setup your <code>devonfw-ide</code>. It is recommended to run the setup script in the top-level directory (<code>$DEVON_IDE_HOME</code>). However, in case you want to skip some system specific integration, you may also run this command directly instead. The setup only needs to be called once after a new <code>devonfw-ide</code> instance has been created. It will follow this process:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="setup#install">install</a> the <code>devon</code> command on your system (if not already installed).</p>
</li>
<li>
<p>clone the <a href="settings">settings</a> (you may provide a git URL directly as argument or you will be prompted for it).</p>
</li>
<li>
<p>install all required <a href="software">software</a> from <code>DEVON_IDE_TOOLS</code> <a href="variables">variable</a> (if not already installed).</p>
</li>
<li>
<p>configure all these tools</p>
</li>
<li>
<p>create IDE launch scripts</p>
</li>
<li>
<p>perform OS specific system integration such as Windows Explorer integration (only done from <code>setup</code> script and not from <code>devon ide setup</code>)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="update-2"><a class="anchor" href="#update-2"></a>update</h5>
<div class="paragraph">
<p>Run <code>devon ide update</code> to update your <code>devonfw-ide</code>. This will check for updates and <a href="setup#install">install</a> them automatically.
The optional extra argument (<code>«package»</code>) behaves as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>scripts</code>: check if a new version of <code>devonfw-ide-scripts</code> is available. If so it will be downloaded and installed. As Windows is using file-locks, it is tricky to update a script while it is executed. Therefore, we update the <code>scripts</code> folder as an async background task and have to abort further processing at this point on windows as a workaround.</p>
</li>
<li>
<p>settings: update the <a href="settings">settings</a> (<code>git pull</code>).</p>
</li>
<li>
<p>software: update the <a href="software">software</a> (e.g. if versions have changed via <code>scripts</code> or <code>settings</code> update).</p>
</li>
<li>
<p>projects: update the <a href="projects">projects</a> (checkout and import repositories into workspace/IDEs).</p>
</li>
<li>
<p>all: do all the above sequentially.</p>
</li>
<li>
<p>none: <code>settings</code> and <code>software</code> are updated by default if no extra argument is given. This is the regular usage for project developers. Only perform an update of <code>scripts</code> when you are requested to do so by your technical lead. Bigger projects especially need to test updates before rolling them out to the entire team. If developers always updated the latest release of the <code>scripts</code> which is released globally, some project functionality would break causing problems and extra efforts in the teams.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to update to a specific version of <code>scripts</code> an explicit version can be specified after the additional <code>to</code> argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon ide update scripts to 3.1.99</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above example will update to the exact version <code>3.1.99</code> no matter if this is an upgrade or a downgrade of your current installed version.
If you just use <code>devon ide update scripts</code> then the latest available version will be installed. In larger teams it is recommended to communicate exact version updates to avoid that a new release can interfere and break anything. Therefore, some pilot user will test a new version for the entire team and, only after a successful test, they will communicate to the team to update to that exact version by providing the complete command as in the above example.</p>
</div>
</div>
<div class="sect4">
<h5 id="uninstall-2"><a class="anchor" href="#uninstall-2"></a>uninstall</h5>
<div class="paragraph">
<p>We hope you love <code>devonfw-ide</code>. However, if you don&#8217;t and want to get rid of it entirely and completely remove all integration, you can use this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon ide uninstall</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will remove <code>devonfw-ide</code> from all central places of your OS (user home directory such as <code>scripts</code>, <code>.devon</code>, <code>.bashrc</code>, as well as windows registry, etc.).
However, it will not remove your current installations (or shared <a href="software">software</a> folder). So after running this <code>uninstall</code>, simply remove your <code>DEVON_IDE_HOME</code> directory of all <code>devonfw-ide</code> installations and potential shared <a href="software">software</a> folder. You may also want to clean up your <code>~/Downloads</code> directory from files downloaded by <code>devonfw-ide</code>. We do not automate this as deleting a directory is a very simple manual step and we do not want to take responsibility for severe data loss if your workspaces contained valuable work.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="intellij"><a class="anchor" href="#intellij"></a>intellij</h5>
<div class="paragraph">
<p>The <code>intellij</code> commandlet allows to install, configure, and launch <a href="https://www.jetbrains.com/idea/">IntelliJ</a>.
To launch IntelliJ for your current workspace and <code>devonfw-ide</code> installation, simply run:
<code>devon intellij</code></p>
</div>
<div class="paragraph">
<p>You may also supply additional arguments as <code>devon intellij «args»</code>. These are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon intellij</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>   |<strong>Meaning</strong>
|<code>--all</code>         |if provided as first arg then to command will be invoked for each workspace
|<code>setup</code>         |setup IntelliJ (install or update)
|<code>add-plugin «id»</code>|install an additional plugin
|<code>run</code>           |launch IntelliJ (default if no argument is given)
|<code>start</code>         |same as <code>run</code>
|<code>ws-up[date]</code>   |update workspace
|<code>ws-re[verse]</code>  |reverse merge changes from workspace into settings
|<code>ws-reverse-add</code>|reverse merge adding new properties
|<code>create-script</code> |create launch script for this IDE, your current workspace and your OS
|== == == == == == == == == == == =</p>
</div>
<div class="paragraph">
<p>There are <a href="variables">variables</a> that can be used for IntelliJ. These are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Variables of devonfw-ide for intelliJ</div>
<p>|== == == == == == == == == == == =
|<strong>Variable</strong>|<strong>Meaning</strong>
|<strong><code>INTELLIJ_VERSION</code></strong>|The version of the tool IntelliJ to install and use.
|<strong><code>INTELLIJ_EDITION_TYPE</code></strong>|The edition of the tool IntelliJ to install and use. The value <code>C</code> mean Community edition and the value <code>U</code> mean Ultimate edition. The Ultimate edition requires a license. The user has to buy the license separately and it is not part of devonfw-ide. The devonfw-ide only supports download and installation.
|*<code>EXTRA_JAVA_VERSION</code>|You can set this to a different (newer) version of Java used to launch your IDE (other than <code>JAVA_VERSION</code> that is used to build your project)
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect4">
<h5 id="plugins-2"><a class="anchor" href="#plugins-2"></a>plugins</h5>
<div class="paragraph">
<p>To be productive with IntelliJ you need plugins. Of course <code>devonfw-ide</code> can automate this for your:
In your <a href="settings">settings</a> git repository create a folder <a href="https://github.com/devonfw/ide-settings/tree/master/intellij/plugins">intellij/plugins</a> (click this link to see more examples and see which plugins come by default).
Here you can create a properties file for each plugin. This is an example <a href="https://github.com/devonfw/ide-settings/blob/master/intellij/plugins/scala.properties">scala.properties</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>plugin_id=org.intellij.scala
plugin_active=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>The variables are defined as following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>plugin_id</code> defines the unique ID of the plugin to install. If you want to customize <code>devonfw-ide</code> with new plugins use the search on <a href="https://plugins.jetbrains.com/idea_ce" class="bare">https://plugins.jetbrains.com/idea_ce</a> to find the plugin of your choice. Select the tab <code>Versions</code> and click on a version in the list. The plugin ID is displayed in the upper right corner. Copy &amp; paste the ID from here to make up your own custom config.</p>
</li>
<li>
<p><code>plugin_active</code> is an optional parameter. If it is <code>true</code> (default) the plugin will be installed automatically during the project <a href="setup">setup</a> for all developers in your team. Otherwise developers can still install the plugin manually via <code>devon intellij add-plugin «plugin_id»</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In general you should try to stick with the configuration pre-defined by your project. But some plugins may be considered as personal flavor and are typically not predefined by the project config. Such plugins should be shipped with your <a href="settings">settings</a> as described above with <code>plugin_active=false</code> allowing you to easily install it manually. Surely, you can easily add plugins via the UI of IntelliJ. However, be aware that some plugins may collect sensitive data or could introduce other vulnerabilities. So consider the governance of your project and talk to your technical lead before installing additional plugins that are not pre-defined in your <a href="settings">settings</a>.</p>
</div>
<div class="paragraph">
<p>As maintainer of the <a href="settings">settings</a> for your project you should avoid to ship too many plugins that may waste resources but are not used by every developer. By configuring additional plugins with <code>plugin_active=false</code> you can give your developers the freedom to install some additional plugins easily.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="ionic"><a class="anchor" href="#ionic"></a>ionic</h5>
<div class="paragraph">
<p>The <code>ionic</code> commandlet allows to install, configure, and launch <a href="https://ionicframework.com/docs/cli">ionic</a> (ionic-cli). Calling <code>devon ionic «args»</code> is more or less the same as calling <code>ionic «args»</code> but with some advanced features and ensuring that ionic is properly set up for your project.</p>
</div>
<div class="paragraph">
<p>The arguments (<code>devon ionic «args»</code>) are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon ionic</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>             |<strong>Meaning</strong>
|<code>setup</code>                   |setup yarn (install and verify), <a href="configuration">configurable</a> via <code>YARN_VERSION</code>
|<code>create</code>                  |Create a new <a href="https://github.com/devonfw/devon4ng/#devon4ng">devon4ng</a> ionic project.
|<code>cicd «args»</code>             |generate cicd files for the current devon4ng project
|<code>«args»</code>                  |run ionic with the given arguments (<code>«args»</code>)
|== == == == == == == == == == == =</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="jasypt"><a class="anchor" href="#jasypt"></a>jasypt</h5>
<div class="paragraph">
<p>The <code>jasypt</code> commandlet allows to install <a href="http://www.jasypt.org/">jasypt</a> and encrypt or decrypt secrets using strong encryption given a secure masterpassword. See also <a href="https://github.com/devonfw/devon4j/blob/master/documentation/guide-configuration#password-encryption">devon4j password encryption guide</a> for further details.</p>
</div>
<div class="paragraph">
<p>The arguments (<code>devon jasypt «args»</code>) are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon mvn</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>             |<strong>Meaning</strong>
|<code>setup</code>                   |setup jasypt (install and verify), <a href="configuration">configurable</a> via <code>JASYPT_VERSION</code>
|<code>encrypt</code>                 |Encrypt a secret with a masterpassword
|<code>decrypt</code>                 |Decrypt an encrypted secret with a masterpassword
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect4">
<h5 id="example"><a class="anchor" href="#example"></a>example</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon jasypt encrypt
Enter masterpassword: master
Enter secret to encrypt/decrypt: secret

----ENVIRONMENT-----------------

Runtime: AdoptOpenJDK OpenJDK 64-Bit Server VM 11.0.9.1+1



----ARGUMENTS-------------------

input: secret
password: master
ivGeneratorClassName: org.jasypt.iv.RandomIvGenerator
algorithm: PBEWITHHMACSHA512ANDAES_256



----OUTPUT----------------------

fQPbaDd8wq0h0qOZw/AEKp2TD4Y07Y//M5PzaLgF3qL7YnBQjiGLtW8s5XkP3Ly9

devon jasypt decrypt
Enter masterpassword: master
Enter secret to encrypt/decrypt: fQPbaDd8wq0h0qOZw/AEKp2TD4Y07Y//M5PzaLgF3qL7YnBQjiGLtW8s5XkP3Ly9

----ENVIRONMENT-----------------

Runtime: AdoptOpenJDK OpenJDK 64-Bit Server VM 11.0.9.1+1



----ARGUMENTS-------------------

input: fQPbaDd8wq0h0qOZw/AEKp2TD4Y07Y//M5PzaLgF3qL7YnBQjiGLtW8s5XkP3Ly9
password: master
ivGeneratorClassName: org.jasypt.iv.RandomIvGenerator
algorithm: PBEWITHHMACSHA512ANDAES_256



----OUTPUT----------------------

secret</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="java"><a class="anchor" href="#java"></a>java</h5>
<div class="paragraph">
<p>The <code>java</code> commandlet allows to install and setup <a href="https://openjdk.java.net/">Java</a>. Also it supports <a href="https://github.com/devonfw/devon4j">devon4j</a>.
The arguments (<code>devon java «args»</code>) are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon java</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>                       |<strong>Meaning</strong>
|<code>setup</code>                             |setup OpenJDK (install or update and verify), <a href="configuration">configurable</a> via <code>JAVA_VERSION</code> (e.g. <code>8u242b08</code> or <code>11.0.6_10</code>)
|create «args»                     |create a new Java project based on <a href="https://github.com/devonfw/devon4j/blob/master/documentation/tutorial-newapp">devon4j application template</a>. If a single argument is provided, this is the package name and is automatically split into <code>groupId</code> and <code>artifactId</code>. Use <code>-DdbType=«db»</code> to choose the database (hana, oracle, mssql, postgresql, mariadb, mysql, h2, hsqldb). Any option starting with dash is passed as is."
|<code>migrate [from «version»] [single]</code> |migrate a <a href="https://github.com/devonfw/devon4j">devon4j</a> project to the latest version. If for some reasons the current devonfw version can not be auto-detected you may provide it manually after the 'from' argument. Also the 'single' option allows to migrate only to the next available version."
|<code>cicd «args»</code>                       |generate cicd files for the current devon4java project
|== == == == == == == == == == == =</p>
</div>
<div class="paragraph">
<p>Since <code>2021.12.003</code> an extra version of Java can be configured via <code>EXTRA_JAVA_VERSION</code> <a href="variables">variable</a>. This can be used to launch your IDE with a different (newer) version of Java but keeping the build of your project stable.</p>
</div>
</div>
<div class="sect4">
<h5 id="create"><a class="anchor" href="#create"></a>create</h5>
<div class="paragraph">
<p>Examples for create a new devon4j application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon java create com.example.domain.myapp</code></pre>
</div>
</div>
<div class="paragraph">
<p>Will create an app with package <code>com.example.domain.myapp</code>, groupId <code>com.example.domain</code>, artifactId <code>myapp</code>, version <code>1.0.0-SNAPSHOT</code>, and h2 database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon java create -Dversion=0.0.1-alpha1 com.example.domain.myapp</code></pre>
</div>
</div>
<div class="paragraph">
<p>Will create an app with package <code>com.example.domain.myapp</code>, groupId <code>com.example.domain</code>, artifactId <code>myapp</code>, version <code>0.0.1-alpha1</code>, and h2 database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon java create com.example.domain.myapp com.example.group</code></pre>
</div>
</div>
<div class="paragraph">
<p>Will create an app with package <code>com.example.domain.myapp</code>, groupId <code>com.example.group</code>, artifactId <code>myapp</code>, version <code>1.0.0-SNAPSHOT</code>, and h2 database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon java create com.example.domain.myapp com.example.group demo-app</code></pre>
</div>
</div>
<div class="paragraph">
<p>Will create an app with package <code>com.example.domain.myapp</code>, groupId <code>com.example.group</code>, artifactId <code>demo-app</code>, version <code>1.0.0-SNAPSHOT</code>, and h2 database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon java create com.example.domain.myapp -DartifactId=demo-app -DdbType=hana</code></pre>
</div>
</div>
<div class="paragraph">
<p>Will create an app with package <code>com.example.domain.myapp</code>, groupId <code>com.example.group</code>, artifactId <code>demo-app</code>, version <code>1.0.0-SNAPSHOT</code>, and SAP hana database.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon java create com.example.domain.myapp -DdbType=oracle -Dversion=0.0.1 com.example.group -Dbatch=batch</code></pre>
</div>
</div>
<div class="paragraph">
<p>Will create an app with package <code>com.example.domain.myapp</code>, groupId <code>com.example.group</code>, artifactId <code>myapp</code>, version <code>0.0.1</code>, oracle database, and with a batch module.</p>
</div>
</div>
<div class="sect4">
<h5 id="migrate"><a class="anchor" href="#migrate"></a>migrate</h5>
<div class="paragraph">
<p>Example for migrating a devon4j application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon java migrate</code></pre>
</div>
</div>
<div class="paragraph">
<p>Will migrate current devon4j application to the latest version available.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="jenkins"><a class="anchor" href="#jenkins"></a>jenkins</h5>
<div class="paragraph">
<p>The <code>jenkins</code> commandlet allows to install, configure, and launch <a href="https://jenkins.io/">Jenkins</a>.</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon jenkins</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>   |<strong>Meaning</strong>
|<code>setup</code>         |Setup Jenkins (install and verify)
|<code>start</code>         |Start your local Jenkins server
|<code>stop</code>          |Stop your local Jenkins server
|<code>add</code>           |Add current project as CI job to your local Jenkins
|== == == == == == == == == == == =</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="kubernetes"><a class="anchor" href="#kubernetes"></a>Kubernetes</h5>
<div class="paragraph">
<p>The <code>kubectl</code> commandlet allows to install and use <a href="https://kubernetes.io/">kubernetes</a>.
On Windows <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">WSL 2</a>(Windows Subsystem for Linux) has to be installed properly as a prerequisite.
The setup on windows will then install kubernetes with <a href="https://k3d.io">K3D</a>. K3D will create a cluster with a single node with a default name as "devonfw-cluster"</p>
</div>
<div class="paragraph">
<p><strong>ATTENTION:</strong>
Currently this feature is new and therefore experimental.
It may change in incompatible ways in the next releases until we reach a stable state.
We hope that all is working fine for you.
However, do not expect everything to work out of the box.
In case you are facing issues (e.g. network problems with Cisco AnyConnect, etc.) please give us feedback so we can improve.</p>
</div>
<div class="paragraph">
<p>The arguments (<code>devon kubectl «args»</code>) are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon kubectl</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>             |<strong>Meaning</strong>
|<code>setup</code>                 |setup Kubernetes (install and verify) as per above flow.
|<code>«args»</code>                  |call kubectl with the specified arguments. Call <code>kubectl help</code> for details or use kubectl directly as preferred.
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect4">
<h5 id="setup-4"><a class="anchor" href="#setup-4"></a>setup</h5>
<div class="paragraph">
<p>Please note that on Windows and macOS, Kubernetes support comes together with <code>Docker Desktop</code> that is installed via <a href="docker">docker</a> commandlet.
When you have installed and launched <code>Docker Desktop</code>, you can once <a href="https://docs.docker.com/desktop/kubernetes/#enable-kubernetes">enable Kubernetes in the Preferences</a>.</p>
</div>
<div class="paragraph">
<p>On Linux however, Kubernetes is installed separately by this commandlet.</p>
</div>
</div>
<div class="sect4">
<h5 id="usage-3"><a class="anchor" href="#usage-3"></a>usage</h5>
<div class="paragraph">
<p>Once installed via setup, you can run <code>kubectl</code> directly from any shell of your OS directly.
Run <code>kubectl help</code> to get started and use the online documentations and resources on the web to get familiar with Kubernetes.
It is not our intention to repeat this here.</p>
</div>
<div class="paragraph">
<p>Please note that the <code>kubectl</code> commandlet is a <a href="cli#command-wrapper">command wrapper</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="mvn"><a class="anchor" href="#mvn"></a>mvn</h5>
<div class="paragraph">
<p>The <code>mvn</code> commandlet allows to install, configure, and launch <a href="https://maven.apache.org/">maven</a>. It is similar to <a href="https://github.com/takari/maven-wrapper">maven-wrapper</a> and <a href="https://github.com/dansomething/mdub">mdub</a>. So calling <code>devon mvn «args»</code> is more or less the same as calling <code>mvn «args»</code> but with the benefit that the version of maven preferred by your project is used (and will be installed if not yet available).</p>
</div>
<div class="paragraph">
<p>The arguments (<code>devon mvn «args»</code>) are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon mvn</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>             |<strong>Meaning</strong>
|                          |run default build, <a href="configuration">configurable</a> via <code>MVN_BUILD_OPTS</code>
|<code>setup</code>                   |setup Maven (install and verify), <a href="configuration">configurable</a> via <code>MAVEN_VERSION</code>
|<code>get-version</code>             |Print the version of your current project. Will consolidate the version for multi-module projects ignoring <code>dev[-SNAPSHOT]</code> versions and fail on mixed versions.
|<code>set-version «nv» [«cv»]</code> |Set the version of your current project to <code>«nv»</code> (assuming your current version is <code>«cv»</code>).
|<code>check-no-snapshots</code>      |Check if no <code>«version»-SNAPSHOT</code> dependencies are used.
|<code>check-top-level-project</code> |Check if you are running on a top-level project or fail if in a module or no maven project at all.
|release                   |Start a clean deploy release build, <a href="configuration">configurable</a> via <code>MVN_RELEASE_OPTS</code>
|<code>«args»</code>        |run maven with the given arguments (<code>«args»</code>)
|== == == == == == == == == == == =</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="ng"><a class="anchor" href="#ng"></a>ng</h5>
<div class="paragraph">
<p>The <code>ng</code> commandlet allows to install, configure, and launch <a href="https://cli.angular.io/">ng</a> (angular-cli). Calling <code>devon ng «args»</code> is more or less the same as calling <code>ng «args»</code> but with some advanced features and ensuring that <code>ng</code> is properly set up for your project.</p>
</div>
<div class="paragraph">
<p>The arguments (<code>devon ng «args»</code>) are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon ng</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>             |<strong>Meaning</strong>
|<code>setup</code>                   |setup yarn (install and verify), <a href="configuration">configurable</a> via <code>NG_VERSION</code>
|<code>create</code>                  |Create a new <a href="https://github.com/devonfw/devon4ng/#devon4ng">devon4ng</a> project.
|<code>cicd «args»</code>             |generate cicd files for the current devon4ng project
|<code>«args»</code>                  |run ng with the given arguments (<code>«args»</code>)
|== == == == == == == == == == == =</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="node"><a class="anchor" href="#node"></a>node</h5>
<div class="paragraph">
<p>The <code>node</code> commandlet allows to install and setup <a href="https://nodejs.org/">node.js</a>.
The arguments (<code>devon node «args»</code>) are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon node</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>   |<strong>Meaning</strong>
|<code>setup</code>         |setup <code>node.js</code> (install and verify), <a href="configuration">configurable</a> via <code>NODE_VERSION</code>
|<code>create «name» [«args»]</code> | create a new devon4node application <code>(same as devon4node new)</code>
|<code>generate «s» [«args»]</code>    | generate devon4node components using the schematic «s» <code>(same as devon4node generate)</code>
|<code>db «c» [«args»]</code>          | execute a TypeORM command «c» <code>(same as devon4node db)</code>
|<code>cicd «args»</code>              |generate cicd files for the current devon4node project
|<code>«args»</code>                   | call NodeJS with the specified arguments
|== == == == == == == == == == == =</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="npm"><a class="anchor" href="#npm"></a>npm</h5>
<div class="paragraph">
<p>The <code>npm</code> commandlet allows to install, configure, and launch <a href="https://www.npmjs.com/">npm</a>. Calling <code>devon npm «args»</code> is more or less the same as calling <code>npm «args»</code> but with the benefit that the version of npm preferred by your project is used (and will be installed if not yet available).</p>
</div>
<div class="paragraph">
<p>The arguments (<code>devon npm «args»</code>) are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon npm</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>             |<strong>Meaning</strong>
|                          |run default build, <a href="configuration">configurable</a> via <code>NPM_BUILD_OPTS</code>
|<code>setup</code>                   |setup NPM (install and verify), <a href="configuration">configurable</a> via <code>NPM_VERSION</code>
|<code>get-version</code>             |print the version of your current project
|<code>set-version «nv» [«cv»]</code> |set the version of your current project to <code>«nv»</code> (assuming your current version is <code>«cv»</code>)
|<code>check-top-level-project</code> |check if you are running on a top-level project or fail if in a module or no NPM project at all
|<code>release</code>                 |Start a clean deploy release build, <a href="configuration">configurable</a> via <code>NPM_RELEASE_OPTS</code>
|<code>«args»</code>                  |run NPM with the given arguments (<code>«args»</code>)
|== == == == == == == == == == == =</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="release"><a class="anchor" href="#release"></a>release</h5>
<div class="paragraph">
<p>Create a release in a standardized way including the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>verify the current project (no local changes, etc.)</p>
</li>
<li>
<p>warn if <code>«version»-SNAPSHOT</code> dependencies are used</p>
</li>
<li>
<p>determine <code>«version»</code> (if currently <code>«version»-SNAPSHOT</code>) and print out release information.</p>
</li>
<li>
<p>ask user for confirmation</p>
</li>
<li>
<p>bump release to <code>«version»</code> in build configuration (e.g. <code>pom.xml</code> files)</p>
</li>
<li>
<p>commit the change</p>
</li>
<li>
<p>create annotated tag for your release as <code>release/«version»</code></p>
</li>
<li>
<p>invoke deployment on build-system</p>
</li>
<li>
<p>set next version as <code>(«version»+1)-SNAPSHOT</code> in build configuration (e.g. <code>pom.xml</code> files)</p>
</li>
<li>
<p>commit the change</p>
</li>
<li>
<p>push your changes</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon java</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>                       |<strong>Meaning</strong>
|<code>&#8230;&#8203;</code>                               |any optional argument will directly be passed to the actual command to build the deployment
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect4">
<h5 id="build-tools"><a class="anchor" href="#build-tools"></a>Build-Tools</h5>
<div class="paragraph">
<p>This <code>release</code> commandlet utilizes the <a href="build">build</a> commandlet to support multiple build-tools such as <a href="mvn">maven</a>, <a href="gradle">gradle</a>, or <a href="npm">npm</a>. Each of those commandlets should respect the <a href="variables">variable</a> <code>«TOOL»_RELEASE_OPTS</code> to customize the parameters for the release build.</p>
</div>
<div class="paragraph">
<p>So e.g. if a <code>pom.xml</code> is detected, maven will be used. In this example the variable <code>MVN_RELEASE_OPTS</code> is used that defaults to <code>clean deploy -Dchangelist= -Pdeploy</code>.
If you provide a specific argument this will be passed additionally.
So if you invoke the command <code>devon release -P myProfile</code>, the above step <code>invoke deployment on build-system</code> would technically call this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>mvn clean deploy -Dchangelist= -Pdeploy -P myProfile</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please also note that it is very tricky to determine and modify the version of a project in a fully generic way.
Even though we try our best to support different scenarios, we can not ensure this is working for edge-cases.
Therefore, we strongly encourage to follow best practices such as <a href="https://maven.apache.org/maven-ci-friendly.html">ci-friendly maven</a>.
Further, sticking to the defaults and follow the devonfw standard to name the profile for custom goals in deployment simply <code>deploy</code> is recommended.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="sonar"><a class="anchor" href="#sonar"></a>sonar</h5>
<div class="paragraph">
<p>The <code>sonar</code> commandlet allows to install, configure, and launch <a href="https://www.sonarqube.org">SonarQube</a>.</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon sonar</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>   |<strong>Meaning</strong>
|<code>setup</code>         |Setup SonarQube (install and verify)
|<code>start</code>         |Start your local SonarQube server
|<code>stop</code>          |Stop your local SonarQube server
|<code>analyze</code>        |Analyze current project with SonarQube
|== == == == == == == == == == == =</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="vscode"><a class="anchor" href="#vscode"></a>vscode</h5>
<div class="paragraph">
<p>The <code>vscode</code> commandlet allows to install, configure, and launch <a href="https://code.visualstudio.com/">Visual Studio Code</a>.
To launch VSCode for your current workspace and <code>devonfw-ide</code> installation, simply run:
<code>devon vscode</code></p>
</div>
<div class="paragraph">
<p>You may also supply additional arguments as <code>devon vscode «args»</code>. These are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon vscode</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>   |<strong>Meaning</strong>
|<code>--all</code>         |if provided as first arg then to command will be invoked for each workspace
|<code>setup</code>         |setup VSCode (install or update)
|<code>add-plugin «id»</code>|install an additional plugin (extension)
|<code>run</code>           |launch VSCode (default if no argument is given)
|<code>start</code>         |same as <code>run</code>
|<code>ws-up[date]</code>   |update workspace
|<code>ws-re[verse]</code>  |reverse merge changes from workspace into settings
|<code>ws-reverse-add</code>|reverse merge adding new properties
|<code>create-script</code> |create launch script for this IDE, your current workspace and your OS
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect4">
<h5 id="plugins-3"><a class="anchor" href="#plugins-3"></a>plugins</h5>
<div class="paragraph">
<p>To be productive with VS Code you need plugins (called <code>extensions</code> in VS Code). Of course <code>devonfw-ide</code> can automate this for your:
In your <a href="settings">settings</a> git repository create a folder <a href="https://github.com/devonfw/ide-settings/tree/master/vscode/plugins">vscode/plugins</a> (click this link to see more examples and see which plugins come by default).
Here you can create a properties file for each plugin. This is an example <a href="https://github.com/devonfw/ide-settings/blob/master/vscode/plugins/devonfw-extension-pack.properties">devonfw-extension-pack.properties</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>plugin_id=devonfw.devonfw-extension-pack
plugin_active=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>The variables are defined as following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>plugin_id</code> defines the unique ID of the plugin to install. If you want to customize <code>devonfw-ide</code> with new plugins click on <code>Extensions</code> at the bottom of the left navigation icon bar in VS code. Then use the search to find the plugin of your choice. If you click on it the plugin ID is displayed in grey beside the official title at the top of the plugin details page. Copy &amp; paste the ID from here to make up your own custom config.</p>
</li>
<li>
<p><code>plugin_active</code> is an optional parameter. If it is <code>true</code> (default) the plugin will be installed automatically during the project <a href="setup">setup</a> for all developers in your team. Otherwise developers can still install the plugin manually via <code>devon vscode add-plugin «plugin-name»</code> from the config file <code>settings/vscode/plugins/«plugin-name».properties</code>. See the <code>settings/vscode/plugins</code> folder for possible values of «plugin-name».</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In general you should try to stick with the configuration pre-defined by your project. But some plugins may be considered as personal flavor and are typically not predefined by the project config. Such plugins should be shipped with your <a href="settings">settings</a> as described above with <code>plugin_active=false</code> allowing you to easily install it manually. Surely, you can easily add plugins via the UI of VS code. However, be aware that some plugins may collect sensitive data or could introduce other vulnerabilities. So consider the governance of your project and talk to your technical lead before installing additional plugins that are not pre-defined in your <a href="settings">settings</a>.</p>
</div>
<div class="paragraph">
<p>As maintainer of the <a href="settings">settings</a> for your project you should avoid to ship too many plugins that may waste resources but are not used by every developer. By configuring additional plugins with <code>plugin_active=false</code> you can give your developers the freedom to install some additional plugins easily.</p>
</div>
</div>
<div class="sect4">
<h5 id="cleaning-plugins-on-update"><a class="anchor" href="#cleaning-plugins-on-update"></a>cleaning plugins on update</h5>
<div class="paragraph">
<p>If you want to strictly manage the plugins for <code>VS code</code> in your project, you can create or edit the file <code>settings/vscode/plugins</code> in your <a href="settings">settings</a> and add this variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>clean_plugins_on_update=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will wipe all plugins when an update of <code>VS code</code> is performed (e.g. via <code>devon ide update</code>) and reinstall all configured plugins. While this gives you more control over the governance of the plugins and allows to remove a plugin later during project lifecycle. However, this will delete all manually installed plugins automatically without asking.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="yarn"><a class="anchor" href="#yarn"></a>yarn</h5>
<div class="paragraph">
<p>The <code>yarn</code> commandlet allows to install, configure, and launch <a href="https://www.npmjs.com/">npm</a>. Calling <code>devon yarn «args»</code> is more or less the same as calling <code>yarn «args»</code> but with the benefit that the version of npm preferred by your project is used (and will be installed if not yet available).</p>
</div>
<div class="paragraph">
<p>The arguments (<code>devon yarn «args»</code>) are explained by the following table:</p>
</div>
<div class="paragraph">
<div class="title">Usage of <code>devon yarn</code></div>
<p>|== == == == == == == == == == == =
|<strong>Argument(s)</strong>             |<strong>Meaning</strong>
|                          |run default build, <a href="configuration">configurable</a> via <code>YARN_BUILD_OPTS</code>
|<code>setup</code>                   |setup yarn (install and verify), <a href="configuration">configurable</a> via <code>YARN_VERSION</code>
|<code>get-version</code>             |print the version of your current project
|<code>set-version «nv» [«cv»]</code> |set the version of your current project to <code>«nv»</code> (assuming your current version is <code>«cv»</code>)
|<code>check-top-level-project</code> |check if you are running on a top-level project or fail if in a module or no NPM project at all
|<code>release</code>                 |start a clean deploy release build, <a href="configuration">configurable</a> via <code>YARN_RELEASE_OPTS</code>
|<code>«args»</code>                  |run yarn with the given arguments (<code>«args»</code>)
|== == == == == == == == == == == =</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
</div>
<div class="sect3">
<h4 id="structure"><a class="anchor" href="#structure"></a>Structure</h4>
<div class="paragraph">
<p>The directory layout of your <code>devonfw-ide</code> will look like this:</p>
</div>
<div class="listingblock">
<div class="title">Listing 1. File structure of your devonfw-ide</div>
<div class="content">
<pre>/ projects (or C:\Projects, etc.)
└──/ my-project (<a href="variables">$DEVON_IDE_HOME</a>)
    ├──/ <a href="conf">conf</a>
    ├──/ <a href="log">log</a>
    ├──/ <a href="scripts">scripts</a>
    ├──/ <a href="settings">settings</a>
    ├──/ <a href="software">software</a>
    ├──/ <a href="system">system</a>
    ├──/ <a href="updates">updates</a>
    ├──/ <a href="workspaces">workspaces</a>
    ├── <a href="setup">setup</a>
    ├── <a href="setup">setup.bat</a>
    └── devon-ide-doc.pdf</pre>
</div>
</div>
<div class="paragraph">
<p>The elements of the above structure are described in the individual sections. As they are hyperlinks you can simply click on them to get more details.</p>
</div>
<!-- toc disabled -->
<div class="sect4">
<h5 id="conf"><a class="anchor" href="#conf"></a>conf</h5>
<div class="paragraph">
<p>This folder contains configurations for your IDE:</p>
</div>
<div class="listingblock">
<div class="title">Listing 2. File structure of the conf folder</div>
<div class="content">
<pre class="highlightjs highlight"><code>/ conf
├──/ .m2
│  ├──/ repository
│  │  ├──/ ant
│  │  ├──/ ...
│  │  └──/ zw
│  ├── settings-security.xml
│  └── settings.xml
├──/ .sonar
├──/ ...
└── variables</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>.m2</code> folder is used for configurations of <a href="mvn">maven</a>. It contains the local <code>repository</code> folder used as cache for artifacts downloaded and installed by maven (see also <a href="https://maven.apache.org/guides/introduction/introduction-to-repositories.html">maven repositories</a>).
Further, there are two configuration files for maven:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://maven.apache.org/settings.html">settings.xml</a> initialized from a template from your <code>devonfw-ide</code> <a href="#settings">settings</a>. You may customize this to your needs (configuring HTTP proxies, credentials, or other user-specific settings). Secrets can be specified as <code>$[«variable.name»]</code> and will be prompted, encrypted and replaced automatically during the setup (unless in <a href="cli#commandlets">batch mode</a>). Please note that this process is skipped in batch mode and also if you use the default settings URL (for simplicity of testing). To make use of this feature simply fork or copy the settings to your own git repo. In case your credentials have changed or you made a typo, you can simply redo this step by first moving your <code>${DEVON_IDE_HOME}/conf/.m2/settings.xml</code> file to a temporary folder and then calling <code>devon mvn setup</code>.</p>
</li>
<li>
<p><a href="https://maven.apache.org/guides/mini/guide-encryption.html">settings-security.xml</a> is auto-generated for you by <code>devonfw-ide</code> with a random password. This should make it easier for <code>devonfw-ide</code> users to use <a href="https://maven.apache.org/guides/mini/guide-encryption.html">password encryption</a> and never add passwords in plain text for better security.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Finally,there is a file <code>variables</code> for the user-specific <a href="configuration">configuration</a> of <code>devonfw-ide</code>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="log"><a class="anchor" href="#log"></a>log</h5>
<div class="paragraph">
<p>The log directory is used to store log files e.g. for the IDE <a href="configurator">configurator</a>. You may look here for debug information if something goes wrong.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="scripts"><a class="anchor" href="#scripts"></a>scripts</h5>
<div class="paragraph">
<p>This directory is the heart of the <code>devonfw-ide</code> and contains the required <a href="https://github.com/devonfw/ide/tree/master/scripts/src/main/resources/scripts">scripts</a>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 3. File structure of the conf folder</div>
<div class="content">
<pre>/scripts
├──/ <a href="https://github.com/devonfw/ide/tree/master/scripts/src/main/resources/scripts/command">command</a>
│  ├── <a href="build">build</a>
│  ├── <a href="docker">docker</a>
│  ├── <a href="eclipse">eclipse</a>
│  ├── <a href="gradle">gradle</a>
│  ├── <a href="help">help</a>
│  ├── <a href="ide">ide</a>
│  ├── <a href="intellij">intellij</a>
│  ├── <a href="ionic">ionic</a>
│  ├── <a href="jasypt">jasypt</a>
│  ├── <a href="java">java</a>
│  ├── <a href="jenkins">jenkins</a>
│  ├── <a href="kubectl">kubectl</a>
│  ├── <a href="mvn">mvn</a>
│  ├── <a href="ng">ng</a>
│  ├── <a href="node">node</a>
│  ├── <a href="npm">npm</a>
│  ├── <a href="project">project</a>
│  ├── <a href="release">release</a>
│  ├── <a href="sonar">sonar</a>
│  ├── <a href="vscode">vscode</a>
│  └── <a href="yarn">yarn</a>
├── <a href="cli">devon</a>
├── <a href="cli">devon.bat</a>
├── <a href="configuration">environment-project</a>
├── <a href="configuration">environment-project.bat</a>
├── <a href="functions">functions</a>
└── <a href="configuration">devon.properties</a></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/devonfw/ide/tree/master/scripts/src/main/resources/scripts/command">command</a> folder contains the <a href="cli#commandlets">commandlets</a>.
The <a href="https://github.com/devonfw/ide/tree/master/scripts/src/main/resources/scripts/devon">devon</a> script is the key <a href="cli">command line interface</a> for <code>devonfw-ide</code>.
There is also <a href="https://github.com/devonfw/ide/tree/master/scripts/src/main/resources/scripts/devon.bat">devon.bat</a> that can be used in cmd or PowerShell.
As the <code>devon</code> <a href="cli">CLI</a> can be used as a global command on your computer from any directory and gets <a href="setup#install">installed</a> centrally, it aims to be stable, minimal, and lightweight.
The key logic to set up the environment variables is therefore in a separate script <a href="https://github.com/devonfw/ide/tree/master/scripts/src/main/resources/scripts/environment-project">environment-project</a> and its Windows variant <a href="https://github.com/devonfw/ide/tree/master/scripts/src/main/resources/scripts/environment-project.bat">environment-project.bat</a> inside this <code>scripts</code> folder.
The file <a href="https://github.com/devonfw/ide/tree/master/scripts/src/main/resources/scripts/functions">functions</a> contains a collection of reusable bash functions.
These are sourced and used by the <a href="cli#commandlets">commandlets</a>.
Finally the <code>devon.properties</code> file contains defaults for the general <a href="configuration">configuration</a> of <code>devonfw-ide</code>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="settings"><a class="anchor" href="#settings"></a>settings</h5>
<div class="paragraph">
<p>The <code>devonfw-ide</code> requires <code>settings</code> with configuration templates for the arbitrary tools.</p>
</div>
<div class="paragraph">
<p>To get an initial set of these settings we provide the default <a href="https://github.com/devonfw/ide-settings">ide-settings</a> as an initial package. These are also released so you can download the latest stable or any history version at <a href="http://search.maven.org/#search|ga|1|a%3A%22devonfw-ide-settings%22">maven central</a>.</p>
</div>
<div class="paragraph">
<p>To test <code>devonfw-ide</code> or for very small projects you can also use these the latest default settings (just hit return when <a href="setup">setup</a> is asking for the <code>Settings URL</code>).
However, for collaborative projects we strongly encourage you to distribute and maintain the settings via a dedicated and project specific <code>git</code> repository.
This gives you the freedom to control and manage the tools with their versions and configurations during the project lifecycle.
Therefore simply follow the <a href="usage#admin">admin usage guide</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="structure-2"><a class="anchor" href="#structure-2"></a>Structure</h5>
<div class="paragraph">
<p>The settings folder (see <code><a href="variables">SETTINGS_PATH</a></code>) has to follow this file structure:</p>
</div>
<div class="listingblock">
<div class="title">Listing 4. File structure of settings</div>
<div class="content">
<pre>/settings
├──/ <a href="https://github.com/devonfw/ide-settings/tree/master/devon">devon</a>
│  ├──/ <a href="https://github.com/devonfw/ide-settings/tree/master/devon/conf">conf</a>
│  │  ├──/ <a href="https://github.com/devonfw/ide-settings/tree/master/devon/conf/.m2">.m2</a>
│  │  │  └── <a href="https://github.com/devonfw/ide-settings/blob/master/devon/.m2/settings.xml">settings.xml</a>
│  │  ├──/ <a href="https://github.com/devonfw/ide-settings/tree/master/devon/conf/npm">npm</a>
│  │  │  └── <a href="https://github.com/devonfw/ide-settings/blob/master/devon/conf/npm/.npmrc">.npmrc</a>
│  │  └── <a href="https://github.com/devonfw/ide-settings/blob/master/devon/conf/devon.properties">devon.properties</a>
├──/ <a href="https://github.com/devonfw/ide-settings/tree/master/eclipse">eclipse</a>
│  ├──/ <a href="https://github.com/devonfw/ide-settings/tree/master/eclipse/workspace">workspace</a>
│  │  ├──/ <a href="https://github.com/devonfw/ide-settings/tree/master/eclipse/workspace/setup">setup</a>
│  │  └──/ <a href="https://github.com/devonfw/ide-settings/tree/master/eclipse/workspace/update">update</a>
│  ├── <a href="https://github.com/devonfw/ide-settings/blob/master/eclipse/lifecycle-mapping-metadata.xml">lifecycle-mapping-metadata.xml</a>
│  └── <a href="https://github.com/devonfw/ide-settings/blob/master/eclipse/project.dictionary">project.dictionary</a>
├──/ ...
├──/ <a href="https://github.com/devonfw/ide-settings/tree/master/sonarqube">sonarqube</a>
│  └──/ <a href="https://github.com/devonfw/ide-settings/tree/master/sonarqube/profiles">profiles</a>
│     ├── Devon-C#.xml
│     ├── ...
│     └── Devon-XML.xml
├──/ <a href="https://github.com/devonfw/ide-settings/tree/master/vscode">vscode</a>
│  └──/ <a href="https://github.com/devonfw/ide-settings/tree/master/vscode/workspace">workspace</a>
│     ├──/ <a href="https://github.com/devonfw/ide-settings/tree/master/vscode/workspace/setup">setup</a>
│     └──/ <a href="https://github.com/devonfw/ide-settings/tree/master/vscode/workspace/update">update</a>
└── <a href="https://github.com/devonfw/ide-settings/blob/master/devon.properties">devon.properties</a></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the <code>settings</code> folder contains sub-folders for tools of the IDE.
So the <code>devon</code> folder contains <code>devon.properties</code> files for the <a href="configuration">configuration</a> of your environment.
Further, for the IDEs such as <a href="eclipse">eclipse</a> or <a href="vscode">vscode</a>, the according folders contain the templates to manage the workspace via our <a href="configurator">configurator</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="configuration-philosophy"><a class="anchor" href="#configuration-philosophy"></a>Configuration Philosophy</h5>
<div class="paragraph">
<p>Different tools and configuration files require a different handling:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Where suitable, we directly use these configurations from your <code>settings</code> (e.g. for <code>eclipse/lifecycle-mapping-metadata.xml</code>, or <code>eclipse/project.dictionary</code>).</p>
</li>
<li>
<p>The <code>devon</code> folder in <code>settings</code> contains templates for configuration files. There are copied to the <code>devonfw-ide</code> installation during <a href="setup">setup</a> (if no such file already exists). In this way the <code>settings</code> repository can provide reasonable defaults but allows the user to take over control and customize to his personal needs (e.g. <code>.m2/settings.xml</code>).</p>
</li>
<li>
<p>Other configurations need to be imported manually. To avoid manual steps and simplify use we try to automate as much as possible. This currently applies to <code>sonarqube</code> profiles but will be automated with <a href="https://github.com/devonfw/sonar-devon4j-plugin">sonar-devon4j-plugin</a> in the future.</p>
</li>
<li>
<p>For tools with complex configuration structures like <a href="eclipse">eclipse</a>, <a href="intellij.">intellij</a>, or <a href="vscode">vscode</a> we provide a smart mechanism via our <a href="configurator">configurator</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="customize-settings"><a class="anchor" href="#customize-settings"></a>Customize Settings</h5>
<div class="paragraph">
<p>You can easily customize these settings for the requirements of your project. We suggest that one team member is responsible to ensure that everything stays consistent and works.</p>
</div>
<div class="paragraph">
<p>You may also create new sub-folders in <code>settings</code> and put individual items according to your needs. E.g. you could add scripts for <a href="https://addons.mozilla.org/de/firefox/addon/greasemonkey">greasemonkey</a> or <a href="https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo">tampermonkey</a>, as well as scripts for your database or whatever may be useful and worth to share in your team. However, to share and maintain knowledge we recommend to use a wiki.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="software"><a class="anchor" href="#software"></a>software</h5>
<div class="paragraph">
<p>The <code>software</code> folder contains the third party tools for your IDE such as <a href="mvn">maven</a>, <a href="npm">npm</a>, <a href="java">java</a>, etc.
With respect to the <a href="license">licensing terms</a> you may create a custom archive containing a <code>devonfw-ide</code> together with the required software.
However, to be platform independent and allow lightweight updates, the <code>devonfw-ide</code> is capable to download and <a href="install">install</a> the software automatically for you.</p>
</div>
</div>
<div class="sect4">
<h5 id="repository"><a class="anchor" href="#repository"></a>Repository</h5>
<div class="paragraph">
<p>By default, software is downloaded via the internet from public download URLs of the according tools. However, some projects may need specific tools or tool versions that are not publicly available.
In such case, they can create their own software repository (e.g. in a <code>VPN</code>) and <a href="configuration">configure</a> the base URL of it via <code>DEVON_SOFTWARE_REPOSITORY</code> <a href="variables">variable</a>.
Then, <code>devonfw-ide</code> will download all software from this repository only instead of the default public download URLs.
This repository (URL) should be accessible within your network via HTTPS (or HTTP) and without any authentication.
The repository needs to have the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>${DEVON_SOFTWARE_REPOSITORY}/«tool»/«version»/«tool»-«version»[-«os»].tgz</code></pre>
</div>
</div>
<div class="paragraph">
<p>So for every tool <code>«tool»</code> (<a href="java">java</a>, <a href="mvn">maven</a>, <a href="vscode">vscode</a>, <a href="eclipse">eclipse</a>, etc.) you need to provide a folder in your repository.
Within this folder for every supported version <code>«version»</code> you need a subfolder.
This subfolder needs to contain the tool in that version for every operating system <code>«os»</code> (<code>windows</code>, <code>linux</code>, or <code>mac</code> - omitted if platform independent, e.g. for <code>maven</code>).</p>
</div>
</div>
<div class="sect4">
<h5 id="shared"><a class="anchor" href="#shared"></a>Shared</h5>
<div class="paragraph">
<p>By default, each installation of <code>devonfw-ide</code> has its own physical installations of the required tools in the desired versions stored in its local <code>software</code> folder.
While this is great for isolation of <code>devonfw-ide</code> installations and to prevent side-effects, it can cause a huge waste of disc resources in case you are having many installations of <code>devonfw-ide</code>.
If you are a power-user of <code>devonfw-ide</code> with more then ten or even up to hundreds of installations on your machine, you might love to share installations of a software tool in a particular version between multiple <code>devonfw-ide</code> installations.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
If you use this power-feature you are taking responsibility for side-effects and should not expect support. Also if you are using Windows please read <a href="https://www.joshkel.com/2018/01/18/symlinks-in-windows/">Symlinks in Windows</a> and make your mind if you really want to do so. You might also use this <a href="advanced-tooling-windows#create-symbolic-links">hint</a> and maintain it manually without enabling the following feature.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to do so, you only need to <a href="configuration">configure</a> the variable <code>DEVON_SOFTWARE_PATH</code> in your <code>~/devon.properties</code> pointing to an existing directory on your disc (e.g. <code>/projects/software</code> or <code>C:\projects\software</code>).
Then <code>devonfw-ide</code> will install required software into <code>${DEVON_SOFTWARE_PATH}/${software_name}/${software_version}</code> as needed and create a symbolic link to it in <code>${DEVON_IDE_HOME}/software/${software_name}</code>.</p>
</div>
<div class="paragraph">
<p>As a benefit, another <code>devonfw-ide</code> installation will using the same software with the same version can re-use the existing installation and only needs to create the symbolic link. No more waste of having many identical JDK installations on your disc.</p>
</div>
<div class="paragraph">
<p>As a drawback, you need to be aware that specific tools may be "manipulated" after installation.
The most common case is that a tool allows to install plugins or extensions such as all IDEs do. Such "manipulations" will cause side-effects between the different <code>devonfw-ide</code> installations sharing the same version of that tool.
While this can also be a benefit it may also cause trouble.
If you have a sensitive project that should not be affected by such side-effects, you may again override the <code>DEVON_SOFTWARE_PATH</code> variable to the empty value in your <code>${DEVON_IDE_HOME}/conf/devon.properties</code> of that sensitive installation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>DEVON_SOFTWARE_PATH=</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will disable this feature particularly for that specific sensitive <code>devonfw-ide</code> installation but let you use it for all other ones.</p>
</div>
</div>
<div class="sect4">
<h5 id="custom"><a class="anchor" href="#custom"></a>Custom</h5>
<div class="paragraph">
<p>In some cases, a project might need a (proprietary) tool(s) that (are) not supported by <code>devonfw-ide</code>. A very simple solution is to get a release of <code>devonfw-ide</code> and add the tool(s) to the software folder and then distribute this modified release to your team. However, this has several drawbacks as you then have a fork of <code>devonfw-ide</code> all will loose your tool(s) when updating to a new release.</p>
</div>
<div class="paragraph">
<p>As a solution for this need, <code>devonfw-ide</code> let&#8217;s you configure custom tools via the <code>DEVON_IDE_CUSTOM_TOOLS</code> <a href="variables">variable</a>. It can be defined in <a href="configuration"><code>devon.properties</code></a> of your <a href="settings">settings</a> git repository as an array of the custom tools you need to add.
Each entry applies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It needs to have the form <code>«tool»:«version»[:all][:«repository-url»]</code></p>
</li>
<li>
<p>The first entry must have the <code>«repository-url»</code> included which is used as default</p>
</li>
<li>
<p>Further entries will inherit this default if omitted</p>
</li>
<li>
<p>This URL is used in the same way as described above for a software <a href="#repository">repository</a>.</p>
</li>
<li>
<p>The <code>DEVON_SOFTWARE_REPOSITORY</code> variable is ignored by this feature.</p>
</li>
<li>
<p>The optional infix <code>:all</code> is used to indicate that the tool is platform independent. Otherwise, an OS specific infix is appended to the URL file to download for your platform (<code>windows</code>, <code>linux</code>, or <code>mac</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As an example, we define it in <code>${DEVON_IDE_HOME}/settings/devon.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>DEVON_IDE_CUSTOM_TOOLS=(jboss-eap:7.1.4.GA:all:https://host.tld/projects/my-project firefox:70.0.1)</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will download and extract the following content to your <code>software</code> folder:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="https://host.tld/projects/my-project/jboss-eap/7.1.4.GA/jboss-eap-7.1.4.GA.tgz" class="bare">https://host.tld/projects/my-project/jboss-eap/7.1.4.GA/jboss-eap-7.1.4.GA.tgz</a></code></p>
</li>
<li>
<p><code><a href="https://host.tld/projects/my-project/firefox/70.0.1/firefox-70.0.1-windows.tgz" class="bare">https://host.tld/projects/my-project/firefox/70.0.1/firefox-70.0.1-windows.tgz</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please note that if you are not using windows, the <code>-windows</code> suffix will be <code>-mac</code> or <code>-linux</code>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="system"><a class="anchor" href="#system"></a>system</h5>
<div class="paragraph">
<p>The <a href="https://github.com/devonfw/ide/tree/master/scripts/src/main/resources/system">system</a> folder contains documentation and solutions for operation system specific <a href="integration">integration</a>. Please have a look to get the maximum out of <code>devonfw-ide</code> and become a very efficient power user.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="updates"><a class="anchor" href="#updates"></a>updates</h5>
<div class="paragraph">
<p>The <code>updates</code> folder is used for temporary data. This includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>extracted archives for installation and updates</p>
</li>
<li>
<p>backups of old content on updates to prevent data loss</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If all works fine you may clean this folder to save some kilo- or mega-bytes. Otherwise, you can ignore it unless you are looking for a backup after a failed or unplanned upgrade.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="workspaces"><a class="anchor" href="#workspaces"></a>workspaces</h5>
<div class="paragraph">
<p>The <code>workspaces</code> folder contains folders for your active work. There is a workspace folder <code>main</code> dedicated for your primary work. You may do all your work inside the <code>main</code> workspace. Also, you are free to create any number of additional workspace folders named as you like (e.g. <code>test</code>, <code>release</code>, <code>testing</code>, <code>my-sub-project</code>, etc.). Using multiple workspaces is especially relevant for Eclipse as each workspace has its own Eclipse runtime instance and configuration.</p>
</div>
<div class="paragraph">
<p>Within the workspace folder (e.g. <code>workspaces/main</code>) you are again free to create sub-folders for (sub-)projects according to your needs. We assume that in most cases you clone git repositories here. The following structure shows an example layout for devonfw:</p>
</div>
<div class="listingblock">
<div class="title">Listing 5. File structure of workspaces</div>
<div class="content">
<pre>/ workspaces
├──/ main
│  ├──/ <a href="configurator">.metadata</a>
│  ├──/ <a href="https://github.com/devonfw/ide">ide</a>
│  ├──/ <a href="https://github.com/devonfw/devon4j">devon4j</a>
│  └──/ <a href="https://github.com/devonfw/my-thai-star">my-thai-star</a>
└──/ stable
   ├──/ <a href="configurator">.metadata</a>
   ├──/ <a href="https://github.com/devonfw/ide">ide</a>
   └──/ <a href="https://github.com/devonfw/devon4j">devon4j</a></pre>
</div>
</div>
<div class="paragraph">
<p>In the <code>main</code> workspace you may find the cloned forks for regular work (in the example e.g. <code>devon4j</code>) as a base to create pull-requests while in the <code>stable</code> workspace there is a clone of <code>devon4j</code> from the official <a href="https://github.com/devonfw/devon4j/">devon4j</a>.
However, this is just an example. Some people like to create separate workspaces for development and maintenance branches with git. Other people just switch between those via <code>git checkout</code>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="project-import"><a class="anchor" href="#project-import"></a>Project import</h5>
<div class="paragraph">
<p>The <code>devonfw-ide</code> supports to automatically check out and import required projects into your IDE during <a href="setup">setup</a>. To configure this you put a <code>.properties</code> file for each desired project into the <code>projects</code> sub-folder in your <a href="settings">settings</a>. Each <code>.properties</code> file describes one "project" which you would like to check out and (potentially) import:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">path=myproject
workingsets=Set1,Set2
workspace=example
git.url=http://github.com/someorg/someproject
git.branch=develop
build.path=.
build.cmd=mvn -DskipTests=true -Darchetype.test.skip=true clean install
eclipse=import
active=true</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>.Variables of project import</pre>
</div>
</div>
<div class="paragraph">
<p>|== =
|<strong>Variable</strong>|<strong>Value</strong>|<strong>Meaning</strong>
|<code>path</code>|e.g. <code>myproject</code>, will clone into <code>${WORKSPACE_PATH}/myproject</code>|(required) Path into which the projects is cloned. This path is relative to the workspace.
|<code>working sets</code>|e.g. <code>ws1,ws2</code>|(optional) This will create working sets (in eclipse). Each module (eclipse project) of this project will be part of all these working sets. Working sets will be automatically created if necessary.
|<code>workspace</code>|<code>main</code>|Workspace to use for checkout and import. Default is <code>main</code>.
|<code>git.url</code>|e.g. <code><a href="http://github.com/someorg/someproject" class="bare">http://github.com/someorg/someproject</a></code>|(required) Git URL to use for cloning the project.
|<code>git.branch</code>|e.g. <code>develop</code>|(optional) Git branch to checkout. Git default branch is default.
|<code>build.path</code>|e.g. <code>.</code> (default)|(optional) The directory inside <code>path</code> where to trigger an initial build after clone or pull (if <code>build.cmd</code> is set). For a regular project use <code>.</code> to build top-level project.
|<code>build.cmd</code>
|e.g. <code>mvn -D skip Tests=true -Darchetype.test.skip=true clean install</code>
|(optional) The <em>devonfw</em> command to invoke to build the project after clone or pull. If omitted no build is triggered.
|<code>eclipse</code>|e.g. <code>import</code>|(optional) Desired action for eclipse IDE. If you put <code>import</code> here all modules (eclipse projects) in the current project will be imported into eclipse. If you leave this out or put any other value for this parameter, no change in eclipse is done.
|<code>active</code>|<code>true</code>|(optional) If set to <code>false</code> the project is skipped during the <a href="setup">setup</a>.
|== =</p>
</div>
<div class="paragraph">
<p>Please note that the <code>.properties</code> file is parsed via shell and not via java. So be careful with "advanced" features <code>.properties</code> files normally support.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="advanced-features"><a class="anchor" href="#advanced-features"></a>Advanced Features</h3>
<!-- toc disabled -->
<div class="sect3">
<h4 id="cross-platform-tooling"><a class="anchor" href="#cross-platform-tooling"></a>Cross-Platform Tooling</h4>

</div>
<div class="sect3">
<h4 id="git-client"><a class="anchor" href="#git-client"></a>Git Client</h4>
<div class="paragraph">
<p>If you are looking for a git client that works cross-platform we recommend to use <a href="https://git-fork.com/">Fork</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="draw-diagrams"><a class="anchor" href="#draw-diagrams"></a>Draw Diagrams</h4>
<div class="paragraph">
<p>To draw diagrams for your project or for blueprints in devonfw, we recommend the following cross-platform tools:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://draw.io/">draw.io</a> is a powerful generic vector painting program (similar to visio). You can get a free open-source edition for your desktop from <a href="https://github.com/jgraph/drawio-desktop/releases">here</a>.</p>
</li>
<li>
<p><a href="https://www.objectaid.com/">ObjectAid</a> is a nice and easy to use eclipse plugin that you can use to quickly create UML diagrams from existing code. While class-diagrams are supported for free, you need to buy a license if you want to use the other diagram types.</p>
</li>
<li>
<p><a href="https://plantuml.com/">PlantUML</a> is a great tool that can render UML diagrams from simple markup that can be easily managed in git or other version-control systems together with your code. Its simplicity allows branching and merging unlike other greedy binary UML data-formats.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="browser-plugins"><a class="anchor" href="#browser-plugins"></a>Browser Plugins</h4>
<div class="paragraph">
<p>There are tons of helpful browser plugins out there and it might be a matter of personal taste what you like to have installed. However, as we are heavily using github we want to promote <a href="https://github.com/buunguyen/octotree#octotree">octotree</a>.
In case you also work with ZenHub you might want to install the <a href="https://www.zenhub.com/extension">Zenhub Browser Extension</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="windows-tooling"><a class="anchor" href="#windows-tooling"></a>Windows Tooling</h4>

</div>
<div class="sect3">
<h4 id="installing-software"><a class="anchor" href="#installing-software"></a>Installing software</h4>
<div class="paragraph">
<p>The devon IDE already contains a lot of software. But if you need more, here are some ways to get it easily:</p>
</div>
</div>
<div class="sect3">
<h4 id="chocolatey"><a class="anchor" href="#chocolatey"></a>Chocolatey</h4>
<div class="paragraph">
<p><a href="https://chocolatey.org/">Chocolatey</a> is a repository for free and open source software similar to the repositories know from the Linux like apt, apk, pacman, &#8230;&#8203;</p>
</div>
</div>
<div class="sect3">
<h4 id="winget"><a class="anchor" href="#winget"></a>Winget</h4>
<div class="paragraph">
<p>Microsoft is also working on a repository for Windows called <a href="https://github.com/microsoft/winget-cli">winget</a>. It is currently in alpha state, but is expected to be integrated in the upcoming Windows 11.</p>
</div>
</div>
<div class="sect3">
<h4 id="integration-into-windows-explorer"><a class="anchor" href="#integration-into-windows-explorer"></a>Integration into Windows-Explorer</h4>
<div class="paragraph">
<p>After you have <a href="setup">set up</a> your <code>devonfw-ide</code> on a windows machine,
you already have windows-explorer integration out-of-the-box.
Just right-click on the folder you would like to open in a terminal and choose from the context menu:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Git Bash</p>
</li>
<li>
<p>Open devonfw cmd shell here</p>
</li>
<li>
<p>Open devonfw PowerShell here</p>
</li>
<li>
<p>Open devonfw Cygwin Bash here (only if cygwin was installed during setup)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="tabs-everywhere"><a class="anchor" href="#tabs-everywhere"></a>Tabs everywhere</h4>
<div class="paragraph">
<p>Many people got used to <em>tabs</em> that have been introduced by all major browsers:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/tools-tabs-firefox.png" alt="tabs in firefox">
</div>
<div class="title">Figure 1. Tabs in Firefox</div>
</div>
<div class="paragraph">
<p>This nice feature can be added to many other tools.</p>
</div>
</div>
<div class="sect3">
<h4 id="tabs-for-windows-explorer"><a class="anchor" href="#tabs-for-windows-explorer"></a>Tabs for Windows Explorer</h4>
<div class="paragraph">
<p>If you want to have tabs for windows explorer simply install <a href="http://en.ejie.me/">Clover</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/tools-tabs-explorer.png" alt="tabs in windows explorer">
</div>
<div class="title">Figure 2. Tabs in Windows Explorer</div>
</div>
</div>
<div class="sect3">
<h4 id="tabs-for-ssh"><a class="anchor" href="#tabs-for-ssh"></a>Tabs for SSH</h4>
<div class="paragraph">
<p>If you want to have tabs for your SSH client <a href="http://www.putty.org/">Putty</a> (or even better <a href="http://www.9bis.net/kitty/">Kitty</a> that comes with <a href="https://winscp.net/">WinSCP</a> integration) you simply install <a href="https://github.com/jimradford/superputty#superputty-application">SuperPutty</a>
BTW: Windows 10 has already an SSH client included.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/tools-tabs-ssh.png" alt="tabs for SSH sessions">
</div>
<div class="title">Figure 3. Tabs for SSH</div>
</div>
</div>
<div class="sect3">
<h4 id="tabs-for-cmd"><a class="anchor" href="#tabs-for-cmd"></a>Tabs for CMD</h4>
<div class="paragraph">
<p>If you want to have tabs for your windows command-line you simply install <a href="https://conemu.github.io/">ConEmu</a>. Here you can also add other shells like Putty.
Also you should have a look at the new <a href="https://github.com/Microsoft/Terminal">Windows Terminal</a> which also supports tabs.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/tools-tabs-cmd.png" alt="tabs for windows shells">
</div>
<div class="title">Figure 4. Tabs for CMD</div>
</div>
<div class="paragraph">
<p>See <a href="integration">integration</a> to make ConEmu work flawless with <code>devonfw-ide</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="windows-helpers"><a class="anchor" href="#windows-helpers"></a>Windows Helpers</h4>

</div>
<div class="sect3">
<h4 id="handle-passwords"><a class="anchor" href="#handle-passwords"></a>Handle passwords</h4>
<div class="paragraph">
<p>Do you want complex passwords that differ for each account for security? Do you only want to remember a single password for simplicity? Do you want to have both? Then, you need to install <a href="https://keepass.info/">KeePass</a> right now.</p>
</div>
</div>
<div class="sect3">
<h4 id="real-text-editor"><a class="anchor" href="#real-text-editor"></a>Real text editor</h4>
<div class="paragraph">
<p>A real developer needs a real text editor and not windows built in <code>notepad</code>.
The most common choice is <a href="https://notepad-plus-plus.org/">Notepad++</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="real-compression-tool"><a class="anchor" href="#real-compression-tool"></a>Real compression tool</h4>
<div class="paragraph">
<p>Do you need to deal with ZIP files, TGZ, dpkg, etc.? Just install <a href="http://www.7-zip.org/">7zip</a> and forget about windows build-in ZIP support (that is buggy with long file paths, etc.).</p>
</div>
</div>
<div class="sect3">
<h4 id="smarter-clipboard"><a class="anchor" href="#smarter-clipboard"></a>Smarter clipboard</h4>
<div class="paragraph">
<p>Do you want to paste something from the clipboard but meanwhile you had to copy something else? Just, one of the many things you can easily do with <a href="http://ditto-cp.sourceforge.net/">ditto</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="powertoys"><a class="anchor" href="#powertoys"></a>PowerToys</h4>
<div class="paragraph">
<p>Microsoft provides some extensions to improve the workflow in windows called <a href="https://github.com/microsoft/PowerToys">PowerToys</a>. The include tools like a file renamer, a way to order your windows on the screen, a color picker and more.</p>
</div>
</div>
<div class="sect3">
<h4 id="sysinternals-tools"><a class="anchor" href="#sysinternals-tools"></a>Sysinternals Tools</h4>
<div class="paragraph">
<p>A real developer will quickly notice that windows build in tools to analyze processes, network connections, autostarts, etc. are quite poor. So, what you really would like is the <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite">Sysinternals-Suite</a>. You can make process-explorer your <a href="https://www.ricksdailytips.com/make-process-explorer-default-task-manager/">default task manager</a>. Use autoruns to prevent nasty background things to be started automatically. Use tcpview to figure out which process is blocking port 8080, etc.</p>
</div>
</div>
<div class="sect3">
<h4 id="cope-with-file-locks"><a class="anchor" href="#cope-with-file-locks"></a>Cope with file locks</h4>
<div class="paragraph">
<p>Did you ever fail to delete a file or directory that was locked by some process and you did not even know which one it was?
Then you might love <a href="https://www.iobit.com/en/iobit-unlocker.php">IoBit Unlocker</a>.
See also <a href="https://www.howtogeek.com/128680/HOW-TO-DELETE-MOVE-OR-RENAME-LOCKED-FILES-IN-WINDOWS/">this article</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="create-symbolic-links"><a class="anchor" href="#create-symbolic-links"></a>Create symbolic links</h4>
<div class="paragraph">
<p>Are you are used to symbolic and hard links in Linux? Do you have to work with Windows? Would you also like to have such links in Windows? Why not? Windows <a href="https://www.howtogeek.com/howto/16226/complete-guide-to-symbolic-links-symlinks-on-windows-or-linux/">supports real links</a> (not shortcuts like in other cases).
If you even want to have it integrated in windows explorer you might want to install <a href="http://schinagl.priv.at/nt/hardlinkshellext/linkshellextension.html">linkshellextension</a>. However, you might want to disable SmartMove in the <a href="http://schinagl.priv.at/nt/hardlinkshellext/hardlinkshellext.html#configuration">configuration</a> if you face strange performance issues when moving folders.</p>
</div>
</div>
<div class="sect3">
<h4 id="linux-2"><a class="anchor" href="#linux-2"></a>Linux</h4>
<div class="paragraph">
<p>Install <a href="https://www.cygwin.com/">Cygwin</a> and get your bash in windows with ssh-agent, awk, sed, tar, and all the tools you love (or hate). Windows 10 has already a Linux as an installable feature included: WSL and from Version 2004 on WSL2, which is a native Linux Kernel running on Windows (in a light weight VM).</p>
</div>
</div>
<div class="sect3">
<h4 id="x11"><a class="anchor" href="#x11"></a>X11</h4>
<div class="paragraph">
<p>Do you want to connect via SSH and need to open an X11 app from the server? Do you want to see the GUI on your windows desktop?
No problem: Install <a href="https://sourceforge.net/projects/vcxsrv/">VcXsrv</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="keyboard-freak"><a class="anchor" href="#keyboard-freak"></a>Keyboard Freak</h4>
<div class="paragraph">
<p>Are you a keyboard shortcut person? Do you want to have shortcuts for things like « and » ?
Then you should try <a href="https://www.autohotkey.com/">AutoHotKey</a>.
For the example (« and ») you can simply use this script to get started:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>^&lt;::Send {U+00AB}
^+&lt;::Send {U+00BB}</code></pre>
</div>
</div>
<div class="paragraph">
<p>First, just press <code>[ctrl][&lt;]</code> and <code>[ctrl][&gt;]</code> (<code>[ctrl][shift][&lt;]</code>). Next, create shortcuts to launch your IDE, to open your favorite tool, etc.
If you like a GUI to easily configure the scrips, that comes with a lot of extensions preinstalled, you should have a look at <a href="https://activaid.telgkamp.de/">Ac&#8217;tive Aid</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="paint-anywhere-on-your-desktop"><a class="anchor" href="#paint-anywhere-on-your-desktop"></a>Paint anywhere on your desktop</h4>
<div class="paragraph">
<p>Do you collaborate sharing your screen, and want to mark a spot on top of what you see? Use <a href="http://epic-pen.com/">Epic Pen</a> to do just that.</p>
</div>
</div>
<div class="sect3">
<h4 id="analyze-graphs"><a class="anchor" href="#analyze-graphs"></a>Analyze graphs</h4>
<div class="paragraph">
<p>Do you need to visualize complex graph structures? Convert them to <a href="https://en.wikipedia.org/wiki/Trivial_Graph_Format">Trivial Graph Format</a> <code>(.tgf)</code>, a run <a href="https://www.yworks.com/products/yed">yEd</a> to get an interactive visualization of your graph.</p>
</div>
</div>
<div class="sect3">
<h4 id="up-your-screen-capture-game"><a class="anchor" href="#up-your-screen-capture-game"></a>Up your screen capture game</h4>
<div class="paragraph">
<p>Capture any part of your screen with a single click, directly upload to dropbox, or run a svn commit all in one go with <a href="http://getgreenshot.org/">Greenshot</a>. Another screen capture tool where you can easily manage and edit your screenshots and also do screen recordings with is <a href="https://www.screenpresso.com/download/">Screenpresso</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="fast-search-in-windows"><a class="anchor" href="#fast-search-in-windows"></a>Fast Search in Windows</h4>
<div class="paragraph">
<p><a href="https://voidtools.com/">Everything</a> is a desktop search utility for Windows that can rapidly find files and folders by name.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="macos-tooling"><a class="anchor" href="#macos-tooling"></a>MacOS Tooling</h4>

</div>
<div class="sect3">
<h4 id="finder"><a class="anchor" href="#finder"></a>Finder</h4>
<div class="paragraph">
<p>If you want to open a terminal from a folder in Finder and automatically get your environment set properly for <code>devonfw-ide</code> you will find the perfect solution here.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/finder-integration.png" alt="devonfw-ide integration in MacOS Finder">
</div>
</div>
<div class="paragraph">
<p>So after installing (see below) the integration(s) provided here, you can easily open a terminal ready for your <code>devonfw-ide</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>right click (<code>[control]</code> + click) on file or folder in <code>Finder</code></p>
</li>
<li>
<p>Expand the <code>Quick-Actions</code> sub-menu</p>
</li>
<li>
<p>Click on the desired action (e.g. <code>Open devonfw-Terminal here</code>)</p>
</li>
<li>
<p>Verify that you environment is properly initialized by invoking:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>mvn -v</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>To get this feature for macOS <code>Terminal.app</code> open Finder and run the workflow <code>system/mac/terminal/Open_devonfw-Terminal_here.workflow</code> (in <code>${DEVON_IDE_HOME}</code>). For iTerm2.app (that can be installed from <code>App Store</code>) do the same with <code>system/mac/iterm/Open_devonfw-iTerm_here.workflow</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="keyboard"><a class="anchor" href="#keyboard"></a>Keyboard</h4>
<div class="paragraph">
<p>Keyboard support is not an integration however, some users coming from other platforms may struggle with the way macOS deals with (external non-apple) keyboards.
So to make it short: if you are happy with your keyboard and shortcuts, you can skip all the following.
Otherwise, if you think that pressing keys like <code>Home</code>, <code>End</code>, etc. should just work as expected or pressing <code>Alt Gr</code> should allow you to type the special characters as printed on your German keyboard then here you will find a solution to your problems!
To get all automated you can just run the script <code>system/mac/keyboard/install-mac-keyboard-support.sh</code> (in <code>${DEVON_IDE_HOME}</code>).
If you would like to understand what is going on, you want to customize the keyboard settings to your needs, or you want a keyboard layout other than German ISO, please read on.</p>
</div>
</div>
<div class="sect3">
<h4 id="keyboard-layouts"><a class="anchor" href="#keyboard-layouts"></a>Keyboard Layouts</h4>
<div class="paragraph">
<p>Keyboard layouts allow a find-grained mapping of each key on your keyboard to its resulting input character or behaviour.
They are macOS native features and do not need to have software running as a background service to make the keyboard mapping work (see Karabiner section below as an alternative).
They are provided as so called <code>bundle</code> (white lego brick icon). Like a macOS app this is a folder containing a <code>Contents</code> folder with a specific sub-folder structure.
In the <code>Resources</code> subfolder <code>*.keylayout</code> files are placed and define the exact mapping for the keyboard.
As an example we provide a <code>Keyboard Layouts</code> folder containing a <code>bundle</code> for a German keyboard mapping.</p>
</div>
<div class="paragraph">
<p>To install keyboard layouts simply double-click the <code>bundle</code> or copy it to <code>~/Library/Keyboard Layouts</code>.
To actually use them go to <code>System Preferences</code> and select <code>Keyboard</code>.
Then, select the tab <code>Input Sources</code>.
With the <code>+</code> button you can add a keyboard layout for your daily usage with your Mac.
Please note that the keyboard layout shipped with <code>devonfw-ide</code> is called <code>German-ISO</code> and can be found in the <code>Others</code> section at the end of the list.
It can be used as an example or template, if you want to create your own layout.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/keyboard-layouts.png" alt="Keyboard Preferences / Input Sources">
</div>
</div>
<div class="paragraph">
<p>When you have multiple mappings in place, on the top menu bar you will find a little icon next to the current time that allows you to switch between the keyboard layouts, which is very handy when you switch from your native MacBook keyboard to an external USB keyboard or vice versa.
Even for a pure MacOS geek this can be helpful in case a friend coming from Windows/Linux is supposed to type something on the Mac in a pair-programming session.</p>
</div>
<div class="paragraph">
<p>In our German keyboard mapping example you can use the keys like <code>Alt Gr</code>, etc. to type special characters as you would expect and as printed on your keyboard.
To make <code>Pos1</code>, <code>End</code>, etc. work properly across all apps please read on to the next section(s).</p>
</div>
<div class="paragraph">
<p>In case you would like to create your own keyboard layout you can of course edit the <code>*.keylayout</code> files in a text editor.
However, to make this much more comfortable, you can use the graphical editor tool <a href="https://scripts.sil.org/ukelele">Ukelele</a>.
Besides, the app itself, the Ukelele <code>dmg</code> file, also contains a <code>Documentation</code> and a <code>Resources</code> folder.
The latter contains many keyboard layouts that you can use as a starting point.</p>
</div>
</div>
<div class="sect3">
<h4 id="key-bindings"><a class="anchor" href="#key-bindings"></a>Key Bindings</h4>
<div class="paragraph">
<p>Still, various keyboard shortcuts might not work as expected for you.
Therefore, we provide you with an advanced configuration in the folder <code>system/mac/keyboard/KeyBindings</code> that you can copy to your <code>~/Library</code> folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>cd system/mac/keyboard/
cp -r KeyBindings ~/Library</code></pre>
</div>
</div>
<div class="paragraph">
<p>To make the changes work you need to log out and log in again or you can reboot.
After that, your <code>Home</code> (<code>Pos1</code>) and <code>End</code> buttons should work as expected including with selection via <code>Shift</code> and/or <code>Command</code>.
Also, you can use <code>Command</code> together with the left or right arrow key to move between words and combined it with <code>Shift</code> for selection.
As an example, for further customization you can press <code>Command</code> + <code>&lt;</code> to type the unicode character <code>«</code>.</p>
</div>
<div class="paragraph">
<p>However, still some apps listen to keyboard events on a lower level and come with their own keyboard mappings.
In these apps you might still experience unexpected behaviour.
Solutions can be found in the following sub-sections.</p>
</div>
</div>
<div class="sect3">
<h4 id="switch-control-and-command"><a class="anchor" href="#switch-control-and-command"></a>Switch Control and Command</h4>
<div class="paragraph">
<p>If you are used to windows or linux and get easily confused by the apple keyboard behaviour you might want to switch the <code>Control</code> and the <code>Option</code> key.
Open <code>System Preferences</code> and select <code>Keyboard</code>.
Then, in the first tab, click on the button <code>Modifier Keys&#8230;&#8203;</code>.
For every keyboard you can customize the behaviour of your modifier keys and therefore switch <code>Control</code> and <code>Option</code> as illustrated in the screenshot:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/keyboard-modifier-keys.png" alt="Keyboard Preferences / Modifier Keys">
</div>
</div>
<div class="paragraph">
<p>Programmers now should also disable that <code>Control</code> + <code>Space</code> is opening <code>Spotlight Search</code> as otherwise this shortcut can not be redefined in other apps like common IDEs.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/keyboard-shortcuts.png" alt="Keyboard Preferences / Shortcuts">
</div>
</div>
</div>
<div class="sect3">
<h4 id="eclipse-2"><a class="anchor" href="#eclipse-2"></a>==  Eclipse</h4>
<div class="paragraph">
<p>In Eclipse, move and select by word as described above does not work.
Even worse, the most important shortcut does not work: <code>Control</code> + <code>Space</code> for code completion (content assist).
You can manually redefine the key bindings in <code>Preferences</code> under <code>General &gt; Keys</code>.
However, with multiple IDE installations and workspaces this will quickly get tedious.
Therefore, you can <code>Export</code> and <code>Import</code> specific <code>Preferences</code> such as <code>Keys Preferences</code> to/from a <code>*.epf</code> (Eclipse PreFerences) file.
We have done all this for you so you can just import the file located in <code>system/mac/keyboard/Eclipse/eclipse-mac-keybindings.epf</code> into your Eclipse.
Happy coding.</p>
</div>
</div>
<div class="sect3">
<h4 id="karabiner"><a class="anchor" href="#karabiner"></a>Karabiner</h4>
<div class="paragraph">
<p>If you want more dynamics and do not worry about an app that has to run in the background to make your keyboard work as you like (no relevant performance overhead), you can try <a href="https://pqrs.org/osx/karabiner/">Karabiner Elements</a>.
This is a powerful tool to remap your keyboard shortcuts.
In the UI you can only directly create and edit <code>Simple Modifications</code> that are too limited for most use-cases.
However, using <code>Complex Modifications</code> you can do a lot of magic to customize the keyboard behaviour to your personal needs.
A key with any combination of modifiers can be mapped to any key with arbitrary modifiers.
This can also be bound to conditions based on the frontmost application or the keyboard model.
These complex modifications are configured as <code>*.json</code> files.
We have included a set with useful rules for external keyboards, programmer shortcuts, etc.
If you have Karabiner installed, you only need to copy the contents of the <code>karabiner</code> folder located in this directory to your <code>~/.config</code> folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>cd system/mac/keyboard/
cp karabiner/assets/complex_modifications/*.json ~/.config/karabiner/assets/complex_modifications/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, if you open the <code>Complex Modifications</code> in the Karabiner app, you can click on the <code>+ Add rule</code> button and will see these mappings in the pop up.
Select the rules you want to add (e.g. add all) and you are done.
Unlike other solutions, you can quickly tweak your keyboard without the need to log out and restart apps, which gives faster trial and error turnarounds.
Further, if you want to tweak your own configs, Karabiner comes with a secondary app called Karabiner-EventViewer that shows you the names of the keys, modifiers, and apps for the events you are triggering.
This is very helpful to get the config right.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="linux-tooling"><a class="anchor" href="#linux-tooling"></a>Linux Tooling</h4>
<div class="paragraph">
<p>There is nothing in this section so far. If you are a Linux user, please share your experience and provide your valuable hints.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="lombok"><a class="anchor" href="#lombok"></a>Lombok</h4>
<div class="paragraph">
<p>Even though not officially recommended by <code>devon4j</code> some projects want to use <a href="https://projectlombok.org/">lombok</a> in their project.
As this requires some tweaks for IDEs we do support you with this guide in case you want to use it.</p>
</div>
</div>
<div class="sect3">
<h4 id="lombok-in-eclipse"><a class="anchor" href="#lombok-in-eclipse"></a>Lombok in Eclipse</h4>
<div class="paragraph">
<p>For eclipse there is a plugin to activate <a href="https://projectlombok.org/setup/eclipse">lombok support in eclipse</a>.
We have this already configured for you in our default <a href="settings">settings</a>. So for manual installation after <a href="setup">setup</a>, you can get it via this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon eclipse add-plugin lombok</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, to avoid manual extra effort for lombok based projects you only need to activate this plugin in your project specific <a href="settings">settings</a> in <a href="https://github.com/devonfw/ide-settings/blob/master/eclipse/plugins/lombok.properties#L3">lombok.properties for eclipse</a> (replace <code>false</code> with <code>true</code> for <code>plugin_active</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="lombok-for-vs-code"><a class="anchor" href="#lombok-for-vs-code"></a>Lombok for VS-Code</h4>
<div class="paragraph">
<p>For VisualStudio Code there is an extension to activate <a href="https://projectlombok.org/setup/vscode">lombok support in VS-Code</a>.
We have this already preconfigured for you in our default <a href="settings">settings</a>. So for manual installation after <a href="setup">setup</a>, you can get it via this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon vscode add-plugin lombok</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, to avoid manual extra effort for lombok based projects you only need to activate this plugin in your project specific <a href="settings">settings</a> in <a href="https://github.com/devonfw/ide-settings/blob/master/vscode/plugins/lombok.properties#L2">lombok.properties for vscode</a> (replace <code>false</code> with <code>true</code> for <code>plugin_active</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="lombok-for-intellij"><a class="anchor" href="#lombok-for-intellij"></a>Lombok for IntelliJ</h4>
<div class="paragraph">
<p>For IntelliJ there is a plugin to activate <a href="https://projectlombok.org/setup/intellij">lombok support in IntelliJ</a>.
Currently we have not yet configured or automated this in <code>devonfw-ide</code>.
Please contribute to change this. See issues <a href="https://github.com/devonfw/ide/issues/453">#453</a> and <a href="https://github.com/devonfw/ide/issues/491">#491</a>.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="support"><a class="anchor" href="#support"></a>Support</h3>
<!-- toc disabled -->
<div class="sect3">
<h4 id="migration-from-oasp4j-ide"><a class="anchor" href="#migration-from-oasp4j-ide"></a>Migration from oasp4j-ide</h4>
<div class="paragraph">
<p>The <code>devonfw-ide</code> is a completely new and innovative solution for managing the local development environment that has been created from scratch.
Releases of <a href="https://github.com/oasp/">OASP</a> as well as releases of <a href="https://github.com/devonfw">devonfw</a> until version 3.1.x are based on the old <code>oasp4j-ide</code> that is now considered deprecated. As <code>devonfw-ide</code> is a complete redesign this will have some impact for the users. This section should help and assist so you do not get lost.</p>
</div>
</div>
<div class="sect3">
<h4 id="get-familiar-with-devonfw-ide"><a class="anchor" href="#get-familiar-with-devonfw-ide"></a>Get familiar with devonfw-ide</h4>
<div class="paragraph">
<p>First of all you should roughly get familiar with the new <code>devonfw-ide</code>. The key features and changes are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>platform-agnostic (supports Windows, Mac, and Linux in a single distribution)</p>
</li>
<li>
<p>small core (reduced the download package from ~2 gigabyte to ~2 megabyte)</p>
</li>
<li>
<p>fast and easy updates (built in update support)</p>
</li>
<li>
<p>minimum number of scripts (removed tons of end-user scripts making things much simpler)</p>
</li>
<li>
<p>fully automated setup (run <code>setup</code> script and you are ready - even for advanced features that had to be configured manually before)</p>
</li>
<li>
<p>single command for everything (entire CLI available via new <code>devon</code> command)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For all the details you should study the documentation starting from the <a href="Home">beginning</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="migration-of-existing-oasp4j-ide-installation"><a class="anchor" href="#migration-of-existing-oasp4j-ide-installation"></a>Migration of existing oasp4j-ide installation</h4>
<div class="ulist">
<ul>
<li>
<p>extract new <code><a href="scripts">devonfw-ide-scripts</a></code> on top of your existing installation</p>
</li>
<li>
<p>run <code>setup</code></p>
</li>
<li>
<p>done</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you get errors:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ask your technical lead to fix the <code><a href="settings">settings</a></code> git repo for <code>devonfw-ide</code> or offer him to do it for you.</p>
</li>
<li>
<p>you need to merge the <code><a href="https://github.com/devonfw/ide-settings/tree/master/devon">devon</a></code> folder into your settings</p>
</li>
<li>
<p>you need to merge the <code><a href="https://github.com/devonfw/ide-settings/blob/master/devon.properties">devon.properties</a></code> into your settings</p>
</li>
<li>
<p>you should check your <code>variables[-customized][.bat]</code> and merge required customizations into the proper <a href="configuration">configuration</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="hints-for-users-after-migration"><a class="anchor" href="#hints-for-users-after-migration"></a>Hints for users after migration</h4>
<div class="paragraph">
<p>Getting used to all the new commands might be tedious when starting after a migration.</p>
</div>
<div class="paragraph">
<div class="title">Comparison of commands</div>
<p>|== == == == == == == == == == == =
|<strong>oasp4j-ide command</strong>|<strong>devonfw-ide command</strong>|<strong>Comment</strong>
|<code>create-or-update-workspace</code>|<code>devon eclipse ws-update</code>
.4+|actually not needed anymore as workspace is updated automatically when IDE is launched. To launch your IDE simply run <code>devon eclipse</code>, <code>devon intellij</code>, or <code>devon vscode</code>. If you like to get launch scripts for your IDE e.g. Eclipse just call <code>devon eclipse --all create-script</code>.
|<code>create-or-update-workspace «workspace»</code>|<code>cd «workspace» &amp;&amp; devon eclipse ws-update</code>
|<code>update-all-workspaces</code>|<code>devon eclipse --all ws-update</code>
|<code>create-or-update-workspace-vs</code>|<code>devon vscode ws-update</code></p>
</div>
<div class="paragraph">
<p>|<code>devcon workspace create «workspace»</code>|Simply create the <code>«workspace»</code> directory (e.g. <code>cd workspaces &amp;&amp; mkdir examples</code>)|</p>
</div>
<div class="paragraph">
<p>|<code>scripts/update-eclipse-workspace-settings</code>|<code>devon eclipse ws-reverse</code>|To add new properties (old option <code>--new</code>) use <code>devon eclipse ws-reverse-add</code></p>
</div>
<div class="paragraph">
<p>|<code>devcon project build</code><br>
<code>devcon devon4j build</code><br>
<code>devcon devon4ng build</code>
|<code>devon build</code>|</p>
</div>
<div class="paragraph">
<p>|<code>devcon devon4j create</code>|<code>devon java create</code>|</p>
</div>
<div class="paragraph">
<p>|<code>devcon devon4ng create</code>|<code>devon ng create</code>|</p>
</div>
<div class="paragraph">
<p>|<code>devcon system *</code><br>
<code>devcon dist *</code>
|<code>setup</code> or <code>devon ide setup</code>|</p>
</div>
<div class="paragraph">
<p>|<code>console.bat</code>|-|Simply open terminal in selected folder. On Windows right-click folder in windows-explorer and select <code>open devonfw CMD here</code>.</p>
</div>
<div class="paragraph">
<p>|<code>devcon help</code>|<code>devon help</code>|</p>
</div>
<div class="paragraph">
<p>|<code>devcon doc</code>|Read the documentation from <a href="https://www.devonfw.com/">devonfw.com</a>|
|== == == == == == == == == == == =</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="license"><a class="anchor" href="#license"></a>License</h4>
<div class="paragraph">
<p>The product <code>devonfw-ide</code> is licensed under the following terms.</p>
</div>
<div class="paragraph">
<p>Binaries of this product have been made available to you by <a href="https://devonfw.com">devonfw</a> under the <a href="https://github.com/devonfw/ide/blob/master/LICENSE">Apache Public License 2.0</a>.</p>
</div>
<div class="paragraph">
<p>The documentation of this product is licensed under the terms of the <a href="http://creativecommons.org/licenses/by-nd/4.0/">Creative Commons License (Attribution-No Derivatives 4.0 International)</a>.</p>
</div>
<div class="paragraph">
<p>All of the source code to this product is available under licenses which are both free and open source.</p>
</div>
<div class="paragraph">
<p>More specifically, most of the source code is available under the Apache Public License 2.0. The remainder of the software which is not under the Apache license is available under one of a variety of other free and open source licenses. Those that require reproduction of the license text in the distribution are given below. (Note: your copy of this product may not contain code covered by one or more of the licenses listed here, depending on the exact product and version you choose.)</p>
</div>
<div class="paragraph">
<p>The following table shows the components that may be used. The column <code>inclusion</code> indicates the way the component is included:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>directly included</code> means the component is directly contained in the download package of <code>devonfw-ide</code> we provide</p>
</li>
<li>
<p><code>default setup</code> means the component is not initially included but will be downloaded during the <a href="setup"><code>setup</code></a> by default</p>
</li>
<li>
<p><code>optional</code> means the component is neither initially included nor downloaded by default, but only gets downloaded and installed if explicitly triggered by you when invoking additional commands or if explicitly configured by your project.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Third party components</div>
<p>|== == == == == == == == == == == =
|<strong>Component</strong>|<strong>Inclusion</strong>|<strong>License</strong>
|https://github.com/devonfw/ide[devonfw-ide] | Directly included |https://github.com/devonfw/ide/blob/master/LICENSE[ASL 2.0]
|https://github.com/eclipse-ee4j/jsonp[JSON-P] API | Directly included |https://github.com/eclipse-ee4j/jsonp/blob/master/LICENSE.md[EPL 2.0]
|https://github.com/eclipse-ee4j/jsonp[JSON-P] Implementation | Directly included |https://github.com/eclipse-ee4j/jsonp/blob/master/LICENSE.md[EPL 2.0]
|https://openjdk.java.net/[OpenJDK] / <a href="https://adoptopenjdk.net/">AdoptOpenJDK</a> (Java) |Default Setup| <a href="https://openjdk.java.net/legal/gplv2+ce.html">GPLv2</a>
|https://maven.apache.org/[Maven] | Default Setup|https://www.apache.org/licenses/LICENSE-2.0[ASL 2.0]
|https://code.visualstudio.com/[VS Code] |Optional| <a href="https://github.com/Microsoft/vscode/blob/master/LICENSE.txt">MIT</a> (<a href="https://code.visualstudio.com/License/">Terms</a>)
|https://github.com/devonfw/extension-pack-vscode[extension-pack-vscode] |Optional|https://github.com/devonfw/extension-pack-vscode/blob/master/LICENSE[ASL 2.0]
|https://www.eclipse.org/[Eclipse] |Optional|https://www.eclipse.org/legal/epl-2.0/[EPL 2.0]
|https://github.com/devonfw/cobigen[CobiGen] |Optional|https://github.com/devonfw/cobigen/blob/master/LICENSE.txt[ASL 2.0]
|https://marketplace.eclipse.org/content/tm-terminal[TM Terminal] |Optional|https://www.eclipse.org/legal/epl-2.0/[EPL 2.0] (see <a href="https://marketplace.eclipse.org/content/tm-terminal">here</a>)
|https://github.com/iloveeclipse/anyedittools/[AnyEdit] |Optional|https://github.com/iloveeclipse/anyedittools/blob/master/LICENSE.md[EPL 1.0]
|https://checkstyle.org/eclipse-cs/[EclipseCS] |Optional|https://github.com/checkstyle/eclipse-cs/blob/master/LICENSE[LGPL 2.1]
|https://marketplace.eclipse.org/content/spotbugs-eclipse-plugin[SpotBugs Eclipse plugin] |Optional|https://github.com/spotbugs/spotbugs/blob/master/LICENSE[LGPL 2.1]
|https://www.eclemma.org/[EclEmma] |Optional|https://www.eclemma.org/license.html[EPL 1.0]
|https://basti1302.github.io/startexplorer/[StartExplorer] |Optional|http://www.wtfpl.net/txt/copying/[WTFPL 2]
|http://myregexp.com/eclipsePlugin.html[regex tester] |Optional|http://www.gnu.org/licenses/gpl-2.0.html[GPL 2.0] (see <a href="https://sourceforge.net/projects/regex-util/">here</a>)
|https://github.com/m-m-m/eclipse-templatevariables/[eclipse-templatevariables] |Optional|https://github.com/m-m-m/eclipse-templatevariables/blob/master/LICENSE.txt[ASL 2.0]
|https://nodejs.org/[Node.js] |Default Setup|https://raw.githubusercontent.com/nodejs/node/master/LICENSE[License]
|https://www.npmjs.com/[NPM] |Default Setup|https://github.com/npm/cli/blob/latest/LICENSE[Artistic License 2.0] (<a href="https://www.npmjs.com/policies/terms">Terms</a>)
|https://cli.angular.io/[Angular CLI] (ng) |Optional|https://cli.angular.io/license.html[MIT]
|http://groovy-lang.org/[Groovy]|Optional|https://github.com/apache/groovy/blob/master/LICENSE[ASL 2.0]
|https://ant.apache.org/[Apache Ant]|Optional|https://github.com/apache/ant/blob/master/LICENSE[ASL 2.0]
|https://gradle.org/[Gradle] |Optional|https://github.com/gradle/gradle/blob/master/LICENSE[ASL 2.0]
|https://jenkins.io/[Jenkins] |Optional|https://github.com/jenkinsci/jenkins/blob/master/LICENSE.txt[MIT]
|https://www.sonarsource.com/plans-and-pricing/community/[SonarQube (Community Edition)] |Optional|https://github.com/SonarSource/sonarqube/blob/master/LICENSE.txt[LGPL 3.0]
|https://www.sonarlint.org/eclipse/[SonarLint] |Optional|https://github.com/SonarSource/sonarlint-eclipse/blob/master/LICENSE.txt[LGPL 3+]
|https://github.com/devonfw/cicdgen[cicdgen] |Optional|https://github.com/devonfw/cicdgen/blob/develop/LICENSE.txt[ASL 2.0]
|https://github.com/devonfw/devon4j[devon4j] |Optional|https://github.com/devonfw/devon4j/blob/develop/LICENSE[ASL 2.0]
|https://github.com/devonfw/devon4ng[devon4ng] |Optional|https://github.com/devonfw/devon4ng/blob/master/LICENSE.txt[ASL 2.0]
|https://github.com/devonfw/devon4node[devon4node] |Optional|https://github.com/devonfw/devon4node/blob/develop/LICENSE.txt[ASL 2.0]
|https://www.jetbrains.com/idea/[IntelliJ IDEA] |Optional|https://www.jetbrains.com/opensource/idea/[ASL 2.0]
|http://www.jasypt.org/[jasypt] |Optional|http://www.jasypt.org/license.html[ASL 2.0]
|https://www.docker.com/[docker]|Optional|https://docs.docker.com/engine/#licensing[ASL 2.0] and <a href="https://www.docker.com/legal/docker-software-end-user-license-agreement">EULA</a>
|https://kubernetes.io/[kubernetes]|Optional|https://github.com/kubernetes/kubernetes/blob/master/LICENSE[ASL 2.0]
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect3">
<h4 id="apache-software-license-version-2-0"><a class="anchor" href="#apache-software-license-version-2-0"></a>Apache Software License - Version 2.0</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>                                 Apache License
                           Version 2.0, January 2004
                        http://www.apache.org/licenses/

   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION

   1. Definitions.

      "License" shall mean the terms and conditions for use, reproduction,
      and distribution as defined by Sections 1 through 9 of this document.

      "Licensor" shall mean the copyright owner or entity authorized by
      the copyright owner that is granting the License.

      "Legal Entity" shall mean the union of the acting entity and all
      other entities that control, are controlled by, or are under common
      control with that entity. For the purposes of this definition,
      "control" means (i) the power, direct or indirect, to cause the
      direction or management of such entity, whether by contract or
      otherwise, or (ii) ownership of fifty percent (50%) or more of the
      outstanding shares, or (iii) beneficial ownership of such entity.

      "You" (or "Your") shall mean an individual or Legal Entity
      exercising permissions granted by this License.

      "Source" form shall mean the preferred form for making modifications,
      including but not limited to software source code, documentation
      source, and configuration files.

      "Object" form shall mean any form resulting from mechanical
      transformation or translation of a Source form, including but
      not limited to compiled object code, generated documentation,
      and conversions to other media types.

      "Work" shall mean the work of authorship, whether in Source or
      Object form, made available under the License, as indicated by a
      copyright notice that is included in or attached to the work
      (an example is provided in the Appendix below).

      "Derivative Works" shall mean any work, whether in Source or Object
      form, that is based on (or derived from) the Work and for which the
      editorial revisions, annotations, elaborations, or other modifications
      represent, as a whole, an original work of authorship. For the purposes
      of this License, Derivative Works shall not include works that remain
      separable from, or merely link (or bind by name) to the interfaces of,
      the Work and Derivative Works thereof.

      "Contribution" shall mean any work of authorship, including
      the original version of the Work and any modifications or additions
      to that Work or Derivative Works thereof, that is intentionally
      submitted to Licensor for inclusion in the Work by the copyright owner
      or by an individual or Legal Entity authorized to submit on behalf of
      the copyright owner. For the purposes of this definition, "submitted"
      means any form of electronic, verbal, or written communication sent
      to the Licensor or its representatives, including but not limited to
      communication on electronic mailing lists, source code control systems,
      and issue tracking systems that are managed by, or on behalf of, the
      Licensor for the purpose of discussing and improving the Work, but
      excluding communication that is conspicuously marked or otherwise
      designated in writing by the copyright owner as "Not a Contribution."

      "Contributor" shall mean Licensor and any individual or Legal Entity
      on behalf of whom a Contribution has been received by Licensor and
      subsequently incorporated within the Work.

   2. Grant of Copyright License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      copyright license to reproduce, prepare Derivative Works of,
      publicly display, publicly perform, sublicense, and distribute the
      Work and such Derivative Works in Source or Object form.

   3. Grant of Patent License. Subject to the terms and conditions of
      this License, each Contributor hereby grants to You a perpetual,
      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
      (except as stated in this section) patent license to make, have made,
      use, offer to sell, sell, import, and otherwise transfer the Work,
      where such license applies only to those patent claims licensable
      by such Contributor that are necessarily infringed by their
      Contribution(s) alone or by combination of their Contribution(s)
      with the Work to which such Contribution(s) was submitted. If You
      institute patent litigation against any entity (including a
      cross-claim or counterclaim in a lawsuit) alleging that the Work
      or a Contribution incorporated within the Work constitutes direct
      or contributory patent infringement, then any patent licenses
      granted to You under this License for that Work shall terminate
      as of the date such litigation is filed.

   4. Redistribution. You may reproduce and distribute copies of the
      Work or Derivative Works thereof in any medium, with or without
      modifications, and in Source or Object form, provided that You
      meet the following conditions:

      (a) You must give any other recipients of the Work or
          Derivative Works a copy of this License; and

      (b) You must cause any modified files to carry prominent notices
          stating that You changed the files; and

      (c) You must retain, in the Source form of any Derivative Works
          that You distribute, all copyright, patent, trademark, and
          attribution notices from the Source form of the Work,
          excluding those notices that do not pertain to any part of
          the Derivative Works; and

      (d) If the Work includes a "NOTICE" text file as part of its
          distribution, then any Derivative Works that You distribute must
          include a readable copy of the attribution notices contained
          within such NOTICE file, excluding those notices that do not
          pertain to any part of the Derivative Works, in at least one
          of the following places: within a NOTICE text file distributed
          as part of the Derivative Works; within the Source form or
          documentation, if provided along with the Derivative Works; or,
          within a display generated by the Derivative Works, if and
          wherever such third-party notices normally appear. The contents
          of the NOTICE file are for informational purposes only and
          do not modify the License. You may add Your own attribution
          notices within Derivative Works that You distribute, alongside
          or as an addendum to the NOTICE text from the Work, provided
          that such additional attribution notices cannot be construed
          as modifying the License.

      You may add Your own copyright statement to Your modifications and
      may provide additional or different license terms and conditions
      for use, reproduction, or distribution of Your modifications, or
      for any such Derivative Works as a whole, provided Your use,
      reproduction, and distribution of the Work otherwise complies with
      the conditions stated in this License.

   5. Submission of Contributions. Unless You explicitly state otherwise,
      any Contribution intentionally submitted for inclusion in the Work
      by You to the Licensor shall be under the terms and conditions of
      this License, without any additional terms or conditions.
      Notwithstanding the above, nothing herein shall supersede or modify
      the terms of any separate license agreement you may have executed
      with Licensor regarding such Contributions.

   6. Trademarks. This License does not grant permission to use the trade
      names, trademarks, service marks, or product names of the Licensor,
      except as required for reasonable and customary use in describing the
      origin of the Work and reproducing the content of the NOTICE file.

   7. Disclaimer of Warranty. Unless required by applicable law or
      agreed to in writing, Licensor provides the Work (and each
      Contributor provides its Contributions) on an "AS IS" BASIS,
      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
      implied, including, without limitation, any warranties or conditions
      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
      PARTICULAR PURPOSE. You are solely responsible for determining the
      appropriateness of using or redistributing the Work and assume any
      risks associated with Your exercise of permissions under this License.

   8. Limitation of Liability. In no event and under no legal theory,
      whether in tort (including negligence), contract, or otherwise,
      unless required by applicable law (such as deliberate and grossly
      negligent acts) or agreed to in writing, shall any Contributor be
      liable to You for damages, including any direct, indirect, special,
      incidental, or consequential damages of any character arising as a
      result of this License or out of the use or inability to use the
      Work (including but not limited to damages for loss of goodwill,
      work stoppage, computer failure or malfunction, or any and all
      other commercial damages or losses), even if such Contributor
      has been advised of the possibility of such damages.

   9. Accepting Warranty or Additional Liability. While redistributing
      the Work or Derivative Works thereof, You may choose to offer,
      and charge a fee for, acceptance of support, warranty, indemnity,
      or other liability obligations and/or rights consistent with this
      License. However, in accepting such obligations, You may act only
      on Your own behalf and on Your sole responsibility, not on behalf
      of any other Contributor, and only if You agree to indemnify,
      defend, and hold each Contributor harmless for any liability
      incurred by, or claims asserted against, such Contributor by reason
      of your accepting any such warranty or additional liability.

   END OF TERMS AND CONDITIONS

   APPENDIX: How to apply the Apache License to your work.

      To apply the Apache License to your work, attach the following
      boilerplate notice, with the fields enclosed by brackets "[]"
      replaced with your own identifying information. (Don't include
      the brackets!)  The text should be enclosed in the appropriate
      comment syntax for the file format. We also recommend that a
      file or class name and description of purpose be included on the
      same "printed page" as the copyright notice for easier
      identification within third-party archives.

   Copyright [yyyy] [name of copyright owner]

   Licensed under the Apache License, Version 2.0 (the "License");
   you may not use this file except in compliance with the License.
   You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE-2.0

   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="eclipse-public-license-version-1-0"><a class="anchor" href="#eclipse-public-license-version-1-0"></a>Eclipse Public License - Version 1.0</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>THE ACCOMPANYING PROGRAM IS PROVIDED UNDER THE TERMS OF THIS ECLIPSE PUBLIC LICENSE ("AGREEMENT"). ANY USE, REPRODUCTION OR DISTRIBUTION OF THE PROGRAM CONSTITUTES RECIPIENT'S ACCEPTANCE OF THIS AGREEMENT.

1. DEFINITIONS

"Contribution" means:

a) in the case of the initial Contributor, the initial code and documentation distributed under this Agreement, and

b) in the case of each subsequent Contributor:

i) changes to the Program, and

ii) additions to the Program;

where such changes and/or additions to the Program originate from and are distributed by that particular Contributor. A Contribution 'originates' from a Contributor if it was added to the Program by such Contributor itself or anyone acting on such Contributor's behalf. Contributions do not include additions to the Program which: (i) are separate modules of software distributed in conjunction with the Program under their own license agreement, and (ii) are not derivative works of the Program.

"Contributor" means any person or entity that distributes the Program.

"Licensed Patents" mean patent claims licensable by a Contributor which are necessarily infringed by the use or sale of its Contribution alone or when combined with the Program.

"Program" means the Contributions distributed in accordance with this Agreement.

"Recipient" means anyone who receives the Program under this Agreement, including all Contributors.

2. GRANT OF RIGHTS

a) Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, distribute and sublicense the Contribution of such Contributor, if any, and such derivative works, in source code and object code form.

b) Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free patent license under Licensed Patents to make, use, sell, offer to sell, import and otherwise transfer the Contribution of such Contributor, if any, in source code and object code form. This patent license shall apply to the combination of the Contribution and the Program if, at the time the Contribution is added by the Contributor, such addition of the Contribution causes such combination to be covered by the Licensed Patents. The patent license shall not apply to any other combinations which include the Contribution. No hardware per se is licensed hereunder.

c) Recipient understands that although each Contributor grants the licenses to its Contributions set forth herein, no assurances are provided by any Contributor that the Program does not infringe the patent or other intellectual property rights of any other entity. Each Contributor disclaims any liability to Recipient for claims brought by any other entity based on infringement of intellectual property rights or otherwise. As a condition to exercising the rights and licenses granted hereunder, each Recipient hereby assumes sole responsibility to secure any other intellectual property rights needed, if any. For example, if a third party patent license is required to allow Recipient to distribute the Program, it is Recipient's responsibility to acquire that license before distributing the Program.

d) Each Contributor represents that to its knowledge it has sufficient copyright rights in its Contribution, if any, to grant the copyright license set forth in this Agreement.

3. REQUIREMENTS

A Contributor may choose to distribute the Program in object code form under its own license agreement, provided that:

a) it complies with the terms and conditions of this Agreement; and

b) its license agreement:

i) effectively disclaims on behalf of all Contributors all warranties and conditions, express and implied, including warranties or conditions of title and non-infringement, and implied warranties or conditions of merchantability and fitness for a particular purpose;

ii) effectively excludes on behalf of all Contributors all liability for damages, including direct, indirect, special, incidental and consequential damages, such as lost profits;

iii) states that any provisions which differ from this Agreement are offered by that Contributor alone and not by any other party; and

iv) states that source code for the Program is available from such Contributor, and informs licensees how to obtain it in a reasonable manner on or through a medium customarily used for software exchange.

When the Program is made available in source code form:

a) it must be made available under this Agreement; and

b) a copy of this Agreement must be included with each copy of the Program.

Contributors may not remove or alter any copyright notices contained within the Program.

Each Contributor must identify itself as the originator of its Contribution, if any, in a manner that reasonably allows subsequent Recipients to identify the originator of the Contribution.

4. COMMERCIAL DISTRIBUTION

Commercial distributors of software may accept certain responsibilities with respect to end users, business partners and the like. While this license is intended to facilitate the commercial use of the Program, the Contributor who includes the Program in a commercial product offering should do so in a manner which does not create potential liability for other Contributors. Therefore, if a Contributor includes the Program in a commercial product offering, such Contributor ("Commercial Contributor") hereby agrees to defend and indemnify every other Contributor ("Indemnified Contributor") against any losses, damages and costs (collectively "Losses") arising from claims, lawsuits and other legal actions brought by a third party against the Indemnified Contributor to the extent caused by the acts or omissions of such Commercial Contributor in connection with its distribution of the Program in a commercial product offering. The obligations in this section do not apply to any claims or Losses relating to any actual or alleged intellectual property infringement. In order to qualify, an Indemnified Contributor must: a) promptly notify the Commercial Contributor in writing of such claim, and b) allow the Commercial Contributor to control, and cooperate with the Commercial Contributor in, the defense and any related settlement negotiations. The Indemnified Contributor may participate in any such claim at its own expense.

For example, a Contributor might include the Program in a commercial product offering, Product X. That Contributor is then a Commercial Contributor. If that Commercial Contributor then makes performance claims, or offers warranties related to Product X, those performance claims and warranties are such Commercial Contributor's responsibility alone. Under this section, the Commercial Contributor would have to defend claims against the other Contributors related to those performance claims and warranties, and if a court requires any other Contributor to pay any damages as a result, the Commercial Contributor must pay those damages.

5. NO WARRANTY

EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, THE PROGRAM IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED INCLUDING, WITHOUT LIMITATION, ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. Each Recipient is solely responsible for determining the appropriateness of using and distributing the Program and assumes all risks associated with its exercise of rights under this Agreement , including but not limited to the risks and costs of program errors, compliance with applicable laws, damage to or loss of data, programs or equipment, and unavailability or interruption of operations.

6. DISCLAIMER OF LIABILITY

EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, NEITHER RECIPIENT NOR ANY CONTRIBUTORS SHALL HAVE ANY LIABILITY FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING WITHOUT LIMITATION LOST PROFITS), HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OR DISTRIBUTION OF THE PROGRAM OR THE EXERCISE OF ANY RIGHTS GRANTED HEREUNDER, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

7. GENERAL

If any provision of this Agreement is invalid or unenforceable under applicable law, it shall not affect the validity or enforceability of the remainder of the terms of this Agreement, and without further action by the parties hereto, such provision shall be reformed to the minimum extent necessary to make such provision valid and enforceable.

If Recipient institutes patent litigation against any entity (including a cross-claim or counterclaim in a lawsuit) alleging that the Program itself (excluding combinations of the Program with other software or hardware) infringes such Recipient's patent(s), then such Recipient's rights granted under Section 2(b) shall terminate as of the date such litigation is filed.

All Recipient's rights under this Agreement shall terminate if it fails to comply with any of the material terms or conditions of this Agreement and does not cure such failure in a reasonable period of time after becoming aware of such noncompliance. If all Recipient's rights under this Agreement terminate, Recipient agrees to cease use and distribution of the Program as soon as reasonably practicable. However, Recipient's obligations under this Agreement and any licenses granted by Recipient relating to the Program shall continue and survive.

Everyone is permitted to copy and distribute copies of this Agreement, but in order to avoid inconsistency the Agreement is copyrighted and may only be modified in the following manner. The Agreement Steward reserves the right to publish new versions (including revisions) of this Agreement from time to time. No one other than the Agreement Steward has the right to modify this Agreement. The Eclipse Foundation is the initial Agreement Steward. The Eclipse Foundation may assign the responsibility to serve as the Agreement Steward to a suitable separate entity. Each new version of the Agreement will be given a distinguishing version number. The Program (including Contributions) may always be distributed subject to the version of the Agreement under which it was received. In addition, after a new version of the Agreement is published, Contributor may elect to distribute the Program (including its Contributions) under the new version. Except as expressly stated in Sections 2(a) and 2(b) above, Recipient receives no rights or licenses to the intellectual property of any Contributor under this Agreement, whether expressly, by implication, estoppel or otherwise. All rights in the Program not expressly granted under this Agreement are reserved.

This Agreement is governed by the laws of the State of New York and the intellectual property laws of the United States of America. No party to this Agreement will bring a legal action under this Agreement more than one year after the cause of action arose. Each party waives its rights to a jury trial in any resulting litigation.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="eclipse-public-license-version-2-0"><a class="anchor" href="#eclipse-public-license-version-2-0"></a>Eclipse Public License - Version 2.0</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>THE ACCOMPANYING PROGRAM IS PROVIDED UNDER THE TERMS OF THIS ECLIPSE PUBLIC LICENSE (“AGREEMENT”). ANY USE, REPRODUCTION OR DISTRIBUTION OF THE PROGRAM CONSTITUTES RECIPIENT'S ACCEPTANCE OF THIS AGREEMENT.
1. DEFINITIONS

“Contribution” means:

    a) in the case of the initial Contributor, the initial content Distributed under this Agreement, and
    b) in the case of each subsequent Contributor:
        i) changes to the Program, and
        ii) additions to the Program;
    where such changes and/or additions to the Program originate from and are Distributed by that particular Contributor. A Contribution “originates” from a Contributor if it was added to the Program by such Contributor itself or anyone acting on such Contributor's behalf. Contributions do not include changes or additions to the Program that are not Modified Works.

“Contributor” means any person or entity that Distributes the Program.

“Licensed Patents” mean patent claims licensable by a Contributor which are necessarily infringed by the use or sale of its Contribution alone or when combined with the Program.

“Program” means the Contributions Distributed in accordance with this Agreement.

“Recipient” means anyone who receives the Program under this Agreement or any Secondary License (as applicable), including Contributors.

“Derivative Works” shall mean any work, whether in Source Code or other form, that is based on (or derived from) the Program and for which the editorial revisions, annotations, elaborations, or other modifications represent, as a whole, an original work of authorship.

“Modified Works” shall mean any work in Source Code or other form that results from an addition to, deletion from, or modification of the contents of the Program, including, for purposes of clarity any new file in Source Code form that contains any contents of the Program. Modified Works shall not include works that contain only declarations, interfaces, types, classes, structures, or files of the Program solely in each case in order to link to, bind by name, or subclass the Program or Modified Works thereof.

“Distribute” means the acts of a) distributing or b) making available in any manner that enables the transfer of a copy.

“Source Code” means the form of a Program preferred for making modifications, including but not limited to software source code, documentation source, and configuration files.

“Secondary License” means either the GNU General Public License, Version 2.0, or any later versions of that license, including any exceptions or additional permissions as identified by the initial Contributor.
2. GRANT OF RIGHTS

    a) Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free copyright license to reproduce, prepare Derivative Works of, publicly display, publicly perform, Distribute and sublicense the Contribution of such Contributor, if any, and such Derivative Works.
    b) Subject to the terms of this Agreement, each Contributor hereby grants Recipient a non-exclusive, worldwide, royalty-free patent license under Licensed Patents to make, use, sell, offer to sell, import and otherwise transfer the Contribution of such Contributor, if any, in Source Code or other form. This patent license shall apply to the combination of the Contribution and the Program if, at the time the Contribution is added by the Contributor, such addition of the Contribution causes such combination to be covered by the Licensed Patents. The patent license shall not apply to any other combinations which include the Contribution. No hardware per se is licensed hereunder.
    c) Recipient understands that although each Contributor grants the licenses to its Contributions set forth herein, no assurances are provided by any Contributor that the Program does not infringe the patent or other intellectual property rights of any other entity. Each Contributor disclaims any liability to Recipient for claims brought by any other entity based on infringement of intellectual property rights or otherwise. As a condition to exercising the rights and licenses granted hereunder, each Recipient hereby assumes sole responsibility to secure any other intellectual property rights needed, if any. For example, if a third party patent license is required to allow Recipient to Distribute the Program, it is Recipient's responsibility to acquire that license before distributing the Program.
    d) Each Contributor represents that to its knowledge it has sufficient copyright rights in its Contribution, if any, to grant the copyright license set forth in this Agreement.
    e) Notwithstanding the terms of any Secondary License, no Contributor makes additional grants to any Recipient (other than those set forth in this Agreement) as a result of such Recipient's receipt of the Program under the terms of a Secondary License (if permitted under the terms of Section 3).

3. REQUIREMENTS

3.1 If a Contributor Distributes the Program in any form, then:

    a) the Program must also be made available as Source Code, in accordance with section 3.2, and the Contributor must accompany the Program with a statement that the Source Code for the Program is available under this Agreement, and informs Recipients how to obtain it in a reasonable manner on or through a medium customarily used for software exchange; and
    b) the Contributor may Distribute the Program under a license different than this Agreement, provided that such license:
        i) effectively disclaims on behalf of all other Contributors all warranties and conditions, express and implied, including warranties or conditions of title and non-infringement, and implied warranties or conditions of merchantability and fitness for a particular purpose;
        ii) effectively excludes on behalf of all other Contributors all liability for damages, including direct, indirect, special, incidental and consequential damages, such as lost profits;
        iii) does not attempt to limit or alter the recipients' rights in the Source Code under section 3.2; and
        iv) requires any subsequent distribution of the Program by any party to be under a license that satisfies the requirements of this section 3.

3.2 When the Program is Distributed as Source Code:

    a) it must be made available under this Agreement, or if the Program (i) is combined with other material in a separate file or files made available under a Secondary License, and (ii) the initial Contributor attached to the Source Code the notice described in Exhibit A of this Agreement, then the Program may be made available under the terms of such Secondary Licenses, and
    b) a copy of this Agreement must be included with each copy of the Program.

3.3 Contributors may not remove or alter any copyright, patent, trademark, attribution notices, disclaimers of warranty, or limitations of liability (‘notices’) contained within the Program from any copy of the Program which they Distribute, provided that Contributors may add their own appropriate notices.
4. COMMERCIAL DISTRIBUTION

Commercial distributors of software may accept certain responsibilities with respect to end users, business partners and the like. While this license is intended to facilitate the commercial use of the Program, the Contributor who includes the Program in a commercial product offering should do so in a manner which does not create potential liability for other Contributors. Therefore, if a Contributor includes the Program in a commercial product offering, such Contributor (“Commercial Contributor”) hereby agrees to defend and indemnify every other Contributor (“Indemnified Contributor”) against any losses, damages and costs (collectively “Losses”) arising from claims, lawsuits and other legal actions brought by a third party against the Indemnified Contributor to the extent caused by the acts or omissions of such Commercial Contributor in connection with its distribution of the Program in a commercial product offering. The obligations in this section do not apply to any claims or Losses relating to any actual or alleged intellectual property infringement. In order to qualify, an Indemnified Contributor must: a) promptly notify the Commercial Contributor in writing of such claim, and b) allow the Commercial Contributor to control, and cooperate with the Commercial Contributor in, the defense and any related settlement negotiations. The Indemnified Contributor may participate in any such claim at its own expense.

For example, a Contributor might include the Program in a commercial product offering, Product X. That Contributor is then a Commercial Contributor. If that Commercial Contributor then makes performance claims, or offers warranties related to Product X, those performance claims and warranties are such Commercial Contributor's responsibility alone. Under this section, the Commercial Contributor would have to defend claims against the other Contributors related to those performance claims and warranties, and if a court requires any other Contributor to pay any damages as a result, the Commercial Contributor must pay those damages.
5. NO WARRANTY

EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, AND TO THE EXTENT PERMITTED BY APPLICABLE LAW, THE PROGRAM IS PROVIDED ON AN “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, EITHER EXPRESS OR IMPLIED INCLUDING, WITHOUT LIMITATION, ANY WARRANTIES OR CONDITIONS OF TITLE, NON-INFRINGEMENT, MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. Each Recipient is solely responsible for determining the appropriateness of using and distributing the Program and assumes all risks associated with its exercise of rights under this Agreement, including but not limited to the risks and costs of program errors, compliance with applicable laws, damage to or loss of data, programs or equipment, and unavailability or interruption of operations.
6. DISCLAIMER OF LIABILITY

EXCEPT AS EXPRESSLY SET FORTH IN THIS AGREEMENT, AND TO THE EXTENT PERMITTED BY APPLICABLE LAW, NEITHER RECIPIENT NOR ANY CONTRIBUTORS SHALL HAVE ANY LIABILITY FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING WITHOUT LIMITATION LOST PROFITS), HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OR DISTRIBUTION OF THE PROGRAM OR THE EXERCISE OF ANY RIGHTS GRANTED HEREUNDER, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
7. GENERAL

If any provision of this Agreement is invalid or unenforceable under applicable law, it shall not affect the validity or enforceability of the remainder of the terms of this Agreement, and without further action by the parties hereto, such provision shall be reformed to the minimum extent necessary to make such provision valid and enforceable.

If Recipient institutes patent litigation against any entity (including a cross-claim or counterclaim in a lawsuit) alleging that the Program itself (excluding combinations of the Program with other software or hardware) infringes such Recipient's patent(s), then such Recipient's rights granted under Section 2(b) shall terminate as of the date such litigation is filed.

All Recipient's rights under this Agreement shall terminate if it fails to comply with any of the material terms or conditions of this Agreement and does not cure such failure in a reasonable period of time after becoming aware of such noncompliance. If all Recipient's rights under this Agreement terminate, Recipient agrees to cease use and distribution of the Program as soon as reasonably practicable. However, Recipient's obligations under this Agreement and any licenses granted by Recipient relating to the Program shall continue and survive.

Everyone is permitted to copy and distribute copies of this Agreement, but in order to avoid inconsistency the Agreement is copyrighted and may only be modified in the following manner. The Agreement Steward reserves the right to publish new versions (including revisions) of this Agreement from time to time. No one other than the Agreement Steward has the right to modify this Agreement. The Eclipse Foundation is the initial Agreement Steward. The Eclipse Foundation may assign the responsibility to serve as the Agreement Steward to a suitable separate entity. Each new version of the Agreement will be given a distinguishing version number. The Program (including Contributions) may always be Distributed subject to the version of the Agreement under which it was received. In addition, after a new version of the Agreement is published, Contributor may elect to Distribute the Program (including its Contributions) under the new version.

Except as expressly stated in Sections 2(a) and 2(b) above, Recipient receives no rights or licenses to the intellectual property of any Contributor under this Agreement, whether expressly, by implication, estoppel or otherwise. All rights in the Program not expressly granted under this Agreement are reserved. Nothing in this Agreement is intended to be enforceable by any entity that is not a Contributor or Recipient. No third-party beneficiary rights are created under this Agreement.
Exhibit A – Form of Secondary Licenses Notice

“This Source Code may also be made available under the following Secondary Licenses when the conditions for such availability set forth in the Eclipse Public License, v. 2.0 are satisfied: {name license(s), version(s), and exceptions or additional permissions here}.”

    Simply including a copy of this Agreement, including this Exhibit A is not sufficient to license the Source Code under Secondary Licenses.

    If it is not possible or desirable to put the notice in a particular file, then You may include the notice in a location (such as a LICENSE file in a relevant directory) where a recipient would be likely to look for such a notice.

    You may add additional accurate notices of copyright ownership.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="mit-license"><a class="anchor" href="#mit-license"></a>MIT License</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Copyright &lt;YEAR&gt; &lt;COPYRIGHT HOLDER&gt;

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="artistic-license-version-2-0"><a class="anchor" href="#artistic-license-version-2-0"></a>Artistic License - Version 2.0</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Copyright (c) 2000-2006, The Perl Foundation.

Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed.
Preamble

This license establishes the terms under which a given free software Package may be copied, modified, distributed, and/or redistributed. The intent is that the Copyright Holder maintains some artistic control over the development of that Package while still keeping the Package available as open source and free software.

You are always permitted to make arrangements wholly outside of this license directly with the Copyright Holder of a given Package. If the terms of this license do not permit the full use that you propose to make of the Package, you should contact the Copyright Holder and seek a different licensing arrangement.
Definitions

"Copyright Holder" means the individual(s) or organization(s) named in the copyright notice for the entire Package.

"Contributor" means any party that has contributed code or other material to the Package, in accordance with the Copyright Holder's procedures.

"You" and "your" means any person who would like to copy, distribute, or modify the Package.

"Package" means the collection of files distributed by the Copyright Holder, and derivatives of that collection and/or of those files. A given Package may consist of either the Standard Version, or a Modified Version.

"Distribute" means providing a copy of the Package or making it accessible to anyone else, or in the case of a company or organization, to others outside of your company or organization.

"Distributor Fee" means any fee that you charge for Distributing this Package or providing support for this Package to another party. It does not mean licensing fees.

"Standard Version" refers to the Package if it has not been modified, or has been modified only in ways explicitly requested by the Copyright Holder.

"Modified Version" means the Package, if it has been changed, and such changes were not explicitly requested by the Copyright Holder.

"Original License" means this Artistic License as Distributed with the Standard Version of the Package, in its current version or as it may be modified by The Perl Foundation in the future.

"Source" form means the source code, documentation source, and configuration files for the Package.

"Compiled" form means the compiled bytecode, object code, binary, or any other form resulting from mechanical transformation or translation of the Source form.
Permission for Use and Modification Without Distribution

(1) You are permitted to use the Standard Version and create and use Modified Versions for any purpose without restriction, provided that you do not Distribute the Modified Version.
Permissions for Redistribution of the Standard Version

(2) You may Distribute verbatim copies of the Source form of the Standard Version of this Package in any medium without restriction, either gratis or for a Distributor Fee, provided that you duplicate all of the original copyright notices and associated disclaimers. At your discretion, such verbatim copies may or may not include a Compiled form of the Package.

(3) You may apply any bug fixes, portability changes, and other modifications made available from the Copyright Holder. The resulting Package will still be considered the Standard Version, and as such will be subject to the Original License.
Distribution of Modified Versions of the Package as Source

(4) You may Distribute your Modified Version as Source (either gratis or for a Distributor Fee, and with or without a Compiled form of the Modified Version) provided that you clearly document how it differs from the Standard Version, including, but not limited to, documenting any non-standard features, executables, or modules, and provided that you do at least ONE of the following:

(a) make the Modified Version available to the Copyright Holder of the Standard Version, under the Original License, so that the Copyright Holder may include your modifications in the Standard Version.
(b) ensure that installation of your Modified Version does not prevent the user installing or running the Standard Version. In addition, the Modified Version must bear a name that is different from the name of the Standard Version.
(c) allow anyone who receives a copy of the Modified Version to make the Source form of the Modified Version available to others under
(i) the Original License or
(ii) a license that permits the licensee to freely copy, modify and redistribute the Modified Version using the same licensing terms that apply to the copy that the licensee received, and requires that the Source form of the Modified Version, and of any works derived from it, be made freely available in that license fees are prohibited but Distributor Fees are allowed.
Distribution of Compiled Forms of the Standard Version or Modified Versions without the Source

(5) You may Distribute Compiled forms of the Standard Version without the Source, provided that you include complete instructions on how to get the Source of the Standard Version. Such instructions must be valid at the time of your distribution. If these instructions, at any time while you are carrying out such distribution, become invalid, you must provide new instructions on demand or cease further distribution. If you provide valid instructions or cease distribution within thirty days after you become aware that the instructions are invalid, then you do not forfeit any of your rights under this license.

(6) You may Distribute a Modified Version in Compiled form without the Source, provided that you comply with Section 4 with respect to the Source of the Modified Version.
Aggregating or Linking the Package

(7) You may aggregate the Package (either the Standard Version or Modified Version) with other packages and Distribute the resulting aggregation provided that you do not charge a licensing fee for the Package. Distributor Fees are permitted, and licensing fees for other components in the aggregation are permitted. The terms of this license apply to the use and Distribution of the Standard or Modified Versions as included in the aggregation.

(8) You are permitted to link Modified and Standard Versions with other works, to embed the Package in a larger work of your own, or to build stand-alone binary or bytecode versions of applications that include the Package, and Distribute the result without restriction, provided the result does not expose a direct interface to the Package.
Items That are Not Considered Part of a Modified Version

(9) Works (including, but not limited to, modules and scripts) that merely extend or make use of the Package, do not, by themselves, cause the Package to be a Modified Version. In addition, such works are not considered parts of the Package itself, and are not subject to the terms of this license.
General Provisions

(10) Any use, modification, and distribution of the Standard or Modified Versions is governed by this Artistic License. By using, modifying or distributing the Package, you accept this license. Do not use, modify, or distribute the Package, if you do not accept this license.

(11) If your Modified Version has been derived from a Modified Version made by someone other than you, you are nevertheless required to ensure that your Modified Version complies with the requirements of this license.

(12) This license does not grant you the right to use any trademark, service mark, tradename, or logo of the Copyright Holder.

(13) This license includes the non-exclusive, worldwide, free-of-charge patent license to make, have made, use, offer to sell, sell, import and otherwise transfer the Package with respect to any patent claims licensable by the Copyright Holder that are necessarily infringed by the Package. If you institute patent litigation (including a cross-claim or counterclaim) against any party alleging that the Package constitutes direct or contributory patent infringement, then this Artistic License to you shall terminate on the date that such litigation is filed.

(14) Disclaimer of Warranty: THE PACKAGE IS PROVIDED BY THE COPYRIGHT HOLDER AND CONTRIBUTORS "AS IS' AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES. THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR NON-INFRINGEMENT ARE DISCLAIMED TO THE EXTENT PERMITTED BY YOUR LOCAL LAW. UNLESS REQUIRED BY LAW, NO COPYRIGHT HOLDER OR CONTRIBUTOR WILL BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL DAMAGES ARISING IN ANY WAY OUT OF THE USE OF THE PACKAGE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="creative-commons-license-attribution-noderivatives-4-0-international"><a class="anchor" href="#creative-commons-license-attribution-noderivatives-4-0-international"></a>Creative Commons License - Attribution-NoDerivatives 4.0 International</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>By exercising the Licensed Rights (defined below), You accept and agree to be bound by the terms and conditions of this Creative Commons Attribution-NoDerivatives 4.0 International Public License ("Public License"). To the extent this Public License may be interpreted as a contract, You are granted the Licensed Rights in consideration of Your acceptance of these terms and conditions, and the Licensor grants You such rights in consideration of benefits the Licensor receives from making the Licensed Material available under these terms and conditions.

Section 1 – Definitions.

    Adapted Material means material subject to Copyright and Similar Rights that is derived from or based upon the Licensed Material and in which the Licensed Material is translated, altered, arranged, transformed, or otherwise modified in a manner requiring permission under the Copyright and Similar Rights held by the Licensor. For purposes of this Public License, where the Licensed Material is a musical work, performance, or sound recording, Adapted Material is always produced where the Licensed Material is synched in timed relation with a moving image.
    Copyright and Similar Rights means copyright and/or similar rights closely related to copyright including, without limitation, performance, broadcast, sound recording, and Sui Generis Database Rights, without regard to how the rights are labeled or categorized. For purposes of this Public License, the rights specified in Section 2(b)(1)-(2) are not Copyright and Similar Rights.
    Effective Technological Measures means those measures that, in the absence of proper authority, may not be circumvented under laws fulfilling obligations under Article 11 of the WIPO Copyright Treaty adopted on December 20, 1996, and/or similar international agreements.
    Exceptions and Limitations means fair use, fair dealing, and/or any other exception or limitation to Copyright and Similar Rights that applies to Your use of the Licensed Material.
    Licensed Material means the artistic or literary work, database, or other material to which the Licensor applied this Public License.
    Licensed Rights means the rights granted to You subject to the terms and conditions of this Public License, which are limited to all Copyright and Similar Rights that apply to Your use of the Licensed Material and that the Licensor has authority to license.
    Licensor means the individual(s) or entity(ies) granting rights under this Public License.
    Share means to provide material to the public by any means or process that requires permission under the Licensed Rights, such as reproduction, public display, public performance, distribution, dissemination, communication, or importation, and to make material available to the public including in ways that members of the public may access the material from a place and at a time individually chosen by them.
    Sui Generis Database Rights means rights other than copyright resulting from Directive 96/9/EC of the European Parliament and of the Council of 11 March 1996 on the legal protection of databases, as amended and/or succeeded, as well as other essentially equivalent rights anywhere in the world.
    You means the individual or entity exercising the Licensed Rights under this Public License. Your has a corresponding meaning.

Section 2 – Scope.

    License grant.
        Subject to the terms and conditions of this Public License, the Licensor hereby grants You a worldwide, royalty-free, non-sublicensable, non-exclusive, irrevocable license to exercise the Licensed Rights in the Licensed Material to:
            reproduce and Share the Licensed Material, in whole or in part; and
            produce and reproduce, but not Share, Adapted Material.
        Exceptions and Limitations. For the avoidance of doubt, where Exceptions and Limitations apply to Your use, this Public License does not apply, and You do not need to comply with its terms and conditions.
        Term. The term of this Public License is specified in Section 6(a).
        Media and formats; technical modifications allowed. The Licensor authorizes You to exercise the Licensed Rights in all media and formats whether now known or hereafter created, and to make technical modifications necessary to do so. The Licensor waives and/or agrees not to assert any right or authority to forbid You from making technical modifications necessary to exercise the Licensed Rights, including technical modifications necessary to circumvent Effective Technological Measures. For purposes of this Public License, simply making modifications authorized by this Section 2(a)(4) never produces Adapted Material.
        Downstream recipients.
            Offer from the Licensor – Licensed Material. Every recipient of the Licensed Material automatically receives an offer from the Licensor to exercise the Licensed Rights under the terms and conditions of this Public License.
            No downstream restrictions. You may not offer or impose any additional or different terms or conditions on, or apply any Effective Technological Measures to, the Licensed Material if doing so restricts exercise of the Licensed Rights by any recipient of the Licensed Material.
        No endorsement. Nothing in this Public License constitutes or may be construed as permission to assert or imply that You are, or that Your use of the Licensed Material is, connected with, or sponsored, endorsed, or granted official status by, the Licensor or others designated to receive attribution as provided in Section 3(a)(1)(A)(i).

    Other rights.
        Moral rights, such as the right of integrity, are not licensed under this Public License, nor are publicity, privacy, and/or other similar personality rights; however, to the extent possible, the Licensor waives and/or agrees not to assert any such rights held by the Licensor to the limited extent necessary to allow You to exercise the Licensed Rights, but not otherwise.
        Patent and trademark rights are not licensed under this Public License.
        To the extent possible, the Licensor waives any right to collect royalties from You for the exercise of the Licensed Rights, whether directly or through a collecting society under any voluntary or waivable statutory or compulsory licensing scheme. In all other cases the Licensor expressly reserves any right to collect such royalties.

Section 3 – License Conditions.

Your exercise of the Licensed Rights is expressly made subject to the following conditions.

    Attribution.

        If You Share the Licensed Material, You must:
            retain the following if it is supplied by the Licensor with the Licensed Material:
                identification of the creator(s) of the Licensed Material and any others designated to receive attribution, in any reasonable manner requested by the Licensor (including by pseudonym if designated);
                a copyright notice;
                a notice that refers to this Public License;
                a notice that refers to the disclaimer of warranties;
                a URI or hyperlink to the Licensed Material to the extent reasonably practicable;
            indicate if You modified the Licensed Material and retain an indication of any previous modifications; and
            indicate the Licensed Material is licensed under this Public License, and include the text of, or the URI or hyperlink to, this Public License.
        For the avoidance of doubt, You do not have permission under this Public License to Share Adapted Material.
        You may satisfy the conditions in Section 3(a)(1) in any reasonable manner based on the medium, means, and context in which You Share the Licensed Material. For example, it may be reasonable to satisfy the conditions by providing a URI or hyperlink to a resource that includes the required information.
        If requested by the Licensor, You must remove any of the information required by Section 3(a)(1)(A) to the extent reasonably practicable.

Section 4 – Sui Generis Database Rights.

Where the Licensed Rights include Sui Generis Database Rights that apply to Your use of the Licensed Material:

    for the avoidance of doubt, Section 2(a)(1) grants You the right to extract, reuse, reproduce, and Share all or a substantial portion of the contents of the database, provided You do not Share Adapted Material;
    if You include all or a substantial portion of the database contents in a database in which You have Sui Generis Database Rights, then the database in which You have Sui Generis Database Rights (but not its individual contents) is Adapted Material; and
    You must comply with the conditions in Section 3(a) if You Share all or a substantial portion of the contents of the database.

For the avoidance of doubt, this Section 4 supplements and does not replace Your obligations under this Public License where the Licensed Rights include other Copyright and Similar Rights.

Section 5 – Disclaimer of Warranties and Limitation of Liability.

    Unless otherwise separately undertaken by the Licensor, to the extent possible, the Licensor offers the Licensed Material as-is and as-available, and makes no representations or warranties of any kind concerning the Licensed Material, whether express, implied, statutory, or other. This includes, without limitation, warranties of title, merchantability, fitness for a particular purpose, non-infringement, absence of latent or other defects, accuracy, or the presence or absence of errors, whether or not known or discoverable. Where disclaimers of warranties are not allowed in full or in part, this disclaimer may not apply to You.
    To the extent possible, in no event will the Licensor be liable to You on any legal theory (including, without limitation, negligence) or otherwise for any direct, special, indirect, incidental, consequential, punitive, exemplary, or other losses, costs, expenses, or damages arising out of this Public License or use of the Licensed Material, even if the Licensor has been advised of the possibility of such losses, costs, expenses, or damages. Where a limitation of liability is not allowed in full or in part, this limitation may not apply to You.

    The disclaimer of warranties and limitation of liability provided above shall be interpreted in a manner that, to the extent possible, most closely approximates an absolute disclaimer and waiver of all liability.

Section 6 – Term and Termination.

    This Public License applies for the term of the Copyright and Similar Rights licensed here. However, if You fail to comply with this Public License, then Your rights under this Public License terminate automatically.

    Where Your right to use the Licensed Material has terminated under Section 6(a), it reinstates:
        automatically as of the date the violation is cured, provided it is cured within 30 days of Your discovery of the violation; or
        upon express reinstatement by the Licensor.
    For the avoidance of doubt, this Section 6(b) does not affect any right the Licensor may have to seek remedies for Your violations of this Public License.
    For the avoidance of doubt, the Licensor may also offer the Licensed Material under separate terms or conditions or stop distributing the Licensed Material at any time; however, doing so will not terminate this Public License.
    Sections 1, 5, 6, 7, and 8 survive termination of this Public License.

Section 7 – Other Terms and Conditions.

    The Licensor shall not be bound by any additional or different terms or conditions communicated by You unless expressly agreed.
    Any arrangements, understandings, or agreements regarding the Licensed Material not stated herein are separate from and independent of the terms and conditions of this Public License.

Section 8 – Interpretation.

    For the avoidance of doubt, this Public License does not, and shall not be interpreted to, reduce, limit, restrict, or impose conditions on any use of the Licensed Material that could lawfully be made without permission under this Public License.
    To the extent possible, if any provision of this Public License is deemed unenforceable, it shall be automatically reformed to the minimum extent necessary to make it enforceable. If the provision cannot be reformed, it shall be severed from this Public License without affecting the enforceability of the remaining terms and conditions.
    No term or condition of this Public License will be waived and no failure to comply consented to unless expressly agreed to by the Licensor.
    Nothing in this Public License constitutes or may be interpreted as a limitation upon, or waiver of, any privileges and immunities that apply to the Licensor or You, including from the legal processes of any jurisdiction or authority.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="gnu-lesser-general-public-license-version-2-1"><a class="anchor" href="#gnu-lesser-general-public-license-version-2-1"></a>GNU LESSER GENERAL PUBLIC LICENSE - Version 2.1</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code> Version 2.1, February 1999

Copyright (C) 1991, 1999 Free Software Foundation, Inc.
51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.

[This is the first released version of the Lesser GPL.  It also counts
 as the successor of the GNU Library Public License, version 2, hence
 the version number 2.1.]

Preamble

The licenses for most software are designed to take away your freedom to share and change it. By contrast, the GNU General Public Licenses are intended to guarantee your freedom to share and change free software--to make sure the software is free for all its users.

This license, the Lesser General Public License, applies to some specially designated software packages--typically libraries--of the Free Software Foundation and other authors who decide to use it. You can use it too, but we suggest you first think carefully about whether this license or the ordinary General Public License is the better strategy to use in any particular case, based on the explanations below.

When we speak of free software, we are referring to freedom of use, not price. Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for this service if you wish); that you receive source code or can get it if you want it; that you can change the software and use pieces of it in new free programs; and that you are informed that you can do these things.

To protect your rights, we need to make restrictions that forbid distributors to deny you these rights or to ask you to surrender these rights. These restrictions translate to certain responsibilities for you if you distribute copies of the library or if you modify it.

For example, if you distribute copies of the library, whether gratis or for a fee, you must give the recipients all the rights that we gave you. You must make sure that they, too, receive or can get the source code. If you link other code with the library, you must provide complete object files to the recipients, so that they can relink them with the library after making changes to the library and recompiling it. And you must show them these terms so they know their rights.

We protect your rights with a two-step method: (1) we copyright the library, and (2) we offer you this license, which gives you legal permission to copy, distribute and/or modify the library.

To protect each distributor, we want to make it very clear that there is no warranty for the free library. Also, if the library is modified by someone else and passed on, the recipients should know that what they have is not the original version, so that the original author's reputation will not be affected by problems that might be introduced by others.

Finally, software patents pose a constant threat to the existence of any free program. We wish to make sure that a company cannot effectively restrict the users of a free program by obtaining a restrictive license from a patent holder. Therefore, we insist that any patent license obtained for a version of the library must be consistent with the full freedom of use specified in this license.

Most GNU software, including some libraries, is covered by the ordinary GNU General Public License. This license, the GNU Lesser General Public License, applies to certain designated libraries, and is quite different from the ordinary General Public License. We use this license for certain libraries in order to permit linking those libraries into non-free programs.

When a program is linked with a library, whether statically or using a shared library, the combination of the two is legally speaking a combined work, a derivative of the original library. The ordinary General Public License therefore permits such linking only if the entire combination fits its criteria of freedom. The Lesser General Public License permits more lax criteria for linking other code with the library.

We call this license the "Lesser" General Public License because it does Less to protect the user's freedom than the ordinary General Public License. It also provides other free software developers Less of an advantage over competing non-free programs. These disadvantages are the reason we use the ordinary General Public License for many libraries. However, the Lesser license provides advantages in certain special circumstances.

For example, on rare occasions, there may be a special need to encourage the widest possible use of a certain library, so that it becomes a de-facto standard. To achieve this, non-free programs must be allowed to use the library. A more frequent case is that a free library does the same job as widely used non-free libraries. In this case, there is little to gain by limiting the free library to free software only, so we use the Lesser General Public License.

In other cases, permission to use a particular library in non-free programs enables a greater number of people to use a large body of free software. For example, permission to use the GNU C Library in non-free programs enables many more people to use the whole GNU operating system, as well as its variant, the GNU/Linux operating system.

Although the Lesser General Public License is Less protective of the users' freedom, it does ensure that the user of a program that is linked with the Library has the freedom and the wherewithal to run that program using a modified version of the Library.

The precise terms and conditions for copying, distribution and modification follow. Pay close attention to the difference between a "work based on the library" and a "work that uses the library". The former contains code derived from the library, whereas the latter must be combined with the library in order to run.
TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

0. This License Agreement applies to any software library or other program which contains a notice placed by the copyright holder or other authorized party saying it may be distributed under the terms of this Lesser General Public License (also called "this License"). Each licensee is addressed as "you".

A "library" means a collection of software functions and/or data prepared so as to be conveniently linked with application programs (which use some of those functions and data) to form executables.

The "Library", below, refers to any such software library or work which has been distributed under these terms. A "work based on the Library" means either the Library or any derivative work under copyright law: that is to say, a work containing the Library or a portion of it, either verbatim or with modifications and/or translated straightforwardly into another language. (Hereinafter, translation is included without limitation in the term "modification".)

"Source code" for a work means the preferred form of the work for making modifications to it. For a library, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the library.

Activities other than copying, distribution and modification are not covered by this License; they are outside its scope. The act of running a program using the Library is not restricted, and output from such a program is covered only if its contents constitute a work based on the Library (independent of the use of the Library in a tool for writing it). Whether that is true depends on what the Library does and what the program that uses the Library does.

1. You may copy and distribute verbatim copies of the Library's complete source code as you receive it, in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate copyright notice and disclaimer of warranty; keep intact all the notices that refer to this License and to the absence of any warranty; and distribute a copy of this License along with the Library.

You may charge a fee for the physical act of transferring a copy, and you may at your option offer warranty protection in exchange for a fee.

2. You may modify your copy or copies of the Library or any portion of it, thus forming a work based on the Library, and copy and distribute such modifications or work under the terms of Section 1 above, provided that you also meet all of these conditions:

    a) The modified work must itself be a software library.
    b) You must cause the files modified to carry prominent notices stating that you changed the files and the date of any change.
    c) You must cause the whole of the work to be licensed at no charge to all third parties under the terms of this License.
    d) If a facility in the modified Library refers to a function or a table of data to be supplied by an application program that uses the facility, other than as an argument passed when the facility is invoked, then you must make a good faith effort to ensure that, in the event an application does not supply such function or table, the facility still operates, and performs whatever part of its purpose remains meaningful.

    (For example, a function in a library to compute square roots has a purpose that is entirely well-defined independent of the application. Therefore, Subsection 2d requires that any application-supplied function or table used by this function must be optional: if the application does not supply it, the square root function must still compute square roots.)

These requirements apply to the modified work as a whole. If identifiable sections of that work are not derived from the Library, and can be reasonably considered independent and separate works in themselves, then this License, and its terms, do not apply to those sections when you distribute them as separate works. But when you distribute the same sections as part of a whole which is a work based on the Library, the distribution of the whole must be on the terms of this License, whose permissions for other licensees extend to the entire whole, and thus to each and every part regardless of who wrote it.

Thus, it is not the intent of this section to claim rights or contest your rights to work written entirely by you; rather, the intent is to exercise the right to control the distribution of derivative or collective works based on the Library.

In addition, mere aggregation of another work not based on the Library with the Library (or with a work based on the Library) on a volume of a storage or distribution medium does not bring the other work under the scope of this License.

3. You may opt to apply the terms of the ordinary GNU General Public License instead of this License to a given copy of the Library. To do this, you must alter all the notices that refer to this License, so that they refer to the ordinary GNU General Public License, version 2, instead of to this License. (If a newer version than version 2 of the ordinary GNU General Public License has appeared, then you can specify that version instead if you wish.) Do not make any other change in these notices.

Once this change is made in a given copy, it is irreversible for that copy, so the ordinary GNU General Public License applies to all subsequent copies and derivative works made from that copy.

This option is useful when you wish to copy part of the code of the Library into a program that is not a library.

4. You may copy and distribute the Library (or a portion or derivative of it, under Section 2) in object code or executable form under the terms of Sections 1 and 2 above provided that you accompany it with the complete corresponding machine-readable source code, which must be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange.

If distribution of object code is made by offering access to copy from a designated place, then offering equivalent access to copy the source code from the same place satisfies the requirement to distribute the source code, even though third parties are not compelled to copy the source along with the object code.

5. A program that contains no derivative of any portion of the Library, but is designed to work with the Library by being compiled or linked with it, is called a "work that uses the Library". Such a work, in isolation, is not a derivative work of the Library, and therefore falls outside the scope of this License.

However, linking a "work that uses the Library" with the Library creates an executable that is a derivative of the Library (because it contains portions of the Library), rather than a "work that uses the library". The executable is therefore covered by this License. Section 6 states terms for distribution of such executables.

When a "work that uses the Library" uses material from a header file that is part of the Library, the object code for the work may be a derivative work of the Library even though the source code is not. Whether this is true is especially significant if the work can be linked without the Library, or if the work is itself a library. The threshold for this to be true is not precisely defined by law.

If such an object file uses only numerical parameters, data structure layouts and accessors, and small macros and small inline functions (ten lines or less in length), then the use of the object file is unrestricted, regardless of whether it is legally a derivative work. (Executables containing this object code plus portions of the Library will still fall under Section 6.)

Otherwise, if the work is a derivative of the Library, you may distribute the object code for the work under the terms of Section 6. Any executables containing that work also fall under Section 6, whether or not they are linked directly with the Library itself.

6. As an exception to the Sections above, you may also combine or link a "work that uses the Library" with the Library to produce a work containing portions of the Library, and distribute that work under terms of your choice, provided that the terms permit modification of the work for the customer's own use and reverse engineering for debugging such modifications.

You must give prominent notice with each copy of the work that the Library is used in it and that the Library and its use are covered by this License. You must supply a copy of this License. If the work during execution displays copyright notices, you must include the copyright notice for the Library among them, as well as a reference directing the user to the copy of this License. Also, you must do one of these things:

    a) Accompany the work with the complete corresponding machine-readable source code for the Library including whatever changes were used in the work (which must be distributed under Sections 1 and 2 above); and, if the work is an executable linked with the Library, with the complete machine-readable "work that uses the Library", as object code and/or source code, so that the user can modify the Library and then relink to produce a modified executable containing the modified Library. (It is understood that the user who changes the contents of definitions files in the Library will not necessarily be able to recompile the application to use the modified definitions.)
    b) Use a suitable shared library mechanism for linking with the Library. A suitable mechanism is one that (1) uses at run time a copy of the library already present on the user's computer system, rather than copying library functions into the executable, and (2) will operate properly with a modified version of the library, if the user installs one, as long as the modified version is interface-compatible with the version that the work was made with.
    c) Accompany the work with a written offer, valid for at least three years, to give the same user the materials specified in Subsection 6a, above, for a charge no more than the cost of performing this distribution.
    d) If distribution of the work is made by offering access to copy from a designated place, offer equivalent access to copy the above specified materials from the same place.
    e) Verify that the user has already received a copy of these materials or that you have already sent this user a copy.

For an executable, the required form of the "work that uses the Library" must include any data and utility programs needed for reproducing the executable from it. However, as a special exception, the materials to be distributed need not include anything that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, unless that component itself accompanies the executable.

It may happen that this requirement contradicts the license restrictions of other proprietary libraries that do not normally accompany the operating system. Such a contradiction means you cannot use both them and the Library together in an executable that you distribute.

7. You may place library facilities that are a work based on the Library side-by-side in a single library together with other library facilities not covered by this License, and distribute such a combined library, provided that the separate distribution of the work based on the Library and of the other library facilities is otherwise permitted, and provided that you do these two things:

    a) Accompany the combined library with a copy of the same work based on the Library, uncombined with any other library facilities. This must be distributed under the terms of the Sections above.
    b) Give prominent notice with the combined library of the fact that part of it is a work based on the Library, and explaining where to find the accompanying uncombined form of the same work.

8. You may not copy, modify, sublicense, link with, or distribute the Library except as expressly provided under this License. Any attempt otherwise to copy, modify, sublicense, link with, or distribute the Library is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance.

9. You are not required to accept this License, since you have not signed it. However, nothing else grants you permission to modify or distribute the Library or its derivative works. These actions are prohibited by law if you do not accept this License. Therefore, by modifying or distributing the Library (or any work based on the Library), you indicate your acceptance of this License to do so, and all its terms and conditions for copying, distributing or modifying the Library or works based on it.

10. Each time you redistribute the Library (or any work based on the Library), the recipient automatically receives a license from the original licensor to copy, distribute, link with or modify the Library subject to these terms and conditions. You may not impose any further restrictions on the recipients' exercise of the rights granted herein. You are not responsible for enforcing compliance by third parties with this License.

11. If, as a consequence of a court judgment or allegation of patent infringement or for any other reason (not limited to patent issues), conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License. If you cannot distribute so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not distribute the Library at all. For example, if a patent license would not permit royalty-free redistribution of the Library by all those who receive copies directly or indirectly through you, then the only way you could satisfy both it and this License would be to refrain entirely from distribution of the Library.

If any portion of this section is held invalid or unenforceable under any particular circumstance, the balance of the section is intended to apply, and the section as a whole is intended to apply in other circumstances.

It is not the purpose of this section to induce you to infringe any patents or other property right claims or to contest validity of any such claims; this section has the sole purpose of protecting the integrity of the free software distribution system which is implemented by public license practices. Many people have made generous contributions to the wide range of software distributed through that system in reliance on consistent application of that system; it is up to the author/donor to decide if he or she is willing to distribute software through any other system and a licensee cannot impose that choice.

This section is intended to make thoroughly clear what is believed to be a consequence of the rest of this License.

12. If the distribution and/or use of the Library is restricted in certain countries either by patents or by copyrighted interfaces, the original copyright holder who places the Library under this License may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded. In such case, this License incorporates the limitation as if written in the body of this License.

13. The Free Software Foundation may publish revised and/or new versions of the Lesser General Public License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.

Each version is given a distinguishing version number. If the Library specifies a version number of this License which applies to it and "any later version", you have the option of following the terms and conditions either of that version or of any later version published by the Free Software Foundation. If the Library does not specify a license version number, you may choose any version ever published by the Free Software Foundation.

14. If you wish to incorporate parts of the Library into other free programs whose distribution conditions are incompatible with these, write to the author to ask for permission. For software which is copyrighted by the Free Software Foundation, write to the Free Software Foundation; we sometimes make exceptions for this. Our decision will be guided by the two goals of preserving the free status of all derivatives of our free software and of promoting the sharing and reuse of software generally.

NO WARRANTY

15. BECAUSE THE LIBRARY IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE LIBRARY, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE LIBRARY "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE LIBRARY IS WITH YOU. SHOULD THE LIBRARY PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

16. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE LIBRARY AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE LIBRARY (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE LIBRARY TO OPERATE WITH ANY OTHER SOFTWARE), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
END OF TERMS AND CONDITIONS
How to Apply These Terms to Your New Libraries

If you develop a new library, and you want it to be of the greatest possible use to the public, we recommend making it free software that everyone can redistribute and change. You can do so by permitting redistribution under these terms (or, alternatively, under the terms of the ordinary General Public License).

To apply these terms, attach the following notices to the library. It is safest to attach them to the start of each source file to most effectively convey the exclusion of warranty; and each file should have at least the "copyright" line and a pointer to where the full notice is found.

one line to give the library's name and an idea of what it does.
Copyright (C) year  name of author

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA

Also add information on how to contact you by electronic and paper mail.

You should also get your employer (if you work as a programmer) or your school, if any, to sign a "copyright disclaimer" for the library, if necessary. Here is a sample; alter the names:

Yoyodyne, Inc., hereby disclaims all copyright interest in
the library `Frob' (a library for tweaking knobs) written
by James Random Hacker.

signature of Ty Coon, 1 April 1990
Ty Coon, President of Vice</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="gnu-lesser-general-public-license-version-3"><a class="anchor" href="#gnu-lesser-general-public-license-version-3"></a>GNU LESSER GENERAL PUBLIC LICENSE - Version 3</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Version 3, 29 June 2007

Copyright © 2007 Free Software Foundation, Inc. &lt;https://fsf.org/&gt;

Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed.

This version of the GNU Lesser General Public License incorporates the terms and conditions of version 3 of the GNU General Public License, supplemented by the additional permissions listed below.
0. Additional Definitions.

As used herein, “this License” refers to version 3 of the GNU Lesser General Public License, and the “GNU GPL” refers to version 3 of the GNU General Public License.

“The Library” refers to a covered work governed by this License, other than an Application or a Combined Work as defined below.

An “Application” is any work that makes use of an interface provided by the Library, but which is not otherwise based on the Library. Defining a subclass of a class defined by the Library is deemed a mode of using an interface provided by the Library.

A “Combined Work” is a work produced by combining or linking an Application with the Library. The particular version of the Library with which the Combined Work was made is also called the “Linked Version”.

The “Minimal Corresponding Source” for a Combined Work means the Corresponding Source for the Combined Work, excluding any source code for portions of the Combined Work that, considered in isolation, are based on the Application, and not on the Linked Version.

The “Corresponding Application Code” for a Combined Work means the object code and/or source code for the Application, including any data and utility programs needed for reproducing the Combined Work from the Application, but excluding the System Libraries of the Combined Work.
1. Exception to Section 3 of the GNU GPL.

You may convey a covered work under sections 3 and 4 of this License without being bound by section 3 of the GNU GPL.
2. Conveying Modified Versions.

If you modify a copy of the Library, and, in your modifications, a facility refers to a function or data to be supplied by an Application that uses the facility (other than as an argument passed when the facility is invoked), then you may convey a copy of the modified version:

    a) under this License, provided that you make a good faith effort to ensure that, in the event an Application does not supply the function or data, the facility still operates, and performs whatever part of its purpose remains meaningful, or
    b) under the GNU GPL, with none of the additional permissions of this License applicable to that copy.

3. Object Code Incorporating Material from Library Header Files.

The object code form of an Application may incorporate material from a header file that is part of the Library. You may convey such object code under terms of your choice, provided that, if the incorporated material is not limited to numerical parameters, data structure layouts and accessors, or small macros, inline functions and templates (ten or fewer lines in length), you do both of the following:

    a) Give prominent notice with each copy of the object code that the Library is used in it and that the Library and its use are covered by this License.
    b) Accompany the object code with a copy of the GNU GPL and this license document.

4. Combined Works.

You may convey a Combined Work under terms of your choice that, taken together, effectively do not restrict modification of the portions of the Library contained in the Combined Work and reverse engineering for debugging such modifications, if you also do each of the following:

    a) Give prominent notice with each copy of the Combined Work that the Library is used in it and that the Library and its use are covered by this License.
    b) Accompany the Combined Work with a copy of the GNU GPL and this license document.
    c) For a Combined Work that displays copyright notices during execution, include the copyright notice for the Library among these notices, as well as a reference directing the user to the copies of the GNU GPL and this license document.
    d) Do one of the following:
        0) Convey the Minimal Corresponding Source under the terms of this License, and the Corresponding Application Code in a form suitable for, and under terms that permit, the user to recombine or relink the Application with a modified version of the Linked Version to produce a modified Combined Work, in the manner specified by section 6 of the GNU GPL for conveying Corresponding Source.
        1) Use a suitable shared library mechanism for linking with the Library. A suitable mechanism is one that (a) uses at run time a copy of the Library already present on the user's computer system, and (b) will operate properly with a modified version of the Library that is interface-compatible with the Linked Version.
    e) Provide Installation Information, but only if you would otherwise be required to provide such information under section 6 of the GNU GPL, and only to the extent that such information is necessary to install and execute a modified version of the Combined Work produced by recombining or relinking the Application with a modified version of the Linked Version. (If you use option 4d0, the Installation Information must accompany the Minimal Corresponding Source and Corresponding Application Code. If you use option 4d1, you must provide the Installation Information in the manner specified by section 6 of the GNU GPL for conveying Corresponding Source.)

5. Combined Libraries.

You may place library facilities that are a work based on the Library side by side in a single library together with other library facilities that are not Applications and are not covered by this License, and convey such a combined library under terms of your choice, if you do both of the following:

    a) Accompany the combined library with a copy of the same work based on the Library, uncombined with any other library facilities, conveyed under the terms of this License.
    b) Give prominent notice with the combined library that part of it is a work based on the Library, and explaining where to find the accompanying uncombined form of the same work.

6. Revised Versions of the GNU Lesser General Public License.

The Free Software Foundation may publish revised and/or new versions of the GNU Lesser General Public License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.

Each version is given a distinguishing version number. If the Library as you received it specifies that a certain numbered version of the GNU Lesser General Public License “or any later version” applies to it, you have the option of following the terms and conditions either of that published version or of any later version published by the Free Software Foundation. If the Library as you received it does not specify a version number of the GNU Lesser General Public License, you may choose any version of the GNU Lesser General Public License ever published by the Free Software Foundation.

If the Library as you received it specifies that a proxy can decide whether future versions of the GNU Lesser General Public License shall apply, that proxy's public statement of acceptance of any version is permanent authorization for you to choose that version for the Library.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="gnu-general-public-license-version-2"><a class="anchor" href="#gnu-general-public-license-version-2"></a>GNU GENERAL PUBLIC LICENSE - Version 2</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code> Version 2, June 1991

Copyright (C) 1989, 1991 Free Software Foundation, Inc.
51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.

Preamble

The licenses for most software are designed to take away your freedom to share and change it. By contrast, the GNU General Public License is intended to guarantee your freedom to share and change free software--to make sure the software is free for all its users. This General Public License applies to most of the Free Software Foundation's software and to any other program whose authors commit to using it. (Some other Free Software Foundation software is covered by the GNU Lesser General Public License instead.) You can apply it to your programs, too.

When we speak of free software, we are referring to freedom, not price. Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for this service if you wish), that you receive source code or can get it if you want it, that you can change the software or use pieces of it in new free programs; and that you know you can do these things.

To protect your rights, we need to make restrictions that forbid anyone to deny you these rights or to ask you to surrender the rights. These restrictions translate to certain responsibilities for you if you distribute copies of the software, or if you modify it.

For example, if you distribute copies of such a program, whether gratis or for a fee, you must give the recipients all the rights that you have. You must make sure that they, too, receive or can get the source code. And you must show them these terms so they know their rights.

We protect your rights with two steps: (1) copyright the software, and (2) offer you this license which gives you legal permission to copy, distribute and/or modify the software.

Also, for each author's protection and ours, we want to make certain that everyone understands that there is no warranty for this free software. If the software is modified by someone else and passed on, we want its recipients to know that what they have is not the original, so that any problems introduced by others will not reflect on the original authors' reputations.

Finally, any free program is threatened constantly by software patents. We wish to avoid the danger that redistributors of a free program will individually obtain patent licenses, in effect making the program proprietary. To prevent this, we have made it clear that any patent must be licensed for everyone's free use or not licensed at all.

The precise terms and conditions for copying, distribution and modification follow.
TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

0. This License applies to any program or other work which contains a notice placed by the copyright holder saying it may be distributed under the terms of this General Public License. The "Program", below, refers to any such program or work, and a "work based on the Program" means either the Program or any derivative work under copyright law: that is to say, a work containing the Program or a portion of it, either verbatim or with modifications and/or translated into another language. (Hereinafter, translation is included without limitation in the term "modification".) Each licensee is addressed as "you".

Activities other than copying, distribution and modification are not covered by this License; they are outside its scope. The act of running the Program is not restricted, and the output from the Program is covered only if its contents constitute a work based on the Program (independent of having been made by running the Program). Whether that is true depends on what the Program does.

1. You may copy and distribute verbatim copies of the Program's source code as you receive it, in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate copyright notice and disclaimer of warranty; keep intact all the notices that refer to this License and to the absence of any warranty; and give any other recipients of the Program a copy of this License along with the Program.

You may charge a fee for the physical act of transferring a copy, and you may at your option offer warranty protection in exchange for a fee.

2. You may modify your copy or copies of the Program or any portion of it, thus forming a work based on the Program, and copy and distribute such modifications or work under the terms of Section 1 above, provided that you also meet all of these conditions:

    a) You must cause the modified files to carry prominent notices stating that you changed the files and the date of any change.
    b) You must cause any work that you distribute or publish, that in whole or in part contains or is derived from the Program or any part thereof, to be licensed as a whole at no charge to all third parties under the terms of this License.
    c) If the modified program normally reads commands interactively when run, you must cause it, when started running for such interactive use in the most ordinary way, to print or display an announcement including an appropriate copyright notice and a notice that there is no warranty (or else, saying that you provide a warranty) and that users may redistribute the program under these conditions, and telling the user how to view a copy of this License. (Exception: if the Program itself is interactive but does not normally print such an announcement, your work based on the Program is not required to print an announcement.)

These requirements apply to the modified work as a whole. If identifiable sections of that work are not derived from the Program, and can be reasonably considered independent and separate works in themselves, then this License, and its terms, do not apply to those sections when you distribute them as separate works. But when you distribute the same sections as part of a whole which is a work based on the Program, the distribution of the whole must be on the terms of this License, whose permissions for other licensees extend to the entire whole, and thus to each and every part regardless of who wrote it.

Thus, it is not the intent of this section to claim rights or contest your rights to work written entirely by you; rather, the intent is to exercise the right to control the distribution of derivative or collective works based on the Program.

In addition, mere aggregation of another work not based on the Program with the Program (or with a work based on the Program) on a volume of a storage or distribution medium does not bring the other work under the scope of this License.

3. You may copy and distribute the Program (or a work based on it, under Section 2) in object code or executable form under the terms of Sections 1 and 2 above provided that you also do one of the following:

    a) Accompany it with the complete corresponding machine-readable source code, which must be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or,
    b) Accompany it with a written offer, valid for at least three years, to give any third party, for a charge no more than your cost of physically performing source distribution, a complete machine-readable copy of the corresponding source code, to be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or,
    c) Accompany it with the information you received as to the offer to distribute corresponding source code. (This alternative is allowed only for noncommercial distribution and only if you received the program in object code or executable form with such an offer, in accord with Subsection b above.)

The source code for a work means the preferred form of the work for making modifications to it. For an executable work, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the executable. However, as a special exception, the source code distributed need not include anything that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, unless that component itself accompanies the executable.

If distribution of executable or object code is made by offering access to copy from a designated place, then offering equivalent access to copy the source code from the same place counts as distribution of the source code, even though third parties are not compelled to copy the source along with the object code.

4. You may not copy, modify, sublicense, or distribute the Program except as expressly provided under this License. Any attempt otherwise to copy, modify, sublicense or distribute the Program is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance.

5. You are not required to accept this License, since you have not signed it. However, nothing else grants you permission to modify or distribute the Program or its derivative works. These actions are prohibited by law if you do not accept this License. Therefore, by modifying or distributing the Program (or any work based on the Program), you indicate your acceptance of this License to do so, and all its terms and conditions for copying, distributing or modifying the Program or works based on it.

6. Each time you redistribute the Program (or any work based on the Program), the recipient automatically receives a license from the original licensor to copy, distribute or modify the Program subject to these terms and conditions. You may not impose any further restrictions on the recipients' exercise of the rights granted herein. You are not responsible for enforcing compliance by third parties to this License.

7. If, as a consequence of a court judgment or allegation of patent infringement or for any other reason (not limited to patent issues), conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License. If you cannot distribute so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not distribute the Program at all. For example, if a patent license would not permit royalty-free redistribution of the Program by all those who receive copies directly or indirectly through you, then the only way you could satisfy both it and this License would be to refrain entirely from distribution of the Program.

If any portion of this section is held invalid or unenforceable under any particular circumstance, the balance of the section is intended to apply and the section as a whole is intended to apply in other circumstances.

It is not the purpose of this section to induce you to infringe any patents or other property right claims or to contest validity of any such claims; this section has the sole purpose of protecting the integrity of the free software distribution system, which is implemented by public license practices. Many people have made generous contributions to the wide range of software distributed through that system in reliance on consistent application of that system; it is up to the author/donor to decide if he or she is willing to distribute software through any other system and a licensee cannot impose that choice.

This section is intended to make thoroughly clear what is believed to be a consequence of the rest of this License.

8. If the distribution and/or use of the Program is restricted in certain countries either by patents or by copyrighted interfaces, the original copyright holder who places the Program under this License may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded. In such case, this License incorporates the limitation as if written in the body of this License.

9. The Free Software Foundation may publish revised and/or new versions of the General Public License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.

Each version is given a distinguishing version number. If the Program specifies a version number of this License which applies to it and "any later version", you have the option of following the terms and conditions either of that version or of any later version published by the Free Software Foundation. If the Program does not specify a version number of this License, you may choose any version ever published by the Free Software Foundation.

10. If you wish to incorporate parts of the Program into other free programs whose distribution conditions are different, write to the author to ask for permission. For software which is copyrighted by the Free Software Foundation, write to the Free Software Foundation; we sometimes make exceptions for this. Our decision will be guided by the two goals of preserving the free status of all derivatives of our free software and of promoting the sharing and reuse of software generally.

NO WARRANTY

11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
END OF TERMS AND CONDITIONS
How to Apply These Terms to Your New Programs

If you develop a new program, and you want it to be of the greatest possible use to the public, the best way to achieve this is to make it free software which everyone can redistribute and change under these terms.

To do so, attach the following notices to the program. It is safest to attach them to the start of each source file to most effectively convey the exclusion of warranty; and each file should have at least the "copyright" line and a pointer to where the full notice is found.

one line to give the program's name and an idea of what it does.
Copyright (C) yyyy  name of author

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.

Also add information on how to contact you by electronic and paper mail.

If the program is interactive, make it output a short notice like this when it starts in an interactive mode:

Gnomovision version 69, Copyright (C) year name of author
Gnomovision comes with ABSOLUTELY NO WARRANTY; for details
type `show w'.  This is free software, and you are welcome
to redistribute it under certain conditions; type `show c'
for details.

The hypothetical commands `show w' and `show c' should show the appropriate parts of the General Public License. Of course, the commands you use may be called something other than `show w' and `show c'; they could even be mouse-clicks or menu items--whatever suits your program.

You should also get your employer (if you work as a programmer) or your school, if any, to sign a "copyright disclaimer" for the program, if necessary. Here is a sample; alter the names:

Yoyodyne, Inc., hereby disclaims all copyright
interest in the program `Gnomovision'
(which makes passes at compilers) written
by James Hacker.

signature of Ty Coon, 1 April 1989
Ty Coon, President of Vice</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="do-what-the-fuck-you-want-to-public-license-version-2"><a class="anchor" href="#do-what-the-fuck-you-want-to-public-license-version-2"></a>DO WHAT THE FUCK YOU WANT TO PUBLIC LICENSE - Version 2</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>            DO WHAT THE FUCK YOU WANT TO PUBLIC LICENSE
                    Version 2, December 2004

 Copyright (C) 2004 Sam Hocevar
  14 rue de Plaisance, 75014 Paris, France
 Everyone is permitted to copy and distribute verbatim or modified
 copies of this license document, and changing it is allowed as long
 as the name is changed.

            DO WHAT THE FUCK YOU WANT TO PUBLIC LICENSE
   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION

  0. You just DO WHAT THE FUCK YOU WANT TO.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="license-of-node-js"><a class="anchor" href="#license-of-node-js"></a>License of Node.js</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Node.js is licensed for use as follows:

"""
Copyright Node.js contributors. All rights reserved.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
"""

This license applies to parts of Node.js originating from the
https://github.com/joyent/node repository:

"""
Copyright Joyent, Inc. and other Node contributors. All rights reserved.
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
"""

The Node.js license applies to all parts of Node.js that are not externally
maintained libraries.

The externally maintained libraries used by Node.js are:

- Acorn, located at deps/acorn, is licensed as follows:
  """
    Copyright (C) 2012-2018 by various contributors (see AUTHORS)

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE.
  """

- Acorn plugins, located at deps/acorn-plugins, is licensed as follows:
  """
    Copyright (C) 2017-2018 by Adrian Heine

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE.
  """

- c-ares, located at deps/cares, is licensed as follows:
  """
    Copyright (c) 2007 - 2018, Daniel Stenberg with many contributors, see AUTHORS
    file.

    Copyright 1998 by the Massachusetts Institute of Technology.

    Permission to use, copy, modify, and distribute this software and its
    documentation for any purpose and without fee is hereby granted, provided that
    the above copyright notice appear in all copies and that both that copyright
    notice and this permission notice appear in supporting documentation, and that
    the name of M.I.T. not be used in advertising or publicity pertaining to
    distribution of the software without specific, written prior permission.
    M.I.T. makes no representations about the suitability of this software for any
    purpose.  It is provided "as is" without express or implied warranty.
  """

- ICU, located at deps/icu-small, is licensed as follows:
  """
    COPYRIGHT AND PERMISSION NOTICE (ICU 58 and later)

    Copyright © 1991-2019 Unicode, Inc. All rights reserved.
    Distributed under the Terms of Use in https://www.unicode.org/copyright.html.

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of the Unicode data files and any associated documentation
    (the "Data Files") or Unicode software and any associated documentation
    (the "Software") to deal in the Data Files or Software
    without restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, and/or sell copies of
    the Data Files or Software, and to permit persons to whom the Data Files
    or Software are furnished to do so, provided that either
    (a) this copyright and permission notice appear with all copies
    of the Data Files or Software, or
    (b) this copyright and permission notice appear in associated
    Documentation.

    THE DATA FILES AND SOFTWARE ARE PROVIDED "AS IS", WITHOUT WARRANTY OF
    ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
    WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT OF THIRD PARTY RIGHTS.
    IN NO EVENT SHALL THE COPYRIGHT HOLDER OR HOLDERS INCLUDED IN THIS
    NOTICE BE LIABLE FOR ANY CLAIM, OR ANY SPECIAL INDIRECT OR CONSEQUENTIAL
    DAMAGES, OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE,
    DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
    TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THE DATA FILES OR SOFTWARE.

    Except as contained in this notice, the name of a copyright holder
    shall not be used in advertising or otherwise to promote the sale,
    use or other dealings in these Data Files or Software without prior
    written authorization of the copyright holder.

    ---------------------

    Third-Party Software Licenses

    This section contains third-party software notices and/or additional
    terms for licensed third-party software components included within ICU
    libraries.

    1. ICU License - ICU 1.8.1 to ICU 57.1

    COPYRIGHT AND PERMISSION NOTICE

    Copyright (c) 1995-2016 International Business Machines Corporation and others
    All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, and/or sell copies of the Software, and to permit persons
    to whom the Software is furnished to do so, provided that the above
    copyright notice(s) and this permission notice appear in all copies of
    the Software and that both the above copyright notice(s) and this
    permission notice appear in supporting documentation.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT
    OF THIRD PARTY RIGHTS. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR
    HOLDERS INCLUDED IN THIS NOTICE BE LIABLE FOR ANY CLAIM, OR ANY
    SPECIAL INDIRECT OR CONSEQUENTIAL DAMAGES, OR ANY DAMAGES WHATSOEVER
    RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF
    CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
    CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

    Except as contained in this notice, the name of a copyright holder
    shall not be used in advertising or otherwise to promote the sale, use
    or other dealings in this Software without prior written authorization
    of the copyright holder.

    All trademarks and registered trademarks mentioned herein are the
    property of their respective owners.

    2. Chinese/Japanese Word Break Dictionary Data (cjdict.txt)

     #     The Google Chrome software developed by Google is licensed under
     # the BSD license. Other software included in this distribution is
     # provided under other licenses, as set forth below.
     #
     #  The BSD License
     #  http://opensource.org/licenses/bsd-license.php
     #  Copyright (C) 2006-2008, Google Inc.
     #
     #  All rights reserved.
     #
     #  Redistribution and use in source and binary forms, with or without
     # modification, are permitted provided that the following conditions are met:
     #
     #  Redistributions of source code must retain the above copyright notice,
     # this list of conditions and the following disclaimer.
     #  Redistributions in binary form must reproduce the above
     # copyright notice, this list of conditions and the following
     # disclaimer in the documentation and/or other materials provided with
     # the distribution.
     #  Neither the name of  Google Inc. nor the names of its
     # contributors may be used to endorse or promote products derived from
     # this software without specific prior written permission.
     #
     #
     #  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND
     # CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
     # INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
     # MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
     # DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
     # LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
     # CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
     # SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
     # BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
     # LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
     # NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
     # SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
     #
     #
     #  The word list in cjdict.txt are generated by combining three word lists
     # listed below with further processing for compound word breaking. The
     # frequency is generated with an iterative training against Google web
     # corpora.
     #
     #  * Libtabe (Chinese)
     #    - https://sourceforge.net/project/?group_id=1519
     #    - Its license terms and conditions are shown below.
     #
     #  * IPADIC (Japanese)
     #    - http://chasen.aist-nara.ac.jp/chasen/distribution.html
     #    - Its license terms and conditions are shown below.
     #
     #  ---------COPYING.libtabe ---- BEGIN--------------------
     #
     #  /*
     #   * Copyright (c) 1999 TaBE Project.
     #   * Copyright (c) 1999 Pai-Hsiang Hsiao.
     #   * All rights reserved.
     #   *
     #   * Redistribution and use in source and binary forms, with or without
     #   * modification, are permitted provided that the following conditions
     #   * are met:
     #   *
     #   * . Redistributions of source code must retain the above copyright
     #   *   notice, this list of conditions and the following disclaimer.
     #   * . Redistributions in binary form must reproduce the above copyright
     #   *   notice, this list of conditions and the following disclaimer in
     #   *   the documentation and/or other materials provided with the
     #   *   distribution.
     #   * . Neither the name of the TaBE Project nor the names of its
     #   *   contributors may be used to endorse or promote products derived
     #   *   from this software without specific prior written permission.
     #   *
     #   * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
     #   * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
     #   * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
     #   * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
     #   * REGENTS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
     #   * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
     #   * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
     #   * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
     #   * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
     #   * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     #   * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
     #   * OF THE POSSIBILITY OF SUCH DAMAGE.
     #   */
     #
     #  /*
     #   * Copyright (c) 1999 Computer Systems and Communication Lab,
     #   *                    Institute of Information Science, Academia
     #       *                    Sinica. All rights reserved.
     #   *
     #   * Redistribution and use in source and binary forms, with or without
     #   * modification, are permitted provided that the following conditions
     #   * are met:
     #   *
     #   * . Redistributions of source code must retain the above copyright
     #   *   notice, this list of conditions and the following disclaimer.
     #   * . Redistributions in binary form must reproduce the above copyright
     #   *   notice, this list of conditions and the following disclaimer in
     #   *   the documentation and/or other materials provided with the
     #   *   distribution.
     #   * . Neither the name of the Computer Systems and Communication Lab
     #   *   nor the names of its contributors may be used to endorse or
     #   *   promote products derived from this software without specific
     #   *   prior written permission.
     #   *
     #   * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
     #   * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
     #   * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
     #   * FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
     #   * REGENTS OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
     #   * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
     #   * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
     #   * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
     #   * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
     #   * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     #   * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
     #   * OF THE POSSIBILITY OF SUCH DAMAGE.
     #   */
     #
     #  Copyright 1996 Chih-Hao Tsai @ Beckman Institute,
     #      University of Illinois
     #  c-tsai4@uiuc.edu  http://casper.beckman.uiuc.edu/~c-tsai4
     #
     #  ---------------COPYING.libtabe-----END--------------------------------
     #
     #
     #  ---------------COPYING.ipadic-----BEGIN-------------------------------
     #
     #  Copyright 2000, 2001, 2002, 2003 Nara Institute of Science
     #  and Technology.  All Rights Reserved.
     #
     #  Use, reproduction, and distribution of this software is permitted.
     #  Any copy of this software, whether in its original form or modified,
     #  must include both the above copyright notice and the following
     #  paragraphs.
     #
     #  Nara Institute of Science and Technology (NAIST),
     #  the copyright holders, disclaims all warranties with regard to this
     #  software, including all implied warranties of merchantability and
     #  fitness, in no event shall NAIST be liable for
     #  any special, indirect or consequential damages or any damages
     #  whatsoever resulting from loss of use, data or profits, whether in an
     #  action of contract, negligence or other tortuous action, arising out
     #  of or in connection with the use or performance of this software.
     #
     #  A large portion of the dictionary entries
     #  originate from ICOT Free Software.  The following conditions for ICOT
     #  Free Software applies to the current dictionary as well.
     #
     #  Each User may also freely distribute the Program, whether in its
     #  original form or modified, to any third party or parties, PROVIDED
     #  that the provisions of Section 3 ("NO WARRANTY") will ALWAYS appear
     #  on, or be attached to, the Program, which is distributed substantially
     #  in the same form as set out herein and that such intended
     #  distribution, if actually made, will neither violate or otherwise
     #  contravene any of the laws and regulations of the countries having
     #  jurisdiction over the User or the intended distribution itself.
     #
     #  NO WARRANTY
     #
     #  The program was produced on an experimental basis in the course of the
     #  research and development conducted during the project and is provided
     #  to users as so produced on an experimental basis.  Accordingly, the
     #  program is provided without any warranty whatsoever, whether express,
     #  implied, statutory or otherwise.  The term "warranty" used herein
     #  includes, but is not limited to, any warranty of the quality,
     #  performance, merchantability and fitness for a particular purpose of
     #  the program and the nonexistence of any infringement or violation of
     #  any right of any third party.
     #
     #  Each user of the program will agree and understand, and be deemed to
     #  have agreed and understood, that there is no warranty whatsoever for
     #  the program and, accordingly, the entire risk arising from or
     #  otherwise connected with the program is assumed by the user.
     #
     #  Therefore, neither ICOT, the copyright holder, or any other
     #  organization that participated in or was otherwise related to the
     #  development of the program and their respective officials, directors,
     #  officers and other employees shall be held liable for any and all
     #  damages, including, without limitation, general, special, incidental
     #  and consequential damages, arising out of or otherwise in connection
     #  with the use or inability to use the program or any product, material
     #  or result produced or otherwise obtained by using the program,
     #  regardless of whether they have been advised of, or otherwise had
     #  knowledge of, the possibility of such damages at any time during the
     #  project or thereafter.  Each user will be deemed to have agreed to the
     #  foregoing by his or her commencement of use of the program.  The term
     #  "use" as used herein includes, but is not limited to, the use,
     #  modification, copying and distribution of the program and the
     #  production of secondary products from the program.
     #
     #  In the case where the program, whether in its original form or
     #  modified, was distributed or delivered to or received by a user from
     #  any person, organization or entity other than ICOT, unless it makes or
     #  grants independently of ICOT any specific warranty to the user in
     #  writing, such person, organization or entity, will also be exempted
     #  from and not be held liable to the user for any such damages as noted
     #  above as far as the program is concerned.
     #
     #  ---------------COPYING.ipadic-----END----------------------------------

    3. Lao Word Break Dictionary Data (laodict.txt)

     #  Copyright (c) 2013 International Business Machines Corporation
     #  and others. All Rights Reserved.
     #
     # Project: http://code.google.com/p/lao-dictionary/
     # Dictionary: http://lao-dictionary.googlecode.com/git/Lao-Dictionary.txt
     # License: http://lao-dictionary.googlecode.com/git/Lao-Dictionary-LICENSE.txt
     #              (copied below)
     #
     #  This file is derived from the above dictionary, with slight
     #  modifications.
     #  ----------------------------------------------------------------------
     #  Copyright (C) 2013 Brian Eugene Wilson, Robert Martin Campbell.
     #  All rights reserved.
     #
     #  Redistribution and use in source and binary forms, with or without
     #  modification,
     #  are permitted provided that the following conditions are met:
     #
     #
     # Redistributions of source code must retain the above copyright notice, this
     #  list of conditions and the following disclaimer. Redistributions in
     #  binary form must reproduce the above copyright notice, this list of
     #  conditions and the following disclaimer in the documentation and/or
     #  other materials provided with the distribution.
     #
     #
     # THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
     # "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
     # LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS
     # FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
     # COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
     # INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
     # (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
     # SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
     # HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
     # STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     # ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
     # OF THE POSSIBILITY OF SUCH DAMAGE.
     #  --------------------------------------------------------------------------

    4. Burmese Word Break Dictionary Data (burmesedict.txt)

     #  Copyright (c) 2014 International Business Machines Corporation
     #  and others. All Rights Reserved.
     #
     #  This list is part of a project hosted at:
     #    github.com/kanyawtech/myanmar-karen-word-lists
     #
     #  --------------------------------------------------------------------------
     #  Copyright (c) 2013, LeRoy Benjamin Sharon
     #  All rights reserved.
     #
     #  Redistribution and use in source and binary forms, with or without
     #  modification, are permitted provided that the following conditions
     #  are met: Redistributions of source code must retain the above
     #  copyright notice, this list of conditions and the following
     #  disclaimer.  Redistributions in binary form must reproduce the
     #  above copyright notice, this list of conditions and the following
     #  disclaimer in the documentation and/or other materials provided
     #  with the distribution.
     #
     #    Neither the name Myanmar Karen Word Lists, nor the names of its
     #    contributors may be used to endorse or promote products derived
     #    from this software without specific prior written permission.
     #
     #  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND
     #  CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
     #  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
     #  MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
     #  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS
     #  BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
     #  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
     #  TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
     #  DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
     #  ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR
     #  TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF
     #  THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
     #  SUCH DAMAGE.
     #  --------------------------------------------------------------------------

    5. Time Zone Database

      ICU uses the public domain data and code derived from Time Zone
    Database for its time zone support. The ownership of the TZ database
    is explained in BCP 175: Procedure for Maintaining the Time Zone
    Database section 7.

     # 7.  Database Ownership
     #
     #    The TZ database itself is not an IETF Contribution or an IETF
     #    document.  Rather it is a pre-existing and regularly updated work
     #    that is in the public domain, and is intended to remain in the
     #    public domain.  Therefore, BCPs 78 [RFC5378] and 79 [RFC3979] do
     #    not apply to the TZ Database or contributions that individuals make
     #    to it.  Should any claims be made and substantiated against the TZ
     #    Database, the organization that is providing the IANA
     #    Considerations defined in this RFC, under the memorandum of
     #    understanding with the IETF, currently ICANN, may act in accordance
     #    with all competent court orders.  No ownership claims will be made
     #    by ICANN or the IETF Trust on the database or the code.  Any person
     #    making a contribution to the database or code waives all rights to
     #    future claims in that contribution or in the TZ Database.

    6. Google double-conversion

    Copyright 2006-2011, the V8 project authors. All rights reserved.
    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

        * Redistributions of source code must retain the above copyright
          notice, this list of conditions and the following disclaimer.
        * Redistributions in binary form must reproduce the above
          copyright notice, this list of conditions and the following
          disclaimer in the documentation and/or other materials provided
          with the distribution.
        * Neither the name of Google Inc. nor the names of its
          contributors may be used to endorse or promote products derived
          from this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- libuv, located at deps/uv, is licensed as follows:
  """
    libuv is licensed for use as follows:

    == ==
    Copyright (c) 2015-present libuv project contributors.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.
    == ==

    This license applies to parts of libuv originating from the
    https://github.com/joyent/libuv repository:

    == ==

    Copyright Joyent, Inc. and other Node contributors. All rights reserved.
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.

    == ==

    This license applies to all parts of libuv that are not externally
    maintained libraries.

    The externally maintained libraries used by libuv are:

      - tree.h (from FreeBSD), copyright Niels Provos. Two clause BSD license.

      - inet_pton and inet_ntop implementations, contained in src/inet.c, are
        copyright the Internet Systems Consortium, Inc., and licensed under the ISC
        license.

      - stdint-msvc2008.h (from msinttypes), copyright Alexander Chemeris. Three
        clause BSD license.

      - pthread-fixes.c, copyright Google Inc. and Sony Mobile Communications AB.
        Three clause BSD license.

      - android-ifaddrs.h, android-ifaddrs.c, copyright Berkeley Software Design
        Inc, Kenneth MacKay and Emergya (Cloud4all, FP7/2007-2013, grant agreement
        n° 289016). Three clause BSD license.
  """

- llhttp, located at deps/llhttp, is licensed as follows:
  """
    This software is licensed under the MIT License.

    Copyright Fedor Indutny, 2018.

    Permission is hereby granted, free of charge, to any person obtaining a
    copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to permit
    persons to whom the Software is furnished to do so, subject to the
    following conditions:

    The above copyright notice and this permission notice shall be included
    in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
    OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
    NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
    OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
    USE OR OTHER DEALINGS IN THE SOFTWARE.
  """

- OpenSSL, located at deps/openssl, is licensed as follows:
  """
    Copyright (c) 1998-2019 The OpenSSL Project.  All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions
    are met:

    1. Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.

    2. Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in
    the documentation and/or other materials provided with the
    distribution.

    3. All advertising materials mentioning features or use of this
    software must display the following acknowledgment:
    "This product includes software developed by the OpenSSL Project
    for use in the OpenSSL Toolkit. (http://www.openssl.org/)"

    4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used to
    endorse or promote products derived from this software without
    prior written permission. For written permission, please contact
    openssl-core@openssl.org.

    5. Products derived from this software may not be called "OpenSSL"
    nor may "OpenSSL" appear in their names without prior written
    permission of the OpenSSL Project.

    6. Redistributions of any form whatsoever must retain the following
    acknowledgment:
    "This product includes software developed by the OpenSSL Project
    for use in the OpenSSL Toolkit (http://www.openssl.org/)"

    THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
    EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
    IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
    PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
    ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
    NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
    LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
    HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
    STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
    ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
    OF THE POSSIBILITY OF SUCH DAMAGE.
    == == == == == == == == == == == == == == == == == == == == == == == == == == == == == == == == == ==

    This product includes cryptographic software written by Eric Young
    (eay@cryptsoft.com).  This product includes software written by Tim
    Hudson (tjh@cryptsoft.com).
  """

- Punycode.js, located at lib/punycode.js, is licensed as follows:
  """
    Copyright Mathias Bynens &lt;https://mathiasbynens.be/&gt;

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
  """

- V8, located at deps/v8, is licensed as follows:
  """
    This license applies to all parts of V8 that are not externally
    maintained libraries.  The externally maintained libraries used by V8
    are:

      - PCRE test suite, located in
        test/mjsunit/third_party/regexp-pcre/regexp-pcre.js.  This is based on the
        test suite from PCRE-7.3, which is copyrighted by the University
        of Cambridge and Google, Inc.  The copyright notice and license
        are embedded in regexp-pcre.js.

      - Layout tests, located in test/mjsunit/third_party/object-keys.  These are
        based on layout tests from webkit.org which are copyrighted by
        Apple Computer, Inc. and released under a 3-clause BSD license.

      - Strongtalk assembler, the basis of the files assembler-arm-inl.h,
        assembler-arm.cc, assembler-arm.h, assembler-ia32-inl.h,
        assembler-ia32.cc, assembler-ia32.h, assembler-x64-inl.h,
        assembler-x64.cc, assembler-x64.h, assembler-mips-inl.h,
        assembler-mips.cc, assembler-mips.h, assembler.cc and assembler.h.
        This code is copyrighted by Sun Microsystems Inc. and released
        under a 3-clause BSD license.

      - Valgrind client API header, located at src/third_party/valgrind/valgrind.h
        This is released under the BSD license.

      - The Wasm C/C++ API headers, located at third_party/wasm-api/wasm.{h,hh}
        This is released under the Apache license. The API's upstream prototype
        implementation also formed the basis of V8's implementation in
        src/wasm/c-api.cc.

    These libraries have their own licenses; we recommend you read them,
    as their terms may differ from the terms below.

    Further license information can be found in LICENSE files located in
    sub-directories.

    Copyright 2014, the V8 project authors. All rights reserved.
    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

        * Redistributions of source code must retain the above copyright
          notice, this list of conditions and the following disclaimer.
        * Redistributions in binary form must reproduce the above
          copyright notice, this list of conditions and the following
          disclaimer in the documentation and/or other materials provided
          with the distribution.
        * Neither the name of Google Inc. nor the names of its
          contributors may be used to endorse or promote products derived
          from this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- SipHash, located at deps/v8/src/third_party/siphash, is licensed as follows:
  """
    SipHash reference C implementation

    Copyright (c) 2016 Jean-Philippe Aumasson &lt;jeanphilippe.aumasson@gmail.com&gt;

    To the extent possible under law, the author(s) have dedicated all
    copyright and related and neighboring rights to this software to the public
    domain worldwide. This software is distributed without any warranty.
  """

- zlib, located at deps/zlib, is licensed as follows:
  """
    zlib.h -- interface of the 'zlib' general purpose compression library
    version 1.2.11, January 15th, 2017

    Copyright (C) 1995-2017 Jean-loup Gailly and Mark Adler

    This software is provided 'as-is', without any express or implied
    warranty.  In no event will the authors be held liable for any damages
    arising from the use of this software.

    Permission is granted to anyone to use this software for any purpose,
    including commercial applications, and to alter it and redistribute it
    freely, subject to the following restrictions:

    1. The origin of this software must not be misrepresented; you must not
    claim that you wrote the original software. If you use this software
    in a product, an acknowledgment in the product documentation would be
    appreciated but is not required.
    2. Altered source versions must be plainly marked as such, and must not be
    misrepresented as being the original software.
    3. This notice may not be removed or altered from any source distribution.

    Jean-loup Gailly        Mark Adler
    jloup@gzip.org          madler@alumni.caltech.edu
  """

- npm, located at deps/npm, is licensed as follows:
  """
    The npm application
    Copyright (c) npm, Inc. and Contributors
    Licensed on the terms of The Artistic License 2.0

    Node package dependencies of the npm application
    Copyright (c) their respective copyright owners
    Licensed on their respective license terms

    The npm public registry at https://registry.npmjs.org
    and the npm website at https://www.npmjs.com
    Operated by npm, Inc.
    Use governed by terms published on https://www.npmjs.com

    "Node.js"
    Trademark Joyent, Inc., https://joyent.com
    Neither npm nor npm, Inc. are affiliated with Joyent, Inc.

    The Node.js application
    Project of Node Foundation, https://nodejs.org

    The npm Logo
    Copyright (c) Mathias Pettersson and Brian Hammond

    "Gubblebum Blocky" typeface
    Copyright (c) Tjarda Koster, https://jelloween.deviantart.com
    Used with permission

    --------

    The Artistic License 2.0

    Copyright (c) 2000-2006, The Perl Foundation.

    Everyone is permitted to copy and distribute verbatim copies
    of this license document, but changing it is not allowed.

    Preamble

    This license establishes the terms under which a given free software
    Package may be copied, modified, distributed, and/or redistributed.
    The intent is that the Copyright Holder maintains some artistic
    control over the development of that Package while still keeping the
    Package available as open source and free software.

    You are always permitted to make arrangements wholly outside of this
    license directly with the Copyright Holder of a given Package.  If the
    terms of this license do not permit the full use that you propose to
    make of the Package, you should contact the Copyright Holder and seek
    a different licensing arrangement.

    Definitions

        "Copyright Holder" means the individual(s) or organization(s)
        named in the copyright notice for the entire Package.

        "Contributor" means any party that has contributed code or other
        material to the Package, in accordance with the Copyright Holder's
        procedures.

        "You" and "your" means any person who would like to copy,
        distribute, or modify the Package.

        "Package" means the collection of files distributed by the
        Copyright Holder, and derivatives of that collection and/or of
        those files. A given Package may consist of either the Standard
        Version, or a Modified Version.

        "Distribute" means providing a copy of the Package or making it
        accessible to anyone else, or in the case of a company or
        organization, to others outside of your company or organization.

        "Distributor Fee" means any fee that you charge for Distributing
        this Package or providing support for this Package to another
        party.  It does not mean licensing fees.

        "Standard Version" refers to the Package if it has not been
        modified, or has been modified only in ways explicitly requested
        by the Copyright Holder.

        "Modified Version" means the Package, if it has been changed, and
        such changes were not explicitly requested by the Copyright
        Holder.

        "Original License" means this Artistic License as Distributed with
        the Standard Version of the Package, in its current version or as
        it may be modified by The Perl Foundation in the future.

        "Source" form means the source code, documentation source, and
        configuration files for the Package.

        "Compiled" form means the compiled bytecode, object code, binary,
        or any other form resulting from mechanical transformation or
        translation of the Source form.

    Permission for Use and Modification Without Distribution

    (1)  You are permitted to use the Standard Version and create and use
    Modified Versions for any purpose without restriction, provided that
    you do not Distribute the Modified Version.

    Permissions for Redistribution of the Standard Version

    (2)  You may Distribute verbatim copies of the Source form of the
    Standard Version of this Package in any medium without restriction,
    either gratis or for a Distributor Fee, provided that you duplicate
    all of the original copyright notices and associated disclaimers.  At
    your discretion, such verbatim copies may or may not include a
    Compiled form of the Package.

    (3)  You may apply any bug fixes, portability changes, and other
    modifications made available from the Copyright Holder.  The resulting
    Package will still be considered the Standard Version, and as such
    will be subject to the Original License.

    Distribution of Modified Versions of the Package as Source

    (4)  You may Distribute your Modified Version as Source (either gratis
    or for a Distributor Fee, and with or without a Compiled form of the
    Modified Version) provided that you clearly document how it differs
    from the Standard Version, including, but not limited to, documenting
    any non-standard features, executables, or modules, and provided that
    you do at least ONE of the following:

        (a)  make the Modified Version available to the Copyright Holder
        of the Standard Version, under the Original License, so that the
        Copyright Holder may include your modifications in the Standard
        Version.

        (b)  ensure that installation of your Modified Version does not
        prevent the user installing or running the Standard Version. In
        addition, the Modified Version must bear a name that is different
        from the name of the Standard Version.

        (c)  allow anyone who receives a copy of the Modified Version to
        make the Source form of the Modified Version available to others
        under

            (i)  the Original License or

            (ii)  a license that permits the licensee to freely copy,
            modify and redistribute the Modified Version using the same
            licensing terms that apply to the copy that the licensee
            received, and requires that the Source form of the Modified
            Version, and of any works derived from it, be made freely
            available in that license fees are prohibited but Distributor
            Fees are allowed.

    Distribution of Compiled Forms of the Standard Version
    or Modified Versions without the Source

    (5)  You may Distribute Compiled forms of the Standard Version without
    the Source, provided that you include complete instructions on how to
    get the Source of the Standard Version.  Such instructions must be
    valid at the time of your distribution.  If these instructions, at any
    time while you are carrying out such distribution, become invalid, you
    must provide new instructions on demand or cease further distribution.
    If you provide valid instructions or cease distribution within thirty
    days after you become aware that the instructions are invalid, then
    you do not forfeit any of your rights under this license.

    (6)  You may Distribute a Modified Version in Compiled form without
    the Source, provided that you comply with Section 4 with respect to
    the Source of the Modified Version.

    Aggregating or Linking the Package

    (7)  You may aggregate the Package (either the Standard Version or
    Modified Version) with other packages and Distribute the resulting
    aggregation provided that you do not charge a licensing fee for the
    Package.  Distributor Fees are permitted, and licensing fees for other
    components in the aggregation are permitted. The terms of this license
    apply to the use and Distribution of the Standard or Modified Versions
    as included in the aggregation.

    (8) You are permitted to link Modified and Standard Versions with
    other works, to embed the Package in a larger work of your own, or to
    build stand-alone binary or bytecode versions of applications that
    include the Package, and Distribute the result without restriction,
    provided the result does not expose a direct interface to the Package.

    Items That are Not Considered Part of a Modified Version

    (9) Works (including, but not limited to, modules and scripts) that
    merely extend or make use of the Package, do not, by themselves, cause
    the Package to be a Modified Version.  In addition, such works are not
    considered parts of the Package itself, and are not subject to the
    terms of this license.

    General Provisions

    (10)  Any use, modification, and distribution of the Standard or
    Modified Versions is governed by this Artistic License. By using,
    modifying or distributing the Package, you accept this license. Do not
    use, modify, or distribute the Package, if you do not accept this
    license.

    (11)  If your Modified Version has been derived from a Modified
    Version made by someone other than you, you are nevertheless required
    to ensure that your Modified Version complies with the requirements of
    this license.

    (12)  This license does not grant you the right to use any trademark,
    service mark, tradename, or logo of the Copyright Holder.

    (13)  This license includes the non-exclusive, worldwide,
    free-of-charge patent license to make, have made, use, offer to sell,
    sell, import and otherwise transfer the Package with respect to any
    patent claims licensable by the Copyright Holder that are necessarily
    infringed by the Package. If you institute patent litigation
    (including a cross-claim or counterclaim) against any party alleging
    that the Package constitutes direct or contributory patent
    infringement, then this Artistic License to you shall terminate on the
    date that such litigation is filed.

    (14)  Disclaimer of Warranty:
    THE PACKAGE IS PROVIDED BY THE COPYRIGHT HOLDER AND CONTRIBUTORS "AS
    IS' AND WITHOUT ANY EXPRESS OR IMPLIED WARRANTIES. THE IMPLIED
    WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, OR
    NON-INFRINGEMENT ARE DISCLAIMED TO THE EXTENT PERMITTED BY YOUR LOCAL
    LAW. UNLESS REQUIRED BY LAW, NO COPYRIGHT HOLDER OR CONTRIBUTOR WILL
    BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, OR CONSEQUENTIAL
    DAMAGES ARISING IN ANY WAY OUT OF THE USE OF THE PACKAGE, EVEN IF
    ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

    --------
  """

- GYP, located at tools/gyp, is licensed as follows:
  """
    Copyright (c) 2009 Google Inc. All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

       * Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.
       * Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.
       * Neither the name of Google Inc. nor the names of its
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- inspector_protocol, located at tools/inspector_protocol, is licensed as follows:
  """
    // Copyright 2016 The Chromium Authors. All rights reserved.
    //
    // Redistribution and use in source and binary forms, with or without
    // modification, are permitted provided that the following conditions are
    // met:
    //
    //    * Redistributions of source code must retain the above copyright
    // notice, this list of conditions and the following disclaimer.
    //    * Redistributions in binary form must reproduce the above
    // copyright notice, this list of conditions and the following disclaimer
    // in the documentation and/or other materials provided with the
    // distribution.
    //    * Neither the name of Google Inc. nor the names of its
    // contributors may be used to endorse or promote products derived from
    // this software without specific prior written permission.
    //
    // THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    // "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    // LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    // A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    // OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    // SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    // LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    // DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    // THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    // (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    // OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- jinja2, located at tools/inspector_protocol/jinja2, is licensed as follows:
  """
    Copyright (c) 2009 by the Jinja Team, see AUTHORS for more details.

    Some rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

        * Redistributions of source code must retain the above copyright
          notice, this list of conditions and the following disclaimer.

        * Redistributions in binary form must reproduce the above
          copyright notice, this list of conditions and the following
          disclaimer in the documentation and/or other materials provided
          with the distribution.

        * The names of the contributors may not be used to endorse or
          promote products derived from this software without specific
          prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- markupsafe, located at tools/inspector_protocol/markupsafe, is licensed as follows:
  """
    Copyright (c) 2010 by Armin Ronacher and contributors.  See AUTHORS
    for more details.

    Some rights reserved.

    Redistribution and use in source and binary forms of the software as well
    as documentation, with or without modification, are permitted provided
    that the following conditions are met:

    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.

    * Redistributions in binary form must reproduce the above
      copyright notice, this list of conditions and the following
      disclaimer in the documentation and/or other materials provided
      with the distribution.

    * The names of the contributors may not be used to endorse or
      promote products derived from this software without specific
      prior written permission.

    THIS SOFTWARE AND DOCUMENTATION IS PROVIDED BY THE COPYRIGHT HOLDERS AND
    CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT
    NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER
    OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
    EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
    PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
    PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
    LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    SOFTWARE AND DOCUMENTATION, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
    DAMAGE.
  """

- cpplint.py, located at tools/cpplint.py, is licensed as follows:
  """
    Copyright (c) 2009 Google Inc. All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

       * Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.
       * Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.
       * Neither the name of Google Inc. nor the names of its
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- ESLint, located at tools/node_modules/eslint, is licensed as follows:
  """
    Copyright JS Foundation and other contributors, https://js.foundation

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE.
  """

- babel-eslint, located at tools/node_modules/babel-eslint, is licensed as follows:
  """
    Copyright (c) 2014-2016 Sebastian McKenzie &lt;sebmck@gmail.com&gt;

    MIT License

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
  """

- gtest, located at test/cctest/gtest, is licensed as follows:
  """
    Copyright 2008, Google Inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

        * Redistributions of source code must retain the above copyright
    notice, this list of conditions and the following disclaimer.
        * Redistributions in binary form must reproduce the above
    copyright notice, this list of conditions and the following disclaimer
    in the documentation and/or other materials provided with the
    distribution.
        * Neither the name of Google Inc. nor the names of its
    contributors may be used to endorse or promote products derived from
    this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  """

- nghttp2, located at deps/nghttp2, is licensed as follows:
  """
    The MIT License

    Copyright (c) 2012, 2014, 2015, 2016 Tatsuhiro Tsujikawa
    Copyright (c) 2012, 2014, 2015, 2016 nghttp2 contributors

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
  """

- node-inspect, located at deps/node-inspect, is licensed as follows:
  """
    Copyright Node.js contributors. All rights reserved.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.
  """

- large_pages, located at src/large_pages, is licensed as follows:
  """
     Copyright (C) 2018 Intel Corporation

     Permission is hereby granted, free of charge, to any person obtaining a copy
     of this software and associated documentation files (the "Software"),
     to deal in the Software without restriction, including without limitation
     the rights to use, copy, modify, merge, publish, distribute, sublicense,
     and/or sell copies of the Software, and to permit persons to whom
     the Software is furnished to do so, subject to the following conditions:

     The above copyright notice and this permission notice shall be included
     in all copies or substantial portions of the Software.

     THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
     OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
     FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL
     THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES
     OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
     ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE
     OR OTHER DEALINGS IN THE SOFTWARE.
  """

- caja, located at lib/internal/freeze_intrinsics.js, is licensed as follows:
  """
     Adapted from SES/Caja - Copyright (C) 2011 Google Inc.
     Copyright (C) 2018 Agoric

     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License.
  """

- brotli, located at deps/brotli, is licensed as follows:
  """
    Copyright (c) 2009, 2010, 2013-2016 by the Brotli Authors.

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
    THE SOFTWARE.
  """

- HdrHistogram, located at deps/histogram, is licensed as follows:
  """
    The code in this repository code was Written by Gil Tene, Michael Barker,
    and Matt Warren, and released to the public domain, as explained at
    http://creativecommons.org/publicdomain/zero/1.0/

    For users of this code who wish to consume it under the "BSD" license
    rather than under the public domain or CC0 contribution text mentioned
    above, the code found under this directory is *also* provided under the
    following license (commonly referred to as the BSD 2-Clause License). This
    license does not detract from the above stated release of the code into
    the public domain, and simply represents an additional license granted by
    the Author.

    -----------------------------------------------------------------------------
    ** Beginning of "BSD 2-Clause License" text. **

     Copyright (c) 2012, 2013, 2014 Gil Tene
     Copyright (c) 2014 Michael Barker
     Copyright (c) 2014 Matt Warren
     All rights reserved.

     Redistribution and use in source and binary forms, with or without
     modification, are permitted provided that the following conditions are met:

     1. Redistributions of source code must retain the above copyright notice,
        this list of conditions and the following disclaimer.

     2. Redistributions in binary form must reproduce the above copyright notice,
        this list of conditions and the following disclaimer in the documentation
        and/or other materials provided with the distribution.

     THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
     AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
     IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
     ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
     LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
     CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
     SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
     INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
     CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
     ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
     THE POSSIBILITY OF SUCH DAMAGE.
  """

- node-heapdump, located at src/heap_utils.cc, is licensed as follows:
  """
    ISC License

    Copyright (c) 2012, Ben Noordhuis &lt;info@bnoordhuis.nl&gt;

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted, provided that the above
    copyright notice and this permission notice appear in all copies.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
    WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
    MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
    ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
    WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
    ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
    OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

    == src/compat.h src/compat-inl.h == =

    ISC License

    Copyright (c) 2014, StrongLoop Inc.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted, provided that the above
    copyright notice and this permission notice appear in all copies.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
    WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
    MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
    ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
    WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
    ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
    OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
  """

- rimraf, located at lib/internal/fs/rimraf.js, is licensed as follows:
  """
    The ISC License

    Copyright (c) Isaac Z. Schlueter and Contributors

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted, provided that the above
    copyright notice and this permission notice appear in all copies.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
    WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
    MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
    ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
    WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
    ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR
    IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
  """

- uvwasi, located at deps/uvwasi, is licensed as follows:
  """
    MIT License

    Copyright (c) 2019 Colin Ihrig and Contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.
  """</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="microsoft-software-license-terms"><a class="anchor" href="#microsoft-software-license-terms"></a>MICROSOFT SOFTWARE LICENSE TERMS</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>MICROSOFT VISUAL STUDIO CODE

These license terms are an agreement between you and Microsoft Corporation (or based on where you live, one of its affiliates). They apply to the software named above. The terms also apply to any Microsoft services or updates for the software, except to the extent those have different terms.

IF YOU COMPLY WITH THESE LICENSE TERMS, YOU HAVE THE RIGHTS BELOW.

    1. INSTALLATION AND USE RIGHTS.
        a. General. You may use any number of copies of the software to develop and test your applications, including deployment within your internal corporate network.
        b. Demo use. The uses permitted above include use of the software in demonstrating your applications.
        c. Third Party Components. The software may include third party components with separate legal notices or governed by other agreements, as may be described in the ThirdPartyNotices file accompanying the software.
        d. Extensions. The software gives you the option to download other Microsoft and third party software packages from our extension marketplace or package managers. Those packages are under their own licenses, and not this agreement. Microsoft does not distribute, license or provide any warranties for any of the third party packages. By accessing or using our extension marketplace, you agree to the extension marketplace terms located at https://aka.ms/vsmarketplace-ToU.
    2. DATA.
        a. Data Collection. The software may collect information about you and your use of the software, and send that to Microsoft. Microsoft may use this information to provide services and improve our products and services. You may opt-out of many of these scenarios, but not all, as described in the product documentation located at https://code.visualstudio.com/docs/supporting/faq#_how-to-disable-telemetry-reporting. There may also be some features in the software that may enable you and Microsoft to collect data from users of your applications. If you use these features, you must comply with applicable law, including providing appropriate notices to users of your applications together with Microsoft’s privacy statement. Our privacy statement is located at https://go.microsoft.com/fwlink/?LinkID=824704. You can learn more about data collection and use in the help documentation and our privacy statement. Your use of the software operates as your consent to these practices.
        c. Processing of Personal Data. To the extent Microsoft is a processor or subprocessor of personal data in connection with the software, Microsoft makes the commitments in the European Union General Data Protection Regulation Terms of the Online Services Terms to all customers effective May 25, 2018, at https://go.microsoft.com/?linkid=9840733.
    3. UPDATES. The software may periodically check for updates and download and install them for you. You may obtain updates only from Microsoft or authorized sources. Microsoft may need to update your system to provide you with updates. You agree to receive these automatic updates without any additional notice. Updates may not include or support all existing software features, services, or peripheral devices. If you do not want automatic updates, you may turn them off by following the instructions in the documentation at https://go.microsoft.com/fwlink/?LinkID=616397.
    4. FEEDBACK. If you give feedback about the software to Microsoft, you give to Microsoft, without charge, the right to use, share and commercialize your feedback in any way and for any purpose. You will not give feedback that is subject to a license that requires Microsoft to license its software or documentation to third parties because we include your feedback in them. These rights survive this agreement.
    5. SCOPE OF LICENSE. This license applies to the Visual Studio Code product. Source code for Visual Studio Code is available at https://github.com/Microsoft/vscode under the MIT license agreement. The software is licensed, not sold. This agreement only gives you some rights to use the software. Microsoft reserves all other rights. Unless applicable law gives you more rights despite this limitation, you may use the software only as expressly permitted in this agreement. In doing so, you must comply with any technical limitations in the software that only allow you to use it in certain ways. You may not
        reverse engineer, decompile or disassemble the software, or otherwise attempt to derive the source code for the software except and solely to the extent required by third party licensing terms governing use of certain open source components that may be included in the software;
        remove, minimize, block or modify any notices of Microsoft or its suppliers in the software;
        use the software in any way that is against the law;
        share, publish, rent or lease the software, or provide the software as a stand-alone offering for others to use.
    6. SUPPORT SERVICES. Because this software is “as is,” we may not provide support services for it.
    7. ENTIRE AGREEMENT. This agreement, and the terms for supplements, updates, Internet-based services and support services that you use, are the entire agreement for the software and support services.
    8. EXPORT RESTRICTIONS. You must comply with all domestic and international export laws and regulations that apply to the software, which include restrictions on destinations, end-users, and end use. For further information on export restrictions, see https://www.microsoft.com/exporting.
    9. APPLICABLE LAW. If you acquired the software in the United States, Washington law applies to interpretation of and claims for breach of this agreement, and the laws of the state where you live apply to all other claims. If you acquired the software in any other country, its laws apply.
    10. CONSUMER RIGHTS; REGIONAL VARIATIONS. This agreement describes certain legal rights. You may have other rights, including consumer rights, under the laws of your state or country. Separate and apart from your relationship with Microsoft, you may also have rights with respect to the party from which you acquired the software. This agreement does not change those other rights if the laws of your state or country do not permit it to do so. For example, if you acquired the software in one of the below regions, or mandatory country law applies, then the following provisions apply to you:
        a. Australia. You have statutory guarantees under the Australian Consumer Law and nothing in this agreement is intended to affect those rights.
        b. Canada. If you acquired this software in Canada, you may stop receiving updates by turning off the automatic update feature, disconnecting your device from the Internet (if and when you re-connect to the Internet, however, the software will resume checking for and installing updates), or uninstalling the software. The product documentation, if any, may also specify how to turn off updates for your specific device or software.
        c. Germany and Austria.
            Warranty. The properly licensed software will perform substantially as described in any Microsoft materials that accompany the software. However, Microsoft gives no contractual guarantee in relation to the licensed software.
            Limitation of Liability. In case of intentional conduct, gross negligence, claims based on the Product Liability Act, as well as, in case of death or personal or physical injury, Microsoft is liable according to the statutory law.

        Subject to the foregoing clause (ii), Microsoft will only be liable for slight negligence if Microsoft is in breach of such material contractual obligations, the fulfillment of which facilitate the due performance of this agreement, the breach of which would endanger the purpose of this agreement and the compliance with which a party may constantly trust in (so-called "cardinal obligations"). In other cases of slight negligence, Microsoft will not be liable for slight negligence.
    11. DISCLAIMER OF WARRANTY. The software is licensed “as-is.” You bear the risk of using it. Microsoft gives no express warranties, guarantees or conditions. To the extent permitted under your local laws, Microsoft excludes the implied warranties of merchantability, fitness for a particular purpose and non-infringement.

    12. LIMITATION ON AND EXCLUSION OF DAMAGES. You can recover from Microsoft and its suppliers only direct damages up to U.S. $5.00. You cannot recover any other damages, including consequential, lost profits, special, indirect or incidental damages.

    This limitation applies to (a) anything related to the software, services, content (including code) on third party Internet sites, or third party applications; and (b) claims for breach of contract, breach of warranty, guarantee or condition, strict liability, negligence, or other tort to the extent permitted by applicable law.

    It also applies even if Microsoft knew or should have known about the possibility of the damages. The above limitation or exclusion may not apply to you because your state or country may not allow the exclusion or limitation of incidental, consequential or other damages.</code></pre>
</div>
</div>
<div class="paragraph">
<p>==Java</p>
</div>
<div class="paragraph">
<p>The devonfw community
${project.version}, ${buildtime}</p>
</div>
<div class="paragraph">
<p><a href="http://www.devonfw.com/"><em>devonfw</em></a> provides a solution to building applications which combine best-in-class frameworks and libraries as well as industry proven practices and code conventions.
It massively speeds up development, reduces risks and helps you to deliver better results.</p>
</div>
<div class="paragraph">
<p>The following sections contain the complete compendium of <a href="https://github.com/devonfw/devon4j/">devon4j</a>, the Java stack of devonfw.
With devon4j we support both <a href="spring">spring</a> and <a href="quarkus">quarkus</a> as major frameworks.
However, the general coding patterns are based on common Java standards mainly from <a href="https://jakarta.ee">Jakarta EE</a> and therefore do not differ between those frameworks.
Therefore, the <a href="#general">general</a> section contains all the documentation that is universal to Java and does not differ between the two frameworks.
Only the sections <a href="spring">spring</a> and <a href="quarkus">quarkus</a> contain documentation that is specific to the respective approach.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re trying to decide which of the two frameworks to use, have a look at <a href="decision-between-Spring-and-Quarkus">this guide</a>.</p>
</div>
<div class="paragraph">
<p>You can also read the latest version of this documentation online at the following sources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4j/wiki">devon4j on github wiki</a></p>
</li>
<li>
<p><a href="https://devonfw.com/website/pages/docs/devon4j.adoc.html">devon4j on devonfw.com</a>.</p>
</li>
<li>
<p><a href="https://repository.sonatype.org/service/local/artifact/maven/redirect?r=central-proxy&amp;g=com.devonfw.java.doc&amp;a=devon4j-doc&amp;v=LATEST&amp;p=pdf">devon4j as PDF on maven-central</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="general"><a class="anchor" href="#general"></a>1. General</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here you will find documentation and code-patterns for developing with Java in general, independent of the framework you choose.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Architecture</p>
</div>
<div class="paragraph">
<p>There are many different views that are summarized by the term <em>architecture</em>. First, we will introduce the <a href="#key-principles">key principles</a> and <a href="#architecture-principles">architecture principles</a> of devonfw. Then, we will go into details of the the <a href="#application-architecture">architecture of an application</a>.</p>
</div>
<div class="sect3">
<h4 id="key-principles"><a class="anchor" href="#key-principles"></a>1.1. Key Principles</h4>
<div class="paragraph">
<p>For devonfw we follow these fundamental key principles for all decisions about architecture, design, or choosing standards, libraries, and frameworks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>KISS</strong><br>
Keep it small and simple</p>
</li>
<li>
<p><strong>Open</strong><br>
Commitment to open standards and solutions (no required dependencies to commercial or vendor-specific standards or solutions)</p>
</li>
<li>
<p><strong>Patterns</strong><br>
We concentrate on providing patterns, best-practices and examples rather than writing framework code.</p>
</li>
<li>
<p><strong>Solid</strong><br>
We pick solutions that are established and have been proven to be solid and robust in real-live (business) projects.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="architecture-principles"><a class="anchor" href="#architecture-principles"></a>1.2. Architecture Principles</h4>
<div class="paragraph">
<p>Additionally we define the following principles that our architecture is based on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Component Oriented Design</strong><br>
We follow a strictly component oriented design to address the following sub-principles:</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://en.wikipedia.org/wiki/Separation_of_concerns">Separation of Concerns</a></p>
</li>
<li>
<p><a href="http://en.wikipedia.org/wiki/Reusability">Reusability</a> and avoiding <a href="http://en.wikipedia.org/wiki/Redundant_code">redundant code</a></p>
</li>
<li>
<p><a href="http://en.wikipedia.org/wiki/Information_hiding">Information Hiding</a> via component API and its exchangeable implementation treated as secret.</p>
</li>
<li>
<p><em>Design by Contract</em> for self-contained, descriptive, and stable component APIs.</p>
</li>
<li>
<p><a href="#technical-architecture">Layering</a> as well as separation of business logic from technical code for better maintenance.</p>
</li>
<li>
<p><em>Data Sovereignty</em> (and <em>high cohesion with low coupling</em>) says that a component is responsible for its data and changes to this data shall only happen via the component. Otherwise, maintenance problems will arise to ensure that data remains consistent. Therefore, interfaces of a component that may be used by other components are designed <em>call-by-value</em> and not <em>call-by-reference</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Homogeneity</strong><br>
Solve similar problems in similar ways and establish a uniform <a href="coding-conventions">code-style</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As an architect you should be prepared for the future by reading the <a href="https://www.capgemini.com/de-de/wp-content/uploads/sites/5/2020/07/TechnoVision-2020-Report.pdf">TechnoVision</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="application-architecture"><a class="anchor" href="#application-architecture"></a>1.3. Application Architecture</h4>
<div class="paragraph">
<p>For the architecture of an application we distinguish the following views:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="#business-architecture">Business Architecture</a> describes an application from the business perspective. It divides the application into business components and with full abstraction of technical aspects.</p>
</li>
<li>
<p>The <a href="#technical-architecture">Technical Architecture</a> describes an application from the technical implementation perspective. It divides the application into technical layers and defines which technical products and frameworks are used to support these layers.</p>
</li>
<li>
<p>The Infrastructure Architecture describes an application from the operational infrastructure perspective. It defines the nodes used to run the application including clustering, load-balancing and networking. This view is not explored further in this guide.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="business-architecture"><a class="anchor" href="#business-architecture"></a>Business Architecture</h5>
<div class="paragraph">
<p>The <em>business architecture</em> divides the application into <em>business components</em>. A business component has a well-defined responsibility that it encapsulates. All aspects related to that responsibility have to be implemented within that business component. Further, the business architecture defines the dependencies between the business components. These dependencies need to be free of cycles. A business component exports its functionality via well-defined interfaces as a self-contained API. A business component may use another business component via its API and compliant with the dependencies defined by the business architecture.</p>
</div>
<div class="paragraph">
<p>As the business domain and logic of an application can be totally different, the devonfw can not define a standardized business architecture. Depending on the business domain it has to be defined from scratch or from a domain reference architecture template. For very small systems it may be suitable to define just a single business component containing all the code.</p>
</div>
</div>
<div class="sect4">
<h5 id="technical-architecture"><a class="anchor" href="#technical-architecture"></a>Technical Architecture</h5>
<div class="paragraph">
<p>The <em>technical architecture</em> divides the application into technical <em>layers</em> based on the <a href="http://en.wikipedia.org/wiki/Multilayered_architecture">multilayered architecture</a>. A layer is a unit of code with the same category such as a service or presentation logic. So, a layer is often supported by a technical framework. Each business component can therefore be split into <em>component parts</em> for each layer. However, a business component may not have component parts for every layer (e.g. only a presentation part that utilized logic from other components).</p>
</div>
<div class="paragraph">
<p>An overview of the technical reference architecture of the devonfw is given by <a href="#img-t-architecture">figure "Technical Reference Architecture"</a>.
It defines the following layers visualized as horizontal boxes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-client-layer">client layer</a> for the front-end (GUI).</p>
</li>
<li>
<p><a href="guide-service-layer">service layer</a> for the services used to expose functionality of the
back-end to the client or other consumers.</p>
</li>
<li>
<p><a href="guide-batch-layer">batch layer</a> for exposing functionality in batch-processes (e.g. mass imports).</p>
</li>
<li>
<p><a href="guide-logic-layer">logic layer</a> for the business logic.</p>
</li>
<li>
<p><a href="guide-domain-layer">domain layer</a> for the data access, especially persistence (in the <a href="guide-structure-classic">classic project structure</a> this layer is named <a href="guide-dataaccess-layer">data-access layer</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also, you can see the (business) components as vertical boxes (e.g. <em>A</em> and <em>X</em>) and how they are composed out of component parts each one assigned to one of the technical layers.</p>
</div>
<div class="paragraph">
<p>Further, there are technical components for cross-cutting aspects grouped by the gray box on the left. Here is a complete list:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-security">Security</a></p>
</li>
<li>
<p><a href="guide-logging">Logging</a></p>
</li>
<li>
<p><a href="guide-monitoring">Monitoring</a></p>
</li>
<li>
<p><a href="guide-transactions">Transaction-Handling</a></p>
</li>
<li>
<p><a href="guide-exceptions">Exception-Handling</a></p>
</li>
<li>
<p><a href="guide-i18n">Internationalization</a></p>
</li>
<li>
<p><a href="guide-dependency-injection">Dependency-Injection</a></p>
</li>
</ul>
</div>
<div id="img-t-architecture" class="imageblock text-center">
<div class="content">
<a class="image" href="https://devonfw.com/website/pages/docs/images/T-Architecture.svg"><img src="_images/images/T-Architecture.png" alt="devonfw architecture blueprint"></a>
</div>
<div class="title">Figure 5. Technical Reference Architecture</div>
</div>
<div class="paragraph">
<p>Please click on the architecture image to open it as SVG and click on the layers and cross-cutting topics to open the according documentation guide.</p>
</div>
<div class="paragraph">
<p>We reflect this architecture in our code as described in our <a href="coding-conventions#packages">coding conventions</a> allowing a traceability of business components, use-cases, layers, etc. into the code and giving
developers a sound orientation within the project.</p>
</div>
<div class="paragraph">
<p>Further, the architecture diagram shows the allowed dependencies illustrated by the dark green connectors.
Within a business component a component part can call the next component part on the layer directly below via a dependency on its API (vertical connectors).
While this is natural and obvious, it is generally forbidden to have dependencies upwards the layers
or to skip a layer by a direct dependency on a component part two or more layers below.
The general dependencies allowed between business components are defined by the <a href="#business-architecture">business architecture</a>.
In our reference architecture diagram we assume that the business component <code>A1</code> is allowed to depend
on component <code>A2</code>. Therefore, a use-case within the logic component part of <code>A1</code> is allowed to call a
use-case from <code>A2</code> via a dependency on the component API. The same applies for dialogs on the client layer.
This is illustrated by the horizontal connectors. Please note that <a href="guide-jpa#entity">persistence entities</a> are part of the API of the data-access component part so only the logic component part of the same
business component may depend on them.</p>
</div>
<div class="paragraph">
<p>The technical architecture has to address non-functional requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>scalability</strong><br>
is established by keeping state in the client and making the server state-less (except for login session). Via load-balancers new server nodes can be added to improve performance (horizontal scaling).</p>
</li>
<li>
<p><strong>availability</strong> and <strong>reliability</strong><br>
are addressed by clustering with redundant nodes avoiding any single-point-of failure. If one node fails the system is still available. Further, the software has to be robust so there are no dead-locks or other bad effects that can make the system unavailable or not reliable.</p>
</li>
<li>
<p><strong>security</strong><br>
is archived in the devonfw by the right templates and best-practices that avoid vulnerabilities. See <a href="guide-security">security guidelines</a> for further details.</p>
</li>
<li>
<p><strong>performance</strong><br>
is obtained by choosing the right products and proper configurations. While the actual implementation of the application matters for performance a proper design is important as it is the key to allow performance-optimizations (see e.g. <a href="guide-caching">caching</a>).</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="technology-stack"><a class="anchor" href="#technology-stack"></a>Technology Stack</h6>
<div class="paragraph">
<p>The technology stack of the devonfw is illustrated by the following table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Technology Stack of devonfw</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Topic</strong></th>
<th class="tableblock halign-left valign-top"><strong>Detail</strong></th>
<th class="tableblock halign-left valign-top"><strong>Standard</strong></th>
<th class="tableblock halign-left valign-top"><strong>Suggested implementation</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">runtime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">language &amp; VM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oracle JDK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">runtime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">servlet-container</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JEE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://tomcat.apache.org/">tomcat</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-dependency-injection">component management</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dependency injection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://jcp.org/en/jsr/detail?id=330">JSR330</a> &amp; <a href="https://jcp.org/en/jsr/detail?id=250">JSR250</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://spring.io/">spring</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-configuration">configuration</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://projects.spring.io/spring-boot/">spring-boot</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-domain-layer">persistence</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OR-mapper</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javaee/tech/persistence-jsp-140049.html">JPA</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://hibernate.org/orm/">hibernate</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-batch-layer">batch</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://jcp.org/en/jsr/detail?id=352">JSR352</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://projects.spring.io/spring-batch/">spring-batch</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-service-layer">service</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-soap">SOAP services</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://jcp.org/en/jsr/detail?id=224">JAX-WS</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://cxf.apache.org/">CXF</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-service-layer">service</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-rest">REST services</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://jax-rs-spec.java.net/">JAX-RS</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://cxf.apache.org/">CXF</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-logging">logging</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.slf4j.org/">slf4j</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://logback.qos.ch/">logback</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-validation">validation</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://beanvalidation.org/">beanvalidation/JSR303</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://hibernate.org/validator/">hibernate-validator</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-security">security</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication &amp; Authorization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/jaas/index.html">JAAS</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://projects.spring.io/spring-security/">spring-security</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-monitoring">monitoring</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/tech/javamanagement-140525.html">JMX</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://spring.io/">spring</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-monitoring">monitoring</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP Bridge</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTTP &amp; JSON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.jolokia.org">jolokia</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-aop">AOP</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/reflect/Proxy.html">dynamic proxies</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://docs.spring.io/autorepo/docs/spring/3.0.6.RELEASE/spring-framework-reference/html/aop.html">spring AOP</a></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Configuration</p>
</div>
<div class="paragraph">
<p>An application needs to be configurable in order to allow internal setup (like CDI) but also to allow externalized configuration of a deployed package (e.g. integration into runtime environment). We rely on a comprehensive configuration approach following a "convention over configuration" pattern. This guide adds on to this by detailed instructions and best-practices how to deal with configurations.</p>
</div>
<div class="paragraph">
<p>In general we distinguish the following kinds of configuration that are explained in the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#internal-application-configuration">Internal Application configuration</a> maintained by developers</p>
</li>
<li>
<p><a href="#externalized-configuration">Externalized Environment configuration</a> maintained by operators</p>
</li>
<li>
<p><a href="#business-configuration">Externalized Business configuration</a> maintained by business administrators</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="internal-application-configuration"><a class="anchor" href="#internal-application-configuration"></a>1.4. Internal Application Configuration</h4>
<div class="paragraph">
<p>The application configuration contains all internal settings and wirings of the application (bean wiring, database mappings, etc.) and is maintained by the application developers at development time.</p>
</div>
<div class="paragraph">
<p>For more detail of <a href="spring">Spring</a> stack, see <a href="spring/guide-spring-configuration#internal-application-configuration">here</a></p>
</div>
</div>
<div class="sect3">
<h4 id="externalized-configuration"><a class="anchor" href="#externalized-configuration"></a>1.5. Externalized Configuration</h4>
<div class="paragraph">
<p>Externalized configuration is a configuration that is provided separately to a deployment package and can be maintained undisturbed by re-deployments.</p>
</div>
<div class="sect4">
<h5 id="environment-configuration"><a class="anchor" href="#environment-configuration"></a>Environment Configuration</h5>
<div class="paragraph">
<p>The environment configuration contains configuration parameters (typically port numbers, host names, passwords, logins, timeouts, certificates, etc.) specific for the different environments. These are under the control of the operators responsible for the application.</p>
</div>
<div class="paragraph">
<p>The environment configuration is maintained in <code>application.properties</code> files, defining various properties.
These properties are explained in the corresponding configuration sections of the guides for each topic:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>persistence configuration (for Spring see <a href="spring/guide-spring-configuration#database-configuration">here</a>, for Quarkus see <a href="quarkus/guide-quarkus-configuration#database-configuration">here</a>)</p>
</li>
<li>
<p><a href="guide-service-layer#jax-rs-configuration">service configuration</a></p>
</li>
<li>
<p><a href="guide-logging#configuration">logging guide</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Make sure your properties are thoroughly documented by providing a comment to each property. This inline documentation is most valuable for your operating department.</p>
</div>
<div class="paragraph">
<p>More about structuring your <code>application.properties</code> files can be read <a href="spring/guide-spring-configuration#application-properties-files">here</a> for Spring.</p>
</div>
<div class="paragraph">
<p>For Quarkus, please refer to <a href="https://quarkus.io/guides/config-reference">Quarkus Config Reference</a> for more details.</p>
</div>
</div>
<div class="sect4">
<h5 id="business-configuration"><a class="anchor" href="#business-configuration"></a>Business Configuration</h5>
<div class="paragraph">
<p>Often applications do not need business configuration. In case they do it should typically be editable by administrators via the GUI. The business configuration values should therefore be stored in the database in key/value pairs.</p>
</div>
<div class="paragraph">
<p>Therefore we suggest to create a dedicated table with (at least) the following columns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ID</p>
</li>
<li>
<p>Property name</p>
</li>
<li>
<p>Property type (Boolean, Integer, String)</p>
</li>
<li>
<p>Property value</p>
</li>
<li>
<p>Description</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>According to the entries in this table, an administrative GUI may show a generic form to modify business configuration. Boolean values should be shown as checkboxes, integer and string values as text fields. The values should be validated according to their type so an error is raised if you try to save a string in an integer property for example.</p>
</div>
<div class="paragraph">
<p>We recommend the following base layout for the hierarchical business configuration:</p>
</div>
<div class="paragraph">
<p><code>component.[subcomponent].[subcomponent].propertyname</code></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="security"><a class="anchor" href="#security"></a>1.6. Security</h4>
<div class="paragraph">
<p>Often you need to have passwords (for databases, third-party services, etc.) as part of your configuration. These are typically environment specific (see above). However, with DevOps and continuous-deployment you might be tempted to commit such configurations into your version-control (e.g. <code>git</code>). Doing that with plain text passwords is a severe problem especially for production systems. Never do that! Instead we offer some suggestions how to deal with sensible configurations:</p>
</div>
<div class="sect4">
<h5 id="password-encryption"><a class="anchor" href="#password-encryption"></a>Password Encryption</h5>
<div class="paragraph">
<p>A simple but reasonable approach is to configure the passwords encrypted with a master-password. The master-password should be a strong secret that is specific for each environment. It must never be committed to version-control.</p>
</div>
<div class="paragraph">
<p>For <a href="spring">Spring</a>, we use <a href="https://github.com/ulisesbocchio/jasypt-spring-boot#jasypt-spring-boot">jasypt-spring-boot</a>. For more details, see <a href="spring/guide-spring-configuration#password-encryption">here</a></p>
</div>
<div class="paragraph">
<p>For <a href="quarkus">Quarkus</a>, see <a href="quarkus/guide-quarkus-configuration#password-encryption">here</a></p>
</div>
<div class="sect5">
<h6 id="is-this-security-by-obscurity"><a class="anchor" href="#is-this-security-by-obscurity"></a>Is this Security by Obscurity?</h6>
<div class="ulist">
<ul>
<li>
<p>Yes, from the point of view to protect the passwords on the target environment this is nothing but security by obscurity. If an attacker somehow got full access to the machine this will only cause him to spend some more time.</p>
</li>
<li>
<p>No, if someone only gets the configuration file. So all your developers might have access to the version-control where the config is stored. Others might have access to the software releases that include this configs. But without the master-password that should only be known to specific operators none else can decrypt the password (except with brute-force what will take a very long time, see jasypt for details).</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Coding Conventions</p>
</div>
<div class="paragraph">
<p>The code should follow general conventions for Java (see <a href="http://www.oracle.com/technetwork/java/namingconventions-139351.html">Oracle Naming Conventions</a>, <a href="https://google.github.io/styleguide/javaguide.html">Google Java Style</a>, etc.).We consider this as common sense and provide configurations for <a href="http://www.sonarqube.org/">SonarQube</a> and related tools such as <a href="http://checkstyle.sourceforge.net/">Checkstyle</a> instead of repeating this here.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="naming"><a class="anchor" href="#naming"></a>1.7. Naming</h4>
<div class="paragraph">
<p>Besides general Java naming conventions, we follow the additional rules listed here explicitly:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Always use short but speaking names (for types, methods, fields, parameters, variables, constants, etc.).</p>
</li>
<li>
<p>Strictly avoid special characters in technical names (for files, types, fields, methods, properties, variables, database tables, columns, constraints, etc.). In other words only use Latin alpahnumeric ASCII characters with the common allowed technical separators for the accordign context (e.g. underscore) for technical names (even excluding whitespaces).</p>
</li>
<li>
<p>For package segments and type names prefer singular forms (<code>CustomerEntity</code> instead of <code class="line-through">CustomersEntity</code>). Only use plural forms when there is no singular or it is really semantically required (e.g. for a container that contains multiple of such objects).</p>
</li>
<li>
<p>Avoid having duplicate type names. The name of a class, interface, enum or annotation should be unique within your project unless this is intentionally desired in a special and reasonable situation.</p>
</li>
<li>
<p>Avoid artificial naming constructs such as prefixes (<code>I*</code>) or suffixes (<code>*IF</code>) for interfaces.</p>
</li>
<li>
<p>Use CamelCase even for abbreviations (<code>XmlUtil</code> instead of <code class="line-through">XMLUtil</code>)</p>
</li>
<li>
<p>Avoid property/field names where the second character is upper-case at all (e.g. 'aBc'). See <a href="https://github.com/devonfw/cobigen/issues/1095">#1095</a> for details.</p>
</li>
<li>
<p>Names of Generics should be easy to understand. Where suitable follow the common rule <code>E=Element</code>, <code>T=Type</code>, <code>K=Key</code>, <code>V=Value</code> but feel free to use longer names for more specific cases such as <code>ID</code>, <code>DTO</code> or <code>ENTITY</code>. The capitalized naming helps to distinguish a generic type from a regular class.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="packages"><a class="anchor" href="#packages"></a>1.8. Packages</h4>
<div class="paragraph">
<p>Java Packages are the most important element to structure your code. We use a strict packaging convention to map technical layers and business components (slices) to the code (See <a href="architecture#technical-architecture">technical architecture</a> for further details). By using the same names in documentation and code we create a strong link that gives orientation and makes it easy to find from business requirements, specifications or story tickets into the code and back.</p>
</div>
<div class="paragraph">
<p>For an devon4j based application we use the following Java-Package schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>«root».«component».«layer»[.«detail»]</code></pre>
</div>
</div>
<div class="paragraph">
<p>E.g. in our example application we find the Spring Data repositories for the <code>ordermanagement</code> component in the package <code>com.devonfw.application.mtsj.ordermanagement.dataaccess.api.repo</code></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Segments of package schema</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Segment</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Example</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«root»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is the basic Java Package name-space of your app. Typically we suggest to use <code>«group».«artifact»</code> where <code>«group»</code> is your maven/gradle <code>groupId</code> corresponding to your organization or IT project owning the code following common Java Package conventions. The segment <code>«artifact»</code> is your maven/gradle <code>artifactId</code> and is typically the technical name of your app.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.devonfw.application.mtsj</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«component»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The (business) component the code belongs to. It is defined by the business architecture and uses terms from the business domain. Use the implicit component <code>general</code> for code not belonging to a specific component (foundation code).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>salesmanagement</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«layer»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the technical layer (See <a href="architecture">technical architecture</a>). Details are described for the <a href="guide-structure-modern#layers">modern project structure</a> and for the <a href="guide-structure-classic#layers">classic project structure</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logic</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«detail»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Here you are free to further divide your code into sub-components and other concerns according to the size of your component part. If you want to strictly separate API from implementation you should start <code>«detail»</code> with <code>«scope»</code> that is explained below.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dao</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«scope»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The scope which is one of <code>api</code> (official API to be used by other layers or components), <code>base</code> (basic code to be reused by other implementations) and <code>impl</code> (implementation that should never be imported from outside). This segment was initially mandatory but due to trends such as microservices, lean, and agile we decided to make it optional and do not force anybody to use it.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>api</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Please note that <code>devon4j</code> library modules for spring use <code>com.devonfw.module</code> as <code>«root»</code> and the name of the module as <code>«component»</code>. E.g. the API of our <code>beanmapping</code> module can be found in the package <code>com.devonfw.module.beanmapping.common.api</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="code-tasks"><a class="anchor" href="#code-tasks"></a>1.9. Code Tasks</h4>
<div class="paragraph">
<p>Code spots that need some rework can be marked with the following tasks tags. These are already properly pre-configured in your development environment for auto completion and to view tasks you are responsible for. It is important to keep the number of code tasks low. Therefore, every member of the team should be responsible for the overall code quality. So if you change a piece of code and hit a code task that you can resolve in a reliable way, please do this as part of your change and remove the according tag.</p>
</div>
<div class="sect4">
<h5 id="todo"><a class="anchor" href="#todo"></a>TODO</h5>
<div class="paragraph">
<p>Used to mark a piece of code that is not yet complete (typically because it can not be completed due to a dependency on something that is not ready).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java"> // TODO «author» «description»</code></pre>
</div>
</div>
<div class="paragraph">
<p>A TODO tag is added by the author of the code who is also responsible for completing this task.</p>
</div>
</div>
<div class="sect4">
<h5 id="fixme"><a class="anchor" href="#fixme"></a>FIXME</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java"> // FIXME «author» «description»</code></pre>
</div>
</div>
<div class="paragraph">
<p>A FIXME tag is added by the author of the code or someone who found a bug he can not fix right now. The «author» who added the FIXME is also responsible for completing this task. This is very similar to a TODO but with a higher priority. FIXME tags indicate problems that should be resolved before a release is completed while TODO tags might have to stay for a longer time.</p>
</div>
</div>
<div class="sect4">
<h5 id="review"><a class="anchor" href="#review"></a>REVIEW</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java"> // REVIEW «responsible» («reviewer») «description»</code></pre>
</div>
</div>
<div class="paragraph">
<p>A REVIEW tag is added by a reviewer during a code review. Here the original author of the code is responsible to resolve the REVIEW tag and the reviewer is assigning this task to him. This is important for feedback and learning and has to be aligned with a review "process" where people talk to each other and get into discussion. In smaller or local teams a peer-review is preferable but this does not scale for large or even distributed teams.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="code-documentation"><a class="anchor" href="#code-documentation"></a>1.10. Code-Documentation</h4>
<div class="paragraph">
<p>As a general goal, the code should be easy to read and understand. Besides, clear naming the documentation is important. We follow these rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>APIs (especially component interfaces) are properly documented with JavaDoc.</p>
</li>
<li>
<p>JavaDoc shall provide actual value - we do not write JavaDoc to satisfy tools such as checkstyle but to express information not already available in the signature.</p>
</li>
<li>
<p>We make use of <code>{@link}</code> tags in JavaDoc to make it more expressive.</p>
</li>
<li>
<p>JavaDoc of APIs describes how to use the type or method and not how the implementation internally works.</p>
</li>
<li>
<p>To document implementation details, we use code comments (e.g. <code>// we have to flush explicitly to ensure version is up-to-date</code>). This is only needed for complex logic.</p>
</li>
<li>
<p>Avoid the pointless <code>{@inheritDoc}</code> as since Java 1.5 there is the <code>@Override</code> annotation for overridden methods and your JavaDoc is inherited automatically even without any JavaDoc comment at all.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="code-style"><a class="anchor" href="#code-style"></a>1.11. Code-Style</h4>
<div class="paragraph">
<p>This section gives you best practices to write better code and avoid pitfalls and mistakes.</p>
</div>
<div class="sect4">
<h5 id="blobs"><a class="anchor" href="#blobs"></a>BLOBs</h5>
<div class="paragraph">
<p>Avoid using <code>byte[]</code> for BLOBs as this will load them entirely into your memory. This will cause performance issues or out of memory errors. Instead, use streams when dealing with BLOBs. For further details see <a href="guide-blob-support">BLOB support</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="stateless-programming"><a class="anchor" href="#stateless-programming"></a>Stateless Programming</h5>
<div class="paragraph">
<p>When implementing logic as components or <em>beans</em> of your container using <a href="guide-dependency-injection">dependency injection</a>, we strongly encourage stateless programming.
This is not about data objects like an <a href="guide-jpa#entity">entity</a> or <a href="guide-transferobject">transfer-object</a> that are stateful by design.
Instead this applies to all classes annotated with <code>@Named</code>, <code>@ApplicationScoped</code>, <code>@Stateless</code>, etc. and all their super-classes.
These classes especially include your <a href="guide-repository">repositories</a>, <a href="guide-usecase">use-cases</a>, and <a href="guide-rest#jax-rs">REST services</a>.
Such classes shall never be modified after initialization.
Methods called at runtime (after initialization via the container) do not assign fields (member variables of your class) or mutate the object stored in a field.
This allows your component or bean to be stateless and thread-safe.
Therefore it can be initialized as a singleton so only one instance is created and shared accross all threads of the application.
Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
@Named
public class UcApproveContractImpl implements UcApproveContract {

  // bad
  private String contractOwner;

  private MyState state;

  @Overide
  public void approve(Contract contract) {
    this.contractOwner = contract.getOwner();
    this.contractOwner = this.contractOwner.toLowerCase(Locale.US);
    this.state.setAdmin(this.contractOwner.endsWith("admin"));
    if (this.state.isAdmin()) {
      ...
    } else {
      ...
    }
  }

  // fine
  @Overide
  public void approveContract(Contract contract) {
    String contractOwner = contract.getOwner().toLowerCase(Locale.US);
    if (contractOwner.endsWith("admin")) {
      ...
    } else {
      ...
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see in the <code>bad</code> code fields of the class are assigned when the method <code>approve</code> is called.
So mutliple users and therefore threads calling this method concurrently can interfere and override this state causing side-effects on parallel threads.
This will lead to nasty bugs and errors that are hard to trace down.
They will not occur in simple tests but for sure in production with real users.
Therefore <strong>never</strong> do this and implement your functionality stateless.
That is keeping all state in local variables and strictly avoid modifying fields or their value as illustrated in the <code>fine</code> code.
If you find yourself passing many parameters between methods that all represent state, you can easily create a separate class that encapsulates this state.
However, then you need to create this state object in your method as local variable and pass it between methods as parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
@Named
public class UcApproveContractImpl implements UcApproveContract {

  // fine
  @Overide
  public void approveContract(Contract contract) {
    String contractOwner = contract.getOwner().toLowerCase(Locale.US);
    MyState state = new MyState();
    state.setAdmin(this.contractOwner.endsWith("admin"));
    doApproveContract(contract, state);
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="closing-resources"><a class="anchor" href="#closing-resources"></a>Closing Resources</h5>
<div class="paragraph">
<p>Resources such as streams (<code>InputStream</code>, <code>OutputStream</code>, <code>Reader</code>, <code>Writer</code>) or transactions need to be handled properly. Therefore, it is important to follow these rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each resource has to be closed properly, otherwise you will get out of file handles, TX sessions, memory leaks or the like</p>
</li>
<li>
<p>Where possible avoid to deal with such resources manually. That is why we are recommending <code>@Transactional</code> for transactions in devonfw (see <a href="guide-transactions">Transaction Handling</a>).</p>
</li>
<li>
<p>In case you have to deal with resources manually (e.g. binary streams) ensure to close them properly. See the example below for details.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Closing streams and other such resources is error prone. Have a look at the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// bad
try {
  InputStream in = new FileInputStream(file);
  readData(in);
  in.close();
} catch (IOException e) {
  throw new IllegalStateException("Failed to read data.", e);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code above is wrong as in case of an <code>IOException</code> the <code>InputStream</code> is not properly closed. In a server application such mistakes can cause severe errors that typically will only occur in production. As such resources implement the <code>AutoCloseable</code> interface you can use the <code>try-with-resource</code> syntax to write correct code. The following code shows a correct version of the example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// fine
try (InputStream in = new FileInputStream(file)) {
  readData(in);
} catch (IOException e) {
  throw new IllegalStateException("Failed to read data.", e);
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="catching-and-handling-exceptions"><a class="anchor" href="#catching-and-handling-exceptions"></a>Catching and handling Exceptions</h5>
<div class="paragraph">
<p>When catching exceptions always ensure the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Never call <code>printStackTrace()</code> method on an exception</p>
</li>
<li>
<p>Either log or wrap and re-throw the entire catched exception. Be aware that the cause(s) of an exception is very valuable information. If you loose such information by improper exception-handling you may be unable to properly analyse production problems what can cause severe issues.</p>
<div class="ulist">
<ul>
<li>
<p>If you wrap and re-throw an exception ensure that the catched exception is passed as cause to the newly created and thrown exception.</p>
</li>
<li>
<p>If you log an exception ensure that the entire exception is passed as argument to the logger (and not only the result of <code>getMessage()</code> or <code>toString()</code> on the exception).</p>
</li>
</ul>
</div>
</li>
<li>
<p>See <a href="guide-exceptions#handling-exceptions">exception handling</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="lambdas-and-streams"><a class="anchor" href="#lambdas-and-streams"></a>Lambdas and Streams</h5>
<div class="paragraph">
<p>With Java8 you have cool new features like lambdas and monads like (<code>Stream</code>, <code>CompletableFuture</code>, <code>Optional</code>, etc.).
However, these new features can also be misused or led to code that is hard to read or debug. To avoid pain, we give you the following best practices:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Learn how to use the new features properly before using. Developers are often keen on using cool new features. When you do your first experiments in your project code you will cause deep pain and might be ashamed afterwards. Please study the features properly. Even Java8 experts still write for loops to iterate over collections, so only use these features where it really makes sense.</p>
</li>
<li>
<p>Streams shall only be used in fluent API calls as a Stream can not be forked or reused.</p>
</li>
<li>
<p>Each stream has to have exactly one terminal operation.</p>
</li>
<li>
<p>Do not write multiple statements into lambda code:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// bad
collection.stream().map(x -&gt; {
Foo foo = doSomething(x);
...
return foo;
}).collect(Collectors.toList());</code></pre>
</div>
</div>
<div class="paragraph">
<p>This style makes the code hard to read and debug. Never do that! Instead, extract the lambda body to a private method with a meaningful name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// fine
collection.stream().map(this::convertToFoo).collect(Collectors.toList());</code></pre>
</div>
</div>
</li>
<li>
<p>Do not use <code>parallelStream()</code> in general code (that will run on server side) unless you know exactly what you are doing and what is going on under the hood. Some developers might think that using parallel streams is a good idea as it will make the code faster. However, if you want to do performance optimizations talk to your technical lead (architect). Many features such as security and transactions will rely on contextual information that is associated with the current thread. Hence, using parallel streams will most probably cause serious bugs. Only use them for standalone (CLI) applications or for code that is just processing large amounts of data.</p>
</li>
<li>
<p>Do not perform operations on a sub-stream inside a lambda:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">set.stream().flatMap(x -&gt; x.getChildren().stream().filter(this::isSpecial)).collect(Collectors.toList()); // bad
set.stream().flatMap(x -&gt; x.getChildren().stream()).filter(this::isSpecial).collect(Collectors.toList()); // fine</code></pre>
</div>
</div>
</li>
<li>
<p>Only use <code>collect</code> at the end of the stream:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">set.stream().collect(Collectors.toList()).forEach(...) // bad
set.stream().peek(...).collect(Collectors.toList()) // fine</code></pre>
</div>
</div>
</li>
<li>
<p>Lambda parameters with Types inference</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">(String a, Float b, Byte[] c) -&gt; a.toString() + Float.toString(b) + Arrays.toString(c)  // bad
(a,b,c)  -&gt; a.toString() + Float.toString(b) + Arrays.toString(c)  // fine

Collections.sort(personList, (Person p1, Person p2) -&gt; p1.getSurName().compareTo(p2.getSurName()));  // bad
Collections.sort(personList, (p1, p2) -&gt; p1.getSurName().compareTo(p2.getSurName()));  // fine</code></pre>
</div>
</div>
</li>
<li>
<p>Avoid Return Braces and Statement</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java"> a -&gt;  { return a.toString(); } // bad
 a -&gt;  a.toString();   // fine</code></pre>
</div>
</div>
</li>
<li>
<p>Avoid Parentheses with Single Parameter</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">(a) -&gt; a.toString(); // bad
 a -&gt; a.toString();  // fine</code></pre>
</div>
</div>
</li>
<li>
<p>Avoid if/else inside foreach method. Use Filter method &amp; comprehension</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// bad
static public Iterator&lt;String&gt; TwitterHandles(Iterator&lt;Author&gt; authors, string company) {
    final List result = new ArrayList&lt;String&gt; ();
    foreach (Author a : authors) {
      if (a.Company.equals(company)) {
        String handle = a.TwitterHandle;
        if (handle != null)
          result.Add(handle);
      }
    }
    return result;
  }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// fine
public List&lt;String&gt; twitterHandles(List&lt;Author&gt; authors, String company) {
    return authors.stream()
            .filter(a -&gt; null != a &amp;&amp; a.getCompany().equals(company))
            .map(a -&gt; a.getTwitterHandle())
            .collect(toList());
  }</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="optionals"><a class="anchor" href="#optionals"></a>Optionals</h5>
<div class="paragraph">
<p>With <code>Optional</code> you can wrap values to avoid a <code>NullPointerException</code> (NPE). However, it is not a good code-style to use <code>Optional</code> for every parameter or result to express that it may be null. For such case use <code>@Nullable</code> or even better instead annotate <code>@NotNull</code> where <code>null</code> is not acceptable.</p>
</div>
<div class="paragraph">
<p>However, <code>Optional</code> can be used to prevent NPEs in fluent calls (due to the lack of the elvis operator):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Long id;
id = fooCto.getBar().getBar().getId(); // may cause NPE
id = Optional.ofNullable(fooCto).map(FooCto::getBar).map(BarCto::getBar).map(BarEto::getId).orElse(null); // null-safe</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="encoding"><a class="anchor" href="#encoding"></a>Encoding</h5>
<div class="paragraph">
<p>Encoding (esp. Unicode with combining characters and surrogates) is a complex topic. Please study this topic if you have to deal with encodings and processing of special characters. For the basics follow these recommendations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Whenever possible prefer unicode (UTF-8 or better) as encoding. This especially impacts your databases and has to be defined upfront as it typically can not be changed (easily) afterwards.</p>
</li>
<li>
<p>Do not cast from <code>byte</code> to <code>char</code> (unicode characters can be composed of multiple bytes, such cast may only work for ASCII characters)</p>
</li>
<li>
<p>Never convert the case of a String using the default locale (esp. when writing generic code like in devonfw). E.g. if you do <code>"HI".toLowerCase()</code> and your system locale is Turkish, then the output will be "hı" instead of "hi", which can lead to wrong assumptions and serious problems. If you want to do a "universal" case conversion always explicitly use an according western locale (e.g. <code>toLowerCase(Locale.US)</code>). Consider using a helper class (see e.g. <a href="https://github.com/m-m-m/base/blob/master/core/src/main/java/io/github/mmm/base/text/CaseHelper.java">CaseHelper</a>) or create your own little static utility for that in your project.</p>
</li>
<li>
<p>Write your code independent from the default encoding (system property <code>file.encoding</code>) - this will most likely differ in JUnit from production environment</p>
<div class="ulist">
<ul>
<li>
<p>Always provide an encoding when you create a <code>String</code> from <code>byte[]</code>: <code>new String(bytes, encoding)</code></p>
</li>
<li>
<p>Always provide an encoding when you create a <code>Reader</code> or <code>Writer</code> : <code>new InputStreamReader(inStream, encoding)</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="prefer-general-api"><a class="anchor" href="#prefer-general-api"></a>Prefer general API</h5>
<div class="paragraph">
<p>Avoid unnecessary strong bindings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Do not bind your code to implementations such as <code>Vector</code> or <code>ArrayList</code> instead of <code>List</code></p>
</li>
<li>
<p>In APIs for input (=parameters) always consider to make little assumptions:</p>
<div class="ulist">
<ul>
<li>
<p>prefer <code>Collection</code> over <code>List</code> or <code>Set</code> where the difference does not matter (e.g. only use <code>Set</code> when you require uniqueness or highly efficient <code>contains</code>)</p>
</li>
<li>
<p>consider preferring <code>Collection&lt;? extends Foo&gt;</code> over <code>Collection&lt;Foo&gt;</code> when <code>Foo</code> is an interface or super-class</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="prefer-primitive-boolean"><a class="anchor" href="#prefer-primitive-boolean"></a>Prefer primitive boolean</h5>
<div class="paragraph">
<p>Unless in rare cases where you need to allow a flag being <code>null</code> avoid using the object type <code>Boolean</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// bad
public Boolean isEmpty {
  return size() == 0;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead always use the primitive <code>boolean</code> type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// fine
public boolean isEmpty {
  return size() == 0;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The only known excuse is for flags in <a href="guide-jpa#embeddable">embeddable types</a> due to limitations of hibernate.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Project structure</p>
</div>
<div class="paragraph">
<p>In devonfw we want to give clear structure and guidance for building applications.
This also allows tools such as <a href="https://github.com/devonfw/cobigen">CobiGen</a> or <a href="https://github.com/devonfw/sonar-devon4j-plugin/">sonar-devon4j-plugin</a> to "understand" the code.
Also this helps developers going from one devonfw project to the next one to quickly understand the code-base.
If every developer knows where to find what, the project gets more efficient.
A long time ago maven standardized the project structure with <code>src/main/java</code>, etc. and turned chaos into structure.
With devonfw we experienced the same for the codebase (what is inside <code>src/main/java</code>).</p>
</div>
<div class="paragraph">
<p>We initially started <code>devon4j</code> based on spring and spring-boot and proposed a <a href="guide-structure-classic">classic project structure</a>.
With modern cloud-native trends we added a <a href="guide-structure-modern">modern project structure</a>, that is more lean and up-to-date with the latest market trends.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Dependency Injection
Dependency injection is one of the most important design patterns and is a key principle to a modular and component based architecture.
The Java Standard for dependency injection is <a href="http://docs.oracle.com/javaee/6/api/javax/inject/package-summary.html">javax.inject (JSR330)</a> that we use in combination with <a href="http://docs.oracle.com/javaee/5/api/javax/annotation/package-summary.html">JSR250</a>.
Additionally, for scoping you can use CDI (Context and Dependency Injection) from <a href="https://jcp.org/en/jsr/detail?id=365">JSR365</a>.</p>
</div>
<div class="paragraph">
<p>There are many frameworks which support this standard including all recent Java EE application servers.
Therefore in devonfw we rely on these open standards and can propagate patterns and code examples that work independent from the underlying frameworks.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="key-principles-2"><a class="anchor" href="#key-principles-2"></a>1.12. Key Principles</h4>
<div class="paragraph">
<p>Within dependency injection a <em>bean</em> is typically a reusable unit of your application providing an encapsulated functionality.
This <em>bean</em> can be injected into other beans and it should in general be replaceable.
As an example we can think of a <a href="guide-usecase">use-case</a>, a <a href="guide-repository">repository</a>, etc.
As best practice we use the following principles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Stateless implementation</strong><br>
By default such beans shall be implemented <a href="coding-conventions#stateless-programming">stateless</a>. If you store state information in member variables you can easily run into concurrency problems and nasty bugs. This is easy to avoid by using local variables and separate state classes for complex state-information. Try to avoid stateful beans wherever possible. Only add state if you are fully aware of what you are doing and properly document this as a warning in your JavaDoc.</p>
</li>
<li>
<p><strong>Usage of Java standards</strong><br>
We use common standards (see above) that makes our code portable. Therefore we use standardized annotations like <code>@Inject</code> (<code>javax.inject.Inject</code>) instead of proprietary annotations such as <code>@Autowired</code>. Generally we avoid proprietary annotations in business code (<a href="guide-logic-layer">logic layer</a>).</p>
</li>
<li>
<p><strong>Simple injection-style</strong><br>
In general you can choose between constructor, setter or field injection. For simplicity we recommend to do private field injection as it is very compact and easy to maintain. We believe that constructor injection is bad for maintenance especially in case of inheritance (if you change the dependencies you need to refactor all sub-classes). Private field injection and public setter injection are very similar but setter injection is much more verbose (often you are even forced to have javadoc for all public methods). If you are writing re-usable library code setter injection will make sense as it is more flexible. In a business application you typically do not need that and can save a lot of boiler-plate code if you use private field injection instead. Nowadays you are using container infrastructure also for your tests (see <a href="guide-testing">testing</a>) so there is no need to inject manually (what would require a public setter).</p>
</li>
<li>
<p><strong>KISS</strong><br>
To follow the KISS (keep it small and simple) principle we avoid advanced features (e.g. custom <a href="guide-aop">AOP</a>, non-singleton beans) and only use them where necessary.</p>
</li>
<li>
<p><strong>Separation of API and implementation</strong><br>
For important components we should separate a self-contained API documented with JavaDoc from its implementation. Code from other components that wants to use the implementation shall only rely on the API. However, for things that will never be exchanged no API as interface is required you can skip such separation.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="example-bean"><a class="anchor" href="#example-bean"></a>1.13. Example Bean</h4>
<div class="paragraph">
<p>Here you can see the implementation of an example bean using dependency injection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
@Named("MyComponent")
public class MyComponentImpl implements MyComponent {
  @Inject
  private MyOtherComponent myOtherComponent;

  @PostConstruct
  public void init() {
    // initialization if required (otherwise omit this method)
  }

  @PreDestroy
  public void dispose() {
    // shutdown bean, free resources if required (otherwise omit this method)
  }

  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here <code>MyComponentImpl</code> depends on <code>MyOtherComponent</code> that is injected into the field <code>myOtherComponent</code> because of the <code>@Inject</code> annotation.
To make this work there must be exactly one bean in the container (e.g. <a href="spring">spring</a> or <a href="quarkus">quarkus</a>) that is an instance of <code>MyOtherComponent</code>.
In order to put a bean into the container, we can use <code>@ApplicationScoped</code> in case of CDI (required for quarkus) for a stateless bean.
In spring we can ommit a CDI annotation and the <code>@Named</code> annotation is already sufficient as a bean is stateless by default in spring.
If we always use <code>@ApplicationScoped</code> we can make this more explicit and more portable accross different frameworks.
So in our example we put <code>MyComponentImpl</code> into the container.
That bean will be called <code>MyComponent</code> as we specified in the <code>@Named</code> annotation but we can also omit the name to use the classname as fallback.
Now our bean can be injected into other beans using <code>@Inject</code> annotation either via <code>MyComponent</code> interface (recommended when interface is present) or even directly via <code>MyComponentImpl</code>.
In case you omit the interface, you should also omit the <code>Impl</code> suffix or instead use <code>Bean</code> as suffix.</p>
</div>
</div>
<div class="sect3">
<h4 id="multiple-bean-implementations"><a class="anchor" href="#multiple-bean-implementations"></a>1.14. Multiple bean implementations</h4>
<div class="paragraph">
<p>In some cases you might have multiple implementations as beans for the same interface.
The following sub-sections handle the different scenarios to give you guidance.</p>
</div>
<div class="sect4">
<h5 id="only-one-implementation-in-container"><a class="anchor" href="#only-one-implementation-in-container"></a>Only one implementation in container</h5>
<div class="paragraph">
<p>In some cases you still have only one implementation active as bean in the container at runtime.
A typical example is that you have different implemenations for test and main usage.
This case is easy, as <code>@Inject</code> will always be unique.
The only thing you need to care about is how to configure your framework (spring, quarkus, etc.) to know which implementation to put in the container depending on specific configuration.
In spring this can be archived via the proprietary <code>@Profile</code> annotaiton.</p>
</div>
</div>
<div class="sect4">
<h5 id="injecting-all-of-multiple-implementations"><a class="anchor" href="#injecting-all-of-multiple-implementations"></a>Injecting all of multiple implementations</h5>
<div class="paragraph">
<p>In some situations you may have an interface that defines a kind of "plugin".
You can have multiple implementations in your container and want to have all of them injected.
Then you can request a list with all the bean implementations via the interface as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Inject
  private List&lt;MyConverter&gt; converters;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your code may iterate over all plugins (converters) and apply them sequentially.
Please note that the injection will fail (at least in spring), when there is no bean available to inject.
So you do not get an empty list injected but will get an exception on startup.</p>
</div>
</div>
<div class="sect4">
<h5 id="injecting-one-of-multiple-implementations"><a class="anchor" href="#injecting-one-of-multiple-implementations"></a>Injecting one of multiple implementations</h5>
<div class="paragraph">
<p>Another scenario is that you have multiple implementations in your container coexisting, but for injection you may want to choose a specific implementation.
Here you could use the <code>@Named</code> annotation to specify a unique identifier for each implementation what is called qualified injection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
@Named("UserAuthenticator")
public class UserAuthenticator implements Authenticator {
  ...
}
@ApplicationScoped
@Named("ServiceAuthenticator")
public class ServiceAuthenticator implements Authenticator {
  ...
}
public class MyUserComponent {
  @Inject
  @Named("UserAuthenticator")
  private Authenticator authenticator;
  ...
}
public class MyServiceComponent {
  @Inject
  @Named("ServiceAuthenticator")
  private Authenticator authenticator;
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, we discovered that this pattern is not so great:
The identifiers in the <code>@Named</code> annotation are just strings that could easily break.
You could use constants instead but still this is not the best solution.</p>
</div>
<div class="paragraph">
<p>In the end you can very much simplify this by just directly injecting the implementation instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class UserAuthenticator implements Authenticator {
  ...
}
@ApplicationScoped
public class ServiceAuthenticator implements Authenticator {
  ...
}
public class MyUserComponent {
  @Inject
  private UserAuthenticator authenticator;
  ...
}
public class MyServiceComponent {
  @Inject
  private ServiceAuthenticator authenticator;
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In case you want to strictly decouple from implementations, you can still create dedicated interfaces:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface UserAuthenticator extends Authenticator {}
@ApplicationScoped
public class UserAuthenticatorImpl implements UserAuthenticator {
  ...
}
public interface ServiceAuthenticator extends Authenticator {}
@ApplicationScoped
public class ServiceAuthenticatorImpl implements ServiceAuthenticator {
  ...
}
public class MyUserComponent {
  @Inject
  private UserAuthenticator authenticator;
  ...
}
public class MyServiceComponent {
  @Inject
  private ServiceAuthenticator authenticator;
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, as you can see this is again introducing additional boiler-plate code.
While the principle to separate API and implementation and strictly decouple from implementation is valuable in general,
you should always consider KISS, lean, and agile in contrast and balance pros and cons instead of blindly following dogmas.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="imports"><a class="anchor" href="#imports"></a>1.15. Imports</h4>
<div class="paragraph">
<p>Here are the import statements for the most important annotations for dependency injection</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import javax.inject.Inject;
import javax.inject.Named;
import javax.enterprise.context.ApplicationScoped;
// import javax.enterprise.context.RequestScoped;
// import javax.enterprise.context.SessionScoped;
import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dependencies"><a class="anchor" href="#dependencies"></a>1.16. Dependencies</h4>
<div class="paragraph">
<p>Please note that with <a href="https://jakarta.ee/">Jakarta EE</a> the dependencies have changed.
When you want to start with Jakarta EE you should use these dependencies to get the annoations for dependency injection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;!-- Basic injection annotations (JSR-330) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;jakarta.inject&lt;/groupId&gt;
  &lt;artifactId&gt;jakarta.inject-api&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- Basic lifecycle and security annotations (JSR-250)--&gt;
&lt;dependency&gt;
  &lt;groupId&gt;jakarta.annotation&lt;/groupId&gt;
  &lt;artifactId&gt;jakarta.annotation-api&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- Context and dependency injection API (JSR-365) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;jakarta.enterprise&lt;/groupId&gt;
  &lt;artifactId&gt;jakarta.enterprise.cdi-api&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that with <a href="quarkus">quarkus</a> you will get them as transitive dependencies out of the box.
The above Jakarate EE dependencies replace these JEE depdencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;!-- Basic injection annotations (JSR-330) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;javax.inject&lt;/groupId&gt;
  &lt;artifactId&gt;javax.inject&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- Basic lifecycle and security annotations (JSR-250)--&gt;
&lt;dependency&gt;
  &lt;groupId&gt;javax.annotation&lt;/groupId&gt;
  &lt;artifactId&gt;javax.annotation-api&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- Context and dependency injection API (JSR-365) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;jakarta.enterprise&lt;/groupId&gt;
  &lt;artifactId&gt;jakarta.enterprise.cdi-api&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==BLOB support</p>
</div>
<div class="paragraph">
<p>BLOB stands for <strong>B</strong>inary <strong>L</strong>arge <strong>Ob</strong>ject. A BLOB may be an image, an office document, ZIP archive or any other multimedia object.
Often these BLOBs are large. if this is the case you need to take care, that you do not copy all the blob data into you application heap, e.g. when providing them via a REST service.
This could easily lead to performance problems or out of memory errors.
As solution for that problem is "streaming" those BLOBs directly from the database to the client. To demonstrate how this can be accomplished, devonfw provides a <a href="https://github.com/devonfw-sample/devon4j-blob-streaming">example</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="further-reading"><a class="anchor" href="#further-reading"></a>1.17. Further Reading</h4>
<div class="ulist">
<ul>
<li>
<p><a href="guide-jpa#blob">BLOBs and the Data Access Layer</a></p>
</li>
<li>
<p><a href="https://www.owasp.org/index.php/Unrestricted_File_Upload">Security Vulnerability Unrestricted File Upload</a></p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Common</p>
</div>
<div class="paragraph">
<p>In our <a href="coding-conventions">coding-conventions</a> we define a clear <a href="coding-conventions#packages">packaging</a> and <a href="coding-conventions#layers">layering</a>.
However, there is always cross-cutting code that does not belong to a specific layer such as generic helpers, general code for configuration or integration, etc.
Therefore, we define a package segment <code>common</code> that can be used as <code>«layer»</code> for such cross-cutting code.
Code from any other layer is allowed to access such <code>common</code> code (at least within the same component).</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Java Persistence API</p>
</div>
<div class="paragraph">
<p>For mapping java objects to a relational database we use the <a href="http://www.oracle.com/technetwork/java/javaee/tech/persistence-jsp-140049.html">Java Persistence API (JPA)</a>.
As JPA implementation we recommend to use <a href="http://hibernate.org/orm/">Hibernate</a>. For general documentation about JPA and Hibernate follow the links above as we will not replicate the documentation. Here you will only find guidelines and examples how we recommend to use it properly. The following examples show how to map the data of a database to an entity. As we use JPA we abstract from <a href="guide-sql">SQL</a> here. However, you will still need a <a href="https://en.wikipedia.org/wiki/Data_definition_language">DDL</a> script for your schema and during maintenance also <a href="guide-database-migration">database migrations</a>. Please follow our <a href="guide-sql">SQL guide</a> for such artifacts.</p>
</div>
</div>
<div class="sect3">
<h4 id="entity"><a class="anchor" href="#entity"></a>1.18. Entity</h4>
<div class="paragraph">
<p>Entities are part of the persistence layer and contain the actual data. They are POJOs (Plain Old Java Objects) on which the relational data of a database is mapped and vice versa. The mapping is configured via JPA annotations (<code>javax.persistence</code>). Usually an entity class corresponds to a table of a database and a property to a column of that table. A persistent entity instance then represents a row of the database table.</p>
</div>
<div class="sect4">
<h5 id="a-simple-entity"><a class="anchor" href="#a-simple-entity"></a>A Simple Entity</h5>
<div class="paragraph">
<p>The following listing shows a simple example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Entity
@Table(name="TEXTMESSAGE")
public class MessageEntity extends ApplicationPersistenceEntity implements Message {

  private String text;

  public String getText() {
    return this.text;
  }

  public void setText(String text) {
    this.text = text;
  }
 }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Entity</code> annotation defines that instances of this class will be entities which can be stored in the database. The <code>@Table</code> annotation is optional and can be used to define the name of the corresponding table in the database. If it is not specified, the simple name of the entity class is used instead.</p>
</div>
<div class="paragraph">
<p>In order to specify how to map the attributes to columns we annotate the corresponding getter methods (technically also private field annotation is also possible but approaches can not be mixed).
The <code>@Id</code> annotation specifies that a property should be used as <a href="#primary-keys">primary key</a>.
With the help of the <code>@Column</code> annotation it is possible to define the name of the column that an attribute is mapped to as well as other aspects such as <code>nullable</code> or <code>unique</code>. If no column name is specified, the name of the property is used as default.</p>
</div>
<div class="paragraph">
<p>Note that every entity class needs a constructor with public or protected visibility that does not have any arguments. Moreover, neither the class nor its getters and setters may be final.</p>
</div>
<div class="paragraph">
<p>Entities should be simple POJOs and not contain business logic.</p>
</div>
</div>
<div class="sect4">
<h5 id="entities-and-datatypes"><a class="anchor" href="#entities-and-datatypes"></a>Entities and Datatypes</h5>
<div class="paragraph">
<p>Standard datatypes like <code>Integer</code>, <code>BigDecimal</code>, <code>String</code>, etc. are mapped automatically by JPA. Custom <a href="guide-datatype">datatypes</a> are mapped as serialized <a href="#blob">BLOB</a> by default what is typically undesired.
In order to map atomic custom datatypes (implementations of`+SimpleDatatype`) we implement an <code>AttributeConverter</code>. Here is a simple example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Converter(autoApply = true)
public class MoneyAttributeConverter implements AttributeConverter&lt;Money, BigDecimal&gt; {

  public BigDecimal convertToDatabaseColumn(Money attribute) {
    return attribute.getValue();
  }

  public Money convertToEntityAttribute(BigDecimal dbData) {
    return new Money(dbData);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The annotation <code>@Converter</code> is detected by the JPA vendor if the annotated class is in the packages to scan. Further, <code>autoApply = true</code> implies that the converter is automatically used for all properties of the handled datatype. Therefore all entities with properties of that datatype will automatically be mapped properly (in our example <code>Money</code> is mapped as <code>BigDecimal</code>).</p>
</div>
<div class="paragraph">
<p>In case you have a composite datatype that you need to map to multiple columns the JPA does not offer a real solution. As a workaround you can use a bean instead of a real datatype and declare it as <a href="#embeddable"><code>@Embeddable</code></a>. If you are using Hibernate you can implement <code>CompositeUserType</code>. Via the <code>@TypeDef</code> annotation it can be registered to Hibernate. If you want to annotate the <code>CompositeUserType</code> implementation itself you also need another annotation (e.g. <code>MappedSuperclass</code> tough not technically correct) so it is found by the scan.</p>
</div>
<div class="sect5">
<h6 id="enumerations"><a class="anchor" href="#enumerations"></a>Enumerations</h6>
<div class="paragraph">
<p>By default JPA maps Enums via their ordinal. Therefore the database will only contain the ordinals (0, 1, 2, etc.) . So , inside the database you can not easily understand their meaning. Using <code>@Enumerated</code> with <code>EnumType.STRING</code> allows to map the enum values to their name (<code>Enum.name()</code>). Both approaches are fragile when it comes to code changes and refactoring (if you change the order of the enum values or rename them) after the application is deployed to production. If you want to avoid this and get a robust mapping you can define a dedicated string in each enum value for database representation that you keep untouched. Then you treat the enum just like any other <a href="#entities-and-datatypes">custom datatype</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="blob"><a class="anchor" href="#blob"></a>BLOB</h6>
<div class="paragraph">
<p>If binary or character large objects (BLOB/CLOB) should be used to store the value of an attribute, e.g. to store an icon, the <code>@Lob</code> annotation should be used as shown in the following listing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Lob
public byte[] getIcon() {
  return this.icon;
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Using a byte array will cause problems if BLOBs get large because the entire BLOB is loaded into the RAM of the server and has to be processed by the garbage collector. For larger BLOBs the type <a href="http://docs.oracle.com/javase/7/docs/api/java/sql/Blob.html">Blob</a> and <a href="guide-blob-support">streaming</a> should be used.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public Blob getAttachment() {
  return this.attachment;
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="date-and-time"><a class="anchor" href="#date-and-time"></a>Date and Time</h6>
<div class="paragraph">
<p>To store date and time related values, the temporal annotation can be used as shown in the listing below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Temporal(TemporalType.TIMESTAMP)
public java.util.Date getStart() {
  return start;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Until Java8 the java data type <code>java.util.Date</code> (or Jodatime) has to be used.
<code>TemporalType</code> defines the granularity. In this case, a precision of nanoseconds is used. If this granularity is not wanted, <code>TemporalType.DATE</code> can be used instead, which only has a granularity of milliseconds.
Mixing these two granularities can cause problems when comparing one value to another. This is why we <strong>only</strong>  use <code>TemporalType.TIMESTAMP</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="querydsl-and-custom-types"><a class="anchor" href="#querydsl-and-custom-types"></a>QueryDSL and Custom Types</h6>
<div class="paragraph">
<p>Using the Aliases API of QueryDSL might result in an <code>InvalidDataAccessApiUsageException</code> when using custom datatypes in entity properties. This can be circumvented in two steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure you have the following maven dependencies in your project (<code>core</code> module) to support custom types via the Aliases API:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.ow2.asm&lt;/groupId&gt;
  &lt;artifactId&gt;asm&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;cglib&lt;/groupId&gt;
  &lt;artifactId&gt;cglib&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Make sure, that all your custom types used in entities provide a non-argument constructor with at least visibility level <code>protected</code>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect4">
<h5 id="primary-keys"><a class="anchor" href="#primary-keys"></a>Primary Keys</h5>
<div class="paragraph">
<p>We only use simple Long values as primary keys (IDs).
By default it is auto generated (<code>@GeneratedValue(strategy=GenerationType.AUTO)</code>).
This is already provided by the class <code>com.devonfw.&lt;projectName&gt;.general.dataaccess.api.AbstractPersistenceEntity</code> within the <a href="guide-structure-classic#architecture-mapping">classic project structure</a> respectively <code>com.devonfw.&lt;projectName&gt;.general.domain.model.AbstractPersistenceEntity</code> within the <a href="guide-structure-modern#architecture-mapping">modern project structure</a>, that you can extend.</p>
</div>
<div class="paragraph">
<p>The reason for this recommendation is simply because using a number (<code>Long</code>) is the most efficient representation for the database.
You may also consider to use other types like <code>String</code> or <code>UUID</code> or even composite custom datatypes and this is technically possible.
However, please consider that the primary key is used to lookup the row from the database table, also in foreign keys and thus in JOINs.
Please note that your project sooner or later may reach some complexity where performance really matters.
Working on big data and performing JOINs when using types such as <code>String</code> (<code>VARCHAR[2]</code>) as primary and foreign keys will kill your performance.
You are still free to make a different choice and devonfw only gives recommendations but does not want to dictate you what to do.
However, you have been warned about the concequences.
If you are well aware of what you are doing, you can still use differnet types of primary keys.
In such case, create your own entity not extending <code>AbstractPersistenceEntity</code> or create your own copy of <code>AbstractPersistenceEntity</code> with a different name and a different type of primary key.</p>
</div>
<div class="paragraph">
<p>In case you have business oriented keys (often as <code>String</code>), you can define an additional property for it and declare it as unique (<code>@Column(unique=true)</code>).
Be sure to include "AUTO_INCREMENT" in your sql table field ID to be able to persist data (or similar for other databases).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="relationships"><a class="anchor" href="#relationships"></a>1.19. Relationships</h4>
<div class="sect4">
<h5 id="n1-and-11-relationships"><a class="anchor" href="#n1-and-11-relationships"></a>n:1 and 1:1 Relationships</h5>
<div class="paragraph">
<p>Entities often do not exist independently but are in some relation to each other. For example, for every period of time one of the StaffMember&#8217;s of the restaurant example has worked, which is represented by the class <code>WorkingTime</code>, there is a relationship to this StaffMember.</p>
</div>
<div class="paragraph">
<p>The following listing shows how this can be modeled using JPA:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">...

@Entity
public class WorkingTimeEntity {
   ...

   private StaffMemberEntity staffMember;

   @ManyToOne
   @JoinColumn(name="STAFFMEMBER")
   public StaffMemberEntity getStaffMember() {
      return this.staffMember;
   }

   public void setStaffMember(StaffMemberEntity staffMember) {
      this.staffMember = staffMember;
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To represent the relationship, an attribute of the type of the corresponding entity class that is referenced has been introduced. The relationship is a n:1 relationship, because every <code>WorkingTime</code> belongs to exactly one <code>StaffMember</code>, but a <code>StaffMember</code> usually worked more often than once.<br>
This is why the <code>@ManyToOne</code> annotation is used here. For 1:1 relationships the <code>@OneToOne</code> annotation can be used which works basically the same way. To be able to save information about the relation in the database, an additional column in the corresponding table of WorkingTime is needed which contains the primary key of the referenced StaffMember. With the <code>name</code> element of the <code>@JoinColumn</code> annotation it is possible to specify the name of this column.</p>
</div>
</div>
<div class="sect4">
<h5 id="1n-and-nm-relationships"><a class="anchor" href="#1n-and-nm-relationships"></a>1:n and n:m Relationships</h5>
<div class="paragraph">
<p>The relationship of the example listed above is currently an unidirectional one, as there is a getter method for retrieving the <code>StaffMember</code> from the <code>WorkingTime</code> object, but not vice versa.</p>
</div>
<div class="paragraph">
<p>To make it a bidirectional one, the following code has to be added to <code>StaffMember</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  private Set&lt;WorkingTimeEntity&gt; workingTimes;

  @OneToMany(mappedBy="staffMember")
  public Set&lt;WorkingTimeEntity&gt; getWorkingTimes() {
    return this.workingTimes;
  }

  public void setWorkingTimes(Set&lt;WorkingTimeEntity&gt; workingTimes) {
    this.workingTimes = workingTimes;
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>To make the relationship bidirectional, the tables in the database do not have to be changed. Instead the column that corresponds to the attribute <code>staffMember</code> in class <code>WorkingTime</code> is used, which is specified by the <code>mappedBy</code> element of the <code>@OneToMany</code> annotation. Hibernate will search for corresponding <code>WorkingTime</code> objects automatically when a <code>StaffMember</code> is loaded.</p>
</div>
<div class="paragraph">
<p>The problem with bidirectional relationships is that if a <code>WorkingTime</code> object is added to the set or list <code>workingTimes</code> in <code>StaffMember</code>, this does not have any effect in the database unless
the <code>staffMember</code> attribute of that <code>WorkingTime</code> object is set. That is why the devon4j advices not to use bidirectional relationships but to use queries instead. How to do this is shown <a href="#queries">here</a>. If a bidirectional relationship should be used nevertheless, appropriate add and remove methods must be used.</p>
</div>
<div class="paragraph">
<p>For 1:n and n:m relations, the devon4j demands that (unordered) Sets and no other collection types are used, as shown in the listing above. The only exception is whenever an ordering is really needed, (sorted) lists can be used.<br>
For example, if <code>WorkingTime</code> objects should be sorted by their start time, this could be done like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  private List&lt;WorkingTimeEntity&gt; workingTimes;

  @OneToMany(mappedBy = "staffMember")
  @OrderBy("startTime asc")
  public List&lt;WorkingTimeEntity&gt; getWorkingTimes() {
    return this.workingTimes;
  }

  public void setWorkingTimes(List&lt;WorkingTimeEntity&gt; workingTimes) {
    this.workingTimes = workingTimes;
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The value of the <code>@OrderBy</code> annotation consists of an attribute name of the class followed by <code>asc</code> (ascending) or <code>desc</code> (descending).</p>
</div>
<div class="paragraph">
<p>To store information about a n:m relationship, a separate table has to be used, as one column cannot store several values (at least if the database schema is in first normal form).<br>
For example if one wanted to extend the example application so that all ingredients of one <code>FoodDrink</code> can be saved and to model the ingredients themselves as entities (e.g. to store additional information about them), this could be modeled as follows (extract of class <code>FoodDrink</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  private Set&lt;IngredientEntity&gt; ingredients;

  @ManyToMany()
  @JoinTable
  public Set&lt;IngredientEntity&gt; getIngredients() {
    return this.ingredients;
  }

  public void setOrders(Set&lt;IngredientEntity&gt; ingredients) {
    this.ingredients = ingredients;
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Information about the relation is stored in a table called <code>BILL_ORDER</code> that has to have two columns, one for referencing the Bill, the other one for referencing the Order. Note that the <code>@JoinTable</code> annotation is not needed in this case because a separate table is the default solution here (same for n:m relations) unless there is a <code>mappedBy</code> element specified.</p>
</div>
<div class="paragraph">
<p>For 1:n relationships this solution has the disadvantage that more joins (in the database system) are needed to get a Bill with all the Orders it refers to. This might have a negative impact on performance so that the solution to store a reference to the Bill row/entity in the Order&#8217;s table is probably the better solution in most cases.</p>
</div>
<div class="paragraph">
<p>Note that bidirectional n:m relationships are not allowed for applications based on devon4j. Instead a third entity has to be introduced, which "represents" the relationship (it has two n:1 relationships).</p>
</div>
</div>
<div class="sect4">
<h5 id="eager-vs-lazy-loading"><a class="anchor" href="#eager-vs-lazy-loading"></a>Eager vs. Lazy Loading</h5>
<div class="paragraph">
<p>Using JPA it is possible to use either lazy or eager loading. Eager loading means that for entities retrieved from the database, other entities that are referenced by these entities are also retrieved, whereas lazy loading means that this is only done when they are actually needed, i.e. when the corresponding getter method is invoked.</p>
</div>
<div class="paragraph">
<p>Application based on devon4j are strongly advised to <strong>always use lazy loading</strong>. The JPA defaults are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@OneToMany</code>: LAZY</p>
</li>
<li>
<p><code>@ManyToMany</code>: LAZY</p>
</li>
<li>
<p><code>@ManyToOne</code>: EAGER</p>
</li>
<li>
<p><code>@OneToOne</code>: EAGER</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So at least for <code>@ManyToOne</code> and <code>@OneToOne</code> you always need to override the default by providing <code>fetch = FetchType.LAZY</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Please read the <a href="guide-jpa-performance">performance guide</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="cascading-relationships"><a class="anchor" href="#cascading-relationships"></a>Cascading Relationships</h5>
<div class="paragraph">
<p>For relations it is also possible to define whether operations are cascaded (like a recursion) to the related entity.
By default, nothing is done in these situations. This can be changed by using the <code>cascade</code> property of the annotation that specifies the relation type (<code>@OneToOne</code>, <code>@ManyToOne</code>, <code>@OneToMany</code>, <code>@ManyToOne</code>). This property accepts a <code>CascadeType</code> that offers the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PERSIST (for <code>EntityManager.persist</code>, relevant to inserted transient entities into DB)</p>
</li>
<li>
<p>REMOVE (for <code>EntityManager.remove</code> to delete entity from DB)</p>
</li>
<li>
<p>MERGE (for <code>EntityManager.merge</code>)</p>
</li>
<li>
<p>REFRESH (for <code>EntityManager.refresh</code>)</p>
</li>
<li>
<p>DETACH (for <code>EntityManager.detach</code>)</p>
</li>
<li>
<p>ALL (cascade all of the above operations)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="http://meri-stuff.blogspot.de/2012/03/jpa-tutorial.html">here</a> for more information.</p>
</div>
</div>
<div class="sect4">
<h5 id="typesafe-foreign-keys-using-idref"><a class="anchor" href="#typesafe-foreign-keys-using-idref"></a>Typesafe Foreign Keys using IdRef</h5>
<div class="paragraph">
<p>For simple usage you can use <code>Long</code> for all your foreign keys.
However, as an optional pattern for advanced and type-safe usage, we offer <a href="guide-jpa-idref">IdRef</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="embeddable"><a class="anchor" href="#embeddable"></a>1.20. Embeddable</h4>
<div class="paragraph">
<p>An embeddable Object is a way to group properties of an <a href="#entity">entity</a> into a separate Java (child) object. Unlike with implement <a href="#relationships">relationships</a> the embeddable is not a separate entity and its properties are stored (embedded) in the same table together with the entity. This is helpful to structure and reuse groups of properties.</p>
</div>
<div class="paragraph">
<p>The following example shows an <code>Address</code> implemented as an embeddable class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Embeddable
public class AddressEmbeddable {

  private String street;
  private String number;
  private Integer zipCode;
  private String city;

  @Column(name="STREETNUMBER")
  public String getNumber() {
    return number;
  }

  public void setNumber(String number) {
    this.number = number;
  }

  ...  // other getter and setter methods, equals, hashCode
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see an embeddable is similar to an entity class, but with an <code>@Embeddable</code> annotation instead of the <code>@Entity</code> annotation and without primary key or modification counter.
An Embeddable does not exist on its own but in the context of an entity.
As a simplification Embeddables do not require a separate interface and <a href="guide-transferobject#ETO">ETO</a> as the <a href="guide-beanmapping">bean-mapper</a> will create a copy automatically when converting the owning entity to an ETO.
However, in this case the embeddable becomes part of your <code>api</code> module that therefore needs a dependency on the <code>JPA</code>.</p>
</div>
<div class="paragraph">
<p>In addition to that the methods <code>equals(Object)</code> and <code>hashCode()</code> need to be implemented as this is required by Hibernate (it is not required for entities because they can be unambiguously identified by their primary key). For some hints on how to implement the <code>hashCode()</code> method please have a look <a href="http://stackoverflow.com/questions/113511/hash-code-implementation">here</a>.</p>
</div>
<div class="paragraph">
<p>Using this <code>AddressEmbeddable</code> inside an entity class can be done like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  private AddressEmbeddable address;

  @Embedded
  public AddressEmbeddable getAddress() {
    return this.address;
  }

  public void setAddress(AddressEmbeddable address) {
    this.address = address;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@Embedded</code> annotation needs to be used for embedded attributes. Note that if in all columns of the embeddable (here <code>Address</code>) are <code>null</code>, then the embeddable object itself is also <code>null</code> inside the entity. This has to be considered to avoid NullPointerException&#8217;s. Further this causes some issues with primitive types in embeddable classes that can be avoided by only using object types instead.</p>
</div>
</div>
<div class="sect3">
<h4 id="inheritance"><a class="anchor" href="#inheritance"></a>1.21. Inheritance</h4>
<div class="paragraph">
<p>Just like normal java classes, <a href="#entity">entity</a> classes can inherit from others. The only difference is that you need to specify how to map a class hierarchy to database tables. Generic abstract super-classes for entities can simply be annotated with <code>@MappedSuperclass</code>.</p>
</div>
<div class="paragraph">
<p>For all other cases the JPA offers the annotation <code>@Inheritance</code> with the property <code>strategy</code> talking an <code>InheritanceType</code> that has the following options:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p><code>SINGLE_TABLE</code>: This strategy uses a single table that contains all columns needed to store all entity-types of the entire inheritance hierarchy. If a column is not needed for an entity because of its type, there is a null value in this column. An additional column is introduced, which denotes the type of the entity (called <code>dtype</code>).</p>
</li>
<li>
<p><code>TABLE_PER_CLASS</code>: For each concrete entity class there is a table in the database that can store such an entity with all its attributes. An entity is only saved in the table corresponding to its most concrete type. To get all entities of a super type, joins are needed.</p>
</li>
<li>
<p><code>JOINED</code>: In this case there is a table for every entity class including abstract classes, which contains only the columns for the persistent properties of that particular class. Additionally there is a primary key column in every table. To get an entity of a class that is a subclass of another one, joins are needed.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Each of the three approaches has its advantages and drawbacks, which are discussed in detail <a href="http://openjpa.apache.org/builds/1.0.4/apache-openjpa-1.0.4/docs/manual/jpa_overview_mapping_inher.html#jpa_overview_mapping_inher_tpc">here</a>. In most cases, the first one should be used, because it is usually the fastest way to do the mapping, as no joins are needed when retrieving, searching or persisting entities. Moreover it is rather simple and easy to understand.
One major disadvantage is that the first approach could lead to a table with a lot of null values, which might have a negative impact on the database size.</p>
</div>
<div class="paragraph">
<p>The inheritance strategy has to be annotated to the top-most entity of the class hierarchy (where <code>@MappedSuperclass</code> classes are not considered) like in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Entity
@Inheritance(strategy=InheritanceType.SINGLE_TABLE)
public abstract class MyParentEntity extends ApplicationPersistenceEntity implements MyParent {
  ...
}

@Entity
public class MyChildEntity extends MyParentEntity implements MyChild {
  ...
}

@Entity
public class MyOtherEntity extends MyParentEntity implements MyChild {
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As a best practice we advise you to avoid entity hierarchies at all where possible and otherwise to keep the hierarchy as small as possible. In order to just ensure reuse or establish a common API you can consider a shared interface, a <code>@MappedSuperclass</code> or an <code>@Embeddable</code> instead of an entity hierarchy.</p>
</div>
</div>
<div class="sect3">
<h4 id="repositories-and-daos"><a class="anchor" href="#repositories-and-daos"></a>1.22. Repositories and DAOs</h4>
<div class="paragraph">
<p>For each entity a code unit is created that groups all database operations for that entity. We recommend to use <a href="guide-repository">spring-data repositories</a> for that as it is most efficient for developers. As an alternative there is still the classic approach using <a href="guide-dao">DAOs</a>.</p>
</div>
<div class="sect4">
<h5 id="concurrency-control"><a class="anchor" href="#concurrency-control"></a>Concurrency Control</h5>
<div class="paragraph">
<p>The concurrency control defines the way concurrent access to the same data of a database is handled. When several users (or threads of application servers) concurrently access a database, anomalies may happen, e.g. a transaction is able to see changes from another transaction although that one did, not yet commit these changes. Most of these anomalies are automatically prevented by the database system, depending on the <a href="http://en.wikipedia.org/wiki/Isolation_(database_systems)"><em>isolation level</em></a> (property <code>hibernate.connection.isolation</code> in the <code>jpa.xml</code>, see <a href="http://docs.jboss.org/hibernate/orm/5.0/manual/en-US/html/ch03.html">here</a>, or <code>quarkus.datasource.jdbc.transaction-isolation-level</code> in the <code>application.properties</code>).</p>
</div>
<div class="paragraph">
<p>Another anomaly is when two stakeholders concurrently access a record, do some changes and write them back to the database. The JPA addresses this with different locking strategies (see <a href="http://www.objectdb.com/java/jpa/persistence/lock">here</a>).</p>
</div>
<div class="paragraph">
<p>As a best practice we are using optimistic locking for regular end-user <a href="guide-service-layer">services</a> (OLTP) and pessimistic locking for <a href="guide-batch-layer">batches</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="optimistic-locking"><a class="anchor" href="#optimistic-locking"></a>Optimistic Locking</h5>
<div class="paragraph">
<p>The class <code>com.devonfw.module.jpa.persistence.api.AbstractPersistenceEntity</code> already provides optimistic locking via a <code>modificationCounter</code> with the <code>@Version</code> annotation. Therefore JPA takes care of optimistic locking for you. When entities are transferred to clients, modified and sent back for update you need to ensure the <code>modificationCounter</code> is part of the game. If you follow our guides about <a href="guide-transferobject">transfer-objects</a> and <a href="guide-service-layer">services</a> this will also work out of the box.
You only have to care about two things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>How to deal with optimistic locking in <a href="#relationships">relationships</a>?<br>
Assume an entity <code>A</code> contains a collection of <code>B</code> entities. Should there be a locking conflict if one user modifies an instance of <code>A</code> while another user in parallel modifies an instance of <code>B</code> that is contained in the other instance? To address this , take a look at <a href="https://github.com/devonfw/devon4j/blob/develop/modules/jpa-basic/src/main/java/com/devonfw/module/jpa/dataaccess/api/feature/FeatureForceIncrementModificationCounter.java">FeatureForceIncrementModificationCounter</a>.</p>
</li>
<li>
<p>What should happen in the UI if an <code>OptimisticLockException</code> occurred?<br>
According to KISS our recommendation is that the user gets an error displayed that tells him to do his change again on the recent data. Try to design your system and the work processing in a way to keep such conflicts rare and you are fine.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="pessimistic-locking"><a class="anchor" href="#pessimistic-locking"></a>Pessimistic Locking</h5>
<div class="paragraph">
<p>For back-end <a href="guide-service-layer">services</a> and especially for <a href="guide-batch-layer">batches</a> optimistic locking is not suitable. A human user shall not cause a large batch process to fail because he was editing the same entity. Therefore such use-cases use pessimistic locking what gives them a kind of priority over the human users.
In your <a href="#data-access-object">DAO</a> implementation you can provide methods that do pessimistic locking via <a href="http://docs.oracle.com/javaee/7/api/javax/persistence/EntityManager.html"><code>EntityManager</code></a> operations that take a <a href="http://docs.oracle.com/javaee/7/api/javax/persistence/LockModeType.html"><code>LockModeType</code></a>. Here is a simple example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  getEntityManager().lock(entity, LockModeType.READ);</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using the <code>lock(Object, LockModeType)</code> method with <code>LockModeType.READ</code>, Hibernate will issue a <code>SELECT &#8230;&#8203; FOR UPDATE</code>. This means that no one else can update the entity (see <a href="http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_10002.htm">here</a> for more information on the statement). If <code>LockModeType.WRITE</code> is specified, Hibernate issues a <code>SELECT &#8230;&#8203; FOR UPDATE NOWAIT</code> instead, which has has the same meaning as the statement above, but if there is already a lock, the program will not wait for this lock to be released. Instead, an exception is raised.<br>
Use one of the types if you want to modify the entity later on, for read only access no lock is required.</p>
</div>
<div class="paragraph">
<p>As you might have noticed, the behavior of Hibernate deviates from what one would expect by looking at the <code>LockModeType</code> (especially <code>LockModeType.READ</code> should not cause a <code>SELECT &#8230;&#8203; FOR UPDATE</code> to be issued). The framework actually deviates from what is <a href="http://docs.oracle.com/javaee/7/api/javax/persistence/LockModeType.html">specified</a> in the JPA for unknown reasons.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="database-auditing"><a class="anchor" href="#database-auditing"></a>1.23. Database Auditing</h4>
<div class="paragraph">
<p>See <a href="guide-auditing">auditing guide</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="testing-data-access"><a class="anchor" href="#testing-data-access"></a>1.24. Testing Data-Access</h4>
<div class="paragraph">
<p>For testing of Entities and Repositories or DAOs see <a href="guide-testing#level-2-component-test">testing guide</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="principles"><a class="anchor" href="#principles"></a>1.25. Principles</h4>
<div class="paragraph">
<p>We strongly recommend these principles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use the JPA where ever possible and use vendor (hibernate) specific features only for situations when JPA does not provide a solution. In the latter case consider first if you really need the feature.</p>
</li>
<li>
<p>Create your entities as simple POJOs and use JPA to annotate the getters in order to define the mapping.</p>
</li>
<li>
<p>Keep your entities simple and avoid putting advanced logic into entity methods.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="database-configuration"><a class="anchor" href="#database-configuration"></a>1.26. Database Configuration</h4>
<div class="paragraph">
<p>For details on the configuration of the database connection and database logging of the individual framework, please refer to the respective configuration guide.</p>
</div>
<div class="paragraph">
<p>For <a href="spring">spring</a> see <a href="spring/guide-spring-configuration#database-configuration">here</a>.</p>
</div>
<div class="paragraph">
<p>For <a href="quarkus">quarkus</a> see <a href="quarkus/guide-quarkus-configuration#database-configuration">here</a>.</p>
</div>
<div class="sect4">
<h5 id="database-migration"><a class="anchor" href="#database-migration"></a>Database Migration</h5>
<div class="paragraph">
<p>See <a href="guide-database-migration">database migration</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="pooling"><a class="anchor" href="#pooling"></a>Pooling</h5>
<div class="paragraph">
<p>You typically want to pool JDBC connections to boost performance by recycling previous connections. There are many libraries available to do connection pooling. We recommend to use <a href="https://github.com/brettwooldridge/HikariCP">HikariCP</a>. For Oracle RDBMS see <a href="guide-oracle#pooling">here</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="security-2"><a class="anchor" href="#security-2"></a>1.27. Security</h4>
<div class="sect4">
<h5 id="sql-injection"><a class="anchor" href="#sql-injection"></a>SQL-Injection</h5>
<div class="paragraph">
<p>A common <a href="guide-security">security</a> threat is <a href="http://en.wikipedia.org/wiki/SQL_injection">SQL-injection</a>. Never build queries with string concatenation or your code might be vulnerable as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  String query = "Select op from OrderPosition op where op.comment = " + userInput;
  return getEntityManager().createQuery(query).getResultList();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Via the parameter <code>userInput</code> an attacker can inject SQL (JPQL) and execute arbitrary statements in the database causing extreme damage.</p>
</div>
<div class="paragraph">
<p>In order to prevent such injections you have to strictly follow our rules for <a href="#queries">queries</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use named queries for <a href="guide-jpa-query#static-queries">static queries</a>.</p>
</li>
<li>
<p>Use QueryDSL for <a href="guide-jpa-query#dynamic-queries">dynamic queries</a>.</p>
</li>
<li>
<p>Please also consult the <a href="https://www.owasp.org/index.php/SQL_Injection_Prevention_Cheat_Sheet">SQL Injection Prevention Cheat Sheet</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="limited-permissions-for-application"><a class="anchor" href="#limited-permissions-for-application"></a>Limited Permissions for Application</h5>
<div class="paragraph">
<p>We suggest that you operate your application with a database user that has limited permissions so he can not modify the SQL schema (e.g. drop tables). For initializing the schema (DDL) or to do schema migrations use a separate user that is not used by the application itself.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Queries
The <a href="http://www.oracle.com/technetwork/java/javaee/tech/persistence-jsp-140049.html">Java Persistence API (JPA)</a> defines its own query language, the <a href="https://docs.oracle.com/html/E13946_01/ejb3_langref.html"><em>java persistence query language</em> (JPQL)</a> (see also <a href="https://docs.oracle.com/javaee/7/tutorial/persistence-querylanguage.htm">JPQL tutorial</a>), which is similar to SQL but operates on entities and their attributes instead of tables and columns.</p>
</div>
<div class="paragraph">
<p>The simplest CRUD-Queries (e.g. find an entity by its ID) are already build in the devonfw CRUD functionality (via <a href="guide-repository">Repository</a> or <a href="guide-dao">DAO</a>). For other cases you need to write your own query. We distinguish between <em>static</em> and <em>dynamic</em> queries. <a href="#static-queries">Static queries</a> have a fixed JPQL query string that may only use parameters to customize the query at runtime. Instead, <a href="#dynamic-queries">dynamic queries</a> can change their clauses (<code>WHERE</code>, <code>ORDER BY</code>, <code>JOIN</code>, etc.) at runtime depending on the given search criteria.</p>
</div>
</div>
<div class="sect4">
<h5 id="static-queries"><a class="anchor" href="#static-queries"></a>Static Queries</h5>
<div class="paragraph">
<p>E.g. to find all <a href="https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/dishmanagement/dataaccess/api/DishEntity.java">DishEntries</a> (from MTS sample app) that have a price not exceeding a given <code>maxPrice</code> we write the following JPQL query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT dish FROM DishEntity dish WHERE dish.price &lt;= :maxPrice</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here <code>dish</code> is used as alias (variable name) for our selected <code>DishEntity</code> (what refers to the simple name of the Java entity class). With <code>dish.price</code> we are referring to the Java property <code>price</code> (<code>getPrice()</code>/<code>setPrice(&#8230;&#8203;)</code>) in <code>DishEntity</code>. A named variable provided from outside (the search criteria at runtime) is specified with a colon (<code>:</code>) as prefix. Here with <code>:maxPrice</code> we reference to a variable that needs to be set via <code>query.setParameter("maxPrice", maxPriceValue)</code>. JPQL also supports indexed parameters (<code>?</code>) but they are discouraged because they easily cause confusion and mistakes.</p>
</div>
<div class="sect5">
<h6 id="using-queries-to-avoid-bidirectional-relationships"><a class="anchor" href="#using-queries-to-avoid-bidirectional-relationships"></a>Using Queries to Avoid Bidirectional Relationships</h6>
<div class="paragraph">
<p>With the usage of queries it is possible to avoid exposing relationships or modelling bidirectional relationships, which have some disadvantages (see <a href="guide-jpa#relationships">relationships</a>). This is especially desired for relationships between entities of different business components.
So for example to get all <a href="https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/ordermanagement/dataaccess/api/OrderLineEntity.java">OrderLineEntities</a> for a specific <a href="https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/ordermanagement/dataaccess/api/OrderEntity.java">OrderEntity</a> without using the <code>orderLines</code> relation from <code>OrderEntity</code> the following query could be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT line FROM OrderLineEntity line WHERE line.order.id = :orderId</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="dynamic-queries"><a class="anchor" href="#dynamic-queries"></a>Dynamic Queries</h5>
<div class="paragraph">
<p>For dynamic queries, we use the <a href="http://querydsl.com/static/querydsl/latest/reference/html/ch02.html">JPA</a> module for <a href="http://www.querydsl.com/">Querydsl</a>. Querydsl also supports other modules such as <a href="http://querydsl.com/static/querydsl/latest/reference/html/ch02s07.html">MongoDB</a>, and <a href="http://querydsl.com/static/querydsl/latest/reference/html/ch02s05.html">Apache Lucene</a>. It allows to implement queries in a powerful but readable and type-safe way (unlike Criteria API). If you already know JPQL, you will quickly be able to read and write Querydsl code. It feels like JPQL but implemented in Java instead of plain text.</p>
</div>
<div class="paragraph">
<p>To use Querydsl in your Maven project, add the following dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencies&gt;

    &lt;dependency&gt;
        &lt;groupId&gt;com.querydsl&lt;/groupId&gt;
        &lt;artifactId&gt;querydsl-apt&lt;/artifactId&gt;
        &lt;version&gt;${querydsl.version}&lt;/version&gt;
        &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
        &lt;groupId&gt;com.querydsl&lt;/groupId&gt;
        &lt;artifactId&gt;querydsl-jpa&lt;/artifactId&gt;
        &lt;version&gt;${querydsl.version}&lt;/version&gt;
    &lt;/dependency&gt;

&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, configure the annotation processing tool (APT) plugin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;project&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      ...
      &lt;plugin&gt;
        &lt;groupId&gt;com.mysema.maven&lt;/groupId&gt;
        &lt;artifactId&gt;apt-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.1.3&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;process&lt;/goal&gt;
            &lt;/goals&gt;
            &lt;configuration&gt;
              &lt;outputDirectory&gt;target/generated-sources/java&lt;/outputDirectory&gt;
              &lt;processor&gt;com.querydsl.apt.jpa.JPAAnnotationProcessor&lt;/processor&gt;
            &lt;/configuration&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
      ...
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is an example from our sample application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  public List&lt;DishEntity&gt; findDishes(DishSearchCriteriaTo criteria) {
    QDishEntity dish = QDishEntity.dishEntity;
    JPAQuery&lt;DishEntity&gt; query = new JPAQuery&lt;OrderEntity&gt;(getEntityManager());
    query.from(dish);

    Range&lt;BigDecimal&gt; priceRange = criteria.getPriceRange();
    if (priceRange != null) {
      BigDecimal min = priceRange.getMin();
      if (min != null) {
        query.where(dish.price.goe(min));
      }
      BigDecimal max = priceRange.getMax();
      if (max != null) {
        query.where(dish.price.loe(max));
      }
    }
    String name = criteria.getName();
    if ((name != null) &amp;&amp; (!name.isEmpty())) {
      query.where(dish.name.eq(name));
    }
    query.orderBy(dish.price.asc(), dish.name.asc());
    return query.fetch();
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, we use the so called Q-types (<code>QDishEntity</code>). These are classes generated at build time by the Querydsl annotation processor from entity classes. The Q-type classes can be used as static types representative of the original entity class.</p>
</div>
<div class="paragraph">
<p>The <code>query.from(dish)</code> method call defines the query source, in this case the <code>dish</code> table. The <code>where</code> method defines a filter. For example, The first call uses the <code>goe</code> operator to filter out any dishes that are not greater or equal to the minimal price. Further operators can be found <a href="https://querydsl.com/static/querydsl/latest/apidocs/com/querydsl/core/types/dsl/ComparableExpression.html">here</a>.</p>
</div>
<div class="paragraph">
<p>The <code>orderBy</code> method is used to sort the query results according to certain criteria. Here, we sort the results first by their price and then by their name, both in ascending order. To sort in descending order, use <code>.desc()</code>. To partition query results into groups of rows, see the <a href="https://querydsl.com/static/querydsl/latest/reference/html_single/#d0e377">groupBy</a> method.</p>
</div>
<div class="paragraph">
<p>For spring, devon4j provides another approach that you can use for your Spring applications to implement Querydsl logic without having to use these metaclasses. An example can be found <a href="spring/guide-querydsl-spring">here</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="native-queries"><a class="anchor" href="#native-queries"></a>Native Queries</h5>
<div class="paragraph">
<p>Spring Data supports the use of <em>native queries</em>. Native queries use simple native SQL syntax that is not parsed in JPQL. This allows you to use all the features that your database supports.
The downside to this is that database portability is lost due to the absence of an abstraction layer. Therefore, the queries may not work with another database because it may use a different syntax.</p>
</div>
<div class="paragraph">
<p>You can implement a native query using <code>@Query</code> annotation with the <code>nativeQuery</code> attribute set to true:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Query(value="...", nativeQuery=true)</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This will not work with Quarkus because Quarkus does not support native queries by using the <code>@Query</code> annotation (see <a href="guide-repository#limitations-in-quarkus">here</a>).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also implement native queries directly using the <code>EntityManager</code> API and the <code>createNativeQuery</code> method.
<strong>This approach also works with Quarkus</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Query query = entityManager.createNativeQuery("SELECT * FROM Product", ProductEntity.class);
List&lt;ProductEntity&gt; products = query.getResultList();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Be sure to use the name of the table when using native queries, while you must use the entity name when implementing queries with JPQL.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="using-wildcards"><a class="anchor" href="#using-wildcards"></a>Using Wildcards</h5>
<div class="paragraph">
<p>For flexible queries it is often required to allow wildcards (especially in <a href="#dynamic_queries">dynamic queries</a>). While users intuitively expect glob syntax, the SQL and JPQL standards work differently. Therefore, a mapping is required. devonfw provides this on a lower level with <a href="https://github.com/devonfw/devon4j/blob/develop/modules/basic/src/main/java/com/devonfw/module/basic/common/api/query/LikePatternSyntax.java">LikePatternSyntax</a> and on a higher level with <a href="https://github.com/devonfw/devon4j/blob/develop/modules/jpa-basic/src/main/java/com/devonfw/module/jpa/dataaccess/api/QueryUtil.java#L54">QueryUtil</a> (see <a href="https://github.com/devonfw/devon4j/blob/develop/modules/jpa-basic/src/main/java/com/devonfw/module/jpa/dataaccess/api/QueryHelper.java#L199">QueryHelper.newStringClause(&#8230;&#8203;)</a>).</p>
</div>
</div>
<div class="sect4">
<h5 id="pagination"><a class="anchor" href="#pagination"></a>Pagination</h5>
<div class="paragraph">
<p>When dealing with large amounts of data, an efficient method of retrieving the data is required. Fetching the entire data set each time would be too time consuming. Instead, <em>Paging</em> is used to process only small subsets of the entire data set.</p>
</div>
<div class="paragraph">
<p>If you are using <a href="guide-repository">Spring Data repositories</a> you will get pagination support out of the box by providing the interfaces <a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Pageable.html">Page</a> and  <a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Pageable.html">Pageable</a>:</p>
</div>
<div class="listingblock">
<div class="title">Listing 6. <strong>repository</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Page&lt;DishEntity&gt; findAll(Pageable pageable);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you can create a Pageable object and pass it to the method call as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">int page = criteria.getPageNumber();
int size = criteria.getPageSize();
Pageable pageable = PageRequest.of(page, size);
Page&lt;DishEntity&gt; dishes = dishRepository.findAll(pageable);</code></pre>
</div>
</div>
<div class="sect5">
<h6 id="paging-with-querydsl"><a class="anchor" href="#paging-with-querydsl"></a>Paging with Querydsl</h6>
<div class="paragraph">
<p>Pagination is also supported for dynamic queries with Querydsl:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  public Page&lt;DishEntity&gt; findDishes(DishSearchCriteriaTo criteria) {
    QDishEntity dish = QDishEntity.dishEntity;
    JPAQuery&lt;DishEntity&gt; query = new JPAQuery&lt;OrderEntity&gt;(getEntityManager());
    query.from(dish);

    // conditions

    int page = criteria.getPageNumber();
    int size = criteria.getPageSize();
    Pageable pageable = PageRequest.of(page, size);
    query.offset(pageable.getOffset());
    query.limit(pageable.getPageSize());

    List&lt;DishEntity&gt; dishes = query.fetch();
    return new PageImpl&lt;&gt;(dishes, pageable, dishes.size());
  }</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="pagination-example"><a class="anchor" href="#pagination-example"></a>Pagination example</h6>
<div class="paragraph">
<p>For the table entity we can make a search request by accessing the REST endpoint with pagination support like in the following examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">POST mythaistar/services/rest/tablemanagement/v1/table/search
{
  "pagination": {
    "size":2,
    "total":true
  }
}

//Response
{
    "pagination": {
        "size": 2,
        "page": 1,
        "total": 11
    },
    "result": [
        {
            "id": 101,
            "modificationCounter": 1,
            "revision": null,
            "waiterId": null,
            "number": 1,
            "state": "OCCUPIED"
        },
        {
            "id": 102,
            "modificationCounter": 1,
            "revision": null,
            "waiterId": null,
            "number": 2,
            "state": "FREE"
        }
    ]
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As we are requesting with the <code>total</code> property set to <code>true</code> the server responds with the total count of rows for the query.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For retrieving a concrete page, we provide the <code>page</code> attribute with the desired value. Here we also left out the <code>total</code> property so the server doesn&#8217;t incur on the effort to calculate it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">POST mythaistar/services/rest/tablemanagement/v1/table/search
{
  "pagination": {
    "size":2,
    "page":2
  }
}

//Response

{
    "pagination": {
        "size": 2,
        "page": 2,
        "total": null
    },
    "result": [
        {
            "id": 103,
            "modificationCounter": 1,
            "revision": null,
            "waiterId": null,
            "number": 3,
            "state": "FREE"
        },
        {
            "id": 104,
            "modificationCounter": 1,
            "revision": null,
            "waiterId": null,
            "number": 4,
            "state": "FREE"
        }
    ]
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="pagingation-in-devon4j-spring"><a class="anchor" href="#pagingation-in-devon4j-spring"></a>Pagingation in devon4j-spring</h6>
<div class="paragraph">
<p>For spring applications, devon4j also offers its own solution for pagination. You can find an example of this <a href="spring/guide-querydsl-spring#pagination">here</a>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="query-meta-parameters"><a class="anchor" href="#query-meta-parameters"></a>Query Meta-Parameters</h5>
<div class="paragraph">
<p>Queries can have meta-parameters and that are provided via <code>SearchCriteriaTo</code>. Besides paging (see above) we also get <a href="https://github.com/devonfw/devon4j/blob/develop/modules/jpa-basic/src/main/java/com/devonfw/module/jpa/dataaccess/api/QueryHelper.java#L51">timeout support</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="advanced-queries"><a class="anchor" href="#advanced-queries"></a>Advanced Queries</h5>
<div class="paragraph">
<p>Writing queries can sometimes get rather complex. The current examples given above only showed very simple basics. Within this topic a lot of advanced features need to be considered like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.w3schools.com/sql/sql_join.asp">Joins</a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/html/E13946_04/ejb3_langref.html#ejb3_langref_constructor">Constructor queries</a></p>
</li>
<li>
<p><a href="https://www.w3schools.com/sql/sql_orderby.asp">Order By</a> (Sorting)</p>
</li>
<li>
<p><a href="https://www.w3schools.com/sql/sql_groupby.asp">Grouping</a></p>
</li>
<li>
<p><a href="https://www.w3schools.com/sql/sql_having.asp">Having</a></p>
</li>
<li>
<p><a href="https://www.w3schools.com/sql/sql_union.asp">Unions</a></p>
</li>
<li>
<p><a href="https://docs.oracle.com/cd/E11035_01/kodo41/full/html/ejb3_langref.html#ejb3_langref_subqueries">Sub-Queries</a></p>
</li>
<li>
<p>Aggregation functions like e.g. <a href="https://www.w3schools.com/sql/sql_count_avg_sum.asp">count/avg/sum</a></p>
</li>
<li>
<p><a href="https://www.w3schools.com/sql/sql_distinct.asp">Distinct selections</a></p>
</li>
<li>
<p>SQL Hints (see e.g. <a href="https://docs.oracle.com/cd/B19306_01/server.102/b14211/hintsref.htm#i8327">Oracle hints</a> or <a href="http://sqlhints.com/">SQL-Server hints</a>) - only when required for ultimate performance tuning</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This list is just containing the most important aspects. As we can not cover all these topics here, they are linked to external documentation that can help and guide you.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Spring Data
<a href="https://projects.spring.io/spring-data-jpa/">Spring Data JPA</a> is supported by both Spring and Quarkus. However, in Quarkus this approach still has some limitations. For detailed information, see the official <a href="https://quarkus.io/guides/spring-data-jpa">Quarkus Spring Data guide</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="motivation-2"><a class="anchor" href="#motivation-2"></a>Motivation</h5>
<div class="paragraph">
<p>The benefits of Spring Data are (for examples and explanations see next sections):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All you need is one single repository interface for each entity. No need for a separate implementation or other code artifacts like XML descriptors, <code>NamedQueries</code> class, etc.</p>
</li>
<li>
<p>You have all information together in one place (the repository interface) that actually belong together (where as in the classic approach you have the static <a href="guide-jpa-query">queries</a> in an XML file, constants to them in <code>NamedQueries</code> class and referencing usages in DAO implementation classes).</p>
</li>
<li>
<p>Static <a href="guide-jpa-query">queries</a> are most simple to realize as you do not need to write any method body. This means you can develop faster.</p>
</li>
<li>
<p>Support for paging is already build-in. Again for static <a href="guide-jpa-query">query</a> method the is nothing you have to do except using the paging objects in the signature.</p>
</li>
<li>
<p>Still you have the freedom to write custom implementations via default methods within the repository interface (e.g. for dynamic queries).</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="dependency"><a class="anchor" href="#dependency"></a>Dependency</h5>
<div class="paragraph">
<p>In case you want to switch to or add Spring Data support to your Spring or Quarkus application, all you need is to add the respective maven dependency:</p>
</div>
<div class="listingblock">
<div class="title">Listing 7. <strong>spring</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 8. <strong>quarkus</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-spring-data-jpa&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="repository-2"><a class="anchor" href="#repository-2"></a>Repository</h5>
<div class="paragraph">
<p>For each entity <code>«Entity»Entity</code> an interface is created with the name <code>«Entity»Repository</code> extending <a href="https://docs.spring.io/spring-data/jpa/docs/current/api/org/springframework/data/jpa/repository/JpaRepository.html">JpaRepository</a>.
Such repository is the analogy to a <a href="guide-dao">Data-Access-Object (DAO)</a> used in the classic approach or when Spring Data is not an option.</p>
</div>
<div class="listingblock">
<div class="title">Listing 9. <strong>Repository</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface ProductRepository extends JpaRepository&lt;ProductEntity, Long&gt; {

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Spring Data repository provides some basic implementations for accessing data, e.g. returning all instances of a type (<code>findAll</code>) or returning an instance by its ID (<code>findById</code>).</p>
</div>
</div>
<div class="sect4">
<h5 id="custom-method-implementation"><a class="anchor" href="#custom-method-implementation"></a>Custom method implementation</h5>
<div class="paragraph">
<p>In addition, repositories can be enriched with additional functionality, e.g. to add QueryDSL functionality or to override the default implementations, by using so called repository fragments:</p>
</div>
<div class="sect5">
<h6 id="example-2"><a class="anchor" href="#example-2"></a>Example</h6>
<div class="paragraph">
<p>The following example shows how to write such a repository:</p>
</div>
<div class="listingblock">
<div class="title">Listing 10. <strong>Repository</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface ProductRepository extends JpaRepository&lt;ProductEntity, Long&gt;, ProductFragment {

  @Query("SELECT product FROM ProductEntity product" //
      + " WHERE product.title = :title")
  List&lt;ProductEntity&gt; findByTitle(@Param("title") String title);

  @Query("SELECT product FROM ProductEntity product" //
      + " WHERE product.title = :title")
  Page&lt;ProductEntity&gt; findByTitlePaginated(@Param("title") String title, Pageable pageable);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 11. <strong>Repository fragment</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface ProductFragment {
  Page&lt;ProductEntity&gt; findByCriteria(ProductSearchCriteriaTo criteria);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 12. <strong>Fragment implementation</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class ProductFragmentImpl implements ProductFragment {
  @Inject
  EntityManager entityManager;

  public Page&lt;ProductEntity&gt; findByCriteria(ProductSearchCriteriaTo criteria) {
    QProductEntity product = QProductEntity.productEntity;
    JPAQuery&lt;ProductEntity&gt; query = new JPAQuery&lt;ProductEntity&gt;(this.entityManager);
    query.from(product);

    String title = criteria.getTitle();
    if ((title != null) &amp;&amp; !title.isEmpty()) {
      query.where(product.title.eq(title));
    }

    List&lt;ProductEntity&gt; products = query.fetch();
    return new PageImpl&lt;&gt;(products, PageRequest.of(criteria.getPageNumber(), criteria.getPageSize()), products.size());
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This <code>ProductRepository</code> has the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CRUD support from Spring Data (see <a href="https://docs.spring.io/spring-data/data-jpa/docs/current/api/org/springframework/data/jpa/repository/JpaRepository.html">JavaDoc</a> for details).</p>
</li>
<li>
<p>Support for <a href="https://github.com/devonfw/devon4j/blob/develop/modules/jpa-spring-data/src/main/java/com/devonfw/module/jpa/dataaccess/api/data/QueryDslSupport.java">QueryDSL integration</a>, <a href="https://github.com/devonfw/devon4j/blob/develop/modules/jpa-basic/src/main/java/com/devonfw/module/jpa/dataaccess/api/QueryUtil.java">paging and more</a>.</p>
</li>
<li>
<p>A static <a href="guide-jpa-query">query</a> method <code>findByTitle</code> to find all <code>ProductEntity</code> instances from DB that have the given title. Please note the <code>@Param</code> annotation that links the method parameter with the variable inside the query (<code>:title</code>).</p>
</li>
<li>
<p>The same with pagination support via findByTitlePaginated method.</p>
</li>
<li>
<p>A dynamic <a href="guide-jpa-query">query</a> method <code>findByCriteria</code> showing the QueryDSL and paging integration into Spring via a fragment implementation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find an implementation of this <code>ProductRepository</code> in our <a href="https://github.com/devonfw-sample/devon4quarkus-reference/tree/master/src/main/java/com/devonfw/quarkus/productmanagement/domain/repo">Quarkus reference application</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In Quarkus, native and named queries via the <code>@Query</code> annotation are currently not supported
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="integration-of-spring-data-in-devon4j-spring"><a class="anchor" href="#integration-of-spring-data-in-devon4j-spring"></a>Integration of Spring Data in devon4j-spring</h6>
<div class="paragraph">
<p>For Spring applications, devon4j offers a proprietary solution that integrates seamlessly with QueryDSL and uses default methods instead of the fragment approach. A separate guide for this can be found <a href="spring/guide-devon4j-spring-repository">here</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="custom-methods-without-fragment-approach"><a class="anchor" href="#custom-methods-without-fragment-approach"></a>Custom methods without fragment approach</h6>
<div class="paragraph">
<p>The fragment approach is a bit laborious, as three types (repository interface, fragment interface and fragment implementation) are always needed to implement custom methods.
We cannot simply use default methods within the repository because we cannot inject the <code>EntityManager</code> directly into the repository interface.</p>
</div>
<div class="paragraph">
<p>As a workaround, you can create a <code>GenericRepository</code> interface, as is done in the <a href="https://github.com/devonfw/devon4j/tree/master/modules/jpa-spring-data/src/main/java/com/devonfw/module/jpa/dataaccess/impl/data">devon4j jpa-spring-data module</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface GenericRepository&lt;E&gt; {

  EntityManager getEntityManager();

  ...
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class GenericRepositoryImpl&lt;E&gt; implements GenericRepository&lt;E&gt; {

  @Inject
  EntityManager entityManager;

  @Override
  public EntityManager getEntityManager() {

    return this.entityManager;
  }

  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, all your repository interfaces can extend the <code>GenericRepository</code> and you can implement queries directly in the repository interface using default methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface ProductRepository extends JpaRepository&lt;ProductEntity, Long&gt;, GenericRepository&lt;ProductEntity&gt; {

  default Page&lt;ProductEntity&gt; findByTitle(Title title) {

    EntityManager entityManager = getEntityManager();
    Query query = entityManager.createNativeQuery("select * from Product where title = :title", ProductEntity.class);
    query.setParameter("title", title);
    List&lt;ProductEntity&gt; products = query.getResultList();
    return new PageImpl&lt;&gt;(products);
  }

  ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="drawbacks"><a class="anchor" href="#drawbacks"></a>Drawbacks</h5>
<div class="paragraph">
<p>Spring Data also has some drawbacks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Some kind of magic behind the scenes that are not so easy to understand. So in case you want to extend all your repositories without providing the implementation via a default method in a parent repository interface you need to deep-dive into Spring Data. We assume that you do not need that and hope what Spring Data and devon already provides out-of-the-box is already sufficient.</p>
</li>
<li>
<p>The Spring Data magic also includes guessing the query from the method name. This is not easy to understand and especially to debug. Our suggestion is not to use this feature at all and either provide a <code>@Query</code> annotation or an implementation via default method.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="limitations-in-quarkus"><a class="anchor" href="#limitations-in-quarkus"></a>Limitations in Quarkus</h5>
<div class="ulist">
<ul>
<li>
<p>Native and named queries are not supported using <code>@Query</code> annotation. You will receive something like: <em>Build step io.quarkus.spring.data.deployment.SpringDataJPAProcessor#build threw an exception: java.lang.IllegalArgumentException: Attribute nativeQuery of @Query is currently not supported</em></p>
</li>
<li>
<p>Customizing the base repository for all repository interfaces in the code base, which is done in Spring Data by registering a class the extends <code>SimpleJpaRepository</code></p>
</li>
</ul>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Data Access Object</p>
</div>
<div class="paragraph">
<p>The <em>Data Access Objects</em> (DAOs) are part of the persistence layer.
They are responsible for a specific <a href="#entity">entity</a> and should be named <code>«Entity»Dao</code> and <code>«Entity»DaoImpl</code>.
The DAO offers the so called CRUD-functionalities (create, retrieve, update, delete) for the corresponding entity.
Additionally a DAO may offer advanced operations such as <a href="guide-jpa-query">query</a> or locking methods.</p>
</div>
</div>
<div class="sect4">
<h5 id="dao-interface"><a class="anchor" href="#dao-interface"></a>DAO Interface</h5>
<div class="paragraph">
<p>For each DAO there is an interface named <code>«Entity»Dao</code> that defines the API. For CRUD support and common naming we derive it from the <code>ApplicationDao</code> interface that comes with the devon application template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface MyEntityDao extends ApplicationDao&lt;MyEntity&gt; {
  List&lt;MyEntity&gt; findByCriteria(MyEntitySearchCriteria criteria);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All CRUD operations are inherited from <code>ApplicationDao</code> so you only have to declare the additional methods.</p>
</div>
</div>
<div class="sect4">
<h5 id="dao-implementation"><a class="anchor" href="#dao-implementation"></a>DAO Implementation</h5>
<div class="paragraph">
<p>Implementing a DAO is quite simple. We create a class named <code>«Entity»DaoImpl</code> that extends <code>ApplicationDaoImpl</code> and implements your <code>«Entity»Dao</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MyEntityDaoImpl extends ApplicationDaoImpl&lt;MyEntity&gt; implements MyEntityDao {

  public List&lt;MyEntity&gt; findByCriteria(MyEntitySearchCriteria criteria) {
    TypedQuery&lt;MyEntity&gt; query = createQuery(criteria, getEntityManager());
    return query.getResultList();
  }
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again you only need to implement the additional non-CRUD methods that you have declared in your <code>«Entity»Dao</code> interface.
In the DAO implementation you can use the method <code>getEntityManager()</code> to access the <code>EntityManager</code> from the JPA. You will need the <code>EntityManager</code> to create and execute <a href="guide-jpa-query">queries</a>.</p>
</div>
<div class="sect5">
<h6 id="static-queries-for-dao-implementation"><a class="anchor" href="#static-queries-for-dao-implementation"></a>Static queries for DAO Implementation</h6>
<div class="paragraph">
<p>All static <a href="guide-jpa-query">queries</a> are declared in the file <code>src\main\resources\META-INF\orm.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;entity-mappings version="1.0" xmlns="http://java.sun.com/xml/ns/persistence/orm" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm http://java.sun.com/xml/ns/persistence/orm_1_0.xsd"&gt;
  &lt;named-query name="find.dish.with.max.price"&gt;
    &lt;query&gt;&lt;![SELECT dish FROM DishEntity dish WHERE dish.price &lt;= :maxPrice]]&gt;&lt;/query&gt;
  &lt;/named-query&gt;
  ...
&lt;/hibernate-mapping&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>When your application is started, all these static queries will be created as prepared statements. This allows better performance and also ensures that you get errors for invalid JPQL queries when you start your app rather than later when the query is used.</p>
</div>
<div class="paragraph">
<p>To avoid redundant occurrences of the query name (<code>get.open.order.positions.for.order</code>) we define a constant for each named query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class NamedQueries {
  public static final String FIND_DISH_WITH_MAX_PRICE = "find.dish.with.max.price";
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that changing the name of the java constant (<code>FIND_DISH_WITH_MAX_PRICE</code>) can be done easily with refactoring. Further you can trace where the query is used by searching the references of the constant.</p>
</div>
<div class="paragraph">
<p>The following listing shows how to use this query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public List&lt;DishEntity&gt; findDishByMaxPrice(BigDecimal maxPrice) {
  Query query = getEntityManager().createNamedQuery(NamedQueries.FIND_DISH_WITH_MAX_PRICE);
  query.setParameter("maxPrice", maxPrice);
  return query.getResultList();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Via <code>EntityManager.createNamedQuery(String)</code> we create an instance of <code>Query</code> for our predefined static query.
Next we use <code>setParameter(String, Object)</code> to provide a parameter (<code>maxPrice</code>) to the query. This has to be done for all parameters of the query.</p>
</div>
<div class="paragraph">
<p>Note that using the <code>createQuery(String)</code> method, which takes the entire query as string (that may already contain the parameter) is not allowed to avoid SQL injection vulnerabilities.
When the method <code>getResultList()</code> is invoked, the query is executed and the result is delivered as <code>List</code>. As an alternative, there is a method called <code>getSingleResult()</code>, which returns the entity if the query returned exactly one and throws an exception otherwise.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==JPA Performance
When using JPA the developer sometimes does not see or understand where and when statements to the database are triggered.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Establishing expectations Developers shouldn’t expect to sprinkle magic pixie dust on POJOs in hopes they will become persistent.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Dan Allen<br>
<cite>https://epdf.tips/seam-in-action.html</cite>
</div>
</div>
<div class="paragraph">
<p>So in case you do not understand what is going on under the hood of JPA, you will easily run into performance issues due to lazy loading and other effects.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="n-plus-1-problem"><a class="anchor" href="#n-plus-1-problem"></a>N plus 1 Problem</h5>
<div class="paragraph">
<p>The most prominent phenomena is call the <code>N+1 Problem</code>.
We use entities from our <a href="https://github.com/devonfw/my-thai-star">MTS</a> demo app as an example to explain the problem.
There is a <a href="https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/dishmanagement/dataaccess/api/DishEntity.java">DishEntity</a> that has a <code>@ManyToMany</code> relation to
<a href="https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/dishmanagement/dataaccess/api/IngredientEntity.java">IngredientEntity</a>.
Now we assume that we want to iterate all ingredients for a dish like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">DishEntity dish = dao.findDishById(dishId);
BigDecimal priceWithAllExtras = dish.getPrice();
for (IngredientEntity ingredient : dish.getExtras()) {
  priceWithAllExtras = priceWithAllExtras.add(ingredient.getPrice());
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now <code>dish.getExtras()</code> is loaded lazy. Therefore the JPA vendor will provide a list with lazy initialized instances of <code>IngredientEntity</code> that only contain the ID of that entity. Now with every call of <code>ingredient.getPrice()</code> we technically trigger an SQL query statement to load the specific <code>IngredientEntity</code> by its ID from the database.
Now <code>findDishById</code> caused 1 initial query statement and for any number <code>N</code> of ingredients we are causing an additional query statement. This makes a total of <code>N+1</code> statements. As causing statements to the database is an expensive operation with a lot of overhead (creating connection, etc.) this ends in bad performance and is therefore a problem (the N+1 Problem).</p>
</div>
</div>
<div class="sect4">
<h5 id="solving-n-plus-1-problem"><a class="anchor" href="#solving-n-plus-1-problem"></a>Solving N plus 1 Problem</h5>
<div class="paragraph">
<p>To solve the N+1 Problem you need to change your code to only trigger a single statement instead. This can be archived in various ways. The most universal solution is to use <code>FETCH JOIN</code> in order to pre-load the nested <code>N</code> child entities into the first level cache of the JPA vendor implementation. This will behave very similar as if the <code>@ManyToMany</code> relation to <code>IngredientEntity</code> was having <code>FetchType.EAGER</code> but only for the specific query and not in general. Because changing <code>@ManyToMany</code> to <code>FetchType.EAGER</code> would cause bad performance for other usecases where only the dish but not its extra ingredients are needed. For this reason all relations, including <code>@OneToOne</code> should always be <code>FetchType.LAZY</code>. Back to our example we simply replace <code>dao.findDishById(dishId)</code> with <code>dao.findDishWithExtrasById(dishId)</code> that we implement by the following JPQL query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">SELECT dish FROM DishEntity dish
  LEFT JOIN FETCH dish.extras
  WHERE dish.id = :dishId</code></pre>
</div>
</div>
<div class="paragraph">
<p>The rest of the code does not have to be changed but now <code>dish.getExtras()</code> will get the <code>IngredientEntity</code> from the first level cache where is was fetched by the initial query above.</p>
</div>
<div class="paragraph">
<p>Please note that if you only need the sum of the prices from the extras you can also create a query using an aggregator function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SELECT sum(dish.extras.price) FROM DishEntity dish</pre>
</div>
</div>
<div class="paragraph">
<p>As you can see you need to understand the concepts in order to get good performance.</p>
</div>
<div class="paragraph">
<p>There are many advanced topics such as creating database indexes or calculating statistics for the query optimizer to get the best performance. For such advanced topics we recommend to have a database expert in your team that cares about such things. However, understanding the <em>N+1 Problem</em> and its solutions is something that every Java developer in the team needs to understand.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==IdRef</p>
</div>
<div class="paragraph">
<p>IdRef can be used to reference other entities in TOs in order to make them type-safe and semantically more expressive.
It is an optional concept in devon4j for more complex applications that make intensive use of relations and foreign keys.</p>
</div>
</div>
<div class="sect4">
<h5 id="motivation-3"><a class="anchor" href="#motivation-3"></a>Motivation</h5>
<div class="paragraph">
<p>Assuming you have a method signature like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Long approve(Long cId, Long cuId);</code></pre>
</div>
</div>
<div class="paragraph">
<p>So what are the paremeters? What is returned?</p>
</div>
<div class="paragraph">
<p><code>IdRef</code> is just a wrapper for a Long used as foreign key. This makes our signature much more expressive and self-explanatory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">IdRef&lt;Contract&gt; approve(IdRef&lt;Contract&gt; cId, IdRef&lt;Customer&gt; cuId);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we can easily see, that the result and the parameters are foreign-keys and which entity they are referring to via their generic type.
We can read the javadoc of these entities from the generic type and understand the context.
Finally, when passing <code>IdRef</code> objects to such methods, we get compile errors in case we accidentally place parameters in the wrong order.</p>
</div>
</div>
<div class="sect4">
<h5 id="idref-and-mapping"><a class="anchor" href="#idref-and-mapping"></a>IdRef and Mapping</h5>
<div class="paragraph">
<p>In order to easily map relations from entities to <a href="guide-transferobject">transfer-objects</a> and back, we can easily also put according getters and setters into our entities:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class ContractEntity extends ApplicationPersistenceEntity implements Contract {

  private CustomerEntity customer;

  ...

  @ManyToOne(fetch = FetchType.LAZY)
  @JoinColumn(name = "CUSTOMER_ID")
  public CustomerEntity getCustomer() {
    return this.customer;
  }

  public void setCustomer(CustomerEntity customer) {
    this.customer = customer;
  }

  @Transient
  public IdRef&lt;Customer&gt; getCustomerId() {
    return IdRef.of(this.customer);
  }

  public void setCustomerId(IdRef&lt;Customer&gt; customerId) {
    this.customer = JpaHelper.asEntity(customerId, CustomerEntity.class);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, ensure that you have the same getters and setters for <code>customerId</code> in your <code>Eto</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class ContractEto extends AbstractEto implements Contract {

  private IdRef&lt;Customer&gt; customerId;

  ...

  public IdRef&lt;Customer&gt; getCustomerId() {
    return this.customerId;
  }

  public void setCustomerId(IdRef&lt;Customer&gt; customerId) {
    this.customerId = customerId;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This way the bean-mapper can automatically map from your entity (<code>ContractEntity</code>) to your Eto (<code>ContractEto</code>) and vice-versa.</p>
</div>
</div>
<div class="sect4">
<h5 id="jpahelper-and-entitymanager-access"><a class="anchor" href="#jpahelper-and-entitymanager-access"></a>JpaHelper and EntityManager access</h5>
<div class="paragraph">
<p>In the above example we used <code>JpaHelper.asEntity</code> to convert the foreign key (<code>IdRef&lt;Customer&gt;</code>) to the according entity (<code>CustomerEntity</code>).
This will internally use <code>EntityManager.getReference</code> to properly create a JPA entity.
The alternative "solution" that may be used with <code>Long</code> instead of <code>IdRef</code> is typically:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  public void setCustomerId(IdRef&lt;Customer&gt; customerId) {
    Long id = null;
    if (customerId != null) {
      id = customerId.getId();
    }
    if (id == null) {
      this.customer = null;
    } else {
      this.customer = new CustomerEntity();
      this.customer.setId(id);
    }
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>While this "solution" works is most cases, we discovered some more complex cases, where it fails with very strange hibernate exceptions.
When cleanly creating the entity via <code>EntityManager.getReference</code> instead it is working in all cases.
So how can <code>JpaHelper.asEntity</code> as a static method access the <code>EntityManager</code>?
Therefore we need to initialize this as otherwise you may see this exception:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>java.lang.IllegalStateException: EntityManager has not yet been initialized!
	at com.devonfw.module.jpa.dataaccess.api.JpaEntityManagerAccess.getEntityManager(JpaEntityManagerAccess.java:38)
	at com.devonfw.module.jpa.dataaccess.api.JpaHelper.asEntity(JpaHelper.java:49)</code></pre>
</div>
</div>
<div class="paragraph">
<p>For main usage in your application we assume that there is only one instance of <code>EntityManager</code>.
Therefore we can initialize this instance during the spring boot setup.
This is what we provide for you in <a href="https://github.com/devonfw/devon4j/blob/master/modules/jpa-basic/src/main/java/com/devonfw/module/jpa/dataaccess/api/JpaInitializer.java">JpaInitializer</a> for you
when <a href="tutorial-newapp">creating a devon4j app</a>.</p>
</div>
<div class="sect5">
<h6 id="jpahelper-and-spring-test"><a class="anchor" href="#jpahelper-and-spring-test"></a>JpaHelper and spring-test</h6>
<div class="paragraph">
<p>Further, you also want your code to work in integration tests.
Spring-test provides a lot of magic under the hood to make integration testing easy for you.
To boost the performance when running multiple tests, spring is smart and avoids creating the same spring-context multiple times.
Therefore it stores these contexts so that if a test-case is executed with a specific spring-configuration that has already been setup before,
the same spring-context can be reused instead of creating it again.
However, your tests may have multiple spring configurations leading to multiple spring-contexts.
Even worse these tests can run in any order leading to switching between spring-contexts forth and back.
Therefore, a static initializer during the spring boot setup can lead to strange errors as you can get the wrong <code>EntityManager</code> instance.
In order to fix such problems, we provide a solution pattern via <a href="https://github.com/devonfw/devon4j/blob/master/modules/test-jpa/src/main/java/com/devonfw/module/test/common/base/DbTest.java#L32">DbTest</a> ensuring for every test,
that the proper instance of <code>EntityManager</code> is initialized.
Therefore you should derive directly or indirectly (e.g. via <code>ComponentDbTest</code> and <code>SubsystemDbTest</code>) from <code>DbTesT</code> or adopt your own way to apply this pattern to your tests, when using <code>JpaHelper</code>.
This already happens if you are extending <code>ApplicationComponentTest</code> or <code>ApplicationSubsystemTest</code>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Transaction Handling</p>
</div>
<div class="paragraph">
<p>For transaction handling we <a href="guide-aop">AOP</a> to add transaction control via annotations as aspect.
This is done by annotating your code with the <code>@Transactional</code> annotation.
You can either annotate your <a href="guide-dependency-injection#key-principles">container bean</a> at class level to make all methods transactional or your can annotate individual methods to make them transactional:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Transactional
  public Output getData(Input input) {
    ...
  }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="jta-imports"><a class="anchor" href="#jta-imports"></a>JTA Imports</h5>
<div class="paragraph">
<p>Here are the import statements for transaction support:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import javax.transaction.Transactional;</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Use the above import statement to follow JEE and avoid using <code>org.springframework.transaction.annotation.Transactional</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="jta-dependencies"><a class="anchor" href="#jta-dependencies"></a>JTA Dependencies</h5>
<div class="paragraph">
<p>Please note that with <a href="https://jakarta.ee/">Jakarta EE</a> the dependencies have changed.
When you want to start with Jakarta EE you should use these dependencies to get the annoations for dependency injection:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;!-- Java Transaction API (JTA) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;jakarta.transaction&lt;/groupId&gt;
  &lt;artifactId&gt;jakarta.transaction-api&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that with <a href="quarkus">quarkus</a> you will get them as transitive dependencies out of the box.
The above Jakarate EE dependencies replace these JEE depdencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;!-- Java Transaction API (JTA) --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;javax.transaction&lt;/groupId&gt;
  &lt;artifactId&gt;javax.transaction-api&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="handling-constraint-violations"><a class="anchor" href="#handling-constraint-violations"></a>Handling constraint violations</h5>
<div class="paragraph">
<p>Using <code>@Transactional</code> magically wraps transaction handling around your code.
As constraints are checked by the database at the end when the transaction gets committed, a constraint violation will be thrown by this aspect outside your code.
In case you have to handle constraint violations manually, you have to do that in code outside the logic that is annotated with <code>@Transactional</code>.
This may be done in a <a href="guide-service-layer">service operation</a> by catching a <code>ConstraintViolationException</code> (<code>org.hibernate.exception.ConstraintViolationException</code> for hibernate).
As a generic approach you can solve this via <a href="guide-rest#rest-exception-handling">REST execption handling</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="batches"><a class="anchor" href="#batches"></a>Batches</h5>
<div class="paragraph">
<p>Transaction control for batches is a lot more complicated and is described in the <a href="guide-batch-layer">batch layer</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==SQL</p>
</div>
<div class="paragraph">
<p>For general guides on dealing or avoiding SQL, preventing SQL-injection, etc. you should study <a href="guide-domain-layer">domain layer</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="naming-conventions"><a class="anchor" href="#naming-conventions"></a>1.28. Naming Conventions</h4>
<div class="paragraph">
<p>Here we define naming conventions that you should follow whenever you write SQL files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All SQL-Keywords in UPPER CASE</p>
</li>
<li>
<p>Indentation should be 2 spaces as suggested by devonfw for every format.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="ddl"><a class="anchor" href="#ddl"></a>DDL</h5>
<div class="paragraph">
<p>The naming conventions for database constructs (tables, columns, triggers, constraints, etc.) should be aligned with your database product and their operators.
However, when you have the freedom of choice and a modern case-sensitive database, you can simply use your code conventions also for database constructs to avoid explicitly mapping each and every property (e.g. <code>RestaurantTable</code> vs. <code>RESTAURANT_TABLE</code>).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Define columns and constraints inline in the statement to create the table</p>
</li>
<li>
<p>Indent column types so they all start in the same text column</p>
</li>
<li>
<p>Constraints should be named explicitly (to get a reasonable hint error messages) with:</p>
<div class="ulist">
<ul>
<li>
<p><code>PK_«table»</code> for primary key (name optional here as PK constraint are fundamental)</p>
</li>
<li>
<p><code>FK_«table»_«property»</code> for foreign keys (<code>«table»</code> and <code>«property»</code> are both on the source where the foreign key is defined)</p>
</li>
<li>
<p><code>UC_«table»_«property»[_«propertyN»]*</code> for unique constraints</p>
</li>
<li>
<p><code>CK_«table»_«check»</code> for check constraints (<code>«check»</code> describes the check, if it is defined on a single property it should start with the property).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Old RDBMS had hard limitations for names (e.g. 30 characters). Please note that recent databases have overcome this very low length limitations. However, keep your names short but precise and try to define common abbreviations in your project for according (business) terms. Especially do not just truncate the names at the limit.</p>
</li>
<li>
<p>If possible add comments on table and columns to help DBAs understanding your schema. This is also honored by many tools (not only DBA-tools).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is a brief example of a DDL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE SEQUENCE HIBERNATE_SEQUENCE START WITH 1000000;

-- *** Table ***
CREATE TABLE RESTAURANT_TABLE (
  ID                   NUMBER(19) NOT NULL,
  MODIFICATION_COUNTER INTEGER NOT NULL,
  SEATS                INTEGER NOT NULL,
  CONSTRAINT PK_TABLE PRIMARY KEY(ID)
);
COMMENT ON TABLE RESTAURANT_TABLE IS 'The physical tables inside the restaurant.';
-- *** Order ***
CREATE TABLE RESTAURANT_ORDER (
  ID                   NUMBER(19) NOT NULL,
  MODIFICATION_COUNTER INTEGER NOT NULL,
  TABLE_ID             NUMBER(19) NOT NULL,
  TOTAL                DECIMAL(5, 2) NOT NULL,
  CREATION_DATE        TIMESTAMP NOT NULL,
  PAYMENT_DATE         TIMESTAMP,
  STATUS               VARCHAR2(10 CHAR) NOT NULL,
  CONSTRAINT PK_ORDER PRIMARY KEY(ID),
  CONSTRAINT FK_ORDER_TABLE_ID FOREIGN KEY(TABLE_ID) REFERENCES RESTAURANT_TABLE(ID)
);
COMMENT ON TABLE RESTAURANT_ORDER IS 'An order and bill at the restaurant.';
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>ATTENTION: Please note that <code>TABLE</code> and <code>ORDER</code> are reserved keywords in SQL and you should avoid using such keywords to prevent problems.</p>
</div>
</div>
<div class="sect4">
<h5 id="data"><a class="anchor" href="#data"></a>Data</h5>
<div class="paragraph">
<p>For insert, update, delete, etc. of data SQL scripts should additionally follow these guidelines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inserts always with the same order of columns in blocks for each table.</p>
</li>
<li>
<p>Insert column values always starting with ID, MODIFICATION_COUNTER, [DTYPE, ] &#8230;&#8203;</p>
</li>
<li>
<p>List columns with fixed length values (boolean, number, enums, etc.) before columns with free text to support alignment of multiple insert statements</p>
</li>
<li>
<p>Pro Tip: Get familiar with column mode of advanced editors such as <code>notepad++</code> when editing large blocks of similar insert statements.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (0, 1, 4);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (1, 1, 4);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (2, 1, 4);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (3, 1, 4);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (4, 1, 6);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (5, 1, 6);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (6, 1, 6);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (7, 1, 8);
INSERT INTO RESTAURANT_TABLE(ID, MODIFICATION_COUNTER, SEATS) VALUES (8, 1, 8);
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>See also <a href="guide-database-migration">Database Migrations</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Database Migration</p>
</div>
<div class="paragraph">
<p>When you have a schema-based <a href="https://github.com/devonfw/devonfw-guide/blob/master/general/db/guide-database.adoc">database</a>,
you need a solution for schema versioning and migration for your database.
A specific release of your app requires a corresponding version of the schema in the database to run.
As you want simple and continuous deployment you should automate the schema versiong and database migration.</p>
</div>
<div class="paragraph">
<p>The general idea is that your software product contains "scripts" to migrate the database from schema version <code>X</code> to verion <code>X+1</code>.
When you begin your project you start with version <code>1</code> and with every increment of your app that needs a change to the database schema (e.g. a new table, a new column to an existing table, a new index, etc.) you add another "script" that migrates from the current to the next version.
For simplicity these versions are just sequential numbers or timestamps.
Now, the solution you choose will automatically manage the schema version in a separate metadata table in your database that stores the current schema version.
When your app is started, it will check the current version inside the database from that metadata table.
As long as there are "scripts" that migrate from there to a higher version, they will be automatically applied to the database and this process is protocolled to the metadata table in your database what also updates the current schema version there.
Using this approach, you can start with an empty database what will result in all "scripts" being applied sequentially.
Also any version of your database schema can be present and you will always end up in a controlled migration to the latest schema version.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="options-for-database-migration"><a class="anchor" href="#options-for-database-migration"></a>1.29. Options for database migration</h4>
<div class="paragraph">
<p>For database migration you can choose between the following options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-flyway">flyway</a> (KISS based approach with migrations as SQL)</p>
</li>
<li>
<p><a href="guide-liquibase">liquibase</a> (more complex approach with database abstraction)</p>
</li>
</ul>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Flyway</p>
</div>
<div class="paragraph">
<p><a href="http://flywaydb.org/">Flyway</a> is a tool for <a href="guide-database-migration">database migration and schema versioning</a>.
See <a href="https://flywaydb.org/getstarted/why">why</a> for a motivation why using flyway.</p>
</div>
<div class="paragraph">
<p>Flyway can be used standalone e.g. via <a href="https://flywaydb.org/documentation/getstarted/firststeps/maven">flyway-maven-plugin</a> or can be integrated directly into your app to make sure the database migration takes place on startup.
For simplicity we recommend to integrate flyway into your app.
However, you need to be aware that therefore your app needs database access with full schema owner permissions.</p>
</div>
<div class="sect4">
<h5 id="organizational-advice"><a class="anchor" href="#organizational-advice"></a>Organizational Advice</h5>
<div class="paragraph">
<p>A few considerations with respect to project organization will help to implement maintainable Flyway migrations.</p>
</div>
<div class="paragraph">
<p>At first, testing and production environments must be clearly and consistently distinguished. Use the following directory structure to achieve this distinction:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">  src/main/resources/db
  src/test/resources/db</code></pre>
</div>
</div>
<div class="paragraph">
<p>Although this structure introduces redundancies, the benefit outweighs this disadvantage.
An even more fine-grained production directory structure which contains one sub folder per release should be implemented:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">  src/main/resources/db/migration/releases/X.Y/x.sql</code></pre>
</div>
</div>
<div class="paragraph">
<p>Emphasizing that migration scripts below the current version must never be changed will aid the second advantage of migrations: it will always be clearly reproducible in which state the database currently is.
Here, it is important to mention that, if test data is required, it must be managed separately from the migration data in the following directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">  src/test/resources/db/migration/</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>migration</code> directory is added to aid easy usage of Flyway defaults.
Of course, test data should also be managed per release as like production data.</p>
</div>
<div class="paragraph">
<p>With regard to content, separation of concerns (SoC) is an important goal. SoC can be achieved by distinguishing and writing multiple scripts with respect to business components/use cases (or database tables in case of large volumes of master data <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>. Comprehensible file names aid this separation.</p>
</div>
<div class="paragraph">
<p>It is important to have clear responsibilities regarding the database, the persistence layer (JPA), and migrations. Therefore a dedicated database expert should be in charge of any migrations performed or she should at least be informed before any change to any of the mentioned parts is applied.</p>
</div>
</div>
<div class="sect4">
<h5 id="technical-configuration"><a class="anchor" href="#technical-configuration"></a>Technical Configuration</h5>
<div class="paragraph">
<p>Database migrations can be <a href="https://flywaydb.org/documentation/concepts/migrations#sql-based-migrations">SQL</a> based or <a href="https://flywaydb.org/documentation/concepts/migrations#java-based-migrations">Java</a> based.</p>
</div>
<div class="paragraph">
<p>To enable auto migration on startup (not recommended for productive environment) set the following property in the <code>application.properties</code> file for an environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">flyway.enabled=true
flyway.clean-on-validation-error=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>For development environment it is helpful to set both properties to <code>true</code> in order to simplify development. For regular environments <code>flyway.clean-on-validation-error</code> should be <code>false</code>.</p>
</div>
<div class="paragraph">
<p>If you want to use Flyway set the following property in any case to prevent Hibernate from doing changes on the database (pre-configured by default in devonfw):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">spring.jpa.hibernate.ddl-auto=validate</code></pre>
</div>
</div>
<div class="paragraph">
<p>The setting must be communicated to and coordinated with the customer and their needs.
In acceptance testing the same configuration as for the production environment should be enabled.</p>
</div>
<div class="paragraph">
<p>Since migration scripts will also be versioned the end-of-line (EOL) style must be fixated according to <a href="https://github.com/flyway/flyway/issues/253">this issue</a>. This is however solved in flyway 4.0+ and the latest devonfw release.
Also, the version numbers of migration scripts should not consist of simple ascending integer numbers like V0001<em>&#8230;&#8203;, V0002</em>&#8230;&#8203;, &#8230;&#8203; This naming may lead to problems when merging branches. Instead the usage of timestamps as version numbers will help to avoid such problems.</p>
</div>
</div>
<div class="sect4">
<h5 id="naming-conventions-2"><a class="anchor" href="#naming-conventions-2"></a>Naming Conventions</h5>
<div class="paragraph">
<p>Database migrations should follow this naming convention:
V&lt;version&gt;__&lt;description&gt; (e.g.: V12345__Add_new_table.sql).</p>
</div>
<div class="paragraph">
<p>It is also possible to use Flyway for test data. To do so place your test data migrations in src/main/resources/db/testdata/ and set property</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">flyway.locations=classpath:db/migration/releases,classpath:db/migration/testdata</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then Flyway scans the additional location for migrations and applies all in the order specified by their version. If migrations V0001__... and V0002__... exist and a test data migration should be applied in between you can name it V0001_1__....</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Liquibase</p>
</div>
<div class="paragraph">
<p><a href="https://www.liquibase.org/">Liquibase</a> is a tool for <a href="guide-database-migration">database migration and schema versioning</a>.</p>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/devonfw/devon4j/issues/303">devon4j#303</a> for details and status.</p>
</div>
</div>
<div class="sect4">
<h5 id="spring-boot-usage"><a class="anchor" href="#spring-boot-usage"></a>Spring-boot usage</h5>
<div class="paragraph">
<p>For using liquibase in <a href="spring">spring</a> see <a href="https://docs.liquibase.com/tools-integrations/springboot/springboot.html">Using Liquibase with Spring Boot</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="quarkus-usage"><a class="anchor" href="#quarkus-usage"></a>Quarkus usage</h5>
<div class="paragraph">
<p>For uisng liquibase in <a href="quarkus">quarkus</a> see <a href="https://quarkus.io/guides/liquibase">Using Liquibase</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==REST
REST (<a href="https://en.wikipedia.org/wiki/Representational_state_transfer">REpresentational State Transfer</a>) is an inter-operable protocol for <a href="guide-service-layer">services</a> that is more lightweight than <a href="guide-soap">SOAP</a>.
However, it is no real standard and can cause confusion (see <a href="https://github.com/devonfw/devon4j/blob/master/documentation/guide-rest-philosophy">REST philosophy</a>).
Therefore we define best practices here to guide you.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="urls"><a class="anchor" href="#urls"></a>1.30. URLs</h4>
<div class="paragraph">
<p>URLs are not case sensitive. Hence, we follow the best practice to use only lower-case-letters-with-hyphen-to-separate-words.
For operations in REST we distinguish the following types of URLs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <em>collection URL</em> is build from the rest service URL by appending the name of a collection. This is typically the name of an entity. Such URL identifies the entire collection of all elements of this type. Example: <code>https://mydomain.com/myapp/services/rest/mycomponent/v1/myentity</code></p>
</li>
<li>
<p>An <em>element URL</em> is build from a collection URL by appending an element ID. It identifies a single element (entity) within the collection. Example: <code>https://mydomain.com/myapp/services/rest/mycomponent/v1/myentity/42</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To follow KISS avoid using plural forms (<code>&#8230;&#8203;/productmanagement/v1/products</code> vs. <code>&#8230;&#8203;/productmanagement/v1/product/42</code>). Always use singular forms and avoid confusions (except for the rare cases where no singular exists).</p>
</div>
<div class="paragraph">
<p>The REST URL scheme fits perfect for <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> operations.
For business operations (processing, calculation, advanced search, etc.) we simply append a collection URL with the name of the business operation.
Then we can <code>POST</code> the input for the business operation and get the result back. Example: <code>https://mydomain.com/myapp/services/rest/mycomponent/v1/myentity/search</code></p>
</div>
</div>
<div class="sect3">
<h4 id="http-methods"><a class="anchor" href="#http-methods"></a>1.31. HTTP Methods</h4>
<div class="paragraph">
<p>The following table defines the HTTP methods (verbs) and their meaning:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Usage of HTTP methods</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>HTTP Method</strong></th>
<th class="tableblock halign-left valign-top"><strong>Meaning</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read data (stateless).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PUT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create or update data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>POST</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process data.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DELETE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delete an entity.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Please also note that for (large) bulk deletions you may be forced to used <code>POST</code> instead of <code>DELETE</code> as according to the HTTP standard <code>DELETE</code> must not have payload and URLs are limited in length.</p>
</div>
<div class="paragraph">
<p>For general recommendations on HTTP methods for collection and element URLs see <a href="http://en.wikipedia.org/wiki/Representational_State_Transfer#Applied_to_web_services">REST@wikipedia</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="http-status-codes"><a class="anchor" href="#http-status-codes"></a>1.32. HTTP Status Codes</h4>
<div class="paragraph">
<p>Further we define how to use the HTTP status codes for REST services properly. In general the 4xx codes correspond to an error on the client side and the 5xx codes to an error on the server side.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Usage of HTTP status codes</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>HTTP Code</strong></th>
<th class="tableblock halign-left valign-top"><strong>Meaning</strong></th>
<th class="tableblock halign-left valign-top"><strong>Response</strong></th>
<th class="tableblock halign-left valign-top"><strong>Comment</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">requested result</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Result of successful GET</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">204</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No Content</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Result of successful POST, DELETE, or PUT with empty result (void return)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">400</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bad Request</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">error details</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The HTTP request is invalid (parse error, validation failed)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">401</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unauthorized</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication failed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">403</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forbidden</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authorization failed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">404</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not found</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>none</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Either the service URL is wrong or the requested resource does not exist</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">error code, UUID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internal server error occurred, in case of an exception, see <a href="#rest-exception-handling">REST exception handling</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="jax-rs"><a class="anchor" href="#jax-rs"></a>1.33. JAX-RS</h4>
<div class="paragraph">
<p>For implementing REST services we use the <a href="https://jax-rs-spec.java.net/">JAX-RS</a> standard.
As payload encoding we recommend <a href="guide-json">JSON</a> bindings using <a href="http://wiki.fasterxml.com/JacksonHome">Jackson</a>.
To implement a REST service you simply add JAX-RS annotations.
Here is a simple example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
@Path("/imagemanagement/v1")
@Consumes(MediaType.APPLICATION_JSON)
@Produces(MediaType.APPLICATION_JSON)
public class ImagemanagementRestService {

  @Inject
  private Imagemanagement imagemanagement;

  @GET
  @Path("/image/{id}/")
  public ImageDto getImage(@PathParam("id") long id) {

    return this.imagemanagement.findImage(id);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we can see a REST service for the <a href="architecture#business-architecture">business component</a> <code>imagemanagement</code>. The method <code>getImage</code> can be accessed via HTTP GET (see <code>@GET</code>) under the URL path <code>imagemanagement/image/{id}</code> (see <code>@Path</code> annotations) where <code>{id}</code> is the ID of the requested table and will be extracted from the URL and provided as parameter <code>id</code> to the method <code>getImage</code>. It will return its result (<code>ImageDto</code>) as <a href="guide-json">JSON</a> (see <code>@Produces</code> annotation - you can also extend <code>RestService</code> marker interface that defines these annotations for JSON). As you can see it delegates to the <a href="guide-logic-layer">logic</a> component <code>imagemanagement</code> that contains the actual business logic while the service itself only exposes this logic via HTTP. The REST service implementation is a regular CDI bean that can use <a href="guide-dependency-injection">dependency injection</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
With JAX-RS it is important to make sure that each service method is annotated with the proper HTTP method (<code>@GET</code>,<code>@POST</code>,etc.) to avoid unnecessary debugging. So you should take care not to forget to specify one of these annotations.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="service-interface"><a class="anchor" href="#service-interface"></a>Service-Interface</h5>
<div class="paragraph">
<p>You may also separate API and implementation in case you want to reuse the API for <a href="guide-service-client">service-client</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Path("/imagemanagement/v1")
@Consumes(MediaType.APPLICATION_JSON)
@Produces(MediaType.APPLICATION_JSON)
public interface ImagemanagementRestService {

  @GET
  @Path("/image/{id}/")
  ImageEto getImage(@PathParam("id") long id);

}

@Named("ImagemanagementRestService")
public class ImagemanagementRestServiceImpl implements ImagemanagementRestService {

  @Override
  public ImageEto getImage(long id) {

    return this.imagemanagement.findImage(id);
  }

}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="jax-rs-configuration"><a class="anchor" href="#jax-rs-configuration"></a>JAX-RS Configuration</h5>
<div class="paragraph">
<p>Starting from CXF 3.0.0 it is possible to enable the auto-discovery of JAX-RS roots.</p>
</div>
<div class="paragraph">
<p>When the JAX-RS server is instantiated, all the scanned root and provider beans (beans annotated with <code>javax.ws.rs.Path</code> and <code>javax.ws.rs.ext.Provider</code>) are configured.</p>
</div>
</div>
<div class="sect4">
<h5 id="rest-exception-handling"><a class="anchor" href="#rest-exception-handling"></a>REST Exception Handling</h5>
<div class="paragraph">
<p>For exceptions, a service needs to have an exception facade that catches all exceptions and handles them by writing proper log messages and mapping them to a HTTP response with an corresponding <a href="#http-status-codes">HTTP status code</a>.
For this, devon4j provides a generic solution via <code>RestServiceExceptionFacade</code> that you can use within your Spring applications. You need to follow the <a href="guide-exceptions">exception guide</a> in order for it to work out of the box because the facade needs to be able to distinguish between business and technical exceptions.
To implement a generic exception facade in Quarkus, follow the <a href="quarkus/guide-exception-handling">Quarkus exception guide</a>.</p>
</div>
<div class="paragraph">
<p>Now your service may throw exceptions, but the facade will automatically handle them for you.</p>
</div>
<div class="paragraph">
<p>The general format for returning an error to the client is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{
  "message": "A human-readable message describing the error",
  "code": "A code identifying the concrete error",
  "uuid": "An identifier (generally the correlation id) to help identify corresponding requests in logs"
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="pagination-details"><a class="anchor" href="#pagination-details"></a>Pagination details</h5>
<div class="paragraph">
<p>We recommend to use <a href="guide-repository">spring-data repositories</a> for database access that already comes with pagination support.
Therefore, when performing a search, you can include a <a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Pageable.html">Pageable</a> object.
Here is a JSON example for it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{ "pageSize": 20, "pageNumber": 0, "sort": [] }</code></pre>
</div>
</div>
<div class="paragraph">
<p>By increasing the <code>pageNumber</code> the client can browse and page through the hits.</p>
</div>
<div class="paragraph">
<p>As a result you will receive a <a href="https://docs.spring.io/spring-data/commons/docs/current/api/org/springframework/data/domain/Page.html">Page</a>.
It is a container for your search results just like a <code>Collection</code> but additionally contains pagination information for the client.
Here is a JSON example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{ "totalElements": 1022,
  pageable: { "pageSize": 20, "pageNumber": 0 },
  content: [ ... ] }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>totalElements</code> property contains the total number of hits.
This can be used by the client to compute the total number of pages and render the pagination links accordingly.
Via the <code>pageable</code> property the client gets back the <code>Pageable</code> properties from the search request.
The actual hits for the current page are returned as array in the <code>content</code> property.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="rest-testing"><a class="anchor" href="#rest-testing"></a>1.34. REST Testing</h4>
<div class="paragraph">
<p>For testing REST services in general consult the <a href="guide-testing">testing guide</a>.</p>
</div>
<div class="paragraph">
<p>For manual testing REST services there are browser plugins:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Firefox: <a href="https://addons.mozilla.org/de/firefox/addon/rested/">rested</a></p>
</li>
<li>
<p>Chrome: <a href="http://www.getpostman.com/">postman</a> (<a href="https://chrome.google.com/webstore/detail/advanced-rest-client/hgmloofddffdnphfgcellkdfbfbjeloo">advanced-rest-client</a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="security-3"><a class="anchor" href="#security-3"></a>1.35. Security</h4>
<div class="paragraph">
<p>Your services are the major entry point to your application. Hence security considerations are important here.</p>
</div>
<div class="sect4">
<h5 id="csrf"><a class="anchor" href="#csrf"></a>CSRF</h5>
<div class="paragraph">
<p>A common security threat is <a href="https://www.owasp.org/index.php/Top_10_2013-A8-Cross-Site_Request_Forgery_(CSRF)">CSRF</a> for REST services. Therefore all REST operations that are performing modifications (PUT, POST, DELETE, etc. - all except GET) have to be secured against CSRF attacks. See <a href="guide-csrf">CSRF</a> how to do this.</p>
</div>
</div>
<div class="sect4">
<h5 id="json-top-level-arrays"><a class="anchor" href="#json-top-level-arrays"></a>JSON top-level arrays</h5>
<div class="paragraph">
<p>OWASP earlier suggested to never return JSON arrays at the top-level, to prevent attacks without rationale.
We digged deep and found <a href="https://haacked.com/archive/2008/11/20/anatomy-of-a-subtle-json-vulnerability.aspx/">anatomy-of-a-subtle-json-vulnerability</a>.
To sum it up the attack is many years old and does not work in any recent or relevant browser.
Hence it is fine to use arrays as top-level result in a JSON REST service (means you can return <code>List&lt;Foo&gt;</code> in a Java JAX-RS service).</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==JSON</p>
</div>
<div class="paragraph">
<p><a href="http://en.wikipedia.org/wiki/JSON">JSON</a> (JavaScript Object Notation) is a popular format to represent and exchange data especially for modern web-clients. For mapping Java objects to JSON and vice-versa there is no official standard API. We use the established and powerful open-source solution <a href="http://wiki.fasterxml.com/JacksonHome">Jackson</a>.
Due to problems with the wiki of fasterxml you should try this alternative link: <a href="https://github.com/FasterXML/jackson#jackson-project-home-github">Jackson/AltLink</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configure-json-mapping"><a class="anchor" href="#configure-json-mapping"></a>1.36. Configure JSON Mapping</h4>
<div class="paragraph">
<p>In order to avoid polluting business objects with proprietary Jackson annotations (e.g. <code>@JsonTypeInfo</code>, <code>@JsonSubTypes</code>, <code>@JsonProperty</code>) we propose to create a separate configuration class. Every devonfw application (sample or any app created from our <a href="tutorial-newapp">app-template</a>) therefore has a class called <code>ApplicationObjectMapperFactory</code> that extends ObjectMapperFactory from the devon4j-rest module. It looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named("ApplicationObjectMapperFactory")
public class ApplicationObjectMapperFactory extends ObjectMapperFactory {

  public RestaurantObjectMapperFactory() {
    super();
    // JSON configuration code goes here
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="json-and-inheritance"><a class="anchor" href="#json-and-inheritance"></a>1.37. JSON and Inheritance</h4>
<div class="paragraph">
<p>If you are using inheritance for your objects mapped to JSON then polymorphism can not be supported out-of-the box. So in general avoid polymorphic objects in JSON mapping. However, this is not always possible.
Have a look at the following example from our sample application:</p>
</div>
<div id="img-rest-inheritance" class="imageblock text-center">
<div class="content">
<img src="_images/images/REST-Inheritance.png" alt="inheritance class diagram">
</div>
<div class="title">Figure 6. Transfer-Objects using Inheritance</div>
</div>
<div class="paragraph">
<p>Now assume you have a <a href="guide-service-layer#rest">REST service operation</a> as Java method that takes a ProductEto as argument. As this is an abstract class the server needs to know the actual sub-class to instantiate.
We typically do not want to specify the classname in the JSON as this should be an implementation detail and not part of the public JSON format (e.g. in case of a service interface). Therefore we use a symbolic name for each polymorphic subtype that is provided as virtual attribute @type within the JSON data of the object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{ "@type": "Drink", ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Therefore you add configuration code to the constructor of <a href="#configure-json-mapping">ApplicationObjectMapperFactory</a>. Here you can see an example from the sample application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">setBaseClasses(ProductEto.class);
addSubtypes(new NamedType(MealEto.class, "Meal"), new NamedType(DrinkEto.class, "Drink"),
  new NamedType(SideDishEto.class, "SideDish"));</code></pre>
</div>
</div>
<div class="paragraph">
<p>We use <code>setBaseClasses</code> to register all top-level classes of polymorphic objects. Further we declare all concrete polymorphic sub-classes together with their symbolic name for the JSON format via <code>addSubtypes</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="custom-mapping"><a class="anchor" href="#custom-mapping"></a>1.38. Custom Mapping</h4>
<div class="paragraph">
<p>In order to map custom <a href="guide-datatype">datatypes</a> or other types that do not follow the Java bean conventions, you need to define a custom mapping. If you create objects dedicated for the JSON mapping you can easily avoid such situations. When this is not suitable follow these instructions to define the mapping:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>As an example, the use of JSR354 (<code>javax.money</code>) is appreciated in order to process monetary amounts properly. However, without custom mapping, the default mapping of Jackson will produce the following JSON for a <code>MonetaryAmount</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"currency": {"defaultFractionDigits":2, "numericCode":978, "currencyCode":"EUR"},
"monetaryContext": {...},
"number":6.99,
"factory": {...}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As clearly can be seen, the JSON contains too much information and reveals implementation secrets that do not belong here. Instead the JSON output expected and desired would be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"currency":"EUR","amount":"6.99"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Even worse, when we send the JSON data to the server, Jackson will see that <code>MonetaryAmount</code> is an interface and does not know how to instantiate it so the request will fail.
Therefore we need a customized <a href="https://github.com/FasterXML/jackson-docs/wiki/JacksonHowToCustomSerializers">Serializer</a>.</p>
</div>
</li>
<li>
<p>We implement <code>MonetaryAmountJsonSerializer</code> to define how a <code>MonetaryAmount</code> is serialized to JSON:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public final class MonetaryAmountJsonSerializer extends JsonSerializer&lt;MonetaryAmount&gt; {

  public static final String NUMBER = "amount";
  public static final String CURRENCY = "currency";

  public void serialize(MonetaryAmount value, JsonGenerator jgen, SerializerProvider provider) throws ... {
    if (value != null) {
      jgen.writeStartObject();
      jgen.writeFieldName(MonetaryAmountJsonSerializer.CURRENCY);
      jgen.writeString(value.getCurrency().getCurrencyCode());
      jgen.writeFieldName(MonetaryAmountJsonSerializer.NUMBER);
      jgen.writeString(value.getNumber().toString());
      jgen.writeEndObject();
    }
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>For composite datatypes it is important to wrap the info as an object (<code>writeStartObject()</code> and <code>writeEndObject()</code>). <code>MonetaryAmount</code> provides the information we need by the <code>getCurrency()</code> and <code>getNumber()</code>. So that we can easily write them into the JSON data.</p>
</div>
</li>
<li>
<p>Next, we implement <code>MonetaryAmountJsonDeserializer</code> to define how a <code>MonetaryAmount</code> is deserialized back as Java object from JSON:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public final class MonetaryAmountJsonDeserializer extends AbstractJsonDeserializer&lt;MonetaryAmount&gt; {
  protected MonetaryAmount deserializeNode(JsonNode node) {
    BigDecimal number = getRequiredValue(node, MonetaryAmountJsonSerializer.NUMBER, BigDecimal.class);
    String currencyCode = getRequiredValue(node, MonetaryAmountJsonSerializer.CURRENCY, String.class);
    MonetaryAmount monetaryAmount =
        MonetaryAmounts.getAmountFactory().setNumber(number).setCurrency(currencyCode).create();
    return monetaryAmount;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For composite datatypes we extend from <a href="https://github.com/devonfw/devon4j/blob/develop/modules/rest/src/main/java/com/devonfw/module/rest/service/impl/json/AbstractJsonDeserializer.java"><code>AbstractJsonDeserializer</code></a> as this makes our task easier. So we already get a <code>JsonNode</code> with the parsed payload of our datatype. Based on this API it is easy to retrieve individual fields from the payload without taking care of their order, etc.
<code>AbstractJsonDeserializer</code> also provides methods such as <code>getRequiredValue</code> to read required fields and get them converted to the desired basis datatype. So we can easily read the amount and currency and construct an instance of <code>MonetaryAmount</code> via the official factory API.</p>
</div>
</li>
<li>
<p>Finally we need to register our custom (de)serializers with the following configuration code in the constructor of <a href="#configure-json-mapping">ApplicationObjectMapperFactory</a>:+</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>  SimpleModule module = getExtensionModule();
  module.addDeserializer(MonetaryAmount.class, new MonetaryAmountJsonDeserializer());
  module.addSerializer(MonetaryAmount.class, new MonetaryAmountJsonSerializer());</pre>
</div>
</div>
<div class="paragraph">
<p>Now we can read and write <code>MonetaryAmount</code> from and to JSON as expected.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==XML</p>
</div>
<div class="paragraph">
<p><a href="http://en.wikipedia.org/wiki/XML">XML</a> (Extensible Markup Language) is a W3C standard format for structured information. It has a large eco-system of additional standards and tools.</p>
</div>
<div class="paragraph">
<p>In Java there are many different APIs and frameworks for accessing, producing and processing XML. For the devonfw we recommend to use <a href="#jaxb">JAXB</a> for mapping Java objects to XML and vice-versa. Further there is the popular <a href="http://docs.oracle.com/javase/7/docs/api/org/w3c/dom/package-summary.html">DOM API</a> for reading and writing smaller XML documents directly. When processing large XML documents <a href="http://en.wikipedia.org/wiki/StAX">StAX</a> is the right choice.</p>
</div>
</div>
<div class="sect3">
<h4 id="jaxb"><a class="anchor" href="#jaxb"></a>1.39. JAXB</h4>
<div class="paragraph">
<p>We use <a href="http://en.wikipedia.org/wiki/Java_Architecture_for_XML_Binding">JAXB</a> to serialize Java objects to XML or vice-versa.</p>
</div>
<div class="sect4">
<h5 id="jaxb-and-inheritance"><a class="anchor" href="#jaxb-and-inheritance"></a>JAXB and Inheritance</h5>
<div class="paragraph">
<p>Use <code>@XmlSeeAlso</code> annotation to provide sub-classes.
See section "Collective Polymorphism" described <a href="https://dzone.com/articles/java-and-xml-part-3-jaxb">here</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="jaxb-custom-mapping"><a class="anchor" href="#jaxb-custom-mapping"></a>JAXB Custom Mapping</h5>
<div class="paragraph">
<p>In order to map custom <a href="guide-datatype">datatypes</a> or other types that do not follow the Java bean conventions, you need to define a custom mapping. If you create dedicated objects for the XML mapping you can easily avoid such situations. When this is not suitable use <code>@XmlJavaTypeAdapter</code> and provide an <code>XmlAdapter</code> implementation that handles the mapping.
For details see <a href="https://www.eclipse.org/eclipselink/documentation/2.6/moxy/advanced_concepts006.htm">here</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="security-4"><a class="anchor" href="#security-4"></a>1.40. Security</h4>
<div class="paragraph">
<p>To prevent XML External Entity attacks, follow <a href="https://docs.oracle.com/en/java/javase/11/security/java-api-xml-processing-jaxp-security-guide.html">JAXP Security Guide</a> and enable <a href="https://docs.oracle.com/en/java/javase/11/security/java-api-xml-processing-jaxp-security-guide.html#GUID-88B04BE2-35EF-4F61-B4FA-57A0E9102342">FSP</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==SOAP
<a href="https://en.wikipedia.org/wiki/SOAP">SOAP</a> is a common protocol for <a href="guide-service-layer">services</a> that is rather complex and heavy. It allows to build inter-operable and well specified services (see WSDL). SOAP is transport neutral what is not only an advantage. We strongly recommend to use HTTPS transport and ignore additional complex standards like WS-Security and use established HTTP-Standards such as RFC2617 (and RFC5280).</p>
</div>
</div>
<div class="sect3">
<h4 id="jax-ws"><a class="anchor" href="#jax-ws"></a>1.41. JAX-WS</h4>
<div class="paragraph">
<p>For building web-services with Java we use the <a href="https://jcp.org/en/jsr/detail?id=224">JAX-WS</a> standard.
There are two approaches:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>code first</p>
</li>
<li>
<p>contract first</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is an example in case you define a code-first service.</p>
</div>
<div class="sect4">
<h5 id="web-service-interface"><a class="anchor" href="#web-service-interface"></a>Web-Service Interface</h5>
<div class="paragraph">
<p>We define a regular interface to define the API of the service and annotate it with JAX-WS annotations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@WebService
public interface TablemanagmentWebService {

  @WebMethod
  @WebResult(name = "message")
  TableEto getTable(@WebParam(name = "id") String id);

}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="web-service-implementation"><a class="anchor" href="#web-service-implementation"></a>Web-Service Implementation</h5>
<div class="paragraph">
<p>And here is a simple implementation of the service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named
@WebService(endpointInterface = "com.devonfw.application.mtsj.tablemanagement.service.api.ws.TablemanagmentWebService")
public class TablemanagementWebServiceImpl implements TablemanagmentWebService {

  private Tablemanagement tableManagement;

  @Override
  public TableEto getTable(String id) {

    return this.tableManagement.findTable(id);
  }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="soap-custom-mapping"><a class="anchor" href="#soap-custom-mapping"></a>1.42. SOAP Custom Mapping</h4>
<div class="paragraph">
<p>In order to map custom <a href="guide-datatype">datatypes</a> or other types that do not follow the Java bean conventions, you need to write adapters for JAXB (see <a href="guide-xml">XML</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="soap-testing"><a class="anchor" href="#soap-testing"></a>1.43. SOAP Testing</h4>
<div class="paragraph">
<p>For testing SOAP services in general consult the <a href="guide-testing">testing guide</a>.</p>
</div>
<div class="paragraph">
<p>For testing SOAP services manually we strongly recommend <a href="http://www.soapui.org/">SoapUI</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Logging</p>
</div>
<div class="paragraph">
<p>We recommend to use <a href="http://www.slf4j.org/">SLF4J</a> as API for logging, that has become a de facto standard in Java as it has a much better design than <code>java.util.logging</code> offered by the JDK.
There are serveral implementations for SLF4J. For Spring applications our recommended implementation is <a href="http://logback.qos.ch/">Logback</a>. Quarkus uses JBoss Logging which provides a JBoss Log Manager implementation for SLF4J. For more information on logging in Quarkus, see the <a href="https://quarkus.io/guides/logging">Quarkus logging guide</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="logging-dependencies"><a class="anchor" href="#logging-dependencies"></a>1.44. Logging Dependencies</h4>
<div class="paragraph">
<p>To use Logback in your Spring application, you need to include the following dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;!-- SLF4J as logging API --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
  &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- Logback as logging implementation  --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
  &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- JSON logging for cloud-native log monitoring --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;net.logstash.logback&lt;/groupId&gt;
  &lt;artifactId&gt;logstash-logback-encoder&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In devon4j these dependencies are provided by the <a href="https://github.com/devonfw/devon4j/tree/master/modules/logging">devon4j-logging module</a>.</p>
</div>
<div class="paragraph">
<p>In Quarkus, SLF4J and the <a href="https://github.com/jboss-logging/slf4j-jboss-logmanager"><code>slf4j-jboss-logmanager</code></a> are directly included in the Quarkus core runtime and can be used out of the box.</p>
</div>
</div>
<div class="sect3">
<h4 id="logger-access"><a class="anchor" href="#logger-access"></a>1.45. Logger Access</h4>
<div class="paragraph">
<p>The general pattern for accessing loggers from your code is a static logger instance per class using the following pattern:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

public class MyClass {
  private static final Logger LOG = LoggerFactory.getLogger(MyClass.class);
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For detailed documentation how to use the logger API check the <a href="http://www.slf4j.org/manual.html">SLF4j manual</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In case you are using <a href="https://github.com/devonfw/ide">devonfw-ide</a> and Eclipse you can just type <code>LOG</code> and hit <code>[ctrl][space]</code> to insert the code pattern including the imports into your class.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="lombok-2"><a class="anchor" href="#lombok-2"></a>Lombok</h5>
<div class="paragraph">
<p>In case you are using <a href="guide-lombok">Lombok</a>, you can simply use the <a href="https://projectlombok.org/api/lombok/extern/slf4j/Slf4j.html"><code>@Slf4j</code></a> annotation in your class. This causes Lombok to generate the logger instance for you.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="log-levels"><a class="anchor" href="#log-levels"></a>1.46. Log-Levels</h4>
<div class="paragraph">
<p>We use a common understanding of the log-levels as illustrated by the following table.
This helps for better maintenance and operation of the systems.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Log-levels</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Log-level</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Impact</strong></th>
<th class="tableblock halign-left valign-top"><strong>Active Environments</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FATAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Only used for fatal errors that prevent the application to work at all (e.g. startup fails or shutdown/restart required)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operator has to react immediately</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ERROR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An abnormal error indicating that the processing failed due to technical problems.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operator should check for known issue and otherwise inform development</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WARNING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A situation where something worked not as expected. E.g. a business exception or user validation failure occurred.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No direct reaction required. Used for problem analysis.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Important information such as context, duration, success/failure of request or process</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No direct reaction required. Used for analysis.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">all</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEBUG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Development information that provides additional context for debugging problems.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No direct reaction required. Used for analysis.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">development and testing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TRACE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Like DEBUG but exhaustive information and for code that is run very frequently. Will typically cause large log-files.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No direct reaction required. Used for problem analysis.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none (turned off by default)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Exceptions (with their stack trace) should only be logged on <code>FATAL</code> or <code>ERROR</code> level. For business exceptions typically a <code>WARNING</code> including the message of the exception is sufficient.</p>
</div>
<div class="sect4">
<h5 id="configuration-of-logback"><a class="anchor" href="#configuration-of-logback"></a>Configuration of Logback</h5>
<div class="paragraph">
<p>The configuration of logback happens via the <code>logback.xml</code> file that you should place into <code>src/main/resources</code> of your app.
For details consult the <a href="http://logback.qos.ch/manual/configuration.html">logback configuration manual</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Logback also allows to overrule the configuration with a <code>logback-test.xml</code> file that you may put into <code>src/test/resources</code> or into a test-dependency.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="configuration-in-quarkus"><a class="anchor" href="#configuration-in-quarkus"></a>Configuration in Quarkus</h5>
<div class="paragraph">
<p>The are several options you can set in the <code>application.properties</code> file to configure the behaviour of the logger in Quarkus. For a detailed overview, see the corresponding part of the <a href="https://quarkus.io/guides/logging#runtime-configuration">Quarkus guide</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="json-logging"><a class="anchor" href="#json-logging"></a>1.47. JSON-logging</h4>
<div class="paragraph">
<p>For easy integration with <a href="guide-log-monitoring">log-monitoring</a>, we recommend that your app logs to <code>standard out</code> in JSON following <a href="https://jsonlines.org/">JSON Lines</a>.</p>
</div>
<div class="paragraph">
<p>In Spring applications, this can be achieved via <a href="https://github.com/logstash/logstash-logback-encoder">logstash-logback-encoder</a> (see <a href="#dependencies">dependencies</a>). In Quarkus, it can be easily achieved using the <a href="https://github.com/quarkusio/quarkus/tree/main/extensions/logging-json">quarkus-logging-json</a> extension (see <a href="https://quarkus.io/guides/logging#json-logging">here</a> for more details).</p>
</div>
<div class="paragraph">
<p>This will produce log-lines with the following format (example formatted for readability):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{
  "timestamp":"2000-12-31T23:59:59.999+00:00",
  "@version":"1",
  "message":"Processing 4 order(s) for shipment",
  "logger_name":"com.myapp.order.logic.UcManageOrder",
  "thread_name":"http-nio-8081-exec-6",
  "level":"INFO",
  "level_value":20000,
  "appname":"myapp",
}</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="adding-custom-values-to-json-log-with-logstash"><a class="anchor" href="#adding-custom-values-to-json-log-with-logstash"></a>Adding custom values to JSON log with Logstash</h5>
<div class="paragraph">
<p>The JSON encoder even supports logging custom properties for your <a href="guide-log-monitoring">log-monitoring</a>.
The <em>trick</em> is to use the class <code>net.logstash.logback.argument.StructuredArguments</code> for adding the arguments to you log message, e.g.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import static net.logstash.logback.argument.StructuredArguments.v;

...
    LOG.info("Request with {} and {} took {} ms.", v("url", url), v("status", statusCode), v("duration", millis));
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will produce the a JSON log-line with the following properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">...
  "message":"Request with url=https://api/service/v1/ordermanagement/order and status=200 took duration=251 ms",
  "url":"https://api/service/v1/ordermanagement/order",
  "status":"200",
  "duration":"251",
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can quickly see besides the human readable <code>message</code> you also have the structured properties <code>url</code>, <code>status</code> and <code>duration</code> that can be extremly valuable to configure dashboards in your <a href="guide-log-monitoring">log-monitoring</a> that visualize success/failure ratio as well as performance of your requests.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="classic-log-files"><a class="anchor" href="#classic-log-files"></a>1.48. Classic log-files</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<strong>In devon4j, we strongly recommend using JSON logging instead of classic log files. The following section refers only to devon4j Spring applications that use Logback.</strong>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Even though we do not recommend anymore to write classical log-files to the local disc, here you can still find our approach for it.</p>
</div>
<div class="sect4">
<h5 id="maven-integration"><a class="anchor" href="#maven-integration"></a>Maven-Integration</h5>
<div class="paragraph">
<p>In the <code>pom.xml</code> of your application add this dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.devonfw.java&lt;/groupId&gt;
  &lt;artifactId&gt;devon4j-logging&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above dependency already adds transitive dependencies to SLF4J and logback.
Also it comes with <a href="https://github.com/devonfw/devon4j/tree/master/modules/logging/src/main/resources/com/devonfw/logging/logback">configration snipplets</a> that can be included from your <code>logback.xml</code> file (see <a href="#configuration">configuration</a>).</p>
</div>
<div class="paragraph">
<p>The <code>logback.xml</code> to write regular log-files can look as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration scan="true" scanPeriod="60 seconds"&gt;
  &lt;property resource="com/devonfw/logging/logback/application-logging.properties" /&gt;
  &lt;property name="appname" value="MyApp"/&gt;
  &lt;property name="logPath" value="../logs"/&gt;
  &lt;include resource="com/devonfw/logging/logback/appenders-file-all.xml" /&gt;
  &lt;include resource="com/devonfw/logging/logback/appender-console.xml" /&gt;

  &lt;root level="DEBUG"&gt;
    &lt;appender-ref ref="ERROR_APPENDER"/&gt;
    &lt;appender-ref ref="INFO_APPENDER"/&gt;
    &lt;appender-ref ref="DEBUG_APPENDER"/&gt;
    &lt;appender-ref ref="CONSOLE_APPENDER"/&gt;
  &lt;/root&gt;

  &lt;logger name="org.springframework" level="INFO"/&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The provided <code>logback.xml</code> is configured to use variables defined on the <code>config/application.properties</code> file.
On our example, the log files path point to <code>../logs/</code> in order to log to tomcat log directory when starting tomcat on the bin folder.
Change it according to your custom needs.</p>
</div>
<div class="listingblock">
<div class="title">Listing 13. config/application.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">log.dir=../logs/</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="log-files"><a class="anchor" href="#log-files"></a>Log Files</h5>
<div class="paragraph">
<p>The classical approach uses the following log files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Error Log</strong>: Includes log entries to detect errors.</p>
</li>
<li>
<p><strong>Info Log</strong>: Used to analyze system status and to detect bottlenecks.</p>
</li>
<li>
<p><strong>Debug Log</strong>: Detailed information for error detection.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The log file name pattern is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>«LOGTYPE»_log_«HOST»_«APPLICATION»_«TIMESTAMP».log</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Segments of Logfilename</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Element</strong></th>
<th class="tableblock halign-left valign-top"><strong>Value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«LOGTYPE»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">info, error, debug</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type of log file</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«HOST»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">e.g. mywebserver01</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of server, where logs are generated</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«APPLICATION»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">e.g. myapp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of application, which causes logs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«TIMESTAMP»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">YYYY-MM-DD_HH00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">date of log file</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Example:
error_log_mywebserver01_myapp_2013-09-16_0900.log</p>
</div>
<div class="paragraph">
<p>Error log from mywebserver01 at application myapp at 16th September 2013 9pm.</p>
</div>
</div>
<div class="sect4">
<h5 id="output-format"><a class="anchor" href="#output-format"></a>Output format</h5>
<div class="paragraph">
<p>We use the following output format for all log entries to ensure that searching and filtering of log entries work consistent for all logfiles:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>[D: «timestamp»] [P: «priority»] [C: «NDC»][T: «thread»][L: «logger»]-[M: «message»]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>D</strong>: Date (Timestamp in ISO8601 format e.g. 2013-09-05 16:40:36,464)</p>
</li>
<li>
<p><strong>P</strong>: Priority (the log level)</p>
</li>
<li>
<p><strong>C</strong>: <a href="#correlation-id">Correlation ID</a> (ID to identify users across multiple systems, needed when application is distributed)</p>
</li>
<li>
<p><strong>T</strong>: Thread (Name of thread)</p>
</li>
<li>
<p><strong>L</strong>: Logger name (use class name)</p>
</li>
<li>
<p><strong>M</strong>: Message (log message)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>[D: 2013-09-05 16:40:36,464] [P: DEBUG] [C: 12345] [T: main] [L: my.package.MyClass]-[M: My message...]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When using devon4j-logging, this format is used by default. To achieve this format in Quarkus, set <code>quarkus.log.console.format=[D: %d] [P: %p] [C: %X] [T: %t] [L: %c] [M: %m]%n</code> in your properties.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="correlation-id"><a class="anchor" href="#correlation-id"></a>Correlation ID</h5>
<div class="paragraph">
<p>In order to correlate separate HTTP requests to services belonging to the same user / session, we provide a servlet filter called <code>DiagnosticContextFilter</code>.
This filter takes a provided correlation ID from the HTTP header <code>X-Correlation-Id</code>.
If none was found, it will generate a new correlation id as <code>UUID</code>.
This correlation ID is added as MDC to the logger.
Therefore, it will then be included to any log message of the current request (thread).
Further concepts such as <a href="guide-service-client">service invocations</a> will pass this correlation ID to subsequent calls in the application landscape. Hence you can find all log messages related to an initial request simply via the correlation ID even in highly distributed systems.</p>
</div>
</div>
<div class="sect4">
<h5 id="security-5"><a class="anchor" href="#security-5"></a>Security</h5>
<div class="paragraph">
<p>In order to prevent <a href="https://owasp.org/www-community/attacks/Log_Injection">log forging</a> attacks you can simply use the suggested <a href="#json-logging">JSON logging</a> format.
Otherwise you can use <code>com.devonfw.module.logging.common.impl.SingleLinePatternLayout</code> as demonstrated  <a href="https://github.com/devonfw/devon4j/blob/master/modules/logging/src/main/resources/com/devonfw/logging/logback/appender-file-warn.xml">here</a> in order to prevent such attacks.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Monitoring</p>
</div>
<div class="paragraph">
<p>For monitoring a complex application landscape it is crucial to have an exact overview which applications are up and running and which are not and why.
In devonfw we only focus on topics which are most important when developing production-ready applications.
On a high level view we strongly suggest to separate the application to be monitored from the <code>monitoring system</code> itself.
Therefore, your application should concentrate on providing app specific data for the monitoring.
Aspects such as aggregation, visualization, search, alerting, etc. should be addressed outside of your app by a monitoring system product.
There are many products providing such a monitoring system like <a href="https://checkmk.com">checkmk</a>, <a href="https://icinga.com/">icinga</a>, <a href="https://skywalking.apache.org/">SkyWalking</a>, etc.
Please note that there is a huge list of such products and devonfw is not biased or aims to make a choice for you.
Instead please search and find the products that fit best for your requirements and infrastructure.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="types-of-monitoring"><a class="anchor" href="#types-of-monitoring"></a>1.49. Types of monitoring</h4>
<div class="paragraph">
<p>As monitoring coveres a lot of different aspects we separate the following types of monitoring and according data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><a href="guide-log-monitoring">Log-monitoring</a></strong><br>
is about collecting and monitoring the logs of all apps and containers in your IT landscape. It is suitable for events such as an HTTP request with its URL, resulting status code and duration in milliseconds. Your monitoring may not react to such data in realtime. Instead it may take a delay of one or a few seconds.</p>
</li>
<li>
<p><strong>Infrastructure monitoring</strong><br>
is about monitoring the (hardware) infrastructure with measures like usage of CPU, memory, disc-space, etc. This is a pure operational task and your app should have nothing to do with this. In other words it is a waste if your app tries to monitor these aspects as existing products can do this much better and your app will only see virtual machines and is unable to see the physical infrastructure.</p>
</li>
<li>
<p><strong><a href="#health-check">Health check</a></strong><br>
is about providing internal data about the current health of your app. Typically you provide sensors with health status per component or interface to neighbour service (database connectivity, etc.).</p>
</li>
<li>
<p><strong><a href="guide-apm">Application Performance Monitoring</a></strong><br>
is about measuring performance and tracing down performance issues.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="health-check"><a class="anchor" href="#health-check"></a>1.50. Health-Check</h4>
<div class="paragraph">
<p>The idea of a health check is to prodvide monitoring data about the current health status of your application.
This allows to integrate this specific data into the monitoring system used for your IT landscape.
In order to keep the monitoring simple and easy to integreate consider using the following best practices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use simple and established protocols such as <a href="guide-rest">REST</a> instead of <a href="guide-jmx">JMX via RMI</a>.</p>
</li>
<li>
<p>Considuer using recent standards such as <a href="https://github.com/eclipse/microprofile-health">microprofile-health</a>.</p>
</li>
<li>
<p>Consider to drop <a href="guide-access-control">access-control</a> for your monitoring interfaces and for security prevent external access to it in your infrastructure (loadbalancers or gateways). Monitoring is only for usage within an IT landscape internally. It does not make sense for externals and end-users to access your app for reading monitoring data from a random node decided by a loadbalancer. Furhter, external access can easily lead to <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">sensitive data exposure</a>.</p>
</li>
<li>
<p>Consider to define different end-points per usage-scenario. So if you want the loadbalancer to ask your app monitoring for availability of each node then create a separate service URL that only provides <code>OK</code> or anything else for failure (<code>NOK</code>, 404, 500, timeout). Do not mix this with a health-check that needs more detailed information.</p>
</li>
<li>
<p>Also do not forget about basic features such as prodiving the name and the release version of your application.</p>
</li>
<li>
<p>Be careful to automate decisions based on monitoring and health checks. It easily turns out to be stupid if you automatically restart your pod or container because of some monitoring indicator. In the worst case a failure of a central component will cause your health-check to report down for all apps and as a result all your containers will be restarted frequently. Indead of curing problems such decisions will cause much more harm and trouble.</p>
</li>
<li>
<p>Avoid causing reasonable load with your monitoring and health-check itself. In many cases it is better to use <a href="guide-log-monitoring">log-monitoring</a> or to collect monitoring data from use-cases that happen in your app anyway. If you create dummy read and write requests in your monitoring implementation you will easily turn it into a DOS-attack.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For <a href="spring">spring</a> you can simply integrate app monitoring and health check via <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/actuator.html">spring-boot-actuator</a>.</p>
</div>
<div class="paragraph">
<p>For <a href="quarkus">quarkus</a> you can simply integrate app monitoring via <a href="https://quarkus.io/guides/micrometer">micrometer</a> or <a href="https://quarkus.io/guides/smallrye-metrics">smallrye-metrics</a> and health check via <a href="https://quarkus.io/guides/smallrye-health">smallrye-health</a>.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Log-Monitoring</p>
</div>
<div class="paragraph">
<p>Log-monitoring is an aspect of <a href="guide-monitoring">monitoring</a> with a strict focus on <a href="guide-logging">logging</a>.
With trends towards IT landscapes with many but much smaller apps the classicial approach to write log-files to the disc and let operators read those via SSH became entirely obsolete.
Nowadays we have up to hundreds or even thousands of apps that themselves are clustered into multiple nodes.
Therefore you should establish a centralized log monitoring system in the environment and let all your nodes log directly into that system.
This approach gives the following benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>all log information available in one place</p>
</li>
<li>
<p>full-text search accross all logfiles</p>
</li>
<li>
<p>ability to automatically trigger alerts from specific log patterns</p>
</li>
<li>
<p>ability to do data-mining on logs and visualize in dashboards</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="options-for-log-monitoring"><a class="anchor" href="#options-for-log-monitoring"></a>1.51. Options for log-monitoring</h4>
<div class="paragraph">
<p>Typical products for such a log monitoring system are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.elastic.co/de/what-is/elk-stack">ELK-Stack</a></p>
</li>
<li>
<p><a href="https://www.graylog.org/">Graylog</a></p>
</li>
<li>
<p><a href="https://www.splunk.com/">Splunk</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In devonfw we are not biased for any of these products. Therefore, feel free to make your choice according to the requirements of your project.</p>
</div>
<div class="paragraph">
<p>For Quarkus applications, you can get an insight into the topic by reading the guide about <a href="https://quarkus.io/guides/centralized-log-management">centralized log management</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-for-log-monitoring"><a class="anchor" href="#api-for-log-monitoring"></a>1.52. API for log-monitoring</h4>
<div class="paragraph">
<p>The "API" for logging to a log-monitoring system for your app is pretty simple:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Write your logs to standard out.</p>
</li>
<li>
<p>Use <a href="guide-logging#json-logging">JSON logging</a> as format.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then the container infrastructure can automatically collect your logs from standard out and directly feed those into the log monitoring system.
As a result, your app does not need to know anything about your log monitoring system and logging becomes most simple.
Further, if you do not write log-files anymore, you might not need to write any other files and therefore may not even need write permissions on the filesystem of your container.
In such case an attacker who may find a vulnerability in your app will have less attack surface in case he can not write any file.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Application Performance Management</p>
</div>
<div class="paragraph">
<p>This guide gives hints how to manage, monitor and analyse performance of Java applications.</p>
</div>
</div>
<div class="sect3">
<h4 id="temporary-analysis"><a class="anchor" href="#temporary-analysis"></a>1.53. Temporary Analysis</h4>
<div class="paragraph">
<p>If you are facing performance issues and want to do a punctual analysis we recommend you to use <a href="https://glowroot.org/">glowroot</a>. It is ideal in cases where monitoring in your local development environment is suitable. However, it is also possible to use it in your test environment. It is entirely free and open-source. Still it is very powerful and helps to trace down bottlenecks. To get a first impression of the tool take a look at the <a href="https://demo.glowroot.org">demo</a>.</p>
</div>
<div class="sect4">
<h5 id="jeewtp"><a class="anchor" href="#jeewtp"></a>JEE/WTP</h5>
<div class="paragraph">
<p>In case you are forced to use an <a href="guide-jee">JEE application server</a> and want to do a temporary analysis you can double click your server instance from the servers view in Eclipse and click on the link <code>Open launch configuration</code> in order to add the <code>-javaagent</code> JVM option.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="regular-analysis"><a class="anchor" href="#regular-analysis"></a>1.54. Regular Analysis</h4>
<div class="paragraph">
<p>In case you want to manage application performance regularly we recommend to use <a href="https://github.com/javamelody/javamelody#javamelody">JavaMelody</a> that can be integrated into your application. More information on javamelody is available on the <a href="https://github.com/javamelody/javamelody/wiki">JavaMelody Wiki</a></p>
</div>
</div>
<div class="sect3">
<h4 id="alternatives"><a class="anchor" href="#alternatives"></a>1.55. Alternatives</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/naver/pinpoint">PinPoint</a></p>
</li>
<li>
<p><a href="https://openapm.io/">OpenAPM</a></p>
</li>
<li>
<p><a href="https://www.appdynamics.com/java/">AppDynamics</a></p>
</li>
<li>
<p><a href="https://www.zabbix.com/features">Zabbix</a></p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Security
Security is todays most important cross-cutting concern of an application and an enterprise IT-landscape. We seriously care about security and give you detailed guides to prevent pitfalls, vulnerabilities, and other disasters. While many mistakes can be avoided by following our guidelines you still have to consider security and think about it in your design and implementation. The security guide will not only automatically prevent you from any harm, but will provide you hints and best practices already used in different software products.</p>
</div>
<div class="paragraph">
<p>An important aspect of security is proper authentication and authorization as described in <a href="guide-access-control">access-control</a>. In the following we discuss about potential vulnerabilities and protection to prevent them.</p>
</div>
</div>
<div class="sect3">
<h4 id="vulnerabilities-and-protection"><a class="anchor" href="#vulnerabilities-and-protection"></a>1.56. Vulnerabilities and Protection</h4>
<div class="paragraph">
<p>Independent from classical authentication and authorization mechanisms there are many common pitfalls that can lead to vulnerabilities and security issues in your application such as XSS, CSRF, SQL-injection, log-forging, etc. A good source of information about this is the <a href="https://www.owasp.org">OWASP</a>.
We address these common threats individually in <em>security</em> sections of our technological guides as a concrete solution to prevent an attack typically depends on the according technology. The following table illustrates common threats and contains links to the solutions and protection-mechanisms provided by the devonfw:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Security threats and protection-mechanisms</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Threat</strong></th>
<th class="tableblock halign-left valign-top"><strong>Protection</strong></th>
<th class="tableblock halign-left valign-top"><strong>Link to details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection.html">A1 Injection</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">validate input, escape output, use proper frameworks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-jpa#security">SQL Injection</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A2-Broken_Authentication.html">A2 Broken Authentication</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">encrypt all channels, use a central identity management with strong password-policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-access-control#authentication">Authentication</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html">A3 Sensitive Data Exposure</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use secured exception facade, design your data model accordingly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-service-layer#rest-exception-handling">REST exception handling</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A4-XML_External_Entities_(XXE).html">A4 XML External Entities</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prefer JSON over XML, ensure <a href="https://docs.oracle.com/en/java/javase/11/security/java-api-xml-processing-jaxp-security-guide.html">FSP</a> when parsing (external) XML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-xml">XML guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A5-Broken_Access_Control.html">A5 Broken Access Control</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure proper authorization for all use-cases, use <code>@DenyAll</code> as default to enforce</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-access-control">Access-control guide</a> especially <a href="guide-access-control#configuration-on-java-method-level">method authorization</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration.html">A6 Security Misconfiguration</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use devon4j application template and guides to avoid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="tutorial-newapp">tutorial-newapp</a> and <a href="guide-configuration#security">sensitive configuration</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A7-Cross-Site_Scripting_(XSS).html">A7 Cross-Site Scripting</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">prevent injection (see A1) for HTML, JavaScript and CSS and understand same-origin-policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-client-layer">client-layer</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A8-Insecure_Deserialization.html">A8 Insecure Deserialization</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use simple and established serialization formats such as JSON, prevent generic deserialization (for polymorphic types)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-json">JSON guide</a> especially <a href="guide-json#json-and-inheritance">inheritence</a>, <a href="guide-xml">XML guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A9-Using_Components_with_Known_Vulnerabilities.html">A9 Using Components with Known Vulnerabilities</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">subscribe to security newsletters, recheck products and their versions continuously, use devonfw dependency management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cve.mitre.org/news/newsletter.html">CVE newsletter</a> and <a href="#dependency-check">dependency check</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A10-Insufficient_Logging%252526Monitoring.html">A10 Insufficient_Logging &amp; Monitoring</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ensure to log all security related events (login, logout, errors), establish effective monitoring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-logging">Logging guide</a> and <a href="guide-monitoring">monitoring guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-chapter-ghana/assets/slides/IDOR.pdf">Insecure Direct Object References</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Using direct object references (IDs) only with appropriate authorization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-logic-layer#direct-object-references">logic-layer</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-community/attacks/csrf">Cross-Site Request Forgery (CSRF)</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">secure mutable service operations with an explicit CSRF security token sent in HTTP header and verified on the server</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-csrf">CSRF guide</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-community/attacks/Log_Injection">Log-Forging</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Escape newlines in log messages</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-logging#security">logging security</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://owasp.org/www-pdf-archive//OWASP_LA_New_OWASP_Top_10_David_Caissy_2017_07.pdf">Unvalidated Redirects and Forwards</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Avoid using redirects and forwards, in case you need them do a security audit on the solution.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">devonfw proposes to use rich-clients (SPA/RIA). We only use redirects for login in a safe way.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="advanced-security"><a class="anchor" href="#advanced-security"></a>1.57. Advanced Security</h4>
<div class="paragraph">
<p>While OWASP Top 10 covers the basic aspects of application security, there are advanced standards such as <code>AVS</code>.
In devonfw we address this in the <a href="https://github.com/devonfw/security/wiki">
Application Security Quick Solution Guide</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="tools"><a class="anchor" href="#tools"></a>1.58. Tools</h4>
<div class="sect4">
<h5 id="dependency-check"><a class="anchor" href="#dependency-check"></a>Dependency Check</h5>
<div class="paragraph">
<p>To address the thread <code>Using Components with Known Vulnerabilities</code> we recomment to use <a href="https://www.owasp.org/index.php/OWASP_Dependency_Check">OWASP dependency check</a> that ships with a maven plugin and can analyze your dependencies for known <a href="https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures">CVE</a>s.
In order to run this check, you can simply call this command on any maven project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn org.owasp:dependency-check-maven:6.1.5:aggregate</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The version is just for completeness. You should check yourself for using a recent version of the plugin.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you build an devon4j spring application from our <a href="tutorial-newapp">app-template</a> you can activate the dependency check even easier with the <code>security</code> profile:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn clean install -P security</code></pre>
</div>
</div>
<div class="paragraph">
<p>This does not run by default as it causes some overhead for the build performance. However, consider to build this in your CI at least nightly.
After the dependency check is performed, you will find the results in <code>target/dependency-check-report.html</code> of each module. The report will also be generated when the site is build (<code>mvn site</code>) even without the profile.</p>
</div>
</div>
<div class="sect4">
<h5 id="penetration-testing"><a class="anchor" href="#penetration-testing"></a>Penetration Testing</h5>
<div class="paragraph">
<p>For penetration testing (testing for vulnerabilities) of your web application, we recommend the following tools:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project">ZAP</a> (OWASP Zed Attack Proxy Project)</p>
</li>
<li>
<p><a href="http://sqlmap.org/">sqlmap</a> (or <a href="https://github.com/PaulSec/HQLmap">HQLmap</a>)</p>
</li>
<li>
<p><a href="https://nmap.org/">nmap</a></p>
</li>
<li>
<p>See the marvelous presentation <a href="https://jaxenter.com/security-open-source-toolbox-video-151314.html">Toolbox of a security professional</a> from <a href="https://www.Christian-Schneider.net">Christian Schneider</a>.</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==CORS support</p>
</div>
<div class="paragraph">
<p>When you are developing Javascript client and server application separately, you have to deal with cross domain issues. We have to request from a origin domain distinct to target domain and browser does not allow this.</p>
</div>
<div class="paragraph">
<p>So , we need to prepare server side to accept request from other domains. We need to cover the following points:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Accept request from other domains.</p>
</li>
<li>
<p>Accept devonfw used headers like <code>X-CSRF-TOKEN</code> or <code>correlationId.</code></p>
</li>
<li>
<p>Be prepared to receive secured request (cookies).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is important to note that if you are using security in your request (sending cookies) you have to set  <code>withCredentials</code> flag to <code>true</code> in your client side request and deal with special IE8 characteristics.</p>
</div>
<div class="paragraph">
<p>For more information about CORS see <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">here</a>. Information about the CORS headers can be found <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#cors">here</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuring-cors-support"><a class="anchor" href="#configuring-cors-support"></a>1.59. Configuring CORS support</h4>
<div class="paragraph">
<p>To enable CORS support for your application, see the advanced guides. For Spring applications see <a href="spring/guide-cors-spring.adoc">here</a>. For Quarkus follow the <a href="https://quarkus.io/guides/http-reference#cors-filter">official Quarkus guide</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-with-service-mesh"><a class="anchor" href="#configuration-with-service-mesh"></a>1.60. Configuration with service mesh</h4>
<div class="paragraph">
<p>If you are using a service mesh, you can also define your CORS policy directly there. Here is an example from <a href="https://istio.io/latest/docs/reference/config/networking/virtual-service/#CorsPolicy">Istio</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Java Development Kit</p>
</div>
<div class="paragraph">
<p>The <a href="https://en.wikipedia.org/wiki/Java_Development_Kit">Java Development Kit</a> is an implementation of the Java platform. It provides the <a href="https://en.wikipedia.org/wiki/Java_virtual_machine">Java Virtual Machine</a> (JVM) and the Java Runtime Environment (JRE).</p>
</div>
</div>
<div class="sect3">
<h4 id="editions"><a class="anchor" href="#editions"></a>1.61. Editions</h4>
<div class="paragraph">
<p>The JDK exists in different editions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://openjdk.java.net/">OpenJDK</a> is a free and open-source edition of the JDK.</p>
</li>
<li>
<p><a href="https://www.oracle.com/technetwork/java/javase/overview/index.html">OracleJDK</a> is a commercial edition of the JDK.</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/List_of_Java_virtual_machines">Various alternative JDK editions</a> either commercial (e.g. IBM&#8217;s JVM) or open-source.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As Java is evolving and also complex maintaining a JVM requires a lot of energy.
Therefore many alternative JDK editions are unable to cope with this and support latest Java versions and according compatibility.
Unfortunately OpenJDK only maintains a specific version of Java for a relative short period of time before moving to the next major version.
In the end, this technically means that OpenJDK is continuous beta and can not be used in production for reasonable software projects.
As OracleJDK changed its licensing model and can not be used for commercial usage even during development, things can get tricky.
You may want to use OpenJDK for development and OracleJDK only in production.
However, e.g. OpenJDK 11 never released a version that is stable enough for reasonable development (e.g. javadoc tool is <a href="https://bugs.openjdk.java.net/browse/JDK-8212233">broken</a> and fixes are not available of OpenJDK 11 - fixed in 11.0.3 what is only available as OracleJDK 11 or you need to go to OpenJDK 12+, what has other bugs) so in the end there is no working release of OpenJDK 11.
This more or less forces you to use OracleJDK what requires you to buy a subscription so you can use it for commercial development.
However, there is <a href="https://github.com/AdoptOpenJDK">AdoptOpenJDK</a> that provides forked releases of OpenJDK with bug-fixes what might be an option.
Anyhow, as you want to have your development environment close to production, the productively used JDK (most likely OracleJDK) should be preferred also for development.</p>
</div>
</div>
<div class="sect3">
<h4 id="upgrading"><a class="anchor" href="#upgrading"></a>1.62. Upgrading</h4>
<div class="paragraph">
<p>Until Java 8 compatibility was one of the key aspects for Java version updates (after the mess on the Swing updates with Java2 many years ago).
However, Java 9 introduced a lot of breaking changes.
This documentation wants to share the experience we collected in devonfw when upgrading from Java 8 to newer versions.
First of all we separate runtime changes that you need if you want to build your software with JDK 8 but such that it can also run on newer versions (e.g. JRE 11)
from changes required to also build your software with more recent JDKs (e.g. JDK 11 or 12).</p>
</div>
<div class="sect4">
<h5 id="runtime-changes"><a class="anchor" href="#runtime-changes"></a>Runtime Changes</h5>
<div class="paragraph">
<p>This section describes required changes to your software in order to make it run also with versions newer than Java 8.</p>
</div>
<div class="sect5">
<h6 id="classes-removed-from-jdk"><a class="anchor" href="#classes-removed-from-jdk"></a>Classes removed from JDK</h6>
<div class="paragraph">
<p>The first thing that most users hit when running their software with newer Java versions is a <code>ClassNotFoundException</code> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Caused by: java.lang.ClassNotFoundException: javax.xml.bind.JAXBException</code></pre>
</div>
</div>
<div class="paragraph">
<p>As Java 9 introduced a module system with <a href="https://www.baeldung.com/project-jigsaw-java-modularity">Jigsaw</a>, the JDK that has been a monolithic mess is now a well-defined set of structured modules.
Some of the classes that used to come with the JDK moved to modules that where not available by default in Java 9 and have even been removed entirely in later versions of Java.
Therefore you should simply treat such code just like any other 3rd party component that you can add as a (maven) dependency.
The following table gives you the required hints to make your software work even with such classes / modules removed from the JDK (please note that the specified version is just a suggestion that worked, feel free to pick a more recent or more appropriate version):</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Dependencies for classes removed from Java 8 since 9+</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Class</strong></th>
<th class="tableblock halign-left valign-top"><strong>GroupId</strong></th>
<th class="tableblock halign-left valign-top"><strong>ArtifactId</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.xml.bind.*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.xml.bind</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jaxb-api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.3.1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.sun.xml.bind.*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.glassfish.jaxb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jaxb-runtime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.3.1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.activation.*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.activation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.activation-api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.2.0</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.transaction.*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.transaction</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.transaction-api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.2</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.xml.ws.*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.xml.ws</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jaxws-api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.3.1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.jws.*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.jws</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.jws-api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.annotation.*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.annotation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.annotation-api</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1.3.2</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="3rd-party-updates"><a class="anchor" href="#3rd-party-updates"></a>3rd Party Updates</h6>
<div class="paragraph">
<p>Further, internal and inofficial APIs (e.g. <code>sun.misc.Unsafe</code>) have been removed.
These are typically not used by your software directly but by low-level 3rd party libraries like <code>asm</code> that need to be updated.
Also simple things like the Java version have changed (from <code>1.8.x</code> to <code>9.x</code>, <code>10.x</code>, <code>11.x</code>, <code>12.x</code>, etc.).
Some 3rd party libraries were parsing the Java version in a very naive way making them unable to be used with Java 9+:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Caused by: java.lang.NullPointerException
   at org.apache.maven.surefire.shade.org.apache.commons.lang3.SystemUtils.isJavaVersionAtLeast (SystemUtils.java:1626)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Therefore the following table gives an overview of common 3rd party libraries that have been affected by such breaking changes and need to be updated to at least the specified version:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Minimum recommended versions of common 3rd party for Java 9+</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>GroupId</strong></th>
<th class="tableblock halign-left valign-top"><strong>ArtifactId</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Issue</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.apache.commons</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>commons-lang3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3.7</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://issues.apache.org/jira/browse/LANG-1365">LANG-1365</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cglib</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cglib</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3.2.9</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/cglib/cglib/issues/102">102</a>, <a href="https://github.com/cglib/cglib/issues/93">93</a>, <a href="https://github.com/cglib/cglib/issues/133">133</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.ow2.asm</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>asm</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>7.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/eclipse/jetty.project/issues/2941">2941</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.javassist</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javassist</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3.25.0-GA</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/jboss-javassist/javassist/issues/194">194</a>, <a href="https://github.com/jboss-javassist/javassist/issues/228">228</a>, <a href="https://github.com/jboss-javassist/javassist/issues/246">246</a>, <a href="https://github.com/jboss-javassist/javassist/issues/171">171</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="resourcebundles"><a class="anchor" href="#resourcebundles"></a>ResourceBundles</h6>
<div class="paragraph">
<p>For internationalization (i18n) and localization (l10n) <code>ResourceBundle</code> is used for language and country specific texts and configurations as properties (e.g. <code>MyResourceBundle_de.properties</code>). With Java modules there are changes and impacts you need to know to get things working. The most important change is documented in the <a href="https://docs.oracle.com/javase/9/docs/api/java/util/ResourceBundle.html#bundleprovider">JavaDoc of ResourceBundle</a>. However, instead of using <a href="https://docs.oracle.com/javase/9/docs/api/java/util/spi/ResourceBundleProvider.html">ResourceBundleProvider</a> and refactoring your entire code causing incompatibilities, you can simply put the resource bundles in a regular JAR on the classpath rather than a named module (or into the lauching app).
If you want to implement (new) Java modules with i18n support, you can have a look at <a href="https://github.com/m-m-m/nls#mmm-nls">mmm-nls</a>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="buildtime-changes"><a class="anchor" href="#buildtime-changes"></a>Buildtime Changes</h5>
<div class="paragraph">
<p>If you also want to change your build to work with a recent JDK you also need to ensure that test frameworks and maven plugins properly support this.</p>
</div>
<div class="sect5">
<h6 id="findbugs"><a class="anchor" href="#findbugs"></a>Findbugs</h6>
<div class="paragraph">
<p>Findbugs does not work with Java 9+ and is actually a dead project.
The new findbugs is <a href="https://spotbugs.github.io/">SpotBugs</a>.
For maven the new solution is <a href="https://spotbugs.github.io/spotbugs-maven-plugin/">spotbugs-maven-plugin</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>&lt;plugin&gt;
  &lt;groupId&gt;com.github.spotbugs&lt;/groupId&gt;
  &lt;artifactId&gt;spotbugs-maven-plugin&lt;/artifactId&gt;
  &lt;version&gt;3.1.11&lt;/version&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="test-frameworks"><a class="anchor" href="#test-frameworks"></a>Test Frameworks</h6>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. Minimum recommended versions of common 3rd party test frameworks for Java 9+</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>GroupId</strong></th>
<th class="tableblock halign-left valign-top"><strong>ArtifactId</strong></th>
<th class="tableblock halign-left valign-top"><strong>Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Issue</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.mockito</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mockito-core</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.23.4</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/mockito/mockito/issues/1419">1419</a>, <a href="https://github.com/mockito/mockito/issues/1696">1696</a>, <a href="https://github.com/mockito/mockito/issues/1607">1607</a>, <a href="https://github.com/mockito/mockito/issues/1594">1594</a>, <a href="https://github.com/mockito/mockito/issues/1577">1577</a>, <a href="https://github.com/mockito/mockito/issues/1482">1482</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="maven-plugins"><a class="anchor" href="#maven-plugins"></a>Maven Plugins</h6>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. Minimum recommended versions of common maven plugins for Java 9+</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>GroupId</strong></th>
<th class="tableblock halign-left valign-top"><strong>ArtifactId</strong></th>
<th class="tableblock halign-left valign-top"><strong>(min.) Version</strong></th>
<th class="tableblock halign-left valign-top"><strong>Issue</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.apache.maven.plugins</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maven-compiler-plugin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3.8.1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.apache.maven.plugins</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maven-surefire-plugin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.22.2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://issues.apache.org/jira/browse/SUREFIRE-1439">SUREFIRE-1439</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.apache.maven.plugins</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maven-surefire-report-plugin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2.22.2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://issues.apache.org/jira/browse/SUREFIRE-1439">SUREFIRE-1439</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.apache.maven.plugins</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maven-archetype-plugin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3.1.0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.apache.maven.plugins</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>maven-javadoc-plugin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>3.1.0</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.jacoco</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>jacoco-maven-plugin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>0.8.3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/jacoco/jacoco/issues/663">663</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="maven-usage"><a class="anchor" href="#maven-usage"></a>Maven Usage</h6>
<div class="paragraph">
<p>With Java modules you can not run Javadoc standalone anymore or you will get this error when running <code>mvn javadoc:javadoc</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>[ERROR] Failed to execute goal org.apache.maven.plugins:maven-javadoc-plugin:3.1.1:javadoc (default-cli) on project mmm-base: An error has occurred in Javadoc report generation:
[ERROR] Exit code: 1 - error: module not found: io.github.mmm.base
[ERROR]
[ERROR] Command line was: /projects/mmm/software/java/bin/javadoc @options @packages @argfile</code></pre>
</div>
</div>
<div class="paragraph">
<p>As a solution or workaround you need to include the <code>compile</code> goal into your build lifecycle so the module-path is properly configured:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>mvn compile javadoc:javadoc</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sources-and-links"><a class="anchor" href="#sources-and-links"></a>1.63. Sources and Links</h4>
<div class="paragraph">
<p>We want to give credits and say thanks to the following articles that have been there before and helped us on our way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://blog.codefx.org/java/java-9-migration-guide/">Java 9 Migration Guide: The Seven Most Common Challenges</a></p>
</li>
<li>
<p><a href="https://medium.com/criciumadev/its-time-migrating-to-java-11-5eb3868354f9">It’s time! Migrating to Java 11</a></p>
</li>
<li>
<p><a href="https://winterbe.com/posts/2018/08/29/migrate-maven-projects-to-java-11-jigsaw/">Migrate Maven Projects to Java 11</a></p>
</li>
<li>
<p><a href="https://www.jesperdj.com/2018/09/30/jaxb-on-java-9-10-11-and-beyond/">JAXB on Java 9, 10, 11 and beyond</a></p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/26413431/which-artifacts-should-i-use-for-jaxb-ri-in-my-maven-project">JAXB Artifacts</a></p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==JEE</p>
</div>
<div class="paragraph">
<p>This section is about Java Enterprise Edition (JEE).
Regarding to our <a href="architecture#key-principles">key principles</a> we focus on open standards.
For Java this means that we consider official standards from Java Standard and Enterprise Edition as first choice for considerations.
Therefore we also decided to recommend <a href="guide-rest#jax-rs">JAX-RS</a> over <a href="https://spring.io/guides/gs/rest-service/">SpringMVC</a> as the latter is proprietary.
Only if an existing Java standard is <strong>not</strong> suitable for current demands such as Java Server Faces (JSF), we do not officially recommend it (while you are still free to use it if you have good reasons to do so).
In all other cases we officially suggest the according standard and use it in our guides, code-samples, sample application, modules, templates, etc.
Examples for such standards are <a href="guide-jpa">JPA</a>, <a href="guide-rest#jax-rs">JAX-RS</a>, <a href="guide-soap#jax-ws">JAX-WS</a>, <a href="guide-dependency-injection">JSR330</a>, <a href="guide-access-control">JSR250</a>, <a href="guide-xml#jaxb">JAX-B</a>, etc.</p>
</div>
</div>
<div class="sect3">
<h4 id="application-server"><a class="anchor" href="#application-server"></a>1.64. Application-Server</h4>
<div class="paragraph">
<p>We designed everything based on standards to work with different technology stacks and servlet containers.
However, we strongly encourage to use modern and leightweight frameworks such as <a href="spring">spring</a> or <a href="quarkus">quarkus</a>.
You are free to decide for a JEE application server but here is a list of good reasons for our decision:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Up-to-date</strong></p>
<div class="paragraph">
<p>With spring or quarkus you easily keep up to date with evolving technologies (microservices, reactive, NoSQL, etc.).
Most application servers put you in a jail with old legacy technology.
In many cases you are even forced to use a totally outdated version of java (JVM/JDK).
This may even cause severe IT-Security vulnerabilities but with expensive support you might get updates.
Also with leightweight open-source frameworks you need to be aware that for IT-security you need to update recently what can cost quite a lot of additional maintenance effort.</p>
</div>
</li>
<li>
<p><strong>Development speed</strong></p>
<div class="paragraph">
<p>With spring-boot you can implement and especially test your individual logic very fast. Starting the app in your IDE is very easy, fast, and realistic (close to production). You can easily write JUnit tests that startup your server application to e.g. test calls to your remote services via HTTP fast and easy. For application servers you need to bundle and deploy your app what takes more time and limits you in various ways. We are aware that this has improved in the past but also spring continuously improves and is always way ahead in this area. Further, with spring you have your configurations bundled together with the code in version control (still with ability to handle different environments) while with application servers these are configured externally and can not be easily tested during development.</p>
</div>
</li>
<li>
<p><strong>Documentation</strong></p>
<div class="paragraph">
<p>Spring and also quarkus have an extremely open and active community.
There is documentation for everything available for free on the web.
You will find solutions to almost any problem on platforms like stackoverflow.
If you have a problem you are only a google search away from your solution.
This is very much different for proprietary application server products.</p>
</div>
</li>
<li>
<p><strong>Helpful Exception Messages</strong></p>
<div class="paragraph">
<p>Especially spring is really great for developers on exception messages.
If you do something wrong you get detailed and helpful messages that guide you to the problem or even the solution.
This is not as great in application servers.</p>
</div>
</li>
<li>
<p><strong>Future-proof</strong></p>
<div class="paragraph">
<p>Spring has evolved really awesome over time.
Since its 1.0 release in 2004 spring has continuously been improved and always caught up with important trends and innovations.
Even in critical situations, when the company behind it (interface21) was sold, spring went on perfectly.
Quarkus on the other hand is relatively new.
It does not have to carry a large legacy history and is therefore most state-of-the-art for modern projects esp. in cloud environments.
JEE went through a lot of trouble and crisis.
Just look at the EJB pain stories.
This happened often in the past and also recent.
See <a href="https://dzone.com/articles/java-ee-8-in-crisis">JEE 8 in crisis</a>.</p>
</div>
</li>
<li>
<p><strong>Free</strong></p>
<div class="paragraph">
<p>Spring and quarkus including their ecosystems are free and open-source.
It still perfectly integrates with commercial solutions for specific needs.
Most application servers are commercial and cost a lot of money.
As of today the ROI for this is of question.</p>
</div>
</li>
<li>
<p><strong>Cloud-native</strong></p>
<div class="paragraph">
<p>Quarkus is designed for cloud-native projects from the start.
With spring this is also available via <a href="spring#spring-native">spring-native</a>.
Using an application server will effectively prevent you from going to the cloud smoothly.</p>
</div>
</li>
<li>
<p><strong>Fun</strong></p>
<div class="paragraph">
<p>If you go to conferences or ask developers you will see that spring or quarkus is popular and fun.
If new developers are forced to use an old application server product they will be less motivated or even get frustrated.
Especially in today&#8217;s agile projects this is a very important aspect.
In the end you will get into trouble with maintenance on the long run if you rely on a proprietary application server.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Of course the vendors of application servers will tell you a different story.
This is simply because they still make a lot of money from their products.
We do not get paid from application servers nor from spring, quarkus or any other IT product company.
We are just developers who love to build great systems.
A good reason for application servers is that they combine a set of solutions to particular aspects to one product that helps to standardize your IT.
However, <a href="http://www.devonfw.com/">devonfw</a> fills exactly this gap for the spring and quarkus ecosystems in a very open and flexible way.
However, there is one important aspect that you need to understand and be aware of:</p>
</div>
<div class="paragraph">
<p>Some big companies decided for a specific application server as their IT strategy.
They may have hundreds of apps running with this application server.
All their operators and developers have learned a lot of specific skills for this product and are familiar with it.
If you are implementing yet another (small) app in this context it could make sense to stick with this application server.
However, also they have to be aware that with every additional app they increase their technical debt.
So actively help your customer and consult him to make the right choices for the future.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Validation</p>
</div>
<div class="paragraph">
<p>Validation is about checking syntax and semantics of input data. Invalid data is rejected by the application.
Therefore validation is required in multiple places of an application. E.g. the <a href="guide-client-layer">GUI</a> will do validation for usability reasons to assist the user, early feedback and to prevent unnecessary server requests.
On the server-side validation has to be done for consistency and <a href="guide-security">security</a>.</p>
</div>
<div class="paragraph">
<p>In general we distinguish these forms of validation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>stateless validation</em> will produce the same result for given input at any time (for the same code/release).</p>
</li>
<li>
<p><em>stateful validation</em> is dependent on other states and can consider the same input data as valid in once case and as invalid in another.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="stateless-validation"><a class="anchor" href="#stateless-validation"></a>1.65. Stateless Validation</h4>
<div class="paragraph">
<p>For regular, stateless validation we use the JSR303 standard that is also called bean validation (BV).
Details can be found in the <a href="http://beanvalidation.org/1.1/spec/">specification</a>.
As implementation we recommend <a href="http://hibernate.org/validator/">hibernate-validator</a>.</p>
</div>
<div class="sect4">
<h5 id="example-3"><a class="anchor" href="#example-3"></a>Example</h5>
<div class="paragraph">
<p>A description of how to enable BV for spring applications can be found in the relevant <a href="http://docs.spring.io/spring-framework/docs/current/spring-framework-reference/htmlsingle/#validation-beanvalidation">Spring documentation</a>. A guide you can use to integrate validation in Quarkus applications can be found <a href="https://quarkus.io/guides/validation">here</a>. For a quick summary follow these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make sure that hibernate-validator is located in the classpath by adding a dependency to the pom.xml.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Listing 14. <strong>spring</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;dependency&gt;
      &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
      &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 15. <strong>quarkus</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;dependency&gt;
      &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
      &lt;artifactId&gt;quarkus-hibernate-validator&lt;/artifactId&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>For methods to validate go to their declaration and add constraint annotations to the method parameters.</p>
<div class="paragraph">
<p><em>In spring applications you can add the <code>@Validated</code> annotation to the implementation (spring bean) to be validated (this is an annotation of the spring framework, so it`s not available in the Quarkus context). The standard use case is to annotate the logic layer implementation, i.e. the use case implementation or component facade in case of simple logic layer pattern. Thus, the validation will be executed for service requests as well as batch processing.</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p>@Valid annotation to the arguments to validate (if that class itself is annotated with constraints to check).</p>
</li>
<li>
<p>@NotNull for required arguments.</p>
</li>
<li>
<p>Other constraints (e.g. @Size) for generic arguments (e.g. of type String or Integer). However, consider to create <a href="guide-datatype">custom datatypes</a> and avoid adding too much validation logic (especially redundant in multiple places).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Listing 16. <strong>BookingmanagementRestServiceImpl.java</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Validated
public class BookingmanagementRestServiceImpl implements BookingmanagementRestService {
  ...
  public BookingEto saveBooking(@Valid BookingCto booking) {
  ...</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Finally add appropriate validation constraint annotations to the fields of the ETO class.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Listing 17. <strong>BookingCto.java</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Valid
  private BookingEto booking;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 18. <strong>BookingEto.java</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @NotNull
  @Future
  private Timestamp bookingDate;</code></pre>
</div>
</div>
<div class="paragraph">
<p>A list with all bean validation constraint annotations available for hibernate-validator can be found <a href="http://docs.jboss.org/hibernate/stable/validator/reference/en-US/html_single/#table-spec-constraints">here</a>. In addition it is possible to configure custom constraints. Therefore it is necessary to implement a annotation and a corresponding validator. A description can also be found in the <a href="http://docs.spring.io/spring-framework/docs/current/spring-framework-reference/htmlsingle/#validation-beanvalidation-spring-constraints">Spring documentation</a> or with more details in the <a href="http://docs.jboss.org/hibernate/validator/4.3/reference/en-US/html/validator-customconstraints.html">hibernate documentation</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<strong>Bean Validation in Wildfly &gt;v8:</strong> Wildfly v8 is the first version of Wildfly implementing the JEE7 specification. It comes with bean validation based on <a href="https://samaxes.com/2014/04/jaxrs-beanvalidation-javaee7-wildfly/">hibernate-validator out of the box</a>. In case someone is running Spring in Wildfly for whatever reasons, the spring based annotation @Validated would duplicate bean validation at runtime and thus should be omitted.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="gui-integration"><a class="anchor" href="#gui-integration"></a>GUI-Integration</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
<div class="sect4">
<h5 id="cross-field-validation"><a class="anchor" href="#cross-field-validation"></a>Cross-Field Validation</h5>
<div class="paragraph">
<p>BV has poor support for this. Best practice is to create and use beans for ranges, etc. that solve this. A bean for a range could look like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Range&lt;V extends Comparable&lt;V&gt;&gt; {

  private V min;
  private V max;

  public Range(V min, V max) {

    super();
    if ((min != null) &amp;&amp; (max != null)) {
      int delta = min.compareTo(max);
      if (delta &gt; 0) {
        throw new ValueOutOfRangeException(null, min, min, max);
      }
    }
    this.min = min;
    this.max = max;
  }

  public V getMin() ...
  public V getMax() ...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="stateful-validation"><a class="anchor" href="#stateful-validation"></a>1.66. Stateful Validation</h4>
<div class="paragraph">
<p>For complex and stateful business validations we do not use BV (possible with groups and context, etc.) but follow KISS and just implement this on the server in a straight forward manner.
An example is the deletion of a table in the example application. Here the state of the table must be checked first:</p>
</div>
<div class="paragraph">
<p><strong>BookingmanagementImpl.java</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  private void sendConfirmationEmails(BookingEntity booking) {

    if (!booking.getInvitedGuests().isEmpty()) {
      for (InvitedGuestEntity guest : booking.getInvitedGuests()) {
        sendInviteEmailToGuest(guest, booking);
      }
    }

    sendConfirmationEmailToHost(booking);
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Implementing this small check with BV would be a lot more effort.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Bean-Mapping</p>
</div>
<div class="paragraph">
<p>For decoupling, you sometimes need to create separate objects (beans) for a different view. E.g. for an external service, you will use a <a href="guide-transferobject">transfer-object</a> instead of the <a href="guide-jpa#entity">persistence entity</a> so internal changes to the entity do not implicitly change or break the service.</p>
</div>
<div class="paragraph">
<p>Therefore you have the need to map similar objects what creates a copy. This also has the benefit that modifications to the copy have no side-effect on the original source object. However, to implement such mapping code by hand is very tedious and error-prone (if new properties are added to beans but not to mapping code):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public UserEto mapUser(UserEntity source) {
  UserEto target = new UserEto();
  target.setUsername(source.getUsername());
  target.setEmail(source.getEmail());
  ...
  return target;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Therefore we are using a <code>BeanMapper</code> for this purpose that makes our lives a lot easier.
There are several bean mapping frameworks with different approaches.</p>
</div>
<div class="paragraph">
<p>For a <a href="spring">devon4j-spring</a> application we recommend Orika, follow <a href="spring/guide-beanmapping-spring">Spring Bean-Mapping</a> for an introduction to Orika and Dozer in a devon4j-spring context application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
devon4j started with <a href="http://dozer.sourceforge.net/">Dozer</a> as framework for Spring applications and still supports it. However, we now recommend Orika (for new projects) as it is much faster (see <a href="https://www.baeldung.com/java-performance-mapping-frameworks#2-orika">Performance of Java Mapping Frameworks</a>).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For a <a href="quarkus">Quarkus</a> application we recommend Mapstruct, follow <a href="quarkus/guide-beanmapping-quarkus">Quarkus Bean-Mapping</a> for an introduction to Mapstruct in a quarkus context application.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Lombok</p>
</div>
<div class="paragraph">
<p><a href="https://projectlombok.org/">Lombok</a> is a library that works with an annotation processor and will generate code for you to save you some time and reduce the amount of boilerplate code in your project. Lombok can generate getter and setter, equals methods, automate your logging variables for your classes, and more. Follow the <a href="https://projectlombok.org/features/all">list of all the features</a> provided by Lombok to get an overview.</p>
</div>
</div>
<div class="sect3">
<h4 id="lombok-dependency"><a class="anchor" href="#lombok-dependency"></a>1.67. Lombok Dependency</h4>
<div class="paragraph">
<p>To get access to the Lombok library just add the following dependency to the POM.xml.</p>
</div>
<div class="paragraph">
<p>The Lombok dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
	&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
	&lt;artifactId&gt;lombok&lt;/artifactId&gt;
	&lt;version&gt;1.18.20&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To get Lombok working with your current IDE you should also install the Lombok addon. Follow the <a href="https://projectlombok.org/setup/eclipse">Eclipse installation guide</a>, there are also guides for other supported IDEs.</p>
</div>
</div>
<div class="sect3">
<h4 id="lombok-with-mapstruct"><a class="anchor" href="#lombok-with-mapstruct"></a>1.68. Lombok with Mapstruct</h4>
<div class="paragraph">
<p>MapStruct takes advantage of generated getters, setters, and constructors from Lombok and uses them to
generate the mapper implementations. Lombok is also an annotation processor and since version 1.18.14 both frameworks are working together. Just add the <code>lombok-mapstruct-binding</code> to your POM.xml.</p>
</div>
<div class="paragraph">
<p>The Lombok annotation processor and the <code>lombok-mapstruct-binding</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
	&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
	&lt;artifactId&gt;lombok-mapstruct-binding&lt;/artifactId&gt;
	&lt;version&gt;0.2.0&lt;/version&gt;
&lt;/dependency&gt;

&lt;plugin&gt;
	&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
	&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
	&lt;version&gt;3.8.1&lt;/version&gt;
	&lt;configuration&gt;
		&lt;source&gt;1.8&lt;/source&gt;
		&lt;target&gt;1.8&lt;/target&gt;
		&lt;annotationProcessorPaths&gt;
			&lt;path&gt;
				&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
				&lt;artifactId&gt;lombok&lt;/artifactId&gt;
				&lt;version&gt;1.18.4&lt;/version&gt;
			&lt;/path&gt;
			&lt;path&gt;
				&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;
				&lt;artifactId&gt;lombok-mapstruct-binding&lt;/artifactId&gt;
				&lt;version&gt;0.2.0&lt;/version&gt;
			&lt;/path&gt;
		&lt;/annotationProcessorPaths&gt;
	&lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In our <a href="https://github.com/devonfw-sample/devon4quarkus-reference">quarkus reference project</a> you can get a look into the usage of both frameworks.</p>
</div>
</div>
<div class="sect3">
<h4 id="lombok-usage"><a class="anchor" href="#lombok-usage"></a>1.69. Lombok Usage</h4>
<div class="paragraph">
<p>Lombok can be used like any other annotation processor and will be shown in the simple example below to generate getter and setter for a <em>Product</em> Entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Getter
@Setter
public class Product{

    private String title;
    private String description;
    private BigDecimal price;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For advanced Lombok usage follow the <a href="https://www.baeldung.com/intro-to-project-lombok">Baeldung Lombok guide</a> or just read the <a href="https://projectlombok.org/api/">Lombok javadoc</a></p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==OpenAPI</p>
</div>
<div class="paragraph">
<p>The <a href="https://spec.openapis.org/oas/latest.html">OpenAPI Specification (OAS)</a> defines a standard for describing RESTful web services in a machine- and human-readable format. OpenAPI allows REST APIs to be defined in a uniform manner.
Technically, an OpenAPI document is written in YAML or JSON format. The specification defines the structure of a REST API by describing attributes such as path information, response codes, and return types. Some examples can be found <a href="https://github.com/OAI/OpenAPI-Specification/tree/main/examples/v3.0">here</a>.
Apart from documenting the API, this schema then also acts as a contract between provider and consumers, guaranteeing interoperability between various technologies.</p>
</div>
<div class="paragraph">
<p>OpenAPI is often used in combination with <a href="https://swagger.io/">Swagger</a>. Swagger is a set of tools build around OpenAPI, that help developers to design and document their REST APIs.
The most common tool is the <a href="https://swagger.io/tools/swagger-ui/">Swagger UI</a>, which uses the OpenAPI specification to create a graphical interface of the REST API that you can also interact with. Check out the <a href="https://editor.swagger.io/">Swagger online editor</a> to get a feeling for it.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Swagger and OpenAPI: Swagger is a former specification, based on which the OpenAPI was created. Swagger 2.0 is still commonly used for describing APIs. OpenAPI is an open-source collaboration and it started from version 3.0.0(semver)</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are many tools that work with OpenAPI: code generators, documentation tools, validators etc.</p>
</div>
</div>
<div class="sect3">
<h4 id="openapi-generation"><a class="anchor" href="#openapi-generation"></a>1.70. OpenAPI generation</h4>
<div class="paragraph">
<p>There are several extensions you can use in your project to automatically generate the OpenAPI specifications and Swagger UI from your REST API (code-first approach). devon4j recommends the following two extensions/plugins to use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Smallrye OpenAPI extension</p>
</li>
<li>
<p>ServicedocGen maven plugin</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="smallrye-openapi"><a class="anchor" href="#smallrye-openapi"></a>Smallrye OpenAPI</h5>
<div class="paragraph">
<p>Quarkus provides OpenAPI support through Smallrye OpenAPI extension:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-smallrye-openapi&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>After adding the extension to your project, you can access the Swagger UI by navigating to <code>/q/swagger-ui</code>.</p>
</div>
<div class="paragraph">
<p>The OpenAPI specification can be accessed by requesting <code>/q/openapi</code>.</p>
</div>
<div class="paragraph">
<p>Smallrye OpenAPI is compliant with <a href="https://github.com/eclipse/microprofile-open-api">MicroProfile OpenAPI</a>. You can add MicroProfile annotations to further describe your REST endpoints and extend the OpenAPI documentation.
More information for this can be found <a href="https://quarkus.io/blog/openapi-for-everyone/#openapi">here</a> or <a href="https://download.eclipse.org/microprofile/microprofile-open-api-1.0/microprofile-openapi-spec.html#_documentation_mechanisms">here</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Quarkus recommends using this extension and you can document your APIs in great detail by using the MicroProfile annotations. The downside to this is that using these annotations will blow up your code and you will have some duplicate information in it.
If you don&#8217;t want to specify the REST API again with all this annotation based information, we also recommend taking a look at the ServicedocGen Maven plugin for your Quarkus applications when implementing JAX-RS APIs.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="servicedocgen-maven-plugin"><a class="anchor" href="#servicedocgen-maven-plugin"></a>ServicedocGen Maven Plugin</h5>
<div class="paragraph">
<p>The <a href="https://github.com/mojohaus/servicedocgen-maven-plugin">ServicedocGen maven plugin</a> can be used within both Spring and Quarkus applications.
It works a bit different then the Smallrye extensions mentioned above. The plugin analysis the REST API and it&#8217;s JavaDoc and then generate the OpenAPI specification and the Swagger UI as static files. So no Swagger or MicroProfile annotations have to be added.</p>
</div>
<div class="paragraph">
<p>The plugin can be configured in the pom.xml file of your application as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
      &lt;artifactId&gt;servicedocgen-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;1.0.0&lt;/version&gt;
      &lt;executions&gt;
        &lt;execution&gt;
          &lt;goals&gt;
            &lt;goal&gt;generate&lt;/goal&gt;
          &lt;/goals&gt;
        &lt;/execution&gt;
      &lt;/executions&gt;
      &lt;configuration&gt;
        &lt;descriptor&gt;
          &lt;info&gt;
            &lt;title&gt;...&lt;/title&gt;
            &lt;description&gt;...&lt;/description&gt;
          &lt;/info&gt;
          &lt;host&gt;...&lt;/host&gt;
          &lt;port&gt;...&lt;/port&gt;
          &lt;basePath&gt;...&lt;/basePath&gt;
          &lt;schemes&gt;
            &lt;scheme&gt;...&lt;/scheme&gt;
          &lt;/schemes&gt;
        &lt;/descriptor&gt;
      &lt;/configuration&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the configuration section you have to define additional information to generate the OpenAPI specification correctly. An example can be found in our <a href="https://github.com/devonfw-sample/devon4quarkus-reference/blob/master/pom.xml">Quarkus reference application</a>.
When building the application, an OpenApi.yaml and a SwaggerUI.html file are created in the <code>/target/site</code> folder. To make the Swagger UI available in the browser, the file must be served by some servlet.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Spring</p>
</div>
<div class="paragraph">
<p><a href="https://spring.io">Spring</a> is the most famous and established Java framework.
It is fully supported by <a href="https://devonfw.com">devonfw</a> as an option and alternative to <a href="quarkus">quarkus</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="guide-to-the-reader"><a class="anchor" href="#guide-to-the-reader"></a>1.71. Guide to the Reader</h3>
<div class="paragraph">
<p>Dependent on the intention you are reading this document, you might be most interested in the following chapters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you are not yet familiar with Spring, you may be interested in <a href="#pros">pros</a> and <a href="#cons">cons</a> of Spring. Also take a look at the <a href="https://spring.io/why-spring">official Spring website</a>.</p>
</li>
<li>
<p>If you already have experience developing with Spring but are new to devon4j, take a look at devon4j&#8217;s recommendations on general best practices. Check out the chapters on <a href="architecture">architecture design</a>, <a href="guide-structure-classic">project structuring</a> and <a href="coding-conventions">coding conventions</a>. Follow the referenced links to go deeper into a topic.</p>
</li>
<li>
<p>If you have already developed with devon4j and Spring and need more information on a specific topic, check out the <a href="https://devonfw.com/website/pages/docs/devon4j.wiki_devon4j_guides.html">devon4j guides for Spring</a>. If you don&#8217;t find what you are looking for there, check out the <a href="https://devonfw.com/website/pages/docs/devon4j_general.html">general section</a>. devon4j uses general solutions for Java, so solutions for both Spring and Quarkus are documented there.</p>
</li>
<li>
<p>If you want to get started or create your first Spring application using devon4j, check out the guide about <a href="tutorial-newapp">creating a new application</a> or the <a href="https://github.com/devonfw/jump-the-queue">Jump the Queue</a> and <a href="https://github.com/devonfw/my-thai-star">My Thai Star</a> reference applications.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="pros"><a class="anchor" href="#pros"></a>1.72. Pros</h3>
<div class="paragraph">
<p>Spring offers the following benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>highly flexible</strong><br>
Spring is famous for its great flexibility. You can customize and integrate nearly everything.</p>
</li>
<li>
<p><strong>well established</strong><br>
While <a href="guide-jee">JEE</a> application servers including very expensive commercial products turned out to be a dead-end, spring has guided projects through the changing trends of IT throughout decades. It may be the framework with the longest history track and popularity. As a result you can easily find developers, experts, books, articles, etc. about spring.</p>
</li>
<li>
<p><strong>non-invasive and not biased</strong><br>
Spring became famous for its non-invasive coding based on patterns instead of hard dependencies. It gives you a lot of freedom and avoids tight coupling of your (business) code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="https://spring.io/why-spring">Why Spring?</a> for details.</p>
</div>
</div>
<div class="sect2">
<h3 id="cons"><a class="anchor" href="#cons"></a>1.73. Cons</h3>
<div class="paragraph">
<p>Spring has the following drawbacks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>history and legacy</strong><br>
Due to the pro of its long established history, spring also carries a lot of legacy. As a result there are many ways to do the same thing while some options may be discouraged. Developers needs some guidance (e.g. via devon4j) as they may enter pitfalls and dead-ends when choosing the first solution they found on google or stackoverflow.</p>
</li>
<li>
<p><strong>lost lead in cloud-native</strong><br>
While for the last decades spring was leading innovation in Java app development, it seems that with the latest trends and shift such as cloud-native, they have been overtaken by frameworks like <a href="quarkus">quarkus</a>. However, spring is trying to catch up with <a href="#spring-native">spring-native</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="spring-boot"><a class="anchor" href="#spring-boot"></a>1.74. Spring-Boot</h3>
<div class="paragraph">
<p><a href="https://spring.io/projects/spring-boot">Spring-boot</a> is a project and initiaitve within the spring-ecosystem that brought a lot of innovation and simplification into app development on top of spring.
As of today we typically use the terms <em>spring</em> and <em>spring-boot</em> rather synonymously as we always use spring together with spring-boot.</p>
</div>
</div>
<div class="sect2">
<h3 id="spring-native"><a class="anchor" href="#spring-native"></a>1.75. Spring-Native</h3>
<div class="paragraph">
<p><a href="https://github.com/spring-projects-experimental/spring-native">Spring-native</a> adds cloud-native support to the spring ecosystem and allows to build a spring app as cloud-native image via <a href="https://www.graalvm.org/">GraalVM</a>.
You may also consider <a href="quarkus">Quarkus</a> if you are interested in building cloud-native images. For a comparison of both Spring Native and Quarkus, you may refer to our <a href="Spring-native-vs-Quarkus">Spring Native vs. Quarkus</a> guide.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Components</p>
</div>
<div class="paragraph">
<p>Following <a href="architecture#architecture-principles">separation-of-concerns</a> we divide an application into components using our <a href="coding-conventions#packages">package-conventions</a> and <a href="guide-structure">project structure</a>.
As described by the <a href="architecture">architecture</a> each component is divided into layers as described in the <a href="guide-structure">project structure</a>.
Please note that a component will only have the required layers.
So a component may have any number from one to all layers.</p>
</div>
<div class="sect3">
<h4 id="general-component"><a class="anchor" href="#general-component"></a>1.75.1. General Component</h4>
<div class="paragraph">
<p>Cross-cutting aspects belong to the implicit component <code>general</code>. It contains technical configurations and very general code that is not business specific. Such code shall not have any dependencies to other components and therefore business related code.</p>
</div>
</div>
<div class="sect3">
<h4 id="business-component"><a class="anchor" href="#business-component"></a>1.75.2. Business Component</h4>
<div class="paragraph">
<p>The <a href="architecture#business-architecture">business-architecture</a> defines the business components with their allowed dependencies. A small application (microservice) may just have one component and no dependencies making it simple while the same architecture can scale up to large and complex applications (from bigger microservice up to modulith).
Tailoring an business domain into applications and applications into components is a tricky task that needs the skills of an experienced architect.
Also, the tailoring should follow the business and not split by technical reasons or only by size.
Size is only an indicator but not a driver of tailoring.
Whatever hypes like microservices are telling you, never get misled in this regard:
If your system grows and reaches <code>MAX+1</code> lines of code, it is not the right motivation to split it into two microservices of <code>~MAX/2</code> lines of code - such approaches will waste huge amounts of money and lead to chaos.</p>
</div>
</div>
<div class="sect3">
<h4 id="app-component"><a class="anchor" href="#app-component"></a>1.75.3. App Component</h4>
<div class="paragraph">
<p>Only in case you need cross-cutting code that aggregates another component you may introduce the component <code>app</code>.
It is allowed to depend on all other components but no other component may depend on it.
With the modularity and flexibility of spring you typically do not need this.
However, when you need to have a class that registers all services or component-facades using direct code dependencies, you can introduce this component.</p>
</div>
</div>
<div class="sect3">
<h4 id="component-example"><a class="anchor" href="#component-example"></a>1.75.4. Component Example</h4>
<div class="paragraph">
<p>The following class diagram illustrates an example of the business component <code>Staffmanagement</code>:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/images/guide-logic-layer.png" alt="logic layer component pattern">
</div>
</div>
<div class="paragraph">
<p>In this scheme, you can see the structure and flow from the <a href="guide-service-layer">service-layer</a> (REST service call) via the <a href="guide-logic-layer">logic-layer</a> to the <a href="guide-dataaccess-layer">dataaccess-layer</a> (and back).</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Classic project structure</p>
</div>
<div class="paragraph">
<p>In this section we describe the classic project structure as initially proposed for Java in devonfw.
It is still valid and fully supported.
However, if you want to start a new project, please consider using the <a href="guide-structure-modern">modern structure</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="modules"><a class="anchor" href="#modules"></a>1.75.5. Modules</h4>
<div class="paragraph">
<p>The structure of a <code>devon4j</code> application is divided into the following modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>api</code>: module containing the API of your application. The API contains the required artifacts to interact with your application via remote services. This can be <a href="guide-rest#jax-rs">REST service interfaces</a>, <a href="guide-transferobject">transfer-objects</a> with their interfaces and <a href="guide-datatype">datatypes</a> but also <a href="https://www.openapis.org/">OpenAPI</a> or <a href="https://grpc.io/">gRPC</a> contracts.</p>
</li>
<li>
<p><code>core</code>: maven module containing the core of the application with service implementation, as well as entire <a href="guide-logic-layer">logic layer</a> and <a href="guide-dataaccess-layer">dataaccess layer</a>.</p>
</li>
<li>
<p><code>batch</code>: optional module for <a href="guide-batch-layer">batch layer</a></p>
</li>
<li>
<p><code>server</code>: module that bundles the entire app (<code>core</code> with optional <code>batch</code>) typically as a bootified WAR file.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deployment"><a class="anchor" href="#deployment"></a>1.75.6. Deployment</h4>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Make jar not war</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Josh Long
</div>
</div>
<div class="paragraph">
<p>First of all it is important to understand that the above defined modules aim to make <code>api</code>, <code>core</code>, and <code>batch</code> reusable artifacts, that can be used as a regular maven dependency.
On the other hand to build and deploy your application you want a final artifact that is containing all required 3rd party libraries.
This artifact is not reusable as a maven dependency.
That is exactly the purpose of the <code>server</code> module to build and package this final deployment artifact.
By default we first build a regular <code>WAR</code> file with maven in your <code>server/target</code> directory (<code>*-server-«version».war</code>) and in a second step create a bootified <code>WAR</code> out of this (<code>*-server-bootified.war</code>).
The bootified <code>WAR</code> file can then be started standalone (<code>java -jar «filename».war</code>).
However, it is also possible to deploy the same <code>WAR</code> file to a servlet container like <code>tomcat</code> or <code>jetty</code>.
As application servers and externally provided servlet containers are not recommendet anymore for various reasons (see <a href="guide-jee">JEE</a>), you may also want to create a bootified <code>JAR</code> file instead.
All you need to do in that case is to change the <code>packaging</code> in your <code>server/pom.xml</code> from <code>war</code> to <code>jar</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="package-structure"><a class="anchor" href="#package-structure"></a>1.75.7. Package Structure</h4>
<div class="paragraph">
<p>The package structure of your code inside <code>src/main/java</code> (and <code>src/test/java</code>) of your modules is described in our coding conventions in the sections <a href="coding-conventions#packages">packages</a>. A full mapping of the architecture and the different code elements to the packaging is described in the following section.</p>
</div>
</div>
<div class="sect3">
<h4 id="layers"><a class="anchor" href="#layers"></a>1.75.8. Layers</h4>
<div class="paragraph">
<p>The package structure of your code inside <code>src/main/java</code> (and <code>src/test/java</code>) of your app is described in our coding conventions in the sections <a href="coding-conventions#packages">packages</a>.
The following table describes our classic approach for packaging and layering:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Traditional generic devon4j layers</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Layer</strong></th>
<th class="tableblock halign-left valign-top"><strong>«layer»</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-service-layer">service</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>service</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-logic-layer">logic</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logic</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-dataaccess-layer">data-access</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dataaccess</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-batch-layer">batch</a> (optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>batch</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-client-layer">client</a> (optional)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>client</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-common">common</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>common</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="architecture-mapping"><a class="anchor" href="#architecture-mapping"></a>1.75.9. Architecture Mapping</h4>
<div class="paragraph">
<p>In order to help you to map the architecture, packaging, layering, etc. to the code and see where different code elements should be placed,
we provide this architecture mapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>«root»
├──.<a href="guide-component#business-component">«component»</a>
|  ├──.<a href="guide-common">common</a>
|  |  ├──.api[.«detail»]
|  |  |  ├──.<a href="guide-datatype">datatype</a>
|  |  |  |  └──.<a href="guide-datatype">«Datatype»</a> (api)
|  |  |  └──.<a href="guide-transferobject#bo">«BusinessObject»</a> (api)
|  |  └──.impl[.«detail»]
|  |     ├──.<a href="guide-configuration-mapping#mapping-advanced-configuration">«Aspect»ConfigProperties</a> (core)
|  |     ├──.<a href="guide-json#custom-mapping">«Datatype»JsonSerializer</a> (core)
|  |     └──.<a href="guide-json#custom-mapping">«Datatype»JsonDeserializer</a> (core)
|  ├──.<a href="guide-dataaccess-layer">dataaccess</a>
|  |  ├──.api[.«detail»]
|  |  |  ├──.<a href="guide-repository">repo</a>
|  |  |  |  └──.<a href="guide-repository#repository">«BusinessObject»Repository</a> (core)
|  |  |  ├──.<a href="guide-dao">dao</a> (core) [alternative to repo]
|  |  |  |  └──.<a href="guide-dao">«BusinessObject»Dao</a> (core) [alternative to Repository]
|  |  |  └──.<a href="guide-jpa#entity">«BusinessObject»Entity</a> (core)
|  |  └──.impl[.«detail»]
|  |     ├──.<a href="guide-dao">dao</a> (core) [alternative to repo]
|  |     |  └──.<a href="guide-dao">«BusinessObject»DaoImpl</a> (core) [alternative to Repository]
|  |     └──.<a href="guide-jpa#entities-and-datatypes">«Datatype»AttributeConverter</a> (core)
|  ├──.<a href="guide-logic-layer">logic</a>
|  |  ├──.api
|  |  |  ├──.[«detail».]<a href="guide-transferobject">to</a>
|  |  |  |   ├──.<a href="guide-transferobject#to">«MyCustom»«To</a> (api)
|  |  |  |   ├──.<a href="guide-jpa#embeddable">«DataStructure»Embeddable</a> (api)
|  |  |  |   ├──.<a href="guide-transferobject#eto">«BusinessObject»Eto</a> (api)
|  |  |  |   └──.<a href="guide-transferobject#cto">«BusinessObject»«Subset»Cto</a> (api)
|  |  |  ├──.[«detail».]<a href="guide-usecase">usecase</a>
|  |  |  |   ├──.<a href="guide-usecase#find">UcFind«BusinessObject»</a> (core)
|  |  |  |   ├──.<a href="guide-usecase#manage">UcManage«BusinessObject»</a> (core)
|  |  |  |   └──.<a href="guide-usecase#custom">Uc«Operation»«BusinessObject»</a> (core)
|  |  |  └──.<a href="guide-logic-layer#component">«Component»</a> (core)
|  |  ├──.base
|  |  |  └──.[«detail».]<a href="guide-usecase">usecase</a>
|  |  |     └──.<a href="guide-usecase">Abstract«BusinessObject»Uc</a> (core)
|  |  └──.impl
|  |     ├──.[«detail».]<a href="guide-usecase">usecase</a>
|  |     |   ├──.<a href="guide-usecase#find">UcFind«BusinessObject»Impl</a> (core)
|  |     |   ├──.<a href="guide-usecase#manage">UcManage«BusinessObject»Impl</a> (core)
|  |     |   └──.<a href="guide-usecase#custom">Uc«Operation»«BusinessObject»Impl</a> (core)
|  |     └──.<a href="guide-logic-layer#component">«Component»Impl</a> (core)
|  └──.<a href="guide-service-layer">service</a>
|     ├──.api[.«detail»]
|     |  ├──.<a href="guide-rest">rest</a>
|     |  |  └──.<a href="guide-rest#rest-service-api">«Component»RestService</a> (api)
|     |  └──.<a href="guide-soap">ws</a>
|     |     └──.<a href="guide-soap#web-service-api">«Component»WebService</a> (api)
|     └──.impl[.«detail»]
|        ├──.<a href="guide-jms">jms</a>
|        |  └──.<a href="guide-jms#jms-listener">«BusinessObject»JmsListener</a> (core)
|        ├──.<a href="guide-rest">rest</a>
|        |  └──.<a href="guide-rest#rest-service-implementation">«Component»RestServiceImpl</a> (core)
|        └──.<a href="guide-soap">ws</a>
|           └──.<a href="guide-soap#web-service-implementation">«Component»WebServiceImpl</a> (core)
├──.<a href="guide-component#general-component">general</a>
│  ├──.<a href="guide-common">common</a>
│  |  ├──.api
|  |  |  ├──.to
|  |  |  |  ├──.AbstractSearchCriteriaTo (api)
|  |  |  └──.ApplicationEntity
│  |  ├──.base
|  |  |  └──.AbstractBeanMapperSupport (core)
│  |  └──.impl
│  |     ├──.config
│  |     |  └──.ApplicationObjectMapperFactory (core)
│  |     └──.security
│  |        └──.ApplicationWebSecurityConfig (core)
│  ├──.dataaccess
│  |  └──.api
|  |     └──.ApplicationPersistenceEntity (core)
│  ├──.logic
│  |  └──.base
|  |     ├──.AbstractComponentFacade (core)
|  |     ├──.AbstractLogic (core)
|  |     └──.AbstractUc (core)
|  └──.service
|     └──...
└──.SpringBootApp (core)</pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="layers-2"><a class="anchor" href="#layers-2"></a>1.76. Layers</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Client Layer</p>
</div>
<div class="paragraph">
<p>There are various technical approaches to building GUI clients. The devonfw proposes rich clients that connect to the server via data-oriented services (e.g. using REST with JSON).
In general, we have to distinguish among the following types of clients:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>web clients</p>
</li>
<li>
<p>native desktop clients</p>
</li>
<li>
<p>(native) mobile clients</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Our main focus is on web-clients. In our sample application <a href="https://github.com/devonfw/my-thai-star/">my-thai-star</a> we offer a responsive web-client based on Angular following <a href="https://github.com/devonfw/devon4ng/">devon4ng</a> that integrates seamlessly with the back ends of my-thai-star available for Java using devon4j as well as .NET/C# using <a href="https://github.com/devonfw/devon4net/">devon4net</a>. For building angular clients read the separate <a href="https://github.com/devonfw/devon4ng/wiki">devon4ng guide</a>.</p>
</div>
<div class="sect4">
<h5 id="javascript-for-java-developers"><a class="anchor" href="#javascript-for-java-developers"></a>JavaScript for Java Developers</h5>
<div class="paragraph">
<p>In order to get started with client development as a Java developer we give you some hints to get started. Also if you are an experienced JavaScript developer and want to learn Java this can be helpful. First, you need to understand that the JavaScript ecosystem is as large as the Java ecosystem and developing a modern web client requires a lot of knowledge. The following table helps you as experienced developer to get an overview of the tools, configuration-files, and other related aspects from the new world to learn. Also it helps you to map concepts between the ecosystems. Please note that we list the tools recommended by devonfw here (and we know that there are alternatives not listed here such as gradle, grunt, bower, etc.).</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Aspects in JavaScript and Java ecosystem</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Topic</strong></th>
<th class="tableblock halign-left valign-top"><strong>Aspect</strong></th>
<th class="tableblock halign-left valign-top"><strong>JavaScript</strong></th>
<th class="tableblock halign-left valign-top"><strong>Java</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Programming</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Language</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.typescriptlang.org/">TypeScript</a> (extends <a href="https://www.javascript.com/">JavaScript</a>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.oracle.com/javase/tutorial/">Java</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Runtime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://nodejs.org/">nodejs</a> (or web-browser)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.oracle.com/technetwork/java/javase/">jvm</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="5"><p class="tableblock">Build- &amp; Dependency-Management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/npm/npm">npm</a> or <a href="http://yarnpkg.com/">yarn</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://maven.apache.org/">maven</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Config</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.npmjs.com/files/package.json">package.json</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://maven.apache.org/pom.html">pom.xml</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Repository</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.npmjs.com/">npm repo</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://repo.maven.apache.org/maven2">maven central</a> (<a href="https://mvnrepository.com/">repo search</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build cmd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><a href="https://angular.io/cli">ng</a> build</code> or <code>npm run build</code> (goals are not standardized in npm)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvn <a href="https://maven.apache.org/plugins/maven-install-plugin/usage.html">install</a> (see <a href="https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html">lifecycle</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test cmd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><a href="https://angular.io/cli">ng</a> test</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mvn <a href="http://maven.apache.org/components/surefire/maven-surefire-plugin/">test</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock"><a href="guide-testing">Testing</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test-Tool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://jasmine.github.io/">jasmine</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://junit.org/">junit</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test-Runner</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://karma-runner.github.io/">karma</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://junit.org/">junit</a> / <a href="http://maven.apache.org/components/surefire/maven-surefire-plugin/">surefire</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">E2E Testing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.protractortest.org/">Protractor</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.seleniumhq.org/">Selenium</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code Analysis</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code Coverage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><a href="https://angular.io/guide/testing-code-coverage">ng test --no-watch --code-coverage</a></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.eclemma.org/jacoco/">JaCoCo</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">Development</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IDE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://code.visualstudio.com/">MS VS Code</a> or <a href="https://www.jetbrains.com/idea/">IntelliJ</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://eclipse.org/downloads/">Eclipse</a> or <a href="https://www.jetbrains.com/idea/">IntelliJ</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://angularjs.org/">Angular</a> (etc.)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="spring">Spring</a> or <a href="quarkus">Quarkus</a></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Service Layer</p>
</div>
<div class="paragraph">
<p>The service layer is responsible for exposing functionality made available by the <a href="guide-logic-layer">logical layer</a> to external consumers over a network via <a href="#protocol">technical protocols</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="types-of-services"><a class="anchor" href="#types-of-services"></a>Types of Services</h5>
<div class="paragraph">
<p>Before you start creating your services you should consider some general design aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Do you want to create a <a href="https://en.wikipedia.org/wiki/Remote_procedure_call">RPC</a> service?</p>
</li>
<li>
<p>Or is your problem better addressed by messaging or eventing?</p>
</li>
<li>
<p>Who will consume your service?</p>
<div class="ulist">
<ul>
<li>
<p>Do you have one or multiple consumers?</p>
</li>
<li>
<p>Do web-browsers have to use your service?</p>
</li>
<li>
<p>Will apps from other vendors or parties have to consume your service that you can not influence if the service may have to change or be extended?</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For RPC a common choice is <a href="guide-rest">REST</a> but there are also interesting alternatives like <a href="https://grpc.io/">gRPC</a>. We also have a guide for <a href="guide-soap">SOAP</a> but this technology should rather be considered as legacy and is not recommended for new services.</p>
</div>
<div class="paragraph">
<p>When it comes to messaging in Java the typical answer will be <a href="guide-jms">JMS</a>. However, a very promising alternative is <a href="guide-kafka">Kafka</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="versioning"><a class="anchor" href="#versioning"></a>Versioning</h5>
<div class="paragraph">
<p>For RPC services consumed by other applications we use versioning to prevent incompatibilities between applications when deploying updates. This is done by the following conventions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We define a version number and prefix it with <code>v</code> (e.g. <code>v1</code>).</p>
</li>
<li>
<p>If we support previous versions we use that version numbers as part of the Java package defining the service API (e.g. <code>com.foo.application.component.service.api.v1</code>)</p>
</li>
<li>
<p>We use the version number as part of the service name in the remote URL (e.g. <code><a href="https://application.foo.com/services/rest/component/v1/resource" class="bare">https://application.foo.com/services/rest/component/v1/resource</a></code>)</p>
</li>
<li>
<p>Whenever breaking changes are made to the API, create a separate version of the service and increment the version (e.g. <code>v1</code> &#8594; <code>v2</code>) . The implementations of the different versions of the service contain compatibility code and delegate to the same unversioned use-case of the logic layer whenever possible.</p>
</li>
<li>
<p>For maintenance and simplicity, avoid keeping more than one previous version.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="interoperability"><a class="anchor" href="#interoperability"></a>Interoperability</h5>
<div class="paragraph">
<p>For services that are consumed by clients with different technology, <em>interoperability</em> is required. This is addressed by selecting the right protocol, following protocol-specific best practices and following our considerations especially <em>simplicity</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="service-considerations"><a class="anchor" href="#service-considerations"></a>Service Considerations</h5>
<div class="paragraph">
<p>The term <em>service</em> is quite generic and therefore easily misunderstood. It is a unit exposing coherent functionality via a well-defined interface over a network. For the design of a service, we consider the following aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>self-contained</strong><br>
The entire API of the service shall be self-contained and have no dependencies on other parts of the application (other services, implementations, etc.).</p>
</li>
<li>
<p><strong>idempotence</strong><br>
E.g. creation of the same master-data entity has no effect (no error)</p>
</li>
<li>
<p><strong>loosely coupled</strong><br>
Service consumers have minimum knowledge and dependencies on the service provider.</p>
</li>
<li>
<p><strong>normalized</strong><br>
Complete, no redundancy, minimal</p>
</li>
<li>
<p><strong>coarse-grained</strong><br>
Service provides rather large operations (save entire entity or set of entities rather than individual attributes)</p>
</li>
<li>
<p><strong>atomic</strong><br>
Process individual entities (for processing large sets of data, use a <a href="guide-batch-layer">batch</a> instead of a service)</p>
</li>
<li>
<p><strong>simplicity</strong><br>
Avoid polymorphism, RPC methods with unique name per signature and no overloading, avoid attachments (consider separate download service), etc.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="security-6"><a class="anchor" href="#security-6"></a>Security</h5>
<div class="paragraph">
<p>Your services are the major entry point to your application. Hence, security considerations are important here.</p>
</div>
<div class="paragraph">
<p>See <a href="guide-rest#security">REST Security</a>.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Service-Versioning</p>
</div>
<div class="paragraph">
<p>This guide describes the aspect and details about versioning of <a href="guide-service-layer">services</a></p>
</div>
</div>
<div class="sect4">
<h5 id="motivation-4"><a class="anchor" href="#motivation-4"></a>Motivation</h5>
<div class="paragraph">
<p>Why versioning of services? First of all, you should only care about this topic if you really have to. Service versioning is complex and requires effort (time and budget). The best way to avoid this is to be smart in the first place when designing the service API.
Further, if you are creating services where the only consumer is e.g. the web-client that you deploy together with the consumed services then you can change your service without the overhead to create new service versions and keeping old service versions for compatibility.</p>
</div>
<div class="paragraph">
<p>However, if the following indicators are given you typically need to do service versioning:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your service is part of a complex and distributed IT landscape</p>
</li>
<li>
<p>Your service requires incompatible changes</p>
</li>
<li>
<p>There are many consumers or there is at least one (relevant) consumer that can not be updated at the same time or is entirely out of control (unknown or totally different party/company)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>What are incompatible changes?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Almost any change when <a href="guide-soap">SOAP</a> is used (as it changes the WSDL and breaks the contract). Therefore, we recommend to use <a href="guide-rest">REST</a> instead. Then, only the following changes are critical.</p>
</li>
<li>
<p>A change where existing properties (attributes) have to change their name</p>
</li>
<li>
<p>A change where existing features (properties, operations, etc.) have to change their semantics (meaning)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>What changes do not cause incompatibilities?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding new service operations is entirely uncritical with <a href="guide-rest">REST</a>.</p>
</li>
<li>
<p>Adding new properties is only a problem in the following cases:</p>
<div class="ulist">
<ul>
<li>
<p>Adding new mandatory properties to the input of a service is causing incompatibilities. This problem can be avoided by contract-design.</p>
</li>
<li>
<p>If a consumer is using a service to read data, modify it and then save it back via a service and a property is added to the data, then this property might be lost. This is not a problem with dynamic languages such as JavaScript/TypeScript but with strictly typed languages such as Java. In Java you will typically use structured typed transfer-objects (and not <code>Map&lt;String, Object&gt;</code>) so new properties that have been added but are not known to the consumer can not be mapped to the transfer-object and will be lost. When saving that transfer-object later the property will be gone. It might be impossible to determine the difference between a lost property and a property that was removed on purpose. This is a general problem that you need to be aware of and that you have to consider by your design in such situations.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Even if you hit an indicator for incompatible changes you can still think about adding a new service operation instead of changing an existing one (and deprecating the old one). Be creative to simplify and avoid extra effort.</p>
</div>
</div>
<div class="sect4">
<h5 id="procedure"><a class="anchor" href="#procedure"></a>Procedure</h5>
<div class="paragraph">
<p>The procedure when rolling out incompatible changes is illustrated by the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>+------+  +------+
| App1 |  | App2 |
+---+--+  +--+---+
    |        |
    +---+----+
        |
+-------+--------+
|      Sv1       |
|                |
|      App3      |
+----------------+</code></pre>
</div>
</div>
<div class="paragraph">
<p>So, here we see a simple example where <code>App3</code> provides a Service <code>S</code> in Version <code>v1</code> that is consumed both by <code>App1</code> and <code>App2</code>.</p>
</div>
<div class="paragraph">
<p>Now for some reason the service <code>S</code> has to be changed in an incompatible way to make it future-proof for demands. However, upgrading all 3 applications at the same time is not possible in this case for whatever reason. Therefore, service versioning is applied for the changes of <code>S</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>+------+  +------+
| App1 |  | App2 |
+---+--+  +--+---+
    |        |
    +--------+
    |
+---+------------+
|  Sv1  |  Sv2   |
|                |
|      App3*     |
+----------------+</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, <code>App3</code> has been upgraded and the new release was deployed. A new version <code>v2</code> of <code>S</code> has been added while <code>v1</code> is still kept for compatibility reasons and that version is still used by <code>App1</code> and <code>App2</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>+------+  +------+
| App1 |  | App2*|
+---+--+  +--+---+
    |        |
    |        |
    |        |
+---+--------+---+
|  Sv1  |  Sv2   |
|                |
|      App3      |
+----------------+</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, <code>App2</code> has been updated and deployed and it is using the new version <code>v2</code> of <code>S</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>+------+  +------+
| App1*|  | App2 |
+---+--+  +--+---+
    |        |
    +--------+
             |
+------------+---+
|  Sv1  |  Sv2   |
|                |
|      App3      |
+----------------+</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, also <code>App1</code> has been updated and deployed and it is using the new version <code>v2</code> of <code>S</code>. The version <code>v1</code> of <code>S</code> is not used anymore. This can be verified via logging and monitoring.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>+------+  +------+
| App1 |  | App2 |
+---+--+  +--+---+
    |        |
    +--------+
             |
+------------+---+
|          Sv2   |
|                |
|      App3*     |
+----------------+</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, version <code>v1</code> of the service <code>S</code> was removed from <code>App3</code> and the new release has been deployed.</p>
</div>
</div>
<div class="sect4">
<h5 id="versioning-schema"><a class="anchor" href="#versioning-schema"></a>Versioning Schema</h5>
<div class="paragraph">
<p>In general anything can be used to differentiate versions of a service. Possibilities are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Code names (e.g. <code>Strawberry</code>, <code>Blueberry</code>, <code>Grapefruit</code>)</p>
</li>
<li>
<p>Timestamps (<code>YYYYMMDD-HHmmSS</code>)</p>
</li>
<li>
<p>Sequential version numbers (e.g. <code>v1</code>, <code>v2</code>, <code>v3</code>)</p>
</li>
<li>
<p>Composed version numbers (e.g. <code>1.0.48-pre-alpha-3-20171231-235959-Strawberry</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As we are following the KISS principle (see <a href="architecture#key-principles">key principles</a>) we propose to use sequential version numbers. These are short, clear, and easy while still allowing to see what version is after another one. Especially composed version numbers (even <code>1.1</code> vs. <code>2.0</code>) lead to decisions and discussions that easily waste more time than adding value. It is still very easy to maintain an Excel sheet or release-notes document that is explaining the changes for each version (<code>v1</code>, <code>v2</code>, <code>v3</code>) of a particular service.</p>
</div>
<div class="paragraph">
<p>We suggest to always add the version schema to the service URL to be prepared for service versioning even if service versioning is not (yet) actively used. For simplicity it is explicitly stated that you may even do incompatible changes to the current version (typically <code>v1</code>) of your service if you can update the according consumers within the same deployment.</p>
</div>
</div>
<div class="sect4">
<h5 id="practice"><a class="anchor" href="#practice"></a>Practice</h5>
<div class="paragraph">
<p>So assuming you know that you have to do service versioning, the question is how to do it practically in the code.
The approach for your devon4j project in case of code-first should be as described below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Determine which types in the code need to be changed. It is likely to be the API and implementation of the according service but it may also impact transfer objects and potentially even datatypes.</p>
</li>
<li>
<p>Create new packages for all these concerned types containing the current version number (e.g. <code>v1</code>).</p>
</li>
<li>
<p>Copy all these types to that new packages.</p>
</li>
<li>
<p>Rename these copies so they carry the version number as suffix (e.g. <code>V1</code>).</p>
</li>
<li>
<p>Increase the version of the service in the unversioned package (e.g. from <code>v1</code> to <code>v2</code>).</p>
</li>
<li>
<p>Now you have two versions of the same service (e.g. <code>v1</code> and <code>v2</code>) but so far they behave exactly the same.</p>
</li>
<li>
<p>You start with your actual changes and modify the original files that have been copied before.</p>
</li>
<li>
<p>You will also ensure the links (import statements) of the copied types point to the copies with the version number</p>
</li>
<li>
<p>This will cause incompatibilities (and compile errors) in the copied service. Therefore, you need to fix that service implementation to map from the old API to the new API and behavior. In some cases, this may be easy (e.g. mapping <code>x.y.z.v1.FooTo</code> to <code>x.y.z.FooTo</code> using <a href="guide-beanmapping">bean-mapping</a> with some custom mapping for the incompatible changes), in other cases this can get very complex. Be aware of this complexity from the start before you make your decision about service versioning.</p>
</li>
<li>
<p>As far as possible this mapping should be done in the service-layer, not to pollute your business code in the core-layer with versioning-aspects. If there is no way to handle it in the service layer, e.g. you need some data from the persistence-layer, implement the "mapping" in the core-layer then, but don&#8217;t forget to remove this code, when removing the old service version.</p>
</li>
<li>
<p>Finally, ensure that both the old service behaves as before as well as the new service works as planned.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="modularization"><a class="anchor" href="#modularization"></a>Modularization</h6>
<div class="paragraph">
<p>For modularization, we also follow the KISS principle (see <a href="architecture#key-principles">key principles</a>):
we suggest to have one <code>api</code> module per application that will contain the most recent version of your service and get released with every release-version of the application. The compatibility code with the versioned packages will be added to the <code>core</code> module and therefore is not exposed via the <code>api</code> module (because it has already been exposed in the previous release of the app). This way, you can always determine for sure which version of a service is used by another application just by its maven dependencies.</p>
</div>
<div class="paragraph">
<p>The KISS approach with only a single module that may contain multiple services (e.g. one for each business component) will cause problems when you want to have mixed usages of service versions: You can not use an old version of one service and a new version of another service from the same APP as then you would need to have its API module twice as a dependency on different versions, which is not possible. However, to avoid complicated overhead we always suggest to follow this easy approach. Only if you come to the point that you really need this complexity you can still solve it (even afterwards by publishing another maven artefact). As we are all on our way to build more but smaller applications (SOA, microservices, etc.) we should always start simple and only add complexity when really needed.</p>
</div>
<div class="paragraph">
<p>The following example gives an idea of the structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>/«my-app»
├──/api
|  └──/src/main/java/
|     └──/«rootpackage»/«application»/«component»
|        ├──/common/api/to
|        |  └──FooTo
|        └──/service/api/rest
|           └──FooRestService
└──/core
   └──/src/main/java/
      └──«rootpackage»/«application»/«component»
         ├──/common/api/to/v1
         |  └──FooToV1
         └──/service
            ├──/api/rest/v1
            |  └──FooRestServiceV1
            └──impl/rest
               ├──/v1
               |  └── FooRestServiceImplV1
               └──FooRestServiceImpl</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Logic Layer</p>
</div>
<div class="paragraph">
<p>The logic layer is the heart of the application and contains the main business logic.
According to our <a href="architecture#business-architecture">business architecture</a>, we divide an application into <a href="guide-component">components</a>.
For each component, the logic layer defines different <a href="guide-usecase">use-cases</a>. Another approach is to define a <a href="guide-component-facade">component-facade</a>, which we do not recommend for future application. Especially for quarkus application, we want to simplify things and highly suggest omitting component-facade completely and using use-cases only.
It is very important that you follow the links to understand the concept of use-case in order to properly implement your business logic.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="responsibility"><a class="anchor" href="#responsibility"></a>Responsibility</h5>
<div class="paragraph">
<p>The logic layer is responsible to implement the business logic according to the specified functional demands and requirements.
Therefore, it creates the actual value of the application. The logic layer is responsible for invoking business logic in external systems.
The following additional aspects are also included in its responsibility:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-validation">validation</a></p>
</li>
<li>
<p><a href="guide-access-control#authorization">authorization</a></p>
</li>
<li>
<p><a href="guide-transactions">transaction-handling</a> (in addition to <a href="guide-service-layer">service layer</a>).</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="security-7"><a class="anchor" href="#security-7"></a>Security</h5>
<div class="paragraph">
<p>The logic layer is the heart of the application. It is also responsible for authorization and hence security is important in this current case. Every method exposed in an interface needs to be annotated with an authorization check, stating what role(s) a caller must provide in order to be allowed to make the call. The authorization concept is described <a href="guide-access-control#authorization">here</a>.</p>
</div>
<div class="sect5">
<h6 id="direct-object-references"><a class="anchor" href="#direct-object-references"></a>Direct Object References</h6>
<div class="paragraph">
<p>A security threat are <a href="https://www.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References">Insecure Direct Object References</a>. This simply gives you two options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>avoid direct object references</p>
</li>
<li>
<p>ensure that direct object references are secure</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Especially when using REST, direct object references via technical IDs are common sense. This implies that you have a proper <a href="#authorization">authorization</a> in place. This is especially tricky when your authorization does not only rely on the type of the data and according to static permissions but also on the data itself. Vulnerabilities for this threat can easily happen by design flaws and inadvertence. Here is an example from our sample application:</p>
</div>
<div class="paragraph">
<p>We have a generic use-case to manage BLOBs. In the first place, it makes sense to write a generic REST service to load and save these BLOBs. However, the permission to read or even update such BLOB depends on the business object hosting the BLOB. Therefore, such a generic REST service would open the door for this OWASP A4 vulnerability. To solve this in a secure way, you need individual services for each hosting business object to manage the linked BLOB and have to check permissions based on the parent business object. In this example the ID of the BLOB would be the direct object reference and the ID of the business object (and a BLOB property indicator) would be the indirect object reference.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Component Facade</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Our recommended approach for implementing the logic layer is <a href="guide-usecase">use-cases</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For each component of the application, the <a href="guide-logic-layer">logic layer</a> defines a component facade.
This is an interface defining all business operations of the component.
It carries the name of the component (<code>«Component»</code>) and has an implementation named <code>«Component»Impl</code> (see <a href="#implementation">implementation</a>).</p>
</div>
</div>
<div class="sect5">
<h6 id="api"><a class="anchor" href="#api"></a>API</h6>
<div class="paragraph">
<p>The component facade interface defines the logic API of the component and has to be business oriented.
This means that all parameters and return types of all methods from this API have to be business <a href="guide-transferobject">transfer-objects</a>, <a href="guide-datatype">datatypes</a> (<code>String</code>, <code>Integer</code>, <code>MyCustomerNumber</code>, etc.), or collections of these.
The API may also only access objects of other business components listed in the (transitive) dependencies of the <a href="architecture#business-architecture">business-architecture</a>.</p>
</div>
<div class="paragraph">
<p>Here is an example how such an API may look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface Bookingmanagement {

  BookingEto findBooking(Long id);

  BookingCto findBookingCto(Long id);

  Page&lt;BookingEto&gt; findBookingEtos(BookingSearchCriteriaTo criteria);

  void approveBooking(BookingEto booking);

}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="implementation"><a class="anchor" href="#implementation"></a>Implementation</h6>
<div class="paragraph">
<p>The implementation of an interface from the <a href="guide-logic-layer">logic layer</a> (a component facade or a <a href="guide-usecase">use-case</a>) carries the name of that interface with the suffix <code>Impl</code> and is annotated with <code>@Named</code>.
An implementation typically needs access to the persistent data.
This is done by <a href="guide-dependency-injection">injecting</a> the corresponding <a href="guide-repository">repository</a> (or <a href="guide-dao">DAO</a>).
According to <a href="architecture#architecture-principles">data-sovereignty</a>, only repositories of the same business component may be accessed directly.
For accessing data from other components the implementation has to use the corresponding API of the logic layer (the component facade). Further, it shall not expose persistent entities from the <a href="guide-domain-layer">domain layer</a> and has to map them to <a href="guide-transferobject">transfer objects</a> using the <a href="guide-beanmapping">bean-mapper</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named
@Transactional
public class BookingmanagementImpl extends AbstractComponentFacade implements Bookingmanagement {

  @Inject
  private BookingRepository bookingRepository;

  @Override
  public BookingEto findBooking(Long id) {

    LOG.debug("Get Booking with id {} from database.", id);
    BookingEntity entity = this.bookingRepository.findOne(id);
    return getBeanMapper().map(entity, BookingEto.class));
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, <a href="guide-jpa#entity">entities</a> (<code>BookingEntity</code>) are mapped to corresponding <a href="guide-transferobject#eto">ETOs</a> (<code>BookingEto</code>).
Further details about this can be found in <a href="guide-beanmapping">bean-mapping</a>.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==UseCase
A use-case is a small unit of the <a href="guide-logic-layer">logic layer</a> responsible for an operation on a particular <a href="guide-jpa#entity">entity</a> (business object).
We leave it up to you to decide whether you want to define an interface (API) for each use-case or provide an implementation directly.</p>
</div>
<div class="paragraph">
<p>Following our architecture-mapping (for <a href="guide-structure-classic#architecture-mapping">classic</a> and <a href="guide-structure-modern#architecture-mapping">modern</a> project), use-cases are named <code>Uc«Operation»«BusinessObject»[Impl]</code>. The prefix <code>Uc</code> stands for use-case and allows to easily find and identify them in your IDE. The <code>«Operation»</code> stands for a verb that is operated on the entity identified by <code>«BusinessObject»</code>.
For <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> we use the standard operations <code>Find</code> and <code>Manage</code> that can be generated by <a href="https://github.com/devonfw/cobigen">CobiGen</a>. This also separates read and write operations (e.g. if you want to do CQSR, or to configure read-only transactions for read operations).</p>
</div>
<div class="paragraph">
<p>In our example, we choose to define an interface for each use-case. We also use <code>*To</code> to refer to any type of transfer object. Please follow our <a href="guide-transferobject">guide</a> to understand more about different types of transfer object e.g. Eto, Dto, Cto</p>
</div>
</div>
<div class="sect5">
<h6 id="find"><a class="anchor" href="#find"></a>Find</h6>
<div class="paragraph">
<p>The <code>UcFind«BusinessObject»</code> defines all read operations to retrieve and search the <code>«BusinessObject»</code>.
Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface UcFindBooking {
  //*To = Eto, Dto or Cto
  Booking*To findBooking(Long id);
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="manage"><a class="anchor" href="#manage"></a>Manage</h6>
<div class="paragraph">
<p>The <code>UcManage«BusinessObject»</code> defines all CRUD write operations (create, update and delete) for the <code>«BusinessObject»</code>.
Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface UcManageBooking {

  //*To = Eto, Dto or Cto
  Booking*To saveBooking(Booking*To booking);

  void deleteBooking(Long id);

}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="custom-2"><a class="anchor" href="#custom-2"></a>Custom</h6>
<div class="paragraph">
<p>Any other non CRUD operation <code>Uc«Operation»«BusinessObject»</code> uses any other custom verb for <code>«Operation»</code>.
Typically, such custom use-cases only define a single method.
Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface UcApproveBooking {

  //*To = Eto, Dto or Cto
  void approveBooking(Booking*To booking);

}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="implementation-2"><a class="anchor" href="#implementation-2"></a>Implementation</h6>
<div class="paragraph">
<p>The implementation should carry its own name and the suffix <code>Impl</code> and is annotated with <code>@Named</code> and <code>@ApplicationScoped</code>. It will need access to the persistent data which is done by injecting the corresponding repository (or DAO). Furthermore, it shall not expose persistent entities from the data access layer and has to map them to transfer objects using the bean-mapper. Please refer to our <a href="guide-beanmapping">bean mapping</a>, <a href="guide-transferobject">transfer object</a> and <a href="guide-dependency-injection">dependency injection</a> documentation for more information.
Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
@Named
public class UcManageBookingImpl implements UcManageBooking {

  @Inject
  private BookingRepository bookingRepository;

  @Override
  public void deleteBooking(Long id) {

    LOG.debug("Delete Booking with id {} from database.", id);
    this.bookingRepository.deleteById(id);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The use-cases can then be injected directly into the service.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named("BookingmanagementRestService")
@Validated
public class BookingmanagementRestServiceImpl implements BookingmanagementRestService {

  @Inject
  private UcFindBooking ucFindBooking;

  @Inject
  private UcManageBooking ucManageBooking;

  @Inject
  private UcApproveBooking ucApproveBooking;
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="internal-use-case"><a class="anchor" href="#internal-use-case"></a>Internal use case</h6>
<div class="paragraph">
<p>Sometimes, a component with multiple related entities and many use-cases needs to reuse business logic internally.
Of course, this can be exposed as an official use-case API but this will imply using transfer-objects (ETOs) instead of entities. In some cases, this is undesired e.g. for better performance to prevent unnecessary mapping of entire collections of entities.
In the first place, you should try to use abstract base implementations providing reusable methods the actual use-case implementations can inherit from.
If your business logic is even more complex and you have multiple aspects of business logic to share and reuse but also run into multi-inheritance issues, you may also just create use-cases that have their interface located in the <code>impl</code> scope package right next to the implementation (or you may just skip the interface). In such a case, you may define methods that directly take or return entity objects.
To avoid confusion with regular use-cases, we recommend to add the <code>Internal</code> suffix to the type name leading to <code>Uc«Operation»«BusinessObject»Internal[Impl]</code>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Data-Access Layer</p>
</div>
<div class="paragraph">
<p>The data-access layer is responsible for all outgoing connections to access and process data. This is mainly about accessing data from a persistent data-store. External system could also be accessed from the data-access layer if they match this definition, e.g. a mongo-db via rest services.</p>
</div>
<div class="paragraph">
<p>Note: In the <a href="guide-structure-modern">modern project structure</a>, this layer is replaced by the <a href="guide-domain-layer">domain layer</a>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="database"><a class="anchor" href="#database"></a>Database</h5>
<div class="paragraph">
<p>You need to make your choice for a database. Options are documented <a href="https://github.com/devonfw/devonfw-guide/blob/master/general/db/guide-database.adoc">here</a>.</p>
</div>
<div class="paragraph">
<p>The classical approach is to use a Relational Database Management System (RDMS). In such a case, we strongly recommend to follow our <a href="guide-jpa">JPA Guide</a>. Some NoSQL databases are supported by <a href="https://spring.io/projects/spring-data">spring-data</a> so you can consider the <a href="guide-repository">repository guide</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Batch Layer</p>
</div>
<div class="paragraph">
<p>We understand batch processing as a bulk-oriented, non-interactive, typically long running execution of tasks. For simplicity, we use the term "batch" or "batch job" for such tasks in the following documentation.</p>
</div>
<div class="paragraph">
<p>devonfw uses <a href="http://projects.spring.io/spring-batch/">Spring Batch</a> as a batch framework.</p>
</div>
<div class="paragraph">
<p>This guide explains how Spring Batch is used in devonfw applications. It focuses on aspects which are special to devonfw. If you want to learn about spring-batch you should adhere to springs references documentation.</p>
</div>
<div class="paragraph">
<p>There is an example of a simple batch implementation in the <a href="https://github.com/devonfw/my-thai-star/tree/develop/java/mtsj/batch">my-thai-star batch module</a>.</p>
</div>
<div class="paragraph">
<p>In this chapter, we will describe the overall architecture (especially concerning layering) and how to administer batches.</p>
</div>
</div>
<div class="sect4">
<h5 id="layering"><a class="anchor" href="#layering"></a>Layering</h5>
<div class="paragraph">
<p>Batches are implemented in the batch layer. The batch layer is responsible for batch processes, whereas the business logic is implemented in the logic layer. Compared to the <a href="guide-service-layer">service layer</a>, you may understand the batch layer just as a different way of accessing the business logic.
From a component point of view, each batch is implemented as a subcomponent in the corresponding business component.
The business component is defined by the <a href="architecture">business architecture</a>.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s make an example for that. The sample application implements a batch for exporting ingredients. This ingredientExportJob belongs to the dishmanagement business component.
So the ingredientExportJob is implemented in the following package:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>&lt;basepackage&gt;.dishmanagement.batch.impl.*</code></pre>
</div>
</div>
<div class="paragraph">
<p>Batches should invoke use cases in the logic layer for doing their work.
Only "batch specific" technical aspects should be implemented in the batch layer.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Example:
For a batch, which imports product data from a CSV file, this means that all code for actually reading and parsing the CSV input file is implemented in the batch layer.
The batch calls the use case "create product" in the logic layer for actually creating the products for each line read from the CSV input file.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="directly-accessing-data-access-layer"><a class="anchor" href="#directly-accessing-data-access-layer"></a>Directly accessing data access layer</h6>
<div class="paragraph">
<p>In practice, it is not always appropriate to create use cases for every bit of work a batch should do. Instead, the data access layer can be used directly.
An example for that is a typical batch for data retention which deletes out-of-time data.
Often deleting, out-dated data is done by invoking a single SQL statement. It is appropriate to implement that SQL in a <a href="guide-repository">Repository</a> or <a href="guide-dao">DAO</a> method and call this method directly from the batch.
But be careful: this pattern is a simplification which could lead to business logic cluttered in different layers, which reduces the maintainability of your application.
It is a typical design decision you have to make when designing your specific batches.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="project-structure-and-packaging"><a class="anchor" href="#project-structure-and-packaging"></a>Project structure and packaging</h5>
<div class="paragraph">
<p>Batches will be implemented in a separate Maven module to keep the application core free of batch dependencies. The batch module includes a dependency on the application core-module to allow the reuse of the use cases, DAOs etc.
Additionally the batch module has dependencies on the required spring batch jars:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">  &lt;dependencies&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;${project.groupId}&lt;/groupId&gt;
      &lt;artifactId&gt;mtsj-core&lt;/artifactId&gt;
      &lt;version&gt;${project.version}&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-starter-batch&lt;/artifactId&gt;
    &lt;/dependency&gt;

  &lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To allow an easy <a href="#start-batch">start of the batches</a> from the command line it is advised to create a bootified jar for the batch module by adding the following to the <code>pom.xml</code> of the batch module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">  &lt;build&gt;
    &lt;resources&gt;
      &lt;resource&gt;
        &lt;directory&gt;src/main/resources&lt;/directory&gt;
        &lt;filtering&gt;true&lt;/filtering&gt;
      &lt;/resource&gt;
    &lt;/resources&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;excludes&gt;
            &lt;exclude&gt;config/application.properties&lt;/exclude&gt;
          &lt;/excludes&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;!-- Create bootified jar for batch execution via command line.
           Your applications spring boot app is used as main-class.
       --&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
        &lt;configuration&gt;
          &lt;mainClass&gt;com.devonfw.application.mtsj.SpringBootApp&lt;/mainClass&gt;
          &lt;classifier&gt;bootified&lt;/classifier&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;repackage&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="implementation-3"><a class="anchor" href="#implementation-3"></a>Implementation</h5>
<div class="paragraph">
<p>Most of the details about implementation of batches is described in the <a href="https://spring.io/projects/spring-batch">spring batch documentation</a>.
There is nothing special about implementing batches in devonfw. You will find an easy <a href="https://github.com/devonfw/my-thai-star/tree/develop/java/mtsj/batch">example in my-thai-star</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="start-batch"><a class="anchor" href="#start-batch"></a>Starting from command line</h5>
<div class="paragraph">
<p>Devonfw advises to start batches via command line. This is most common to many ops teams and allows easy integration in existing <a href="#scheduling">schedulers</a>. In general batches are started with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -jar &lt;app&gt;-batch-&lt;version&gt;-bootified.jar --spring.main.web-application-type=none --spring.batch.job.enabled=true --spring.batch.job.names=&lt;myJob&gt; &lt;params&gt;</pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--spring.main.web-application-type=none</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This disables the web app (e.g. Tomcat)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--spring.batch.job.names=&lt;myJob&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This specifies the name of the job to run. If you leave this out ALL jobs will be executed. Which probably does not make to much sense.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;params&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Optional) additional parameters which are passed to your job</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This will launch your normal spring boot app, disables the web application part and runs the designated job via Spring Boots <code>org.springframework.boot.autoconfigure.batch.JobLauncherCommandLineRunner</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="scheduling"><a class="anchor" href="#scheduling"></a>Scheduling</h5>
<div class="paragraph">
<p>In real world scheduling of batches is not as simple as it first might look like.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Multiple batches have to be executed in order to achieve complex tasks. If one of those batches fails the further execution has to be stopped and operations should be notified for example.</p>
</li>
<li>
<p>Input files or those created by batches have to be copied from one node to another.</p>
</li>
<li>
<p>Scheduling batch executing could get complex easily (quarterly jobs, run job on first workday of a month, &#8230;&#8203;)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For devonfw we propose the batches themselves should not mess around with details of scheduling.
Likewise your application should not do so. This complexity should be externalized to a dedicated batch administration service or scheduler.
This service could be a complex product or a simple tool like cron. We propose <a href="http://rundeck.org">Rundeck</a> as an open source job scheduler.</p>
</div>
<div class="paragraph">
<p>This gives full control to operations to choose the solution which fits best into existing administration procedures.</p>
</div>
</div>
<div class="sect4">
<h5 id="handling-restarts"><a class="anchor" href="#handling-restarts"></a>Handling restarts</h5>
<div class="paragraph">
<p>If you start a job with the same parameters set after a failed run (BatchStatus.FAILED) a restart will occur.
In many cases your batch should then not reprocess all items it processed in the previous runs.
For that you need some logic to start at the desired offset. There different ways to implement such logic:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Marking processed items in the database in a dedicated column</p>
</li>
<li>
<p>Write all IDs of items to process in a separate table as an initialization step of your batch. You can then delete IDs of already processed items from that table during the batch execution.</p>
</li>
<li>
<p>Storing restart information in springs ExecutionContext (see below)</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="using-spring-batch-executioncontext-for-restarts"><a class="anchor" href="#using-spring-batch-executioncontext-for-restarts"></a>Using spring batch ExecutionContext for restarts</h6>
<div class="paragraph">
<p>By implementing the <code>ItemStream</code> interface in your <code>ItemReader</code> or <code>ItemWriter</code> you may store information about the batch progress in the <code>ExecutionContext</code>. You will find an example for that in the CountJob in My Thai Star.</p>
</div>
<div class="paragraph">
<p>Additional hint: It is important that bean definition method of your <code>ItemReader</code>/<code>ItemWriter</code> return types implementing <code>ItemStream</code>(and not just <code>ItemReader</code> or <code>ItemWriter</code> alone). For that the <code>ItemStreamReader</code> and <code>ItemStreamWriter</code> interfaces are provided.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="exit-codes"><a class="anchor" href="#exit-codes"></a>Exit codes</h5>
<div class="paragraph">
<p>Your batches should create a meaningful exit code to allow reaction to batch errors e.g. in a <a href="#scheduling">scheduler</a>.
For that spring batch automatically registers an <code>org.springframework.boot.autoconfigure.batch.JobExecutionExitCodeGenerator</code>. To make this mechanism work your spring boot app main class as to populate this exit code to the JVM:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@SpringBootApplication
public class SpringBootApp {

  public static void main(String[] args) {
    if (Arrays.stream(args).anyMatch((String e) -&gt; e.contains("--spring.batch.job.names"))) {
      // if executing batch job, explicitly exit jvm to report error code from batch
      System.exit(SpringApplication.exit(SpringApplication.run(SpringBootApp.class, args)));
    } else {
      // normal web application start
      SpringApplication.run(SpringBootApp.class, args);
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="stop-batches-and-manage-batch-status"><a class="anchor" href="#stop-batches-and-manage-batch-status"></a>Stop batches and manage batch status</h5>
<div class="paragraph">
<p>Spring batch uses several database tables to store the status of batch executions.
Each execution may have <a href="https://docs.spring.io/spring-batch/docs/current/reference/html/index-single.html#jobexecution">different status</a>.
You may use this mechanism to <a href="https://docs.spring.io/spring-batch/docs/current/reference/html/index-single.html#stoppingAJob">gracefully stop batches</a>.
Additionally in some edge cases (batch process crashed) the execution status may be in an undesired state.
E.g. the state will be running, despite the process crashed sometime ago.
For that cases you have to change the status of the execution in the database.</p>
</div>
<div class="sect5">
<h6 id="cli-tool"><a class="anchor" href="#cli-tool"></a>CLI-Tool</h6>
<div class="paragraph">
<p>Devonfw provides a easy to use cli-tool to manage the executing status of your jobs.
The tool is implemented in the devonfw module <code>devon4j-batch-tool</code>. It will provide a runnable jar, which may be used as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">List names of all previous executed jobs</dt>
<dd>
<p><code>java -D'spring.datasource.url=jdbc:h2:~/mts;AUTO_SERVER=TRUE' -jar devon4j-batch-tool.jar jobs list</code></p>
</dd>
<dt class="hdlist1">Stop job named 'countJob'</dt>
<dd>
<p><code>java -D'spring.datasource.url=jdbc:h2:~/mts;AUTO_SERVER=TRUE' -jar devon4j-batch-tool.jar jobs stop countJob</code></p>
</dd>
<dt class="hdlist1">Show help</dt>
<dd>
<p><code>java -D'spring.datasource.url=jdbc:h2:~/mts;AUTO_SERVER=TRUE' -jar devon4j-batch-tool.jar</code></p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>As you can the each invocation includes the JDBC connection string to your database.
This means that you have to make sure that the corresponding DB driver is in the classpath (the prepared jar only contains H2).</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="authentication"><a class="anchor" href="#authentication"></a>Authentication</h5>
<div class="paragraph">
<p>Most business application incorporate authentication and authorization.
Your spring boot application will implement some kind of security, e.g. integrated login with username+password or in many cases authentication via an existing IAM.
For security reasons your batch should also implement an authentication mechanism and obey the authorization implemented in your application (e.g. via @RolesAllowed).</p>
</div>
<div class="paragraph">
<p>Since there are many different authentication mechanism we cannot provide an out-of-the-box solution in devonfw, but we describe a pattern how this can be implemented in devonfw batches.</p>
</div>
<div class="paragraph">
<p>We suggest to implement the authentication in a Spring Batch tasklet, which runs as the first step in your batch. This tasklet will do all of the work which is required to authenticate the batch. A simple example which authenticates the batch "locally" via username and password could be implemented like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named
public class SimpleAuthenticationTasklet implements Tasklet {

  @Override
  public RepeatStatus execute(StepContribution contribution, ChunkContext chunkContext) throws Exception {

    String username = chunkContext.getStepContext().getStepExecution().getJobParameters().getString("username");
    String password = chunkContext.getStepContext().getStepExecution().getJobParameters().getString("password");
    Authentication authentication = new UsernamePasswordAuthenticationToken(username, password);

    SecurityContextHolder.getContext().setAuthentication(authentication);
    return RepeatStatus.FINISHED;
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The username and password have to be supplied via two cli parameters <code>-username</code> and <code>-password</code>. This implementation creates an "authenticated" <code>Authentication</code> and sets in the Spring Security context. This is just for demonstration normally you should not provide passwords via command line. The actual authentication will be done automatically via Spring Security as in your "normal" application.
If you have a more complex authentication mechanism in your application e.g. via OpenID connect just call this in the tasklet. Naturally you may read authentication parameters (e.g. secrets) from the command line or more securely from a configuration file.</p>
</div>
<div class="paragraph">
<p>In your Job Configuration set this tasklet as the first step:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
@EnableBatchProcessing
public class BookingsExportBatchConfig {
  @Inject
  private JobBuilderFactory jobBuilderFactory;

  @Inject
  private StepBuilderFactory stepBuilderFactory;

  @Bean
  public Job myBatchJob() {
    return this.jobBuilderFactory.get("myJob").start(myAuthenticationStep()).next(...).build();
  }

  @Bean
  public Step myAuthenticationStep() {
    return this.stepBuilderFactory.get("myAuthenticationStep").tasklet(myAuthenticatonTasklet()).build();
  }

  @Bean
  public Tasklet myAuthenticatonTasklet() {
    return new SimpleAuthenticationTasklet();
  }
...</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="tipps-tricks"><a class="anchor" href="#tipps-tricks"></a>Tipps &amp; tricks</h5>
<div class="sect5">
<h6 id="identifying-job-parameters"><a class="anchor" href="#identifying-job-parameters"></a>Identifying job parameters</h6>
<div class="paragraph">
<p>Spring uses a jobs parameters to identify <a href="https://docs.spring.io/spring-batch/docs/current/reference/html/domain.html#jobexecution">job executions</a>. Parameters starting with "-" are not considered for identifying a job execution.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="guides-2"><a class="anchor" href="#guides-2"></a>1.77. Guides</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Configuration</p>
</div>
<div class="sect4">
<h5 id="internal-application-configuration-2"><a class="anchor" href="#internal-application-configuration-2"></a>Internal Application Configuration</h5>
<div class="paragraph">
<p>There usually is a main configuration registered with main Spring Boot App, but differing configurations to support automated test of the application can be defined using profiles (not detailed in this guide).</p>
</div>
<div class="sect5">
<h6 id="spring-boot-application"><a class="anchor" href="#spring-boot-application"></a>Spring Boot Application</h6>
<div class="paragraph">
<p>For a complete documentation, see the <a href="http://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/">Spring Boot Reference Guide</a>.</p>
</div>
<div class="paragraph">
<p>With spring-boot you provide a simple <em>main class</em> (also called starter class) like this:
com.devonfw.mtsj.application</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@SpringBootApplication(exclude = { EndpointAutoConfiguration.class })
@EntityScan(basePackages = { "com.devonfw.mtsj.application" }, basePackageClasses = { AdvancedRevisionEntity.class })
@EnableGlobalMethodSecurity(jsr250Enabled = true)
@ComponentScan(basePackages = { "com.devonfw.mtsj.application.general", "com.devonfw.mtsj.application" })
public class SpringBootApp {

  /**
   * Entry point for spring-boot based app
   *
   * @param args - arguments
   */
  public static void main(String[] args) {

    SpringApplication.run(SpringBootApp.class, args);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In an devonfw application this main class is always located in the <code>&lt;basepackage&gt;</code> of the application package namespace (see <a href="coding-conventions#packages">package-conventions</a>). This is because a spring boot application will automatically do a classpath scan for components (spring-beans) and entities in the package where the application main class is located including all sub-packages. You can use the <code>@ComponentScan</code> and <code>@EntityScan</code> annotations to customize this behaviour.</p>
</div>
<div class="paragraph">
<p>If you want to map spring configuration properties into your custom code please see <a href="guide-configuration-mapping">configuration mapping</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="standard-beans-configuration"><a class="anchor" href="#standard-beans-configuration"></a>Standard beans configuration</h6>
<div class="paragraph">
<p>For basic bean configuration we rely on spring boot using mainly configuration classes and only occasionally XML configuration files. Some key principle to understand Spring Boot auto-configuration features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Spring Boot auto-configuration attempts to automatically configure your Spring application based on the jar dependencies and annotated components found in your source code.</p>
</li>
<li>
<p>Auto-configuration is non-invasive, at any point you can start to define your own configuration to replace specific parts of the auto-configuration by redefining your identically named bean (see also <code>exclude</code> attribute of <code>@SpringBootApplication</code> in example code above).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Beans are configured via annotations in your java code (see <a href="guide-dependency-injection">dependency-injection</a>).</p>
</div>
<div class="paragraph">
<p>For technical configuration you will typically write additional spring config classes annotated with <code>@Configuration</code> that provide bean implementations via methods annotated with <code>@Bean</code>. See <a href="http://docs.spring.io/spring-javaconfig/docs/1.0.0.M4/reference/html/ch02s02.html">spring @Bean documentation</a> for further details. Like in XML you can also use <code>@Import</code> to make a <code>@Configuration</code> class include other configurations.</p>
</div>
<div class="paragraph">
<p>More specific configuration files (as required) reside in an adequately named subfolder of:</p>
</div>
<div class="paragraph">
<p><code>src/main/resources/app</code></p>
</div>
</div>
<div class="sect5">
<h6 id="beanmapper-configuration"><a class="anchor" href="#beanmapper-configuration"></a>BeanMapper Configuration</h6>
<div class="paragraph">
<p>In case you are still using dozer, you will find further details in <a href="guide-beanmapping-spring#bean-mapper-configuration">bean-mapper configuration</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="security-configuration"><a class="anchor" href="#security-configuration"></a>Security configuration</h6>
<div class="paragraph">
<p>The abstract base class <code>BaseWebSecurityConfig</code> should be extended to configure web application security thoroughly.
A basic and secure configuration is provided which can be overridden or extended by subclasses.
Subclasses must use the <code>@Profile</code> annotation to further discriminate between beans used in production and testing scenarios. See the following example:</p>
</div>
<div class="listingblock">
<div class="title">Listing 19. How to extend <code>BaseWebSecurityConfig</code> for Production and Test</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
@EnableWebSecurity
@Profile(SpringProfileConstants.JUNIT)
public class TestWebSecurityConfig extends BaseWebSecurityConfig {...}

@Configuration
@EnableWebSecurity
@Profile(SpringProfileConstants.NOT_JUNIT)
public class WebSecurityConfig extends BaseWebSecurityConfig {...}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/general/service/impl/config/WebSecurityConfig.java">WebSecurityConfig</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="websocket-configuration"><a class="anchor" href="#websocket-configuration"></a>WebSocket configuration</h6>
<div class="paragraph">
<p>A websocket endpoint is configured within the business package as a Spring configuration class. The annotation <code>@EnableWebSocketMessageBroker</code> makes Spring Boot registering this endpoint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package your.path.to.the.websocket.config;
...
@Configuration
@EnableWebSocketMessageBroker
public class WebSocketConfig extends AbstractWebSocketMessageBrokerConfigurer {
...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="external-application-configuration"><a class="anchor" href="#external-application-configuration"></a>External Application Configuration</h5>
<div class="sect5">
<h6 id="application-properties-files"><a class="anchor" href="#application-properties-files"></a>application.properties files</h6>
<div class="paragraph">
<p><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html">Here</a> is a list of common properties provided by the Spring framework.</p>
</div>
<div class="paragraph">
<p>For a general understanding how spring-boot is loading and boostrapping your <code>application.properties</code> see <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html">spring-boot external configuration</a>.</p>
</div>
<div class="paragraph">
<p>The following properties files are used in devonfw application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>src/main/resources/application.properties</code> providing a default configuration - bundled and deployed with the application package. It further acts as a template to derive a tailored minimal environment-specific configuration.</p>
</li>
<li>
<p><code>src/main/resources/config/application.properties</code> providing additional properties only used at development time (for all local deployment scenarios). This property file is excluded from all packaging.</p>
</li>
<li>
<p><code>src/test/resources/config/application.properties</code> providing additional properties only used for testing (JUnits based on <a href="guide-testing">spring test</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For other environments where the software gets deployed such as <code>test</code>, <code>acceptance</code> and <code>production</code> you need to provide a tailored copy of <code>application.properties</code>. The location depends on the deployment strategy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>standalone run-able Spring Boot App using embedded tomcat: <code>config/application.properties</code> under the installation directory of the spring boot application.</p>
</li>
<li>
<p>dedicated tomcat (one tomcat per app): <code>$CATALINA_BASE/lib/config/application.properties</code></p>
</li>
<li>
<p>tomcat serving a number of apps (requires expanding the wars): <code>$CATALINA_BASE/webapps/&lt;app&gt;/WEB-INF/classes/config</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this <code>application.properties</code> you only define the minimum properties that are environment specific and inherit everything else from the bundled <code>src/main/resources/application.properties</code>. In any case, make very sure that the classloader will find the file.</p>
</div>
</div>
<div class="sect5">
<h6 id="database-configuration-2"><a class="anchor" href="#database-configuration-2"></a>Database Configuration</h6>
<div class="paragraph">
<p>The configuration for spring and Hibernate is already provided by devonfw in our sample application and the application template. So you only need to worry about a few things to customize.</p>
</div>
<div class="sect6">
<h7 id="database-system-and-access"><a class="anchor" href="#database-system-and-access"></a>Database System and Access</h7>
<div class="paragraph">
<p>Obviously you need to configure which type of database you want to use as well as the location and credentials to access it. The defaults are configured in <code>application.properties</code> that is bundled and deployed with the release of the software. The files should therefore contain the properties as in the given example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">  database.url=jdbc:postgresql://database.enterprise.com/app
  database.user.login=appuser01
  database.user.password=************
  database.hibernate.dialect = org.hibernate.dialect.PostgreSQLDialect
  database.hibernate.hbm2ddl.auto=validate</code></pre>
</div>
</div>
<div class="paragraph">
<p>For further details about <code>database.hibernate.hbm2ddl.auto</code> please see <a href="http://docs.jboss.org/hibernate/orm/5.0/manual/en-US/html/ch03.html#configuration-misc-properties">here</a>. For production and acceptance environments we use the value <code>validate</code> that should be set as default. In case you want to use Oracle RDBMS you can find additional hints <a href="guide-oracle#driver">here</a>.</p>
</div>
<div class="paragraph">
<p>If your application supports multiples database types, set <code>spring.profiles.active=XXX</code> in <code>src/main/resources/config/application.properties</code> choose database of your choice. Also, one has to set all the active spring profiles in this <code>application.properties</code> and not in any of the other <code>application.properties</code>.</p>
</div>
</div>
<div class="sect6">
<h7 id="database-logging"><a class="anchor" href="#database-logging"></a>Database Logging</h7>
<div class="paragraph">
<p>Add the following properties to <code>application.properties</code> to enable logging of database queries for debugging purposes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">spring.jpa.properties.hibernate.show_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true
spring.jpa.properties.hibernate.format_sql=true</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="security-8"><a class="anchor" href="#security-8"></a>Security</h5>
<div class="sect5">
<h6 id="password-encryption-2"><a class="anchor" href="#password-encryption-2"></a>Password Encryption</h6>
<div class="paragraph">
<p>In order to support encrypted passwords in spring-boot <code>application.properties</code> all you need to do is to add <a href="https://github.com/ulisesbocchio/jasypt-spring-boot#jasypt-spring-boot">jasypt-spring-boot</a> as dependency in your <code>pom.xml</code> (please check for recent version <a href="https://mvnrepository.com/artifact/com.github.ulisesbocchio/jasypt-spring-boot-starter">here</a>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.github.ulisesbocchio&lt;/groupId&gt;
  &lt;artifactId&gt;jasypt-spring-boot-starter&lt;/artifactId&gt;
  &lt;version&gt;3.0.3&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will smoothly integrate <a href="http://jasypt.org/">jasypt</a> into your <a href="https://projects.spring.io/spring-boot/">spring-boot</a> application. Read this <a href="https://apereo.atlassian.net/wiki/spaces/CASUM/pages/103261428/HOWTO+Use+Jasypt+to+encrypt+passwords+in+configuration+files">HOWTO</a> to learn how to encrypt and decrypt passwords using jasypt.</p>
</div>
<div class="paragraph">
<p>Next, we give a simple example how to encypt and configure a secret value.
We use the algorithm <code>PBEWITHHMACSHA512ANDAES_256</code> that provides strong encryption and is the default of <code>jasypt-spring-boot-starter</code>.
However, different algorithms can be used if perferred (e.g. <code>PBEWITHMD5ANDTRIPLEDES</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -cp ${M2_REPO}/org/jasypt/jasypt/1.9.3/jasypt-1.9.3.jar org.jasypt.intf.cli.JasyptPBEStringEncryptionCLI password=masterpassword algorithm=PBEWITHHMACSHA512ANDAES_256 input=secret ivGeneratorClassName=org.jasypt.iv.RandomIvGenerator

----ENVIRONMENT-----------------

Runtime: AdoptOpenJDK OpenJDK 64-Bit Server VM 11.0.5+10



----ARGUMENTS-------------------

input: secret
password: masterpassword
ivGeneratorClassName: org.jasypt.iv.RandomIvGenerator
algorithm: PBEWITHHMACSHA512ANDAES_256



----OUTPUT----------------------

PoUxkNjY2juQMCyPu6ic5KJy1XfK+bX9vu2/mPj3pmcO4iydG6mhgZRZSw50z/oC</pre>
</div>
</div>
<div class="paragraph">
<p>Of course the master-password (<code>masterpassword</code>) and the actual password to encrypt (<code>secret</code>) are just examples.
Please replace them with reasonable strong passwords for your environment.
Further, if you are using <a href="https://github.com/devonfw/ide">devonfw-ide</a> you can make your life much easier and just type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>devon jasypt encrypt</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/devonfw/ide/blob/master/documentation/jasypt">jasypt commandlet</a> for details.</p>
</div>
<div class="paragraph">
<p>Now the entire line after the <code>OUTPUT</code> block is your encrypted secret.
It even contains some random salt so that multiple encryption invocations with the same parameters (<code>ARGUMENTS</code>) will produce a different <code>OUTPUT</code>.</p>
</div>
<div class="paragraph">
<p>The master-password can be configured on your target environment via the property <code>jasypt.encryptor.password</code>. As system properties given on the command-line are visible in the process list, we recommend to use an <code>config/application.yml</code> file only for this purpose (as we recommended to use <code>application.properties</code> for regular configs):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>jasypt:
    encryptor:
        password: masterpassword</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again <code>masterpassword</code> is just an example that your replace with your actual master password.
Now you are able to put encrypted passwords into your <code>application.properties</code> and specify the algorithm.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>spring.datasource.password=ENC(PoUxkNjY2juQMCyPu6ic5KJy1XfK+bX9vu2/mPj3pmcO4iydG6mhgZRZSw50z/oC)
jasypt.encryptor.algorithm=PBEWITHHMACSHA512ANDAES_256</code></pre>
</div>
</div>
<div class="paragraph">
<p>This <code>application.properties</code> file can be version controlled (git-opts) and without knowing the masterpassword nobody is able to decrypt this to get the actual secret back.</p>
</div>
<div class="paragraph">
<p>To prevent jasypt to throw an exception in dev or test scenarios you can simply put this in your local config (<code>src/main/config/application.properties</code> and same for <code>test</code>, see above for details):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>jasypt.encryptor.password=none</code></pre>
</div>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Mapping configuration to your code</p>
</div>
<div class="paragraph">
<p>If you are using <code>spring-boot</code> as suggested by <code>devon4j</code> your application can be configured by <code>application.properties</code> file as described in <a href="guide-configuration">configuration</a>.
To get a single configuration option into your code for flexibility, you can use</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Value("${my.property.name}")
private String myConfigurableField;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, in your <code>application.properties</code> you can add the property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>my.property.name=my-property-value</code></pre>
</div>
</div>
<div class="paragraph">
<p>You may even use <code>@Value("${my.property.name:my-default-value}")</code> to make the property optional.</p>
</div>
</div>
<div class="sect5">
<h6 id="naming-conventions-for-configuration-properties"><a class="anchor" href="#naming-conventions-for-configuration-properties"></a>Naming conventions for configuration properties</h6>
<div class="paragraph">
<p>As a best practice your configruation properties should follow these naming conventions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>build the property-name as a path of segments separated by the dot character (<code>.</code>)</p>
</li>
<li>
<p>segments should get more specific from left to right</p>
</li>
<li>
<p>a property-name should either be a leaf value or a tree node (prefix of other property-names) but never both! So never have something like <code>foo.bar=value</code> and <code>foo.bar.child=value2</code>.</p>
</li>
<li>
<p>start with a segment namespace unique to your context or application</p>
</li>
<li>
<p>a good example would be <code>«myapp».billing.service.email.sender</code> for the sender address of billing service emails send by <code>«myapp»</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="mapping-advanced-configuration"><a class="anchor" href="#mapping-advanced-configuration"></a>Mapping advanced configuration</h6>
<div class="paragraph">
<p>However, in many scenarios you will have features that require more than just one property.
Injecting those via <code>@Value</code> is not leading to good code quality.
Instead we create a class with the suffix <code>ConfigProperties</code> containing all configuration properties for our aspect that is annotated with <code>@ConfigurationProperties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ConfigurationProperties(prefix = "myapp.billing.service")
public class BillingServiceConfigProperties {

  private final Email email = new Email();
  private final Smtp smtp = new Smtp();

  public Email getEmail() { return this.email; }
  public Email getSmtp() { return this.smtp; }

  public static class Email {

    private String sender;
    private String subject;

    public String getSender() { return this.sender; }
    public void setSender(String sender) { this.sender = sender; }
    public String getSubject() { return this.subject; }
    public void setSubject(String subject) { this.subject = subject; }
  }

  public static class Smtp {

    private String host;
    private int port = 25;

    public String getHost() { return this.host; }
    public void setHost(String host) { this.host = host; }
    public int getPort() { return this.port; }
    public void setPort(int port) { this.port = port; }
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course this is just an example to demonstrate this feature of <code>spring-boot</code>.
In order to send emails you would typically use the existing <a href="https://www.baeldung.com/spring-email">spring-email</a> feature.
But as you can see this allows us to define and access our configuration in a very structured and comfortable way.
The annotation <code>@ConfigurationProperties(prefix = "myapp.billing.service")</code> will automatically map spring configuration properties starting with <code>myapp.billing.service</code> via the according getters and setters into our <code>BillingServiceConfigProperties</code>.
We can easily define defaults (e.g. <code>25</code> as default value for <code>myapp.billing.service.smtp.port</code>).
Also <code>Email</code> or <code>Smtp</code> could be top-level classes to be reused in multiple configurations.
Of course you would also add helpful <code>JavaDoc</code> comments to the <code>getters</code> and classes to document your configuration options.
Further to access this configuration, we can use standard <a href="guide-dependency-injection">dependency-injection</a>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Inject
private BillingServiceConfigProperties config;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For very generic cases you may also use <code>Map&lt;String, String&gt;</code> to map any kind of property in an untyped way.
An example for generic configuration from <code>devon4j</code> can be found in
<a href="https://github.com/devonfw/devon4j/blob/9b8f9461997bb5d8048a9fec42bec3625652eec3/modules/service/src/main/java/com/devonfw/module/service/common/base/config/ServiceConfigProperties.java">ServiceConfigProperties</a>.</p>
</div>
<div class="paragraph">
<p>For further details about this feature also consult <a href="https://www.baeldung.com/configuration-properties-in-spring-boot">Guide to @ConfigurationProperties in Spring Boot</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="generate-configuration-metadata"><a class="anchor" href="#generate-configuration-metadata"></a>Generate configuration metadata</h6>
<div class="paragraph">
<p>You should further add this <code>dependency</code> to your module containing the <code>*ConfigProperties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;dependency&gt;
      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
      &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;
      &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will generate configuration metadata so projects using your code can benefit from autocompletion and getting your JavaDoc as tooltip when editing <code>application.properites</code> what makes this approach very powerful.
For further details about this please read <a href="https://www.baeldung.com/spring-boot-configuration-metadata">A Guide to Spring Boot Configuration Metadata</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Auditing</p>
</div>
<div class="paragraph">
<p>For database auditing we use <a href="http://envers.jboss.org/">hibernate envers</a>. If you want to use auditing ensure you have the following dependency in your pom.xml:</p>
</div>
<div class="listingblock">
<div class="title">Listing 20. <strong>spring</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.devonfw.java.modules&lt;/groupId&gt;
  &lt;artifactId&gt;devon4j-jpa-envers&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 21. <strong>quarkus</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-hibernate-envers&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The following part applies only to spring applications. At this point, the Quarkus extension does not provide any additional configurations. For Quarkus applications, simply use the <code>@Audited</code> annotation to enable auditing for an entity class, as described a few lines below or seen <a href="https://hibernate.org/orm/envers/">here</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Make sure that entity manager also scans the package from the devon4j-jpa[-envers] module in order to work properly. And make sure that correct Repository Factory Bean Class is chosen.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@EntityScan(basePackages = { "«my.base.package»" }, basePackageClasses = { AdvancedRevisionEntity.class })
...
@EnableJpaRepositories(repositoryFactoryBeanClass = GenericRevisionedRepositoryFactoryBean.class)
...
public class SpringBootApp {
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now let your [Entity]Repository extend from DefaultRevisionedRepository instead of DefaultRepository.</p>
</div>
<div class="paragraph">
<p>The repository now has a method getRevisionHistoryMetadata(id) and getRevisionHistoryMetadata(id, boolean lazy) available to get a list of revisions for a given entity and a method find(id, revision) to load a specific revision of an entity with the given ID or getLastRevisionHistoryMetadata(id) to load last revision.
To enable auditing for a entity simply place the @Audited annotation to your entity and all entity classes it extends from.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Entity(name = "Drink")
@Audited
public class DrinkEntity extends ProductEntity implements Drink {
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>When auditing is enabled for an entity an additional database table is used to store all changes to the entity table and a corresponding revision number. This table is called &lt;ENTITY_NAME&gt;_AUD per default. Another table called REVINFO is used to store all revisions. Make sure that these tables are available. They can be generated by hibernate with the following property (only for development environments).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">  database.hibernate.hbm2ddl.auto=create</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another possibility is to put them in your <a href="guide-database-migration">database migration</a> scripts like so.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE CACHED TABLE PUBLIC.REVINFO(
  id BIGINT NOT NULL generated by default as identity (start with 1),
  timestamp BIGINT NOT NULL,
  user VARCHAR(255)
);
...
CREATE CACHED TABLE PUBLIC.&lt;TABLE_NAME&gt;_AUD(
    &lt;ALL_TABLE_ATTRIBUTES&gt;,
    revtype TINYINT,
    rev BIGINT NOT NULL
);</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Access-Control
Access-Control is a central and important aspect of <a href="guide-security">Security</a>. It consists of two major aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#authentication">Authentication</a> (Who tries to access?)</p>
</li>
<li>
<p><a href="#authorization">Authorization</a> (Is the one accessing allowed to do what he wants to do?)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="authentication-2"><a class="anchor" href="#authentication-2"></a>Authentication</h5>
<div class="paragraph">
<p>Definition:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Authentication is the verification that somebody interacting with the system is the actual subject for whom he claims to be.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The one authenticated is properly called <em>subject</em> or <a href="http://docs.oracle.com/javase/7/docs/api/java/security/Principal.html"><em>principal</em></a>. There are two forms of principals you need to distinguish while designing your authentication: <code>human users</code> and <code>autonomous systems</code>. While e.g. a Kerberos/SPNEGO Single-Sign-On makes sense for human users, it is pointless for authenticating autonomous systems.  For simplicity, we use the common term <em>user</em> to refer to any principal even though it may not be a human (e.g. in case of a service call from an external system).</p>
</div>
<div class="paragraph">
<p>To prove the authenticity, the user provides some secret called <em>credentials</em>. The most simple form of credentials is a password.</p>
</div>
<div class="sect5">
<h6 id="implementations"><a class="anchor" href="#implementations"></a>Implementations</h6>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please never implement your own authentication mechanism or credential store. You have to be aware of implicit demands such as salting and hashing credentials, password life-cycle with recovery, expiry, and renewal including email notification confirmation tokens, central password policies, etc. This is the domain of access managers and identity management systems. In a business context you will typically already find a system for this purpose that you have to integrate (e.g. via LDAP). Otherwise you should consider establishing such a system e.g. using <a href="http://keycloak.org">keycloak</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We recommend using <a href="guide-jwt">JWT</a> when possible. For KISS, also try to avoid combining multiple authentication mechanisms (form based, basic-auth, SAMLv2, OAuth, etc.) within the same application (for different URLs).</p>
</div>
<div class="paragraph">
<p>For <a href="spring">spring</a>, check the <a href="spring/guide-authentication-spring">Spring Security</a></p>
</div>
<div class="paragraph">
<p>For <a href="quarkus">quarkus</a>, check the <a href="quarkus/guide-authentication-quarkus">Quarkus Authentication</a></p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="authorization"><a class="anchor" href="#authorization"></a>Authorization</h5>
<div class="paragraph">
<p><strong>Definition:</strong></p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Authorization is the verification that an authenticated user is allowed to perform the operation he intends to invoke.</p>
</div>
</blockquote>
</div>
<div class="sect5">
<h6 id="clarification-of-terms"><a class="anchor" href="#clarification-of-terms"></a>Clarification of terms</h6>
<div class="paragraph">
<p>For clarification we also want to give a common understanding of related terms that have no unique definition and consistent usage in the wild.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. Security terms related to authorization</caption>
<colgroup>
<col style="width: 15%;">
<col style="width: 85%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Term</strong></th>
<th class="tableblock halign-left valign-top"><strong>Meaning and comment</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Permission</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A permission is an object that allows a principal to perform an operation in the system. This permission can be <em>granted</em> (give) or <em>revoked</em> (taken away). Sometimes people also use the term <em>right</em> what is actually wrong as a right (such as the right to be free) can not be revoked.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Group</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We use the term group in this context for an object that contains permissions. A group may also contain other groups. Then the group represents the set of all recursively contained permissions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Role</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">We consider a role as a specific form of group that also contains permissions. A role identifies a specific function of a principal. A user can act in a role.</p>
<p class="tableblock">For simple scenarios a principal has a single role associated. In more complex situations a principal can have multiple roles but has only one active role at a time that he can choose out of his assigned roles. For KISS it is sometimes sufficient to avoid this by creating multiple accounts for the few users with multiple roles. Otherwise at least avoid switching roles at run-time in clients as this may cause problems with related states. Simply restart the client with the new role as parameter in case the user wants to switch his role.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access Control</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any permission, group, role, etc., which declares a control for access management.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="suggestions-on-the-access-model"><a class="anchor" href="#suggestions-on-the-access-model"></a>Suggestions on the access model</h6>
<div class="paragraph">
<p>For the access model we give the following suggestions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each Access Control (permission, group, role, &#8230;&#8203;) is uniquely identified by a human readable string.</p>
</li>
<li>
<p>We create a unique permission for each use-case.</p>
</li>
<li>
<p>We define groups that combine permissions to typical and useful sets for the users.</p>
</li>
<li>
<p>We define roles as specific groups as required by our business demands.</p>
</li>
<li>
<p>We allow to associate users with a list of Access Controls.</p>
</li>
<li>
<p>For authorization of an implemented use case we determine the required permission. Furthermore, we determine the current user and verify that the required permission is contained in the tree spanned by all his associated Access Controls. If the user does not have the permission we throw a security exception and thus abort the operation and transaction.</p>
</li>
<li>
<p>We avoid negative permissions, that is a user has no permission by default and only those granted to him explicitly give him additional permission for specific things. Permissions granted can not be reduced by other permissions.</p>
</li>
<li>
<p>Technically we consider permissions as a secret of the application. Administrators shall not fiddle with individual permissions but grant them via groups. So the access management provides a list of strings identifying the Access Controls of a user. The individual application itself contains these Access Controls in a structured way, whereas each group forms a permission tree.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="naming-conventions-3"><a class="anchor" href="#naming-conventions-3"></a>Naming conventions</h6>
<div class="paragraph">
<p>As stated above each Access Control is uniquely identified by a human readable string. This string should follow the naming convention:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>«app-id».«local-name»</code></pre>
</div>
</div>
<div class="paragraph">
<p>For Access Control Permissions the <code>«local-name»</code> again follows the convention:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>«verb»«object»</code></pre>
</div>
</div>
<div class="paragraph">
<p>The segments are defined by the following table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. Segments of Access Control Permission ID</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Segment</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Example</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«app-id»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is a unique technical but human readable string of the application (or microservice). It shall not contain special characters and especially no dot or whitespace. We recommend to use <code>lower-train-case-ascii-syntax</code>. The identity and access management should be organized on enterprise level rather than application level. Therefore permissions of different apps might easily clash (e.g. two apps might both define a group <code>ReadMasterData</code> but some user shall get this group for only one of these two apps). Using the <code>«app-id».</code> prefix is a simple but powerful namespacing concept that allows you to scale and grow. You may also reserve specific «app-id»s for cross-cutting concerns that do not actually reflect a single app e.g to grant access to a geographic region.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>shop</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«verb»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The action that is to be performed on «object». We use <code>Find</code> for searching and reading data. <code>Save</code> shall be used both for create and update. Only if you really have demands to separate these two you may use <code>Create</code> in addition to <code>Save</code>. Finally, <code>Delete</code> is used for deletions. For non CRUD actions you are free to use additional verbs such as <code>Approve</code> or <code>Reject</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Find</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">«object»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The affected object or entity. Shall be named according to your data-model</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Product</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>So as an example <code>shop.FindProduct</code> will reflect the permission to search and retrieve a <code>Product</code> in the <code>shop</code> application. The group <code>shop.ReadMasterData</code> may combine all permissions to read master-data from the <code>shop</code>. However, also a group <code>shop.Admin</code> may exist for the <code>Admin</code> role of the <code>shop</code> application. Here the <code>«local-name»</code> is <code>Admin</code> that does not follow the <code>«verb»«object»</code> schema.</p>
</div>
</div>
<div class="sect5">
<h6 id="devon4j-security"><a class="anchor" href="#devon4j-security"></a>devon4j-security</h6>
<div class="paragraph">
<p>The module <code>devon4j-security</code> provides ready-to-use code based on <a href="http://projects.spring.io/spring-security/">spring-security</a> that makes your life a lot easier.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/Security-AccessControl.png"><img src="_images/images/Security-AccessControl.png" alt="access-control"></a>
</div>
<div class="title">Figure 7. devon4j Security Model</div>
</div>
<div class="paragraph">
<p>The diagram shows the model of <code>devon4j-security</code> that separates two different aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <em>Identity- and Access-Management</em> is provided by according products and typically already available in the enterprise landscape (e.g. an active directory). It provides a hierarchy of <em>primary access control objects</em> (roles and groups) of a user. An administrator can grant and revoke permissions (indirectly) via this way.</p>
</li>
<li>
<p>The application security defines a hierarchy of <em>secondary access control objects</em> (groups and permissions). This is done by configuration owned by the application (see following section). The "API" is defined by the IDs of the primary access control objects that will be referenced from the <em>Identity- and Access-Management</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="access-control-config"><a class="anchor" href="#access-control-config"></a>Access Control Config</h6>
<div class="paragraph">
<p>In your application simply extend <code>AccessControlConfig</code> to configure your access control objects as code and reference it from your use-cases. An example config may look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named
public class ApplicationAccessControlConfig extends AccessControlConfig {

  public static final String APP_ID = "MyApp";

  private static final String PREFIX = APP_ID + ".";

  public static final String PERMISSION_FIND_OFFER = PREFIX + "FindOffer";

  public static final String PERMISSION_SAVE_OFFER = PREFIX + "SaveOffer";

  public static final String PERMISSION_DELETE_OFFER = PREFIX + "DeleteOffer";

  public static final String PERMISSION_FIND_PRODUCT = PREFIX + "FindProduct";

  public static final String PERMISSION_SAVE_PRODUCT = PREFIX + "SaveProduct";

  public static final String PERMISSION_DELETE_PRODUCT = PREFIX + "DeleteProduct";

  public static final String GROUP_READ_MASTER_DATA = PREFIX + "ReadMasterData";

  public static final String GROUP_MANAGER = PREFIX + "Manager";

  public static final String GROUP_ADMIN = PREFIX + "Admin";

  public ApplicationAccessControlConfig() {

    super();
    AccessControlGroup readMasterData = group(GROUP_READ_MASTER_DATA, PERMISSION_FIND_OFFER, PERMISSION_FIND_PRODUCT);
    AccessControlGroup manager = group(GROUP_MANAGER, readMasterData, PERMISSION_SAVE_OFFER, PERMISSION_SAVE_PRODUCT);
    AccessControlGroup admin = group(GROUP_ADMIN, manager, PERMISSION_DELETE_OFFER, PERMISSION_DELETE_PRODUCT);
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="configuration-on-java-method-level"><a class="anchor" href="#configuration-on-java-method-level"></a>Configuration on Java Method level</h6>
<div class="paragraph">
<p>In your use-case you can now reference a permission like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named
public class UcSafeOfferImpl extends ApplicationUc implements UcSafeOffer {

  @Override
  @RolesAllowed(ApplicationAccessControlConfig.PERMISSION_SAVE_OFFER)
  public OfferEto save(OfferEto offer) { ... }
  ...
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="jee-standard"><a class="anchor" href="#jee-standard"></a>JEE Standard</h6>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/Role-based_access_control">Role-based Access Control (RBAC)</a> is commonly used for authorization.
JSR 250 defines a number of common annotations to secure your application.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>javax.annotation.security.PermitAll</code> specifies that no access control is required to invoke the specified method(s).</p>
</li>
<li>
<p><code>javax.annotation.security.DenyAll</code> specifies that no access controls are allowed to invoke the specified method(s).</p>
</li>
<li>
<p><code>javax.annotation.security.RolesAllowed</code> specifies that only a list of access controls are allowed to invoke the specified method(s).</p>
</li>
<li>
<p><code>javax.annotation.security.DeclareRoles</code> defines roles for security checking.</p>
</li>
<li>
<p><code>javax.annotation.security.RunAs</code> specifies the RunAs role for the given components.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>@PermitAll</code>, <code>@Denyall</code>, and <code>@RolesAllowed</code> annotations can be applied to both class and method.
A method-level annotation will override the behaviour of class-level annotation. Using multiple annotations of those 3 is not valid.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// invalid
@PermitAll
@DenyAll
public String foo()

// invalid and compilation fails
@RolesAllowed("admin")
@RolesAllowed("user")
public String bar()

// OK
@RolesAllowed("admin", "user")
public String bar()</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that when specifying multiple arguments to <code>@RolesAllowed</code> those are combined with OR (and not with AND).
So if the user has any of the specified access controls, he will be able to access the method.</p>
</div>
<div class="paragraph">
<p>As a best practice avoid specifying string literals to <code>@RolesAllowed</code>.
Instead define a class with all access controls as constants and reference them from there.
This class is typically called <code>ApplicationAccessControlConfig</code> in devonfw.</p>
</div>
<div class="paragraph">
<p>In many complicated cases where <code>@PermitAll</code> <code>@DenyAll</code> <code>@RolesAllowed</code> are insufficient e.g. a method should be accessed by a user in role A and not in role B at the same time, you have to verify the user role directly in the method. You can use <code>SecurityContext</code> class to get further needed information.</p>
</div>
<div class="sect6">
<h7 id="spring"><a class="anchor" href="#spring"></a>Spring</h7>
<div class="paragraph">
<p>Spring Security also supports authorization on method level. To use it, you need to add the <code>spring-security-config</code> dependency. If you use Spring Boot, the dependency <code>spring-boot-starter-security</code> already includes <code>spring-security-config</code>. Then you can configure as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>prePostEnabled</code> property enables Spring Security pre/post annotations. <code>@PreAuthorize</code> and <code>@PostAuthorize</code> annotations provide expression-based access control. See more <a href="https://docs.spring.io/spring-security/site/docs/4.2.x/reference/html/el-access.html">here</a></p>
</li>
<li>
<p><code>securedEnabled</code> property determines if the <code>@Secured</code> annotation should be enabled. <code>@Secured</code> can be used similarly as <code>@RollesAllowed</code>.</p>
</li>
<li>
<p><code>jsr250Enabled</code> property allows us to use the JSR-250 annotations such as <code>@RolesAllowed</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
@EnableGlobalMethodSecurity(
  prePostEnabled = true,
  securedEnabled = true,
  jsr250Enabled = true)
public class MethodSecurityConfig
  extends GlobalMethodSecurityConfiguration {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A further read about the whole concept of Spring Security Authorization can be found <a href="https://docs.spring.io/spring-security/site/docs/current/reference/html5/#servlet-authorization">here</a>.</p>
</div>
</div>
<div class="sect6">
<h7 id="quarkus"><a class="anchor" href="#quarkus"></a>Quarkus</h7>
<div class="paragraph">
<p>Quarkus comes with built-in security to allow for RBAC based on the common security annotations <code>@RolesAllowed</code>, <code>@DenyAll</code>, <code>@PermitAll</code> on REST endpoints and CDI beans. Quarkus also provides the <code>io.quarkus.security.Authenticated</code> annotation that will permit any authenticated user to access the resource (equivalent to @RolesAllowed("**")).</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="data-based-permissions"><a class="anchor" href="#data-based-permissions"></a>Data-based Permissions</h6>
<div class="paragraph">
<p>See <a href="guide-data-permission">data permissions</a></p>
</div>
</div>
<div class="sect5">
<h6 id="access-control-schema-deprecated"><a class="anchor" href="#access-control-schema-deprecated"></a>Access Control Schema (deprecated)</h6>
<div class="paragraph">
<p>The <code>access-control-schema.xml</code> approach is deprecated. The documentation can still be found in <a href="guide-access-control-schema">access control schema</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Data-permissions</p>
</div>
<div class="paragraph">
<p>In some projects there are demands for permissions and authorization that is dependent on the processed data. E.g. a user may only be allowed to read or write data for a specific region. This is adding some additional complexity to your authorization. If you can avoid this it is always best to keep things simple. However, in various cases this is a requirement. Therefore the following sections give you guidance and patterns how to solve this properly.</p>
</div>
</div>
<div class="sect5">
<h6 id="structuring-your-data"><a class="anchor" href="#structuring-your-data"></a>Structuring your data</h6>
<div class="paragraph">
<p>For all your business objects (entities) that have to be secured regarding to data permissions we recommend that you create a separate interface that provides access to the relevant data required to decide about the permission. Here is a simple example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface SecurityDataPermissionCountry {

  /**
   * @return the 2-letter ISO code of the country this object is associated with. Users need
   *         a data-permission for this country in order to read and write this object.
   */
  String getCountry();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now related business objects (entities) can implement this interface. Often such data-permissions have to be applied to an entire object-hierarchy. For security reasons we recommend that also all child-objects implement this interface. For performance reasons we recommend that the child-objects redundantly store the data-permission properties (such as <code>country</code> in the example above) and this gets simply propagated from the parent, when a child object is created.</p>
</div>
</div>
<div class="sect5">
<h6 id="permissions-for-processing-data"><a class="anchor" href="#permissions-for-processing-data"></a>Permissions for processing data</h6>
<div class="paragraph">
<p>When saving or processing objects with a data-permission, we recommend to provide dedicated methods to verify the permission in an abstract base-class such as <code>AbstractUc</code> and simply call this explicitly from your business code. This makes it easy to understand and debug the code. Here is a simple example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">protected void verifyPermission(SecurityDataPermissionCountry entity) throws AccessDeniedException;</code></pre>
</div>
</div>
<div class="sect6">
<h7 id="beware-of-aop"><a class="anchor" href="#beware-of-aop"></a>Beware of AOP</h7>
<div class="paragraph">
<p>For simple but cross-cutting data-permissions you may also use <a href="guide-aop">AOP</a>. This leads to programming aspects that reflectively scan method arguments and magically decide what to do. Be aware that this quickly gets tricky:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What if multiple of your method arguments have data-permissions (e.g. implement <code>SecurityDataPermission*</code>)?</p>
</li>
<li>
<p>What if the object to authorize is only provided as reference (e.g. <code>Long</code> or <code>IdRef</code>) and only loaded and processed inside the implementation where the AOP aspect does not apply?</p>
</li>
<li>
<p>How to express advanced data-permissions in annotations?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>What we have learned is that annotations like <code>@PreAuthorize</code> from <code>spring-security</code> easily lead to the "programming in string literals" anti-pattern. We strongly discourage to use this anti-pattern. In such case writing your own <code>verifyPermission</code> methods that you manually call in the right places of your business-logic is much better to understand, debug and maintain.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="permissions-for-reading-data"><a class="anchor" href="#permissions-for-reading-data"></a>Permissions for reading data</h6>
<div class="paragraph">
<p>When it comes to restrictions on the data to read it becomes even more tricky. In the context of a user only entities shall be loaded from the database he is permitted to read. This is simple for loading a single entity (e.g. by its ID) as you can load it and then if not permitted throw an exception to secure your code. But what if the user is performing a search query to find many entities? For performance reasons we should only find data the user is permitted to read and filter all the rest already via the database query. But what if this is not a requirement for a single query but needs to be applied cross-cutting to tons of queries? Therefore we have the following pattern that solves your problem:</p>
</div>
<div class="paragraph">
<p>For each data-permission attribute (or set of such) we create an abstract base entity:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@MappedSuperclass
@EntityListeners(PermissionCheckListener.class)
@FilterDef(name = "country", parameters = {@ParamDef(name = "countries", type = "string")})
@Filter(name = "country", condition = "country in (:countries)")
public abstract class SecurityDataPermissionCountryEntity extends ApplicationPersistenceEntity
    implements SecurityDataPermissionCountry {

  private String country;

  @Override
  public String getCountry() {
    return this.country;
  }

  public void setCountry(String country) {
    this.country = country;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are some special hibernate annotations <code>@EntityListeners</code>, <code>@FilterDef</code>, and <code>@Filter</code> used here allowing to apply a filter on the <code>country</code> for any (non-native) query performed by hibernate. The entity listener may look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class PermissionCheckListener {

  @PostLoad
  public void read(SecurityDataPermissionCountryEntity entity) {
    PermissionChecker.getInstance().requireReadPermission(entity);
  }

  @PrePersist
  @PreUpdate
  public void write(SecurityDataPermissionCountryEntity entity) {
    PermissionChecker.getInstance().requireWritePermission(entity);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will ensure that hibernate implicitly will call these checks for every such entity when it is read from or written to the database. Further to avoid reading entities from the database the user is not permitted to (and ending up with exceptions), we create an AOP aspect that automatically activates the above declared hibernate filter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named
public class PermissionCheckerAdvice implements MethodBeforeAdvice {

  @Inject
  private PermissionChecker permissionChecker;

  @PersistenceContext
  private EntityManager entityManager;

  @Override
  public void before(Method method, Object[] args, Object target) {

    Collection&lt;String&gt; permittedCountries = this.permissionChecker.getPermittedCountriesForReading();
    if (permittedCountries != null) { // null is returned for admins that may access all countries
      if (permittedCountries.isEmpty()) {
        throw new AccessDeniedException("Not permitted for any country!");
      }
      Session session = this.entityManager.unwrap(Session.class);
      session.enableFilter("country").setParameterList("countries", permittedCountries.toArray());
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally to apply this aspect to all Repositories (can easily be changed to DAOs) implement the following advisor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named
public class PermissionCheckerAdvisor implements PointcutAdvisor, Pointcut, ClassFilter, MethodMatcher {

  @Inject
  private PermissionCheckerAdvice advice;

  @Override
  public Advice getAdvice() {
    return this.advice;
  }

  @Override
  public boolean isPerInstance() {
    return false;
  }

  @Override
  public Pointcut getPointcut() {
    return this;
  }

  @Override
  public ClassFilter getClassFilter() {
    return this;
  }

  @Override
  public MethodMatcher getMethodMatcher() {
    return this;
  }

  @Override
  public boolean matches(Method method, Class&lt;?&gt; targetClass) {
    return true; // apply to all methods
  }

  @Override
  public boolean isRuntime() {
    return false;
  }

  @Override
  public boolean matches(Method method, Class&lt;?&gt; targetClass, Object... args) {
    throw new IllegalStateException("isRuntime()==false");
  }

  @Override
  public boolean matches(Class&lt;?&gt; clazz) {
    // when using DAOs simply change to some class like ApplicationDao
    return DefaultRepository.class.isAssignableFrom(clazz);
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="managing-and-granting-the-data-permissions"><a class="anchor" href="#managing-and-granting-the-data-permissions"></a>Managing and granting the data-permissions</h6>
<div class="paragraph">
<p>Following our <a href="guide-access-control#authorization">authorization guide</a> we can simply create a permission for each country. We might simply reserve a prefix (as virtual <code>«app-id»</code>) for each data-permission to allow granting data-permissions to end-users across all applications of the IT landscape. In our example we could create access controls <code>country.DE</code>, <code>country.US</code>, <code>country.ES</code>, etc. and assign those to the users. The method <code>permissionChecker.getPermittedCountriesForReading()</code> would then scan for these access controls and only return the 2-letter country code from it.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Before you make your decisions how to design your access controls please clarify the following questions:
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Do you need to separate data-permissions independent of the functional permissions? E.g. may it be required to express that a user can read data from the countries <code>ES</code> and <code>PL</code> but is only permitted to modify data from <code>PL</code>? In such case a single assignment of "country-permissions" to users is insufficient.</p>
</li>
<li>
<p>Do you want to grant data-permissions individually for each application (higher flexibility and complexity) or for the entire application landscape (simplicity, better maintenance for administrators)? In case of the first approach you would rather have access controls like <code>app1.country.GB</code> and <code>app2.country.GB</code>.</p>
</li>
<li>
<p>Do your data-permissions depend on objects that can be created dynamically inside your application?</p>
</li>
<li>
<p>If you want to grant data-permissions on other business objects (entities), how do you want to reference them (primary keys, business keys, etc.)? What reference is most stable? Which is most readable?</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==JWT</p>
</div>
<div class="paragraph">
<p><a href="https://jwt.io">JWT</a> (JSON Web Token) is an open standard (see <a href="https://tools.ietf.org/html/rfc7519">RFC 7519</a>) for creating <a href="guide-json">JSON</a> based access tokens that assert some number of claims.
With an IT landscape divided into multiple smaller apps you want to avoid coupling all those apps or services tightly with your IAM (Identity &amp; Access Management).
Instead your apps simply expects a JWT as <a href="https://oauth.net/2/bearer-tokens/">bearer-token</a> in the <code>Authorization</code> HTTP header field.
All it needs to do for authentication is validating this JWT.
The actual authentication is done centrally by an access system (IAM) that authors those JWTs.
Therefore we recommend to use strong asymmetric cryptography to sign the JWT when it is authored.
Create a keypair per environment and keep the private key as a secret only known to the access system authorizing the JWTs.
Your apps only need to know the public key in order to validate the JWT.
Any request without a JWT or with an invalid JWT will be rejected (with status code <code>401</code>).</p>
</div>
<div class="paragraph">
<p>When using <a href="spring">spring</a> check the <a href="spring/guide-jwt-spring">JWT Spring-Starter</a>.
For <a href="quarkus">quarkus</a> follow <a href="https://quarkus.io/guides/security-jwt">Using JWT RBAC</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Cross-site request forgery (CSRF)</p>
</div>
<div class="paragraph">
<p>CSRF is a type of malicious exploit of a web application that allows an attacker to induce users to perform actions that they do not intend to perform.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/jwt_flow.png"><img src="_images/images/csrf.png" alt="csrf" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>More details about csrf can be found at <a href="https://owasp.org/www-community/attacks/csrf" class="bare">https://owasp.org/www-community/attacks/csrf</a>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="secure-devon4j-server-against-csrf"><a class="anchor" href="#secure-devon4j-server-against-csrf"></a>Secure devon4j server against CSRF</h5>
<div class="paragraph">
<p>In case your devon4j server application is not accessed by browsers or the web-client is using <a href="guide-jwt">JWT based authentication</a>, you are already safe according to CSRF.
However, if your application is accessed from a browser and you are using <em>form based authentication</em> (with session coockie) or <em>basic authentication</em>, you need to enable CSRF protection.
This guide will tell you how to do this.</p>
</div>
<div class="sect5">
<h6 id="dependency-2"><a class="anchor" href="#dependency-2"></a>Dependency</h6>
<div class="paragraph">
<p>To secure your devon4j application against CSRF attacks, you only need to add the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.devonfw.java.starters&lt;/groupId&gt;
  &lt;artifactId&gt;devon4j-starter-security-csrf&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Starting with devon4j version <code>2020.12.001</code> application template, this is all you need to do.
However, if you have started from an older version or you want to understand more, please read on.</p>
</div>
</div>
<div class="sect5">
<h6 id="pluggable-web-security"><a class="anchor" href="#pluggable-web-security"></a>Pluggable web-security</h6>
<div class="paragraph">
<p>To enable pluggable security via devon4j security starters you need to apply <code>WebSecurityConfigurer</code> to your <code>BaseWebSecurityConfig</code> (your class extending spring-boot&#8217;s <code>WebSecurityConfigurerAdapter</code>) as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Inject
  private WebSecurityConfigurer webSecurityConfigurer;

  public void configure(HttpSecurity http) throws Exception {
    // disable CSRF protection by default, use csrf starter to override.
	  http = http.csrf().disable();
	  // apply pluggable web-security from devon4j security starters
    http = this.webSecurityConfigurer.configure(http);
    .....
  }</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="custom-csrfrequestmatcher"><a class="anchor" href="#custom-csrfrequestmatcher"></a>Custom CsrfRequestMatcher</h6>
<div class="paragraph">
<p>If you want to customize which HTTP requests will require a CSRF token, you can implement your own <code>CsrfRequestMatcher</code> and provide it to the devon4j CSRF protection via qualified injection as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named("CsrfRequestMatcher")
public class CsrfRequestMatcher implements RequestMatcher {
  @Override
  public boolean matches(HttpServletRequest request) {
    .....
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that the exact name (<code>@Named("CsrfRequestMatcher")</code>) is required here to ensure your custom implementation will be injected properly.</p>
</div>
</div>
<div class="sect5">
<h6 id="csrfrestservice"><a class="anchor" href="#csrfrestservice"></a>CsrfRestService</h6>
<div class="paragraph">
<p>With the <code>devon4j-starter-security-csrf</code> the <code>CsrfRestService</code> gets integrated into your app.
It provides an operation to get the CSRF token via an HTTP <code>GET</code> request.
The URL path to retrieve this CSRF token is <code>services/rest/csrf/v1/token</code>.
As a result you will get a JSON like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{
  "token":"3a8a5f66-c9eb-4494-81e1-7cc58bc3a519",
  "parameterName":"_csrf",
  "headerName":"X-CSRF-TOKEN"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>token</code> value is a strong random value that will differ for each user session.
It has to be send with subsequent HTTP requests (when method is other than <code>GET</code>) in the specified header (<code>X-CSRF-TOKEN</code>).</p>
</div>
</div>
<div class="sect5">
<h6 id="how-it-works"><a class="anchor" href="#how-it-works"></a>How it works</h6>
<div class="paragraph">
<p>Putting it all together, a browser client should call the <code>CsrfRestService</code> after successfull login to receive the current CSRF token.
With every subsequent HTTP request (other than <code>GET</code>) the client has to send this token in the according HTTP header.
Otherwise the server will reject the request to prevent CSRF attacks.
Therefore, an attacker might make your browser perform HTTP requests towards your devon4j application backend via <code>&lt;image&gt;</code> elements, <code>&lt;iframes&gt;</code>, etc.
Your browser will then still include your session coockie if you are already logged in (e.g. from another tab).
However, in case he wants to trigger <code>DELETE</code> or <code>POST</code> requests trying your browser to make changes in the application (delete or update data, etc.) this will fail without CSRF token.
The attacker may make your browser retrieve the CSRF token but he will not be able to retrieve the result and put it into the header of other requests due to the same-origin-policy.
This way your application will be secured against CSRF attacks.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="configure-devon4ng-client-for-csrf"><a class="anchor" href="#configure-devon4ng-client-for-csrf"></a>Configure devon4ng client for CSRF</h5>
<div class="paragraph">
<p>Devon4ng client configuration for CSRF is described <a href="https://github.com/devonfw/devon4ng/blob/develop/documentation/guide-consuming-rest-services">here</a></p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Aspect Oriented Programming (AOP)</p>
</div>
<div class="paragraph">
<p><a href="http://en.wikipedia.org/wiki/Aspect-oriented_programming">AOP</a> is a powerful feature for cross-cutting concerns. However, if used extensive and for the wrong things an application can get unmaintainable. Therefore we give you the best practices where and how to use AOP properly.</p>
</div>
</div>
<div class="sect4">
<h5 id="aop-key-principles"><a class="anchor" href="#aop-key-principles"></a>AOP Key Principles</h5>
<div class="paragraph">
<p>We follow these principles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We use <a href="http://docs.spring.io/spring/docs/2.5.4/reference/aop.html">spring AOP</a> based on dynamic proxies (and fallback to cglib).</p>
</li>
<li>
<p>We avoid AspectJ and other mighty and complex AOP frameworks whenever possible</p>
</li>
<li>
<p>We only use AOP where we consider it as necessary (see below).</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aop-usage"><a class="anchor" href="#aop-usage"></a>AOP Usage</h5>
<div class="paragraph">
<p>We recommend to use AOP with care but we consider it established for the following cross cutting concerns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-transactions">Transaction-Handling</a></p>
</li>
<li>
<p><a href="guide-security#method-authorization">Authorization</a></p>
</li>
<li>
<p><a href="guide-validation">Validation</a></p>
</li>
<li>
<p><a href="guide-logging#tracing">Trace-Logging</a> (for testing and debugging)</p>
</li>
<li>
<p>Exception facades for <a href="guide-service-layer">services</a> but only if no other solution is possible (use alternatives such as <a href="guide-service-layer#rest-exception-handling">JAX-RS provider</a> instead).</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aop-debugging"><a class="anchor" href="#aop-debugging"></a>AOP Debugging</h5>
<div class="paragraph">
<p>When using AOP with dynamic proxies the debugging of your code can get nasty. As you can see by the red boxes in the call stack in the debugger there is a lot of magic happening while you often just want to step directly into the implementation skipping all the AOP clutter. When using Eclipse this can easily be archived by enabling <em>step filters</em>. Therefore you have to enable the feature in the Eclipse tool bar (highlighted in read).</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/eclipse-debug-aop.png"><img src="_images/images/eclipse-debug-aop.png" alt="AOP debugging"></a>
</div>
</div>
<div class="paragraph">
<p>In order to properly make this work you need to ensure that the step filters are properly configured:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/eclipse-debug-step-filters.png"><img src="_images/images/eclipse-debug-step-filters.png" alt="Step Filter Configuration"></a>
</div>
</div>
<div class="paragraph">
<p>Ensure you have at least the following step-filters configured and active:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ch.qos.logback.*
com.devonfw.module.security.*
java.lang.reflect.*
java.security.*
javax.persistence.*
org.apache.commons.logging.*
org.apache.cxf.jaxrs.client.*
org.apache.tomcat.*
org.h2.*
org.springframework.*</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Exception Handling</p>
</div>
</div>
<div class="sect4">
<h5 id="exception-principles"><a class="anchor" href="#exception-principles"></a>Exception Principles</h5>
<div class="paragraph">
<p>For exceptions we follow these principles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We only use exceptions for <em>exceptional</em> situations and not for programming control flows, etc. Creating an exception in Java is expensive and hence should not be done for simply testing whether something is present, valid or permitted. In the latter case design your API to return this as a regular result.</p>
</li>
<li>
<p>We use unchecked exceptions (RuntimeException) <sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</li>
<li>
<p>We distinguish <em>internal exceptions</em> and <em>user exceptions</em>:</p>
<div class="ulist">
<ul>
<li>
<p>Internal exceptions have technical reasons. For unexpected and exotic situations, it is sufficient to throw existing exceptions such as IllegalStateException. For common scenarios a own exception class is reasonable.</p>
</li>
<li>
<p>User exceptions contain a message explaining the problem for end users. Therefore, we always define our own exception classes with a clear, brief, but detailed message.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Our own exceptions derive from an exception base class supporting</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/exception/api/NlsRuntimeException.html#getUuid%28%29">unique ID per instance</a></p>
</li>
<li>
<p><a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/exception/api/NlsRuntimeException.html#getCode%28%29">Error code per class</a></p>
</li>
<li>
<p><a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/exception/api/NlsThrowable.html#getNlsMessage%28%29">message templating</a> (see <a href="guide-i18n">I18N</a>)</p>
</li>
<li>
<p><a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/exception/api/NlsRuntimeException.html#isForUser%28%29">distinguish between <em>user exceptions</em> and <em>internal exceptions</em></a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>All this is offered by <a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/exception/api/package-summary.html#documentation">mmm-util-core</a>, which we propose as a solution.
If you use the <a href="https://github.com/devonfw/devon4j/tree/master/modules/rest">devon4j-rest module</a>, this is already included. For Quarkus applications, you need to add the dependency manually.</p>
</div>
<div class="paragraph">
<p>If you want to avoid additional dependencies, you can implement your own solution for this by creating an abstract exception class <code>ApplicationBusinessException</code> extending from <code>RuntimeException</code>. For an example of this, see our <a href="https://github.com/devonfw-sample/devon4quarkus-reference">Quarkus reference application</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="exception-example"><a class="anchor" href="#exception-example"></a>Exception Example</h5>
<div class="paragraph">
<p>Here is an exception class from our sample application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class IllegalEntityStateException extends ApplicationBusinessException {

  private static final long serialVersionUID = 1L;

  public IllegalEntityStateException(Object entity, Object state) {

    this((Throwable) null, entity, state);
  }


  public IllegalEntityStateException(Object entity, Object currentState, Object newState) {

    this(null, entity, currentState, newState);
  }

  public IllegalEntityStateException(Throwable cause, Object entity, Object state) {

    super(cause, createBundle(NlsBundleApplicationRoot.class).errorIllegalEntityState(entity, state));
  }

  public IllegalEntityStateException(Throwable cause, Object entity, Object currentState, Object newState) {

    super(cause, createBundle(NlsBundleApplicationRoot.class).errorIllegalEntityStateChange(entity, currentState,
        newState));
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The message templates are defined in the interface NlsBundleRestaurantRoot as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface NlsBundleApplicationRoot extends NlsBundle {


  @NlsBundleMessage("The entity {entity} is in state {state}!")
  NlsMessage errorIllegalEntityState(@Named("entity") Object entity, @Named("state") Object state);


  @NlsBundleMessage("The entity {entity} in state {currentState} can not be changed to state {newState}!")
  NlsMessage errorIllegalEntityStateChange(@Named("entity") Object entity, @Named("currentState") Object currentState,
      @Named("newState") Object newState);


  @NlsBundleMessage("The property {property} of object {object} can not be changed!")
  NlsMessage errorIllegalPropertyChange(@Named("object") Object object, @Named("property") Object property);

  @NlsBundleMessage("There is currently no user logged in")
  NlsMessage errorNoActiveUser();</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="handling-exceptions"><a class="anchor" href="#handling-exceptions"></a>Handling Exceptions</h5>
<div class="paragraph">
<p>For catching and handling exceptions we follow these rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We do not catch exceptions just to wrap or to re-throw them.</p>
</li>
<li>
<p>If we catch an exception and throw a new one, we always <strong>have</strong> to provide the original exception as <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html#getCause%28%29">cause</a> to the constructor of the new exception.</p>
</li>
<li>
<p>At the entry points of the application (e.g. a service operation) we have to catch and handle all throwables. This is done via the <em>exception-facade-pattern</em> via an explicit facade or aspect. The <code>devon4j-rest</code> module already provides ready-to-use implementations for this such as <a href="https://github.com/devonfw/devon4j/blob/develop/modules/rest/src/main/java/com/devonfw/module/rest/service/impl/RestServiceExceptionFacade.java">RestServiceExceptionFacade</a> that you can use in your Spring application. For Quarkus, follow the <a href="quarkus/guide-exception-handling">Quarkus guide on exception handling</a>.<br>
The exception facade has to &#8230;&#8203;</p>
<div class="ulist">
<ul>
<li>
<p>log all errors (user errors on info and technical errors on error level)</p>
</li>
<li>
<p>ensure that the entire exception is passed to the logger (not only the message) so that the logger can capture the entire stacktrace and the root cause is not lost.</p>
</li>
<li>
<p>convert the error to a result appropriable for the client and secure for <a href="https://www.owasp.org/index.php/Top_10_2013-A6-Sensitive_Data_Exposure">Sensitive Data Exposure</a>. Especially for security exceptions only a generic security error code or message may be revealed but the details shall only be logged but <strong>not</strong> be exposed to the client. All <em>internal exceptions</em> are converted to a generic error with a message like:</p>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>An unexpected technical error has occurred. We apologize any inconvenience. Please try again later.</p>
</div>
</blockquote>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="common-errors"><a class="anchor" href="#common-errors"></a>Common Errors</h5>
<div class="paragraph">
<p>The following errors may occur in any devon application:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. Common Exceptions</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Code</strong></th>
<th class="tableblock halign-left valign-top"><strong>Message</strong></th>
<th class="tableblock halign-left valign-top"><strong>Link</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TechnicalError</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An unexpected error has occurred! We apologize any inconvenience. Please try again later.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/m-m-m/util/blob/master/exception/src/main/java/net/sf/mmm/util/exception/api/TechnicalErrorUserException.java">TechnicalErrorUserException.java</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ServiceInvoke</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">«original message of the cause»</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/m-m-m/util/blob/master/exception/src/main/java/net/sf/mmm/util/exception/api/ServiceInvocationFailedException.java">ServiceInvocationFailedException.java</a></p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Internationalization
Internationalization (I18N) is about writing code independent from locale-specific information.
For I18N of text messages we are suggesting
<a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/nls/api/package-summary.html#documentation">mmm native-language-support</a>.</p>
</div>
<div class="paragraph">
<p>In devonfw we have developed a solution to manage text internationalization. devonfw solution comes into two aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bind locale information to the user.</p>
</li>
<li>
<p>Get the messages in the current user locale.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="binding-locale-information-to-the-user"><a class="anchor" href="#binding-locale-information-to-the-user"></a>Binding locale information to the user</h5>
<div class="paragraph">
<p>We have defined two different points to bind locale information to user, depending on user is authenticated or not.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>User not authenticated: devonfw intercepts unsecured request and extract locale from it. At first, we try to extract a <code>language</code> parameter from the request and if it is not possible, we extract locale from Àccept-language` header.</p>
</li>
<li>
<p>User authenticated. During login process, applications developers are responsible to fill <code>language</code> parameter in the UserProfile class. This <code>language</code> parameter could be obtain from DB, LDAP, request, etc. In devonfw sample we get the locale information from database.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This image shows the entire process:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/images/i18n.png" alt="Internationalization">
</div>
</div>
</div>
<div class="sect4">
<h5 id="getting-internationalizated-messages"><a class="anchor" href="#getting-internationalizated-messages"></a>Getting internationalizated messages</h5>
<div class="paragraph">
<p>devonfw has a bean that manage i18n message resolution, the <code>ApplicationLocaleResolver.</code> This bean is responsible to get the current user and extract locale information from it and read the correct properties file to get the message.</p>
</div>
<div class="paragraph">
<p>The i18n properties file must be called <code>ApplicationMessages_la_CO.properties</code> where la=language and CO=country. This is an example of a i18n properties file for English language to translate devonfw sample user roles:</p>
</div>
<div class="paragraph">
<p>ApplicationMessages_en_US.properties</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>admin=Admin</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should define an ApplicationMessages_la_CO.properties file for every language that your application needs.</p>
</div>
<div class="paragraph">
<p><code>ApplicationLocaleResolver</code> bean is injected in <code>AbstractComponentFacade</code> class so you have available this bean in logic layer so you only need to put this code to get an internationalized message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">String msg = getApplicationLocaleResolver().getMessage("mymessage");</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Service Client</p>
</div>
<div class="paragraph">
<p>This guide is about consuming (calling) services from other applications (micro-services). For providing services, see the <a href="guide-service-layer">Service-Layer Guide</a>. Services can be consumed by the <a href="guide-client-layer">client</a> or the server. As the client is typically not written in Java, you should consult the according guide for your client technology. In case you want to call a service within your Java code, this guide is the right place to get help.</p>
</div>
</div>
<div class="sect4">
<h5 id="motivation-5"><a class="anchor" href="#motivation-5"></a>Motivation</h5>
<div class="paragraph">
<p>Various solutions already exist for calling services, such as <code>RestTemplate</code> from spring or the JAX-RS client API. Furthermore, each and every service framework offers its own API as well. These solutions might be suitable for very small and simple projects (with one or two such invocations). However, with the trend of microservices, the invocation of a service becomes a very common use-case that occurs all over the place. You typically need a solution that is very easy to use but supports flexible configuration, adding headers for authentication, mapping of errors from the server, logging success/errors with duration for performance analysis, support for synchronous and asynchronous invocations, etc. This is exactly what this <code>devon4j</code> service-client solution brings to you.</p>
</div>
</div>
<div class="sect4">
<h5 id="usage-4"><a class="anchor" href="#usage-4"></a>Usage</h5>
<div class="paragraph">
<p><strong>Spring</strong></p>
</div>
<div class="paragraph">
<p>For Spring, follow the <a href="spring/guide-service-client-spring">Spring rest-client guide</a>.</p>
</div>
<div class="paragraph">
<p><strong>Quarkus</strong></p>
</div>
<div class="paragraph">
<p>For Quarkus, we recommend to follow the official <a href="https://quarkus.io/guides/rest-client">Quarkus rest-client guide</a></p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Testing</p>
</div>
</div>
<div class="sect4">
<h5 id="general-best-practices"><a class="anchor" href="#general-best-practices"></a>General best practices</h5>
<div class="paragraph">
<p>For testing please follow our general best practices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tests should have a clear goal that should also be documented.</p>
</li>
<li>
<p>Tests have to be classified into different <a href="#integration-levels">integration levels</a>.</p>
</li>
<li>
<p>Tests should follow a clear naming convention.</p>
</li>
<li>
<p>Automated tests need to properly assert the result of the tested operation(s) in a reliable way. E.g. avoid stuff like <code>assertThat(service.getAllEntities()).hasSize(42)</code> or even worse tests that have no assertion at all.</p>
</li>
<li>
<p>Tests need to be independent of each other. Never write test-cases or tests (in Java @Test methods) that depend on another test to be executed before.</p>
</li>
<li>
<p>Use <a href="http://joel-costigliola.github.io/assertj/">AssertJ</a> to write good readable and maintainable tests that also provide valuable feedback in case a test fails. Do not use legacy JUnit methods like <code>assertEquals</code> anymore!</p>
</li>
<li>
<p>For easy understanding divide your test in three commented sections:</p>
<div class="ulist">
<ul>
<li>
<p><code>//given</code></p>
</li>
<li>
<p><code>//when</code></p>
</li>
<li>
<p><code>//then</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Plan your tests and test data management properly before implementing.</p>
</li>
<li>
<p>Instead of having a too strong focus on test coverage better ensure you have covered your critical core functionality properly and review the code including tests.</p>
</li>
<li>
<p>Test code shall NOT be seen as second class code. You shall consider design, architecture and code-style also for your test code but do not over-engineer it.</p>
</li>
<li>
<p>Test automation is good but should be considered in relation to cost per use. Creating full coverage via <em>automated system tests</em> can cause a massive amount of test-code that can turn out as a huge maintenance hell. Always consider all aspects including product life-cycle, criticality of use-cases to test, and variability of the aspect to test (e.g. UI, test-data).</p>
</li>
<li>
<p>Use continuous integration and establish that the entire team wants to have clean builds and running tests.</p>
</li>
<li>
<p>Prefer delegation over inheritance for cross-cutting testing functionality. Good places to put this kind of code can be realized and reused via the JUnit @Rule mechanism.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="test-automation-technology-stack"><a class="anchor" href="#test-automation-technology-stack"></a>Test Automation Technology Stack</h5>
<div class="paragraph">
<p>For test automation we use <a href="http://junit.org/">JUnit</a>. However, we are strictly doing all assertions with <a href="http://joel-costigliola.github.io/assertj/">AssertJ</a>. For <a href="#test-doubles">mocking</a> we use <a href="http://mockito.org/">Mockito</a>.
In order to mock remote connections we use <a href="#wiremock">WireMock</a>.</p>
</div>
<div class="paragraph">
<p>For testing entire components or sub-systems we recommend to use for Spring stack <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-testing.html">spring-boot-starter-test</a> as lightweight and fast testing infrastructure that is already shipped with <code>devon4j-test</code>. For Quarkus, you can add the necessary extensions manually such as <code>quarkus-junit5</code>, <code>quarkus-junit5-mockito</code>, <code>assertj-core</code> etc.</p>
</div>
<div class="paragraph">
<p>In case you have to use a full blown JEE application server, we recommend to use <a href="http://arquillian.org/">arquillian</a>. To get started with arquillian, look <a href="http://arquillian.org/guides/getting_started/index.html#add_the_arquillian_apis">here</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="test-doubles"><a class="anchor" href="#test-doubles"></a>Test Doubles</h5>
<div class="paragraph">
<p>We use <a href="http://xunitpatterns.com/Using%20Test%20Doubles.html">test doubles</a> as generic term for mocks, stubs, fakes, dummies, or spys to avoid confusion. Here is a short summary from <a href="http://martinfowler.com/articles/mocksArentStubs.html">stubs VS mocks</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Dummy</strong> objects specifying no logic at all. May declare data in a POJO style to be used as boiler plate code to parameter lists or even influence the control flow towards the test&#8217;s needs.</p>
</li>
<li>
<p><strong>Fake</strong> objects actually have working implementations, but usually take some shortcut which makes them not suitable for production (an in memory database is a good example).</p>
</li>
<li>
<p><strong>Stubs</strong> provide canned answers to calls made during the test, usually not responding at all to anything outside what&#8217;s programmed in for the test. Stubs may also record information about calls, such as an email gateway stub that remembers the messages it 'sent', or maybe only how many messages it 'sent'.</p>
</li>
<li>
<p><strong>Mocks</strong> are objects pre-programmed with expectations, which form a specification of the calls they are expected to receive.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We try to give some examples, which should make it somehow clearer:</p>
</div>
<div class="sect5">
<h6 id="stubs"><a class="anchor" href="#stubs"></a>Stubs</h6>
<div class="paragraph">
<p>Best Practices for applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A good way to replace small to medium large boundary systems, whose impact (e.g. latency) should be ignored during load and performance tests of the application under development.</p>
</li>
<li>
<p>As stub implementation will rely on state-based verification, there is the threat, that test developers will partially reimplement the state transitions based on the replaced code. This will immediately lead to a black maintenance whole, so better use mocks to assure the certain behavior on interface level.</p>
</li>
<li>
<p>Do NOT use stubs as basis of a large amount of test cases as due to state-based verification of stubs, test developers will enrich the stub implementation to become a large monster with its own hunger after maintenance efforts.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="mocks"><a class="anchor" href="#mocks"></a>Mocks</h6>
<div class="paragraph">
<p>Best Practices for applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Replace not-needed dependencies of your system-under-test (SUT) to minimize the application context to start of your component framework.</p>
</li>
<li>
<p>Replace dependencies of your SUT to impact the control flow under test without establishing all the context parameters needed to match the control flow.</p>
</li>
<li>
<p>Remember: Not everything has to be mocked! Especially on lower levels of tests like isolated module tests you can be betrayed into a mocking delusion, where you end up in a hundred lines of code mocking the whole context and five lines executing the test and verifying the mocks behavior. Always keep in mind the benefit-cost ratio, when implementing tests using mocks.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="wiremock"><a class="anchor" href="#wiremock"></a>WireMock</h6>
<div class="paragraph">
<p>If you need to mock remote connections such as HTTP-Servers, WireMock offers easy to use functionality. For a full description see the <a href="http://wiremock.org/">homepage</a> or the <a href="https://github.com/tomakehurst/wiremock">github repository</a>. Wiremock can be used either as a JUnit Rule, in Java outside of JUnit or as a standalone process. The mocked server can be configured to respond to specific requests in a given way via a fluent Java API, JSON files and JSON over HTTP. An example as an integration to JUnit can look as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import static com.github.tomakehurst.wiremock.core.WireMockConfiguration.wireMockConfig;
import com.github.tomakehurst.wiremock.junit.WireMockRule;

public class WireMockOfferImport{

  @Rule
  public WireMockRule mockServer = new WireMockRule(wireMockConfig().dynamicPort());

  @Test
  public void requestDataTest() throws Exception {
  int port = this.mockServer.port();
  ...}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This creates a server on a randomly chosen free port on the running machine. You can also specify the port to be used if wanted. Other than that there are several options to further configure the server. This includes HTTPs, proxy settings, file locations, logging and extensions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Test
  public void requestDataTest() throws Exception {
      this.mockServer.stubFor(get(urlEqualTo("/new/offers")).withHeader("Accept", equalTo("application/json"))
      .withHeader("Authorization", containing("Basic")).willReturn(aResponse().withStatus(200).withFixedDelay(1000)
      .withHeader("Content-Type", "application/json").withBodyFile("/wireMockTest/jsonBodyFile.json")));
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will stub the URL <code>localhost:port/new/offers</code> to respond with a status 200 message containing a header (<code>Content-Type: application/json</code>) and a body with content given in <code>jsonBodyFile.json</code> if the request matches several conditions.
It has to be a GET request to <code>../new/offers</code> with the two given header properties.</p>
</div>
<div class="paragraph">
<p>Note that by default files are located in <code>src/test/resources/__files/</code>. When using only one WireMock server one can omit the <code>this.mockServer</code> in before the <code>stubFor</code> call (static method).
You can also add a fixed delay to the response or processing delay with <code>WireMock.addRequestProcessingDelay(time)</code> in order to test for timeouts.</p>
</div>
<div class="paragraph">
<p>WireMock can also respond with different corrupted messages to simulate faulty behaviour.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Test(expected = ResourceAccessException.class)
public void faultTest() {

    this.mockServer.stubFor(get(urlEqualTo("/fault")).willReturn(aResponse()
    .withFault(Fault.MALFORMED_RESPONSE_CHUNK)));
...}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A GET request to <code>../fault</code> returns an OK status header, then garbage, and then closes the connection.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="integration-levels"><a class="anchor" href="#integration-levels"></a>Integration Levels</h5>
<div class="paragraph">
<p>There are many discussions about the right level of integration for test automation. Sometimes it is better to focus on small, isolated modules of the system - whatever a "module" may be. In other cases it makes more sense to test integrated groups of modules. Because there is no universal answer to this question, devonfw only defines a common terminology for what could be tested. Each project must make its own decision where to put the focus of test automation. There is no worldwide accepted terminology for the integration levels of testing. In general we consider <a href="http://istqbexamcertification.com/what-are-software-testing-levels/">ISTQB</a>. However, with a technical focus on test automation we want to get more precise.</p>
</div>
<div class="paragraph">
<p>The following picture shows a simplified view of an application based on the <a href="architecture#technical-architecture">devonfw reference architecture</a>. We define four integration levels that are explained in detail below.
The boxes in the picture contain parenthesized numbers. These numbers depict the lowest integration level, a box belongs to. Higher integration levels also contain all boxes of lower integration levels. When writing tests for a given integration level, related boxes with a lower integration level must be replaced by test <a href="#test-doubles">doubles</a> or drivers.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/images/integration-levels.png" alt="Integration Levels">
</div>
</div>
<div class="paragraph">
<p>The main difference between the integration levels is the amount of infrastructure needed to test them. The more infrastructure you need, the more bugs you will find, but the more instable and the slower your tests will be. So each project has to make a trade-off between pros and contras of including much infrastructure in tests and has to select the integration levels that fit best to the project.</p>
</div>
<div class="paragraph">
<p>Consider, that more infrastructure does not automatically lead to a better bug-detection. There may be bugs in your software that are masked by bugs in the infrastructure. The best way to find those bugs is to test with very few infrastructure.</p>
</div>
<div class="paragraph">
<p>External systems do not belong to any of the integration levels defined here. devonfw does not recommend involving real external systems in test automation. This means, they have to be replaced by test <a href="#test-doubles">doubles</a> in automated tests. An exception may be external systems that are fully under control of the own development team.</p>
</div>
<div class="paragraph">
<p>The following chapters describe the four integration levels.</p>
</div>
<div class="sect5">
<h6 id="level-1-module-test"><a class="anchor" href="#level-1-module-test"></a>Level 1 Module Test</h6>
<div class="paragraph">
<p>The goal of a <em>isolated module test</em> is to provide fast feedback to the developer. Consequently, isolated module tests must not have any interaction with the client, the database, the file system, the network, etc.</p>
</div>
<div class="paragraph">
<p>An isolated module test is testing a single classes or at least a small set of classes in isolation. If such classes depend on other components or external resources, etc. these shall be replaced with a <a href="#test-doubles">test double</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class MyClassTest extends ModuleTest {

  @Test
  public void testMyClass() {

    // given
    MyClass myClass = new MyClass();
    // when
    String value = myClass.doSomething();
    // then
    assertThat(value).isEqualTo("expected value");
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For an advanced example see <a href="https://github.com/devonfw/devon4j/blob/develop/modules/rest/src/test/java/com/devonfw/module/rest/service/impl/RestServiceExceptionFacadeTest.java">here</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="level-2-component-test"><a class="anchor" href="#level-2-component-test"></a>Level 2 Component Test</h6>
<div class="paragraph">
<p>A <a href="http://istqbexamcertification.com/what-is-component-testing/"><em>component test</em></a> aims to test components or component parts as a unit.
These tests can access resources such as a database (e.g. for DAO tests).
Further, no remote communication is intended here. Access to external systems shall be replaced by a <a href="#test-doubles">test double</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Spring stack, they are typically run with a (light-weight) infrastructure such as spring-boot-starter-test. A component-test is illustrated in the following example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@SpringBootTest(classes = { MySpringBootApp.class }, webEnvironment = WebEnvironment.NONE)
public class UcFindCountryTest extends ComponentTest {
  @Inject
  private UcFindCountry ucFindCountry;

  @Test
  public void testFindCountry() {

    // given
    String countryCode = "de";

    // when
    TestUtil.login("user", MyAccessControlConfig.FIND_COUNTRY);
    CountryEto country = this.ucFindCountry.findCountry(countryCode);

    // then
    assertThat(country).isNotNull();
    assertThat(country.getCountryCode()).isEqualTo(countryCode);
    assertThat(country.getName()).isEqualTo("Germany");
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This test will start the entire spring-context of your app (<code>MySpringBootApp</code>). Within the test spring will inject according spring-beans into all your fields annotated with <code>@Inject</code>. In the test methods you can use these spring-beans and perform your actual tests. This pattern can be used for testing DAOs/Repositories, Use-Cases, or any other spring-bean with its entire configuration including database and transactions.</p>
</div>
</li>
<li>
<p>For Quarkus, you can similarly inject the CDI beans and perform tests. An example is shown below:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@QuarkusTest
public class UcFindCountryTest {
  @Inject
  private UcFindCountry ucFindCountry;
  ...</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you are testing use-cases your <a href="guide-access-control#configuration-on-java-method-level">authorization</a> will also be in place. Therefore, you have to simulate a logon in advance what is done via the <code>login</code> method in the above Spring example.  The test-infrastructure will automatically do a <code>logout</code> for you after each test method in <code>doTearDown</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="level-3-subsystem-test"><a class="anchor" href="#level-3-subsystem-test"></a>Level 3 Subsystem Test</h6>
<div class="paragraph">
<p>A <em>subsystem test</em> runs against the external interfaces (e.g. HTTP service) of the integrated subsystem. Subsystem tests of the client subsystem are described in the <a href="https://github.com/devonfw/devon4ng/blob/master/documentation/guide-testing">devon4ng testing guide</a>. In devon4j the server (JEE application) is the subsystem under test. The tests act as a client (e.g. service consumer) and the server has to be integrated and started in a container.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>With devon4j and Spring you can write a subsystem-test as easy as illustrated in the following example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@SpringBootTest(classes = { MySpringBootApp.class }, webEnvironment = WebEnvironment.RANDOM_PORT)
public class CountryRestServiceTest extends SubsystemTest {

  @Inject
  private ServiceClientFactory serviceClientFactory;

  @Test
  public void testFindCountry() {

    // given
    String countryCode = "de";

    // when
    CountryRestService service = this.serviceClientFactory.create(CountryRestService.class);
    CountryEto country = service.findCountry(countryCode);

    // then
    assertThat(country).isNotNull();
    assertThat(country.getCountryCode()).isEqualTo(countryCode);
    assertThat(country.getName()).isEqualTo("Germany");
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Even though not obvious on the first look this test will start your entire application as a server on a free random port (so that it works in CI with parallel builds for different branches) and tests the invocation of a (REST) service including (un)marshalling of data (e.g. as JSON) and transport via HTTP (all in the invocation of the <code>findCountry</code> method).</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Do not confuse a <em>subsystem test</em> with a <a href="http://istqbexamcertification.com/what-is-system-integration-testing/">system integration test</a>. A system integration test validates the interaction of several systems where we do not recommend test automation.</p>
</div>
</div>
<div class="sect5">
<h6 id="level-4-system-test"><a class="anchor" href="#level-4-system-test"></a>Level 4 System Test</h6>
<div class="paragraph">
<p>A <a href="http://istqbexamcertification.com/what-is-system-testing/"><em>system test</em></a> has the goal to test the system as a whole against its official interfaces such as its UI or batches. The system itself runs as a separate process in a way close to a regular deployment. Only external systems are simulated by <a href="#test-doubles">test doubles</a>.</p>
</div>
<div class="paragraph">
<p>The devonfw only gives advice for automated system test (TODO see allure testing framework). In nearly every project there must be manual system tests, too. This manual system tests are out of scope here.</p>
</div>
</div>
<div class="sect5">
<h6 id="classifying-integration-levels"><a class="anchor" href="#classifying-integration-levels"></a>Classifying Integration-Levels</h6>
<div class="paragraph">
<p>For Spring stack, devon4j defines <a href="https://github.com/devonfw/devon4j/tree/develop/modules/test/src/main/java/com/devonfw/module/test/common/api/category">Category-Interfaces</a> that shall be used as <a href="https://github.com/junit-team/junit/wiki/Categories">JUnit Categories</a>.
Also devon4j provides <a href="https://github.com/devonfw/devon4j/tree/develop/modules/test/src/main/java/com/devonfw/module/test/common/base">abstract base classes</a> that you may extend in your test-cases if you like.</p>
</div>
<div class="paragraph">
<p>devon4j further pre-configures the maven build to only run integration levels 1-2 by default (e.g. for fast feedback in continuous integration). It offers the profiles subsystemtest (1-3) and systemtest (1-4). In your nightly build you can simply add -Psystemtest to run all tests.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="implementation-4"><a class="anchor" href="#implementation-4"></a>Implementation</h5>
<div class="paragraph">
<p>This section introduces how to implement tests on the different levels with the given devonfw infrastructure and the proposed frameworks.
For Spring, see <a href="spring/guide-spring-testing#implementation">Spring Test Implementation</a></p>
</div>
</div>
<div class="sect4">
<h5 id="regression-testing"><a class="anchor" href="#regression-testing"></a>Regression testing</h5>
<div class="paragraph">
<p>When it comes to complex output (even binary) that you want to regression test by comparing with an expected result, you sould consider <a href="https://approvaltests.com/">Approval Tests</a> using <a href="https://github.com/approvals/approvaltests.java">ApprovalTests.Java</a>.
If applied for the right problems, it can be very helpful.</p>
</div>
</div>
<div class="sect4">
<h5 id="deployment-pipeline"><a class="anchor" href="#deployment-pipeline"></a>Deployment Pipeline</h5>
<div class="paragraph">
<p>A deployment pipeline is a semi-automated process that gets software-changes from version control into production. It contains several validation steps, e.g. automated tests of all integration levels.
Because devon4j should fit to different project types - from agile to waterfall - it does not define a standard deployment pipeline. But we recommend to define such a deployment pipeline explicitly for each project and to find the right place in it for each type of test.</p>
</div>
<div class="paragraph">
<p>For that purpose, it is advisable to have fast running test suite that gives as much confidence as possible without needing too much time and too much infrastructure. This test suite should run in an early stage of your deployment pipeline. Maybe the developer should run it even before he/she checked in the code. Usually lower integration levels are more suitable for this test suite than higher integration levels.</p>
</div>
<div class="paragraph">
<p>Note, that the deployment pipeline always should contain manual validation steps, at least manual acceptance testing. There also may be manual validation steps that have to be executed for special changes only, e.g. usability testing. Management and execution processes of those manual validation steps are currently not in the scope of devonfw.</p>
</div>
</div>
<div class="sect4">
<h5 id="test-coverage"><a class="anchor" href="#test-coverage"></a>Test Coverage</h5>
<div class="paragraph">
<p>We are using tools (SonarQube/Jacoco) to measure the coverage of the tests. Please always keep in mind that the only reliable message of a code coverage of X% is that (100-X)% of the code is entirely untested. It does not say anything about the quality of the tests or the software though it often relates to it.</p>
</div>
</div>
<div class="sect4">
<h5 id="test-configuration"><a class="anchor" href="#test-configuration"></a>Test Configuration</h5>
<div class="paragraph">
<p>This section covers test configuration in general without focusing on integration levels as in the first chapter.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Spring, see <a href="spring/guide-spring-testing#configure-test-specific-beans">Configure Test Specific Beans</a></p>
</li>
<li>
<p>For Quarkus, see <a href="quarkus/guide-quarkus-testing#configuration">here</a></p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="configure-test-specific-beans"><a class="anchor" href="#configure-test-specific-beans"></a>Configure Test Specific Beans</h6>
<div class="paragraph">
<p>Sometimes it can become handy to provide other or differently configured bean implementations via CDI than those available in production. For example, when creating beans using <code>@Bean</code>-annotated methods they are usually configured within those methods. <a href="https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/java/com/devonfw/application/mtsj/general/service/impl/config/WebSecurityBeansConfig.java">WebSecurityBeansConfig</a> shows an example of such methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
public class WebSecurityBeansConfig {
  //...
  @Bean
  public AccessControlSchemaProvider accessControlSchemaProvider() {
    // actually no additional configuration is shown here
    return new AccessControlSchemaProviderImpl();
  }
  //...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>AccessControlSchemaProvider</code> allows to programmatically access data defined in some XML file, e.g. <code>access-control-schema.xml</code>. Now, one can imagine that it would be helpful if <code>AccessControlSchemaProvider</code> would point to some other file than the default within a test class. That file could provide content that differs from the default.
The question is: how can I change resource path of <code>AccessControlSchemaProviderImpl</code> within a test?</p>
</div>
<div class="paragraph">
<p>One very helpful solution is to use <strong>static inner classes</strong>.
Static inner classes can contain <code>@Bean</code> -annotated methods, and by placing them in the <code>classes</code> parameter in <code>@SpringBootTest(classes = { /* place class here*/ })</code> annotation the beans returned by these methods are placed in the application context during test execution. Combining this feature with inheritance allows to override methods defined in other configuration classes as shown in the following listing where <code>TempWebSecurityConfig</code> extends <code>WebSecurityBeansConfig</code>. This relationship allows to override <code>public AccessControlSchemaProvider accessControlSchemaProvider()</code>. Here we are able to configure the instance of type <code>AccessControlSchemaProviderImpl</code> before returning it (and, of course, we could also have used a completely different implementation of the <code>AccessControlSchemaProvider</code> interface). By overriding the method the implementation of the super class is ignored, hence, only the new implementation is called at runtime. Other methods defined in <code>WebSecurityBeansConfig</code> which are not overridden by the subclass are still dispatched to <code>WebSecurityBeansConfig</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">//... Other testing related annotations
@SpringBootTest(classes = { TempWebSecurityConfig.class })
public class SomeTestClass {

  public static class TempWebSecurityConfig extends WebSecurityBeansConfig {

    @Override
    @Bean
    public AccessControlSchemaProvider accessControlSchemaProvider() {

      ClassPathResource resource = new ClassPathResource(locationPrefix + "access-control-schema3.xml");
      AccessControlSchemaProviderImpl accessControlSchemaProvider = new AccessControlSchemaProviderImpl();
      accessControlSchemaProvider.setAccessControlSchema(resource);
      return accessControlSchemaProvider;
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following <a href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#testcontext-ctx-management-javaconfig">chapter of the Spring framework documentation</a> explains issue, but uses a slightly different way to obtain the configuration.</p>
</div>
</div>
<div class="sect5">
<h6 id="test-data"><a class="anchor" href="#test-data"></a>Test Data</h6>
<div class="paragraph">
<p>It is possible to obtain test data in two different ways depending on your test&#8217;s integration level.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="debugging-tests"><a class="anchor" href="#debugging-tests"></a>Debugging Tests</h5>
<div class="paragraph">
<p>The following two sections describe two debugging approaches for tests. Tests are either run from within the IDE or from the command line using Maven.</p>
</div>
<div class="sect5">
<h6 id="debugging-with-the-ide"><a class="anchor" href="#debugging-with-the-ide"></a>Debugging with the IDE</h6>
<div class="paragraph">
<p>Debugging with the IDE is as easy as always. Even if you want to execute a <code>SubsystemTest</code> which needs a Spring context and a server infrastructure to run properly, you just set your breakpoints and click on Debug As &#8594; JUnit Test. The test infrastructure will take care of initializing the necessary infrastructure - if everything is configured properly.</p>
</div>
</div>
<div class="sect5">
<h6 id="debugging-with-maven"><a class="anchor" href="#debugging-with-maven"></a>Debugging with Maven</h6>
<div class="paragraph">
<p>Please refer to the following two links to find a guide for debugging tests when running them from Maven.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://maven.apache.org/surefire/maven-surefire-plugin/examples/debugging.html" class="bare">http://maven.apache.org/surefire/maven-surefire-plugin/examples/debugging.html</a></p>
</li>
<li>
<p><a href="https://www.eclipse.org/jetty/documentation/jetty-9/index.html#debugging-with-eclipse" class="bare">https://www.eclipse.org/jetty/documentation/jetty-9/index.html#debugging-with-eclipse</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In essence, you first have to start execute a test using the command line. Maven will halt just before the test execution and wait for your IDE to connect to the process. When receiving a connection the test will start and then pause at any breakpoint set in advance.
The first link states that tests are started through the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>mvn -Dmaven.surefire.debug test</code></pre>
</div>
</div>
<div class="paragraph">
<p>Although this is correct, it will run <em>every</em> test class in your project and - which is time consuming and mostly unnecessary - halt before each of these tests.
To counter this problem you can simply execute a single test class through the following command (here we execute the <code>TablemanagementRestServiceTest</code> from the restaurant sample application):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>mvn test -Dmaven.surefire.debug test -Dtest=TablemanagementRestServiceTest</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is important to notice that you first have to execute the Maven command in the according submodule, e.g. to execute the <code>TablemanagementRestServiceTest</code> you have first to navigate to the core module&#8217;s directory.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Transfer-Objects</p>
</div>
<div class="paragraph">
<p>The technical data model is defined in form of <a href="guide-jpa#entity">persistent entities</a>.
However, passing persistent entities via <em>call-by-reference</em> across the entire application will soon cause problems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Changes to a persistent entity are directly written back to the persistent store when the transaction is committed. When the entity is send across the application also changes tend to take place in multiple places endangering data sovereignty and leading to inconsistency.</p>
</li>
<li>
<p>You want to send and receive data via services across the network and have to define what section of your data is actually transferred. If you have relations in your technical model you quickly end up loading and transferring way too much data.</p>
</li>
<li>
<p>Modifications to your technical data model shall not automatically have impact on your external services causing incompatibilities.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To prevent such problems transfer-objects are used leading to a <em>call-by-value</em> model and decoupling changes to persistent entities.</p>
</div>
<div class="paragraph">
<p>In the following sections the different types of transfer-objects are explained.
You will find all according naming-conventions in the <a href="guide-structure-classic#architecture-mapping">architecture-mapping</a></p>
</div>
<div class="paragraph">
<p>To structure your transfer objects, we recommend the following approaches:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-eto-cto">ETO and CTO</a></p>
</li>
<li>
<p><a href="guide-dto">DTO</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also considering the following transfer objects in specific cases:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">SearchCriteriaTo</dt>
<dd>
<p>For searching we create or generate a <code>«BusinessObject»SearchCriteriaTo</code> representing a query to find instances of <code>«BusinessObject»</code>.</p>
</dd>
<dt class="hdlist1">TO</dt>
<dd>
<p>There are typically transfer-objects for data that is never persistent.
For very generic cases these just carry the suffix <code>To</code>.</p>
</dd>
<dt class="hdlist1">STO</dt>
<dd>
<p>We can potentially create separate <em>service transfer objects</em> (STO) (if possible named <code>«BusinessObject»Sto</code>) to keep the <a href="guide-service-layer">service</a> API stable and independent of the actual data-model.
However, we usually do not need this and want to keep our architecture simple.
Only create STOs if you need <a href="guide-service-layer#versioning">service versioning</a> and support previous APIs or to provide legacy service technologies that require their own isolated data-model.
In such case you also need <a href="guide-beanmapping">beanmapping</a> between STOs and ETOs/DTOs what means extra effort and complexity that should be avoided.</p>
</dd>
</dl>
</div>
<div style="page-break-after: always;"></div>
<div class="paragraph">
<p>==Bean Mapping in devon4j-spring</p>
</div>
<div class="paragraph">
<p>We have developed a solution that uses a <code>BeanMapper</code> that allows to abstract from the underlying implementation. As mentioned in the <a href="../guide-beanmapping.asccidoc">general bean mapping guide</a>, we started with <a href="http://dozer.sourceforge.net/documentation/about.html">Dozer</a> a Java Bean to Java Bean mapper that recursively copies data from one object to another. Now we recommend using <a href="https://orika-mapper.github.io/orika-docs/">Orika</a>. This guide will show an introduction to Orika and Dozer bean-mapper.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bean-mapper-dependency"><a class="anchor" href="#bean-mapper-dependency"></a>Bean-Mapper Dependency</h5>
<div class="paragraph">
<p>To get access to the <code>BeanMapper</code> we have to use either of the below dependency in our POM:</p>
</div>
<div class="listingblock">
<div class="title">Listing 22. <strong>Orika</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.devonfw.java.modules&lt;/groupId&gt;
    &lt;artifactId&gt;devon4j-beanmapping-orika&lt;/artifactId&gt;
    &lt;version&gt;2020.12.002&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 23. <strong>Dozer</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.devonfw.java.modules&lt;/groupId&gt;
    &lt;artifactId&gt;devon4j-beanmapping-dozer&lt;/artifactId&gt;
    &lt;version&gt;2020.12.002&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bean-mapper-configuration"><a class="anchor" href="#bean-mapper-configuration"></a>Bean-Mapper Configuration</h5>
<div class="sect5">
<h6 id="bean-mapper-configuration-using-dozer"><a class="anchor" href="#bean-mapper-configuration-using-dozer"></a>Bean-Mapper Configuration using Dozer</h6>
<div class="paragraph">
<p>The <code>BeanMapper</code> implementation is based on an existing open-source bean-mapping framework.
In case of Dozer the mapping is configured <code>src/main/resources/config/app/common/dozer-mapping.xml</code>.</p>
</div>
<div class="paragraph">
<p>See the my-thai-star <a href="https://github.com/devonfw/my-thai-star/blob/develop/java/mtsj/core/src/main/resources/config/app/common/dozer-mapping.xml">dozer-mapping.xml</a> as an example.
Important is that you configure all your custom datatypes as <code>&lt;copy-by-reference&gt;</code> tags and have the mapping from <code>PersistenceEntity</code> (<code>ApplicationPersistenceEntity</code>) to <code>AbstractEto</code> configured properly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml"> &lt;mapping type="one-way"&gt;
    &lt;class-a&gt;com.devonfw.module.basic.common.api.entity.PersistenceEntity&lt;/class-a&gt;
    &lt;class-b&gt;com.devonfw.module.basic.common.api.to.AbstractEto&lt;/class-b&gt;
    &lt;field custom-converter="com.devonfw.module.beanmapping.common.impl.dozer.IdentityConverter"&gt;
      &lt;a&gt;this&lt;/a&gt;
      &lt;b is-accessible="true"&gt;persistentEntity&lt;/b&gt;
    &lt;/field&gt;
&lt;/mapping&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bean-mapper-configuration-using-orika"><a class="anchor" href="#bean-mapper-configuration-using-orika"></a>Bean-Mapper Configuration using Orika</h5>
<div class="paragraph">
<p>Orika with devonfw is configured by default and sets some custom mappings for <em>GenericEntity.java</em> to <em>GenericEntityDto.java</em>. To specify and customize the mappings you can create the class <em>BeansOrikaConfig.java</em> that extends the class <em>BaseOrikaConfig.java</em> from the <strong>devon4j.orika</strong> package. To register a basic mapping, register a <strong>ClassMap</strong> for the <strong>mapperFactory</strong> with your custom mapping. Watch the example below and follow the <a href="https://orika-mapper.github.io/orika-docs/mappings-via-classmapbuilder.html">basic Orika mapping configuration guide</a> and the <a href="https://orika-mapper.github.io/orika-docs/advanced-mappings.html">Orika advanced mapping guide</a>.</p>
</div>
<div class="paragraph">
<p>Register Mappings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">mapperFactory.classMap(UserEntity.class, UserEto.class)
			.field("email", "email")
			.field("username", "name")
			.byDefault()
			.register();</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="bean-mapper-usage"><a class="anchor" href="#bean-mapper-usage"></a>Bean-Mapper Usage</h5>
<div class="paragraph">
<p>Then we can get the <code>BeanMapper</code> via <a href="guide-dependency-injection">dependency-injection</a> what we typically already provide by an abstract base class (e.g. <code>AbstractUc</code>). Now we can solve our problem very easy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">...
UserEntity resultEntity = ...;
...
return getBeanMapper().map(resultEntity, UserEto.class);</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Datatypes</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A datatype is an object representing a value of a specific type with the following aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It has a technical or business specific semantic.</p>
</li>
<li>
<p>Its JavaDoc explains the meaning and semantic of the value.</p>
</li>
<li>
<p>It is immutable and therefore stateless (its value assigned at construction time and can not be modified).</p>
</li>
<li>
<p>It is serializable.</p>
</li>
<li>
<p>It properly implements #equals(Object) and #hashCode() (two different instances with the same value are equal and have the same hash).</p>
</li>
<li>
<p>It shall ensure syntactical validation so it is NOT possible to create an instance with an invalid value.</p>
</li>
<li>
<p>It is responsible for formatting its value to a string representation suitable for sinks such as UI, loggers, etc. Also consider cases like a Datatype representing a password where toString() should return something like "<strong><strong></strong></strong>**" instead of the actual password to prevent security accidents.</p>
</li>
<li>
<p>It is responsible for parsing the value from other representations such as a string (as needed).</p>
</li>
<li>
<p>It shall provide required logical operations on the value to prevent redundancies. Due to the immutable attribute all manipulative operations have to return a new Datatype instance (see e.g. BigDecimal.add(java.math.BigDecimal)).</p>
</li>
<li>
<p>It should implement Comparable if a natural order is defined.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Based on the Datatype a presentation layer can decide how to view and how to edit the value. Therefore a structured data model should make use of custom datatypes in order to be expressive.
Common generic datatypes are String, Boolean, Number and its subclasses, Currency, etc.
Please note that both Date and Calendar are mutable and have very confusing APIs. Therefore, use JSR-310 or jodatime instead.
Even if a datatype is technically nothing but a String or a Number but logically something special it is worth to define it as a dedicated datatype class already for the purpose of having a central javadoc to explain it. On the other side avoid to introduce technical datatypes like String32 for a String with a maximum length of 32 characters as this is not adding value in the sense of a real Datatype.
It is suitable and in most cases also recommended to use the class implementing the datatype as API omitting a dedicated interface.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; mmm project<br>
<cite>datatype javadoc</cite>
</div>
</div>
<div class="paragraph">
<p>See <a href="http://m-m-m.sourceforge.net/apidocs/net/sf/mmm/util/lang/api/Datatype.html">mmm datatype javadoc</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="datatype-packaging"><a class="anchor" href="#datatype-packaging"></a>Datatype Packaging</h5>
<div class="paragraph">
<p>For the devonfw we use a common <a href="coding-conventions#packages">packaging schema</a>.
The specifics for datatypes are as following:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Segment</strong></th>
<th class="tableblock halign-left valign-top"><strong>Value</strong></th>
<th class="tableblock halign-left valign-top"><strong>Explanation</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;component&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Here we use the (business) component defining the datatype or general for generic datatypes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;layer&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">common</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Datatypes are used across all layers and are not assigned to a dedicated layer.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;scope&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">api</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Datatypes are always used directly as API even tough they may contain (simple) implementation logic. Most datatypes are simple wrappers for generic Java types (e.g. String) but make these explicit and might add some validation.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="technical-concerns"><a class="anchor" href="#technical-concerns"></a>Technical Concerns</h5>
<div class="paragraph">
<p>Many technologies like Dozer and QueryDSL&#8217;s (alias API) are heavily based on reflection. For them to work properly with custom datatypes, the frameworks must be able to instantiate custom datatypes with no-argument constructors. It is therefore recommended to implement a no-argument constructor for each datatype of at least protected visibility.</p>
</div>
</div>
<div class="sect4">
<h5 id="datatypes-in-entities"><a class="anchor" href="#datatypes-in-entities"></a>Datatypes in Entities</h5>
<div class="paragraph">
<p>The usage of custom datatypes in entities is explained in the <a href="guide-jpa#entities-and-datatypes">persistence layer guide</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="datatypes-in-transfer-objects"><a class="anchor" href="#datatypes-in-transfer-objects"></a>Datatypes in Transfer-Objects</h5>
<div class="sect5">
<h6 id="xml"><a class="anchor" href="#xml"></a>XML</h6>
<div class="paragraph">
<p>For mapping datatypes with JAXB see <a href="guide-xml">XML guide</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="json"><a class="anchor" href="#json"></a>JSON</h6>
<div class="paragraph">
<p>For mapping datatypes from and to JSON see <a href="guide-json#json-custom-mapping">JSON custom mapping</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==CORS configuration in Spring</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="dependency-3"><a class="anchor" href="#dependency-3"></a>Dependency</h5>
<div class="paragraph">
<p>To enable the CORS support from the server side for your devon4j-Spring application, add the below dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.devonfw.java.starters&lt;/groupId&gt;
  &lt;artifactId&gt;devon4j-starter-security-cors&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="configuration-2"><a class="anchor" href="#configuration-2"></a>Configuration</h5>
<div class="paragraph">
<p>Add the below properties in your application.properties file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>#CORS support
security.cors.spring.allowCredentials=true
security.cors.spring.allowedOriginPatterns=*
security.cors.spring.allowedHeaders=*
security.cors.spring.allowedMethods=OPTIONS,HEAD,GET,PUT,POST,DELETE,PATCH
security.cors.pathPattern=/**</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Attribute</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">HTTP Header</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allowCredentials</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decides the browser should include any cookies associated with the request (<code>true</code> if cookies should be included).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access-Control-Allow-Credentials</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allowedOrigins</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of allowed origins (use <code>*</code> to allow all orgins).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access-Control-Allow-Origin</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allowedMethods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of allowed HTTP request methods (<code>OPTIONS</code>, <code>HEAD</code>, <code>GET</code>, <code>PUT</code>, <code>POST</code>, <code>DELETE</code>, <code>PATCH</code>, etc.).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">allowedHeaders</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of allowed headers that can be used during the request (use <code>*</code> to allow all headers requested by the client)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access-Control-Allow-Headers</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pathPattern</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ant-style pattern for the URL paths where to apply CORS. Use "/**" to match all URL paths.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Microservices in devonfw</p>
</div>
<div class="paragraph">
<p>The Microservices architecture is an approach for application development based on a series of <em>small</em> services grouped under a business domain. Each individual service runs autonomously and communicating with each other through their APIs. That independence between the different services allows to manage (upgrade, fix, deploy, etc.) each one without affecting the rest of the system&#8217;s services. In addition to that the microservices architecture allows to scale specific services when facing an increment of the requests, so the applications based on microservices are more flexible and stable, and can be adapted quickly to demand changes.</p>
</div>
<div class="paragraph">
<p>However, this new approach, developing apps based on microservices, presents some downsides.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see the main challenges when working with microservices:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Having the applications divided in different services we will need a component (router) to redirect each request to the related microservice. These redirection rules must implement filters to guarantee a proper functionality.</p>
</li>
<li>
<p>In order to manage correctly the routing process, the application will also need a catalog with all the microservices and its details: IPs and ports of each of the deployed instances of each microservice, the state of each instance and some other related information. This catalog is called <em>Service Discovery</em>.</p>
</li>
<li>
<p>With all the information of the <em>Service Discovery</em> the application will need to calculate and select between all the available instances of a microservice which is the suitable one. This will be figured out by the library <em>Client Side Load Balancer</em>.</p>
</li>
<li>
<p>The different microservices will be likely interconnected with each other, that means that in case of failure of one of the microservices involved in a process, the application must implement a mechanism to avoid the error propagation through the rest of the services and provide an alternative as a process result. To solve this, the pattern <em>Circuit Breaker</em> can be implemented in the calls between microservices.</p>
</li>
<li>
<p>As we have mentioned, the microservices will exchange calls and information with each other so our applications will need to provide a secured context to avoid not allowed operations or intrusions. In addition, since microservices must be able to operate in an isolated way, it is not recommended to maintain a session. To meet this need without using Spring sessions, a token-based authentication is used that exchanges information using the <a href="https://jwt.io/">json web token (JWT)</a> protocol.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In addition to all of this we will find other issues related to this particular architecture that we will address fitting the requirements of each project.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Distributed data bases: each instance of a microservice should have only one data base.</p>
</li>
<li>
<p>Centralized logs: each instance of a microservice creates a log and a trace that should be centralized to allow an easier way to read all that information.</p>
</li>
<li>
<p>Centralized configuration: each microservice has its own configuration, so our applications should group all those configurations in only one place to ease the configuration management.</p>
</li>
<li>
<p>Automatized deployments: as we are managing several components (microservices, catalogs, balancers, etc.) the deployment should be automatized to avoid errors and ease this process.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To address the above, devonfw microservices has an alternative approach <a href="alternative-microservice-netflix">Microservices based on Netflix-Tools</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Caching
Caching is a technical approach to improve performance. While it may appear easy on the first sight it is an advanced topic. In general, try to use caching only when required for performance reasons. If you come to the point that you need caching first think about:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What to cache?<br>
Be sure about what you want to cache. Is it static data? How often will it change? What will happen if the data changes but due to caching you might receive "old" values? Can this be tolerated? For how long? This is not a technical question but a business requirement.</p>
</li>
<li>
<p>Where to cache?<br>
Will you cache data on client or server? Where exactly?</p>
</li>
<li>
<p>How to cache?<br>
Is a local cache sufficient or do you need a shared cache?</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="local-cache"><a class="anchor" href="#local-cache"></a>Local Cache</h5>

</div>
<div class="sect4">
<h5 id="shared-cache"><a class="anchor" href="#shared-cache"></a>Shared Cache</h5>
<div class="sect5">
<h6 id="distributed-cache"><a class="anchor" href="#distributed-cache"></a>Distributed Cache</h6>

</div>
</div>
<div class="sect4">
<h5 id="products"><a class="anchor" href="#products"></a>Products</h5>
<div class="ulist">
<ul>
<li>
<p><a href="http://ehcache.org/" class="bare">http://ehcache.org/</a></p>
</li>
<li>
<p><a href="http://hazelcast.org/" class="bare">http://hazelcast.org/</a></p>
</li>
<li>
<p><a href="http://terracotta.org/" class="bare">http://terracotta.org/</a></p>
</li>
<li>
<p><a href="http://memcached.org/" class="bare">http://memcached.org/</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="caching-of-web-resources"><a class="anchor" href="#caching-of-web-resources"></a>Caching of Web-Resources</h5>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.mobify.com/blog/beginners-guide-to-http-cache-headers/" class="bare">http://www.mobify.com/blog/beginners-guide-to-http-cache-headers/</a></p>
</li>
<li>
<p><a href="http://en.wikipedia.org/wiki/Web_cache#Cache_control" class="bare">http://en.wikipedia.org/wiki/Web_cache#Cache_control</a></p>
</li>
<li>
<p><a href="http://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Avoiding_caching" class="bare">http://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Avoiding_caching</a></p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Feature-Toggles</p>
</div>
<div class="paragraph">
<p>The most software developing teams use Feature-Branching to be able to work in parallel and maintain a stable main branch in the VCS. However Feature-Branching might not be the ideal tool in every case because of big merges and isolation between development groups. In many cases, Feature-Toggles can avoid some of these problems, so these should definitely be considered to be used in the collaborative software development.</p>
</div>
</div>
<div class="sect4">
<h5 id="implementation-with-the-devonfw"><a class="anchor" href="#implementation-with-the-devonfw"></a>Implementation with the devonfw</h5>
<div class="paragraph">
<p>To use Feature-Toggles with the devonfw, use the Framework <a href="http://www.togglz.org/">Togglz</a> because it has all the features generally needed and provides a great documentation.</p>
</div>
<div class="paragraph">
<p>For a pretty minimal working example, also see <a href="https://github.com/florianluediger/oasp4j">this fork</a>.</p>
</div>
<div class="sect5">
<h6 id="preparation"><a class="anchor" href="#preparation"></a>Preparation</h6>
<div class="paragraph">
<p>The following example takes place in the <code>oasp-sample-core</code> project, so the necessary dependencies have to be added to the according <code>pom.xml</code> file. Required are the main Togglz project including Spring support, the Togglz console to graphically change the feature state and the Spring security package to handle authentication for the Togglz console.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;!-- Feature-Toggle-Framework togglz --&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.togglz&lt;/groupId&gt;
  &lt;artifactId&gt;togglz-spring-boot-starter&lt;/artifactId&gt;
  &lt;version&gt;2.3.0.RC2&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
  &lt;groupId&gt;org.togglz&lt;/groupId&gt;
  &lt;artifactId&gt;togglz-console&lt;/artifactId&gt;
  &lt;version&gt;2.3.0.RC2&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
  &lt;groupId&gt;org.togglz&lt;/groupId&gt;
  &lt;artifactId&gt;togglz-spring-security&lt;/artifactId&gt;
  &lt;version&gt;2.3.0.RC2&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to that, the following lines have to be included in the spring configuration file <code>application.properties</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>##configuration for the togglz Feature-Toggle-Framework
togglz.enabled=true
togglz.console.secured=false</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="small-features"><a class="anchor" href="#small-features"></a>Small features</h6>
<div class="paragraph">
<p>For small features, a simple query of the toggle state is often enough to achieve the desired functionality. To illustrate this, a simple example follows, which implements a toggle to limit the page size returned by the staffmanagement. See <a href="https://github.com/florianluediger/oasp4j/commit/e55c3c7cfcb42efe4f279dc673cced730abd580a">here</a> for further details.</p>
</div>
<div class="paragraph">
<p>This is the current implementation to <em>toggle</em> the feature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">// Uncomment next line in order to limit the maximum page size for the staff member search
// criteria.limitMaximumPageSize(MAXIMUM_HIT_LIMIT);</code></pre>
</div>
</div>
<div class="paragraph">
<p>To realise this more elegantly with Togglz, first an enum is required to configure the feature-toggle.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public enum StaffmanagementFeatures implements Feature {
  @Label("Limit the maximum page size for the staff members")
  LIMIT_STAFF_PAGE_SIZE;

  public boolean isActive() {
    return FeatureContext.getFeatureManager().isActive(this);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To familiarize the Spring framework with the enum, add the following entry to the <code>application.properties</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>togglz.feature-enums=io.oasp.gastronomy.restaurant.staffmanagement.featuremanager.StaffmanagementFeatures</code></pre>
</div>
</div>
<div class="paragraph">
<p>After that, the toggle can be used easily by calling the <code>isActive()</code> method of the enum.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">if (StaffmanagementFeatures.LIMIT_STAFF_PAGE_SIZE.isActive()) {
  criteria.limitMaximumPageSize(MAXIMUM_HIT_LIMIT);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This way, you can easily switch the feature on or off by using the administration console at <a href="http://localhost:8081/devon4j-sample-server/togglz-console" class="bare">http://localhost:8081/devon4j-sample-server/togglz-console</a>. If you are getting redirected to the login page, just sign in with any valid user (eg. admin).</p>
</div>
</div>
<div class="sect5">
<h6 id="extensive-features"><a class="anchor" href="#extensive-features"></a>Extensive features</h6>
<div class="paragraph">
<p>When implementing extensive features, you might want to consider using the strategy design pattern to maintain the overview of your software. The following example is an implementation of a feature which adds a 25% discount to all products managed by the offermanagement.</p>
</div>
<div class="olist arabic">
<div class="title">Therefore there are two strategies needed:</div>
<ol class="arabic">
<li>
<p>Return the offers with the normal price</p>
</li>
<li>
<p>Return the offers with a 25% discount</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The implementation is pretty straight forward so use this as a reference. Compare <a href="https://github.com/florianluediger/oasp4j/commit/8f43f788d3a4a61b6b003c22a8b6c0d3f2254d14">this</a> for further details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
@RolesAllowed(PermissionConstants.FIND_OFFER)
public PaginatedListTo&lt;OfferEto&gt; findOfferEtos(OfferSearchCriteriaTo criteria) {
  criteria.limitMaximumPageSize(MAXIMUM_HIT_LIMIT);
  PaginatedListTo&lt;OfferEntity&gt; offers = getOfferDao().findOffers(criteria);


  if (OffermanagementFeatures.DISCOUNT.isActive()) {
    return getOfferEtosDiscount(offers);
  } else {
    return getOfferEtosNormalPrice(offers);
  }

}


// Strategy 1: Return the OfferEtos with the normal price
private PaginatedListTo&lt;OfferEto&gt; getOfferEtosNormalPrice(PaginatedListTo&lt;OfferEntity&gt; offers) {
  return mapPaginatedEntityList(offers, OfferEto.class);
}

// Strategy 2: Return the OfferEtos with the new, discounted price
private PaginatedListTo&lt;OfferEto&gt; getOfferEtosDiscount(PaginatedListTo&lt;OfferEntity&gt; offers) {
  offers = addDiscountToOffers(offers);
  return mapPaginatedEntityList(offers, OfferEto.class);
}

private PaginatedListTo&lt;OfferEntity&gt; addDiscountToOffers(PaginatedListTo&lt;OfferEntity&gt; offers) {
  for (OfferEntity oe : offers.getResult()) {
    Double oldPrice = oe.getPrice().getValue().doubleValue();

    // calculate the new price and round it to two decimal places
    BigDecimal newPrice = new BigDecimal(oldPrice * 0.75);
    newPrice = newPrice.setScale(2, RoundingMode.HALF_UP);

    oe.setPrice(new Money(newPrice));
  }

  return offers;
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="guidelines-for-a-successful-use-of-feature-toggles"><a class="anchor" href="#guidelines-for-a-successful-use-of-feature-toggles"></a>Guidelines for a successful use of feature-toggles</h5>
<div class="paragraph">
<p>The use of feature-toggles requires a specified set of guidelines to maintain the overview on the software. The following is a collection of considerations and examples for conventions that are reasonable to use.</p>
</div>
<div class="sect5">
<h6 id="minimize-the-number-of-toggles"><a class="anchor" href="#minimize-the-number-of-toggles"></a>Minimize the number of toggles</h6>
<div class="paragraph">
<p>When using too many toggles at the same time, it is hard to maintain a good overview of the system and things like finding bugs are getting much harder. Additionally, the management of toggles in the configuration interface gets more difficult due to the amount of toggles.</p>
</div>
<div class="paragraph">
<p>To prevent toggles from piling up during development, a toggle and the associated obsolete source code should be removed after the completion of the corresponding feature. In addition to that, the existing toggles should be revisited periodically to verify that these are still needed and therefore remove legacy toggles.</p>
</div>
</div>
<div class="sect5">
<h6 id="consistent-naming-scheme"><a class="anchor" href="#consistent-naming-scheme"></a>Consistent naming scheme</h6>
<div class="paragraph">
<p>A consistent naming scheme is the key to a structured and easily maintainable set of features. This should include the naming of toggles in the source code and the appropriate naming of commit messages in the VCS. The following section contains an example for a useful naming scheme including a small example.</p>
</div>
<div class="paragraph">
<p>Every Feature-Toggle in the system has to get its own unique name without repeating any names of features, which were removed from the system. The chosen names should be descriptive names to simplify the association between toggles and their purpose. If the feature should be split into multiple sub-features, you might want to name the feature like the parent feature with a describing addition. If for example you want to split the <code>DISCOUNT</code> feature into the logic and the UI part, you might want to name the sub-features <code>DISCOUNT_LOGIC</code> and <code>DISCOUNT_UI</code>.</p>
</div>
<div class="paragraph">
<p>The entry in the togglz configuration enum should be named identically to the aforementioned feature name. The explicitness of feature names prevents a confusion between toggles due to using multiple enums.</p>
</div>
<div class="paragraph">
<p>Commit messages are very important for the use of feature-toggles and also should follow a predefined naming scheme. You might want to state the feature name at the beginning of the message, followed by the actual message, describing what the commit changes to the feature. An example commit message could look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>DISCOUNT: Add the feature-toggle to the offermanagement implementation.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Mentioning the feature name in the commit message has the advantage, that you can search your git log for the feature name and get every commit belonging to the feature. An example for this using the tool <em>grep</em> could look like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>$ git log | grep -C 4 DISCOUNT

commit 034669a48208cb946cc6ba8a258bdab586929dd9
Author: Florian Luediger &lt;florian.luediger@somemail.com&gt;
Date:   Thu Jul 7 13:04:37 2016 +0100

DISCOUNT: Add the feature-toggle to the offermanagement implementation.</code></pre>
</div>
</div>
<div class="paragraph">
<p>To keep track of all the features in your software system, a platform like GitHub offers issues. When creating an issue for every feature, you can retrace, who created the feature and who is assigned to completing its development. When referencing the issue from commits, you also have links to all the relevant commits from the issue view.</p>
</div>
</div>
<div class="sect5">
<h6 id="placement-of-toggle-points"><a class="anchor" href="#placement-of-toggle-points"></a>Placement of toggle points</h6>
<div class="paragraph">
<p>To maintain a clean codebase, you definitely want to avoid using the same toggle in different places in the software. There should be one single query of the toggle which should be able to toggle the whole functionality of the feature. If one single toggle point is not enough to switch the whole feature on or off, you might want to think about splitting the feature into multiple ones.</p>
</div>
</div>
<div class="sect5">
<h6 id="use-of-fine-grained-features"><a class="anchor" href="#use-of-fine-grained-features"></a>Use of fine-grained features</h6>
<div class="paragraph">
<p>Bigger features in general should be split into multiple sub-features to maintain the overview on the codebase. These sub-features get their own feature-toggle and get implemented independently.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Accessibility</p>
</div>
<div class="paragraph">
<p>TODO</p>
</div>
<div class="paragraph">
<p><a href="http://www.w3.org/TR/WCAG20/" class="bare">http://www.w3.org/TR/WCAG20/</a></p>
</div>
<div class="paragraph">
<p><a href="http://www.w3.org/WAI/intro/aria" class="bare">http://www.w3.org/WAI/intro/aria</a></p>
</div>
<div class="paragraph">
<p><a href="http://www.einfach-fuer-alle.de/artikel/bitv/" class="bare">http://www.einfach-fuer-alle.de/artikel/bitv/</a></p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
devon4j-kafka has been abandoned. Its main feature was the implementation of a retry pattern using multiple topics. This implementation has become an integral part of Spring Kafka. We recommend to use Spring Kafkas own implemenation for retries.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>==Messaging Services</p>
</div>
<div class="paragraph">
<p>Messaging Services provide an asynchronous communication mechanism between applications. Technically this is implemented using <a href="http://kafka.apache.org/documentation.html">Apache Kafka</a> .</p>
</div>
<div class="paragraph">
<p>For <a href="spring">spring</a>, devonfw uses <a href="https://spring.io/projects/spring-kafka">Spring-Kafka</a> as kafka framework.
For more details, check the <a href="spring/guide-kafka-spring">devon4j-kafka</a>.</p>
</div>
<div class="paragraph">
<p>For <a href="quarkus">quarkus</a>, follow <a href="https://quarkus.io/guides/kafka">Quarkus - Kafka Reference Guide</a>.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Messaging</p>
</div>
<div class="paragraph">
<p>Messaging in Java is done using the <a href="https://en.wikipedia.org/wiki/Java_Message_Service">JMS</a> standard from JEE.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="products-2"><a class="anchor" href="#products-2"></a>Products</h5>
<div class="paragraph">
<p>For messaging you need to choose a JMS provider such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.rabbitmq.com/">RabbitMQ</a></p>
</li>
<li>
<p><a href="https://activemq.apache.org">ActiveMQ</a></p>
</li>
<li>
<p><a href="guide-oracle#messaging">Oracle Advanced Queuing</a> (esp. if you already use <a href="guide-oracle">Oracle RDBMS</a>)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="receiver"><a class="anchor" href="#receiver"></a>Receiver</h5>
<div class="paragraph">
<p>As a receiver of messages is receiving data from other systems it is located in the <a href="guide-service-layer">service-layer</a>.</p>
</div>
<div class="sect5">
<h6 id="jms-listener"><a class="anchor" href="#jms-listener"></a>JMS Listener</h6>
<div class="paragraph">
<p>A <code>JmsListener</code> is a class listening and consuming JMS messages. It should carry the suffix <code>JmsListener</code> and implement the <code>MessageListener</code> interface or have its listener method annotated with <code>@JmsListener</code>. This is illustrated by the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named
@Transactional
public class BookingJmsListener /* implements MessageListener */ {

  @Inject
  private Bookingmanagement bookingmanagement;

  @Inject
  private MessageConverter messageConverter;

  @JmsListener(destination = "BOOKING_QUEUE", containerFactory = "jmsListenerContainerFactory")
  public void onMessage(Message message) {
    try {
      BookingTo bookingTo = (BookingTo) this.messageConverter.fromMessage(message);
      this.bookingmanagement.importBooking(bookingTo);
    } catch (MessageConversionException | JMSException e) {
      throw new InvalidMessageException(message);
    }
  }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sender"><a class="anchor" href="#sender"></a>Sender</h5>
<div class="paragraph">
<p>The sending of JMS messages is considered as any other sending of data like <a href="guide-kafka">kafka</a> messages or RPC calls via <a href="guide-rest">REST</a> using <a href="guide-service-client">service-client</a>, gRPC, etc.
This will typically happen directly from a <a href="guide-usecase">use-case</a> in the <a href="guide-logic-layer">logic-layer</a>.
However, the technical complexity of the communication and protocols itself shall be hidden from the use-case and not be part of the logic layer.
With spring we can simply use <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/jms/core/JmsTemplate.html">JmsTemplate</a> to do that.</p>
</div>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Full Text Search</p>
</div>
<div class="paragraph">
<p>If you want to all your users fast and simple searches with just a single search field (like in google), you need full text indexing and search support.</p>
</div>
</div>
<div class="sect4">
<h5 id="solutions"><a class="anchor" href="#solutions"></a>Solutions</h5>
<div class="ulist">
<ul>
<li>
<p><a href="http://lucene.apache.org/">Lucene</a></p>
</li>
<li>
<p><a href="https://lucene.apache.org/core/4_4_0/analyzers-common/org/apache/lucene/analysis/ngram/NGramTokenizer.html">NGram</a></p>
</li>
<li>
<p><a href="http://lucene.apache.org/solr/">Solr</a></p>
</li>
<li>
<p><a href="https://www.elastic.co/products/elasticsearch">elastic-search</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Maybe you also want to use native features of your database</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://blogs.sap.com/2012/10/10/the-not-so-fuzzy-fuzzy-search/">SAP Hana Fuzzy Search</a></p>
</li>
<li>
<p><a href="https://www.oracle.com/technetwork/database/enterprise-edition/index-098492.html">Oracle Text</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="best-practices"><a class="anchor" href="#best-practices"></a>Best Practices</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tutorials"><a class="anchor" href="#tutorials"></a>1.78. Tutorials</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Creating a new application</p>
</div>
<div class="sect4">
<h5 id="running-the-archetype"><a class="anchor" href="#running-the-archetype"></a>Running the archetype</h5>
<div class="paragraph">
<p>In order to create a new application you must use the archetype provided by devon4j which uses the maven archetype functionality.</p>
</div>
<div class="paragraph">
<p>To create a new application, you should have installed devonfw IDE. Follow the devon ide documentation to install
the same.
You can choose between 2 alternatives, create it from command line or, in more visual manner, within eclipse.</p>
</div>
<div class="sect5">
<h6 id="from-command-line"><a class="anchor" href="#from-command-line"></a>From command Line</h6>
<div class="paragraph">
<p>To create a new devon4j application from command line, you can simply run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">devon java create com.example.application.sampleapp</code></pre>
</div>
</div>
<div class="paragraph">
<p>For low-level creation you can also manually call this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn -DarchetypeVersion=${devon4j.version} -DarchetypeGroupId=com.devonfw.java.templates -DarchetypeArtifactId=devon4j-template-server archetype:generate -DgroupId=com.example.application -DartifactId=sampleapp -Dversion=1.0.0-SNAPSHOT -Dpackage=com.devonfw.application.sampleapp</code></pre>
</div>
</div>
<div class="paragraph">
<p>Attention: The <code>archetypeVersion</code> (first argument) should be set to the latest version of <code>devon4j</code>. You can easily determine the version from this badge:
<span class="image"><img src="https://javadoc.io/badge2/com.devonfw.java.modules/devon4j-basic/javadoc.svg" alt="latest devon4j version"></span></p>
</div>
<div class="paragraph">
<p>Further providing additional properties (using <code>-D</code> parameter) you can customize the generated app:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. Options for app template</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>property</strong></th>
<th class="tableblock halign-left valign-top"><strong>comment</strong></th>
<th class="tableblock halign-left valign-top"><strong>example</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>dbType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Choose the type of RDBMS to use (<code>hana</code>, <code>oracle</code>, <code>mssql</code>, <code>postgresql</code>, <code>mariadb</code>, <code>mysql</code>, etc.)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-DdbTpye=postgresql</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>batch</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Option to add an <code>batch</code> module</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-Dbatch=batch</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="from-eclipse"><a class="anchor" href="#from-eclipse"></a>From Eclipse</h6>
<div class="literalblock">
<div class="content">
<pre>After that, you should follow this Eclipse steps to create your application:</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a new Maven Project.</p>
</li>
<li>
<p>Choose the devon4j-template-server archetype, just like the image.</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/images/eclipse-m2e-create-devon4j-project.png" alt="Select archetype">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Fill the Group Id, Artifact Id, Version and Package for your project.</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="_images/images/eclipse-m2e-create-devon4j-project-parameters.png" alt="Configure archetype">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Finish the Eclipse assistant and you are ready to start your project.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="what-is-generated"><a class="anchor" href="#what-is-generated"></a>What is generated</h5>
<div class="paragraph">
<p>The application template (archetype) generates a Maven multi-module project. It has the following modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>api</code>: module with the API (REST service interfaces, transferobjects, datatypes, etc.) to be imported by other apps as a maven dependency in order to invoke and consume the offered (micro)services.</p>
</li>
<li>
<p><code>core</code>: maven module containing the core of the application.</p>
</li>
<li>
<p><code>batch</code>: optional module for <a href="guide-batch-layer">batch</a>(es)</p>
</li>
<li>
<p><code>server</code>: module that bundles the entire app (<code>core</code> with optional <code>batch</code>) as a WAR file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The toplevel <code>pom.xml</code> of the generated project has the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Properties definition: Spring-boot version, Java version, etc.</p>
</li>
<li>
<p>Modules definition for the modules (described above)</p>
</li>
<li>
<p>Dependency management: define versions for dependencies of the technology stack that are recommended and work together in a compatible way.</p>
</li>
<li>
<p>Maven plugins with desired versions and configuration</p>
</li>
<li>
<p>Profiles for <a href="guide-testing">test stages</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="how-to-run-your-app"><a class="anchor" href="#how-to-run-your-app"></a>How to run your app</h5>
<div class="sect5">
<h6 id="run-app-from-ide"><a class="anchor" href="#run-app-from-ide"></a>Run app from IDE</h6>
<div class="paragraph">
<p>To run your application from your favourite IDE, simply launch <code>SpringBootApp</code> as java application.</p>
</div>
</div>
<div class="sect5">
<h6 id="run-app-as-bootified-jar-or-war"><a class="anchor" href="#run-app-as-bootified-jar-or-war"></a>Run app as bootified jar or war</h6>
<div class="paragraph">
<p>More details are available <a href="guide-structure-classic#deployment">here</a>.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Quarkus</p>
</div>
<div class="paragraph">
<p><a href="https://quarkus.io">Quarkus</a> is a Java framework for building cloud-native apps.
It is fully supported by <a href="https://devonfw.com">devonfw</a> as an option and alternative to <a href="spring">spring</a>.
Additional things like extensions will be available on the  <a href="https://github.com/devonfw/devon4quarkus">devon4quarkus</a> GitHub repository.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="guide-to-the-reader-2"><a class="anchor" href="#guide-to-the-reader-2"></a>1.79. Guide to the Reader</h3>
<div class="paragraph">
<p>Depending on your intention of reading this document, you might be more interested in the following chapters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you are completely new to Quarkus, you may be interested in the <a href="quarkus#pros">pros</a> and <a href="quarkus#cons">cons</a> of Quarkus. Also, take a look at the <a href="https://quarkus.io">official Quarkus website</a>. You might also be interested in the features that <a href="https://www.graalvm.org/">GraalVM</a> offers.</p>
</li>
<li>
<p>If you are new to devon4j, take a look at devon4j&#8217;s recommendations on general best practices. Check out the chapters on <a href="architecture">architecture design</a>, <a href="guide-structure-modern">project structuring</a>, and <a href="coding-conventions">coding conventions</a>. Follow the referenced links to explore a topic in more depth.</p>
</li>
<li>
<p>If you are an experienced Spring developer and want to get in touch with Quarkus, read our <a href="quarkus/getting-started-for-spring-developers">Getting started with Quarkus for Spring developers</a> guide.</p>
</li>
<li>
<p>If you&#8217;re looking to build your first Quarkus application, the Quarkus website offers some good <a href="https://quarkus.io/get-started/">getting started guides</a>. Also, check out our <a href="quarkus/quarkus-template">Quarkus template guide</a>, which gives you some recommendations on extensions and frameworks to use. It also provides some links to the <a href="https://code.quarkus.io/">Quarkus code generator</a> with preselected configurations you can use to create your application.</p>
</li>
<li>
<p>If you want to have a Quarkus sample application using devon4j recommendations, check out our <a href="https://github.com/devonfw-sample/devon4quarkus-reference">Quarkus reference application</a>.</p>
</li>
<li>
<p>If you have a Spring application and want to migrate it to Quarkus, take a look at our <a href="guide-migration-spring-quarkus">migration guide</a>.</p>
</li>
<li>
<p>If you already have some experience with devon4j and Quarkus and need more information on a specific topic, check out our <a href="devon4j#guides">Quarkus guides</a>. If you don&#8217;t find what you are looking for there, check out the <a href="devon4j#general">general section</a>. devon4j uses general solutions for Java, so solutions for both Quarkus and Spring are documented there.</p>
</li>
<li>
<p>If you want to learn how to build native images, check out <a href="quarkus/guide-native-image">this guide</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="pros"><a class="anchor" href="#pros"></a>1.80. Pros</h3>
<div class="paragraph">
<p>Quarkus offers the following benefits:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>fast turn-around cycles for developers</strong><br>
Save changes in your Java code and immediately test the results without restarting or waiting</p>
</li>
<li>
<p><strong>faster start-up and less memory footprint</strong><br>
When building your app as <a href="quarkus/guide-native-image">native-images</a> via <a href="https://www.graalvm.org/">GraalVM</a>, it gets highly optimized. As a result, it starts up lightning fast and consumes much less memory. This is a great advantage for cloud deployment as well as for sustainability. You can find a performance comparison between Spring and Quarkus <a href="performance-comparision-spring-quarkus">here</a>.</p>
</li>
<li>
<p><strong>clean and lean</strong>
As quarkus was born as a cloud-native framework, it is very light-weight and does not carry much history and legacy.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cons"><a class="anchor" href="#cons"></a>1.81. Cons</h3>
<div class="paragraph">
<p>Quarkus has the following drawbacks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>less flexible</strong><br>
Quarkus is less flexible compared to <a href="spring">spring</a>, or in other words, it is more biased and coupled to specific implementations. However, the implementations  work and you have less things to choose and worry about. However, in case you want to integrate a specific or custom library, you may hit limitations or lose support for <a href="quarkus/guide-native-image">native-images</a>, especially when that library is based on reflection. Therefore, check your requirements and technology stack early on when making your choice.</p>
</li>
<li>
<p><strong>less established</strong><br>
Since quarkus was born in 2019, it is modern but also less established. It will be easier to get developers for <a href="spring">spring</a>, but we already consider quarkus mature and established enough for building production-ready apps.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>==Quarkus Quickstart</p>
</div>
<div class="paragraph">
<p>This guide serves as a quickstart on how to create a Quarkus app, briefly presenting the key functionalities that Quarkus provides, both for beginners and experienced developers.</p>
</div>
<div class="sect3">
<h4 id="introduction-to-quarkus"><a class="anchor" href="#introduction-to-quarkus"></a>1.81.1. Introduction to Quarkus</h4>
<div class="paragraph">
<p>To get a first introduction to Quarkus, you can read the <a href="../quarkus">Quarkus introduction guide</a>. To get a brief overview of where you can find the important Quarkus related guides, follow the chapter <a href="../quarkus#guide-to-the-reader">guide to the reader</a>.
Also, see the comparison of the <a href="../quarkus#Pros">advantages</a> and <a href="../quarkus#cons">disadvantages</a> of a Quarkus application compared to the alternative framework Spring.
This comparison will be supported by our <a href="../performance-comparison-spring-quarkus">performance comparison between Spring and Quarkus</a>, which demonstrates the lower resource consumption and startup time of Quarkus applications.</p>
</div>
</div>
<div class="sect3">
<h4 id="installation-of-tools-and-dependencies"><a class="anchor" href="#installation-of-tools-and-dependencies"></a>1.81.2. Installation of Tools and Dependencies</h4>
<div class="paragraph">
<p>First, we need to install some dependencies and tools before we can start programming. Our tool <a href="https://devonfw.com/website/pages/docs/devonfw-ide-introduction.adoc.html">devonfw-ide</a> comes with many development tools for you.
We need to install the following tools for this guide:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maven</p>
</li>
<li>
<p>Java</p>
</li>
<li>
<p>any IDE (devonfw-ide supports Eclipse, Intellij and VScode)</p>
</li>
<li>
<p>Docker</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We recommend installing the devonfw-ide with the tools, but if you already have your system configured and the tools above installed, you can skip to <a href="#bootstrap-a-quarkus-project">Bootstrap a Quarkus Project</a>, otherwise we will show you how to set up and update your devonfw-ide.</p>
</div>
<div class="olist arabic">
<div class="title">devonfw-ide</div>
<ol class="arabic">
<li>
<p>Install devonfw-ide<br>
Follow the <a href="https://github.com/devonfw/ide/wiki/setup#setup">Setup</a> to install the devonfw-ide with Java, Maven, Eclipse and VScode.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Command to install Docker<br>
<code>devon docker setup</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Update devonfw-ide<br>
As we are still working on improving devonfw-ide, we recommend to update your already installed devonfw-ide and tools in order to include essential features for cloud development with Quarkus that you could be missing.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Use the commands <code>devon ide update</code>, <code>devon ide update software</code>, and <code>devon ide scripts</code> to update devonfw-ide and all installed software.</p>
</div>
<div class="paragraph">
<p>Go to the main folder under workspaces of the devonfw-ide installation.
We will create the project there.</p>
</div>
</div>
<div class="sect3">
<h4 id="bootstrap-a-quarkus-project"><a class="anchor" href="#bootstrap-a-quarkus-project"></a>1.81.3. Bootstrap a Quarkus Project</h4>
<div class="paragraph">
<p>Quarkus provides multiple ways to bootstrap a project.
The option to bootstrap a project via the command-line is shown in the Quarkus getting started guide <a href="https://quarkus.io/guides/getting-started#bootstrapping-the-project">Bootstrap the project</a>.
Quarkus also provides a project builder where you can select some extensions, the build tool for your project, and if you want, some starter code.
This will deliver a project skeleton with the configured project dependencies and also contributes the information to compile the application natively. To get some recommendations on starter templates, follow the guide on: <a href="guide-template">template recommendations</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By creating a Quarkus project from the command-line or with the project builder, you get a different project structure and have to adapt it to the devon4j conventions shown in the next Chapter.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="project-structure"><a class="anchor" href="#project-structure"></a>Project Structure</h5>
<div class="paragraph">
<p>We provide a recommendation and guideline for a <a href="../guide-structure-modern">modern project structure</a> to help organize your project into logically related modules.
In order to comply with the requirements of modern cloud development and microservice architectures, follow the guide and apply the modern project structure to your project. You can also find similar modules in our example projects.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="introduction-to-quarkus-functionality"><a class="anchor" href="#introduction-to-quarkus-functionality"></a>1.81.4. Introduction to Quarkus Functionality</h4>
<div class="paragraph">
<p>Before we start programming, you should first have a look at the functionality of Quarkus.</p>
</div>
<div class="olist arabic">
<div class="title">Quarkus functionality guides</div>
<ol class="arabic">
<li>
<p><a href="https://quarkus.io/guides/getting-started">Getting started guide from Quarkus</a><br>
This guide presents a good overview of the functionality of Quarkus. The simple <strong>Greeting Service</strong> gives a brief introduction into concepts like CDI, testing, dev mode, packaging, and running the app.</p>
</li>
<li>
<p>From Spring to Quarkus<br>
For experienced Spring developers that have already followed devon4j guidelines, you can read our guide to <a href="getting-started-for-spring-developers">getting started with Quarkus for Spring developer</a>, as it goes more into the differences that can give you a more detailed comparison to Spring.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Migrate a Spring app to Quarkus<br>
This guide shows how to <a href="../guide-migration-spring-quarkus">migrate a Spring application to a Quarkus application with devon4j conventions</a>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="create-a-rest-service"><a class="anchor" href="#create-a-rest-service"></a>1.81.5. Create a REST service</h4>
<div class="paragraph">
<p>Now let&#8217;s create our first REST CRUD service with Quarkus.
We give you the options of using a guide to start to code the service yourself or to just download a service that&#8217;s ready to use.</p>
</div>
<div class="olist arabic">
<div class="title">Options</div>
<ol class="arabic">
<li>
<p>Create the service yourself<br>
There is a good Quarkus guide for a simple <a href="https://quarkus.io/guides/rest-json#creating-your-first-json-rest-service">JSON REST service</a> that will guide you through your first application and help you with implement the definition of endpoints with JAX-RS and an Entity that will be managed by the service, and also how to <a href="https://quarkus.io/guides/rest-json#json">configure the JSON support</a>.</p>
</li>
<li>
<p>Use an existing Quarkus project<br>
You don&#8217;t want to code a service and just want to test some Quarkus functionalities? Just load a Quarkus <a href="https://github.com/quarkusio/quarkus-quickstarts#quick-start-list">sample project</a> provided for every existing quickstart guide and the supported framework.
Our Team also provides some Quarkus applications that are working and can be loaded and tested.</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw-sample/devon4quarkus-reference">reference project</a> is a service that manages products. It contains the devon4j modern project structure, pagination, queries, a Postgres database, SwaggerUI, and support for Kubernetes deploy. To add OpenTelemetry support, see the following <a href="https://github.com/devonfw-sample/devon4quarkus-reference/blob/master/documentation/opentelemetry-deployment.adoc">guide</a>.
This project will be steadily improved and is used to showcase the abilities of Quarkus with devon4j.</p>
</li>
<li>
<p><a href="https://github.com/devonfw-sample/devon4quarkus-minimal">minimal Quarkus project</a> is just the Quarkus project from a <a href="https://quarkus.io/guides/getting-started">getting started with Quarkus</a> guide with a <strong>Greeting Services</strong> modified with the correct modern structure mentioned in the chapter <a href="#project-structure">Project Structure</a></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="openapi-generation-2"><a class="anchor" href="#openapi-generation-2"></a>1.81.6. OpenAPI generation</h4>
<div class="paragraph">
<p>We provide a guide with a short introduction to the <a href="../guide-openaoi">OpenAPI specification</a> with two plugins that are important in a Quarkus Context.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="../guide-openaoi#smallrye-openapi">Smallrye Openapi supported by quarkus</a></p>
</li>
<li>
<p><a href="../guide-openaoi#servicedocgen-maven-plugin">servicedocgen Maven Plugin</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A more detailed usage guide to the Smallrye Plugin is provided by <a href="https://quarkus.io/guides/openapi-swaggerui">Quarkus OpenAPI and Swagger guide</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="how-to-integrate-a-database"><a class="anchor" href="#how-to-integrate-a-database"></a>1.81.7. How to Integrate a Database</h4>
<div class="paragraph">
<p>The next step for our REST service would be to integrate a database to store the objects of the entity.</p>
</div>
<div class="paragraph">
<p>With Quarkus, adding a database can be easy, because Quarkus can take over the build-up and connection process.
First, you should understand our guides on the concepts of working with data. Then, we will show how to integrate a database with Quarkus.</p>
</div>
<div class="olist arabic">
<div class="title">Data Principles Guides</div>
<ol class="arabic">
<li>
<p>General devon4j JPA guide<br>
To get an insight into the general JPA usage, read the <a href="../guide-jpa">JPA guide</a> containing a general explanation of the Java Persistence API.</p>
</li>
<li>
<p>Difference to SpringData<br>
If you have already worked with SpringData, this is also partially supported with Quarkus. This is explained in more detail in this <a href="../guide-repository">SpringData Guide</a>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Database Integration</div>
<ol class="arabic">
<li>
<p>Quarkus zero config dev mode<br>
Starting with the database implementation in Quarkus, we recommend for beginners to use the <a href="https://quarkus.io/guides/datasource#dev-services">DEV mode Zero Config Setup (Dev Services)</a>. This is especially great for testing the code without a database set up.
Quarkus does all the work for you and configures a database and creates the database and tables (schemas) for you.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Configuration Properties<br>
A list of all database configuration properties for the <a href="https://quarkus.io/guides/datasource#configuring-dev-services">Dev services</a></p>
</li>
</ol>
</div>
</li>
<li>
<p>Integrate a simple Hibernate ORM database<br>
The zero config setup only works with the Dev mode, it&#8217;s comfortable in the first phases of the creation of your service but if the goal is to also get a deployable version, you have to create your own database and integrate it.
This Quarkus guide shows, how to integrate a <a href="https://quarkus.io/guides/hibernate-orm">Hibernate ORM database</a> with an example service.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Configuration list for JDBC<br>
A list of all configuration that is possible with a <a href="https://quarkus.io/guides/datasource#jdbc-configuration">JDBC configuration properties</a></p>
</li>
</ol>
</div>
</li>
<li>
<p>Reactive CRUD application with Panache<br>
Quarkus unifies reactive and imperative programming.
Reactive is an architectural principle to build robust, efficient, and concurrent applications.
For an introduction into reactive and how Quarkus enables it, follow this <a href="https://quarkus.io/guides/quarkus-reactive-architecture">Quarkus reactive architecture</a> article and also the <a href="https://quarkus.io/guides/getting-started-reactive">reactive quickstart</a>.
To get started with reactive and implement reactive methods, you can follow the <a href="https://quarkus.io/guides/hibernate-reactive-panache">Quarkus reactive guide</a>.
The reactive guide uses the Quarkus based implementation of a Hibernate ORM called Panache.
The implementation is not our first choice with devon4j and therefore not part of our recommendations, but to understand the reactive guide you can read the <a href="https://quarkus.io/guides/hibernate-orm-panache">Hibernate ORM with Panache guide</a> first to prevent possible problems following the guide.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You need an installed Docker version for the <a href="https://quarkus.io/guides/datasource#dev-services">zero config setup</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Database Migration</div>
<p>For schema-based databases, we recommend migrating databases with Flyway.
In that case, our <a href="../guide-database-migration">general migration guide</a> can give you an overview if you are not familiar with migration.
.. Flyway guide for Quarkus
This Quarkus guide will show how to work with the <a href="https://quarkus.io/guides/flyway">Flyway extension in a Quarkus application</a>.
This should be used if you start your own database and do not leave the creation to quarkus.</p>
</div>
</div>
<div class="sect3">
<h4 id="testing-a-quarkus-application"><a class="anchor" href="#testing-a-quarkus-application"></a>1.81.8. Testing a Quarkus Application</h4>
<div class="paragraph">
<p>After we have built the service, we have to verify it with some tests.
We will give you some guidelines to implement some test cases.</p>
</div>
<div class="olist arabic">
<div class="title">Testing Guides</div>
<ol class="arabic">
<li>
<p>General testing guide<br>
For users that aren&#8217;t familiar with the devon4j testing principles, we created a general <a href="../guide-testing">best practices and recommendations guide for testing</a>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Our guide for testing with Quarkus
In addition, we also provide a guide that specifically addresses the <a href="guide-for-testing">testing of a Quarkus application</a>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Most of the Quarkus applications are already equipped with a basic test and our <a href="https://github.com/devonfw-sample/devon4quarkus-reference">reference project</a> provides some further test cases. If you want to improve and extend the tests, you can also follow the large <a href="https://quarkus.io/guides/getting-started-testing">Quarkus guide for testing</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="packaging-of-a-quarkus-application-and-creation-of-a-native-executable"><a class="anchor" href="#packaging-of-a-quarkus-application-and-creation-of-a-native-executable"></a>1.81.9. Packaging of a Quarkus application and creation of a native executable</h4>
<div class="paragraph">
<p>Quarkus applications can be packaged into different file types. The following link will show you how to build them and give you a short explanation of the characteristics of these files.</p>
</div>
<div class="olist arabic">
<div class="title">Package types</div>
<ol class="arabic">
<li>
<p><a href="https://quarkus.io/guides/maven-tooling#fast-jar">fast-jar</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/maven-tooling#remote-development-mode">mutable-jar</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/maven-tooling#uber-jar-maven">uber-jar</a></p>
</li>
<li>
<p><a href="guide-native-image">native executable</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To package an application, use the command <code>mvn package</code> and Quarkus will generate the output in the <strong>/target</strong> folder. For the native executables, the command needs more parameters, which is explained in the link above.</p>
</div>
<div class="paragraph">
<p>Configure the Output with these <a href="https://quarkus.io/guides/maven-tooling#configuration-reference">configuration properties</a></p>
</div>
</div>
<div class="sect3">
<h4 id="create-and-build-a-docker-image"><a class="anchor" href="#create-and-build-a-docker-image"></a>1.81.10. Create and build a Docker Image</h4>
<div class="paragraph">
<p>Quarkus supports Jib, S2I and <a href="https://www.docker.com/">Docker</a> for building images. We focus on building a Quarkus App with Docker.
You get a generated Dockerfile from Quarkus in the src/main/docker folder of any project generated from Quarkus. There are multiple Dockerfiles.</p>
</div>
<div class="olist arabic">
<div class="title">Dockerfiles</div>
<ol class="arabic">
<li>
<p>Dockerfile.jvm<br>
Dockerfile for Quarkus application in the JVM mode. running in <strong>Red Hat Universal Base Image 8 Minimal Container</strong></p>
</li>
<li>
<p>Dockerfile.legacy-jar<br>
DockerFile for Quarkus application in JVM mode with the legacy jar <strong>running in Red Hat Universal Base Image 8 Minimal Container</strong>.</p>
</li>
<li>
<p>Dockerfile.native<br>
Dockerfile using the native executable running in <strong>Red Hat Universal Base Image 8 Minimal container</strong>.</p>
</li>
<li>
<p>Dockerfile.native-distroless
The native file will run in a <strong>Distroless container</strong>. Distroless images are very small containers with just the application and runtime dependencies and without the other programs that come with a Linux distribution.</p>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>For more information to the different executables go back to the chapter <a href="#packaging-of-a-quarkus-application-and-creation-of-a-native-executable">Packaging of a Quarkus application and creation of a native executable</a></p>
</div>
</div>
</div>
<div class="paragraph">
<p>To simply build and run a Docker image, you can follow the instructions Quarkus provides for every Dockerfile in the comments block.</p>
</div>
<div class="paragraph">
<p>Docker commands example for the JVM Dockerfile from our <a href="https://github.com/devonfw-sample/devon4quarkus-reference">reference project</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre>####
##This Dockerfile is used in order to build a container that runs the Quarkus application in JVM mode
#
##Before building the container image run:
#
##./mvnw package
#
##Then, build the image with:
#
##docker build -f src/main/docker/Dockerfile.jvm -t quarkus/quarkus-basics-jvm .
#
##Then run the container using:
#
##docker run -i --rm -p 8080:8080 quarkus/quarkus-basics-jvm
#
##If you want to include the debug port into your docker image
##you will have to expose the debug port (default 5005) like this :  EXPOSE 8080 5050
#
##Then run the container using :
#
##docker run -i --rm -p 8080:8080 -p 5005:5005 -e JAVA_ENABLE_DEBUG="true" quarkus/quarkus-basics-jvm
#
###</pre>
</div>
</div>
<div class="paragraph">
<p>Quarkus is also able to build the image while packaging the application, so you don&#8217;t have to execute the command from above.
To perform Docker builds with the generated Dockerfiles from above, you need to add the following extension to your project with the command <code>mvn quarkus:add-extension -Dextensions="container-image-docker"</code>.</p>
</div>
<div class="paragraph">
<p>You also have to set the <strong>quarkus.container-image.build=true</strong>. You can add this to your <strong>application.properties</strong> or just append it to the packaging command like this: <code>./mvn package -Dquarkus.container-image.build=true</code>.</p>
</div>
<div class="paragraph">
<p>If your needs exceed the instructions given by the file, we recommend to follow the Docker <a href="https://docs.docker.com/get-started/">getting started guide</a> to get familiar with Docker and customize the Dockerfiles according to your needs.
To specify your container build, you can use the <a href="https://quarkus.io/guides/container-image#container-image-options">general container image configurations properties</a> and the <a href="https://quarkus.io/guides/container-image#docker-options">Docker image configurations properties</a> when building and runnig Docker images.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Migrate from Spring to Quarkus</p>
</div>
<div class="paragraph">
<p>This guide will cover the migration process of a Spring application to a Quarkus application. There are already articles about migrating from Spring to Quarkus (e.g. <a href="https://developers.redhat.com/blog/2020/04/10/migrating-a-spring-boot-microservices-application-to-quarkus" class="bare">https://developers.redhat.com/blog/2020/04/10/migrating-a-spring-boot-microservices-application-to-quarkus</a>, <a href="https://dzone.com/articles/migrating-a-spring-boot-application-to-quarkus-cha" class="bare">https://dzone.com/articles/migrating-a-spring-boot-application-to-quarkus-cha</a>).
This guide will focus more on the devon4j specific aspects. We assume that a working Spring application exists, built in the <a href="guide-structure-classic">classic devon4j specific way</a> (e.g. <a href="https://github.com/devonfw/jump-the-queue/tree/master/java/jtqj">Jump The Queue</a> or <a href="https://github.com/devonfw/my-thai-star">My Thai Star</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="create-the-quarkus-application"><a class="anchor" href="#create-the-quarkus-application"></a>1.81.11. Create the Quarkus application</h4>
<div class="paragraph">
<p>We start with an empty Quarkus project. You can create the project with Maven on the command line or use the <a href="https://code.quarkus.io/">online generator</a>. The advantage of the online generator is that you have a pre-selection of dependencies to use in your project.
For starters, let&#8217;s select the basic dependencies required to develop a REST service with database connectivity (you can use one of the links in the <a href="quarkus/quarkus-template">Quarkus template guide</a>): <em>RESTEasy JAX-RS, RESTEasy Jackson, Hibernate ORM, Spring Data JPA API, JDBC Driver (choose the type of database you need), Flyway (if you have database migration schemas), SmallRye Health (optional for Health Monitoring)</em></p>
</div>
<div class="paragraph">
<p>The list does not include all required dependencies. We will add more dependencies to the project later. For now, generate the application with these dependencies.</p>
</div>
<div class="sect4">
<h5 id="migration-toolkit-from-red-hat"><a class="anchor" href="#migration-toolkit-from-red-hat"></a>Migration Toolkit from Red Hat</h5>
<div class="paragraph">
<p>Red Hat provides a migration toolkit (<a href="https://developers.redhat.com/products/mta/overview">MTA, Migration Toolkit for Applications</a>), that supports migration of a Spring to a Quarkus application. There are several versions of this toolkit (e.g., a web console, a Maven plugin, or an IDE plugin).
The MTA analyzes your existing application and generates a report with hints and instructions for migrating from Spring to Quarkus. For example, it gives you an indication of which dependencies are not supported in your project for a Quarkus application and which dependencies you need to swap them with. The analysis is rule-based, and you can also add your own rules that will be checked during analysis.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="entities"><a class="anchor" href="#entities"></a>1.81.12. Entities</h4>
<div class="paragraph">
<p>There is nothing special to consider when creating the entities. In most cases, you can simply take the code from your Spring application and use it for your Quarkus application. Usually, the entities extend a superclass <code>ApplicationPersistenceEntity</code> containing, for example, the <code>id</code> property. You can also take this class from your Spring application and reuse it.</p>
</div>
</div>
<div class="sect3">
<h4 id="transfer-objects"><a class="anchor" href="#transfer-objects"></a>1.81.13. Transfer objects</h4>
<div class="paragraph">
<p>The next step is to create the appropriate transfer objects for the entities. In a devon4j Spring application, we would use CobiGen to create these classes. Since CobiGen is not usable for this purpose in Quarkus applications yet, we have to create the classes manually.</p>
</div>
<div class="paragraph">
<p>First, we create some abstract base classes for the search criteria and DTO classes. Normally, these would also be created by CobiGen.</p>
</div>
<div class="listingblock">
<div class="title">Listing 24. <strong>AbstractSearchCriteriaTo</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class AbstractSearchCriteriaTo extends AbstractTo {

  private static final long serialVersionUID = 1L;

  private Pageable pageable;

  //getter + setter for pageable
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 25. <strong>AbstractDto</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public abstract class AbstractDto extends AbstractTo {

  private static final long serialVersionUID = 1L;

  private Long id;

  private int modificationCounter;

  public AbstractDto() {

    super();
  }

  //getter + setter

  @Override
  protected void toString(StringBuilder buffer) {
    ...
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The class <code>AbstractTo</code>, extended by other classes, would be provided by the <a href="https://github.com/devonfw/devon4j/tree/master/modules/basic"><code>devon4j-basic</code></a> module in a devon4j Spring application. You can take the code from <a href="https://github.com/devonfw/devon4j/blob/master/modules/basic/src/main/java/com/devonfw/module/basic/common/api/to/AbstractTo.java">here</a> and reuse it in your Quarkus project.</p>
</div>
<div class="paragraph">
<p>Now you can create your transfer objects. Most of the code of the transfer objects of your Spring application should be reusable. For Quarkus, we recommend (as mentioned <a href="guide-dto">here</a>) to use <code>*Dto</code> instead of <code>*Eto</code> classes. Be sure to change the names of the classes accordingly.</p>
</div>
</div>
<div class="sect3">
<h4 id="data-access-layer"><a class="anchor" href="#data-access-layer"></a>1.81.14. Data Access Layer</h4>
<div class="paragraph">
<p>In devon4j, we propose to use <a href="guide-repository">Spring Data JPA</a> to build the data access layer using repositories and Querydsl to build <a href="guide-jpa-query#dynamic-queries">dynamic queries</a>. We will also use this approach for Quarkus applications, but we need to change the implementation because the devon4j modules are based on reflection, which is not suitable for Quarkus.
In Quarkus we will use Querydsl using code generation. So for this layer, more changes are required and we can&#8217;t just take the existing code.</p>
</div>
<div class="paragraph">
<p>First, create a repository interface for your entity class that extends <code>JpaRepository</code> (see <a href="guide-repository#repository">here</a>).</p>
</div>
<div class="paragraph">
<p>To add QueryDSL support to your project, add the following dependencies to your pom.xml file:</p>
</div>
<div class="listingblock">
<div class="title">Listing 26. <strong>pom.xml</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;com.querydsl&lt;/groupId&gt;
  &lt;artifactId&gt;querydsl-jpa&lt;/artifactId&gt;
  &lt;version&gt;4.3.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;com.querydsl&lt;/groupId&gt;
  &lt;artifactId&gt;querydsl-apt&lt;/artifactId&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
  &lt;version&gt;4.3.1&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>As mentioned above, we will use QueryDSL with code generation. For this, add the QueryDSL annotation processor to your plugins:</p>
</div>
<div class="listingblock">
<div class="title">Listing 27. <strong>pom.xml</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;plugins&gt;
...
  &lt;plugin&gt;
    &lt;groupId&gt;com.mysema.maven&lt;/groupId&gt;
    &lt;artifactId&gt;apt-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.1.3&lt;/version&gt;
    &lt;executions&gt;
      &lt;execution&gt;
        &lt;phase&gt;generate-sources&lt;/phase&gt;
        &lt;goals&gt;
          &lt;goal&gt;process&lt;/goal&gt;
        &lt;/goals&gt;
        &lt;configuration&gt;
          &lt;outputDirectory&gt;target/generated-sources/annotations&lt;/outputDirectory&gt;
          &lt;processor&gt;com.querydsl.apt.jpa.JPAAnnotationProcessor&lt;/processor&gt;
        &lt;/configuration&gt;
      &lt;/execution&gt;
    &lt;/executions&gt;
  &lt;/plugin&gt;
&lt;/plugins&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To implement the queries, follow the <a href="guide-jpa-query#dynamic-queries">corresponding guide</a>.</p>
</div>
<div class="paragraph">
<p>Set the following properties in the application.properties file to configure the connection to your database (see also <a href="quarkus/guide-quarkus-configuration#database-configuration">here</a>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.datasource.db-kind=...
quarkus.datasource.jdbc.url=...
quarkus.datasource.username=...
quarkus.datasource.password=...</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="logic-layer"><a class="anchor" href="#logic-layer"></a>1.81.15. Logic Layer</h4>
<div class="paragraph">
<p>For the logic layer, devon4j uses a <a href="guide-usecase">use-case approach</a>. You can reuse the use case interfaces from the api module of the Spring application. Again, make sure to rename the transfer objects.</p>
</div>
<div class="paragraph">
<p>Create the appropriate class that implements the interface. Follow the <a href="guide-usecase#implementation">implementation section</a> of the use-case guide to implement the methods. For mapping the entities to the corresponding transfer objects, see the next section.</p>
</div>
</div>
<div class="sect3">
<h4 id="mapping"><a class="anchor" href="#mapping"></a>1.81.16. Mapping</h4>
<div class="paragraph">
<p>For bean mapping, we need to use a completely different approach in the Quarkus application than in the Spring application. For Quarkus, we use MapStruct, which creates the mapper at build time rather than at runtime using reflection. Add the following dependencies to your pom.xml.</p>
</div>
<div class="listingblock">
<div class="title">Listing 28. <strong>pom.xml</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.mapstruct&lt;/groupId&gt;
  &lt;artifactId&gt;mapstruct-processor&lt;/artifactId&gt;
  &lt;version&gt;1.4.2.Final&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.mapstruct&lt;/groupId&gt;
  &lt;artifactId&gt;mapstruct&lt;/artifactId&gt;
  &lt;version&gt;1.4.2.Final&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you can create the mapper as follows:</p>
</div>
<div class="listingblock">
<div class="title">Listing 29. <strong>Mapper</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Mapper(componentModel = "cdi")
public interface YourEntityMapper {
  YourEntityDto map(YourEntity entity);

  YourEntity map(YourEntityDto dto);

  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Inject the mapper into your use-case implementation and simply use the methods. The method implementations of the mapper are created when the application is built.</p>
</div>
</div>
<div class="sect3">
<h4 id="service-layer"><a class="anchor" href="#service-layer"></a>1.81.17. Service Layer</h4>
<div class="paragraph">
<p>For the implementation of the service layer, we use the <a href="guide-rest#jax-rs">JAX-RS</a> for both Quarkus and Spring applications to create the REST services. Classic devon4j Spring applications rely on Apache CFX as the implemention of JAX-RS.
For Quarkus, we use RESTEasy. Since both are implementations of JAX-RS, much of the Spring application code can be reused.</p>
</div>
<div class="paragraph">
<p>Take the definition of the REST endpoints from the api module of the Spring application (make sure to rename the transfer objects), inject the use-cases from the logic layer and use them in the REST service methods as follows:</p>
</div>
<div class="listingblock">
<div class="title">Listing 30. <strong>REST service</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Path("/path/v1")
public class YourComponentRestService {

  @Inject
  UcFindYourEntity ucFindYourEntity;

  @Inject
  UcManageYourEntity ucManageYourEntity;

  @GET
  @Path("/yourEntity/{id}/")
  public YourEntityDto getYourEntity(@PathParam("id") long id);

    return this.ucFindYourEntity.findYourEntity(id);
  }

  ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="summary"><a class="anchor" href="#summary"></a>1.81.18. Summary</h4>
<div class="paragraph">
<p>As you have seen, some parts hardly differ when migrating a Spring application to a Quarkus application, while other parts differ more. The above sections describe the parts needed for simple applications that provide REST services with a data access layer.
If you add more functionality, more customization and other frameworks, dependencies may be required. If that is the case, take a look at the corresponding guide on the topic in the devon4j documentation or check if there is a tutorial on the official <a href="https://quarkus.io/guides/">Quarkus website</a>.</p>
</div>
<div class="paragraph">
<p>Furthermore, we can summarize that migrating from a Spring application to a Quarkus representative is not complex. Although Quarkus is a very young framework (release 1.0 was in 2019), it brings a lot of proven standards and libraries that you can integrate into your application.
This makes it easy to migrate and reuse code from existing (Spring) applications. Also, Quarkus comes with Spring API compatibility for many Spring modules (<a href="https://quarkus.io/guides/spring-data-jpa">Spring Data JPA</a>, <a href="https://quarkus.io/guides/spring-di">Spring DI</a>, <a href="https://github.com/quarkusio/quarkus/tree/main/extensions">etc.</a>), which makes it easier for developers to reuse their knowledge.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Spring Native vs Quarkus</p>
</div>
<div class="paragraph">
<p>Nowadays, it is very common to write an application and deploy it to a cloud.
Serverless computing and Function-as-a-Service (FaaS) have become
very popular.
While many challenges arise when deploying a Java application into the latest cloud environment, the biggest challenges facing developers are memory footprint and the startup time required
for the Java application, as more of these keeps the host&#8217;s costs high in public clouds and Kubernetes clusters. With the introduction of frameworks like micronaut and microprofile, Java processes are getting faster and more lightweight. In a similar context, Spring has introduced
<a href="https://docs.spring.io/spring-native/docs/current/reference/htmlsingle/#overview">Spring Native</a> which aims to solve the big memory footprint of Spring and its slow startup time to potentially rival the new framework called <a href="https://quarkus.io">Quarkus</a>, by Red Hat. This document briefly discusses both of these two frameworks and their potential suitability with devonfw.</p>
</div>
</div>
<div class="sect3">
<h4 id="quarkus-2"><a class="anchor" href="#quarkus-2"></a>1.81.19. Quarkus</h4>
<div class="paragraph">
<p>Quarkus is a full-stack, Kubernetes-native Java framework made for JVMs. With its container-first-philosophy and its native compilation with GraalVM, Quarkus optimizes Java for containers with low memory usage and fast startup times.</p>
</div>
<div class="paragraph">
<p>Quarkus achieves this in the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>First Class Support for GraalVM</strong></p>
</li>
<li>
<p><strong>Build Time Metadata Processing:</strong> As much processing as possible is
done at build time, so your application will only contain the classes
that are actually needed at runtime. This results in less memory usage,
and also faster startup time, as all metadata processing has already been
done.</p>
</li>
<li>
<p><strong>Reduction in Reflection Usage:</strong> Quarkus tries to avoid reflection as much as possible in order to reduce startup time and memory usage.</p>
</li>
<li>
<p><strong>Native Image Pre Boot:</strong> When running in a native image, Quarkus
pre-boots as much of the framework as possible during the native image
build process. This means that the resulting native image has already
run most of the startup code and serialized the result into the
executable, resulting in an even faster startup-time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This gives Quarkus the potential for a great platform for serverless cloud and Kubernetes environments. For more information about Quarkus and its support for devonfw please refer to the <a href="quarkus">Quarkus introduction guide</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="spring-native-2"><a class="anchor" href="#spring-native-2"></a>1.81.20. Spring Native</h4>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>The current version of Spring Native 0.10.5 is designed to be used with Spring Boot 2.5.6</strong></p>
</div>
</div>
</div>
<div class="paragraph">
<p>Like Quarkus, Spring Native provides support for compiling Spring applications to native executables using the GraalVM native-image compiler deisgned to be packaged in lightweight containers.</p>
</div>
<div class="paragraph">
<p>Spring Native is composed of the following modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>spring-native:</strong> runtime dependency required for running Spring Native, provides also Native hints API.</p>
</li>
<li>
<p><strong>spring-native-configuration:</strong> configuration hints for Spring classes used by Spring AOT plugins, including various Spring Boot auto-configurations.</p>
</li>
<li>
<p><strong>spring-native-docs:</strong> reference guide, in adoc format.</p>
</li>
<li>
<p><strong>spring-native-tools:</strong> tools used for reviewing image building configuration and output.</p>
</li>
<li>
<p><strong>spring-aot:</strong> AOT transformation infrastructure common to Maven and Gradle plugins.</p>
</li>
<li>
<p><strong>spring-aot-test:</strong> Test-specific AOT transformation infrastructure.</p>
</li>
<li>
<p><strong>spring-aot-gradle-plugin:</strong> Gradle plugin that invokes AOT transformations.</p>
</li>
<li>
<p><strong>spring-aot-maven-plugin:</strong> Maven plugin that invokes AOT transformations.</p>
</li>
<li>
<p><strong>samples:</strong> contains various samples that demonstrate features usage and are used as integration tests.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="native-compilation-with-graalvm"><a class="anchor" href="#native-compilation-with-graalvm"></a>1.81.21. Native compilation with GraalVM</h4>
<div class="paragraph">
<p>Quarkus and Spring Native both use GraalVM for native compilation. Using a native image provides some key advantages, such as instant startup, instant peak performance, and reduced memory consumption. However, there are also some drawbacks: Creating a native image is a heavy process that is slower than a regular application. A native image also has fewer runtime optimizations after its warmup. Furthermore, it is less mature than the JVM and comes with some different behaviors.</p>
</div>
<div class="paragraph">
<p><strong>Key characteristics:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Static analysis of the application from the main entry point is
performed at build time.</p>
</li>
<li>
<p>Unused parts are removed at build time.</p>
</li>
<li>
<p>Configuration required for reflection, resources, and dynamic proxies.</p>
</li>
<li>
<p>Classpath is fixed at build time.</p>
</li>
<li>
<p>No class lazy loading: everything shipped in the executables will be loaded in memory on startup.</p>
</li>
<li>
<p>Some code will run at build time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are <a href="https://github.com/oracle/graal/blob/master/docs/reference-manual/native-image/Limitations.md">limitations</a> around some aspects of Java applications that are not fully supported</p>
</div>
</div>
<div class="sect3">
<h4 id="build-time-and-start-time-for-apps"><a class="anchor" href="#build-time-and-start-time-for-apps"></a>1.81.22. Build time and start time for apps</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Framework</th>
<th class="tableblock halign-left valign-top">build time</th>
<th class="tableblock halign-left valign-top">start time</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Native</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">19.615s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.913s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quarkus Native executable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">52.818s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.802s</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="memory-footprints"><a class="anchor" href="#memory-footprints"></a>1.81.23. Memory footprints</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Framework</th>
<th class="tableblock halign-left valign-top">memory footprint</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring Native</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">109 MB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quarkus Native executable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">75 MB</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="considering-devonfw-best-practices"><a class="anchor" href="#considering-devonfw-best-practices"></a>1.81.24. Considering devonfw best practices</h4>
<div class="paragraph">
<p>As of now, devonfw actively supports Spring but not Spring Native.
Although Quarkus has been released to a stable release in early 2021, it has been already used in multiple big projects successfully showing its potential to implement cloud native services with low resource consumption matching the needs of scalability and resilience in cloud native environments.
With major stakeholders behind the open source community like Red Hat, its development and growth from its kickoff to the current state is very impressive and really shows the market needs and focus.
Another big advantage of Quarkus is that it started on a green field and therefore did not need to circumvent main pillars of the spring framework like reflection, being able to take clean and up-to-date design decisions not needing to cope with legacy issues.
Nonetheless, there is a experimental support also for some spring libraries already available in Quarkus, which make switching from spring to Quarkus much more easier if needed.
We also provide a <a href="quarkus/getting-started-for-spring-developers">guide
for Spring developers</a> who want to adopt or try Quarkus for their
(next) projects as it really has some gamechanging advantages over
Spring.</p>
</div>
</div>
<div class="sect3">
<h4 id="general-recommendations-and-conclusion"><a class="anchor" href="#general-recommendations-and-conclusion"></a>1.81.25. General recommendations and conclusion</h4>
<div class="paragraph">
<p>Quarkus and Spring Native both have their own use cases. Under the consideration of the limitations of GraalVM to be used for native images built by Quarkus and Spring Native, there is a strong recommendation towards Quarkus from devonfw.
One essential differentiation has to be made on the decision for native or against native applications - the foreseen performance optimization of the JIT compiler of the JVM, which is not available anymore in a native image deployment.
For sure, both component frameworks will also run on a JVM getting advantage again from JIT compilation, but depending on the overall landscape then, it is recommended to stay with the knowledge of the available teams, e.g. continue making use of devon4j based on spring or even if already in that state also here make use of Quarkus on JVM.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Modern project structure</p>
</div>
<div class="paragraph">
<p>With trends such as cloud, microservices, lean, and agile, we decided for a more modern project structure that fits better to recent market trends.
When starting new projects with devonfw, and especially in the context of cloud-native development, we strongly recommend this modern approach over the <a href="guide-structure-classic">classic structure</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="modules-2"><a class="anchor" href="#modules-2"></a>1.81.26. Modules</h4>
<div class="paragraph">
<p>Due to trends such as microservices, we are building smaller apps compared to moduliths.
For simplicity, we therefore do not split our app into different modules and keep everything top-level and easy.</p>
</div>
<div class="paragraph">
<p>In addition to <code>java</code> and <code>resources</code>, we also add <code>helm</code> for helm templates and <code>docker</code> for docker scripts (e.g. <code>Dockerfile</code>) in <code>src/main</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>├──/src
|  ├──/main
|  |  ├──/docker
|  |  ├──/helm
|  |  ├──/java
|  |  └──/resources
|  └──/test
|     ├──/java
|     └──/resources
└──/pom.xml</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deployment-2"><a class="anchor" href="#deployment-2"></a>1.81.27. Deployment</h4>
<div class="paragraph">
<p>For modern projects, we strongly recommend that your build process generates the final deliverable as an OCI compliant container.
Further, to go fully cloud-native, you should build your app as a native image via <a href="https://www.graalvm.org/">GraalVM</a> AOT compiler.
Therefore, we recommed to use <a href="https://quarkus.io/">quarkus</a> as your main framework.
In case you want to go with spring, you may consider using <a href="https://github.com/spring-projects-experimental/spring-native">spring-native</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="layers-3"><a class="anchor" href="#layers-3"></a>1.81.28. Layers</h4>
<div class="paragraph">
<p>The package structure of your code inside <code>src/main/java</code> (and <code>src/test/java</code>) of your app is described in our coding conventions in the sections <a href="coding-conventions#packages">packages</a>.
For the modern project structure, the layers are defined by the following table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Layer</strong></th>
<th class="tableblock halign-left valign-top"><strong>«layer»</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-service-layer">service</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>service</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The service layer exposing functionality via its remote API. Typical protocol is <a href="guide-rest">REST</a>. May also be any other protocol you are using such as <a href="https://grpc.io/">gRPC</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-domain-layer">domain</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>domain</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The domain with the data-model and DB access. Use sub-package (in <code>«detail»</code>) <code>repository</code> for <a href="guide-repository">repository</a> and <code>dao</code> for <a href="guide-dao">DAOs</a>. Also we recommend to put <a href="guide-jpa#entity">entities</a> in <code>model</code> sub-package.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-logic-layer">logic</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The logic layer with the functionallity providing the business value.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="guide-common">common</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>common</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cross-cutting code not assigned to a technical layer.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="architecture-mapping-2"><a class="anchor" href="#architecture-mapping-2"></a>1.81.29. Architecture Mapping</h4>
<div class="paragraph">
<p>In order to help you to map the architecture, packaging, layering, etc. to the code and see where different code elements should be placed,
we provide this architecture mapping:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>«root»
├──.<a href="guide-component#business-component">«component»</a>
|  ├──.<a href="guide-domain-layer">domain</a>
|  |  ├──.<a href="guide-repository">repo</a>
|  |  |  ├──.<a href="guide-repository#repository">«BusinessObject»Repository</a>
|  |  |  ├──.<a href="guide-repository#fragment">«BusinessObject»Fragment</a>
|  |  |  └──.<a href="guide-repository#fragment">«BusinessObject»FragmentImpl</a>
|  |  ├──.<a href="guide-dao">dao</a> [alternative to repo]
|  |  |  ├──.<a href="guide-dao#data-access-object">«BusinessObject»Dao</a>
|  |  |  └──.<a href="guide-dao#data-access-object">«BusinessObject»DaoImpl</a>
|  |  └──.model
|  |     └──.<a href="guide-jpa#entity">«BusinessObject»Entity</a>
|  ├──.<a href="guide-logic-layer">logic</a>
|  |  ├──«BusinessObject»Validator
|  |  └──«BusinessObject»EventsEmitter
|   |  └──.<a href="guide-usecase">Uc«Operation»«BusinessObject»[Impl</a>]
|  └──.<a href="guide-service-layer">rest</a>
|     └──.<a href="guide-service-versioning#jax-rs">v1</a>
|        ├──.<a href="guide-rest#jax-rs">«Component»RestService</a>
|        ├──.mapper
|        |     └──.«BusinessObject»Mapper
|        └──.model
|           └──.«BusinessObject»Dto
└──.<a href="guide-component#general-component">general</a>
   └──.domain
      └──.model
         └──.ApplicationPersistenceEntity</pre>
</div>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Domain Layer</p>
</div>
<div class="paragraph">
<p>The domain layer is responsible for the data-model and mapping it to a <a href="https://github.com/devonfw/devonfw-guide/blob/master/general/db/guide-database.adoc">database</a>.
The most common approach is to use a Relational Database Management System (RDMS). In such a case, we strongly recommend to follow our <a href="guide-jpa">JPA Guide</a>. Some NoSQL databases are supported by <a href="https://spring.io/projects/spring-data">spring-data</a>, so you can consider the <a href="guide-repository">repository guide</a>.</p>
</div>
<div class="paragraph">
<p>Note: The domain layer is the replacement for the <a href="guide-dataaccess-layer">data-access layer</a> in the <a href="guide-structure-modern">modern project structure</a>.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect2">
<h3 id="guides-3"><a class="anchor" href="#guides-3"></a>1.82. Guides</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Getting started with Quarkus for Spring developers</p>
</div>
<div class="paragraph">
<p>As a Spring developer, you have heard more and more about Quarkus: its pros and cons, its fast growth etc. So, you decided to adopt/try Quarkus for your (next) project(s) and are wondering where to go next and what you need to pay attention to when moving from Spring to Quarkus.</p>
</div>
<div class="paragraph">
<p>This guide tries to address this exact concern. In the following, we will present you some main points you should be aware of when starting to develop with Quarkus, along with some useful sources.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Quarkus is a fairly new Java toolkit. Thus, it is very well documented. It also provides a set of well-written technical guides that are a good starting point to get in touch and make the first steps with Quarkus. See <a href="https://quarkus.io/get-started/">here</a>. It is an Open Source project licensed under the Apache License version 2.0. The source code is hosted in <a href="https://github.com/quarkusio/quarkus">GitHub</a>. If you have any questions or concerns, don&#8217;t hesitate to reach out to the <a href="https://quarkus.io/community/">Quarkus community</a>.</p>
</li>
<li>
<p>Same as <a href="https://start.spring.io/">Spring Initializr</a>, you can go to <a href="https://code.quarkus.io/">code.quarkus.io</a> to create a new application. Also, check out our <a href="quarkus-template">Template Quarkus Guide</a> to see our recommendations on certain topics.</p>
</li>
<li>
<p>In Spring stack, we recommend structuring your application into multiple modules, known as our <a href="../guide-structure-classic">classic structure</a>. Moving to Quarkus and the world of cloud-native microservices, where we build smaller applications compared to monoliths, we recommend keeping everything top-level and simple. Therefore, we propose the <a href="../guide-structure-modern">modern structure</a> as a better fit.</p>
</li>
<li>
<p>Quarkus focuses not only on delivering top features, but also on the developer experience. The <strong>Quarkus&#8217;s Live Coding</strong> feature automatically detects changes made to Java files, application configuration, static resources, or even classpath dependency changes and recompiles and redeploys the changes. As that, it solves the problem of traditional Java development workflow, hence improves productivity.</p>
<div class="listingblock">
<div class="content">
<pre>    Write Code → Compile → Deploy → Test Changes/ Refresh Browser/ etc → Repeat (traditional)
    Write Code → Test Changes/ Refresh Browser/ etc → Repeat (Quarkus)</pre>
</div>
</div>
<div class="paragraph">
<p>You can use this feature out of the box without any extra setup by running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>    mvn compile quarkus:dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another highlight feature to speed up developing is the Quarkus&#8217;s Dev Mode with <strong>Dev Services</strong>, which can automatically provision unconfigured services in development and test mode. This means that if you include an extension and don&#8217;t configure it, Quarkus will automatically start the relevant service and wire up your application to use it, therefore saving you a lot of time setting up those services manually. In production mode, where the real configuration is provided, Dev Services will be disabled automatically.</p>
</div>
<div class="paragraph">
<p>Additionally, you can access the <strong>Dev UI</strong> at <code>\q\dev</code> in Dev Mode to browse endpoints offered by various extensions, conceptually similar to what a Spring Boot actuator might provide.</p>
</div>
</li>
<li>
<p>Quarkus is made of a small core on which hundreds of extensions rely. In fact, the power of Quarkus is its extension mechanism. Think of these extensions as your project dependencies. You can add it per dependency manager such as maven or gradle.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>mvn quarkus:list-extensions
mvn quarkus:add-extension -Dextensions="groupId:artifactId"
(or add it manually to pom.xml)
##or
gradle list-extensions
(add dependency to build.gradle)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Like Spring Boot, Quarkus also has a vast ecosystem of extensions with commonly-used technologies.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. Example of common Quarkus extensions and the Spring Boot Starters with similar functionality (<a href="https://developers.redhat.com/e-books/quarkus-spring-developers">book: Quarkus for Spring Developer</a>)</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Quarkus extension</th>
<th class="tableblock halign-left valign-top">Spring Boot Starter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-resteasy-jackson</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-web</p>
<p class="tableblock">spring-boot-starter-webflux</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-resteasy-reactive-jackson</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-web</p>
<p class="tableblock">spring-boot-starter-webflux</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-hibernate-orm-panache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-data-jpa</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-hibernate-orm-rest-datapanache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-data-rest</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-hibernate-reactive-panache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-data-r2dbc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-mongodb-panache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-data-mongodb</p>
<p class="tableblock">spring-boot-starter-data-mongodb-reactive</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-hibernate-validator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-validation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-qpid-jms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-activemq</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-artemis-jms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-artemis</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-cache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-cache</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-redis-client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-data-redis</p>
<p class="tableblock">spring-boot-starter-data-redis-reactive</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-mailer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-mail</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-quartz</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-quartz</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-oidc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-oauth2-resource-server</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-oidc-client</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-oauth2-client</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus-smallrye-jwt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-boot-starter-security</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A full list of all Quarkus extensions can be found <a href="https://quarkus.pro/extensions/">here</a>. Furthermore, you can check out the community extensions hosted by <a href="https://github.com/quarkiverse/quarkiverse/wiki">Quarkiverse Hub</a>. Quarkus has some extensions for Spring API as well, which is helpful when migrating from Spring to Quarkus.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://quarkus.io/guides/spring-di">Quarkus Extension for Spring Dependency Injection</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-web">Quarkus Extension for Spring Web</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-data-jpa">Quarkus Extension for Spring Data JPA</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-security">Quarkus Extension for Spring Security</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-boot-properties">Quarkus Extension for Spring Boot Properties</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-cache">Quarkus Extension for Spring Cache</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-cloud-config-client">Quarkus Extension for Spring Cloud Config Client</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-data-rest">Quarkus Extension for Spring Data REST</a></p>
</li>
<li>
<p><a href="https://quarkus.io/guides/spring-scheduled">Quarkus Extension for Spring Scheduled</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Besides extensions, which are officially maintained by Quarkus team, Quarkus allows adding external libraries too. While extensions can be integrated seamlessly into Quarkus, as they can be processed at build time and be built in native mode with GraalVM, external dependencies might not work out of the box with native compilation. If that is the case, you have to recompile them with the right GraalVM configuration to make them work.</p>
</div>
</li>
<li>
<p>Quarkus' design accounted for native compilation by default. A Quarkus native executable starts much faster and utilizes far less memory than a traditional JVM (see our <a href="../performance-comparision-spring-quarkus">performace comparision between Spring and Quarkus</a>). To get familiar with building native executable, configuring and running it, please check out our <a href="guide-native-image">Native Image Guide</a>. Be sure to test your code in both JVM and native mode.</p>
</li>
<li>
<p>Both Quarkus and Spring include testing frameworks based on <a href="https://junit.org/junit5/">JUnit</a> and <a href="https://site.mockito.org/">Mockito</a>. Thus, by design, Quarkus enables test-driven development by detecting affected tests as changes are made and automatically reruns them in background. As that, it gives developer instant feedback, hence improves productivity. To use continuous testing, execute the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>mvn quarkus:dev</code></pre>
</div>
</div>
</li>
<li>
<p>For the sake of performance optimization, Quarkus avoids reflection as much as possible, favoring static class binding instead. When building a native executable, it analyzes the call tree and removes all the classes/methods/fields that are not used directly. As a consequence, the elements used via reflection are not part of the call tree so they are dead code eliminated (if not called directly in other cases).</p>
<div class="paragraph">
<p>A common example is the JSON library, which typically use reflection to serialize the objects to JSON. If you use them out of the box, you might encounter some errors in native mode. So, be sure to register the elements for reflection explicitly. A How-to is provided by <a href="https://quarkus.io/guides/writing-native-applications-tips#registering-for-reflection">Quarkus Registering For Reflection</a> with practical program snippets.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>A very good read on the topic is the e-book <a href="https://developers.redhat.com/e-books/quarkus-spring-developers">Quarkus for Spring Developers</a> by Red Hat. Another good source for direct hands-on coding tutorial is <a href="https://www.katacoda.com/openshift/courses/developing-with-quarkus/spring">Katacoda Quarkus for Spring Boot Developers</a></p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Configuration</p>
</div>
<div class="paragraph">
<p><a href="quarkus">Quarkus</a> provides a comprehensive guide on configuration <a href="https://quarkus.io/guides/config-reference">here</a>.</p>
</div>
<div class="sect4">
<h5 id="external-application-configuration-2"><a class="anchor" href="#external-application-configuration-2"></a>External Application Configuration</h5>
<div class="sect5">
<h6 id="database-configuration-3"><a class="anchor" href="#database-configuration-3"></a>Database Configuration</h6>
<div class="paragraph">
<p>In Quarkus, Hibernate is provided by the <code>quarkus-hibernate-orm</code> extension. Ensure the extension is added to your <code>pom.xml</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-hibernate-orm&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, you have to add the respective JDBC driver extension to your <code>pom.xml</code>. There are different drivers for different database types. See <a href="https://quarkus.io/guides/hibernate-orm#setting-up-and-configuring-hibernate-orm">Quarkus Hibernate guide</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="database-system-and-access-2"><a class="anchor" href="#database-system-and-access-2"></a>Database System and Access</h6>
<div class="paragraph">
<p>You need to configure which database type you want to use, as well as the location and credentials to access it. The defaults are configured in <code>application.properties</code>. The file should therefore contain the properties as in the given example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.datasource.jdbc.url=jdbc:postgresql://database.enterprise.com/app
quarkus.datasource.username=appuser01
quarkus.datasource.password=************
quarkus.datasource.db-kind=postgresql

##drop and create the database at startup (use only for local development)
quarkus.hibernate-orm.database.generation=drop-and-create</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="database-logging-2"><a class="anchor" href="#database-logging-2"></a>Database Logging</h6>
<div class="paragraph">
<p>Add the following properties to <code>application.properties</code> to enable logging of database queries for debugging purposes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.log.format-sql=true

#Logs SQL bind parameters. Setting it to true is obviously not recommended in production.
quarkus.hibernate-orm.log.bind-parameters=true</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="secrets-and-environment-specific-configurations"><a class="anchor" href="#secrets-and-environment-specific-configurations"></a>Secrets and environment specific configurations</h5>
<div class="sect5">
<h6 id="environment-variables"><a class="anchor" href="#environment-variables"></a>Environment variables</h6>
<div class="paragraph">
<p>There are also some libraries to make Jasypt work with Quarkus, such as <a href="https://camel.apache.org/camel-quarkus/latest/reference/extensions/jasypt.html">Camel Quarkus Jasypt</a>. Unfortunately, this feature only works in JVM mode and not in native mode.</p>
</div>
<div class="paragraph">
<p>Quarkus supports many credential providers with official extensions, such as HashiCorp Vault.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-vault&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Quarkus reads configuration values from several locations, ordered by a certain priority. An overview of these can be found at the official  <a href="https://quarkus.io/guides/config-extending-support">Quarkus config guide</a>.</p>
</div>
<div class="paragraph">
<p>Environment variables have a higher ordinal number and are therefore higher prioritized than e.g. the <code>application.properties</code> file.
So instead of storing secrets in plain text in the configuration files, it is better to use environment variables for critical values to configure the application.</p>
</div>
<div class="paragraph">
<p>Environment variables also have the advantage that they can be easily integrated into a containerized environment.
When using Kubernetes, the secrets can be stored as <em>Kubernetes secret</em> and then passed to the containers as an environment variable.</p>
</div>
</div>
<div class="sect5">
<h6 id="custom-config-sources"><a class="anchor" href="#custom-config-sources"></a>Custom config sources</h6>
<div class="paragraph">
<p>Quarkus provides the possability to add custom config sources, which can be used to retrieve configuration values from custom locations.
For a description of this feature, see the <a href="https://quarkus.io/guides/config-extending-support#custom-config-source">corresponding Quarkus guide</a>.</p>
</div>
<div class="sect6">
<h7 id="config-interceptors"><a class="anchor" href="#config-interceptors"></a>Config interceptors</h7>
<div class="paragraph">
<p>Quarkus also allows with the concept of interceptors to hook into the resolution of configuration values. This can be useful when configuration values are encrypted or need to be extracted.
To do this, you have to implement a <code>ConfigSourceInterceptor</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Java hljs" data-lang="Java">public class CustomConfigInterceptor implements ConfigSourceInterceptor {

  @Override
  public ConfigValue getValue(ConfigSourceInterceptorContext context, String name) {

    ConfigValue configValue = context.proceed(name);
    if (name.equals("config-value-to-resolve")) {
      configValue = new ConfigValue.ConfigValueBuilder()
          .withName(name)
          .withValue(resolveConfigurationValue(name))
          .build();
    }

    return configValue;
  }

  private String resolveConfigurationValue(String name) {
    ...
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use the Interceptor, you must register it. To do this, create a file  <code>io.smallrye.config.ConfigSourceInterceptor</code> in the folder <code>src/main/resources/META-INF/services</code> and register the interceptor register the interceptor by writing the fully qualified class name to this file.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="credential-encryption"><a class="anchor" href="#credential-encryption"></a>Credential encryption</h6>
<div class="paragraph">
<p>As for <a href="../spring/guide-spring-configuration#security">Spring</a>, there are also some libraries that let Jasypt work with Quarkus such as <a href="https://camel.apache.org/camel-quarkus/latest/reference/extensions/jasypt.html">Camel Quarkus Jasypt</a>. Unfortunately, this feature only works in JVM mode and not in native mode, so it is not a suitable approach.</p>
</div>
<div class="paragraph">
<p>If you want to store usernames or passwords in encrypted form or retrieve them from a custom store, you can use a custom <code>CredentialsProvider</code> for this purpose.
Consider the use case where you want to store your database credentials in encrypted form rather than in plain text. Then you can implement a credentials provider as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Java hljs" data-lang="Java">@ApplicationScoped
@Unremovable
public class DatabaseCredentialsProvider implements CredentialsProvider {

  @Override
  public Map&lt;String, String&gt; getCredentials(String credentialsProviderName) {

    Map&lt;String, String&gt; properties = new HashMap&lt;&gt;();
    properties.put(USER_PROPERTY_NAME, decryptUsername());
    properties.put(PASSWORD_PROPERTY_NAME, decryptPassword());
    return properties;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the <code>application.properties</code> file you need to set <code>quarkus.datasource.credentials-provider=custom</code>.
For more information about the credentials provider, see the official <a href="https://quarkus.io/guides/credentials-provider">Quarkus guide</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="hashicorp-vault"><a class="anchor" href="#hashicorp-vault"></a>HashiCorp Vault</h6>
<div class="paragraph">
<p>For centralized management of secrets and other critical configuration values, you can use <a href="https://www.vaultproject.io/">HashiCorp Vault</a> as external management tool.</p>
</div>
<div class="paragraph">
<p>For detailed instructions on how to integrate Vault into your Quarkus application, see the official <a href="https://quarkus.io/guides/vault">Quarkus guide</a>.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Quarkus template</p>
</div>
<div class="paragraph">
<p><a href="https://code.quarkus.io/?g=org.devonfw&amp;e=resteasy&amp;e=resteasy-jackson&amp;e=hibernate-validator&amp;e=hibernate-orm&amp;e=micrometer">Quarkus Code Generator</a> is provides many alternative technologies and libraries that can be integrated into a project. Detailed guides on multiple topics can be found <a href="https://quarkus.io/guides/">here</a>.</p>
</div>
<div class="paragraph">
<p>Due to the large selection, getting started can be difficult for developers.
In this guide we aim to provide a general suggestion on basic frameworks, libraries, and technologies to make it easy for developers to begin with.</p>
</div>
<div class="paragraph">
<p>With that said, please take this as a recommendation and not as a compulsion. Depending on your project requirements, you might have to use another stack compared to what is listed below.</p>
</div>
<div class="paragraph">
<p>If you are new to Quarkus, consider checking out their <a href="https://quarkus.io/guides/getting-started">getting started guide</a> to get an overview of how to create, run, test, as well as package a Quarkus application. Another recommended source to get started is <a href="https://www.katacoda.com/openshift/courses/developing-with-quarkus/getting-started">the Katacoda tutorials</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="basic-templates"><a class="anchor" href="#basic-templates"></a>Basic templates</h6>
<div class="olist arabic">
<ol class="arabic" start="1">
<li>
<p>simple REST API (<a href="https://code.quarkus.io/?g=com.devonfw&amp;e=resteasy&amp;e=resteasy-jackson&amp;e=hibernate-validator&amp;e=hibernate-orm">go to code.quarkus.io</a>)</p>
</li>
<li>
<p>simple REST API with monitoring (<a href="https://code.quarkus.io/?g=com.devonfw&amp;e=resteasy&amp;e=resteasy-jackson&amp;e=hibernate-validator&amp;e=hibernate-orm&amp;e=micrometer&amp;e=smallrye-health">go to code.quarkus.io</a>)</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. Topic-based suggested implementation</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 42.8572%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Topic</th>
<th class="tableblock halign-left valign-top">Detail</th>
<th class="tableblock halign-left valign-top">Suggested implementation</th>
<th class="tableblock halign-left valign-top">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">runtime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">servlet-container</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undertow</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">component management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dependency injection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ArC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ArC is based on JSR 365. It also provides interceptors that can be used to implement the same functionality as AOP provides</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configuration</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/config">SmallRye Config</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SmallRye Config is an implementation of Eclipse MicroProfile Config. It also supports YAML configuration files</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">persistence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OR-mapper</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/hibernate-orm">Hibernate ORM</a>, <a href="https://quarkus.io/guides/spring-data-jpa">Spring Data JPA</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hibernate ORM is the de facto standard JPA implementation and works perfectly in Quarkus. Quarkus also provides a compatibility layer for Spring Data JPA repositories in the form of the <code>spring-data-jpa</code> extension.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">batch</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quarkus JBeret Extension is a non-official extension, which is hosted in the <a href="https://github.com/quarkiverse/">Quarkiverse Hub</a>. It is an implementation of JSR 352.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">service</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST services</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/rest-json">RESTEasy</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTEasy is an portable implementation of the new JCP specification JAX-RS JSR-311. It can be documented via Swagger OpenAPI.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">async messaging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/kafka">SmallRye Reactive Messaging</a>, Vert.x EventBus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SmallRye Reactive Messaging is an implementation of the Eclipse MicroProfile Reactive Messaging specification 1.0. You can also utilize SmallRye Reactive Messaging in your Quarkus application to interact with Apache Kafka.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">marshalling</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESTEasy Jackson, RESTEasy JSON-B, RESTEasy JAXB, RESTEasy Multipart</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">cloud</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">kubernetes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deployment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minikube, k3d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Minikube is quite popular when a Kubernetes cluster is needed for development purposes. Quarkus supports this with the <code>quarkus-minikube</code> extension.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">logging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/logging">JBoss Log Manager and the JBoss Logging facade</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Internally, Quarkus uses JBoss Log Manager and the JBoss Logging facade. Logs from other supported Logging API (JBoss Logging, SLF4J, Apache Commons Logging) will be merged.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">validation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/validation">Hibernate Validator</a>/Bean Validation (JSR 380)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">security</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">authentication &amp; authorization</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JWT authentication</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quarkus supports <a href="https://quarkus.io/guides/security">various security mechanisms</a>. Depending on your protocol, identity provider you can choose the necessary extensions such as <code>quarkus-oidc</code> <code>quarkus-smallrye-jwt</code> <code>quarkus-elytron-security-oauth2</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock">monitoring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">framework</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/micrometer">Micrometer Metrics</a>, <a href="https://quarkus.io/guides/smallrye-metrics">SmallRye Metrics</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SmallRye Metrics is an implementation of the MicroProfile Metrics specification. Quarkus also offers various extensions to customize the metrics.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">health</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/smallrye-health">SmallRye Health</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SmallRye Health is an implementation of the MicroProfile Health specification.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fault tolerance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://quarkus.io/guides/smallrye-fault-tolerance">SmallRye Fault Tolerance</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SmallRye Fault Tolerance is an implementation of the MicroProfile Fault Tolerance specification.</p></td>
</tr>
</tbody>
</table>
<!-- toc disabled -->
<div class="paragraph">
<p>==Building a native image</p>
</div>
<div class="paragraph">
<p>Quarkus provides the ability to create a native executable of the application called <em><a href="https://quarkus.io/guides/building-native-image">native image</a></em>.
Unlike other Java based deployments, a native image will only run on the architecture and operating system it is compiled for.
Also, no JVM is needed to run the native-image.
This improves the startup time, performance, and efficiency.
A distribution of <a href="https://www.graalvm.org/">GraalVM</a> is needed.
You can find the differences between the available distributions <a href="https://quarkus.io/guides/building-native-image#graalvm">here</a>.</p>
</div>
<div class="paragraph">
<p>To build your quarkus app as a native-image, you have two options that are described in the following sections.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="build-a-native-executable-with-graalvm"><a class="anchor" href="#build-a-native-executable-with-graalvm"></a>Build a native executable with GraalVM</h5>
<div class="paragraph">
<p>To build a Quarkus application, you can install GraalVM locally on your machine, as described below.
Therefore, read the <a href="quarkus-template#basic-templates">basic Quarkus application chapter</a>, or clone the <a href="https://github.com/devonfw-sample/devon4quarkus-reference">example project</a> provided by devonfw.
Follow this <a href="https://quarkus.io/guides/building-native-image#producing-a-native-executable">chapter</a> from the Quarkus Guide for building a native executable.</p>
</div>
<div class="sect5">
<h6 id="installing-graalvm"><a class="anchor" href="#installing-graalvm"></a>Installing GraalVM</h6>
<div class="paragraph">
<p>A native image can be created locally or through a container environment.
To create a native image locally, an installed and configured version of GraalVM is needed. You can follow the <a href="https://quarkus.io/guides/building-native-image#prerequisites-for-oracle-graalvm-ceee">installation guide from Quarkus</a> or the <a href="https://www.graalvm.org/docs/getting-started/#install-graalvm">guide provided by GraalVM</a> for this.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="build-a-native-executable-with-graalvm-through-container-environment"><a class="anchor" href="#build-a-native-executable-with-graalvm-through-container-environment"></a>Build a native executable with GraalVM through container environment</h5>
<div class="paragraph">
<p>In order to make the build of native images more portable, you can also use your container environment and run the GraalVM inside a container (typically Docker).
You can simply install Docker with your devonfw-ide distribution, just follow this description <a href="https://github.com/devonfw/ide/blob/master/documentation/docker">Docker with devonfw-ide</a>.
Follow this <a href="https://quarkus.io/guides/building-native-image#container-runtime">chapter</a> to build a native Linux image through container runtime.</p>
</div>
</div>
<div class="sect4">
<h5 id="configuring-the-native-executable"><a class="anchor" href="#configuring-the-native-executable"></a>Configuring the native executable</h5>
<div class="paragraph">
<p>A list of all configuration properties for a native image can be found <a href="https://quarkus.io/guides/building-native-image#configuration-reference">here</a>.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Bean mapping with Quarkus</p>
</div>
<div class="paragraph">
<p>This guide will show bean-mapping, in particular for a Quarkus application. We recommend using <a href="https://mapstruct.org/">MapStruct</a> with a Quarkus application because the other bean-mapper frameworks use Java reflections. They are not supported in GraalVm right now and cause problems when building native applications. MapStruct is a code generator that greatly simplifies the implementation of mappings between Java bean types based on a convention over configuration approach. The mapping code will be generated at compile-time and uses plain method invocations and is thus fast, type-safe, and easy to understand. MapStruct has to be configured to not use Java reflections, which will be shown in this guide.</p>
</div>
<div class="paragraph">
<p>You can find the official
<a href="https://mapstruct.org/documentation/stable/reference/pdf/mapstruct-reference-guide.pdf">MapStruct reference guide</a> and a general introduction to MapStruct from <a href="https://www.baeldung.com/mapstruct">Baeldung</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="mapstruct-dependency"><a class="anchor" href="#mapstruct-dependency"></a>MapStruct Dependency</h5>
<div class="paragraph">
<p>To get access to MapStruct, we have to add the dependency to our POM.xml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.mapstruct&lt;/groupId&gt;
  &lt;artifactId&gt;mapstruct&lt;/artifactId&gt;
  &lt;version&gt;1.4.2.Final&lt;/version&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>MapStruct provides an annotation processor that also has to be added to the POM.xml</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;plugin&gt;
	&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
	&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
	&lt;version&gt;3.8.1&lt;/version&gt;
	&lt;configuration&gt;
		&lt;source&gt;1.8&lt;/source&gt;
		&lt;target&gt;1.8&lt;/target&gt;
		&lt;annotationProcessorPaths&gt;
			&lt;path&gt;
				&lt;groupId&gt;org.mapstruct&lt;/groupId&gt;
				&lt;artifactId&gt;mapstruct-processor&lt;/artifactId&gt;
				&lt;version&gt;1.4.2.Final&lt;/version&gt;
			&lt;/path&gt;
		&lt;/path&gt;
		&lt;/annotationProcessorPaths&gt;
	&lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>MapStruct takes advantage of generated getters, setters, and constructors from the <a href="https://projectlombok.org/">Lombok</a> library, follow this <a href="../guide-lombok.adoc#lombok-with-mapstruct">Lombok with Mapstruct guide</a> to get Lombok with Mapstruct working.</p>
</div>
</div>
<div class="sect4">
<h5 id="mapstruct-configuration"><a class="anchor" href="#mapstruct-configuration"></a>MapStruct Configuration</h5>
<div class="paragraph">
<p>We already discussed the benefits of <a href="https://github.com/devonfw/devon4j/blob/master/documentation/guide-dependency-injection.adoc#dependency-injection">dependency injection</a>. MapStruct supports CDI with EJB, spring, and jsr330. The default retrieving method for a mapper is a factory that uses reflections, which should be avoided. The component model should be set to CDI, as this will allow us to easily inject the generated mapper implementation. The component model can be configured in multiple ways.</p>
</div>
<div class="sect5">
<h6 id="simple-configuration"><a class="anchor" href="#simple-configuration"></a>Simple Configuration</h6>
<div class="paragraph">
<p>Add the attribute <strong>componentModel</strong> to the <strong>@Mapper</strong> annotation in the mapper interface.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Mapper(compnentModel = "cdi")
public interface ProductMapper{
  ...
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="mapperconfig-configuration"><a class="anchor" href="#mapperconfig-configuration"></a>MapperConfig Configuration</h6>
<div class="paragraph">
<p>Create a shared configuration that can be used for multiple mappers. Implement an interface and use the annotation <strong>@MapperConfig</strong> for the class. You can define all configurations in this interface and pass the generated <code>MapperConfig.class</code> with the <strong>config</strong> attribute to the mapper. The <code>MapperConfig</code> also defines the <strong>InjectionStrategy</strong> and <strong>MappingInheritaceStrategy</strong>, both of which will be explained later.
A list of all configurations can be found <a href="https://mapstruct.org/documentation/stable/api/org/mapstruct/MapperConfig.html">here</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@MapperConfig(
  compnentModel = "cdi",
  mappingInheritanceStrategy = MappingInheritanceStrategy.AUTO_INHERIT_FROM_CONFIG
  injectionStrategy =InjectionStrategy.CONSTRUCTOR
)
public interface MapperConfig{
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Mapper( config = MapperConfig.class )
public interface ProductMapper{
  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any attributes not given via <strong>@Mapper</strong> will be inherited from the shared configuration <code>MapperConfig.class</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="configuration-via-annotation-processor-options"><a class="anchor" href="#configuration-via-annotation-processor-options"></a>Configuration via annotation processor options</h6>
<div class="paragraph">
<p>The MapStruct code generator can be configured using annotation processor options.
You can pass the options to the compiler while invoking javac directly, or add the parameters to the maven configuration in the POM.xml</p>
</div>
<div class="paragraph">
<p>We also use the constructor injection strategy to avoid field injections and potential reflections. This will also simplify our tests.</p>
</div>
<div class="paragraph">
<p>The option to pass the parameter to the annotation processor in the POM.xml is used and can be inspected in our <a href="https://github.com/devonfw-sample/devon4quarkus-reference/blob/master/pom.xml#L220-L228">quarkus reference project</a>.</p>
</div>
<div class="paragraph">
<p>A list of all annotation processor options can be found <a href="https://mapstruct.org/documentation/dev/reference/html/#configuration-options">here</a>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="basic-bean-mapper-usage"><a class="anchor" href="#basic-bean-mapper-usage"></a>Basic Bean-Mapper Usage</h5>
<div class="paragraph">
<p>To use the mapper, we have to implement the mapper interface and the function prototypes with a <strong>@Mapper</strong> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Mapper
public interface ProductMapper {

  ProductDto map(ProductEntity model);

  ProductEntity create(NewProductDto dto);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The MapStruct annotation processor will generate the implementation for us under <code>/target/generated-sources/</code>, we just need to tell it that we would like to have a method that accepts a <code>ProductEntity</code> entity and returns a new <code>ProductDto</code> DTO.</p>
</div>
<div class="paragraph">
<p>The generated mapper implementation will be marked with the <strong>@ApplicationScoped</strong> annotation and can thus be injected into fields, constructor arguments, etc. using the <strong>@Inject</strong> annotation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class ProductRestService{

  @Inject
  ProductMapper mapper;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>That is the basic usage of a Mapstruct mapper. In the next chapter, we&#8217;ll go into a bit more detail and show some more configurations.</p>
</div>
</div>
<div class="sect4">
<h5 id="advanced-bean-mapper-usage"><a class="anchor" href="#advanced-bean-mapper-usage"></a>Advanced Bean-Mapper Usage</h5>
<div class="paragraph">
<p>Let´s assume that our <code>Product</code> entity and the <code>ProductDto</code> have some differently named properties that should be mapped. Add a mapping annotation to map the property <strong>type</strong> from <code>Product</code> to <strong>kind</strong> from <code>ProductDto</code>. We define the source name of the property and the target name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Mapper
public interface ProductMapper {
  @Mapping(target = "kind", source = "type")
  ProductDto map(ProductEntity entity);

  @InheritInverseConfiguration(name = "map" )
  ProductEntity create(ProductDto dto);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For bi-directional mappings, we can indicate that a method shall inherit the inverse configuration of the corresponding method with the <strong>@InheritInverseConfiguration</strong>. You can omit the name parameter if the result type of method A is the same as the
single-source type of method B and if the single-source type of A is the same as the result type of B. If multiple apply, the attribute name is needed. Specific mappings from the inverse method can (optionally) be overridden, ignored, or set to constants or expressions.</p>
</div>
<div class="paragraph">
<p>The mappingInheritanceStrategy can be defined as showed in <a href="#mapstruct-configuration">MapStruct Configuration</a>. The existing options can be found <a href="https://mapstruct.org/documentation/dev/reference/html/#shared-configurations">here</a>.</p>
</div>
<div class="paragraph">
<p>A mapped attribute does not always have the same type in the source and target objects. For instance, an attribute may be of type <code>int</code> in the source bean but of type <code>Long</code> in the target bean.</p>
</div>
<div class="paragraph">
<p>Another example are references to other objects which should be mapped to the corresponding types in the target model. E.g. the class <code>ShoppingCart</code> might have a property <strong>content</strong> of the type <code>Product</code> which needs to be converted into a <code>ProductDto</code> object when mapping a <code>ShoppingCart</code> object to <code>ShoppingCartDto</code>. For these cases, it&#8217;s useful to understand how Mapstruct <a href="https://mapstruct.org/documentation/dev/reference/html/#datatype-conversions">converts the data types</a> and the <a href="https://mapstruct.org/documentation/dev/reference/html/#mapping-object-references">object references</a>.</p>
</div>
<div class="paragraph">
<p>Also, the Chapter for <a href="https://mapstruct.org/documentation/dev/reference/html/#controlling-nested-bean-mappings">nested bean mappings</a> will help to configure MapStruct to map arbitrarily deep object graphs.</p>
</div>
<div class="paragraph">
<p>You can study running MapStruct implementation examples given by <a href="https://github.com/mapstruct/mapstruct-examples">MapStruct</a> or in our <a href="https://github.com/devonfw-sample/devon4quarkus-reference">Quarkus reference project</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="angular"><a class="anchor" href="#angular"></a>2. Angular</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="introduction-2"><a class="anchor" href="#introduction-2"></a>3. Introduction</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="devon4ng"><a class="anchor" href="#devon4ng"></a>3.1. devon4ng</h4>
<div class="paragraph">
<p>This guide describes an application architecture for web client development with <a href="https://angular.io/">Angular</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="motivation-6"><a class="anchor" href="#motivation-6"></a>3.2. Motivation</h4>
<div class="paragraph">
<p>Front-end development is a very difficult task since there are a lot of different frameworks, patterns and practices nowadays. For that reason, in devonfw we decided to make use of Angular since it is a full front-end framework that includes almost all the different patterns and features that any SPA may need and provides a well defined architecture to development, build and deploy.</p>
</div>
<div class="paragraph">
<p>The idea with <strong>devon4ng</strong> is to define an architecture which is a compromise between, on the one hand, leveraging the best practices and latest trends like reactive style development, on the other hand, providing a short on-boarding time while still using an architecture that helps us scale and be productive at the same time.</p>
</div>
<div class="paragraph">
<p>At the same time <strong>devon4ng</strong> aims to help developers to solve common problems that appear in many projects and provide samples and blueprints to show how to apply this solutions in real situations.</p>
</div>
</div>
<div class="sect3">
<h4 id="contents"><a class="anchor" href="#contents"></a>3.3. Contents</h4>
<div class="ulist">
<ul>
<li>
<p><a href="architecture">Architecture Overview</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This section introduces in an easy way the main principles and guidelines based on Angular Style Guide.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="meta-architecture">Client Meta Architecture</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The goal of this topic is to support the non-functional requirements for the client, i.e. mostly maintainability, scalability, efficiency and portability. As such it provides a component-oriented architecture following the same principles listed already in the devonfw architecture overview.</p>
</div>
</div>
<div class="sect3">
<h4 id="layers-4"><a class="anchor" href="#layers-4"></a>3.4. Layers</h4>
<div class="paragraph">
<p>This section provides a condensed explanation about the different layers a good Angular application must provide.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="components-layer">Components Layer</a></p>
</li>
<li>
<p><a href="services-layer">Services Layer</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="guides-4"><a class="anchor" href="#guides-4"></a>3.5. Guides</h4>
<div class="paragraph">
<p>This section introduces concepts to help developers with the tooling and package managers.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-package-managers">Package Managers</a></p>
</li>
<li>
<p><a href="guide-npm-yarn-workflow">Package Managers Workflow</a></p>
</li>
<li>
<p><a href="guide-yarn-2-support">Yarn 2 Support</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="angular-2"><a class="anchor" href="#angular-2"></a>3.6. Angular</h4>
<div class="paragraph">
<p>This is the main section of the documentation, where the developer will find guidelines for accessibility, how to use the Angular toolchain, how to refactor components, create libraries and, in general, maintain Angular applications. But last and not least, developers will also find solutions to common problems many of the Angular projects may have.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All the different topics are demonstrated in the <code>samples</code> folder with a small application.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-accessibility">Accessibility</a></p>
</li>
<li>
<p><a href="guide-angular-elements">Angular Elements</a></p>
</li>
<li>
<p><a href="guide-angular-lazy-loading">Angular Lazy Loading</a></p>
</li>
<li>
<p><a href="guide-angular-library">Angular Library</a></p>
</li>
<li>
<p><a href="guide-angular-theming">Angular Material Theming</a></p>
</li>
<li>
<p><a href="guide-angular-pwa">Angular Progressive Web Apps</a></p>
</li>
<li>
<p><a href="guide-app-initializer"><code>App Initializer</code></a></p>
</li>
<li>
<p><a href="guide-component-decomposition">Component Decomposition</a></p>
</li>
<li>
<p><a href="guide-consuming-rest-services">Consuming REST services</a></p>
</li>
<li>
<p><a href="guide-error-handler">Error Handler</a></p>
</li>
<li>
<p><a href="guide-file-structure">File Structure</a></p>
</li>
<li>
<p><a href="guide-internationalization">Internationalization</a></p>
</li>
<li>
<p><a href="guide-routing">Routing</a></p>
</li>
<li>
<p><a href="guide-testing">Testing</a></p>
</li>
<li>
<p><a href="guide-update-angular-cli">Update Angular CLI</a></p>
</li>
<li>
<p><a href="guide-upgrade-devon4ng">Upgrade devon4ng applications</a></p>
</li>
<li>
<p><a href="guide-working-with-angular-cli">Working with Angular CLI</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="ionic-2"><a class="anchor" href="#ionic-2"></a>3.7. Ionic</h4>
<div class="paragraph">
<p>As part of the devon4ng stack, we include a small section to explain how to develop hybrid mobile Ionic/Angular applications and create <code>PWAs</code> with this UI library. As the previous section, the contents are demonstrated in the <code>samples</code> folder.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-ionic-getting-started">Ionic Getting started</a></p>
</li>
<li>
<p><a href="guide-ionic-from-code-to-android">Ionic to Android</a></p>
</li>
<li>
<p><a href="guide-ionic-pwa">Ionic Progressive Web Apps</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="layouts"><a class="anchor" href="#layouts"></a>3.8. Layouts</h4>
<div class="paragraph">
<p>Any SPA application must have a layout. So, the purpose of this section is to explain the Angular Material approach.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-layout-with-angular-material">Angular Material Layout</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="ngrx"><a class="anchor" href="#ngrx"></a>3.9. NgRx</h4>
<div class="paragraph">
<p>State Management is a big topic in big front-end application. This section explains the fundamentals of the industry standard library NgRx, showing its main components.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-ngrx-getting-started">Introduction</a></p>
</li>
<li>
<p><a href="guide-ngrx-simple-store">State, Selection and Reducers</a></p>
</li>
<li>
<p><a href="guide-ngrx-effects">Side effects with NgRx/Effects</a></p>
</li>
<li>
<p><a href="guide-ngrx-entity">Simplifying CRUD with NgRx/Entity</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="cookbook"><a class="anchor" href="#cookbook"></a>3.10. Cookbook</h4>
<div class="paragraph">
<p>The Cookbook section aims to provide solutions to cross-topic challenges that at this moment do not fit in the previous sections. As the <strong>Angular</strong> section, some of the topics are demonstrated with a sample located in the <code>samples</code> folder.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="cookbook-abstract-class-store">Abstract Class Store</a></p>
</li>
<li>
<p><a href="guide-add-electron">Angular Electron</a></p>
</li>
<li>
<p><a href="guide-angular-mock-service">Mock Service</a></p>
</li>
<li>
<p><a href="guide-cypress">Cypress e2e testing</a></p>
</li>
<li>
<p><a href="guide-eslint">Angular ESLint</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="devon4ng-templates"><a class="anchor" href="#devon4ng-templates"></a>3.11. devon4ng templates</h4>
<div class="paragraph">
<p>In order to support CobiGen generation tool for Angular applications, devon4ng demos realization and provide more opinionated samples, the following templates are also included in devon4ng contents:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4ng-application-template">devon4ng-application-template</a>: It is the Angular application template used by the CobiGen code generation tool.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4ng-ngrx-template">devon4ng-ngrx-template</a>: It is the Angular application template used by the CobiGen code generation tool that makes use of NgRx for state management.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4ng-ionic-application-template">devon4ng-ionic-application-template</a>: It is the Ionic mobile application template used by the CobiGen code generation tool.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="architecture"><a class="anchor" href="#architecture"></a>4. Architecture</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="architecture-2"><a class="anchor" href="#architecture-2"></a>4.1. Architecture</h4>
<div class="paragraph">
<p>The following principles and guidelines are based on Angular Style Guide - especially Angular modules (see <a href="https://angular.io/guide/ngmodule">Angular Docs</a>).
It extends those where additional guidance is needed to define an architecture which is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>maintainable across applications and teams</p>
</li>
<li>
<p>easy to understand, especially when coming from a classic Java/.Net perspective - so whenever possible the same principles apply both to the server and the client</p>
</li>
<li>
<p>pattern based to solve common problems</p>
</li>
<li>
<p>based on best of breed solutions coming from open source and Capgemini project experiences</p>
</li>
<li>
<p>gives as much guidance as necessary and as little as possible</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="overview"><a class="anchor" href="#overview"></a>4.2. Overview</h4>
<div class="paragraph">
<p>When using Angular the web client architecture is driven by the framework in a certain way Google and the Angular community think about web client architecture.
Angular gives an opinion on how to look at architecture.
It is a component based like devon4j but uses different terms which are common language in web application development.
The important term is <em>module</em> which is used instead of <em>component</em>. The primary reason is the naming collision with the <em>Web Components</em> standard (see <a href="https://www.w3.org/standards/techs/components">Web Components</a>).<br>
To clarify this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <em>component</em> describes an UI element containing HTML, CSS and JavaScript - structure, design and logic encapsulated inside a reusable container called component.</p>
</li>
<li>
<p>A <em>module</em> describes an applications feature area. The application flight-app may have a module called booking.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An application developed using Angular consists of multiple modules.
There are feature modules and special modules described by the Angular Style Guide - <a href="https://angular.io/guide/ngmodule#the-core-module"><em>core</em></a> and <a href="https://angular.io/guide/ngmodule#shared-module"><em>shared</em></a>.
Angular or Angular Style Guide give no guidance on how to structure a module internally.
This is where this architecture comes in.</p>
</div>
</div>
<div class="sect3">
<h4 id="layers-5"><a class="anchor" href="#layers-5"></a>4.3. Layers</h4>
<div class="paragraph">
<p>The architecture describes two layers. The terminology is based on common language in web development.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/architecture-layers.svg"><img src="_images/images/architecture-layers.svg" alt="Architecture - Layers" width="450"></a>
</div>
<div class="title">Figure 8. Layers</div>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="components-layer"><strong>Components Layer</strong></a> encapsulates components which present the current application state.
Components are separated into <a href="components-layer"><em>Smart</em> and <em>Dumb Components</em></a>.
The only logic present is view logic inside <em>Smart Components</em>.</p>
</li>
<li>
<p><a href="services-layer"><strong>Services Layer</strong></a> is more or less what we call 'business logic layer' on the server side.
The layer defines the applications state, the transitions between state and classic business logic.
Stores contain application state over time to which <em>Smart Components</em> subscribe to.
Adapters are used to perform XHR, <code>WebSocket</code> connections, etc.
The business model is described inside the module.
Use case services perform business logic needed for use cases.
A use case services interacts with the store and adapters.
Methods of use case services are the API for <em>Smart Components</em>.
Those methods are <em>Actions</em> in reactive terminology.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="modules-3"><a class="anchor" href="#modules-3"></a>4.4. Modules</h4>
<div class="paragraph">
<p>Angular requires a module called <em>app</em> which is the main entrance to an application at runtime - this module gets bootstrapped.
Angular Style Guide defines feature modules and two special modules - <a href="https://angular.io/guide/ngmodule#the-core-module"><em>core</em></a> and <a href="https://angular.io/guide/ngmodule#shared-module"><em>shared</em></a>.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/architecture-modules.svg"><img src="_images/images/architecture-modules.svg" alt="Architecture - Modules" width="450"></a>
</div>
<div class="title">Figure 9. Modules</div>
</div>
<div class="paragraph">
<p>A feature module is basically a vertical cut through both layers.
The <em>shared</em> module consists of components shared across feature modules.
The <em>core</em> module holds services shared across modules.
So <em>core</em> module is a module only having a services layer
and <em>shared</em> module is a module only having a components layer.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="meta-architecture"><a class="anchor" href="#meta-architecture"></a>4.5. Meta Architecture</h4>

</div>
<div class="sect3">
<h4 id="introduction-3"><a class="anchor" href="#introduction-3"></a>4.6. Introduction</h4>

</div>
<div class="sect3">
<h4 id="purpose-of-this-document"><a class="anchor" href="#purpose-of-this-document"></a>4.7. Purpose of this document</h4>
<div class="paragraph">
<p>In our business applications, the client easily gets underestimated. Sometimes the client is more complex to develop and design than the server. While the server architecture is nowadays easily to agree as common sense, for clients this is not as obvious and stable especially as it typically depends on the client framework used. Finding a concrete architecture applicable for all clients may therefore be difficult to accomplish.</p>
</div>
<div class="paragraph">
<p>This document tries to define on a high abstract level, a reference architecture which is supposed to be a mental image and frame for orientation regarding the evaluation and appliance of different client frameworks. As such it defines terms and concepts required to be provided for in any framework and thus gives a common ground of understanding for those acquainted with the reference architecture. This allows better comparison between the various frameworks out there, each having their own terms for essentially the same concepts. It also means that for each framework we need to explicitly map how it implements the concepts defined in this document.</p>
</div>
<div class="paragraph">
<p>The architecture proposed herein is neither new nor was it developed from scratch. Instead it is the gathered and consolidated knowledge and best practices of various projects (s. References).</p>
</div>
</div>
<div class="sect3">
<h4 id="goal-of-the-client-architecture"><a class="anchor" href="#goal-of-the-client-architecture"></a>4.8. Goal of the Client Architecture</h4>
<div class="paragraph">
<p>The goal of the client architecture is to support the non-functional requirements for the client, i.e. mostly maintainability, scalability, efficiency and portability. As such it provides a component-oriented architecture following the same principles listed already in the devonfw architecture overview. Furthermore it ensures a homogeneity regarding how different concrete UI technologies are being applied in the projects, solving the common requirements in the same way.</p>
</div>
</div>
<div class="sect3">
<h4 id="architecture-views"><a class="anchor" href="#architecture-views"></a>4.9. Architecture Views</h4>
<div class="paragraph">
<p>As for the server we distinguish between the business and the technical architecture. Where the business architecture is different from project to project and relates to the concrete design of dialog components given concrete requirements, the technical architecture can be applied to multiple projects.</p>
</div>
<div class="paragraph">
<p>The focus of this document is to provide a technical reference architecture on the client on a very abstract level defining required layers and components. How the architecture is implemented has to be defined for each UI technology.</p>
</div>
<div class="paragraph">
<p>The technical infrastructure architecture is out of scope for this document and although it needs to be considered, the concepts of the reference architecture should work across multiple TI architecture, i.e. native or web clients.</p>
</div>
</div>
<div class="sect3">
<h4 id="devonfw-reference-client-architecture"><a class="anchor" href="#devonfw-reference-client-architecture"></a>4.10. devonfw Reference Client Architecture</h4>
<div class="paragraph">
<p>The following gives a complete overview of the proposed reference architecture. It will be built up incrementally in the following sections.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/devonfw-methodology/OASP_ClientArchitecture_CompleteOverview.png"><img src="_images/images/devonfw-methodology/OASP_ClientArchitecture_CompleteOverview.png" alt="Complete Client Architecture Overview" width="450"></a>
</div>
</div>
<div class="paragraph">
<p><em>Figure 1 Overview</em></p>
</div>
</div>
<div class="sect3">
<h4 id="client-architecture"><a class="anchor" href="#client-architecture"></a>4.11. Client Architecture</h4>
<div class="paragraph">
<p>On the highest level of abstraction we see the need to differentiate between dialog components and their container they are managed in, as well as the access to the application server being the back-end for the client (e.g. an devon4j instance). This section gives a summary of these components and how they relate to each other. Detailed architectures for each component will be supplied in subsequent sections</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/devonfw-methodology/OASP_ClientArchitecture_Overview.png"><img src="_images/images/devonfw-methodology/OASP_ClientArchitecture_Overview.png" alt="Client Architecture Overview" width="450"></a>
</div>
</div>
<div class="paragraph">
<p><em>Figure 2 Overview of Client Architecture</em></p>
</div>
</div>
<div class="sect3">
<h4 id="dialog-component"><a class="anchor" href="#dialog-component"></a>4.12. ==  Dialog Component</h4>
<div class="paragraph">
<p>A dialog component is a logical, self-contained part of the user interface. It accepts user input and actions and controls communication with the user. Dialog components use the services provided by the dialog container in order to execute the business logic. They are self-contained, i.e. they possess their own user interface together with the associated logic, data and states.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Dialog components can be composed of other dialog components forming a hierarchy</p>
</li>
<li>
<p>Dialog components can interact with each other. This includes communication of a parent to its children, but also between components independent of each other regarding the hierarchy.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="dialog-container"><a class="anchor" href="#dialog-container"></a>4.13. ==  Dialog Container</h4>
<div class="paragraph">
<p>Dialog components need to be managed in their life-cycle and how they can be coupled to each other. The dialog container is responsible for this along with the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Bootstrapping the client application and environment</p>
<div class="ulist">
<ul>
<li>
<p>Configuration of the client</p>
</li>
<li>
<p>Initialization of the application server access component</p>
</li>
</ul>
</div>
</li>
<li>
<p>Dialog Component Management</p>
<div class="ulist">
<ul>
<li>
<p>Controlling the life-cycle</p>
</li>
<li>
<p>Controlling the dialog flow</p>
</li>
<li>
<p>Providing means of interaction between the dialogs</p>
</li>
<li>
<p>Providing application server access</p>
</li>
<li>
<p>Providing services to the dialog components<br>
(e.g. printing, caching, data storage)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Shutdown of the application</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="application-server-access"><a class="anchor" href="#application-server-access"></a>4.14. ==  Application Server Access</h4>
<div class="paragraph">
<p>Dialogs will require a back-end application server in order to execute their business logic. Typically in an devonfw application the service layer will provide interfaces for the functionality exposed to the client. These business oriented interfaces should also be present on the client backed by a proxy handling the concrete call of the server over the network. This component provides the set of interfaces as well as the proxy.</p>
</div>
</div>
<div class="sect3">
<h4 id="dialog-container-architecture"><a class="anchor" href="#dialog-container-architecture"></a>4.15. Dialog Container Architecture</h4>
<div class="paragraph">
<p>The dialog container can be further structured into the following components with their respective tasks described in own sections:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/devonfw-methodology/OASP_ClientArchitecture_DialogContainer.png"><img src="_images/images/devonfw-methodology/OASP_ClientArchitecture_DialogContainer.png" alt="Dialog Container Architecture Overview" width="450"></a>
</div>
</div>
<div class="paragraph">
<p><em>Figure 3 Dialog Container Architecture</em></p>
</div>
</div>
<div class="sect3">
<h4 id="application"><a class="anchor" href="#application"></a>4.16. ==  Application</h4>
<div class="paragraph">
<p>The application component represents the overall client in our architecture. It is responsible for bootstrapping all other components and connecting them with each other. As such it initializes the components below and provides an environment for them to work in.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-management"><a class="anchor" href="#configuration-management"></a>4.17. ==  Configuration Management</h4>
<div class="paragraph">
<p>The configuration management manages the configuration of the client, so the client can be deployed in different environments. This includes configuration of the concrete application server to be called or any other environment-specific property.</p>
</div>
</div>
<div class="sect3">
<h4 id="dialog-management"><a class="anchor" href="#dialog-management"></a>4.18. ==  Dialog Management</h4>
<div class="paragraph">
<p>The Dialog Management component provides the means to define, create and destroy dialog components. It therefore offers basic life-cycle capabilities for a component. In addition it also allows composition of dialog components in a hierarchy. The life-cycle is then managed along the hierarchy, meaning when creating/destroying a parent dialog, this affects all child components, which are created/destroyed as well.</p>
</div>
</div>
<div class="sect3">
<h4 id="service-registry"><a class="anchor" href="#service-registry"></a>4.19. ==  Service Registry</h4>
<div class="paragraph">
<p>Apart from dialog components, a client application also consists of services offered to these. A service can thereby encompass among others:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access to the application server</p>
</li>
<li>
<p>Access to the dialog container functions for managing dialogs or accessing the configuration</p>
</li>
<li>
<p>Dialog independent client functionality such as Printing, Caching, Logging, Encapsulated business logic such as tax calculation</p>
</li>
<li>
<p>Dialog component interaction</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The service registry offers the possibility to define, register and lookup these services. Note that these services could be dependent on the dialog hierarchy, meaning different child instances could obtain different instances / implementations of a service via the service registry, depending on which service implementations are registered by the parents.</p>
</div>
<div class="paragraph">
<p>Services should be defined as interfaces allowing for different implementations and thus loose coupling.</p>
</div>
</div>
<div class="sect3">
<h4 id="dialog-component-architecture"><a class="anchor" href="#dialog-component-architecture"></a>4.20. Dialog Component Architecture</h4>
<div class="paragraph">
<p>A dialog component has to support all or a subset of the following tasks:<br>
(T1)	Displaying the user interface incl. internationalization<br>
(T2)	Displaying business data incl. changes made to the data due to user interactions and localization of the data<br>
(T3)	Accepting user input including possible conversion from e.g. entered Text to an Integer<br>
(T4)	Displaying the dialog state<br>
(T5)	Validation of user input<br>
(T6)	Managing the business data incl. business logic altering it due to user interactions<br>
(T7)	Execution of user interactions<br>
(T8)	Managing the state of the dialog (e.g. Edit vs. View)<br>
(T9)	Calling the application server in the course of user interactions</p>
</div>
<div class="paragraph">
<p>Following the principle of separation of concerns, we further structure a dialog component in an own architecture allowing us the distribute responsibility for these tasks along the defined components:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/devonfw-methodology/OASP_ClientArchitecture_DialogComponent.png"><img src="_images/images/devonfw-methodology/OASP_ClientArchitecture_DialogComponent.png" alt="Dialog Component Architecture" width="450"></a>
</div>
</div>
<div class="paragraph">
<p><em>Figure 4 Overview of dialog component architecture</em></p>
</div>
</div>
<div class="sect3">
<h4 id="presentation-layer"><a class="anchor" href="#presentation-layer"></a>4.21. ==  Presentation Layer</h4>
<div class="paragraph">
<p>The presentation layer generates and displays the user interface, accepts user input and user actions and binds these to the dialog core layer (T1-5). The tasks of the presentation layer fall into two categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Provision of the visual representation (View component)</strong><br>
The presentation layer generates and displays the user interface and accepts user input and user actions. The logical processing of the data, actions and states is performed in the dialog core layer. The data and user interface are displayed in localized and internationalized form.</p>
</li>
<li>
<p><strong>Binding of the visual representation to the dialog core layer</strong><br>
The presentation layer itself does not contain any dialog logic. The data or actions entered by the user are then processed in the dialog core layer. There are three aspects to the binding to the dialog core layer. We refer to “data binding”, “state binding” and “action binding”. Syntactical and (to a certain extent) semantic validations are performed during data binding (e.g. cross-field plausibility checks). Furthermore, the formatted, localized data in the presentation layer is converted into the presentation-independent, neutral data in the dialog core layer (parsing) and vice versa (formatting).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="dialog-core-layer"><a class="anchor" href="#dialog-core-layer"></a>4.22. ==  Dialog Core Layer</h4>
<div class="paragraph">
<p>The dialog core layer contains the business logic, the control logic, and the logical state of the dialog. It therefore covers tasks T5-9:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Maintenance of the logical dialog state and the logical data</strong><br>
The dialog core layer maintains the logical dialog state and the logical data in a form which is independent of the presentation. The states of the presentation (e.g. individual widgets) must not be maintained in the dialog core layer, e.g. the view state could lead to multiple presentation states disabling all editable widgets on the view.</p>
</li>
<li>
<p><strong>Implementation of the dialog and dialog control logic</strong><br>
The component parts in the dialog core layer implement the client specific business logic and the dialog control logic. This includes, for example, the manipulation of dialog data and dialog states as well as the opening and closing of dialogs.</p>
</li>
<li>
<p><strong>Communication with the application server</strong><br>
The dialog core layer calls the interfaces of the application server via the application server access component services.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The dialog core layer should not depend on the presentation layer enforcing a strict layering and thus minimizing dependencies.</p>
</div>
</div>
<div class="sect3">
<h4 id="interactions-between-dialog-components"><a class="anchor" href="#interactions-between-dialog-components"></a>4.23. ==  Interactions between dialog components</h4>
<div class="paragraph">
<p>Dialog components can interact in the following ways:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/devonfw-methodology/OASP_ClientArchitecture_DialogInteractions.png"><img src="_images/images/devonfw-methodology/OASP_ClientArchitecture_DialogInteractions.png" alt="Dialog Interactions" width="450"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Embedding of dialog components</strong><br>
As already said dialog components can be hierarchically composed. This composition works by embedding on dialog component within the other. Apart from the life-cycle managed by the dialog container, the embedding needs to cope for the visual embedding of the presentation and core layer.</p>
<div class="ulist">
<ul>
<li>
<p><strong>Embedding dialog presentation</strong><br>
The parent dialog needs to either integrate the embedded dialog in its layout or open it in an own model window.</p>
</li>
<li>
<p><strong>Embedding dialog core</strong><br>
The parent dialog needs to be able to access the embedded instance of its children. This allows initializing and changing their data and states. On the other hand the children might require context information offered by the parent dialog by registering services in the hierarchical service registry.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Dialog flow</strong><br>
Apart from the embedding of dialog components representing a tight coupling, dialogs can interact with each other by passing the control of the UI, i.e. switching from one dialog to another.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When interacting, dialog components should interact only between the same or lower layers, i.e. the dialog core should not access the presentation layer of another dialog component.</p>
</div>
</div>
<div class="sect3">
<h4 id="appendix"><a class="anchor" href="#appendix"></a>4.24. Appendix</h4>

</div>
<div class="sect3">
<h4 id="notes-about-quasar-client"><a class="anchor" href="#notes-about-quasar-client"></a>4.25. Notes about Quasar Client</h4>
<div class="paragraph">
<p>The Quasar client architecture as the consolidated knowledge of our CSD projects is the major source for the above drafted architecture. However, the above is a much simplified and more agile version thereof:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Quasar Client tried to abstract from the concrete UI library being used, so it could decouple the business from the technical logic of a dialog. The presentation layer should be the only one knowing the concrete UI framework used. This level of abstraction was dropped in this reference architecture, although it might of course still make sense in some projects. For fast-moving agile projects in the web however introducing such a level of abstraction takes effort with little gained benefits. With frameworks like Angular 2 we would even introduce one additional seemingly artificial and redundant layer, since it already separates the dialog core from its presentation.</p>
</li>
<li>
<p>In the past and in the days of Struts, JSF, etc. the concept of session handling was important for the client since part of the client was sitting on a server with a session relating it to its remote counterpart on the users PC. Quasar Client catered for this need, by very prominently differentiating between session and application in the root of the dialog component hierarchy. However, in the current days of SPA applications and the lowered importance of servers-side web clients, this prominent differentiation was dropped. When still needed the referenced documents will provide in more detail how to tailor the respective architecture to this end.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="references"><a class="anchor" href="#references"></a>4.26. References</h4>
<div class="ulist">
<ul>
<li>
<p>Architecture Guidelines for Application Design:
<a href="https://troom.capgemini.com/sites/vcc/engineering/Cross%20Cutting/ArchitectureGuide/Architecture_Guidelines_for_Application_Design_v2.0.docx" class="bare">https://troom.capgemini.com/sites/vcc/engineering/Cross%20Cutting/ArchitectureGuide/Architecture_Guidelines_for_Application_Design_v2.0.docx</a></p>
</li>
<li>
<p>Quasar Client Architecture:
<a href="https://troom.capgemini.com/sites/vcc/Shared%20Documents/CrossCuttingContent/TopicOrientedCCC/QuasarOverview/NCE%20Quasar%20Review%20Workshop%202009-11-17/Quasar%20Development/Quasar-Client-Architectures.doc" class="bare">https://troom.capgemini.com/sites/vcc/Shared%20Documents/CrossCuttingContent/TopicOrientedCCC/QuasarOverview/NCE%20Quasar%20Review%20Workshop%202009-11-17/Quasar%20Development/Quasar-Client-Architectures.doc</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="layers-6"><a class="anchor" href="#layers-6"></a>5. Layers</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="components-layer"><a class="anchor" href="#components-layer"></a>5.1. Components Layer</h4>
<div class="paragraph">
<p>The components layer encapsulates all components presenting the current application view state, which means data to be shown to the user.
The term component refers to a component described by the standard <a href="https://www.w3.org/standards/techs/components">Web Components</a>.
So this layer has all Angular components, directives and pipes defined for an application.
The main challenges are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>how to structure the components layer (see <a href="guide-file-structure">File Structure Guide</a>)</p>
</li>
<li>
<p>decompose components into maintainable chunks (see <a href="guide-component-decomposition">Component Decomposition Guide</a>)</p>
</li>
<li>
<p>handle component interaction</p>
</li>
<li>
<p>manage calls to the services layer</p>
</li>
<li>
<p>apply a maintainable data and event flow throughout the component tree</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="smart-and-dumb-components"><a class="anchor" href="#smart-and-dumb-components"></a>5.2. Smart and Dumb Components</h4>
<div class="paragraph">
<p>The architecture applies the concept of <em>Smart</em> and <em>Dumb Components</em> (syn. <em>Containers</em> and <em>Presenters</em>).
The concept means that components are divided into <em>Smart</em> and <em>Dumb Components</em>.</p>
</div>
<div class="paragraph">
<p>A <em>Smart Component</em> typically is a top-level dialog inside the component tree.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a component, that can be routed to</p>
</li>
<li>
<p>a modal dialog</p>
</li>
<li>
<p>a component, which is placed inside <code>AppComponent</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <em>Dumb Component</em> can be used by one to many <em>Smart Components</em>.
Inside the component tree a <em>Dumb Component</em> is a child of a <em>Smart Component</em>.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/component-tree.svg"><img src="_images/images/component-tree.svg" alt="Component Tree" width="450"></a>
</div>
<div class="title">Figure 10. Component tree example</div>
</div>
<div class="paragraph">
<p>As shown the topmost component is always the <code>AppComponent</code> in Angular applications.
The component tree describes the hierarchy of components starting from <code>AppComponent</code>.
The figure shows <em>Smart Components</em> in blue and <em>Dumb Components</em> in green.
<code>AppComponent</code> is a <em>Smart Component</em> by definition.
Inside the template of <code>AppComponent</code> placed components are static components inside the component tree.
So they are always displayed.
In the example <code>OverviewComponent</code> and <code>DetailsComponent</code> are rendered by Angular compiler depending on current URL the application displays.
So <code>OverviewComponents</code> sub-tree is displayed if the URL is <code>/overview</code> and <code>DetailsComponents</code> sub-tree is displayed if the URL is <code>/details</code>.
To clarify this distinction further the following table shows the main differences.</p>
</div>
<div class="paragraph">
<div class="title">Smart vs Dumb Components</div>
<p>|== =
|<em>Smart Components</em> |<em>Dumb Components</em></p>
</div>
<div class="paragraph">
<p>|contain the current view state
|show data via binding (<code>@Input</code>) and contain no view state</p>
</div>
<div class="paragraph">
<p>|handle events emitted by <em>Dumb Components</em>
|pass events up the component tree to be handled by <em>Smart Components</em> (<code>@Output</code>)</p>
</div>
<div class="paragraph">
<p>|call the services layer
|never call the services layer</p>
</div>
<div class="paragraph">
<p>|use services
|do not use services</p>
</div>
<div class="paragraph">
<p>|consists of n <em>Dumb Components</em>
|is independent of <em>Smart Components</em>
|== =</p>
</div>
</div>
<div class="sect3">
<h4 id="interaction-of-smart-and-dumb-components"><a class="anchor" href="#interaction-of-smart-and-dumb-components"></a>5.3. Interaction of Smart and Dumb Components</h4>
<div class="paragraph">
<p>With the usage of the <em>Smart</em> and <em>Dumb Components</em> pattern one of the most important part is component interaction.
Angular comes with built in support for component interaction with <code>@Input()</code> and <code>@Output()</code> Decorators.
The following figure illustrates an unidirectional data flow.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Data always goes down the component tree - from a <em>Smart Component</em> down its children.</p>
</li>
<li>
<p>Events bubble up, to be handled by a <em>Smart Component</em>.</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/smart-dumb-components-interaction.svg"><img src="_images/images/smart-dumb-components-interaction.svg" alt="Smart and Dumb Components Interaction" width="450"></a>
</div>
<div class="title">Figure 11. Smart and Dumb Component Interaction</div>
</div>
<div class="paragraph">
<p>As shown a <em>Dumb Components</em> role is to define a signature by declaring Input and Output Bindings.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@Input()</code> defines what data is necessary for that component to work</p>
</li>
<li>
<p><code>@Output()</code> defines which events can be listened on by the parent component</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Listing 31. Dumb Components define a signature</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export class ValuePickerComponent {

  @Input() columns: string[];
  @Input() items: {}[];
  @Input() selected: {};
  @Input() filter: string;
  @Input() isChunked = false;
  @Input() showInput = true;
  @Input() showDropdownHeader = true;

  @Output() elementSelected = new EventEmitter&lt;{}&gt;();
  @Output() filterChanged = new EventEmitter&lt;string&gt;();
  @Output() loadNextChunk = new EventEmitter();
  @Output() escapeKeyPressed = new EventEmitter();

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example shows the <em>Dumb Component</em> <code>ValuePickerComponent</code>.
It describes seven input bindings with <code>isChunked</code>, <code>showHeader</code> and <code>showDropdownHeader</code> being non mandatory as they have a default value.
Four output bindings are present. Typically, a <em>Dumb Component</em> has very little code to no code inside the TypeScript class.</p>
</div>
<div class="listingblock">
<div class="title">Listing 32. Smart Components use the Dumb Components signature inside the template</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;div&gt;

  &lt;value-input
    ...&gt;
  &lt;/value-input&gt;

  &lt;value-picker
    *ngIf="isValuePickerOpen"
    [columns]="columns"
    [items]="filteredItems"
    [isChunked]="isChunked"
    [filter]="filter"
    [selected]="selectedItem"
    [showDropdownHeader]="showDropdownHeader"
    (loadNextChunk)="onLoadNextChunk()"
    (elementSelected)="onElementSelected($event)"
    (filterChanged)="onFilterChanged($event)"
    (escapeKeyPressed)="onEscapePressedInsideChildTable()"&gt;
  &lt;/value-picker&gt;

&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Inside the <em>Smart Components</em> template the events emitted by <em>Dumb Components</em> are handled.
It is a good practice to name the handlers with the prefix <code>on*</code> (e.g. <code>onInputChanged()</code>).</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="services-layer"><a class="anchor" href="#services-layer"></a>5.4. Services Layer</h4>
<div class="paragraph">
<p>The services layer is more or less what we call 'business logic layer' on the server side.
It is the layer where the business logic is placed.
The main challenges are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Define application state and an API for the components layer to use it</p>
</li>
<li>
<p>Handle application state transitions</p>
</li>
<li>
<p>Perform back-end interaction (XHR, WebSocket, etc.)</p>
</li>
<li>
<p>Handle business logic in a maintainable way</p>
</li>
<li>
<p>Configuration management</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All parts of the services layer are described in this chapter.
An example which puts the concepts together can be found at the end <a href="#interaction-of-smart-components-through-the-services-layer">Interaction of Smart Components through the services layer</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="boundaries"><a class="anchor" href="#boundaries"></a>5.5. Boundaries</h4>
<div class="paragraph">
<p>There are two APIs for the components layer to interact with the services layer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A store can be subscribed to for receiving state updates over time</p>
</li>
<li>
<p>A use case service can be called to trigger an action</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To illustrate the fact the following figure shows an abstract overview.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/components-layer-service-layer-boundaries.svg"><img src="_images/images/components-layer-service-layer-boundaries.svg" alt="Smart and Dumb Components Interaction" width="450"></a>
</div>
<div class="title">Figure 12. Boundaries to components layer</div>
</div>
</div>
<div class="sect3">
<h4 id="store"><a class="anchor" href="#store"></a>5.6. Store</h4>
<div class="paragraph">
<p>A store is a class which defines and handles application state with its transitions over time.
Interaction with a store is always synchronous.
A basic implementation using RxJS can look like this.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A more profound implementation taken from a real-life project can be found here (<a href="cookbook-abstract-class-store">Abstract Class Store</a>).
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Listing 33. Store defined using RxJS</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">@Injectable()
export class ProductSearchStore {

  private stateSource = new BehaviorSubject&lt;ProductSearchState&gt;(defaultProductSearchState);
  state$ = this.stateSource.asObservable();

  setLoading(isLoading: boolean) {
    const currentState = this.stateSource.getValue();
    this.stateSource.next({
      isLoading: isLoading,
      products: currentState.products,
      searchCriteria: currentState.searchCriteria
    });
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the example <code>ProductSearchStore</code> handles state of type <code>ProductSearchState</code>.
The public API is the property <code>state$</code> which is an observable of type <code>ProductSearchState</code>.
The state can be changed with method calls.
So every desired change to the state needs to be modeled with an method.
In reactive terminology this would be an <em>Action</em>.
The store does not use any services.
Subscribing to the <code>state$</code> observable leads to the subscribers receiving every new state.</p>
</div>
<div class="paragraph">
<p>This is basically the <em>Observer Pattern</em>:<br>
The store consumer registers itself to the observable via <code>state$.subscribe()</code> method call.
The first parameter of <code>subscribe()</code> is a callback function to be called when the subject changes.
This way the consumer - the observer - is registered.
When next() is called with a new state inside the store, all callback functions are called with the new value.
So every observer is notified of the state change.
This equals the <em>Observer Pattern</em> push type.</p>
</div>
<div class="paragraph">
<p>A store is the API for <em>Smart Components</em> to receive state from the service layer.
State transitions are handled automatically with <em>Smart Components</em> registering to the <code>state$</code> observable.</p>
</div>
</div>
<div class="sect3">
<h4 id="use-case-service"><a class="anchor" href="#use-case-service"></a>5.7. Use Case Service</h4>
<div class="paragraph">
<p>A use case service is a service which has methods to perform asynchronous state transitions.
In reactive terminology this would be an <em>Action of Actions</em> - a thunk (<code>redux</code>) or an effect (<code>@ngrx</code>).</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/use-case-service.svg"><img src="_images/images/use-case-service.svg" alt="Use Case Service" width="450"></a>
</div>
<div class="title">Figure 13. Use case services are the main API to trigger state transitions</div>
</div>
<div class="paragraph">
<p>A use case services method - an action - interacts with adapters, business services and stores.
So use case services orchestrate whole use cases.
For an example see <code><a href="#usecaseservice-example">use case service example</a></code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="adapter"><a class="anchor" href="#adapter"></a>5.8. Adapter</h4>
<div class="paragraph">
<p>An adapter is used to communicate with the back-end.
This could be a simple XHR request, a WebSocket connection, etc.
An adapter is simple in the way that it does not add anything other than the pure network call.
So there is no caching or logging performed here.
The following listing shows an example.</p>
</div>
<div class="paragraph">
<p>For further information on back-end interaction see <a href="guide-consuming-rest-services">Consuming REST Services</a></p>
</div>
<div class="listingblock">
<div class="title">Listing 34. Calling the back-end via an adapter</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">@Injectable()
export class ProducsAdapter {

  private baseUrl = environment.baseUrl;

  constructor(private http: HttpClient) { }

  getAll(): Observable&lt;Product[]&gt; {
    return this.http.get&lt;Product[]&gt;(this.baseUrl + '/products');
  }

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="interaction-of-smart-components-through-the-services-layer"><a class="anchor" href="#interaction-of-smart-components-through-the-services-layer"></a>5.9. Interaction of Smart Components through the services layer</h4>
<div class="paragraph">
<p>The interaction of smart components is a classic problem which has to be solved in every UI technology.
It is basically how one dialog tells the other something has changed.</p>
</div>
<div class="paragraph">
<p>An example is <em>adding an item to the shopping basket</em>.
With this action there need to be multiple state updates.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The small logo showing how many items are currently inside the basket needs to be updated from 0 to 1</p>
</li>
<li>
<p>The price needs to be recalculated</p>
</li>
<li>
<p>Shipping costs need to be checked</p>
</li>
<li>
<p>Discounts need to be updated</p>
</li>
<li>
<p>Ads need to be updated with related products</p>
</li>
<li>
<p>etc.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="pattern"><a class="anchor" href="#pattern"></a>5.10. Pattern</h4>
<div class="paragraph">
<p>To handle this interaction in a scalable way we apply the following pattern.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/smart-component-interaction-via-services-layer.svg"><img src="_images/images/smart-component-interaction-via-services-layer.svg" alt="Interaction of Smart Components via services layer" width="450"></a>
</div>
<div class="title">Figure 14. Smart Component interaction</div>
</div>
<div class="paragraph">
<p>The state of interest is encapsulated inside a store. All <em>Smart Components</em> interested in the state have to subscribe to the store&#8217;s API served by the public observable. Thus, with every update to the store the subscribed components receive the new value. The components basically react to state changes. Altering a store can be done directly if the desired change is synchronous. Most actions are of asynchronous nature so the <code>UseCaseService</code> comes into play. Its actions are <code>void</code> methods, which implement a use case, i.e., adding a new item to the basket. It calls asynchronous actions and can perform multiple store updates over time.</p>
</div>
<div class="paragraph">
<p>To put this pattern into perspective the <code>UseCaseService</code> is a programmatic alternative to <code>redux-thunk</code> or <code>@ngrx/effects</code>. The main motivation here is to use the full power of TypeScript <code>--strictNullChecks</code> and to let the learning curve not to become as steep as it would be when learning a new state management framework. This way actions are just <code>void</code> method calls.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-4"><a class="anchor" href="#example-4"></a>5.11. Example</h4>
<div class="imageblock">
<div class="content">
<a class="image" href="images/smart-smart-components-example.svg"><img src="_images/images/smart-smart-components-example.svg" alt="Smart component interaction example" width="450"></a>
</div>
<div class="title">Figure 15. Smart Components interaction example</div>
</div>
<div class="paragraph">
<p>The example shows two <em>Smart Components</em> sharing the <code>FlightSearchState</code> by using the <code>FlightSearchStore</code>.
The use case shown is started by an event in the <em>Smart Component</em> <code>FlightSearchComponent</code>. The action <code>loadFlight()</code> is called. This could be submitting a search form.
The <code>UseCaseService</code> is <code>FlightSearchService</code>, which handles the use case <em>Load Flights</em>.</p>
</div>
<div class="paragraph">
<div class="title"><code>UseCaseService</code> example</div>
<p><code><a id="usecaseservice-example"></a></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export class FlightSearchService {

  constructor(
    private flightSearchAdapter: FlightSearchAdapter,
    private store: FlightSearchStore
  ) { }

  loadFlights(criteria: FlightSearchCriteria): void {
    this.store.setLoadingFlights(true);
    this.store.clearFlights();

    this.flightSearchAdapter.getFlights(criteria.departureDate,
        {
          from: criteria.departureAirport,
          to: criteria.destinationAirport
        })
      .finally(() =&gt; this.store.setLoadingFlights(false))
      .subscribe((result: FlightTo[]) =&gt; this.store.setFlights(result, criteria));
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>First the loading flag is set to <code>true</code> and the current flights are cleared. This leads the <em>Smart Component</em> showing a spinner indicating the loading action. Then the asynchronous XHR is triggered by calling the adapter. After completion the loading flag is set to <code>false</code> causing the loading indication no longer to be shown. If the XHR was successful, the data would be put into the store. If the XHR was not successful, this would be the place to handle a custom error. All general network issues should be handled in a dedicated class, i.e., an interceptor. So for example the basic handling of 404 errors is not done here.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="guides-5"><a class="anchor" href="#guides-5"></a>6. Guides</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="package-managers"><a class="anchor" href="#package-managers"></a>6.1. Package Managers</h4>
<div class="paragraph">
<p>There are two major package managers currently used for JavaScript / TypeScript projects which leverage NodeJS as a build platform.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://www.npmjs.com/">npm</a></p>
</li>
<li>
<p><a href="https://yarnpkg.com">yarn</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Our recommendation is to use yarn but both package managers are fine.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
When using npm it is important to use a version greater 5.0 as npm 3 has major drawbacks compared to yarn.
The following guide assumes that you are using npm &gt;= 5 or yarn.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before you start reading further, please take a look at the docs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://yarnpkg.com/en/docs/getting-started">yarn getting started</a></p>
</li>
<li>
<p><a href="https://docs.npmjs.com/getting-started/what-is-npm">npm getting started</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following guide will describe best practices for working with yarn / npm.</p>
</div>
</div>
<div class="sect3">
<h4 id="semantic-versioning"><a class="anchor" href="#semantic-versioning"></a>6.2. Semantic Versioning</h4>
<div class="paragraph">
<p>When working with package managers it is very important to understand the concept of <a href="https://semver.org/">semantic versioning</a>.</p>
</div>
<div class="paragraph">
<div class="title">Version example 1.2.3</div>
<p>|== == == =
|Version                        |1.             |2.             |3
|Version name when incrementing |Major (2.0.0)  |Minor (1.3.0)  |Patch (1.2.4)
|Has breaking changes           |yes            |no             |no
|Has features                   |yes            |yes            |no
|Has bug fixes                   |yes            |yes            |yes
|== == == =</p>
</div>
<div class="paragraph">
<p>The table gives an overview of the most important parts of semantic versioning.
In the header version 1.2.3 is displayed.
The first row shows the name and the resulting version when incrementing a part of the version.
The next rows show specifics of the resulting version - e.g. a major version can have breaking changes, features and bug fixes.</p>
</div>
<div class="paragraph">
<p>Packages from npm and yarn leverage semantic versioning and instead of selecting a fixed version one can specify a selector.
The most common selectors are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>^1.2.3</strong>
At least 1.2.3 - 1.2.4 or 1.3.0 can be used, 2.0.0 can not be used</p>
</li>
<li>
<p><strong>~1.2.3</strong>
At lease 1.2.3 - 1.2.4 can be used, 2.0.0 and 1.3.0 can not be used</p>
</li>
<li>
<p><strong>&gt;=1.2.3</strong>
At least 1.2.3 - every version greater can also be used</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This achieves a lower number of duplicates.
To give an example:</p>
</div>
<div class="paragraph">
<p>If package A needs version 1.3.0 of package C and package B needs version 1.4.0 of package C one would end up with 4 packages.</p>
</div>
<div class="paragraph">
<p>If package A needs version ^1.3.0 of package C and package B needs version 1.4.0 of package C one would end up with 3 packages.
A would use the same version of C as B - 1.4.0.</p>
</div>
</div>
<div class="sect3">
<h4 id="do-not-modify-package-json-and-lock-files-by-hand"><a class="anchor" href="#do-not-modify-package-json-and-lock-files-by-hand"></a>6.3. Do not modify package.json and lock files by hand</h4>
<div class="paragraph">
<p>Dependencies are always added using a yarn or npm command.
Altering the package.json, package-json.lock or yarn.lock file by hand is not recommended.</p>
</div>
<div class="paragraph">
<p>Always use a yarn or npm command to add a new dependency.</p>
</div>
<div class="paragraph">
<p>Adding the package <code>express</code> with yarn to dependencies.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">yarn add express</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adding the package <code>express</code> with npm to dependencies.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install express</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="what-does-the-lock-file-do"><a class="anchor" href="#what-does-the-lock-file-do"></a>6.4. What does the lock file do</h4>
<div class="paragraph">
<p>The purpose of files <code>yarn.lock</code> and <code>package-json.lock</code> is to freeze versions for a short time.</p>
</div>
<div class="paragraph">
<p>The following problem is solved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Developer A upgrades the dependency <code>express</code> to fixed version <code>4.16.3</code>.</p>
</li>
<li>
<p><code>express</code> has sub-dependency <code>accepts</code> with version selector <code>~1.3.5</code></p>
</li>
<li>
<p>His local <code>node_modules</code> folder receives <code>accepts</code> in version <code>1.3.5</code></p>
</li>
<li>
<p>On his machine everything is working fine</p>
</li>
<li>
<p>Afterward version <code>1.3.6</code> of <code>accepts</code> is published - it contains a major bug</p>
</li>
<li>
<p>Developer B now clones the repo and loads the dependencies.</p>
</li>
<li>
<p>He receives version <code>1.3.6</code> of <code>accepts</code> and blames developer A for upgrading to a broken version.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both <code>yarn.lock</code> and <code>package-json.lock</code> freeze all the dependencies.
For example in yarn lock you will find.</p>
</div>
<div class="listingblock">
<div class="title">Listing 35. yarn.lock example (excerp)</div>
<div class="content">
<pre class="highlightjs highlight"><code>accepts@~1.3.5:
  version "1.3.5"
  resolved "[...URL to registry]"
  dependencies:
    mime-types "~2.1.18"
    negotiator "0.6.1"

mime-db@~1.33.0:
  version "1.33.0"
  resolved "[...URL to registry]"

mime-types@~2.1.18:
  version "2.1.18"
  resolved "[...URL to registry]"
  dependencies:
    mime-db "~1.33.0"

negotiator@0.6.1:
  version "0.6.1"
  resolved "[...URL to registry]"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The described problem is solved by the example yarn.lock file.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>accepts</code> is frozen at version <code>~1.3.5</code></p>
</li>
<li>
<p>All of its sub-dependencies are also frozen.
It needs <code>mime-types</code> at version <code>~2.1.18</code> which is frozen at <code>2.1.18</code>.
<code>mime-types</code> needs <code>mime-db</code> at <code>~1.33.0</code> which is frozen at <code>1.33.0</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Every developer will receive the same versions of every dependency.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You have to make sure all your developers are using the same npm/yarn version - this includes the CI build.
</td>
</tr>
</table>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="package-managers-workflow"><a class="anchor" href="#package-managers-workflow"></a>6.5. Package Managers Workflow</h4>

</div>
<div class="sect3">
<h4 id="introduction-4"><a class="anchor" href="#introduction-4"></a>6.6. Introduction</h4>
<div class="paragraph">
<p>This document aims to provide you the necessary documentation and sources in order to help you understand the importance of dependencies between packages.</p>
</div>
<div class="paragraph">
<p>Projects in NodeJS make use of modules, chunks of reusable code made by other people or teams. These small chunks of reusable code are called packages <sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup>. Packages are used to solve specific problems or tasks. These relations between your project and the external packages are called dependencies.</p>
</div>
<div class="paragraph">
<p>For example, imagine we are doing a small program that takes your birthday as an input and tells you how many days are left until your birthday. We search in the repository if someone has published a package to retrieve the actual date and manage date types, and maybe we could search for another package to show a calendar, because we want to optimize our time, and we wish the user to click a calendar button and choose the day in the calendar instead of typing it.</p>
</div>
<div class="paragraph">
<p>As you can see, packages are convenient. In some cases, they may be even needed, as they can manage aspects of your program you may not be proficient in, or provide an easier use of them.</p>
</div>
<div class="paragraph">
<p>For more comprehensive information visit <a href="https://docs.npmjs.com/getting-started/what-is-npm">npm definition</a></p>
</div>
</div>
<div class="sect3">
<h4 id="package-json"><a class="anchor" href="#package-json"></a>6.7. Package.json</h4>
<div class="paragraph">
<p>Dependencies in your project are stored in a file called package.json. Every package.json must contain, at least, the name and version of your project.</p>
</div>
<div class="paragraph">
<p>Package.json is located in the root of your project.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If package.json is not on your root directory refer to <a href="#problems-you-may-encounter">Problems you may encounter</a> section
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you wish to learn more information about package.json, click on the following links:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://yarnpkg.com/en/docs/package-json">Yarn Package.json</a></p>
</li>
<li>
<p><a href="https://docs.npmjs.com/getting-started/using-a-package.json">npm Package.json</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="content-of-package-json"><a class="anchor" href="#content-of-package-json"></a>6.8. ==  Content of package.json</h4>
<div class="paragraph">
<p>As you noticed, package.json is a really important file in your project. It contains essential information about our project, therefore you need to understand what&#8217;s inside.</p>
</div>
<div class="paragraph">
<p>The structure of package.json is divided in blocks, inside the first one you can find essential information of your project such as the name, version, license and optionally some <a href="#Scripts">[Scripts]</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "name": "exampleproject",
  "version": "0.0.0",
  "license": "MIT",
  "scripts": {
    "ng": "ng",
    "start": "ng serve",
    "build": "ng build",
    "test": "ng test",
    "lint": "ng lint",
    "e2e": "ng e2e"
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next block is called <em>dependencies</em> and contains the packages that project needs in order to be developed, compiled and executed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"private": true,
  "dependencies": {
    "@angular/animations": "^4.2.4",
    "@angular/common": "^4.2.4",
    "@angular/forms": "^4.2.4",
    ...
    "zone.js": "^0.8.14"
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>After <em>dependencies</em> we find <code><strong><em>devDependencies</em></strong></code>, another kind of dependencies present in the development of the application but unnecessary for its execution. One example is typescript. Code is written in typescript, and then, <em>transpiled</em> to JavaScript. This means the application is not using typescript in execution and consequently not included in the deployment of our application.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"devDependencies": {
    "@angular/cli": "1.4.9",
    "@angular/compiler-cli": "^4.2.4",
    ...
    "@types/node": "~6.0.60",
    "typescript": "~2.3.3"
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Having a peer dependency means that your package needs a dependency that is the same exact dependency as the person installing your package</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"peerDependencies": {
    "package-123": "^2.7.18"
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Optional dependencies are just that: optional. If they fail to install, Yarn will still say the install process was successful.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"optionalDependencies": {
    "package-321": "^2.7.18"
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally you can have bundled dependencies which are packages bundled together when publishing your package in a repository.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "bundledDependencies": [
    "package-4"
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here is the link to an in-depth explanation of <a href="https://yarnpkg.com/en/docs/dependency-types">dependency types</a>&#8203;.</p>
</div>
</div>
<div class="sect3">
<h4 id="scripts-2"><a class="anchor" href="#scripts-2"></a>6.9. ==  Scripts</h4>
<div class="paragraph">
<p>Scripts are a great way of automating tasks related to your package, such as simple build processes or development tools.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "name": "exampleproject",
  "version": "0.0.0",
  "license": "MIT",
  "scripts": {
    "build-project": "node hello-world.js",
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can run that script by running the command <code>yarn (run) script</code> or <code>npm run script</code>, check the example below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn (run) build-project    # run is optional
$ npm run build-project</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are special reserved words for scripts, like pre-install, which will execute the script automatically
before the package you install are installed.</p>
</div>
<div class="paragraph">
<p>Check different uses for scripts in the following links:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://yarnpkg.com/en/docs/package-json#toc-scripts">Yarn scripts documentation</a></p>
</li>
<li>
<p><a href="https://docs.npmjs.com/misc/scripts">npm scripts documentation</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Or you can go back to
<a href="#Content of package.json">[Content of package.json]</a>&#8203;.<br></p>
</div>
</div>
<div class="sect3">
<h4 id="managing-dependencies"><a class="anchor" href="#managing-dependencies"></a>6.10. Managing dependencies</h4>
<div class="paragraph">
<p>In order to manage dependencies we recommend using package managers in your projects.</p>
</div>
<div class="paragraph">
<p>A big reason is their usability. Adding or removing a package is really easy, and by doing so, packet manager update the package.json and copies (or removes) the package in the needed location, with a single command.</p>
</div>
<div class="paragraph">
<p>Another reason, closely related to the first one, is reducing human error by automating the package management process.</p>
</div>
<div class="paragraph">
<p>Two of the package managers you can use in NodeJS projects are "yarn" and "npm". While you can use both, we encourage you to use only one of them while working on projects. Using both may lead to different dependencies between members of the team.</p>
</div>
</div>
<div class="sect3">
<h4 id="npm-2"><a class="anchor" href="#npm-2"></a>6.11. ==  npm</h4>
<div class="paragraph">
<p>We&#8217;ll start by installing npm following this small guide <a href="https://docs.npmjs.com/getting-started/installing-node">here</a>.</p>
</div>
<div class="paragraph">
<p>As stated on the web, npm comes inside of NodeJS, and must be updated after installing NodeJS, in the same guide you used earlier are written the instructions to update npm.</p>
</div>
<div class="paragraph">
<p><strong>How npm works</strong></p>
</div>
<div class="paragraph">
<p>In order to explain how npm works, let&#8217;s take a command as an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install @angular/material @angular/cdk</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command tells npm to look for the packages <code>@angular/material</code> and <code>@angular/cdk</code> in the npm registry, download and decompress them in the folder node_modules along with their own dependencies. Additionally, npm will update package.json and create a new file called package-lock.json.</p>
</div>
<div class="paragraph">
<p>After initialization and installing the first package there will be a new folder called node_modules in your project. This folder is where your packages are unzipped and stored, following a tree scheme.</p>
</div>
<div class="paragraph">
<p>Take in consideration both npm and yarn need a package.json in the root of your project in order to work properly. If after creating your project don&#8217;t have it, download again the package.json from the repository or you&#8217;ll have to start again.</p>
</div>
<div class="paragraph">
<p><strong>Brief overview of commands</strong></p>
</div>
<div class="paragraph">
<p>If we need to create a package.json from scratch, we can use the command <strong>init</strong>. This command asks the user for basic information about the project and creates a brand new package.json.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm init</code></pre>
</div>
</div>
<div class="paragraph">
<p>Install (or i) installs all modules listed as dependencies in package.json <strong>locally</strong>. You can also specify a package, and install that package. Install can also be used with the parameter <code>-g</code>, which tells npm to install the <a href="#Global package">[Global package]</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install
$ npm i
$ npm install Package</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Earlier versions of npm did <strong>not</strong> add dependencies to package.json unless it was used with the flag <code>--save</code>, so npm install package would be npm install <code>--save</code> package, you have one example below.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install --save Package</code></pre>
</div>
</div>
<div class="paragraph">
<p>Npm needs flags in order to know what kind of dependency you want in your project, in npm you need to put the flag <code>-D</code> or <code>--save-dev</code> to install <code>devDependencies</code>, for more information consult the links at the end of this section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install -D package
$ npm install --save-dev package</code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8203;</p>
</div>
<div class="paragraph">
<p>The next command uninstalls the module you specified in the command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm uninstall Package</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>ls</code> command shows us the dependencies like a nested tree, useful if you have few packages, not so useful when you need a lot of packages.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm ls</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>npm@@VERSION@ /path/to/npm
└─┬ init-package-json@0.0.4
  └── promzard@0.1.5</pre>
</div>
</div>
<div class="paragraph">
<div class="title">example tree</div>
<p>We recommend you to learn more about npm commands in the following <a href="https://docs.npmjs.com/">link</a>, navigating to the section CLI commands.</p>
</div>
<div class="paragraph">
<p><strong>About Package-lock.json</strong></p>
</div>
<div class="paragraph">
<p>Package-lock.json describes the dependency tree resulting of using package.json and npm.
Whenever you update, add or remove a package, package-lock.json is deleted and redone with
the new dependencies.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"> "@angular/animations": {
      "version": "4.4.6",
      "resolved": "https://registry.npmjs.org/@angular/animations/-/animations-4.4.6.tgz",
      "integrity": "sha1-+mYYmaik44y3xYPHpcl85l1ZKjU=",
      "requires": {
        "tslib": "1.8.0"
      }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This lock file is checked every time the command npm i (or npm install) is used without specifying a package,
in the case it exists and it&#8217;s valid, npm will install the exact tree that was generated, such that subsequent
installs are able to generate identical dependency trees.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
It is <strong>not</strong> recommended to modify this file yourself. It&#8217;s better to leave its management to npm.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>More information is provided by the npm team at <a href="https://docs.npmjs.com/files/package-lock.json">package-lock.json</a></p>
</div>
</div>
<div class="sect3">
<h4 id="yarn-2"><a class="anchor" href="#yarn-2"></a>6.12. ==  Yarn</h4>
<div class="paragraph">
<p>Yarn is an alternative to npm, if you wish to install yarn follow the guide <a href="https://yarnpkg.com/en/docs/install">getting started with yarn</a> and download the correct version for your operative system. NodeJS is also needed you can find it <a href="https://nodejs.org/en/">here</a>.</p>
</div>
<div class="paragraph">
<p><strong>Working with yarn</strong></p>
</div>
<div class="paragraph">
<p>Yarn is used like npm, with small differences in syntax, for example <em>npm install module</em> is changed to <em>yarn add module</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn add @covalent</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command is going to download the required packages, modify package.json, put the package in the folder node_modules and makes a new yarn.lock with the new dependency.</p>
</div>
<div class="paragraph">
<p>However, unlike npm, yarn maintains a cache with packages you download inside. You don&#8217;t need to download every file every time you do a general installation. This means installations faster than npm.</p>
</div>
<div class="paragraph">
<p>Similarly to npm, yarn creates and maintains his own lock file, called yarn.lock. Yarn.lock gives enough information about the project for dependency tree to be reproduced.</p>
</div>
<div class="paragraph">
<p><strong>yarn commands</strong></p>
</div>
<div class="paragraph">
<p>Here we have a brief description of yarn&#8217;s most used commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn add Package
$ yarn add --dev Package</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adds a package <strong>locally</strong> to use in your package. Adding the flags <code>--dev</code> or <code>-D</code> will add them to <code>devDependencies</code> instead of the default dependencies, if you need more information check the links at the end of the section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn init</code></pre>
</div>
</div>
<div class="paragraph">
<p>Initializes the development of a package.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn install</code></pre>
</div>
</div>
<div class="paragraph">
<p>Installs all the dependencies defined in a package.json file, you can also write "yarn" to achieve the same effect.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn remove Package</code></pre>
</div>
</div>
<div class="paragraph">
<p>You use it when you wish to remove a package from your project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn global add Package</code></pre>
</div>
</div>
<div class="paragraph">
<p>Installs the <a href="#Global package">[Global package]</a>.</p>
</div>
<div class="paragraph">
<p>Please, refer to the documentation to learn more about yarn commands and their attributes: <a href="https://yarnpkg.com/en/docs/cli/">yarn commands</a></p>
</div>
<div class="paragraph">
<p><strong>yarn.lock</strong></p>
</div>
<div class="paragraph">
<p>This file has the same purpose as Package-lock.json, to guide the packet manager, in this case yarn,
to install the dependency tree specified in yarn.lock.</p>
</div>
<div class="paragraph">
<p>Yarn.lock and package.json are
essential files when collaborating in a project more co-workers and may be a
source of errors if programmers do not use the same manager.</p>
</div>
<div class="paragraph">
<p>Yarn.lock follows the same structure as package-lock.json, you can find an example of dependency below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"@angular/animations@^4.2.4":
  version "4.4.6"
  resolved "https://registry.yarnpkg.com/@angular/animations/-/animations-4.4.6.tgz#fa661899a8a4e38cb7c583c7a5c97ce65d592a35"
  dependencies:
    tslib "^1.7.1"</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
As with package-lock.json, it&#8217;s strongly <strong>not</strong> advised to modify this file. Leave its management to yarn
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can learn more about yarn.lock here: <a href="https://yarnpkg.com/en/docs/yarn-lock">yarn.lock</a></p>
</div>
</div>
<div class="sect3">
<h4 id="global-package"><a class="anchor" href="#global-package"></a>6.13. ==  Global package</h4>
<div class="paragraph">
<p>Global packages are packages installed in your operative system instead of your local project,
global packages useful for developer tooling that is not part of any individual project but instead is used for local commands.</p>
</div>
<div class="paragraph">
<p>A good example of global package is <code>@angular/cli</code>, a command line interface for angular used in our projects. You can install
a global package in npm with "npm install -g package" and "yarn global add package" with yarn, you have a npm example below:</p>
</div>
<div class="listingblock">
<div class="title">Listing 36. npm global package</div>
<div class="content">
<pre>npm install –g @angular/cli</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://docs.npmjs.com/getting-started/installing-npm-packages-globally">Global npm</a><br>
<a href="https://yarnpkg.com/lang/en/docs/cli/global/">Global yarn</a></p>
</div>
</div>
<div class="sect3">
<h4 id="package-version"><a class="anchor" href="#package-version"></a>6.14. ==  Package version</h4>
<div class="paragraph">
<p>Dependencies are critical to the success of a package. You must be extra careful about
which version packages are using, one package in a different version may break your code.</p>
</div>
<div class="paragraph">
<p>Versioning in npm and yarn, follows a semantic called semver, following the logic
MAJOR.MINOR.PATCH, like for example, @angular/animations: 4.4.6.</p>
</div>
<div class="paragraph">
<p><strong>Different versions</strong></p>
</div>
<div class="paragraph">
<p>Sometimes, packages are installed with a different version from the one initially installed.
This happens because package.json also contains the range of versions we allow yarn or npm to
install or update to, example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"@angular/animations": "^4.2.4"</code></pre>
</div>
</div>
<div class="paragraph">
<p>And here the installed one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"> "@angular/animations": {
      "version": "4.4.6",
      "resolved": "https://registry.npmjs.org/@angular/animations/-/animations-4.4.6.tgz",
      "integrity": "sha1-+mYYmaik44y3xYPHpcl85l1ZKjU=",
      "requires": {
        "tslib": "1.8.0"
      }</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the version we initially added is 4.2.4, and the version finally installed after
a global installation of all packages, 4.4.6.</p>
</div>
<div class="paragraph">
<p>Installing packages without package-lock.json or yarn.lock using their respective packet managers, will always
end with npm or yarn installing the latest version allowed by package.json.</p>
</div>
<div class="paragraph">
<p>"@angular/animations": "^4.2.4" contains not only the version we added, but also the range we allow npm and yarn
to update. Here are some examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"@angular/animations": "&lt;4.2.4"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The version installed must be lower than 4.2.4 .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"@angular/animations": "&gt;=4.2.4"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The version installed must be greater than or equal to 4.2.4 .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"@angular/animations": "=4.2.4"</code></pre>
</div>
</div>
<div class="paragraph">
<p>the version installed must be equal to 4.2.4 .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"@angular/animations": "^4.2.4"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The version installed cannot modify the first non zero digit, for example in this case
it cannot surpass 5.0.0 or be lower than 4.2.4 .</p>
</div>
<div class="paragraph">
<p>You can learn more about this in <a href="https://yarnpkg.com/en/docs/dependency-versions">Versions</a></p>
</div>
</div>
<div class="sect3">
<h4 id="problems-you-may-encounter"><a class="anchor" href="#problems-you-may-encounter"></a>6.15. Problems you may encounter</h4>
<div class="paragraph">
<p>If you can&#8217;t find package.json, you may have deleted the one you had previously,
which means you have to download the package.json from the repository.
In the case you are creating a new project you can create a new package.json. More information
in the links below. Click on <a href="#package-json">Package.json</a> if you come from that section. <br></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://yarnpkg.com/en/docs/cli/init">Creating new package.json in yarn</a><br></p>
</li>
<li>
<p><a href="https://docs.npmjs.com/cli/init">Creating new package.json in npm</a><br></p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Using npm install or yarn without package.json in your projects will
result in compilation errors. As we mentioned earlier,
Package.json contains essential information about your project.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you have package.json, but you don&#8217;t have package-lock.json or yarn.lock the use of
command "npm install" or "yarn"  may result in a different dependency tree.</p>
</div>
<div class="paragraph">
<p>If you are trying to import a module and visual code studio is not able to find it,
is usually caused by error adding the package to the project, try to add the module again with yarn or npm,
and restart Visual Studio Code.</p>
</div>
<div class="paragraph">
<p>Be careful with the semantic versioning inside your package.json of the packages,
or you may find a new update on one of your dependencies breaking your code.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In the following <a href="https://yarnpkg.com/en/docs/selective-version-resolutions">link</a>
there is a solution to a problematic update to one package.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A list of common errors of npm can be found in: <a href="https://docs.npmjs.com/troubleshooting/common-errors">npm errors</a></p>
</div>
</div>
<div class="sect3">
<h4 id="recomendations"><a class="anchor" href="#recomendations"></a>6.16. ==  Recomendations</h4>
<div class="paragraph">
<p>Use yarn <strong>or</strong> npm in your project, reach an agreement with your team in order to choose one, this will avoid
undesired situations like forgetting to upload an updated yarn.lock or package-lock.json.
Be sure to have the latest version of your project when possible.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Pull your project every time it&#8217;s updated. Erase your node_modules folder and reinstall all
dependencies. This assures you to be working with the same dependencies your team has.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>AD Center recommends the use of yarn.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="yarn-2-2"><a class="anchor" href="#yarn-2-2"></a>6.17. Yarn 2</h4>
<div class="paragraph">
<p>Yarn v2 is a very different software from the v1. The following list contains the main new features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://yarnpkg.com/features/constraints">Constraints</a></p>
</li>
<li>
<p><a href="https://yarnpkg.com/features/offline-cache">Offline Cache</a></p>
</li>
<li>
<p><a href="https://yarnpkg.com/features/pnp">Plug&#8217;n&#8217;Play</a></p>
</li>
<li>
<p><a href="https://yarnpkg.com/features/plugins">Plugins</a></p>
</li>
<li>
<p><a href="https://yarnpkg.com/features/protocols">Protocols</a></p>
</li>
<li>
<p><a href="https://yarnpkg.com/features/release-workflow">Release Workflow</a></p>
</li>
<li>
<p><a href="https://yarnpkg.com/features/workspaces">Workspaces</a></p>
</li>
<li>
<p><a href="https://yarnpkg.com/features/zero-installs">Zero-Installs</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please, read them carefully to decide if your current project is suitable to use Yarn 2 as package manager.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Some features are still experimental, so please do not use them in production environments.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>More info at <a href="https://yarnpkg.com/" class="bare">https://yarnpkg.com/</a></p>
</div>
</div>
<div class="sect3">
<h4 id="global-install"><a class="anchor" href="#global-install"></a>6.18. Global Install</h4>
<div class="paragraph">
<p>Installing Yarn 2.x globally is discouraged as Yarn team is moving to a per-project install strategy. We advise you to keep Yarn 1.x (Classic) as your global binary by installing it via the instructions you can find <a href="https://classic.yarnpkg.com/en/docs/install">here</a>.</p>
</div>
<div class="paragraph">
<p>Once you&#8217;ve followed the instructions (running yarn --version from your home directory should yield something like 1.22.0), go to the next section to see how to enable Yarn 2 on your project.</p>
</div>
</div>
<div class="sect3">
<h4 id="per-project-install"><a class="anchor" href="#per-project-install"></a>6.19. Per-project install</h4>
<div class="paragraph">
<p>Follow these instructions to update your current devon4ng project to Yarn 2:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Follow the global install instructions.</p>
</li>
<li>
<p>Move into your project folder:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd ~/path/to/project</code></pre>
</div>
</div>
</li>
<li>
<p>Run the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">yarn policies set-version berry # below v1.22
yarn set version berry          # on v1.22+</code></pre>
</div>
</div>
</li>
<li>
<p>Since Angular CLI still is not fully supported with the new <a href="https://yarnpkg.com/advanced/architecture">Yarn architecture</a> as it is not compatible with PnP it is necessary to include the <a href="https://github.com/yarnpkg/berry/tree/master/packages/plugin-nm"><code>node-modules</code></a> plugin adding the following line in the <code>.yarnrc.yml</code> file:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yml hljs" data-lang="yml">nodeLinker: node-modules</code></pre>
</div>
</div>
</li>
<li>
<p>Commit the <code>.yarn</code> and <code>.yarnrc.yml</code> changes</p>
</li>
<li>
<p>Run again <code>yarn install</code>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For more advanced migration topics please refer to <a href="https://yarnpkg.com/advanced/migration" class="bare">https://yarnpkg.com/advanced/migration</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="which-files-should-be-added-to-gitignore-file"><a class="anchor" href="#which-files-should-be-added-to-gitignore-file"></a>6.20. Which files should be added to gitignore file?</h4>
<div class="paragraph">
<p>If you&#8217;re using Zero-Installs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-gitignore hljs" data-lang="gitignore">.yarn/*
!.yarn/cache
!.yarn/releases
!.yarn/plugins</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;re not using Zero-Installs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-gitignore hljs" data-lang="gitignore">.yarn/*
!.yarn/releases
!.yarn/plugins
.pnp.*</code></pre>
</div>
</div>
<div class="paragraph">
<p>More details at <a href="https://yarnpkg.com/advanced/qa#details" class="bare">https://yarnpkg.com/advanced/qa#details</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="angular-3"><a class="anchor" href="#angular-3"></a>7. Angular</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="accessibility"><a class="anchor" href="#accessibility"></a>7.1. Accessibility</h4>
<div class="paragraph">
<p>Multiple studies suggest that around 15-20% of the population are living with a disability of some kind. In comparison, that number is higher than any single browser demographic currently, other than Chrome2. Not considering those users when developing an application means excluding a large number of people from being able to use it comfortable or at all.</p>
</div>
<div class="paragraph">
<p>Some people are unable to use the mouse, view a screen, see low contrast text, Hear dialogue or music and some people having difficulty to understanding the complex language.This kind of people needed the support like Keyboard support, screen reader support, high contrast text, captions and transcripts and Plain language support. This disability may change the from permanent to the situation.</p>
</div>
</div>
<div class="sect3">
<h4 id="key-concerns-of-accessible-web-applications"><a class="anchor" href="#key-concerns-of-accessible-web-applications"></a>7.2. Key Concerns of Accessible Web Applications</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Semantic Markup</strong> - Allows the application to be understood on a more general level rather than just details of whats being rendered</p>
</li>
<li>
<p><strong>Keyboard Accessibility</strong> - Applications must still be usable when using only a keyboard</p>
</li>
<li>
<p><strong>Visual Assistance</strong> - color contrast, focus of elements and text representations of audio and events</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="semantic-markup"><a class="anchor" href="#semantic-markup"></a>7.3. Semantic Markup</h4>
<div class="paragraph">
<p>If you&#8217;re creating custom element directives, Web Components or HTML in general, use native elements wherever possible to utilize built-in events and properties. Alternatively, use ARIA to communicate semantic meaning.</p>
</div>
<div class="paragraph">
<p>HTML tags have attributes that providers extra context on what&#8217;s being displayed on the browser. For example, the  <code>&lt;img&gt;</code>  tag&#8217;s  alt  attribute lets the reader know what is being shown using a short description.However, native tags don&#8217;t cover all cases. This is where ARIA fits in. ARIA attributes can provide context on what roles specific elements have in the application or on how elements within the document relate to each other.</p>
</div>
<div class="paragraph">
<p>A modal component can be given the role of <code>dialog</code> or <code>alertdialog</code> to let the browser know that that component is acting as a modal. The modal component template can use the ARIA attributes  <code>aria-labelledby</code> and aria-described to describe to readers what the title and purpose of the modal is.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">@Component({
    selector: 'ngc2-app',
    template: `
      &lt;ngc2-notification-button
        message="Hello!"
        label="Greeting"
        role="button"&gt;
      &lt;/ngc2-notification-button&gt;
      &lt;ngc2-modal
        [title]="modal.title"
        [description]="modal.description"
        [visible]="modal.visible"
        (close)="modal.close()"&gt;
      &lt;/ngc2-modal&gt;
    `
})
export class AppComponent {
  constructor(private modal: ModalService) { }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>notification-button.component.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">@Component({
  selector: 'ngc2-modal',
  template: `
    &lt;div
      role="dialog"
      aria-labelledby="modal-title"
      aria-describedby="modal-description"&gt;
      &lt;div id="modal-title"&gt;{{title}}&lt;/div&gt;
      &lt;p id="modal-description"&gt;{{description}}&lt;/p&gt;
      &lt;button (click)="close.emit()"&gt;OK&lt;/button&gt;
    &lt;/div&gt;
  `
})
export class ModalComponent {
  ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="keyboard-accessibility"><a class="anchor" href="#keyboard-accessibility"></a>7.4. Keyboard Accessibility</h4>
<div class="paragraph">
<p>Keyboard accessibility is the ability of your application to be interacted with using just a keyboard. The more streamlined the site can be used this way, the more keyboard accessible it is. Keyboard accessibility is one of the largest aspects of web accessibility since it targets:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>those with motor disabilities who can&#8217;t use a mouse</p>
</li>
<li>
<p>users who rely on screen readers and other assistive technology, which require keyboard navigation</p>
</li>
<li>
<p>those who prefer not to use a mouse</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="focus"><a class="anchor" href="#focus"></a>7.5. ==  Focus</h4>
<div class="paragraph">
<p>Keyboard interaction is driven by something called focus. In web applications, only one element on a document has focus at a time, and keypress will activate whatever function is bound to that element.
Focus element border can be styled with CSS using the  outline  property, but it should not be removed. Elements can also be styled using the  :focus  psuedo-selector.</p>
</div>
</div>
<div class="sect3">
<h4 id="tabbing"><a class="anchor" href="#tabbing"></a>7.6. ==  Tabbing</h4>
<div class="paragraph">
<p>The most common way of moving focus along the page is through the  tab  key. Elements will be traversed in the order they appear in the document outline - so that order must be carefully considered during development.
There is way change the default behavior or tab order. This can be done through the  <code>tabindex</code>  attribute. The  <code>tabindex</code>  can be given the values:
* less than zero - to let readers know that an element should be focusable but not keyboard accessible
* 0 - to let readers know that that element should be accessible by keyboard
* greater than zero - to let readers know the order in which the focusable element should be reached using the keyboard. Order is calculated from lowest to highest.</p>
</div>
</div>
<div class="sect3">
<h4 id="transitions"><a class="anchor" href="#transitions"></a>7.7. ==  Transitions</h4>
<div class="paragraph">
<p>The majority of transitions that happen in an Angular application will not involve a page reload. This means that developers will need to carefully manage what happens to focus in these cases.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">@Component({
  selector: 'ngc2-modal',
  template: `
    &lt;div
      role="dialog"
      aria-labelledby="modal-title"
      aria-describedby="modal-description"&gt;
      &lt;div id="modal-title"&gt;{{title}}&lt;/div&gt;
      &lt;p id="modal-description"&gt;{{description}}&lt;/p&gt;
      &lt;button (click)="close.emit()"&gt;OK&lt;/button&gt;
    &lt;/div&gt;
  `,
})
export class ModalComponent {
  constructor(private modal: ModalService, private element: ElementRef) { }

  ngOnInit() {
    this.modal.visible$.subscribe(visible =&gt; {
      if(visible) {
        setTimeout(() =&gt; {
          this.element.nativeElement.querySelector('button').focus();
        }, 0);
      }
    })
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="visual-assistance"><a class="anchor" href="#visual-assistance"></a>7.8. Visual Assistance</h4>
<div class="paragraph">
<p>One large category of disability is visual impairment. This includes not just the blind, but those who are color blind or partially sighted, and require some additional consideration.</p>
</div>
</div>
<div class="sect3">
<h4 id="color-contrast"><a class="anchor" href="#color-contrast"></a>7.9. Color Contrast</h4>
<div class="paragraph">
<p>When choosing colors for text or elements on a website, the contrast between them needs to be considered. For WCAG 2.0 AA, this means that the contrast ratio for text or visual representations of text needs to be at least 4.5:1. There are tools online to measure the contrast ratio such as this color contrast checker from WebAIM or be checked with using automation tests.</p>
</div>
</div>
<div class="sect3">
<h4 id="visual-information"><a class="anchor" href="#visual-information"></a>7.10. Visual Information</h4>
<div class="paragraph">
<p>Color can help a user&#8217;s understanding of information, but it should never be the only way to convey information to a user. For example, a user with red/green color-blindness may have trouble discerning at a glance if an alert is informing them of success or failure.</p>
</div>
</div>
<div class="sect3">
<h4 id="audiovisual-media"><a class="anchor" href="#audiovisual-media"></a>7.11. Audiovisual Media</h4>
<div class="paragraph">
<p>Audiovisual elements in the application such as video, sound effects or audio (that is, podcasts) need related textual representations such as transcripts, captions or descriptions. They also should never auto-play and playback controls should be provided to the user.</p>
</div>
</div>
<div class="sect3">
<h4 id="accessibility-with-angular-material"><a class="anchor" href="#accessibility-with-angular-material"></a>7.12. Accessibility with Angular Material</h4>
<div class="paragraph">
<p>The <code>a11y</code> package provides a number of tools to improve accessibility. Import</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { A11yModule } from '@angular/cdk/a11y';</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="listkeymanager"><a class="anchor" href="#listkeymanager"></a>7.13. <code>ListKeyManager</code></h4>
<div class="paragraph">
<p><code>ListKeyManager</code> manages the active option in a list of items based on keyboard interaction. Intended to be used with components that correspond to a <code>role="menu"</code> or <code>role="listbox"</code> pattern . Any component that uses a <code>ListKeyManager</code> will generally do three things:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a <code>@ViewChildren</code> query for the options being managed.</p>
</li>
<li>
<p>Initialize the <code>ListKeyManager</code>, passing in the options.</p>
</li>
<li>
<p>Forward keyboard events from the managed component to the <code>ListKeyManager</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each option should implement the <code>ListKeyManagerOption</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">interface ListKeyManagerOption {
  disabled?: boolean;
  getLabel?(): string;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="types-of-listkeymanager"><a class="anchor" href="#types-of-listkeymanager"></a>7.14. ==  Types of <code>ListKeyManager</code></h4>
<div class="paragraph">
<p>There are two varieties of <code>ListKeyManager</code>, <code>FocusKeyManager</code> and <code>ActiveDescendantKeyManager</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="focuskeymanager"><a class="anchor" href="#focuskeymanager"></a>7.15. <code>FocusKeyManager</code></h4>
<div class="paragraph">
<p>Used when options will directly receive browser focus. Each item managed must implement the <code>FocusableOption</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">interface FocusableOption extends ListKeyManagerOption {
  focus(): void;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="activedescendantkeymanager"><a class="anchor" href="#activedescendantkeymanager"></a>7.16. <code>ActiveDescendantKeyManager</code></h4>
<div class="paragraph">
<p>Used when options will be marked as active via <code>aria-activedescendant</code>. Each item managed must implement the <code>Highlightable</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">interface Highlightable extends ListKeyManagerOption {
  setActiveStyles(): void;
  setInactiveStyles(): void;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each item must also have an ID bound to the listbox&#8217;s or menu&#8217;s <code>aria-activedescendant</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="focustrap"><a class="anchor" href="#focustrap"></a>7.17. <code>FocusTrap</code></h4>
<div class="paragraph">
<p>The <code>cdkTrapFocus</code> directive traps Tab key focus within an element. This is intended to be used to create accessible experience for components like modal dialogs, where focus must be constrained. This directive is declared in <code>A11yModule</code>.</p>
</div>
<div class="paragraph">
<p>This directive will not prevent focus from moving out of the trapped region due to mouse interaction.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-HTML hljs" data-lang="HTML">&lt;div class="my-inner-dialog-content" cdkTrapFocus&gt;
  &lt;!-- Tab and Shift + Tab will not leave this element. --&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="regions"><a class="anchor" href="#regions"></a>7.18. Regions</h4>
<div class="paragraph">
<p>Regions can be declared explicitly with an initial focus element by using the <code>cdkFocusRegionStart</code>, <code>cdkFocusRegionEnd</code> and <code>cdkFocusInitial</code> DOM attributes. When using the tab key, focus will move through this region and wrap around on either end.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-HTML hljs" data-lang="HTML">&lt;a mat-list-item routerLink cdkFocusRegionStart&gt;Focus region start&lt;/a&gt;
&lt;a mat-list-item routerLink&gt;Link&lt;/a&gt;
&lt;a mat-list-item routerLink cdkFocusInitial&gt;Initially focused&lt;/a&gt;
&lt;a mat-list-item routerLink cdkFocusRegionEnd&gt;Focus region end&lt;/a&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="interactivitychecker"><a class="anchor" href="#interactivitychecker"></a>7.19. <code>InteractivityChecker</code></h4>
<div class="paragraph">
<p><code>InteractivityChecker</code> is used to check the interactivity of an element, capturing disabled, visible, tabbable, and focusable states for accessibility purposes.</p>
</div>
</div>
<div class="sect3">
<h4 id="liveannouncer"><a class="anchor" href="#liveannouncer"></a>7.20. <code>LiveAnnouncer</code></h4>
<div class="paragraph">
<p><code>LiveAnnouncer</code> is used to announce messages for screen-reader users using an aria-live region.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-HTML hljs" data-lang="HTML">@Component({...})
export class MyComponent {

 constructor(liveAnnouncer: LiveAnnouncer) {
   liveAnnouncer.announce("Hey Google");
 }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="api-reference-for-angular-cdk-a11y"><a class="anchor" href="#api-reference-for-angular-cdk-a11y"></a>7.21. API reference for Angular CDK a11y</h4>
<div class="paragraph">
<p><a href="https://material.angular.io/cdk/a11y/api">API reference for Angular CDK a11y</a></p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="angular-elements"><a class="anchor" href="#angular-elements"></a>7.22. Angular Elements</h4>

</div>
<div class="sect3">
<h4 id="what-are-angular-elements"><a class="anchor" href="#what-are-angular-elements"></a>7.23. What are Angular Elements?</h4>
<div class="paragraph">
<p><a href="https://angular.io/guide/elements">Angular elements</a> are Angular components packaged as custom elements, a web standard for defining new HTML elements in a framework-agnostic way.</p>
</div>
<div class="paragraph">
<p>Custom elements are a Web Platform feature currently supported by Chrome, Firefox, Opera, and Safari, and available in other browsers through <a href="https://angular.io/guide/elements#browser-support">Polyfills</a>. A custom element extends HTML by allowing you to define a tag whose content is created and controlled by JavaScript code. The browser maintains a <code>CustomElementRegistry</code> of defined custom elements (also called Web Components), which maps an instantiable JavaScript class to an HTML tag.</p>
</div>
</div>
<div class="sect3">
<h4 id="why-use-angular-elements"><a class="anchor" href="#why-use-angular-elements"></a>7.24. Why use Angular Elements?</h4>
<div class="paragraph">
<p>Angular Elements allows Angular to work with different frameworks by using input and output elements. This allows Angular to work with many different frameworks if needed. This is an ideal situation if a slow transformation of an application to <code>Angular</code> is needed or some Angular needs to be added in other web applications(For example. <code>ASP.net</code>, <code>JSP</code> etc )</p>
</div>
</div>
<div class="sect3">
<h4 id="negative-points-about-elements"><a class="anchor" href="#negative-points-about-elements"></a>7.25. Negative points about Elements</h4>
<div class="paragraph">
<p>Angular Elements is really powerful but since, the transition between views is going to be handled by another framework or HTML/JavaScript, using Angular <code>Router</code> is not possible. the view transitions have to be handled manually. This fact also eliminates the possibility of just porting an application completely.</p>
</div>
</div>
<div class="sect3">
<h4 id="how-to-use-angular-elements"><a class="anchor" href="#how-to-use-angular-elements"></a>7.26. How to use Angular Elements?</h4>
<div class="paragraph">
<p>In a generalized way, a simple <code>Angular component</code> could be transformed to an <code>Angular Element</code> with this steps:</p>
</div>
</div>
<div class="sect3">
<h4 id="installing-angular-elements"><a class="anchor" href="#installing-angular-elements"></a>7.27. Installing Angular Elements</h4>
<div class="paragraph">
<p>The first step is going to be install the library using our preferred packet manager:</p>
</div>
</div>
<div class="sect3">
<h4 id="npm-3"><a class="anchor" href="#npm-3"></a>7.28. == NPM</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>npm install @angular/elements</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="yarn-3"><a class="anchor" href="#yarn-3"></a>7.29. == YARN</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>yarn add @angular/elements</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="preparing-the-components-in-the-modules"><a class="anchor" href="#preparing-the-components-in-the-modules"></a>7.30. Preparing the components in the modules</h4>
<div class="paragraph">
<p>Inside the <code>app.module.ts</code>, in addition to the normal declaration of the components inside <code>declarations</code>, the modules inside <code>imports</code> and the services inside <code>providers</code>, the components need to added in <code>entryComponents</code>. If there are components that have their own module, the same logic is going to be applied for them, only adding in the <code>app.module.ts</code> the components that do not have their own module. Here is an example of this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">....
@NgModule({
  declarations: [
    DishFormComponent,
    DishViewComponent
  ],
  imports: [
    CoreModule,  // Module containing Angular Materials
    FormsModule
  ],
  entryComponents: [
    DishFormComponent,
    DishViewComponent
  ],
  providers: [DishShareService]
})
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>After that is done, the constructor of the module is going to be modified to use injector and bootstrap the application defining the components. This is going to allow the <code>Angular Element</code> to get the injections and to define a component tag that will be used later:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">....
})
export class AppModule {
  constructor(private injector: Injector) {

  }

  ngDoBootstrap() {
    const el = createCustomElement(DishFormComponent, {injector: this.injector});
    customElements.define('dish-form', el);

    const elView = createCustomElement(DishViewComponent, {injector: this.injector});
    customElements.define('dish-view', elView);
  }
}
....</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="a-component-example"><a class="anchor" href="#a-component-example"></a>7.31. A component example</h4>
<div class="paragraph">
<p>In order to be able to use a component, <code>@Input()</code> and <code>@Output()</code> variables are used. These variables are going to be the ones that will allow the Angular Element to communicate with the framework/JavaScript:</p>
</div>
<div class="paragraph">
<p>Component html</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;mat-card&gt;
    &lt;mat-grid-list cols="1" rowHeight="100px" rowWidth="50%"&gt;
				&lt;mat-grid-tile colspan="1" rowspan="1"&gt;
					&lt;span&gt;{{ platename }}&lt;/span&gt;
				&lt;/mat-grid-tile&gt;
				&lt;form (ngSubmit)="onSubmit(dishForm)" #dishForm="ngForm"&gt;
					&lt;mat-grid-tile colspan="1" rowspan="1"&gt;
						&lt;mat-form-field&gt;
							&lt;input matInput placeholder="Name" name="name" [(ngModel)]="dish.name"&gt;
						&lt;/mat-form-field&gt;
					&lt;/mat-grid-tile&gt;
					&lt;mat-grid-tile colspan="1" rowspan="1"&gt;
						&lt;mat-form-field&gt;
							&lt;textarea matInput placeholder="Description" name="description" [(ngModel)]="dish.description"&gt;&lt;/textarea&gt;
						&lt;/mat-form-field&gt;
					&lt;/mat-grid-tile&gt;
					&lt;mat-grid-tile colspan="1" rowspan="1"&gt;
						&lt;button mat-raised-button color="primary" type="submit"&gt;Submit&lt;/button&gt;
					&lt;/mat-grid-tile&gt;
				&lt;/form&gt;
		&lt;/mat-grid-list&gt;
&lt;/mat-card&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Component ts</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Component({
  templateUrl: './dish-form.component.html',
  styleUrls: ['./dish-form.component.scss']
})
export class DishFormComponent implements OnInit {

  @Input() platename;

  @Input() platedescription;

  @Output()
  submitDishEvent = new EventEmitter();

  submitted = false;
  dish = {name: '', description: ''};

  constructor(public dishShareService: DishShareService) { }

  ngOnInit() {
    this.dish.name = this.platename;
    this.dish.description = this.platedescription;
  }

  onSubmit(dishForm: NgForm): void {
    this.dishShareService.createDish(dishForm.value.name, dishForm.value.description);
    this.submitDishEvent.emit('dishSubmited');
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this file there are definitions of multiple variables that will be used as input and output. Since the input variables are going to be used directly by html, only lowercase and underscore strategies can be used for them. On the <code>onSubmit(dishForm: NgForm)</code> a service is used to pass this variables to another component. Finally, as a last thing, the selector inside <code>@Component</code> has been removed since a tag that will be used dynamically was already defined in the last step.</p>
</div>
</div>
<div class="sect3">
<h4 id="solving-the-error"><a class="anchor" href="#solving-the-error"></a>7.32. Solving the error</h4>
<div class="paragraph">
<p>In order to be able to use this <code>Angular Element</code> a <code>Polyfills</code>/<code>Browser support</code> related error needs to solved. This error can be solved in two ways:</p>
</div>
</div>
<div class="sect3">
<h4 id="changing-the-target"><a class="anchor" href="#changing-the-target"></a>7.33. == Changing the target</h4>
<div class="paragraph">
<p>One solution is to change the target in <code>tsconfig.json</code> to <code>es2015</code>. This might not be doable for every application since maybe a specific target is required.</p>
</div>
</div>
<div class="sect3">
<h4 id="installing-polyfaces"><a class="anchor" href="#installing-polyfaces"></a>7.34. == Installing Polyfaces</h4>
<div class="paragraph">
<p>Another solution is to use <code>AutoPollyfill</code>. In order to do so, the library is going to be installed with a packet manager:</p>
</div>
<div class="paragraph">
<p>Yarn</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>yarn add @webcomponents/webcomponentsjs</code></pre>
</div>
</div>
<div class="paragraph">
<p>Npm</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>npm install @webcomponents/webcomponentsjs</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the packet manager has finished, inside the <code>src</code> folder a new file <code>polyfills.ts</code> is found. To solve the error, importing the corresponding adapter (<code>custom-elements-es5-adapter.js</code>) is necessary:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">....
/***************************************************************************************************
 * APPLICATION IMPORTS
 */

import '@webcomponents/webcomponentsjs/custom-elements-es5-adapter.js';
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to learn more about polyfills in angular you can do it <a href="https://angular.io/guide/browser-support">here</a></p>
</div>
</div>
<div class="sect3">
<h4 id="building-the-angular-element"><a class="anchor" href="#building-the-angular-element"></a>7.35. Building the Angular Element</h4>
<div class="paragraph">
<p>First, before building the <code>Angular Element</code>, every element inside that app component except the module need to be removed. After that, a bash script is created in the root folder,. This script will allow to put every necessary file into a JS.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng build "projectName" --configuration production --output-hashing=none &amp;&amp; cat dist/"projectName"/runtime.js dist/"projectName"/polyfills.js dist/"projectName"/scripts.js dist/"projectName"/main.js &gt; ./dist/"projectName"/"nameWantedAngularElement".js</code></pre>
</div>
</div>
<div class="paragraph">
<p>After executing the bash script, it will generate inside the path <code>dist/"projectName"</code> (or <code>dist/apps/projectname</code> in a Nx workspace) a JS file named <code>"nameWantedAngularElement".js</code> and a css file.</p>
</div>
</div>
<div class="sect3">
<h4 id="building-with-ngx-build-plus-recommended"><a class="anchor" href="#building-with-ngx-build-plus-recommended"></a>7.36. == Building with <code>ngx-build-plus</code> (Recommended)</h4>
<div class="paragraph">
<p>The library <a href="https://github.com/manfredsteyer/ngx-build-plus"><code>ngx-build-plus</code></a> allows to add different options when building. In addition, it solves some errors that will occur when trying to use multiple angular elements in an application. In order to use it, yarn or npm can be used:</p>
</div>
<div class="paragraph">
<p>Yarn</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>yarn add ngx-build-plus</code></pre>
</div>
</div>
<div class="paragraph">
<p>Npm</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>npm install ngx-build-plus</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to add it to a specific sub project in your projects folder, use the --project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>.... ngx-build-plus --project "project-name"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using this library and the following command, an isolated <code>Angular Element</code> which won&#8217;t have conflict with others can be generated. This <code>Angular Element</code> will not have a polyfill so, the project where we use them will need to include a <code>poliyfill</code> with the <code>Angular Element</code> requirements.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng build "projectName" --output-hashing none --single-bundle true --configuration production --bundle-styles false</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command will generate three things:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The main JS bundle</p>
</li>
<li>
<p>The script JS</p>
</li>
<li>
<p>The css</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These files will be used later instead of the single JS generated in the last step.</p>
</div>
</div>
<div class="sect3">
<h4 id="extra-parameters"><a class="anchor" href="#extra-parameters"></a>7.37. == ==  Extra parameters</h4>
<div class="paragraph">
<p>Here are some extra useful parameters that <code>ngx-build-plus</code> provides:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--keep-polyfills</code>: This parameter is going to allow us to keep the polyfills. This needs to be used with caution, avoiding using multiple different polyfills that could cause an error is necessary.</p>
</li>
<li>
<p><code>--extraWebpackConfig webpack.extra.js</code>: This parameter allows us to create a JavaScript file inside our <code>Angular Elements</code> project with the name of different libraries. Using <code>webpack</code> these libraries will not be included in the <code>Angular Element</code>. This is useful to lower the size of our <code>Angular Element</code> by removing libraries shared. Example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">const webpack = require('webpack');

module.exports = {
    "externals": {
        "rxjs": "rxjs",
        "@angular/core": "ng.core",
        "@angular/common": "ng.common",
        "@angular/common/http": "ng.common.http",
        "@angular/platform-browser": "ng.platformBrowser",
        "@angular/platform-browser-dynamic": "ng.platformBrowserDynamic",
        "@angular/compiler": "ng.compiler",
        "@angular/elements": "ng.elements",
        "@angular/router": "ng.router",
        "@angular/forms": "ng.forms"
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id=""><a class="anchor" href="#"></a>==</h4>
<div class="literalblock">
<div class="content">
<pre>  If some libraries are excluded from the `Angular Element` you will need to add the bundled UMD files of those libraries manually.
== ==</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-the-angular-element"><a class="anchor" href="#using-the-angular-element"></a>7.38. Using the Angular Element</h4>
<div class="paragraph">
<p>The <code>Angular Element</code> that got generated in the last step can be used in almost every framework. In this case, the <code>Angular Element</code> is going to be used in html:</p>
</div>
<div class="listingblock">
<div class="title">Listing 37. Sample index.html version without <code>ngx-build-plus</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-HTML hljs" data-lang="HTML">&lt;html&gt;
    &lt;head&gt;
        &lt;link rel="stylesheet" href="styles.css"&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="container"&gt;

        &lt;/div&gt;
        &lt;!--Use of the element non dynamically--&gt;
        &lt;!--&lt;plate-form platename="test" platedescription="test"&gt;&lt;/plate-form&gt;--&gt;
        &lt;script src="./devon4ngAngularElements.js"&gt; &lt;/script&gt;
        &lt;script&gt;
                var elContainer = document.getElementById('container');
                var el= document.createElement('dish-form');
                el.setAttribute('platename','test');
                el.setAttribute('platedescription','test');
                el.addEventListener('submitDishEvent',(ev)=&gt;{
                    var elView= document.createElement('dish-view');
                    elContainer.innerHTML = '';
                    elContainer.appendChild(elView);
                });
                elContainer.appendChild(el);
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 38. Sample index.html version with <code>ngx-build-plus</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-HTML hljs" data-lang="HTML">&lt;html&gt;
    &lt;head&gt;
        &lt;link rel="stylesheet" href="styles.css"&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="container"&gt;

        &lt;/div&gt;
        &lt;!--Use of the element non dynamically--&gt;
        &lt;!--&lt;plate-form platename="test" platedescription="test"&gt;&lt;/plate-form&gt;--&gt;
         &lt;script src="./polyfills.js"&gt; &lt;/script&gt; &lt;!-- Created using --keep-polyfills options --&gt;
        &lt;script src="./scripts.js"&gt; &lt;/script&gt;
         &lt;script src="./main.js"&gt; &lt;/script&gt;
        &lt;script&gt;
                var elContainer = document.getElementById('container');
                var el= document.createElement('dish-form');
                el.setAttribute('platename','test');
                el.setAttribute('platedescription','test');
                el.addEventListener('submitDishEvent',(ev)=&gt;{
                    var elView= document.createElement('dish-view');
                    elContainer.innerHTML = '';
                    elContainer.appendChild(elView);
                });
                elContainer.appendChild(el);
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this html, the css generated in the last step is going to be imported inside the <code>&lt;head&gt;</code> and then, the JavaScript element is going to be imported at the end of the body. After that is done, There is two uses of <code>Angular Elements</code> in the html, one directly with use of the <code>@input()</code> variables as parameters commented in the html:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">....
        &lt;!--Use of the element non dynamically--&gt;
        &lt;!--&lt;plate-form platename="test" platedescription="test"&gt;&lt;/plate-form&gt;--&gt;
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>and one dynamically inside the script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">....
        &lt;script&gt;
                var elContainer = document.getElementById('container');
                var el= document.createElement('dish-form');
                el.setAttribute('platename','test');
                el.setAttribute('platedescription','test');
                el.addEventListener('submitDishEvent',(ev)=&gt;{
                    var elView= document.createElement('dish-view');
                    elContainer.innerHTML = '';
                    elContainer.appendChild(elView);
                });
                elContainer.appendChild(el);
        &lt;/script&gt;
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>This JavaScript is an example of how to create dynamically an <code>Angular Element</code> inserting attributed to fill our <code>@Input()</code> variables and listen to the <code>@Output()</code> that was defined earlier. This is done with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">                el.addEventListener('submitDishEvent',(ev)=&gt;{
                    var elView= document.createElement('dish-view');
                    elContainer.innerHTML = '';
                    elContainer.appendChild(elView);
                });</code></pre>
</div>
</div>
<div class="paragraph">
<p>This allows JavaScript to hook with the <code>@Output()</code> event emitter that was defined. When this event gets called, another component that was defined gets inserted dynamically.</p>
</div>
</div>
<div class="sect3">
<h4 id="angular-element-within-another-angular-project"><a class="anchor" href="#angular-element-within-another-angular-project"></a>7.39. Angular Element within another Angular project</h4>
<div class="paragraph">
<p>In order to use an <code>Angular Element</code> within another <code>Angular</code> project the following steps need to be followed:</p>
</div>
</div>
<div class="sect3">
<h4 id="copy-bundled-script-and-css-to-resources"><a class="anchor" href="#copy-bundled-script-and-css-to-resources"></a>7.40. Copy bundled script and css to resources</h4>
<div class="paragraph">
<p>First copy the generated <code>.js</code> and <code>.css</code> inside assets in the corresponding folder.</p>
</div>
</div>
<div class="sect3">
<h4 id="add-bundled-script-to-angular-json"><a class="anchor" href="#add-bundled-script-to-angular-json"></a>7.41. Add bundled script to angular.json</h4>
<div class="paragraph">
<p>Inside <code>angular.json</code> both of the files that were copied in the last step are going to be included. This will be done both, in <code>test</code> and in <code>build</code>. Including it on the test, will allow to perform unitary tests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
....
  "architect": {
    ....
    "build": {
      ....
      "styles": [
        ....
          "src/assets/css/devon4ngAngularElements.css"
        ....
      ]
      ....
      "scripts": [
        "src/assets/js/devon4ngAngularElements.js"
      ]
      ....
    }
    ....
    "test": {
      ....
      "styles": [
        ....
          "src/assets/css/devon4ngAngularElements.css"
        ....
      ]
      ....
      "scripts": [
        "src/assets/js/devon4ngAngularElements.js"
      ]
      ....
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By declaring the files in the <code>angular.json</code> angular will take care of including them in a proper way.</p>
</div>
</div>
<div class="sect3">
<h4 id="-2"><a class="anchor" href="#-2"></a>==</h4>
<div class="literalblock">
<div class="content">
<pre>  If you are using Nx, the configuration file `angular.json` might be named as `workspace.json`, depending on how you had setup the workspace. The structure of the file remains similar though.
== ==</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-angular-element"><a class="anchor" href="#using-angular-element"></a>7.42. Using Angular Element</h4>
<div class="paragraph">
<p>There are two ways that <code>Angular Element</code> can be used:</p>
</div>
</div>
<div class="sect3">
<h4 id="create-component-dynamically"><a class="anchor" href="#create-component-dynamically"></a>7.43. == Create component dynamically</h4>
<div class="paragraph">
<p>In order to add the component in a dynamic way, first adding a container is necessary:</p>
</div>
<div class="paragraph">
<p><code>app.component.html</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">....
&lt;div id="container"&gt;
&lt;/div&gt;
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this container created, inside the <code>app.component.ts</code> a method is going to be created. This method is going to find the container, create the dynamic element and append it into the container.</p>
</div>
<div class="paragraph">
<p><code>app.component.ts</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export class AppComponent implements OnInit {
  ....
  ngOnInit(): void {
    this.createComponent();
  }
  ....
  createComponent(): void {
    const container = document.getElementById('container');
    const component = document.createElement('dish-form');
    container.appendChild(component);
  }
  ....</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-it-directly"><a class="anchor" href="#using-it-directly"></a>7.44. == Using it directly</h4>
<div class="paragraph">
<p>In order to use it directly on the templates, in the <code>app.module.ts</code> the <code>CUSTOM_ELEMENTS_SCHEMA</code> needs to be added:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">....
import { NgModule, CUSTOM_ELEMENTS_SCHEMA } from '@angular/core';
....
@NgModule({
  ....
  schemas: [ CUSTOM_ELEMENTS_SCHEMA ],</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is going to allow the use of the <code>Angular Element</code> in the templates directly:</p>
</div>
<div class="paragraph">
<p><code>app.component.html</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">....
&lt;div id="container"&gt;
  &lt;dish-form&gt;&lt;/dish-form&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can find a working example of Angular Elements in our <a href="https://github.com/devonfw-sample/devon4ts-samples">devon4ts-samples</a> repo by referring the samples named angular-elements and angular-elements-test.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="angular-lazy-loading"><a class="anchor" href="#angular-lazy-loading"></a>7.45. Angular Lazy loading</h4>
<div class="paragraph">
<p>When the development of an application starts, it just contains a small set of features so the app usually loads fast. However, as new features are added, the overall application size grows up  and its loading speed decreases. It is in this context where Lazy loading finds its place.
Lazy loading is a design pattern that defers initialization of objects until it is needed, so, for example, users that just access to a website&#8217;s home page do not need to have other areas loaded.
Angular handles lazy loading through the routing module which redirects to requested pages. Those pages can be loaded at start or on demand.</p>
</div>
</div>
<div class="sect3">
<h4 id="an-example-with-angular"><a class="anchor" href="#an-example-with-angular"></a>7.46. An example with Angular</h4>
<div class="paragraph">
<p>To explain how lazy loading is implemented using angular, a basic sample app is going to be developed. This app will consist in a window named "level 1" that contains two buttons that redirects to other windows in a "second level". It is a simple example, but useful to understand the relation between angular modules and lazy loading.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-lazy/levels-app.png" alt="Levels app structure" width="500 link="images/angular/angular-lazy/levels-app.png"">
</div>
<div class="title">Figure 16. Levels app structure.</div>
</div>
<div class="paragraph">
<p>This graphic shows that modules acts as gates to access components "inside" them.</p>
</div>
<div class="paragraph">
<p>Because the objective of this guide is related mainly with logic, the html structure and SCSS styles are less relevant, but the complete code can be found as a sample <a href="https://github.com/devonfw-sample/devon4ts-samples/tree/master/apps/angular-lazy-loading">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="implementation-5"><a class="anchor" href="#implementation-5"></a>7.47. Implementation</h4>
<div class="paragraph">
<p>First write in a console <code>ng new level-app --routing</code>, to generate a new project called level-app including an app-routing.module.ts file (<strong>--routing</strong> flag). If you are using Nx, the command would be <code>nx generate @nrwl/angular:app level-app --routing</code> in your Nx workspace.</p>
</div>
<div class="paragraph">
<p>In the file app.component.html delete all the content except the router-outlet tag.</p>
</div>
<div class="listingblock">
<div class="title">Listing 39. File app.component.html</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;router-outlet&gt;&lt;/router-outlet&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next steps consists on creating features modules.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>run <code>ng generate module first --routing</code>  to generate a module named <em>first</em>.</p>
</li>
<li>
<p>run <code>ng generate module first/second-left --routing</code> to generate a module named <em>second-left</em> under <em>first</em>.</p>
</li>
<li>
<p>run <code>ng generate module first/second-right --routing</code> to generate a module <em>second-right</em> under <em>first</em>.</p>
</li>
<li>
<p>run <code>ng generate component first/first</code> to generate a component named <em>first</em> inside the module <em>first</em>.</p>
</li>
<li>
<p>run <code>ng generate component first/second-left/content</code> to generate a component <em>content</em> inside the module <em>second-left</em>.</p>
</li>
<li>
<p>run <code>ng generate component first/second-right/content</code> to generate a component <em>content</em> inside the module <em>second-right</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="-3"><a class="anchor" href="#-3"></a>==</h4>
<div class="literalblock">
<div class="content">
<pre>  If you are using Nx, you have to specify the project name (level-app) along with the --project flag. For example, command for generating the first module will be `ng generate module first --project=level-app --routing`
== ==</pre>
</div>
</div>
<div class="paragraph">
<p>To move between components we have to configure the routes used:</p>
</div>
<div class="paragraph">
<p>In <strong>app-routing.module.ts</strong> add a path <strong>'first'</strong> to <code>FirstComponent</code> and a redirection from <strong>''</strong> to <strong>'first'</strong>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 40. File app-routing.module.ts.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import { FirstComponent } from './first/first/first.component';

const routes: Routes = [
  {
    path: 'first',
    component: FirstComponent
  },
  {
    path: '',
    redirectTo: 'first',
    pathMatch: 'full',
  },
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule],
})
export class AppRoutingModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In <strong>app.module.ts</strong> import the module which includes <code>FirstComponent</code>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 41. File app.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">....
import { FirstModule } from './first/first.module';

@NgModule({
  ...
  imports: [
    ....
    FirstModule
  ],
  ...
})
export class AppModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In <strong>first-routing.module.ts</strong> add routes that direct to the content of <code>SecondRightModule</code> and <code>SecondLeftModule</code>. The content of both modules have the same name so, in order to avoid conflicts the name of the components are going to be changed using <strong>as</strong> ( original-name as new-name).</p>
</div>
<div class="listingblock">
<div class="title">Listing 42. File first-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import { ContentComponent as ContentLeft} from './second-left/content/content.component';
import { ContentComponent as ContentRight} from './second-right/content/content.component';
import { FirstComponent } from './first/first.component';

const routes: Routes = [
  {
    path: '',
    component: FirstComponent
  },
  {
    path: 'first/second-left',
    component: ContentLeft
  },
  {
    path: 'first/second-right',
    component: ContentRight
  }
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule]
})
export class FirstRoutingModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In first.module.ts import <code>SecondLeftModule</code> and <code>SecondRightModule</code>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 43. File first.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import { SecondLeftModule } from './second-left/second-left.module';
import { SecondRightModule } from './second-right/second-right.module';

@NgModule({
  ...
  imports: [
    ...
    SecondLeftModule,
    SecondRightModule,
  ]
})
export class FirstModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the current configuration, we have a project that loads all the modules in a eager way. Run <code>ng serve</code> (with <code>--project=level-app</code> in an Nx workspace) to see what happens.</p>
</div>
<div class="paragraph">
<p>First, during the compilation we can see that just a main file is built.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-lazy/compile-eager.png" alt="Compile eager" width="800 link="images/angular/angular-lazy/compile-eager.png"">
</div>
<div class="title">Figure 17. Compile eager.</div>
</div>
<div class="paragraph">
<p>If we go to <code><a href="http://localhost:4200/first" class="bare">http://localhost:4200/first</a></code> and open developer options (F12 on Chrome), it is found that a document named "first" is loaded.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-lazy/first-lvl-eager.png" alt="First level eager" width="800 link="images/angular/angular-lazy/first-lvl-eager.png"">
</div>
<div class="title">Figure 18. First level eager.</div>
</div>
<div class="paragraph">
<p>If we click on <strong>[Go to right module]</strong> a second level module opens, but there is no 'second-right' document.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-lazy/second-lvl-right-eager.png" alt="Second level right eager" width="800 link="images/angular/angular-lazy/second-lvl-right-eager.png"">
</div>
<div class="title">Figure 19. Second level right eager.</div>
</div>
<div class="paragraph">
<p>But, typing the URL directly will load 'second-right' but no 'first', even if we click on <strong>[Go back]</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-lazy/second-lvl-right-eager-d.png" alt="Second level right eager" width="800 link="images/angular/angular-lazy/second-lvl-right-eager-d.png"">
</div>
<div class="title">Figure 20. Second level right eager direct URL.</div>
</div>
<div class="paragraph">
<p>Modifying an angular application to load its modules lazily is easy, you have to change the routing configuration of the desired module (for example <code>FirstModule</code>).</p>
</div>
<div class="listingblock">
<div class="title">Listing 44. File app-routing.module.ts.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  {
    path: 'first',
    loadChildren: () =&gt; import('./first/first.module').then(m =&gt; m.FirstModule),
  },
  {
    path: '',
    redirectTo: 'first',
    pathMatch: 'full',
  },
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule],
})
export class AppRoutingModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Notice that instead of loading a component, you dynamically import it in a <code>loadChildren</code> attribute because modules acts as gates to access components "inside" them. Updating the app to load lazily has four consequences:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>No component attribute.</p>
</li>
<li>
<p>No import of <code>FirstComponent</code>.</p>
</li>
<li>
<p><code>FirstModule</code> import has to be removed from the imports array at app.module.ts.</p>
</li>
<li>
<p>Change of context.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If we check <strong>first-routing.module.ts</strong> again, we can see that the path for <code>ContentLeft</code> and <code>ContentRight</code> is set to 'first/second-left' and 'first/second-right' respectively, so writing <code><a href="http://localhost:4200/first/second-left" class="bare">http://localhost:4200/first/second-left</a></code> will redirect us to <code>ContentLeft</code>. However, after loading a module with <code>loadChildren</code> setting the path to '<em>second-left</em>' and '<em>second-right</em>' is enough because it acquires the context set by <code>AppRoutingModule</code>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 45. File first-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  {
    path: '',
    component: FirstComponent
  },
  {
    path: 'second-left',
    component: ContentLeft
  },
  {
    path: 'second-right',
    component: ContentRight
  }
];</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we go to '<em>first</em>' then <code>FirstModule</code> is situated in '<em>/first</em>' but also its children <code>ContentLeft</code> and <code>ContentRight</code>, so it is not necessary to write in their path '<em>first/second-left</em>' and '<em>first/second-right</em>', because that will situate the components on '<em>first/first/second-left</em>' and  '<em>first/first/second-right</em>'.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-lazy/first-lvl-wrong-path.png" alt="First level wrong path" width="800 link="images/angular/angular-lazy/first-lvl-wrong-path.png"">
</div>
<div class="title">Figure 21. First level lazy wrong path.</div>
</div>
<div class="paragraph">
<p>When we compile an app with lazy loaded modules, files containing them will be generated</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-lazy/compile-first-lazy.png" alt="First level lazy compilation" width="800 link="images/angular/angular-lazy/compile-first-lazy.png"">
</div>
<div class="title">Figure 22. First level lazy compilation.</div>
</div>
<div class="paragraph">
<p>And if we go to <em>developer tools &#8594; network</em>, we can find those modules loaded (if they are needed).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-lazy/first-lvl-lazy.png" alt="First level lazy" width="800 link="images/angular/angular-lazy/first-lvl-lazy.png"">
</div>
<div class="title">Figure 23. First level lazy.</div>
</div>
<div class="paragraph">
<p>To load the component <code>ContentComponent</code> of <code>SecondLeftModule</code> lazily, we have to load <code>SecondLeftModule</code> as a children of <code>FirstModule</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Change <strong>component</strong> to <code>loadChildren</code> and reference <code>SecondLeftModule</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Listing 46. File first-routing.module.ts.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  {
    path: '',
    component: FirstComponent
  },
  {
    path: 'second-left',
    loadChildren: () =&gt; import('./second-left/second-left.module').then(m =&gt; m.SecondLeftModule),
  },
  {
    path: 'second-right',
    component: ContentRight
  }
];</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Remove <code>SecondLeftModule</code> at first.component.ts</p>
</li>
<li>
<p>Route the components inside <code>SecondLeftModule</code>. Without this step nothing would be displayed.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Listing 47. File second-left-routing.module.ts.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import { ContentComponent } from './content/content.component';

const routes: Routes = [
  {
    path: '',
    component: ContentComponent
  }
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule]
})
export class SecondLeftRoutingModule { }</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>run <code>ng serve</code> to generate files containing the lazy modules.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-lazy/second-lvl-lazy.png" alt="Second level lazy" width="800 link="images/angular/angular-lazy/second-lvl-lazy.png"">
</div>
<div class="title">Figure 24. Second level lazy loading compilation.</div>
</div>
<div class="paragraph">
<p>Clicking on <strong>[Go to left module]</strong> triggers the load of <code>SecondLeftModule</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-lazy/second-lvl-left-lazy.png" alt="Second level lazy network" width="800 link="images/angular/angular-lazy/second-lvl-left-lazy.png"">
</div>
<div class="title">Figure 25. Second level lazy loading network.</div>
</div>
</div>
<div class="sect3">
<h4 id="conclusion"><a class="anchor" href="#conclusion"></a>7.48. Conclusion</h4>
<div class="paragraph">
<p>Lazy loading is a pattern useful when new features are added, these features are usually identified as modules which can be loaded only if needed as shown in this document, reducing the time spent loading an application.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="angular-library"><a class="anchor" href="#angular-library"></a>7.49. Angular Library</h4>
<div class="paragraph">
<p><code>Angular CLI</code> provides us with methods that allow the creation of a library. After that, using a packet manager (either <code>npm</code> or <code>yarn</code>) the library can be build and packed which will allow later to install/publish it.</p>
</div>
</div>
<div class="sect3">
<h4 id="whats-a-library"><a class="anchor" href="#whats-a-library"></a>7.50. Whats a library?</h4>
<div class="paragraph">
<p>From <a href="https://en.wikipedia.org/wiki/Library_(computing)">wikipedia</a>: a library is a collection of non-volatile resources used by computer programs, often for software development. These may include configuration data, documentation, help data, message templates, pre-written code and subroutines, classes, values or type specifications.</p>
</div>
</div>
<div class="sect3">
<h4 id="how-to-build-a-library"><a class="anchor" href="#how-to-build-a-library"></a>7.51. How to build a library</h4>
<div class="paragraph">
<p>In this section, a library is going to be build step by step. Please note, we will be explaining the steps using both Angular CLI and Nx CLI. You are free to choose either one for your development.</p>
</div>
</div>
<div class="sect3">
<h4 id="1-creating-an-empty-application"><a class="anchor" href="#1-creating-an-empty-application"></a>7.52. 1. Creating an empty application</h4>
<div class="paragraph">
<p>First, using <code>Angular CLI</code> we are going to generate a empty application which will be later filled with the generated library. In order to do so, <code>Angular CLI</code> allows us to add to <code>ng new "application-name"</code> an option (<code>--create-application</code>). This option is going to tell <code>Angular CLI</code> not to create the initial <code>app</code> project. This is convenient since a library is going to be generated in later steps. Using this command <code>ng new "application-name" --create-application=false</code> an empty project with the name wanted is created.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng new "application-name" --create-application=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>This step is much more easier and straight-forward when using Nx. Nx allows us to work in a monorepo workspace, where you can develop a project as an application, or a library, or a tool. You can follow <a href="https://github.com/devonfw/devon4ng/wiki/guide-creating-angular-app-with-nx-cli">this guide</a> to get started with Nx.
The command for generating a library in Nx is <code>nx generate @nrwl/angular:library library-name --publishable --importPath=library-name</code>. This will create an empty angular application which we can modify and publish as a library.</p>
</div>
</div>
<div class="sect3">
<h4 id="2-generating-a-library"><a class="anchor" href="#2-generating-a-library"></a>7.53. 2. Generating a library</h4>
<div class="paragraph">
<p>After generating an empty application, a library is going to be generated. Inside the folder of the project, the <code>Angular CLI</code> command <code>ng generate library "library-name"</code> is going to generate the library as a project (<code>projects/"library-name"</code>). As an addition, the option <code>--prefix="library-prefix-wanted"</code> allows us to switch the default prefix that Angular generated with (<code>lib</code>). Using the option to change the prefix the command will look like this <code>ng generate library "library-name" --prefix="library-prefix-wanted"</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng generate library "library-name" --prefix="library-prefix-wanted"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are using Nx, this step is not needed as it is already covered in step 1. In this case, the library project will be generated in the <code>libs</code> folder of a Nx workspace.</p>
</div>
</div>
<div class="sect3">
<h4 id="3-modifying-our-library"><a class="anchor" href="#3-modifying-our-library"></a>7.54. 3. Modifying our library</h4>
<div class="paragraph">
<p>In the last step we generated a library. This automatically generates a <code>module</code>,<code>service</code> and a <code>component</code> inside <code>projects/"library-name"</code> that we can modify adding new methods, components etc that we want to use in other projects. We can generate other elements, using the usual <code>Angular CLI</code> generate commands adding the option <code>--project="library-name"</code>, this will allow to generate elements within our project . An example of this is: <code>ng generate service "name" --project="library-name"</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng generate "element" "name" --project="library-name"</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use the same command as above in a Nx workspace.</p>
</div>
</div>
<div class="sect3">
<h4 id="4-exporting-the-generated-things"><a class="anchor" href="#4-exporting-the-generated-things"></a>7.55. 4. Exporting the generated things</h4>
<div class="paragraph">
<p>Inside the library (<code>projects/"library-name</code>) there&#8217;s a <code>public_api.ts</code> which is the file that exports the elements inside the library. (The file is named as <code>index.ts</code> in an Nx workspace). In case we generated other things, this file needs to be modified adding the extra exports with the generated elements. In addition, changing the library version is possible in the file <code>package.json</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="5-building-our-library"><a class="anchor" href="#5-building-our-library"></a>7.56. 5. Building our library</h4>
<div class="paragraph">
<p>Once we added the necessary exports, in order to use the library in other applications, we need to build the library. The command <code>ng build "library-name"</code> is going to build the library, generating the necessary files in <code>"project-name"/dist/"library-name"</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng build "library-name"</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use the same command in Nx as well. Only the path for the generated files will be slightly different: <code>"project-name"/dist/libs/"library-name"</code></p>
</div>
</div>
<div class="sect3">
<h4 id="id-packing-library"><a class="anchor" href="#id-packing-library"></a>7.57. 6. Packing the library</h4>
<div class="paragraph">
<p>In this step we are going to pack the build library. In order to do so, we need to go inside <code>dist/"library-name"</code> (or <code>dist/libs/"library-name"</code>) and then run either <code>npm pack</code> or <code>yarn pack</code> to generate a <code>"library-name-version.tgz"</code> file.</p>
</div>
<div class="listingblock">
<div class="title">Listing 48. Packing using npm</div>
<div class="content">
<pre class="highlightjs highlight"><code>npm pack</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 49. Packing using yarn</div>
<div class="content">
<pre class="highlightjs highlight"><code>yarn pack</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="7-publishing-to-npm-repository-optional"><a class="anchor" href="#7-publishing-to-npm-repository-optional"></a>7.58. 7. Publishing to npm repository (optional)</h4>
<div class="ulist">
<ul>
<li>
<p>Add a <code><em>README.md</em></code> and <em>LICENSE</em> file. The text inside <code><em>README.md</em></code> will be used in you npm package web page as documentation.</p>
</li>
<li>
<p>run <code>npm adduser</code> if you do not have a npm account to create it, otherwise run <code>npm login</code> and introduce your credentials.</p>
</li>
<li>
<p>run <code>npm publish</code> inside <code>dist/"library-name"</code> folder.</p>
</li>
<li>
<p>Check that the library is published: <a href="https://npmjs.com/package/library-name" class="bare">https://npmjs.com/package/library-name</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="8-installing-our-library-in-other-projects"><a class="anchor" href="#8-installing-our-library-in-other-projects"></a>7.59. 8. Installing our library in other projects</h4>
<div class="paragraph">
<p>In this step we are going to install/add the library on other projects.</p>
</div>
</div>
<div class="sect3">
<h4 id="npm-4"><a class="anchor" href="#npm-4"></a>7.60. ==  npm</h4>
<div class="paragraph">
<p>In order to add the library in other applications, there are two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Option 1</strong>: From inside the application where the library is going to get used, using the command <code>npm install "path-to-tgz"/"library-name-version.tgz"</code> allows us to install the <code>.tgz</code> generated in <a href="#id-packing-library">Packing the library</a>.</p>
</li>
<li>
<p><strong>Option 2</strong>: run <code>npm install "library-name"</code> to install it from npm repository.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="yarn-4"><a class="anchor" href="#yarn-4"></a>7.61. ==  yarn</h4>
<div class="paragraph">
<p>To add the package using yarn:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Option 1</strong>: From inside the application where the library is going to get used, using the command <code>yarn add "path-to-tgz"/"library-name-version.tgz"</code> allows us to install the <code>.tgz</code>  generated in <a href="#id-packing-library">Packing the library</a>.</p>
</li>
<li>
<p><strong>Option 2</strong>: run <code>yarn add "library-name"</code> to install it from npm repository.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="9-using-the-library"><a class="anchor" href="#9-using-the-library"></a>7.62. 9. Using the library</h4>
<div class="paragraph">
<p>Finally, once the library was installed with either packet manager, you can start using the elements from inside like they would be used in a normal element inside the application. Example <code>app.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { Component, OnInit } from '@angular/core';
import { MyLibraryService } from 'my-library';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.scss']
})
export class AppComponent implements OnInit {

  toUpper: string;

  constructor(private myLibraryService: MyLibraryService) {}
  title = 'devon4ng library test';
  ngOnInit(): void {
    this.toUpper = this.myLibraryService.firstLetterToUpper('test');
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example <code>app.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">&lt;!--The content below is only a placeholder and can be replaced.--&gt;
&lt;div style="text-align:center"&gt;
  &lt;h1&gt;
    Welcome to {{ title }}!
  &lt;/h1&gt;
  &lt;img width="300" alt="Angular Logo" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNTAgMjUwIj4KICAgIDxwYXRoIGZpbGw9IiNERDAwMzEiIGQ9Ik0xMjUgMzBMMzEuOSA2My4ybDE0LjIgMTIzLjFMMTI1IDIzMGw3OC45LTQzLjcgMTQuMi0xMjMuMXoiIC8+CiAgICA8cGF0aCBmaWxsPSIjQzMwMDJGIiBkPSJNMTI1IDMwdjIyLjItLjFWMjMwbDc4LjktNDMuNyAxNC4yLTEyMy4xTDEyNSAzMHoiIC8+CiAgICA8cGF0aCAgZmlsbD0iI0ZGRkZGRiIgZD0iTTEyNSA1Mi4xTDY2LjggMTgyLjZoMjEuN2wxMS43LTI5LjJoNDkuNGwxMS43IDI5LjJIMTgzTDEyNSA1Mi4xem0xNyA4My4zaC0zNGwxNy00MC45IDE3IDQwLjl6IiAvPgogIDwvc3ZnPg== "&gt;
&lt;/div&gt;
&lt;h2&gt;Here is my library service being used: {{toUpper}}&lt;/h2&gt;
&lt;lib-my-library&gt;&lt;/lib-my-library&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example <code>app.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';

import { AppRoutingModule } from './app-routing.module';
import { AppComponent } from './app.component';

import { MyLibraryModule } from 'my-library';
@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule,
    AppRoutingModule,
    MyLibraryModule
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result from using the library:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/angular-library/result.png"><img src="_images/images/angular-library/result.png" alt="result"></a>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devon4ng-libraries"><a class="anchor" href="#devon4ng-libraries"></a>7.63. devon4ng libraries</h4>
<div class="paragraph">
<p>In <a href="https://github.com/devonfw/devon4ng-library">devonfw/devon4ng-library</a> you can find some useful libraries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Authorization module</strong>: This devon4ng Angular module adds rights-based authorization to your Angular app.</p>
</li>
<li>
<p><strong>Cache module</strong>: Use this devon4ng Angular module when you want to cache requests to server. You may configure it to store in cache only the requests you need and to set the duration you want.</p>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="angular-material-theming"><a class="anchor" href="#angular-material-theming"></a>7.64. Angular Material Theming</h4>
<div class="paragraph">
<p>Angular Material library offers UI components for developers, those components follows Google Material design baselines but characteristics like colors can be modified in order to adapt them to the needs of the client: corporative colors, corporative identity, dark themes, &#8230;&#8203;</p>
</div>
</div>
<div class="sect3">
<h4 id="theming-basics"><a class="anchor" href="#theming-basics"></a>7.65. Theming basics</h4>
<div class="paragraph">
<p>In Angular Material, a theme is created mixing multiple colors. Colors and its light and dark variants conform a <strong>palette</strong>. In general, a theme consists of the following palettes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>primary</strong>: Most used across screens and components.</p>
</li>
<li>
<p><strong>accent</strong>: Floating action button and interactive elements.</p>
</li>
<li>
<p><strong>warn</strong>: Error state.</p>
</li>
<li>
<p><strong>foreground</strong>: Text and icons.</p>
</li>
<li>
<p><strong>background</strong>: Element backgrounds.</p>
</li>
</ul>
</div>
<div id="id_palette_variants" class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-theming/palette.PNG" alt="Theme palette" width="600 link="images/angular/angular-theming/palette.PNG"">
</div>
<div class="title">Figure 26. Palettes and variants.</div>
</div>
<div class="paragraph">
<p>In angular material, a palette is represented as a SCSS map.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-theming/scss-map.png" alt="SCSS map" width="600 link="images/angular/angular-theming/scss-map.png"">
</div>
<div class="title">Figure 27. SCSS map and palettes.</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Some components can be forced to use primary, accent or warn palettes using the attribute <strong>color</strong>, for example: &lt;mat-toolbar color="primary"&gt;.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="pre-built-themes"><a class="anchor" href="#pre-built-themes"></a>7.66. Pre-built themes</h4>
<div class="paragraph">
<p>Available pre-built themes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>deeppurple-amber.css</code></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-theming/deeppurple-amber.png" alt="`deeppurple-amber theme`" width="600 link="images/angular/angular-theming/deeppurple-amber.png"">
</div>
<div class="title">Figure 28. <code>deeppurple-amber</code> theme.</div>
</div>
<div class="ulist">
<ul>
<li>
<p>indigo-pink.css</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-theming/indigo-pink.png" alt="indigo-pink theme" width="600 link="images/angular/angular-theming/indigo-pink.png"">
</div>
<div class="title">Figure 29. indigo-pink theme.</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pink-bluegrey.css</code></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-theming/pink-bluegrey.png" alt="` pink-bluegrey theme`" width="600 link="images/angular/angular-theming/pink-bluegrey.png"">
</div>
<div class="title">Figure 30. <code>ink-bluegrey theme</code>.</div>
</div>
<div class="ulist">
<ul>
<li>
<p>purple-green.css</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-theming/purple-green.png" alt="purple-green theme" width="600 link="images/angular/angular-theming/purple-green.png"">
</div>
<div class="title">Figure 31. purple-green theme.</div>
</div>
<div class="paragraph">
<p>The pre-built themes can be added using <strong>@import</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">@import '@angular/material/prebuilt-themes/deeppurple-amber.css';</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="custom-themes"><a class="anchor" href="#custom-themes"></a>7.67. Custom themes</h4>
<div class="paragraph">
<p>Sometimes pre-built themes do not meet the needs of a project, because color schemas are too specific or do not incorporate branding colors, in those situations custom themes can be built to offer a better solution to the client.</p>
</div>
<div class="paragraph">
<p>For this topic, we are going to use a basic layout project that can be found in <a href="https://github.com/devonfw-sample/devon4ts-samples/tree/master/apps/angular-material-basic-layout">devon4ts-samples repository</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="basics"><a class="anchor" href="#basics"></a>7.68. Basics</h4>
<div class="paragraph">
<p>Before starting writing custom themes, there are some necessary things that have to be mentioned:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add a default theme: The project mentioned before has just one global SCSS style sheet <code><strong>styles.scss</strong></code> that includes <code>indigo-pink.scss</code> which will be the default theme.</p>
</li>
<li>
<p>Add <em>@import '~@angular/material/theming';</em> at the beginning of the every style sheet to be able to use angular material pre-built color palettes and functions.</p>
</li>
<li>
<p>Add <em>@include mat-core();</em> <strong>once</strong> per project, so if you are writing multiple themes in multiple files you could import those files from a 'central' one (for example <code>styles.scss</code>). This includes all common styles that are used by multiple components.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-theming/theme-files-structure.png" alt="Theme files structure" width="600 link="images/angular/angular-theming/theme-files-structure.png"">
</div>
<div class="title">Figure 32. Theme files structure.</div>
</div>
</div>
<div class="sect3">
<h4 id="basic-custom-theme"><a class="anchor" href="#basic-custom-theme"></a>7.69. Basic custom theme</h4>
<div class="paragraph">
<p>To create a new custom theme, the <code>.scss</code> file containing it has to have imported the angular <code>_theming.scss</code> file (angular/material/theming) file and mat-core included. <code>_theming.scss</code> includes multiple color palettes and some functions that we are going to see below. The file for this basic theme is going to be named <code><strong>styles-custom-dark.scss</strong></code>.</p>
</div>
<div class="paragraph">
<p>First, declare new variables for primary, accent and warn palettes. Those variables are going to store the result of the function <strong>mat-palette</strong>.</p>
</div>
<div class="paragraph">
<p><strong>mat-palette</strong> accepts four arguments: base color palette, main, lighter and darker variants (See <a href="#id_palette_variants">Palettes and variants.</a>) and returns a new palette including some additional map values: default, lighter and darker (<code><a href="#id_scss_map">[id_scss_map]</a></code>). Only the first argument is mandatory.</p>
</div>
<div class="listingblock">
<div class="title">Listing 50. <code>File styles-custom-dark.scss</code>.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">$custom-dark-theme-primary: mat-palette($mat-pink);
$custom-dark-theme-accent: mat-palette($mat-blue);
$custom-dark-theme-warn: mat-palette($mat-red);
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example we are using colors available in <code>_theming.scss</code>: mat-pink, mat-blue, mat-red. If you want to use a custom color you need to define a new map, for instance:</p>
</div>
<div class="listingblock">
<div class="title">Listing 51. File <code>styles-custom-dark.scss</code> custom pink.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">$my-pink: (
    50 : #fcf3f3,
    100 : #f9e0e0,
    200 : #f5cccc,
    300 : #f0b8b8,
    500 : #ea9999,
    900 : #db6b6b,
    A100 : #ffffff,
    A200 : #ffffff,
    A400 : #ffeaea,
    A700 : #ffd0d0,
    contrast: (
        50 : #000000,
        100 : #000000,
        200 : #000000,
        300 : #000000,
        900 : #000000,
        A100 : #000000,
        A200 : #000000,
        A400 : #000000,
        A700 : #000000,
    )
);

$custom-dark-theme-primary: mat-palette($my-pink);
...</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Some pages allows to create these palettes easily, for instance: <a href="http://mcg.mbitson.com" class="bare">http://mcg.mbitson.com</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Until now, we just have defined primary, accent and warn palettes but what about foreground and background? Angular material has two functions to change both:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>mat-light-theme</strong>: Receives as arguments primary, accent and warn palettes and return a theme whose foreground is basically black (texts, icons, &#8230;&#8203;), the background is white and the other palettes are the received ones.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-theming/custom-light.png" alt="`deeppurple-amber theme`" width="600 link="images/angular/angular-theming/custom-light.png"">
</div>
<div class="title">Figure 33. Custom light theme.</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>mat-dark-theme</strong>: Similar to mat-light-theme but returns a theme whose foreground is basically white and background black.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-theming/custom-dark.png" alt="`deeppurple-amber theme`" width="600 link="images/angular/angular-theming/custom-dark.png"">
</div>
<div class="title">Figure 34. Custom dark theme.</div>
</div>
<div class="paragraph">
<p>For this example we are going to use mat-dark-theme and save its result in $custom-dark-theme.</p>
</div>
<div class="listingblock">
<div class="title">Listing 52. File <code>styles-custom-dark.scss</code> updated with mat-dark-theme.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">...

$custom-dark-theme: mat-dark-theme(
  $custom-dark-theme-primary,
  $custom-dark-theme-accent,
  $custom-dark-theme-warn
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>To apply the saved theme, we have to go to <code><strong>styles.scss</strong></code> and import our <code><strong>styles-custom-dark.scss</strong></code> and include a function called <strong>angular-material-theme</strong> using the theme variable as argument.</p>
</div>
<div class="listingblock">
<div class="title">Listing 53. File <code>styles.scss</code>.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">...
@import 'styles-custom-dark.scss';
@include angular-material-theme($custom-dark-theme);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we have multiple themes it is necessary to add the include statement inside a css class and use it in <code>src/index.html &#8594; app-root component</code>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 54. File <code>styles.scss</code> updated with custom-dark-theme class.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">...
@import 'styles-custom-dark.scss';

.custom-dark-theme {
  @include angular-material-theme($custom-dark-theme);
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 55. File <code>src/index.html</code>.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">...
&lt;app-root class="custom-dark-theme"&gt;&lt;/app-root&gt;
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will apply <strong>$custom-dark-theme</strong> theme for the entire application.</p>
</div>
</div>
<div class="sect3">
<h4 id="full-custom-theme"><a class="anchor" href="#full-custom-theme"></a>7.70. Full custom theme</h4>
<div class="paragraph">
<p>Sometimes it is needed to custom different elements from background and foreground, in those situations we have to create a new function similar to <em>mat-light-theme</em> and <em>mat-dark-theme</em>. Let&#8217;s focus con mat-light-theme:</p>
</div>
<div id="source-mat-light" class="listingblock">
<div class="title">Listing 56. Source code of mat-light-theme</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">@function mat-light-theme($primary, $accent, $warn: mat-palette($mat-red)) {
  @return (
    primary: $primary,
    accent: $accent,
    warn: $warn,
    is-dark: false,
    foreground: $mat-light-theme-foreground,
    background: $mat-light-theme-background,
  );
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As we can see, <em>mat-light-theme</em> takes three arguments and returns a map including them as primary, accent and warn color; but there are three more keys in that map: is-dark, foreground and background.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>is-dark</strong>: Boolean true if it is a dark theme, false otherwise.</p>
</li>
<li>
<p><strong>background</strong>: Map that stores the color for multiple background elements.</p>
</li>
<li>
<p><strong>foreground</strong>: Map that stores the color for multiple foreground elements.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To show which elements can be colored lets create a new theme in a file <code><strong>styles-custom-cap.scss</strong></code>:</p>
</div>
<div class="listingblock">
<div class="title">Listing 57. File <code>styles-custom-cap.scss</code>: Background and foreground variables.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">@import '~@angular/material/theming';

// custom background and foreground palettes
$my-cap-theme-background: (
  status-bar: #0070ad,
  app-bar: map_get($mat-blue, 900),
  background: #12abdb,
  hover: rgba(white, 0.04),
  card: map_get($mat-red, 800),
  dialog: map_get($mat-grey, 800),
  disabled-button: $white-12-opacity,
  raised-button: map-get($mat-grey, 800),
  focused-button: $white-6-opacity,
  selected-button: map_get($mat-grey, 900),
  selected-disabled-button: map_get($mat-grey, 800),
  disabled-button-toggle: black,
  unselected-chip: map_get($mat-grey, 700),
  disabled-list-option: black,
);

$my-cap-theme-foreground: (
  base: yellow,
  divider: $white-12-opacity,
  dividers: $white-12-opacity,
  disabled: rgba(white, 0.3),
  disabled-button: rgba(white, 0.3),
  disabled-text: rgba(white, 0.3),
  hint-text: rgba(white, 0.3),
  secondary-text: rgba(white, 0.7),
  icon: white,
  icons: white,
  text: white,
  slider-min: white,
  slider-off: rgba(white, 0.3),
  slider-off-active: rgba(white, 0.3),
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Function which uses the variables defined before to create a new theme:</p>
</div>
<div class="listingblock">
<div class="title">Listing 58. File <code>styles-custom-cap.scss</code>: Creating a new theme function.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">// instead of creating a theme with mat-light-theme or mat-dark-theme,
// we will create our own theme-creating function that lets us apply our own foreground and background palettes.
@function create-my-cap-theme($primary, $accent, $warn: mat-palette($mat-red)) {
  @return (
    primary: $primary,
    accent: $accent,
    warn: $warn,
    is-dark: false,
    foreground: $my-cap-theme-foreground,
    background: $my-cap-theme-background
  );
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Calling the new function and storing its value in <strong>$custom-cap-theme</strong>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 59. File <code>styles-custom-cap.scss</code>: Storing the new theme.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">// We use create-my-cap-theme instead of mat-light-theme or mat-dark-theme
$custom-cap-theme-primary: mat-palette($mat-green);
$custom-cap-theme-accent: mat-palette($mat-blue);
$custom-cap-theme-warn: mat-palette($mat-red);

$custom-cap-theme: create-my-cap-theme(
  $custom-cap-theme-primary,
  $custom-cap-theme-accent,
  $custom-cap-theme-warn
);</code></pre>
</div>
</div>
<div class="paragraph">
<p>After defining our new theme, we can import it from <code>styles.scss</code>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 60. File <code>styles.scss</code> updated with custom-cap-theme class.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scss hljs" data-lang="scss">...
@import 'styles-custom-cap.scss';
.custom-cap-theme {
  @include angular-material-theme($custom-cap-theme);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="multiple-themes-and-overlay-based-components"><a class="anchor" href="#multiple-themes-and-overlay-based-components"></a>7.71. Multiple themes and overlay-based components</h4>
<div class="paragraph">
<p>Certain components (e.g. menu, select, dialog, etc.) that are inside of a global overlay container,require an additional step to be affected by the theme&#8217;s css class selector.</p>
</div>
<div class="listingblock">
<div class="title">Listing 61. File app.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import {OverlayContainer} from '@angular/cdk/overlay';

@NgModule({
  // ...
})
export class AppModule {
  constructor(overlayContainer: OverlayContainer) {
    overlayContainer.getContainerElement().classList.add('custom-cap-theme');
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="useful-resources"><a class="anchor" href="#useful-resources"></a>7.72. Useful resources</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://material.angular.io/guide/theming">Angular Material&#8217;s official theming guide</a></p>
</li>
<li>
<p><a href="https://material.io/design/color/#color-theme-creation">Material Design: Color theme creation</a></p>
</li>
<li>
<p><a href="http://mcg.mbitson.com">Palette generator</a></p>
</li>
<li>
<p><a href="https://sass-lang.com/guide">SCSS tutorial</a></p>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="angular-progressive-web-app"><a class="anchor" href="#angular-progressive-web-app"></a>7.73. Angular Progressive Web App</h4>
<div class="paragraph">
<p>Progressive web applications (PWA) are web application that offer better user experience than the traditional ones. In general, they solve problems related with reliability and speed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Reliability</em>:  PWA are stable. In this context stability means than even with slow connections or even with no network at all, the application still works. To achieve this, some basic resources like styles, fonts, requests, &#8230;&#8203; are stored; due to this caching, it is not possible to assure that the content is always up-to-date.</p>
</li>
<li>
<p><em>Speed</em>: When an users opens an application, he or she will expect it to load almost immediately (almost 53% of users abandon sites that take longer that 3 seconds, source: <a href="https://developers.google.com/web/progressive-web-apps/#fast" class="bare">https://developers.google.com/web/progressive-web-apps/#fast</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>PWA uses a script called <a href="https://developers.google.com/web/fundamentals/primers/service-workers/">service worker</a>, which runs in background and essentially act as proxy between web app and network, intercepting requests and acting depending on the network conditions.</p>
</div>
</div>
<div class="sect3">
<h4 id="assumptions"><a class="anchor" href="#assumptions"></a>7.74. Assumptions</h4>
<div class="paragraph">
<p>This guide assumes that you already have installed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>NodeJS</p>
</li>
<li>
<p>npm package manager</p>
</li>
<li>
<p>Angular CLI / Nx CLI</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sample-application"><a class="anchor" href="#sample-application"></a>7.75. Sample Application</h4>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-pwa/mts-pwa-rec.png" alt="My Thai Star recommendation" width="800 link="images/angular/angular-pwa/mts-pwa-rec.png"">
</div>
<div class="title">Figure 35. Basic angular PWA.</div>
</div>
<div class="paragraph">
<p>To explain how to build PWA using angular, a basic application is going to be built. This app will be able to ask for resources and save in the cache in order to work even offline.</p>
</div>
</div>
<div class="sect3">
<h4 id="step-1-create-a-new-project"><a class="anchor" href="#step-1-create-a-new-project"></a>7.76. Step 1: Create a new project</h4>
<div class="paragraph">
<p>This step can be completed with one simple command using the Angular CLI: <code>ng new &lt;name&gt;</code>, where <code>&lt;name&gt;</code> is the name for the app. In this case, the app is going to be named <code><strong>basic-ng-pwa</strong></code>. If you are using Nx CLI, you can use the command <code>nx generate @nrwl/angular:app &lt;name&gt;</code> in your Nx workspace. You can follow <a href="https://github.com/devonfw/devon4ng/wiki/guide-creating-angular-app-with-nx-cli">this guide</a> if you want to get started with Nx workspace.</p>
</div>
</div>
<div class="sect3">
<h4 id="step-2-create-a-service"><a class="anchor" href="#step-2-create-a-service"></a>7.77. Step 2: Create a service</h4>
<div class="paragraph">
<p>Web applications usually uses external resources, making necessary the addition of services which can get those resources. This application gets a dish from My Thai Star&#8217;s back-end and shows it. To do so, a new service is going to be created.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>go to project folder: <code>cd basic-ng-pwa</code>. If using Nx, go to the root folder of the workspace.</p>
</li>
<li>
<p>run <code>ng generate service data</code>. For Nx CLI, specify the project name with <code>--project</code> flag. So the command becomes <code>ng generate service data --project=basic-ng-pwa</code></p>
</li>
<li>
<p>Modify <strong>data.service.ts</strong>, <strong>environment.ts</strong>, <strong>environment.prod.ts</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To retrieve data with this service, you have to import the module <code>HttpClient</code> and add it to the service&#8217;s constructor. Once added, use it to create a function <code><strong>getDishes()</strong></code> that sends HTTP request to My Thai Start&#8217;s back-end. The URL of the back-end can be stored as an environment variable <strong>MY_THAI_STAR_DISH</strong>.</p>
</div>
<div class="paragraph">
<p><strong>data.service.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">  ...
  import { HttpClient } from '@angular/common/http';
  import { MY_THAI_STAR_DISH } from '../environments/environment';
  ...

  export class DataService {
    constructor(private http: HttpClient) {}

    /* Get data from Back-end */
    getDishes() {
      return this.http.get(MY_THAI_STAR_DISH);
    }
    ...
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>environments.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">  ...
  export const MY_THAI_STAR_DISH =
  'https://mts-devonfw-core.cloud.okteto.net/api/services/rest/dishmanagement/v1/dish/1';
  ...</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>environments.prod.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">  ...
  export const MY_THAI_STAR_DISH =
  'https://mts-devonfw-core.cloud.okteto.net/api/services/rest/dishmanagement/v1/dish/1';
  ...</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="step-3-use-the-service"><a class="anchor" href="#step-3-use-the-service"></a>7.78. Step 3: Use the service</h4>
<div class="paragraph">
<p>The component <code>AppComponent</code> implements the interface <code>OnInit</code> and inside its method <code>ngOnInit()</code> the subscription to the services is done. When a dish arrives, it is saved and shown (app.component.html).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">  ...
  import { DataService } from './data.service';
  export class AppComponent implements OnInit {
  dish: { name: string; description: string } = { name: '', description: ''};

  ...
  ngOnInit() {
    this.data
      .getDishes()
      .subscribe(
        (dishToday: { dish: { name: string; description: string } }) =&gt; {
          this.dish = {
            name: dishToday.dish.name,
            description: dishToday.dish.description,
          };
        },
      );
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="step-4-structures-styles-and-updates"><a class="anchor" href="#step-4-structures-styles-and-updates"></a>7.79. Step 4: Structures, styles and updates</h4>
<div class="paragraph">
<p>This step shows code interesting inside the sample app. The complete content can be found in <a href="https://github.com/devonfw-sample/devon4ts-samples/tree/master/apps/angular-basic-pwa">devon4ts-samples</a>.</p>
</div>
<div class="paragraph">
<p><strong>index.html</strong></p>
</div>
<div class="paragraph">
<p>To use the Montserrat font add the following link inside the <code>head</code> tag of the app&#8217;s index.html file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">  &lt;link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet"&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><strong>styles.scss</strong></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-css hljs" data-lang="css">  body {
    ...
    font-family: 'Montserrat', sans-serif;
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p><code><strong>app.component.ts</strong></code></p>
</div>
<div class="paragraph">
<p>This file is also used to reload the app if there are any changes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SwUpdate</code>: This object comes inside the <code>@angular/pwa</code> package and it is used to detect changes and reload the page if needed.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">  ...
  import { SwUpdate } from '@angular/service-worker';

  export class AppComponent implements OnInit {

  ...
    constructor(updates: SwUpdate, private data: DataService) {
      updates.available.subscribe((event) =&gt; {
        updates.activateUpdate().then(() =&gt; document.location.reload());
      });
    }
    ...
  }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="step-5-make-it-progressive"><a class="anchor" href="#step-5-make-it-progressive"></a>7.80. Step 5: Make it Progressive.</h4>
<div class="paragraph">
<p>Install Angular PWA package with <code>ng add @angular/pwa --project=&lt;name&gt;</code>. As before substitute <code>name</code> with <code><strong>basic-ng-pwa</strong></code>.</p>
</div>
<div class="paragraph">
<p>The above command completes the following actions:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adds the @angular/service-worker package to your project.</p>
</li>
<li>
<p>Enables service worker build support in the CLI.</p>
</li>
<li>
<p>Imports and registers the service worker in the app module.</p>
</li>
<li>
<p>Updates the <code>index.html</code> file:</p>
<div class="ulist">
<ul>
<li>
<p>Includes a link to add the <code>manifest.json</code> file.</p>
</li>
<li>
<p>Adds meta tags for theme-color.</p>
</li>
<li>
<p>Installs icon files to support the installed Progressive Web App (PWA).</p>
</li>
<li>
<p>Creates the service worker configuration file called <code>ngsw-config.json</code>, which specifies the caching behaviors and other settings.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="manifest-json"><a class="anchor" href="#manifest-json"></a>7.81. ==  <code>manifest.json</code></h4>
<div class="paragraph">
<p>manifest.json is a file that allows to control how the app is displayed in places where native apps are displayed.</p>
</div>
<div class="paragraph">
<p><strong>Fields</strong></p>
</div>
<div class="paragraph">
<p><code>name</code>: Name of the web application.</p>
</div>
<div class="paragraph">
<p><code>short_name</code>: Short version of name.</p>
</div>
<div class="paragraph">
<p><code>theme_color</code>: Default theme color for an application context.</p>
</div>
<div class="paragraph">
<p><code>background_color</code>: Expected background color of the web application.</p>
</div>
<div class="paragraph">
<p><code>display</code>: Preferred display mode.</p>
</div>
<div class="paragraph">
<p><code>scope</code>: Navigation scope of this web application&#8217;s application context.</p>
</div>
<div class="paragraph">
<p><code>start_url</code>: URL loaded when the user launches the web application.</p>
</div>
<div class="paragraph">
<p><code>icons</code>: Array of icons that serve as representations of the web app.</p>
</div>
<div class="paragraph">
<p>Additional information can be found <a href="https://developers.google.com/web/fundamentals/web-app-manifest/">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="ngsw-config-json"><a class="anchor" href="#ngsw-config-json"></a>7.82. ==  <code>ngsw-config.json</code></h4>
<div class="paragraph">
<p>ngsw-config.json specifies which files and data URLs have to be cached and updated by the Angular service worker.</p>
</div>
<div class="paragraph">
<p><strong>Fields</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>index</em>: File that serves as index page to satisfy navigation requests.</p>
</li>
<li>
<p><code><em>assetGroups</em></code>: Resources that are part of the app version that update along with the app.</p>
<div class="ulist">
<ul>
<li>
<p><em>name</em>: Identifies the group.</p>
</li>
<li>
<p><code><em>installMode</em></code>: How the resources are cached (pre-fetch or lazy).</p>
</li>
<li>
<p><code><em>updateMode</em></code>: Caching behavior when a new version of the app is found (pre-fetch or lazy).</p>
</li>
<li>
<p><em>resources</em>: Resources to cache. There are three groups.</p>
<div class="ulist">
<ul>
<li>
<p><em>files</em>: Lists patterns that match files in the distribution directory.</p>
</li>
<li>
<p><code><em>urls</em></code>:  URL patterns matched at runtime.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code><em>dataGroups</em></code>: <code>UsefulIdentifies</code> the group. for API requests.</p>
<div class="ulist">
<ul>
<li>
<p><em>name</em>: Identifies the group.</p>
</li>
<li>
<p><code><em>urls</em></code>: URL patterns matched at runtime.</p>
</li>
<li>
<p><em>version</em>:  Indicates that the resources being cached have been updated in a backwards-incompatible way.</p>
</li>
<li>
<p><code><em>cacheConfig</em></code>: Policy by which matching requests will be cached</p>
<div class="ulist">
<ul>
<li>
<p><code><em>maxSize</em></code>: The maximum number of entries, or responses, in the cache.</p>
</li>
<li>
<p><code><em>maxAge</em></code>: How long responses are allowed to remain in the cache.</p>
<div class="ulist">
<ul>
<li>
<p>d: days. (5d = 5 days).</p>
</li>
<li>
<p>h: hours</p>
</li>
<li>
<p>m: minutes</p>
</li>
<li>
<p>s: seconds. (5m20s = 5 minutes and 20 seconds).</p>
</li>
<li>
<p>u: milliseconds</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>timeout</em>: How long the Angular service worker will wait for the network to respond before using a cached response. Same <code>dataformat</code> as <code>maxAge</code>.</p>
</li>
<li>
<p><em>strategy</em>: Caching strategies (performance or freshness).</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code><em>navigationUrls</em></code>: List of URLs that will be redirected to the index file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Additional information can be found <a href="https://angular.io/guide/service-worker-config">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="step-6-configure-the-app"><a class="anchor" href="#step-6-configure-the-app"></a>7.83. Step 6: Configure the app</h4>
<div class="paragraph">
<p><strong>manifest.json</strong></p>
</div>
<div class="paragraph">
<p>Default configuration.</p>
</div>
<div class="paragraph">
<p>&#160;<br>
&#160;<br></p>
</div>
<div class="paragraph">
<p><code><strong>ngsw-config.json</strong></code></p>
</div>
<div class="paragraph">
<p>At <code><em>assetGroups &#8594; resources &#8594; urls</em></code>: In this field the google fonts API is added in order to use Montserrat font even without network.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  "urls": [
          "https://fonts.googleapis.com/**"
        ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>At the root of the json: A data group to cache API calls.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  {
    ...
    "dataGroups": [{
      "name": "mythaistar-dishes",
      "urls": [
        "https://mts-devonfw-core.cloud.okteto.net/api/services/rest/dishmanagement/v1/dish/1"
      ],
      "cacheConfig": {
        "maxSize": 100,
        "maxAge": "1h",
        "timeout": "10s",
        "strategy": "freshness"
      }
    }]
  }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="step-7-check-that-your-app-is-a-pwa"><a class="anchor" href="#step-7-check-that-your-app-is-a-pwa"></a>7.84. Step 7: Check that your app is a PWA</h4>
<div class="paragraph">
<p>To check if an app is a PWA lets compare its normal behavior against itself but built for production. Run in the project&#8217;s root folder the commands below:</p>
</div>
<div class="paragraph">
<p><code>ng build --prod</code> to build the app using production settings.(<code>nx build &lt;name&gt; --prod</code> in Nx CLI)</p>
</div>
<div class="paragraph">
<p><code>npm install http-server</code> to install an npm module that can serve your built application. Documentation <a href="https://www.npmjs.com/package/http-server">here</a>.</p>
</div>
<div class="paragraph">
<p>Go to the <code>dist/basic-ng-pwa/</code> folder running <code>cd dist/basic-ng-pwa</code>. In an Nx workspace, the path will be <code>dist/apps/basic-ng-pwa</code></p>
</div>
<div class="paragraph">
<p><code>http-server -o</code> to serve your built app.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-pwa/http-serve.png" alt="Http server running" width="600 link="images/angular/angular-pwa/http-serve.png"">
</div>
<div class="title">Figure 36. Http server running on localhost:8081.</div>
</div>
<div class="paragraph">
<p>&#160;</p>
</div>
<div class="paragraph">
<p>In another console instance run <code>ng serve</code> (or <code>nx serve basic-ng-pwa</code> for Nx) to open the common app (not built).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-pwa/ng-serve.png" alt=".Angular server running" width="600 link="images/angular/angular-pwa/ng-serve.png"">
</div>
<div class="title">Figure 37. Angular server running on localhost:4200.</div>
</div>
<div class="paragraph">
<p>&#160;</p>
</div>
<div class="paragraph">
<p>The first difference can be found on <em>Developer tools &#8594; application</em>, here it is seen that the PWA application (left) has a service worker and the common (right) one does not.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-pwa/pwa-nopwa-app-ng.png" alt="Application comparison" width="800 link="images/angular/angular-pwa/pwa-nopwa-app-ng.png"">
</div>
<div class="title">Figure 38. Application service worker comparison.</div>
</div>
<div class="paragraph">
<p>&#160;</p>
</div>
<div class="paragraph">
<p>If the "offline" box is checked, it will force a disconnection from network. In situations where users do not have connectivity or have a slow, one the PWA can still be accessed and used.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-pwa/online-offline-ng.png" alt="Online offline apps" width="800 link="images/angular/angular-pwa/online-offline-ng.png"">
</div>
<div class="title">Figure 39. Offline application.</div>
</div>
<div class="paragraph">
<p>&#160;</p>
</div>
<div class="paragraph">
<p>Finally, browser extensions like <a href="https://chrome.google.com/webstore/detail/lighthouse/blipmdconlkpinefehnmjammfjpmpbjk">Lighthouse</a> can be used to test whether an application is progressive or not.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/angular/angular-pwa/lighthouse-ng.png" alt="Lighthouse report" width="800 link="images/angular/angular-pwa/lighthouse-ng.png"">
</div>
<div class="title">Figure 40. Lighthouse report.</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="app_initializer"><a class="anchor" href="#app_initializer"></a>7.85. <code>APP_INITIALIZER</code></h4>

</div>
<div class="sect3">
<h4 id="what-is-the-app_initializer-pattern"><a class="anchor" href="#what-is-the-app_initializer-pattern"></a>7.86. What is the <code>APP_INITIALIZER</code> pattern</h4>
<div class="paragraph">
<p>The <code>APP_INITIALIZER</code> pattern allows an application to choose which configuration is going to be used in the start of the application, this is useful because it allows to setup different configurations, for example, for docker or a remote configuration. This provides benefits since this is done on <code>runtime</code>, so there&#8217;s no need to recompile the whole application to switch from configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="what-is-app_initializer"><a class="anchor" href="#what-is-app_initializer"></a>7.87. What is <code>APP_INITIALIZER</code></h4>
<div class="paragraph">
<p><code>APP_INITIALIZER</code> allows to provide a service in the initialization of the application in a <code>@NgModule</code>. It also allows to use a factory, allowing to create a singleton in the same service. An example can be found in <code>MyThaiStar</code> <code>/core/config/config.module.ts</code>:</p>
</div>
</div>
<div class="sect3">
<h4 id="-4"><a class="anchor" href="#-4"></a>==</h4>
<div class="paragraph">
<p>The provider expects the return of a <code>Promise</code>, if it is using Observables, a change with the method <code>toPromise()</code> will allow a switch from <code>Observable</code> to <code>Promise</code>
== ==</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { NgModule, APP_INITIALIZER } from '@angular/core';
import { HttpClientModule } from '@angular/common/http';

import { ConfigService } from './config.service';

@NgModule({
  imports: [HttpClientModule],
  providers: [
    ConfigService,
    {
      provide: APP_INITIALIZER,
      useFactory: ConfigService.factory,
      deps: [ConfigService],
      multi: true,
    },
  ],
})
export class ConfigModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is going to allow the creation of a <code>ConfigService</code> where, using a singleton, the service is going to load an external config depending on a route. This dependence with a route, allows to setup different configuration for docker etc. This is seen in the <code>ConfigService</code> of <code>MyThaiStar</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Config, config } from './config';

@Injectable()
export class ConfigService {
  constructor(private httpClient: HttpClient) {}

  static factory(appLoadService: ConfigService) {
    return () =&gt; appLoadService.loadExternalConfig();
  }

  // this method gets external configuration calling /config endpoint
  //and merges into config object
  loadExternalConfig(): Promise&lt;any&gt; {
    if (!environment.loadExternalConfig) {
      return Promise.resolve({});
    }

    const promise = this.httpClient
      .get('/config')
      .toPromise()
      .then((settings) =&gt; {
        Object.keys(settings || {}).forEach((k) =&gt; {
          config[k] = settings[k];
        });
        return settings;
      })
      .catch((error) =&gt; {
        return 'ok, no external configuration';
      });

    return promise;
  }

  getValues(): Config {
    return config;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As it is mentioned earlier, you can see the use of a factory to create a singleton at the start. After that, <code>loadExternalConfig</code> is going to look for a Boolean inside the corresponding environment file inside the path <code>src/environments/</code>, this Boolean <code>loadExternalConfig</code> is going to easily allow to switch to a external config. If it is true, it generates a promise that overwrites the parameters of the local config, allowing to load the external config. Finally, the last method <code>getValues()</code> is going to allow to return the file config with the values (overwritten or not). The local <code>config</code> file from <code>MyThaiStar</code> can be seen here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">export enum BackendType {
  IN_MEMORY,
  REST,
  GRAPHQL,
}

interface Role {
  name: string;
  permission: number;
}

interface Lang {
  label: string;
  value: string;
}

export interface Config {
  version: string;
  backendType: BackendType;
  restPathRoot: string;
  restServiceRoot: string;
  pageSizes: number[];
  pageSizesDialog: number[];
  roles: Role[];
  langs: Lang[];
}

export const config: Config = {
  version: 'dev',
  backendType: BackendType.REST,
  restPathRoot: 'http://localhost:8081/mythaistar/',
  restServiceRoot: 'http://localhost:8081/mythaistar/services/rest/',
  pageSizes: [8, 16, 24],
  pageSizesDialog: [4, 8, 12],
  roles: [
    { name: 'CUSTOMER', permission: 0 },
    { name: 'WAITER', permission: 1 },
  ],
  langs: [
    { label: 'English', value: 'en' },
    { label: 'Deutsch', value: 'de' },
    { label: 'Español', value: 'es' },
    { label: 'Català', value: 'ca' },
    { label: 'Français', value: 'fr' },
    { label: 'Nederlands', value: 'nl' },
    { label: 'हिन्दी', value: 'hi' },
    { label: 'Polski', value: 'pl' },
    { label: 'Русский', value: 'ru' },
    { label: 'български', value: 'bg' },
  ],
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, inside a environment file <code>src/environments/environment.ts</code> the use of the Boolean <code>loadExternalConfig</code> is seen:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">// The file contents for the current environment will overwrite these during build.
// The build system defaults to the dev environment which uses `environment.ts`, but if you do
// `ng build --env=prod` then `environment.prod.ts` will be used instead.
// The list of which env maps to which file can be found in `.angular-cli.json`.

export const environment: {
  production: boolean;
  loadExternalConfig: boolean;
} = { production: false, loadExternalConfig: false };</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="creating-a-app_initializer-configuration"><a class="anchor" href="#creating-a-app_initializer-configuration"></a>7.88. Creating a <code>APP_INITIALIZER</code> configuration</h4>
<div class="paragraph">
<p>This section is going to be used to create a new <code>APP_INITIALIZER</code> basic example. For this, a basic app with angular is going to be generated using <code>ng new "appname"</code> substituting <code>appname</code> for the name of the app opted.
If you are using Nx, the command would be <code>nx generate @nrwl/angular:app "appname"</code> in your Nx workspace. <a href="https://github.com/devonfw/devon4ng/wiki/guide-creating-angular-app-with-nx-cli">Click here</a> to get started with using Nx.</p>
</div>
</div>
<div class="sect3">
<h4 id="setting-up-the-config-files"><a class="anchor" href="#setting-up-the-config-files"></a>7.89. Setting up the config files</h4>

</div>
<div class="sect3">
<h4 id="docker-external-configuration-optional"><a class="anchor" href="#docker-external-configuration-optional"></a>7.90. Docker external configuration (Optional)</h4>
<div class="paragraph">
<p>This section is only done if there is a docker configuration in the app you are setting up this type of configuration.</p>
</div>
<div class="paragraph">
<p>1.- Create in the root folder <code>/docker-external-config.json</code>. This external config is going to be used when the application is loaded with docker (if the Boolean to load the external configuration is set to true). Here you need to add all the config parameter you want to load with docker:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "version": "docker-version"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>2.- In the root, in the file <code>/Dockerfile</code> angular is going to copy the <code>docker-external-config.json</code> that was created before into the Nginx html route:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>....
COPY docker-external-config.json /usr/share/nginx/html/docker-external-config.json
....</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="external-json-configuration"><a class="anchor" href="#external-json-configuration"></a>7.91. External json configuration</h4>
<div class="paragraph">
<p>1.- Create a json file in the route <code>/src/external-config.json</code>. This external config is going to be used when the application is loaded with the start script (if the Boolean to load the external configuration is set to true). Here you need to add all the config parameter you want to load:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "version": "external-config"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>2.- The file named <code>/angular.json</code> (<code>/workspace.json</code> if using Nx) located at the root is going to be modified to add the file <code>external-config.json</code> that was just created to both <code>"assets"</code> inside <code>Build</code> and <code>Test</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">	....
	"build": {
          ....
            "assets": [
              "src/assets",
              "src/data",
              "src/favicon.ico",
              "src/manifest.json",
              "src/external-config.json"
            ]
	        ....
        "test": {
	  ....
	   "assets": [
              "src/assets",
              "src/data",
              "src/favicon.ico",
              "src/manifest.json",
              "src/external-config.json"
            ]
	  ....</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="setting-up-the-proxies"><a class="anchor" href="#setting-up-the-proxies"></a>7.92. Setting up the proxies</h4>
<div class="paragraph">
<p>This step is going to setup two proxies. This is going to allow to load the config desired by the context, in case that it is using docker to load the app or in case it loads the app with angular. Loading different files is made possible by the fact that the <code>ConfigService</code> method <code>loadExternalConfig()</code> looks for the path <code>/config</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="docker-optional"><a class="anchor" href="#docker-optional"></a>7.93. Docker (Optional)</h4>
<div class="paragraph">
<p>1.- This step is going to be for docker. Add <code>docker-external-config.json</code> to Nginx configuration (<code>/nginx.conf</code>) that is in the root of the application:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>....
  location  ~ ^/config {
        alias /usr/share/nginx/html/docker-external-config.json;
  }
....</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="external-configuration"><a class="anchor" href="#external-configuration"></a>7.94. External Configuration</h4>
<div class="paragraph">
<p>1.- Now the file <code>/proxy.conf.json</code>, needs to be created/modified this file can be found in the root of the application. In this file you can add the route of the external configuration in <code>target</code> and the name of the file in <code>^/config:</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">....
  "/config": {
    "target": "http://localhost:4200",
    "secure": false,
    "pathRewrite": {
      "^/config": "/external-config.json"
    }
  }
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>2.- The file <code>package.json</code> found in the root of the application is gonna use the start script to load the proxy config that was just created :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">  "scripts": {
....
    "start": "ng serve --proxy-config proxy.conf.json -o",
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>If using Nx, you need to run the command manually:</p>
</div>
<div class="paragraph">
<p><code>nx run angular-app-initializer:serve:development --proxyConfig=proxy.conf.json --o</code></p>
</div>
</div>
<div class="sect3">
<h4 id="adding-the-loadexternalconfig-boolean-to-the-environments"><a class="anchor" href="#adding-the-loadexternalconfig-boolean-to-the-environments"></a>7.95. Adding the <code>loadExternalConfig</code> Boolean to the environments</h4>
<div class="paragraph">
<p>In order to load an external config we need to add the <code>loadExternalConfig</code> Boolean to the environments. To do so, inside the folder <code>environments/</code> the files are going to get modified adding this Boolean to each environment that is going to be used. In this case, only two environments are going to be modified (<code>environment.ts</code> and <code>environment.prod.ts</code>). Down below there is an example of the modification being done in the <code>environment.prod.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">export const environment: {
  production: boolean;
  loadExternalConfig: boolean;
} = { production: false, loadExternalConfig: false };</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the file in first instance there is the declaration of the types of the variables. After that, there is the definition of those variables. This variable <code>loadExternalConfig</code> is going to be used by the service, allowing to setup a external config just by switching the <code>loadExternalConfig</code> to true.</p>
</div>
</div>
<div class="sect3">
<h4 id="creating-core-configuration-service"><a class="anchor" href="#creating-core-configuration-service"></a>7.96. Creating core configuration service</h4>
<div class="paragraph">
<p>In order to create the whole configuration module three are going to be created:</p>
</div>
<div class="paragraph">
<p>1.- Create in the core <code>app/core/config/</code> a <code>config.ts</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">  export interface Config {
    version: string;
  }

  export const config: Config = {
    version: 'dev'
  };</code></pre>
</div>
</div>
<div class="paragraph">
<p>Taking a look to this file, it creates a interface (<code>Config</code>) that is going to be used by the variable that exports (<code>export const config: Config</code>). This variable <code>config</code> is going to be used by the service that is going to be created.</p>
</div>
<div class="paragraph">
<p>2.- Create in the core <code>app/core/config/</code> a <code>config.service.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Config, config } from './config';

@Injectable()
export class ConfigService {
  constructor(private httpClient: HttpClient) {}

  static factory(appLoadService: ConfigService) {
    return () =&gt; appLoadService.loadExternalConfig();
  }

  // this method gets external configuration calling /config endpoint
  // and merges into config object
  loadExternalConfig(): Promise&lt;any&gt; {
    if (!environment.loadExternalConfig) {
      return Promise.resolve({});
    }

    const promise = this.httpClient
      .get('/config')
      .toPromise()
      .then((settings) =&gt; {
        Object.keys(settings || {}).forEach((k) =&gt; {
          config[k] = settings[k];
        });
        return settings;
      })
      .catch((error) =&gt; {
        return 'ok, no external configuration';
      });

    return promise;
  }

  getValues(): Config {
    return config;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As it was explained in previous steps, at first, there is a factory that uses the method <code>loadExternalConfig()</code>, this factory is going to be used in later steps in the module. After that, the <code>loadExternalConfig()</code> method checks if the Boolean in the environment is false. If it is false it will return the promise resolved with the normal config. Else, it is going to load the external config in the path (<code>/config</code>), and overwrite the values from the external config to the config that&#8217;s going to be used by the app, this is all returned in a promise.</p>
</div>
<div class="paragraph">
<p>3.- Create in the core a module for the config <code>app/core/config/</code> a <code>config.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { NgModule, APP_INITIALIZER } from '@angular/core';
import { HttpClientModule } from '@angular/common/http';

import { ConfigService } from './config.service';

@NgModule({
  imports: [HttpClientModule],
  providers: [
    ConfigService,
    {
      provide: APP_INITIALIZER,
      useFactory: ConfigService.factory,
      deps: [ConfigService],
      multi: true,
    },
  ],
})
export class ConfigModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As seen earlier, the <code>ConfigService</code> is added to the module. In this addition, the app is initialized(<code>provide</code>) and it uses the factory that was created in the <code>ConfigService</code> loading the config with or without the external values depending on the Boolean in the <code>config</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="using-the-config-service"><a class="anchor" href="#using-the-config-service"></a>7.97. Using the Config Service</h4>
<div class="paragraph">
<p>As a first step, in the file <code>/app/app.module.ts</code> the <code>ConfigModule</code> created earlier in the other step is going to be imported:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">  imports: [
    ....
    ConfigModule,
    ....
  ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>After that, the <code>ConfigService</code> is going to be injected into the <code>app.component.ts</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">....
import { ConfigService } from './core/config/config.service';
....
export class AppComponent {
....
  constructor(public configService: ConfigService) { }
....</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, for this demonstration app, the component <code>app/app.component.html</code> is going to show the version of the config it is using at that moment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;div style="text-align:center"&gt;
  &lt;h1&gt;
    Welcome to {{ title }}!
  &lt;/h1&gt;
&lt;/div&gt;
&lt;h2&gt;Here is the configuration version that is using angular right now: {{configService.getValues().version}}&lt;/h2&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="final-steps"><a class="anchor" href="#final-steps"></a>7.98. Final steps</h4>
<div class="paragraph">
<p>The script <code>start</code> that was created earlier in the <code>package.json</code> (<code>npm start</code>) is going to be used to start the application. After that, modifying the Boolean <code>loadExternalConfig</code> inside the corresponding environment file inside <code>/app/environments/</code> should show the different config versions.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/loadExternalConfigFalse.png"><img src="_images/images/app-initializer/loadExternalConfigFalse.png" alt="loadExternalConfigFalse"></a>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/loadExternalConfigTrue.png"><img src="_images/images/app-initializer/loadExternalConfigTrue.png" alt="loadExternalConfigTrue"></a>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="component-decomposition"><a class="anchor" href="#component-decomposition"></a>7.99. Component Decomposition</h4>
<div class="paragraph">
<p>When implementing a new requirement there are a few design decisions, which need to be considered.
A decomposition in <em>Smart</em> and <em>Dumb Components</em> should be done first.
This includes the definition of state and responsibilities.
Implementing a new dialog will most likely be done by defining a new <em>Smart Component</em> with multiple <em>Dumb Component</em> children.</p>
</div>
<div class="paragraph">
<p>In the component tree this would translate to the definition of a new sub-tree.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-tree-highlighted-subtree.svg"><img src="_images/images/component-tree-highlighted-subtree.svg" alt="Component Tree With Highlighted Sub Tree" width="450"></a>
</div>
<div class="title">Figure 41. Component Tree with highlighted sub-tree</div>
</div>
</div>
<div class="sect3">
<h4 id="defining-components"><a class="anchor" href="#defining-components"></a>7.100. Defining Components</h4>
<div class="paragraph">
<p>The following gives an example for component decomposition.
Shown is a screenshot from a style guide to be implemented.
It is a widget called <code>Listpicker</code>.</p>
</div>
<div class="paragraph">
<p>The basic function is an <code>input</code> field accepting direct input.
So typing <code>otto</code> puts <code>otto</code> inside the <code>FormControl</code>.
With arrow down key or by clicking the icon displayed in the inputs right edge a dropdown is opened.
Inside possible values can be selected and filtered beforehand.
After pressing arrow down key the focus should move into the filter input field.
Up and down arrow keys can be used to select an element from the list.
Typing into the filter input field filters the list from which the elements can be selected.
The current selected element is highlighted with green background color.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-decomposition-example-1.svg"><img src="_images/images/component-decomposition-example-1.svg" alt="Component Decomposition Example 1v2" width="450"></a>
</div>
<div class="title">Figure 42. Component decomposition example before</div>
</div>
<div class="paragraph">
<p>What should be done, is to define small reusable <em>Dumb Components</em>.
This way the complexity becomes manageable.
In the example every colored box describes a component with the purple box being a <em>Smart Component</em>.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-decomposition-example-2.svg"><img src="_images/images/component-decomposition-example-2.svg" alt="Component Decomposition Example 2v2" width="450"></a>
</div>
<div class="title">Figure 43. Component decomposition example after</div>
</div>
<div class="paragraph">
<p>This leads to the following component tree.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/component-decomposition-example-component-tree.svg"><img src="_images/images/component-decomposition-example-component-tree.svg" alt="Component Decomposition Example component tree" width="450"></a>
</div>
<div class="title">Figure 44. Component decomposition example component tree</div>
</div>
<div class="paragraph">
<p>Note the uppermost component is a <em>Dumb Component</em>.
It is a wrapper for the label and the component to be displayed inside a form.
The <em>Smart Component</em> is <code>Listpicker</code>.
This way the widget can be reused without a form needed.</p>
</div>
<div class="paragraph">
<p>A widgets is a typical <em>Smart Component</em> to be shared across feature modules.
So the <code>SharedModule</code> is the place for it to be defined.</p>
</div>
</div>
<div class="sect3">
<h4 id="defining-state"><a class="anchor" href="#defining-state"></a>7.101. Defining state</h4>
<div class="paragraph">
<p>Every UI has state.
There are different kinds of state, for example</p>
</div>
<div class="ulist">
<ul>
<li>
<p>View State: e.g. is a panel open, a css transition pending, etc.</p>
</li>
<li>
<p>Application State: e.g. is a payment pending, current URL, user info, etc.</p>
</li>
<li>
<p>Business Data: e.g. products loaded from back-end</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is good practice to base the component decomposition on the state handled by a component and to define a simplified state model beforehand.
Starting with the parent - the <em>Smart Component</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What overall state does the dialog have: e.g. loading, error, valid data loaded, valid input, invalid input, etc.
Every defined value should correspond to an overall appearance of the whole dialog.</p>
</li>
<li>
<p>What events can occur to the dialog: e.g. submitting a form, changing a filter, pressing buttons, pressing keys, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For every <em>Dumb Component</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What data does a component display: e.g. a header text, user information to be displayed, a loading flag, etc.<br>
This will be a slice of the overall state of the parent <em>Smart Component</em>.
In general a <em>Dumb Component</em> presents a slice of its parent <em>Smart Components</em> state to the user.</p>
</li>
<li>
<p>What events can occur: keyboard events, mouse events, etc.<br>
These events are all handled by its parent <em>Smart Component</em> - every event is passed up the tree to be handled by a <em>Smart Component</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These information should be reflected inside the modeled state.
The implementation is a TypeScript type - an interface or a class describing the model.</p>
</div>
<div class="paragraph">
<p>So there should be a type describing all state relevant for a <em>Smart Component</em>.
An instance of that type is send down the component tree at runtime.
Not every <em>Dumb Component</em> will need the whole state.
For instance a single <em>Dumb Component</em> could only need a single string.</p>
</div>
<div class="paragraph">
<p>The state model for the previous <code>Listpicker</code> example is shown in the following listing.</p>
</div>
<div class="listingblock">
<div class="title">Listing 62. <code>Listpicker</code> state model</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export class ListpickerState {

  items: {}[]|undefined;
  columns = ['key', 'value'];
  keyColumn = 'key';
  displayValueColumn = 'value';
  filteredItems: {}[]|undefined;
  filter = '';
  placeholder = '';
  caseSensitive = true;
  isDisabled = false;
  isDropdownOpen = false;
  selectedItem: {}|undefined;
  displayValue = '';

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Listpicker</code> holds an instance of <code>ListpickerState</code> which is passed down the component tree via <code>@Input()</code> bindings in the <em>Dumb Components</em>.
Events emitted by children - <em>Dumb Components</em> - create a new instance of <code>ListpickerState</code> based on the current instance and the event and its data.
So a state transition is just setting a new instance of <code>ListpickerState</code>.
Angular Bindings propagate the value down the tree after exchanging the state.</p>
</div>
<div class="listingblock">
<div class="title">Listing 63. <code>Listpicker</code> State transition</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export class ListpickerComponent {

  // initial default values are set
  state = new ListpickerState();

  /** User changes filter */
  onFilterChange(filter: string): void {
    // apply filter ...
    const filteredList = this.filterService.filter(...);

    // important: A new instance is created, instead of altering the existing one.
    //            This makes change detection easier and prevents hard to find bugs.
    this.state = Object.assing({}, this.state, {
      filteredItems: filteredList,
      filter: filter
    });
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Note:</div>
<p>It is not always necessary to define the model as independent type.
So there would be no state property and just properties for every state defined directly in the component class.
When complexity grows and state becomes larger this is usually a good idea.
If the state should be shared between <em>Smart Components</em> a store is to be used.</p>
</div>
</div>
<div class="sect3">
<h4 id="when-are-dumb-components-needed"><a class="anchor" href="#when-are-dumb-components-needed"></a>7.102. When are Dumb Components needed</h4>
<div class="paragraph">
<p>Sometimes it is not necessary to perform a full decomposition. The architecture does not enforce it generally. What you should keep in mind is, that there is always a point when it becomes recommendable.</p>
</div>
<div class="paragraph">
<p>For example a template with 800 line of code is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>not understandable</p>
</li>
<li>
<p>not maintainable</p>
</li>
<li>
<p>not testable</p>
</li>
<li>
<p>not reusable</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So when implementing a template with more than 50 line of code you should think about decomposition.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="consuming-rest-services"><a class="anchor" href="#consuming-rest-services"></a>7.103. Consuming REST services</h4>
<div class="paragraph">
<p>A good introduction to working with <code>Angular HttpClient</code> can be found in <a href="https://angular.io/guide/http">Angular Docs</a></p>
</div>
<div class="paragraph">
<p>This guide will cover, how to embed <code>Angular HttpClient</code> in the application architecture.
For back-end request a special service with the suffix <code>Adapter</code> needs to be defined.</p>
</div>
</div>
<div class="sect3">
<h4 id="defining-adapters"><a class="anchor" href="#defining-adapters"></a>7.104. Defining Adapters</h4>
<div class="paragraph">
<p>It is a good practice to have a Angular service whose single responsibility is to call the back-end and parse the received value to a transfer data model (e.g. Swagger generated TOs).
Those services need to have the suffix <code>Adapter</code> to make them easy to recognize.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/rest-adapter.svg"><img src="_images/images/rest-adapter.svg" alt="Adapters handle back-end communication" width="450"></a>
</div>
<div class="title">Figure 45. Adapters handle back-end communication</div>
</div>
<div class="paragraph">
<p>As illustrated in the figure a Use Case service does not use <code>Angular HttpClient</code> directly but uses an adapter.
A basic adapter could look like this:</p>
</div>
<div class="listingblock">
<div class="title">Listing 64. Example adapter</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs/Observable';

import { FlightTo } from './flight-to';

@Injectable({
 providedIn: 'root',
})
export class FlightsAdapter {

  constructor(
    private httpClient: HttpClient
  ) {}

  getFlights(): Observable&lt;FlightTo&gt; {
    return this.httpClient.get&lt;FlightTo&gt;('/relative/url/to/flights');
  }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The adapters should use a well-defined transfer data model.
This could be generated from server endpoints with CobiGen, Swagger, typescript-maven-plugin, etc.
If inside the application there is a business model defined, the adapter has to parse to the transfer model.
This is illustrated in the following listing.</p>
</div>
<div class="listingblock">
<div class="title">Listing 65. Example adapter mapping from business model to transfer model</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs/Observable';
import { map } from 'rxjs/operators';

import { FlightTo } from './flight-to';
import { Flight } from '../../../model/flight';

@Injectable({
 providedIn: 'root',
})
export class FlightsAdapter {

  constructor(
    private httpClient: HttpClient
  ) {}

  updateFlight(flight: Flight): Observable&lt;Flight&gt; {
    const to = this.mapFlight(flight);

    return this.httpClient.post&lt;FlightTo&gt;('/relative/url/to/flights', to).pipe(
      map(to =&gt; this.mapFlightTo(to))
    );
  }

  private mapFlight(flight: Flight): FlightTo {
    // mapping logic
  }

  private mapFlightTo(flightTo: FlightTo): Flight {
    // mapping logic
  }

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="token-management"><a class="anchor" href="#token-management"></a>7.105. Token management</h4>
<div class="paragraph">
<p>In most cases the access to back-end API is secured using well known mechanisms as <strong>CSRF</strong>, <strong>JWT</strong> or both. In these cases the front-end application must manage the tokens that are generated when the user authenticates. More concretely it must store them to include them in every request automatically. Obviously, when user logs out these tokens must be removed from <code>localStorage</code>, memory, etc.</p>
</div>
</div>
<div class="sect3">
<h4 id="store-security-token"><a class="anchor" href="#store-security-token"></a>7.106. Store security token</h4>
<div class="paragraph">
<p>In order to make this guide simple we are going to store the token in memory. Therefore, if we consider that we already have a login mechanism implemented we would like to store the token using a <code>auth.service.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { Injectable } from '@angular/core';
import { Router } from '@angular/router';

@Injectable({
  providedIn: 'root',
})
export class AuthService {
  private loggedIn = false;
  private token: string;

  constructor(public router: Router) {}

  public isLogged(): boolean {
    return this.loggedIn || false;
  }

  public setLogged(login: boolean): void {
    this.loggedIn = login;
  }

  public getToken(): string {
    return this.token;
  }

  public setToken(token: string): void {
    this.token = token;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the previous service we will be able to store the token obtained in the login request using the method <code>setToken(token)</code>. Please consider that, if you want a more sophisticated approach using <code>localStorage</code> API, you will need to modify this service accordingly.</p>
</div>
</div>
<div class="sect3">
<h4 id="include-token-in-every-request"><a class="anchor" href="#include-token-in-every-request"></a>7.107. Include token in every request</h4>
<div class="paragraph">
<p>Now that the token is available in the application it is necessary to include it in every request to a protected API endpoint. Instead of modifying all the HTTP requests in our application, Angular provides a class to intercept every request (and every response if we need to) called <code>HttpInterceptor</code>. Let&#8217;s create a service called <code>http-interceptor.service.ts</code> to implement the <code>intercept</code> method of this class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {
  HttpEvent,
  HttpHandler,
  HttpInterceptor,
  HttpRequest,
} from '@angular/common/http';
import { Injectable } from '@angular/core';
import { Observable } from 'rxjs';
import { environment } from '../../../environments/environment';
import { AuthService } from './auth.service';

@Injectable()
export class HttpRequestInterceptorService implements HttpInterceptor {

  constructor(private auth: AuthService) {}

  intercept(
    req: HttpRequest&lt;any&gt;,
    next: HttpHandler,
  ): Observable&lt;HttpEvent&lt;any&gt;&gt; {
    // Get the auth header from the service.
    const authHeader: string = this.auth.getToken();
    if (authHeader) {
      let authReq: HttpRequest&lt;any&gt;;

      // CSRF
      if (environment.security == 'csrf') {
        authReq = req.clone({
          withCredentials: true,
          setHeaders: { 'x-csrf-token': authHeader },
        });
      }

      // JWT
      if (environment.security == 'jwt') {
        authReq = req.clone({
          setHeaders: { Authorization: authHeader },
        });
      }

      return next.handle(authReq);
    } else {
      return next.handle(req);
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you may notice, this service is making use of an environment field <code>environment.security</code> to determine if we are using JWT or CSRF in order to inject the token accordingly. In your application you can combine both if necessary.</p>
</div>
<div class="paragraph">
<p>Configure environment.ts file to use the CSRF/JWT.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>security: 'csrf'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>authHeader</code> used is obtained using the injected service <code>AuthService</code> already presented above.</p>
</div>
<div class="paragraph">
<p>In order to activate the interceptor we need to provide it in our <code>app.module.ts</code> or <code>core.module.ts</code> depending on the application structure. Let&#8217;s assume that we are using the latter and the interceptor file is inside a <code>security</code> folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">...
import { HttpRequestInterceptorService } from './security/http-request-interceptor.service';
...

@NgModule({
  imports: [...],
  exports: [...],
  declarations: [],
  providers: [
    ...
    {
      provide: HTTP_INTERCEPTORS,
      useClass: HttpRequestInterceptorService,
      multi: true,
    },
  ],
})
export class CoreModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Angular automatically will now modify every request and include in the header the token if it is convenient.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="error-handler-in-angular"><a class="anchor" href="#error-handler-in-angular"></a>7.108. Error Handler in angular</h4>
<div class="paragraph">
<p>Angular allows us to set up a custom error handler that can be used to control the different errors and them in a correct way. Using a global error handler will avoid mistakes and provide a use friendly interface allowing us to indicate the user what problem is happening.</p>
</div>
</div>
<div class="sect3">
<h4 id="what-is-errorhandler"><a class="anchor" href="#what-is-errorhandler"></a>7.109. What is <code>ErrorHandler</code></h4>
<div class="paragraph">
<p><code>ErrorHandler</code> is the class that <code>Angular</code> uses by default to control the errors. This means that, even if the application doesn&#8217;t have a <code>ErrorHandler</code> it is going to use the one setup by default in <code>Angular</code>. This can be tested by trying to find a page not existing in any app, instantly <code>Angular</code> will print the error in the console.</p>
</div>
</div>
<div class="sect3">
<h4 id="creating-your-custom-errorhandler-step-by-step"><a class="anchor" href="#creating-your-custom-errorhandler-step-by-step"></a>7.110. Creating your custom <code>ErrorHandler</code> step by step</h4>
<div class="paragraph">
<p>In order to create a custom <code>ErrorHandler</code> three steps are going to be needed:</p>
</div>
</div>
<div class="sect3">
<h4 id="creating-the-custom-errorhandler-class"><a class="anchor" href="#creating-the-custom-errorhandler-class"></a>7.111. Creating the custom <code>ErrorHandler</code> class</h4>
<div class="paragraph">
<p>In this first step the custom <code>ErrorHandler</code> class is going to be created inside the folder <code>/app/core/errors/errors-handler.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { ErrorHandler, Injectable, Injector } from '@angular/core';
import { HttpErrorResponse } from '@angular/common/http';

@Injectable()
export class ErrorsHandler implements ErrorHandler {

    constructor(private injector: Injector) {}

    handleError(error: Error | HttpErrorResponse) {
      //  To do: Use injector to get the necessary services to redirect or
      // show a message to the user
      const classname  = error.constructor.name;
      switch ( classname )  {
        case 'HttpErrorResponse':
          console.error('HttpError:' + error.message);
          if (!navigator.onLine) {
            console.error('There's no internet connection');
            // To do: control here in internet what you wanna do if user has no internet
          } else {
            console.error('Server Error:' + error.message);
            // To do: control here if the server gave an error
          }
          break;
        default:
          console.error('Error:' + error.message);
          // To do: control here if the client/other things gave an error
      }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This class can be used to control the different type of errors. If wanted, the <code>classname</code> variable could be used to add more switch cases. This would allow control of more specific situations.</p>
</div>
</div>
<div class="sect3">
<h4 id="creating-a-errorinterceptor"><a class="anchor" href="#creating-a-errorinterceptor"></a>7.112. Creating a <code>ErrorInterceptor</code></h4>
<div class="paragraph">
<p>Inside the same folder created in the last step we are going to create the <code>ErrorInterceptor</code>(<code>errors-handler-interceptor.ts</code>). This <code>ErrorInterceptor</code> is going to retry any failed calls to the server to make sure it is not being found before showing the error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { HttpInterceptor, HttpRequest, HttpHandler, HttpEvent } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { Observable } from 'rxjs';
import { retry } from 'rxjs/operators';

@Injectable()
export class ErrorsHandlerInterceptor implements HttpInterceptor {

    constructor() {}
    intercept(req: HttpRequest&lt;any&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;any&gt;&gt; {
        return next.handle(req).pipe(
            retryWhen((errors: Observable&lt;any&gt;) =&gt; errors.pipe(
                delay(500),
                take(5),
                concatMap((error: any, retryIndex: number) =&gt; {
                    if (++retryIndex == 5) {
                        throw error;
                    }
                    return of(error);
                })
            ))
        );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This custom made interceptor is implementing the <code>HttpInterceptor</code> and inside the method <code>intercept</code> using the method <code>pipe</code>,<code>retryWhen</code>,<code>delay</code>,<code>take</code> and <code>concatMap</code> from <a href="https://rxjs-dev.firebaseapp.com/api">RxJs</a> it is going to do the next things if there is errors:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>With <code>delay(500)</code> do a delay to allow some time in between requests</p>
</li>
<li>
<p>With <code>take(5)</code> retry five times.</p>
</li>
<li>
<p>With <code>concatMap</code> if the index that <code>take()</code> gives is not 5 it returns the error, else, it throws the error.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="creating-a-error-module"><a class="anchor" href="#creating-a-error-module"></a>7.113. Creating a Error Module</h4>
<div class="paragraph">
<p>Finally, creating a module(<code>errors-handler.module.ts</code>) is necessary to include the <code>interceptor</code> and the custom error handler. In this case, the module is going to be created in the same folder as the last two:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { NgModule, ErrorHandler } from '@angular/core';
import { CommonModule } from '@angular/common';
import { ErrorsHandler } from './errors-handler';
import { HTTP_INTERCEPTORS } from '@angular/common/http';
import { ErrorsHandlerInterceptor } from './errors-handler-interceptor';

@NgModule({
  declarations: [], // Declare here component if you want to use routing to error component
  imports: [
    CommonModule
  ],
  providers: [
    {
      provide: ErrorHandler,
      useClass: ErrorsHandler,
    },
    {
      provide: HTTP_INTERCEPTORS,
      useClass: ErrorsHandlerInterceptor,
      multi: true,
    }
  ]
})
export class ErrorsHandlerModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This module simply is providing the services that are implemented by our custom classes and then telling angular to use our custom made classes instead of the default ones. After doing this, the module has to be included in the app module <code>app.module.ts</code> in order to be used.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">....
  imports: [
    ErrorsHandlerModule,
    ....</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="handling-errors"><a class="anchor" href="#handling-errors"></a>7.114. Handling Errors</h4>
<div class="paragraph">
<p>As a final step, handling these errors is necessary. There are different ways that can be used to control the errors, here are a few:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating a custom page and using with <code>Router</code> to redirect to a page showing an error.</p>
</li>
<li>
<p>Creating a service in the server side or <code>Backend</code> to create a log with the error and calling it with <code>HttpClient</code>.</p>
</li>
<li>
<p>Showing a custom made <code>SnackBar</code> with the error message.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="using-snackbarservice-and-ngzone"><a class="anchor" href="#using-snackbarservice-and-ngzone"></a>7.115. ==  Using <code>SnackBarService</code> and <code>NgZone</code></h4>
<div class="paragraph">
<p>If the <a href="https://material.angular.io/components/snack-bar/overview">SnackBar</a> is used directly, some errors can occur, this is due to <code>SnackBar</code> being out of the <code>Angular</code> zone. In order to use this service properly, <a href="https://angular.io/api/core/NgZone">NgZone</a> is necessary. The method <code>run()</code> from <code>NgZone</code> will allow the service to be inside the <code>Angular Zone</code>. An example on how to use it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { ErrorHandler, Injectable, Injector, NgZone } from '@angular/core';
import { HttpErrorResponse } from '@angular/common/http';
import { MatSnackBar } from '@angular/material';

@Injectable()
export class ErrorsHandler implements ErrorHandler {

    constructor(private injector: Injector, private zone: NgZone) {}

    handleError(error: Error | HttpErrorResponse) {
      // Use injector to get the necessary services to redirect or
      const snackBar: MatSnackBar = this.injector.get(MatSnackBar);
      const classname  = error.constructor.name;
      let message: string;
      switch ( classname )  {
        case 'HttpErrorResponse':
          message = !(navigator.onLine) ? 'There is no internet connection' : error.message;
          break;
        default:
          message = error.message;
      }
      this.zone.run(
        () =&gt; snackBar.open(message, 'danger', { duration : 4000})
      );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using <code>Injector</code> the <code>MatSnackBar</code> is obtained, then the correct message is obtained inside the switch. Finally, using <code>NgZone</code> and <code>run()</code>, we open the <code>SnackBar</code> passing the message, and the parameters wanted.</p>
</div>
<div class="paragraph">
<p>You can find a working example of this guide in <a href="https://github.com/devonfw-sample/devon4ts-samples/tree/master/apps/angular-error-handler">devon4ts-samples</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="file-structure"><a class="anchor" href="#file-structure"></a>7.116. File Structure</h4>

</div>
<div class="sect3">
<h4 id="top-level"><a class="anchor" href="#top-level"></a>7.117. Top-level</h4>
<div class="paragraph">
<p>The top-level file structure is defined by Angular CLI. You might put this "top-level file structure" into a sub-directory to facilitate your build, but this is not relevant for this guide. So the applications file structure relevant to this guide is the folder <code>/src/app</code> inside the part managed by Angular CLI.</p>
</div>
<div class="listingblock">
<div class="title">Listing 66. Top-level file structure shows feature modules</div>
<div class="content">
<pre class="highlightjs highlight"><code>    /src
    └── /app
        ├── /account-management
        ├── /billing
        ├── /booking
        ├── /core
        ├── /shared
        ├── /status
        |
        ├── app.module.ts
        ├── app.component.spec.ts
        ├── app.component.ts
        └── app.routing-module.ts</code></pre>
</div>
</div>
<div class="paragraph">
<p>Besides the definition of app module the <code>app</code> folder has feature modules on top-level.
The special modules <em>shared</em> and <em>core</em> are present as well.</p>
</div>
</div>
<div class="sect3">
<h4 id="feature-modules"><a class="anchor" href="#feature-modules"></a>7.118. Feature Modules</h4>
<div class="paragraph">
<p>A feature module contains the modules definition and two folders representing both layers.</p>
</div>
<div class="listingblock">
<div class="title">Listing 67. Feature module file structure has both layers</div>
<div class="content">
<pre class="highlightjs highlight"><code>    /src
    └── /app
        └── /account-management
            ├── /components
            ├── /services
            |
            ├── account-management.module.ts
            ├── account-management.component.spec.ts
            ├── account-management.component.ts
            └── account-management.routing-module.ts</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally an entry component is possible. This would be the case in lazy loading scenarios.
So <code>account-management.component.ts</code> would be only present if <code>account-management</code> is lazy loaded.
Otherwise, the module&#8217;s routes would be defined <em>Component-less</em>
(see <a href="http://vsavkin.tumblr.com/post/146722301646/angular-router-empty-paths-componentless-routes">vsavkin blog post</a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="components-layer-2"><a class="anchor" href="#components-layer-2"></a>7.119. Components Layer</h4>
<div class="paragraph">
<p>The component layer reflects the distinction between <em>Smart Components</em> and <em>Dumb Components</em>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 68. Components layer file structure shows Smart Components on top-level</div>
<div class="content">
<pre class="highlightjs highlight"><code>    /src
    └── /app
        └── /account-management
            └── /components
                ├── /account-overview
                ├── /confirm-modal
                ├── /create-account
                ├── /forgot-password
                └── /shared</code></pre>
</div>
</div>
<div class="paragraph">
<p>Every folder inside the <code>/components</code> folder represents a smart component. The only exception is <code>/shared</code>.
<code>/shared</code> contains <em>Dumb Components</em> shared across <em>Smart Components</em> inside the components layer.</p>
</div>
<div class="listingblock">
<div class="title">Listing 69. Smart components contain Dumb components</div>
<div class="content">
<pre class="highlightjs highlight"><code>    /src
    └── /app
        └── /account-management
            └── /components
                └── /account-overview
                    ├── /user-info-panel
                    |   ├── /address-tab
                    |   ├── /last-activities-tab
                    |   |
                    |   ├── user-info-panel.component.html
                    |   ├── user-info-panel.component.scss
                    |   ├── user-info-panel.component.spec.ts
                    |   └── user-info-panel.component.ts
                    |
                    ├── /user-header
                    ├── /user-toolbar
                    |
                    ├── account-overview.component.html
                    ├── account-overview.component.scss
                    ├── account-overview.component.spec.ts
                    └── account-overview.component.ts</code></pre>
</div>
</div>
<div class="paragraph">
<p>Inside the folder of a <em>Smart Component</em> the component is defined.
Besides that are folders containing the <em>Dumb Components</em> the <em>Smart Component</em> consists of.
This can be recursive - a <em>Dumb Component</em> can consist of other <em>Dumb Components</em>.
This is reflected by the file structure as well. This way the structure of a view becomes very readable.
As mentioned before, if a <em>Dumb Component</em> is used by multiple <em>Smart Components</em> inside the components layer
it is put inside the <code>/shared</code> folder inside the components layer.</p>
</div>
<div class="paragraph">
<p>With this way of thinking the <em>shared</em> module makes a lot of sense. If a <em>Dumb Component</em> is used by multiple <em>Smart Components</em>
from different feature modules, the <em>Dumb Component</em> is placed into the <em>shared</em> module.</p>
</div>
<div class="listingblock">
<div class="title">Listing 70. The shared module contains Dumb Components shared across Smart Components from different feature modules</div>
<div class="content">
<pre class="highlightjs highlight"><code>    /src
    └── /app
        └── /shared
            └── /user-panel
                |
                ├── user-panel.component.html
                ├── user-panel.component.scss
                ├── user-panel.component.spec.ts
                └── user-panel.component.ts</code></pre>
</div>
</div>
<div class="paragraph">
<p>The layer folder <code>/components</code> is not necessary inside the <em>shared</em> module.
The <em>shared</em> module only contains components!</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="internationalization"><a class="anchor" href="#internationalization"></a>7.120. Internationalization</h4>
<div class="paragraph">
<p>Nowadays, a common scenario in front-end applications is to have the ability to translate labels and locate numbers, dates, currency and so on when the user clicks over a language selector or similar. devon4ng and specifically Angular has a default mechanism in order to fill the gap of such features, and besides there are some wide used libraries that make even easier to translate applications.</p>
</div>
<div class="paragraph">
<p>More info at <a href="https://angular.io/guide/i18n">Angular i18n official documentation</a></p>
</div>
</div>
<div class="sect3">
<h4 id="devon4ng-i18n-approach"><a class="anchor" href="#devon4ng-i18n-approach"></a>7.121. devon4ng i18n approach</h4>
<div class="paragraph">
<p>The official approach could be a bit complicated, therefore the recommended one is to use the recommended library <strong>Transloco</strong> from <a href="https://github.com/ngneat/transloco/" class="bare">https://github.com/ngneat/transloco/</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="install-and-configure-transloco"><a class="anchor" href="#install-and-configure-transloco"></a>7.122. Install and configure Transloco</h4>
<div class="paragraph">
<p>In order to include this library in your devon4ng <strong>Angular &gt;= 7.2</strong> project you will need to execute in a terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ng add @ngneat/transloco</code></pre>
</div>
</div>
<div class="paragraph">
<p>As part of the installation process you&#8217;ll be presented with questions; Once you answer them, everything you need will automatically be created for you.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First, Transloco creates boilerplate files for the requested translations.</p>
</li>
<li>
<p>Next, it will create a new file, <code>transloco-root.module.ts</code> which exposes an Angular&#8217;s <code>module</code> with a default configuration, and inject it into the <code>AppModule</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { HttpClient } from '@angular/common/http';
import {
  TRANSLOCO_LOADER,
  Translation,
  TranslocoLoader,
  TRANSLOCO_CONFIG,
  translocoConfig,
  TranslocoModule
} from '@ngneat/transloco';
import { Injectable, NgModule } from '@angular/core';
import { environment } from '../environments/environment';

@Injectable({ providedIn: 'root' })
export class TranslocoHttpLoader implements TranslocoLoader {
  constructor(private http: HttpClient) {}

  getTranslation(lang: string) {
    return this.http.get&lt;Translation&gt;(`/assets/i18n/${lang}.json`);
  }
}

@NgModule({
  exports: [ TranslocoModule ],
  providers: [
    {
      provide: TRANSLOCO_CONFIG,
      useValue: translocoConfig({
        availableLangs: ['en', 'es'],
        defaultLang: 'en',
        // Remove this option if your application doesn't support changing language in runtime.
        reRenderOnLangChange: true,
        prodMode: environment.production,
      })
    },
    { provide: TRANSLOCO_LOADER, useClass: TranslocoHttpLoader }
  ]
})
export class TranslocoRootModule {}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As you might have noticed it also set an <code>HttpLoader</code> into the module&#8217;s providers. The <code>HttpLoader</code> is a class that implements the <code>TranslocoLoader</code> interface. It&#8217;s responsible for instructing Transloco how to load the translation files. It uses Angular HTTP client to fetch the files, based on the given path.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="usage-5"><a class="anchor" href="#usage-5"></a>7.123. Usage</h4>
<div class="paragraph">
<p>In order to translate any label in any HTML template you will need to use the <code>transloco</code> pipe available:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">{{ 'HELLO' | transloco }}</code></pre>
</div>
</div>
<div class="paragraph">
<p>An <strong>optional</strong> parameter from the component TypeScript class could be included as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">{{ 'HELLO' | transloco: { value: dynamic } }}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is possible to use with <code>inputs</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;span [attr.alt]="'hello' | transloco"&gt;Attribute&lt;/span&gt;
&lt;span [title]="'hello' | transloco"&gt;Property&lt;/span&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to change the language used you will need to create a button or selector that calls the <code>this.translocoService.use(language: string)</code> method from <code>TranslocoService</code>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export class AppComponent {
  constructor(private translocoService: TranslocoService) {}

  changeLanguage(lang) {
      this.translocoService.setActiveLang(lang);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The translations will be included in the <code>en.json</code>, <code>es.json</code>, <code>de.json</code>, etc. files inside the <code>/assets/i18n</code> folder. For example <code>en.json</code> would be (using the previous parameter):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "HELLO": "hello"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or with an <strong>optional parameter</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "HELLO": "hello {{value}}"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Transloco understands nested JSON objects. This means that you can have a translation that looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "HOME": {
        "HELLO": "hello {{value}}"
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to access access the value, use the dot notation, in this case <code>HOME.HELLO</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="using-the-service-pipe-or-directive"><a class="anchor" href="#using-the-service-pipe-or-directive"></a>7.124. Using the service, pipe or directive</h4>

</div>
<div class="sect3">
<h4 id="structural-directive"><a class="anchor" href="#structural-directive"></a>7.125. ==  Structural Directive</h4>
<div class="paragraph">
<p>Using a structural directive is the <strong>recommended</strong> approach. It&#8217;s DRY and efficient, as it creates <strong>one</strong> subscription per template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">&lt;ng-container *transloco="let t"&gt;
  &lt;p&gt;{{ t('title') }}&lt;/p&gt;

  &lt;comp [title]="t('title')"&gt;&lt;/comp&gt;
&lt;/ng-container&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the <code>t</code> function is <strong>memoized</strong>. It means that given the same <code>key</code> it will return the result directly from the cache.</p>
</div>
<div class="paragraph">
<p>We can pass a <code>params</code> object as the second parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">&lt;ng-container *transloco="let t"&gt;
  &lt;p&gt;{{ t('name', { name: 'Transloco' }) }}&lt;/p&gt;
&lt;/ng-container&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can instruct the directive to use a different language in our template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">&lt;ng-container *transloco="let t; lang: 'es'"&gt;
  &lt;p&gt;{{ t('title') }}&lt;/p&gt;
&lt;/ng-container&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="pipe"><a class="anchor" href="#pipe"></a>7.126. ==  Pipe</h4>
<div class="paragraph">
<p>The use of pipes can be possible too:</p>
</div>
<div class="paragraph">
<p>template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">&lt;div&gt;{{ 'HELLO' | transloco:param }}&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">param = {value: 'world'};</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="attribute-directive"><a class="anchor" href="#attribute-directive"></a>7.127. ==  Attribute Directive</h4>
<div class="paragraph">
<p>The last option available with <code>transloco</code> is the attribute directive:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">&lt;div transloco="HELLO" [translocoParams]="{ value: 'world' }"&gt;&lt;/div&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="service"><a class="anchor" href="#service"></a>7.128. ==  Service</h4>
<div class="paragraph">
<p>If you need to access translations in any component or service you can do it injecting the <code>TranslocoService</code> into them:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// Sync translation
translocoService.translate('HELLO', {value: 'world'});

// Async translation
translocoService.selectTranslate('HELLO', { value: 'world' }).subscribe(res =&gt; {
    console.log(res);
    //=&gt; 'hello world'
});</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You can find a complete example at <a href="https://github.com/devonfw/devon4ng-application-template" class="bare">https://github.com/devonfw/devon4ng-application-template</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Please, visit <a href="https://github.com/ngneat/transloco/" class="bare">https://github.com/ngneat/transloco/</a> for more info.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="routing"><a class="anchor" href="#routing"></a>7.129. Routing</h4>
<div class="paragraph">
<p>A basic introduction to the Angular Router can be found in <a href="https://angular.io/guide/router">Angular Docs</a>.</p>
</div>
<div class="paragraph">
<p>This guide will show common tasks and best practices.</p>
</div>
</div>
<div class="sect3">
<h4 id="defining-routes"><a class="anchor" href="#defining-routes"></a>7.130. Defining Routes</h4>
<div class="paragraph">
<p>For each feature module and the app module all routes should be defined in a separate module with the suffix <code>RoutingModule</code>.
This way the routing modules are the only place where routes are defined.
This pattern achieves a clear separation of concerns.
The following figure illustrates this.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/module-declaration.svg"><img src="_images/images/module-declaration.svg" alt="Routing module declaration" width="450"></a>
</div>
<div class="title">Figure 46. Routing module declaration</div>
</div>
<div class="paragraph">
<p>It is important to define routes inside app routing module with <code>.forRoot()</code> and in feature routing modules with <code>.forChild()</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-1-no-lazy-loading"><a class="anchor" href="#example-1-no-lazy-loading"></a>7.131. Example 1 - No Lazy Loading</h4>
<div class="paragraph">
<p>In this example two modules need to be configured with routes - <code>AppModule</code> and <code>FlightModule</code>.</p>
</div>
<div class="paragraph">
<p>The following routes will be configured</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/</code> will redirect to <code>/search</code></p>
</li>
<li>
<p><code>/search</code> displays <code>FlightSearchComponent</code> (<code>FlightModule</code>)</p>
</li>
<li>
<p><code>/search/print/:flightId/:date</code> displays <code>FlightPrintComponent</code> (<code>FlightModule</code>)</p>
</li>
<li>
<p><code>/search/details/:flightId/:date</code> displays <code>FlightDetailsComponent</code> (<code>FlightModule</code>)</p>
</li>
<li>
<p>All other routes will display <code>ErrorPage404</code> (<code>AppModule</code>)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Listing 71. app-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  { path: '', redirectTo: 'search', pathMatch: 'full' },
  { path: '**', component: ErrorPage404 }
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule]
})
export class AppRoutingModule { }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 72. flight-search-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  {
    path: 'search', children: [
      { path: '', component: FlightSearchComponent },
      { path: 'print/:flightId/:date', component: FlightPrintComponent },
      { path: 'details/:flightId/:date', component: FlightDetailsComponent }
    ]
  }
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule],
})
export class FlightSearchRoutingModule { }</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The import order inside <code>AppModule</code> is important.
<code>AppRoutingModule</code> needs to be imported <strong>after</strong> <code>FlightModule</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="example-2-lazy-loading"><a class="anchor" href="#example-2-lazy-loading"></a>7.132. Example 2 - Lazy Loading</h4>
<div class="paragraph">
<p>Lazy Loading is a good practice when the application has multiple feature areas and a user might not visit every dialog.
Or at least he might not need every dialog up front.</p>
</div>
<div class="paragraph">
<p>The following example will configure the same routes as example 1 but will lazy load <code>FlightModule</code>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 73. app-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  { path: '/search', loadChildren: 'app/flight-search/flight-search.module#FlightSearchModule' },
  { path: '**', component: ErrorPage404 }
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule]
})
export class AppRoutingModule { }</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 74. flight-search-routing.module.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">const routes: Routes = [
  {
    path: '', children: [
      { path: '', component: FlightSearchComponent },
      { path: 'print/:flightId/:date', component: FlightPrintComponent },
      { path: 'details/:flightId/:date', component: FlightDetailsComponent }
    ]
  }
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule],
})
export class FlightSearchRoutingModule { }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="triggering-route-changes"><a class="anchor" href="#triggering-route-changes"></a>7.133. Triggering Route Changes</h4>
<div class="paragraph">
<p>With Angular you have two ways of triggering route changes.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Declarative with bindings in component HTML templates</p>
</li>
<li>
<p>Programmatic with Angular <code>Router</code> service inside component classes</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>On the one hand, architecture-wise it is a much cleaner solution to trigger route changes in <em>Smart Components</em>.
This way you have every UI event that should trigger a navigation handled in one place - in a <em>Smart Component</em>.
It becomes very easy to look inside the code for every navigation, that can occur.
Refactoring is also much easier, as there are no navigation events "hidden" in the HTML templates</p>
</div>
<div class="paragraph">
<p>On the other hand, in terms of accessibility and <code>SEO</code> it is a better solution to rely on bindings in the view - e.g. by using Angular router-link directive.
This way screen readers and the Google crawler can move through the page easily.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you do not have to support accessibility (screen readers, etc.) and to care about <code>SEO</code> (Google rank, etc.),
then you should aim for triggering navigation only in <em>Smart Components</em>.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/triggering-navigation.svg"><img src="_images/images/triggering-navigation.svg" alt="Triggering navigation" width="350" height="200"></a>
</div>
<div class="title">Figure 47. Triggering navigation</div>
</div>
</div>
<div class="sect3">
<h4 id="guards"><a class="anchor" href="#guards"></a>7.134. Guards</h4>
<div class="paragraph">
<p>Guards are Angular services implemented on routes which determines whether a user can navigate to/from the route. There are examples below which will explain things better. We have the following types of Guards:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>CanActivate</code></strong>: It is used to determine whether a user can visit a route. The most common scenario for this guard is to check if the user is authenticated. For example, if we want only logged in users to be able to go to a particular route, we will implement the <code>CanActivate</code> guard on this route.</p>
</li>
<li>
<p><code><strong>CanActivateChild</strong></code>: Same as above, only implemented on child routes.</p>
</li>
<li>
<p><strong><code>CanDeactivate</code></strong>: It is used to determine if a user can navigate away from a route. Most common example is when a user tries to go to a different page after filling up a form and does not save/submit the changes, we can use this guard to confirm whether the user really wants to leave the page without saving/submitting.</p>
</li>
<li>
<p><strong>Resolve</strong>: For resolving dynamic data.</p>
</li>
<li>
<p><strong><code>CanLoad</code></strong>: It is used to determine whether an <em>Angular module</em> can be loaded lazily. Example below will be helpful to understand it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s have a look at some examples.</p>
</div>
</div>
<div class="sect3">
<h4 id="example-1-canactivate-and-canactivatechild-guards"><a class="anchor" href="#example-1-canactivate-and-canactivatechild-guards"></a>7.135. Example 1 - <code>CanActivate</code> and <code>CanActivateChild</code> guards</h4>

</div>
<div class="sect3">
<h4 id="canactivate-guard"><a class="anchor" href="#canactivate-guard"></a>7.136. ==  <code>CanActivate</code> guard</h4>
<div class="paragraph">
<p>As mentioned earlier, a guard is an Angular service and services are simply <code>TypeScript</code> classes. So we begin by creating a class. This class has to implement the <code>CanActivate</code> interface (imported from <code>angular/router</code>), and therefore, must have a <code>canActivate</code> function. The logic of this function determines whether the requested route can be navigated to or not. It returns either a Boolean value or an <code>Observable</code> or a <code>Promise</code> which resolves to a Boolean value. If it is true, the route is loaded, else not.</p>
</div>
<div class="listingblock">
<div class="title">Listing 75. <code>CanActivate</code> example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import {CanActivate} from "@angular/router";

@Injectable()
class ExampleAuthGuard implements CanActivate {
  constructor(private authService: AuthService) {}

  canActivate(route: ActivatedRouterSnapshot, state: RouterStateSnapshot) {
	if (this.authService.isLoggedIn()) {
      return true;
    } else {
	  window.alert('Please log in first');
      return false;
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, let&#8217;s assume we have a <code>AuthService</code> which has a <code>isLoggedIn()</code> method which returns a Boolean value depending on whether the user is logged in. We use it to return <code>true</code> or <code>false</code> from the <code>canActivate</code> function.
The <code>canActivate</code> function accepts two parameters (provided by Angular). The first parameter of type <code>ActivatedRouterSnapshot</code> is the snapshot of the route the user is trying to navigate to (where the guard is implemented); we can extract the route parameters from this instance. The second parameter of type <code>RouterStateSnapshot</code> is a snapshot of the router state the user is trying to navigate to; we can fetch the <code>URL</code> from it&#8217;s <code>url</code> property.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We can also redirect the user to another page (maybe a login page) if the <code>authService</code> returns false. To do that, inject <code>Router</code> and use it&#8217;s <code>navigate</code> function to redirect to the appropriate page.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Since it is a service, it needs to be provided in our module:</p>
</div>
<div class="listingblock">
<div class="title">Listing 76. provide the guard in a module</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">@NgModule({
  ...
  providers: [
    ...
    ExampleAuthGuard
  ]
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now this guard is ready to use on our routes. We implement it where we define our array of routes in the application:</p>
</div>
<div class="listingblock">
<div class="title">Listing 77. Implementing the guard</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
const routes: Routes = [
  { path: '', redirectTo: 'home', pathMatch: 'full' },
  { path: 'home', component: HomeComponent },
  { path: 'page1', component: Page1Component, canActivate: [ExampleAuthGuard] }
];</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, the <code>canActivate</code> property accepts an array of guards. So we can implement more than one guard on a route.</p>
</div>
</div>
<div class="sect3">
<h4 id="canactivatechild-guard"><a class="anchor" href="#canactivatechild-guard"></a>7.137. ==  <code>CanActivateChild</code> guard</h4>
<div class="paragraph">
<p>To use the guard on nested (children) routes, we add it to the <code>canActivateChild</code> property like so:</p>
</div>
<div class="listingblock">
<div class="title">Listing 78. Implementing the guard on child routes</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
const routes: Routes = [
  { path: '', redirectTo: 'home', pathMatch: 'full' },
  { path: 'home', component: HomeComponent },
  { path: 'page1', component: Page1Component, canActivateChild: [ExampleAuthGuard], children: [
	{path: 'sub-page1', component: SubPageComponent},
    {path: 'sub-page2', component: SubPageComponent}
  ] }
];</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="example-2-canload-guard"><a class="anchor" href="#example-2-canload-guard"></a>7.138. Example 2 - <code>CanLoad</code> guard</h4>
<div class="paragraph">
<p>Similar to <code>CanActivate</code>, to use this guard we implement the <code>CanLoad</code> interface and overwrite it&#8217;s <code>canLoad</code> function. Again, this function returns either a Boolean value or an <code>Observable</code> or a <code>Promise</code> which resolves to a Boolean value. The fundamental difference between <code>CanActivate</code> and <code>CanLoad</code> is that <code>CanLoad</code> is used to determine whether an entire module can be lazily loaded or not. If the guard returns <code>false</code> for a module protected by <code>CanLoad</code>, the entire module is not loaded.</p>
</div>
<div class="listingblock">
<div class="title">Listing 79. <code>CanLoad</code> example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
import {CanLoad, Route} from "@angular/router";

@Injectable()
class ExampleCanLoadGuard implements CanLoad {
  constructor(private authService: AuthService) {}

  canLoad(route: Route) {
	if (this.authService.isLoggedIn()) {
      return true;
    } else {
	  window.alert('Please log in first');
      return false;
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, let&#8217;s assume we have a <code>AuthService</code> which has a <code>isLoggedIn()</code> method which returns a Boolean value depending on whether the user is logged in. The <code>canLoad</code> function accepts a parameter of type Route which we can use to fetch the path a user is trying to navigate to (using the <code>path</code> property of <code>Route</code>).</p>
</div>
<div class="paragraph">
<p>This guard needs to be provided in our module like any other service.</p>
</div>
<div class="paragraph">
<p>To implement the guard, we use the <code>canLoad</code> property:</p>
</div>
<div class="listingblock">
<div class="title">Listing 80. Implementing the guard</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">...
const routes: Routes = [
  { path: 'home', component: HomeComponent },
  { path: 'admin', loadChildren: 'app/admin/admin.module#AdminModule', canLoad: [ExampleCanLoadGuard] }
];</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="testing"><a class="anchor" href="#testing"></a>7.139. Testing</h4>
<div class="paragraph">
<p>This guide will cover the basics of testing logic inside your code with unit test cases.
The guide assumes that you are familiar with Angular CLI (<a href="guide-working-with-angular-cli">see the guide</a>)</p>
</div>
<div class="paragraph">
<p>For testing your Angular application with unit test cases there are two main strategies:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Isolated unit test cases<br>
Isolated unit tests examine an instance of a class all by itself without any dependence on Angular or any injected values.
The amount of code and effort needed to create such tests in minimal.</p>
</li>
<li>
<p>Angular Testing Utilities<br>
Let you test components including their interaction with Angular.
The amount of code and effort needed to create such tests is a little higher.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="testing-concept"><a class="anchor" href="#testing-concept"></a>7.140. Testing Concept</h4>
<div class="paragraph">
<p>The following figure shows you an overview of the application architecture divided in testing areas.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/testing-areas.svg"><img src="_images/images/testing-areas.svg" alt="Testing Areas" width="450"></a>
</div>
<div class="title">Figure 48. Testing Areas</div>
</div>
<div class="paragraph">
<p>There are three areas, which need to be covered by different testing strategies.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Components:<br>
Smart Components need to be tested because they contain view logic.
Also the interaction with 3rd party components needs to be tested.
When a 3rd party component changes with an upgrade a test will be failing and warn you, that there is something wrong with the new version.
Most of the time Dumb Components do not need to be tested because they mainly display data and do not contain any logic.
Smart Components are always tested with <strong>Angular Testing Utilities</strong>.
For example selectors, which select data from the store and transform it further, need to be tested.</p>
</li>
<li>
<p>Stores:<br>
A store contains methods representing state transitions.
If these methods contain logic, they need to be tested.
Stores are always tested using <strong>Isolated unit tests</strong>.</p>
</li>
<li>
<p>Services:<br>
Services contain Business Logic, which needs to be tested.
UseCase Services represent a whole business use case.
For instance this could be initializing a store with all the data that is needed for a dialog - loading, transforming, storing.
Often <strong>Angular Testing Utilities</strong> are the optimal solution for testing UseCase Services, because they allow for an easy stubbing of the back-end.
All other services should be tested with <strong>Isolated unit tests</strong> as they are much easier to write and maintain.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="testing-smart-components"><a class="anchor" href="#testing-smart-components"></a>7.141. Testing Smart Components</h4>
<div class="paragraph">
<p>Testing Smart Components should assure the following.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Bindings are correct.</p>
</li>
<li>
<p>Selectors which load data from the store are correct.</p>
</li>
<li>
<p>Asynchronous behavior is correct (loading state, error state, "normal" state).</p>
</li>
<li>
<p>Oftentimes through testing one realizes, that important edge cases are forgotten.</p>
</li>
<li>
<p>Do these test become very complex, it is often an indicator for poor code quality in the component.
Then the implementation is to be adjusted / refactored.</p>
</li>
<li>
<p>When testing values received from the native DOM, you will test also that 3rd party libraries did not change with a version upgrade.
A failing test will show you what part of a 3rd party library has changed.
This is much better than the users doing this for you.
For example a binding might fail because the property name was changed with a newer version of a 3rd party library.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the function <code>beforeEach()</code> the TestBed imported from <strong>Angular Testing Utilities</strong> needs to be initialized.
The goal should be to define a minimal test-module with TestBed.
The following code gives you an example.</p>
</div>
<div class="listingblock">
<div class="title">Listing 81. Example test setup for Smart Components</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">describe('PrintFlightComponent', () =&gt; {

  let fixture: ComponentFixture&lt;PrintCPrintFlightComponentomponent&gt;;
  let store: FlightStore;
  let printServiceSpy: jasmine.SpyObj&lt;FlightPrintService&gt;;

  beforeEach(() =&gt; {
    const urlParam = '1337';
    const activatedRouteStub = { params: of({ id: urlParam }) };
    printServiceSpy = jasmine.createSpyObj('FlightPrintService', ['initializePrintDialog']);
    TestBed.configureTestingModule({
      imports: [
        TranslateModule.forRoot(),
        RouterTestingModule
      ],
      declarations: [
        PrintFlightComponent,
        PrintContentComponent,
        GeneralInformationPrintPanelComponent,
        PassengersPrintPanelComponent
      ],
      providers: [
        FlightStore,
        {provide: FlightPrintService, useValue: printServiceSpy},
        {provide: ActivatedRoute, useValue: activatedRouteStub}
      ]
    });
    fixture = TestBed.createComponent(PrintFlightComponent);
    store = fixture.debugElement.injector.get(FlightStore);
    fixture.detectChanges();
  });

  // ... test cases
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is important:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use <code>RouterTestingModule</code> instead of <code>RouterModule</code></p>
</li>
<li>
<p>Use <code>TranslateModule.forRoot()</code> without translations
This way you can test language-neutral without translation marks.</p>
</li>
<li>
<p>Do not add a whole module from your application - in declarations add the tested Smart Component with all its Dumb Components</p>
</li>
<li>
<p>The store should never be stubbed.
If you need a complex test setup, just use the regular methods defined on the store.</p>
</li>
<li>
<p>Stub all services used by the Smart Component.
These are mostly UseCase services.
They should not be tested by these tests.
Only the correct call to their functions should be assured.
The logic inside the UseCase services is tested with separate tests.</p>
</li>
<li>
<p><code>detectChanges()</code> performance an Angular Change Detection cycle (Angular refreshes all the bindings present in the view)</p>
</li>
<li>
<p><code>tick()</code> performance a virtual macro task, <code>tick(1000)</code> is equal to the virtual passing of 1s.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following test cases show the testing strategy in action.</p>
</div>
<div class="listingblock">
<div class="title">Listing 82. Example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">it('calls initializePrintDialog for url parameter 1337', fakeAsync(() =&gt; {
  expect(printServiceSpy.initializePrintDialog).toHaveBeenCalledWith(1337);
}));

it('creates correct loading subtitle', fakeAsync(() =&gt; {
  store.setPrintStateLoading(123);
  tick();
  fixture.detectChanges();

  const subtitle = fixture.debugElement.query(By.css('app-header-element .print-header-container span:last-child'));
  expect(subtitle.nativeElement.textContent).toBe('PRINT_HEADER.FLIGHT STATE.IS_LOADING');
}));

it('creates correct subtitle for loaded flight', fakeAsync(() =&gt; {
  store.setPrintStateLoadedSuccess({
    id: 123,
    description: 'Description',
    iata: 'FRA',
    name: 'Frankfurt',
    // ...
  });
  tick();
  fixture.detectChanges();

  const subtitle = fixture.debugElement.query(By.css('app-header-element .print-header-container span:last-child'));
  expect(subtitle.nativeElement.textContent).toBe('PRINT_HEADER.FLIGHT "FRA (Frankfurt)" (ID: 123)');
}));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The examples show the basic testing method</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the store to a well-defined state</p>
</li>
<li>
<p>check if the component displays the correct values</p>
</li>
<li>
<p>&#8230;&#8203; via checking values inside the native DOM.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="testing-state-transitions-performed-by-stores"><a class="anchor" href="#testing-state-transitions-performed-by-stores"></a>7.142. Testing state transitions performed by stores</h4>
<div class="paragraph">
<p>Stores are always tested with <strong>Isolated unit tests</strong>.</p>
</div>
<div class="paragraph">
<p>Actions triggered by <code>dispatchAction()</code> calls are asynchronously performed to alter the state.
A good solution to test such a state transition is to use the done callback from Jasmine.</p>
</div>
<div class="listingblock">
<div class="title">Listing 83. Example for testing a store</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">let sut: FlightStore;

beforeEach(() =&gt; {
  sut = new FlightStore();
});

it('setPrintStateLoading sets print state to loading', (done: Function) =&gt; {
  sut.setPrintStateLoading(4711);

  sut.state$.pipe(first()).subscribe(result =&gt; {
    expect(result.print.isLoading).toBe(true);
    expect(result.print.loadingId).toBe(4711);
    done();
  });
});

it('toggleRowChecked adds flight with given id to selectedValues Property', (done: Function) =&gt; {
  const flight: FlightTO = {
    id: 12
    // dummy data
  };
  sut.setRegisterabgleichListe([flight]);
  sut.toggleRowChecked(12);

  sut.state$.pipe(first()).subscribe(result =&gt; {
    expect(result.selectedValues).toContain(flight);
    done();
  });
});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="testing-services"><a class="anchor" href="#testing-services"></a>7.143. Testing services</h4>
<div class="paragraph">
<p>When testing services both strategies - <strong>Isolated unit tests</strong> and <strong>Angular Testing Utilities</strong> - are valid options.</p>
</div>
<div class="paragraph">
<p>The goal of such tests are</p>
</div>
<div class="ulist">
<ul>
<li>
<p>assuring the behavior for valid data.</p>
</li>
<li>
<p>assuring the behavior for invalid data.</p>
</li>
<li>
<p>documenting functionality</p>
</li>
<li>
<p>save performing refactoring</p>
</li>
<li>
<p>thinking about edge case behavior while testing</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For simple services <strong>Isolated unit tests</strong> can be written.
Writing these tests takes lesser effort and they can be written very fast.</p>
</div>
<div class="paragraph">
<p>The following listing gives an example of such tests.</p>
</div>
<div class="listingblock">
<div class="title">Listing 84. Testing a simple services with <strong>Isolated unit tests</strong></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">let sut: IsyDatePipe;

beforeEach(() =&gt; {
  sut = new IsyDatePipe();
});

it('transform should return empty string if input value is empty', () =&gt; {
  expect(sut.transform('')).toBe('');
});

it('transform should return empty string if input value is null', () =&gt; {
  expect(sut.transform(undefined)).toBe('');
});

// ...more tests</code></pre>
</div>
</div>
<div class="paragraph">
<p>For testing Use Case services the Angular Testing Utilities should be used.
The following listing gives an example.</p>
</div>
<div class="listingblock">
<div class="title">Listing 85. Test setup for testing use case services with Angular Testing Utilities</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">let sut: FlightPrintService;
let store: FlightStore;
let httpController: HttpTestingController;
let flightCalculationServiceStub: jasmine.SpyObj&lt;FlightCalculationService&gt;;
const flight: FlightTo = {
  // ... valid dummy data
};

beforeEach(() =&gt; {
  flightCalculationServiceStub = jasmine.createSpyObj('FlightCalculationService', ['getFlightType']);
  flightCalculationServiceStub.getFlightType.and.callFake((catalog: string, type: string, key: string) =&gt; of(`${key}_long`));
  TestBed.configureTestingModule({
    imports: [
      HttpClientTestingModule,
      RouterTestingModule,
    ],
    providers: [
      FlightPrintService,
      FlightStore,
      FlightAdapter,
      {provide: FlightCalculationService, useValue: flightCalculationServiceStub}
    ]
  });

  sut = TestBed.get(FlightPrintService);
  store = TestBed.get(FlightStore);
  httpController = TestBed.get(HttpTestingController);
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using TestBed, it is important</p>
</div>
<div class="ulist">
<ul>
<li>
<p>to import <code>HttpClientTestingModule</code> for stubbing the back-end</p>
</li>
<li>
<p>to import <code>RouterTestingModule</code> for stubbing the Angular router</p>
</li>
<li>
<p>not to stub stores, adapters and business services</p>
</li>
<li>
<p>to stub services from libraries like <code>FlightCalculationService</code> - the correct implementation of libraries should not be tested by these tests.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Testing back-end communication looks like this:</p>
</div>
<div class="listingblock">
<div class="title">Listing 86. Testing back-end communication with <code>Angular HttpTestingController</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">it('loads flight if not present in store', fakeAsync(() =&gt; {
  sut.initializePrintDialog(1337);
  const processRequest = httpController.expectOne('/path/to/flight');
  processRequest.flush(flight);

  httpController.verify();
}));

it('does not load flight if present in store', fakeAsync(() =&gt; {
  const flight = {...flight, id: 4711};
  store.setRegisterabgleich(flight);

  sut.initializePrintDialog(4711);
  httpController.expectNone('/path/to/flight');

  httpController.verify();
}));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first test assures a correct XHR request is performed if <code>initializePrintDialog()</code> is called and no data is in the store.
The second test assures no XHR request IST performed if the needed data is already in the store.</p>
</div>
<div class="paragraph">
<p>The next steps are checks for the correct implementation of logic.</p>
</div>
<div class="listingblock">
<div class="title">Listing 87. Example testing a Use Case service</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">it('creates flight destination for valid key in svz', fakeAsync(() =&gt; {
  const flightTo: FlightTo = {
    ...flight,
    id: 4712,
    profile: '77'
  };
  store.setFlight(flightTo);
  let result: FlightPrintContent|undefined;

  sut.initializePrintDialog(4712);
  store.select(s =&gt; s.print.content).subscribe(content =&gt; result = content);
  tick();

  expect(result!.destination).toBe('77_long (ID: 77)');
}));</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="update-angular-cli"><a class="anchor" href="#update-angular-cli"></a>7.144. Update Angular CLI</h4>

</div>
<div class="sect3">
<h4 id="angular-cli-common-issues"><a class="anchor" href="#angular-cli-common-issues"></a>7.145. Angular CLI common issues</h4>
<div class="paragraph">
<p>There are constant updates for the official Angular framework dependencies. These dependencies are directly related with the Angular CLI package. Since this package comes installed by default inside the devonfw distribution folder for Windows OS and the distribution is updated every few months it needs to be updated in order to avoid known issues.</p>
</div>
</div>
<div class="sect3">
<h4 id="angular-cli-update-guide"><a class="anchor" href="#angular-cli-update-guide"></a>7.146. Angular CLI update guide</h4>
<div class="paragraph">
<p>For <strong>Linux users</strong> is as easy as updating the global package:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm unistall -g @angular/cli
$ npm install -g @angular/cli</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <strong>Windows users</strong> the process is only a bit harder. Open the <strong>devonfw bundled console</strong> and do as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ cd [devonfw_dist_folder]
$ cd software/nodejs
$ npm uninstall @angular/cli --no-save
$ npm install @angular/cli --no-save</code></pre>
</div>
</div>
<div class="paragraph">
<p>After following these steps you should have the latest Angular CLI version installed in your system. In order to check it run in the distribution console:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
At the time of this writing, the Angular CLI is at 1.7.4 version.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">λ ng version

     _                      _                 ____ _     ___
    / \   _ __   __ _ _   _| | __ _ _ __     / ___| |   |_ _|
   / △ \ | '_ \ / _` | | | | |/ _` | '__|   | |   | |    | |
  / ___ \| | | | (_| | |_| | | (_| | |      | |___| |___ | |
 /_/   \_\_| |_|\__, |\__,_|_|\__,_|_|       \____|_____|___|
                |___/


Angular CLI: 7.2.3
Node: 10.13.0
OS: win32 x64
Angular:
...</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="upgrade-devon4ng-angular-and-ionicangular-applications"><a class="anchor" href="#upgrade-devon4ng-angular-and-ionicangular-applications"></a>7.147. Upgrade devon4ng Angular and Ionic/Angular applications</h4>
<div class="paragraph">
<p>Angular CLI provides a powerful tool to upgrade Angular based applications to the current stable release of the core framework.</p>
</div>
<div class="paragraph">
<p>This tool is <code>ng update</code>. It will not only upgrade dependencies and their related ones but also will perform some fixes in your code if available thanks to the provided <em>schematics</em>. It will check even if the update is not possible as there is another library or libraries that are not compatible with the versions of the upgraded dependencies. In this case it will keep your application untouched.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The repository must be in a clean state before executing a <code>ng update</code>. So, remember to commit your changes first.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="basic-usage"><a class="anchor" href="#basic-usage"></a>7.148. Basic usage</h4>
<div class="paragraph">
<p>In order to perform a basic upgrade we will execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ng update @angular/cli @angular/core</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="upgrade-to-new-angular-version"><a class="anchor" href="#upgrade-to-new-angular-version"></a>7.149. Upgrade to new Angular version</h4>
<div class="paragraph">
<p>The process will be the same, but first we need to make sure that our devon4ng application is in the lates version of Angular 8, so the <code>ng update</code> command can perform the upgrade not only in the dependencies but also making code changes to reflect the new features and fixes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First, upgrade to latest Angular 9 version:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ng update @angular/cli@9 @angular/core@9</code></pre>
</div>
</div>
<div class="paragraph">
<p>Optionally the flag <code>-C</code> can be added to previous command to make a commit automatically. This is also valid for the next steps.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Then, upgrade Angular:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ng update @angular/cli @angular/core</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>In case you use Angular Material:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ng update @angular/material</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>If the application depends on third party libraries, the new tool <code>ngcc</code> can be run to make them compatible with the new <strong>Ivy compiler</strong>. In this case it is recommended to include a <code>postinstall</code> script in the <code>package.json</code>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "scripts": {
    "postinstall": "ngcc --properties es2015 browser module main --first-only --create-ivy-entry-points"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>More information at <a href="https://angular.io/guide/updating-to-version-9" class="bare">https://angular.io/guide/updating-to-version-9</a> and <a href="https://angular.io/guide/ivy" class="bare">https://angular.io/guide/ivy</a>.</p>
</div>
<div class="paragraph">
<p><strong>Important use cases:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>To update to the next beta or pre-release version, use the <code>--next=true</code> option.</p>
</li>
<li>
<p>To update from one major version to another, use the format <code>ng update @angular/cli@^&lt;major_version&gt; @angular/core@^&lt;major_version&gt;</code>.</p>
</li>
<li>
<p>In case your Angular application uses <code>@angular/material</code> include it in the first command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ng update @angular/cli @angular/core @angular/material</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="ionicangular-applications"><a class="anchor" href="#ionicangular-applications"></a>7.150. Ionic/Angular applications</h4>
<div class="paragraph">
<p>Just following the same procedure we can upgrade Angular applications, but we must take care of important specific Ionic dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ng update @angular/cli @angular/core @ionic/angular @ionic/angular-toolkit [@ionic/...]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="other-dependencies"><a class="anchor" href="#other-dependencies"></a>7.151. Other dependencies</h4>
<div class="paragraph">
<p>Every application will make use of different dependencies. Angular CLI <code>ng upgrade</code> will also take care of these ones. For example, if you need to upgrade <code>@capacitor</code> you will perform:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ng update @capacitor/cli @capacitor/core [@capacitor/...]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another example could be that you need to upgrade <code>@ngx-translate</code> packages. As always in this case you will execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ng update @ngx-translate/core @ngx-translate/http-loader</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="angular-update-guide-online-tool"><a class="anchor" href="#angular-update-guide-online-tool"></a>7.152. Angular Update Guide online tool</h4>
<div class="paragraph">
<p>It is recommended to use the Angular Update Guide tool at <a href="https://update.angular.io/" class="bare">https://update.angular.io/</a> that will provide the necessary steps to upgrade any Angular application depending on multiple criteria.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="working-with-angular-cli"><a class="anchor" href="#working-with-angular-cli"></a>7.153. Working with Angular CLI</h4>
<div class="paragraph">
<p>Angular CLI provides a facade for building, testing, linting, debugging and generating code.
Under the hood Angular CLI uses specific tools to achieve these tasks.
The user does no need to maintain them and can rely on Angular to keep them up to date and maybe switch to other tools which come up in the future.</p>
</div>
<div class="paragraph">
<p>The Angular CLI provides a wiki with common tasks you encounter when working on applications with the Angular CLI.
<a href="https://github.com/angular/angular-cli/wiki">The Angular CLI Wiki can be found here.</a></p>
</div>
<div class="paragraph">
<p>In this guide we will go through the most important tasks.
To go into more details, please visit the Angular CLI wiki.</p>
</div>
</div>
<div class="sect3">
<h4 id="installing-angular-cli"><a class="anchor" href="#installing-angular-cli"></a>7.154. Installing Angular CLI</h4>
<div class="paragraph">
<p>Angular CLI should be added as global and local dependency.
The following commands add Angular CLI as global Dependency.</p>
</div>
<div class="paragraph">
<p>yarn command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">yarn global add @angular/cli</code></pre>
</div>
</div>
<div class="paragraph">
<p>npm command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install -g @angular/cli</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can check a successful installtion with <code>ng --version</code>.
This should print out the version installed.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/install-cli-success.png"><img src="_images/images/install-cli-success.png" alt="Printing Angular CLI Version" width="450"></a>
</div>
<div class="title">Figure 49. Printing Angular CLI Version</div>
</div>
</div>
<div class="sect3">
<h4 id="running-a-live-development-server"><a class="anchor" href="#running-a-live-development-server"></a>7.155. Running a live development server</h4>
<div class="paragraph">
<p>The Angular CLI can be used to start a live development server.
First your application will be compiled and then the server will be started.
If you change the code of a file, the server will reload the displayed page.
Run your application with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ng serve -o</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="running-unit-tests"><a class="anchor" href="#running-unit-tests"></a>7.156. Running Unit Tests</h4>
<div class="paragraph">
<p>All unit tests can be executed with the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ng test</code></pre>
</div>
</div>
<div class="paragraph">
<p>To make a single run and create a code coverage file use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ng test -sr -cc</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can configure the output format for code coverage files to match your requirements in the file <code>karma.conf.js</code> which can be found on toplevel of your project folder.
For instance, this can be useful for exporting the results to a SonarQube.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="linting-the-code-quality"><a class="anchor" href="#linting-the-code-quality"></a>7.157. Linting the code quality</h4>
<div class="paragraph">
<p>You can lint your files with the command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ng lint --type-check</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can adjust the linting rules in the file tslint.json which can be found on toplevel of your project folder.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="generating-code"><a class="anchor" href="#generating-code"></a>7.158. Generating Code</h4>

</div>
<div class="sect3">
<h4 id="creating-a-new-angular-cli-project"><a class="anchor" href="#creating-a-new-angular-cli-project"></a>7.159. Creating a new Angular CLI project</h4>
<div class="paragraph">
<p>For creating a new Angular CLI project the command <code>ng new</code> is used.</p>
</div>
<div class="paragraph">
<p>The following command creates a new application named my-app.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ng create my-app</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="creating-a-new-feature-module"><a class="anchor" href="#creating-a-new-feature-module"></a>7.160. Creating a new feature module</h4>
<div class="paragraph">
<p>A new feature module can be created via <code>ng generate module`</code> command.</p>
</div>
<div class="paragraph">
<p>The following command generates a new feature module named todo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ng generate module todo</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/generate-module.png"><img src="_images/images/generate-module.png" alt="Generate a module with Angular CLI" width="450"></a>
</div>
<div class="title">Figure 50. Generate a module with Angular CLI</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The created feature module needs to be added to the AppModule by hand.
Other option would be to define a lazy route in AppRoutingModule to make this a lazy loaded module.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="creating-a-new-component"><a class="anchor" href="#creating-a-new-component"></a>7.161. Creating a new component</h4>
<div class="paragraph">
<p>To create components the command <code>ng generate component</code> can be used.</p>
</div>
<div class="paragraph">
<p>The following command will generate the component todo-details inside the components layer of todo module.
It will generate a class, a html file, a css file and a test file.
Also, it will register this component as declaration inside the nearest module - this ist TodoModule.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ng generate component todo/components/todo-details</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/generate-component.png"><img src="_images/images/generate-component.png" alt="Generate a component with Angular CLI" width="450"></a>
</div>
<div class="title">Figure 51. Generate a component with Angular CLI</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you want to export the component, you have to add the component to exports array of the module.
This would be the case if you generate a component inside shared module.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="configuring-an-angular-cli-project"><a class="anchor" href="#configuring-an-angular-cli-project"></a>7.162. Configuring an Angular CLI project</h4>
<div class="paragraph">
<p>Inside an Angular CLI project the file <code>.angular-cli.json</code> can be used to configure the Angular CLI.</p>
</div>
<div class="paragraph">
<p>The following options are very important to understand.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The property <code>defaults`</code> can be used to change the default style extension.
The following settings will make the Angular CLI generate <code>.less</code> files, when a new component is generated.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"defaults": {
  "styleExt": "less",
  "component": {}
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The property <code>apps</code> contains all applications maintained with Angular CLI.
Most of the time you will have only one.</p>
<div class="ulist">
<ul>
<li>
<p><code>assets</code> configures all the static files, that the application needs - this can be images, fonts, json files, etc.
When you add them to assets the Angular CLI will put these files to the build target and serve them while debugging.
The following will put all files in <code>/i18n</code> to the output folder <code>/i18n</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"assets": [
  { "glob": "**/*.json", "input": "./i18n", "output": "./i18n" }
]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>styles</code> property contains all style files that will be globally available.
The Angular CLI will create a styles bundle that goes directly into index.html with it.
The following will make all styles in <code>styles.less</code> globally available.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"styles": [
  "styles.less"
]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>environmentSource</code> and <code>environments</code> are used to configure configuration with the Angular CLI.
Inside the code always the file specified in <code>environmentSource</code> will be referenced.
You can define different environments - eg. production, staging, etc. - which you list in <code>enviroments</code>.
At compile time the Angular CLI will override all values in <code>environmentSource</code> with the values from the matching environment target.
The following code will build the application for the environment staging.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ng build --environment=staging</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ionic-3"><a class="anchor" href="#ionic-3"></a>8. Ionic</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="ionic-5-getting-started"><a class="anchor" href="#ionic-5-getting-started"></a>8.1. Ionic 5 Getting started</h4>
<div class="paragraph">
<p>Ionic is a front-end focused framework which offers different tools for developing hybrid mobile applications. The web technologies used for this purpose are CSS, Sass, HTML5 and Typescript.</p>
</div>
</div>
<div class="sect3">
<h4 id="why-ionic"><a class="anchor" href="#why-ionic"></a>8.2. Why Ionic?</h4>
<div class="paragraph">
<p>Ionic is used for developing hybrid applications, which means not having to rely on a specific IDE such as Android Studio or Xcode. Furthermore, development of native apps require learning different languages (Java/Kotlin for Android and Objective-C/Swift for Apple), with Ionic, a developer does not have to code the same functionality for multiple platforms, just use the adequate libraries and components.</p>
</div>
</div>
<div class="sect3">
<h4 id="basic-environment-set-up"><a class="anchor" href="#basic-environment-set-up"></a>8.3. Basic environment set up</h4>

</div>
<div class="sect3">
<h4 id="install-ionic-cli"><a class="anchor" href="#install-ionic-cli"></a>8.4. Install Ionic CLI</h4>
<div class="paragraph">
<p>Although the devonfw distribution comes with and already installed Ionic CLI, here are the steps to install it. The installation of Ionic is easy, just one command has to be written:</p>
</div>
<div class="paragraph">
<p><code>$ npm install -g @ionic/cli</code></p>
</div>
</div>
<div class="sect3">
<h4 id="update-ionic-cli"><a class="anchor" href="#update-ionic-cli"></a>8.5. Update Ionic CLI</h4>
<div class="paragraph">
<p>If there was a previous installation of the Ionic CLI, it will need to be uninstalled due to a change in package name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm uninstall -g ionic
$ npm install -g @ionic/cli</code></pre>
</div>
</div>
<div class="paragraph">
<p>##Basic project set up
The set up of an ionic application is pretty immediate and can be done in one line:</p>
</div>
<div class="paragraph">
<p><code>ionic start &lt;name&gt; &lt;template&gt; --type=angular</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>ionic start: Command to create an app.</p>
</li>
<li>
<p>&lt;name&gt;: Name of the application.</p>
</li>
<li>
<p>&lt;template&gt;: Model of the application.</p>
</li>
<li>
<p>--type=angular: With this flag, the app produced will be based on angular.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To create an empty project, the following command can be used:</p>
</div>
<div class="paragraph">
<p><code>ionic start MyApp blank --type=angular</code></p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-getting-started/ionic-blank-project.PNG"><img src="_images/images/ionic-getting-started/ionic-blank-project.PNG" alt="Ionic blank project"></a>
</div>
</div>
<div class="paragraph">
<p>The image above shows the directory structure generated.</p>
</div>
<div class="paragraph">
<p>There are more templates available that can be seen with the command
<code>ionic start --list</code></p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-getting-started/ionic-start-list.png"><img src="_images/images/ionic-getting-started/ionic-start-list.png" alt="List of ionic templates"></a>
</div>
</div>
<div class="paragraph">
<p>The templates surrounded by red line are based on angular and comes with Ionic v5, while the others belong to earlier versions (before v4).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
More info at <a href="https://ionicframework.com/docs" class="bare">https://ionicframework.com/docs</a>. Remember to select <strong>Angular documentation</strong>, since Ionic supports React, Vue and Vanilla JS.
</td>
</tr>
</table>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="ionic-to-android"><a class="anchor" href="#ionic-to-android"></a>8.6. Ionic to android</h4>
<div class="paragraph">
<p>This page is written to help developers to go from the source code of an ionic application to an android one, with this in mind, topics such as: environment, commands, modifications,&#8230;&#8203;  are covered.</p>
</div>
</div>
<div class="sect3">
<h4 id="assumptions-2"><a class="anchor" href="#assumptions-2"></a>8.7. Assumptions</h4>
<div class="paragraph">
<p>This document assumes that the reader has already:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Source code of an Ionic application and wants to build it on an android device,</p>
</li>
<li>
<p>A working installation of NodeJS</p>
</li>
<li>
<p>An Ionic CLI installed and up-to-date.</p>
</li>
<li>
<p>Android Studio and Android SDK.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="from-ionic-to-android-project"><a class="anchor" href="#from-ionic-to-android-project"></a>8.8. From Ionic to Android project</h4>
<div class="paragraph">
<p>When a native application is being designed, sometimes, functionalities that uses camera, geolocation, push notification, &#8230;&#8203; are requested. To resolve these requests, Capacitor can be used.</p>
</div>
<div class="paragraph">
<p>In general terms, Capacitor wraps apps made with Ionic (HTML, SCSS, Typescript) into WebViews that can be displayed in native applications (Android, IOS) and allows the developer to access native functionalities like the ones said before.</p>
</div>
<div class="paragraph">
<p>Installing capacitor is as easy as installing any node module, just a few commands have to be run in a console:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cd name-of-ionic-4-app</code></p>
</li>
<li>
<p><code>npm install --save @capacitor/core @capacitor/cli</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then, it is necessary to initialize capacitor with some information: app id, name of the app and the directory where your app is stored. To fill this information, run:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>npx cap init</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="modifications"><a class="anchor" href="#modifications"></a>8.9. Modifications</h4>
<div class="paragraph">
<p>Throughout the development process, usually back-end and front-end are on a local computer, so it&#8217;s a common practice to have different configuration files for each environment (commonly production and development). Ionic uses an angular.json file to store those configurations and some rules to be applied.</p>
</div>
<div class="paragraph">
<p>If a back-end is hosted on <code><a href="http://localhost:8081" class="bare">http://localhost:8081</a></code>, and that direction is used in every environment, the application built for android will not work because computer and device do not have the same localhost. Fortunately, different configurations can be defined.</p>
</div>
<div class="paragraph">
<p>Android Studio uses 10.0.0.2 as alias for 127.0.0.1 (computer&#8217;s localhost) so adding <code><a href="http://10.0.0.2:8081" class="bare">http://10.0.0.2:8081</a></code> in a new environment file and modifying angular.json accordingly, will make possible connect front-end and back-end.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/environments.png"><img src="_images/images/ionic-to-android/environments.png" alt="Android environment and angular.json"></a>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>    "build": {
    ...
        "configurations": {
            ...
            "android": {
                "fileReplacements": [
                    {
                        "replace": "src/environments/environment.ts",
                        "with": "src/environments/environment.android.ts"
                    }
                ]
            },
        }
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="build-2"><a class="anchor" href="#build-2"></a>8.10. Build</h4>
<div class="paragraph">
<p>Once configured, it is necessary to build the Ionic app using this new configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ionic build --configuration=android</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The next commands copy the build application on a folder named android and open android studio.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>npx cap add android</code></p>
</li>
<li>
<p><code>npx cap copy</code></p>
</li>
<li>
<p><code>npx cap open android</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="from-android-project-to-emulated-device"><a class="anchor" href="#from-android-project-to-emulated-device"></a>8.11. From Android project to emulated device</h4>
<div class="paragraph">
<p>Once Android Studio is opened, follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click on "Build" &#8594; Make project.</p>
</li>
<li>
<p>Click on "Build" &#8594; Make Module 'app' (default name).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/ionic-to-android/and-vsc-make.png"><img src="_images/images/ionic-to-android/and-vsc-make.png" alt="Click on make project" width="400"></a></span>
<span class="image"><a class="image" href="images/ionic-to-android/and-vsc-make-app.png"><img src="_images/images/ionic-to-android/and-vsc-make-app.png" alt="click on make app" width="400"></a></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Click on" Build" &#8594; Build Bundle(s) / APK(s) &#8594; Build APK(s).</p>
</li>
<li>
<p>Click on run and choose a device.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/ionic-to-android/and-vsc-build-apk.png"><img src="_images/images/ionic-to-android/and-vsc-build-apk.png" alt="click on build APK" width="400"></a></span>
<span class="image"><a class="image" href="images/ionic-to-android/and-vsc-build-run.png"><img src="_images/images/ionic-to-android/and-vsc-build-run.png" alt="click on running device" width="400"></a></span></p>
</div>
<div class="paragraph">
<p>If there are no devices available, a new one can be created:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click on "Create new device"</p>
</li>
<li>
<p>Select hardware and click "Next". For example: Phone &#8594; Nexus 5X.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/ionic-to-android/create-new-device.png"><img src="_images/images/ionic-to-android/create-new-device.png" alt="Create new device" width="400"></a></span>
<span class="image"><a class="image" href="images/ionic-to-android/new-phone-nexus.png"><img src="_images/images/ionic-to-android/new-phone-nexus.png" alt="Select hardware" width="400"></a></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="3">
<li>
<p>Download a system image.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click on download.</p>
</li>
<li>
<p>Wait until the installation finished and then click "Finish".</p>
</li>
<li>
<p>Click "Next".</p>
</li>
</ol>
</div>
</li>
<li>
<p>Verify configuration (default configuration should be enough) and click "Next".</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/ionic-to-android/download-so.png"><img src="_images/images/ionic-to-android/download-so.png" alt="Download system image" width="400"></a></span>
<span class="image"><a class="image" href="images/ionic-to-android/config-device.png"><img src="_images/images/ionic-to-android/config-device.png" alt="Check configuration" width="400"></a></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>Check that the new device is created correctly.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/new-phone-created.png"><img src="_images/images/ionic-to-android/new-phone-created.png" alt="New created device" width="400"></a>
</div>
</div>
</div>
<div class="sect3">
<h4 id="from-android-project-to-real-device"><a class="anchor" href="#from-android-project-to-real-device"></a>8.12. From Android project to real device</h4>
<div class="paragraph">
<p>To test on a real android device, an easy approach to communicate a smartphone (front-end) and computer (back-end) is to configure a WiFi hotspot and connect the computer to it. A guide about this process can be found <a href="https://support.google.com/nexus/answer/9059108?hl=en">here</a>.</p>
</div>
<div class="paragraph">
<p>Once connected, run <code>ipconfig</code> on a console if you are using windows or <code>ifconfig</code> on a Linux machine to get the IP address of your machine&#8217;s Wireless LAN adapter WiFi.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/ipconfig-short.png"><img src="_images/images/ionic-to-android/ipconfig-short.png" alt="Result of `ipconfig` command on Windows 10" width="700"></a>
</div>
</div>
<div class="paragraph">
<p>This obtained IP must be used instead of "localhost" or "10.0.2.2" at environment.android.ts.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/new-backend-url.PNG"><img src="_images/images/ionic-to-android/new-backend-url.PNG" alt="Android environment file server URL" width="700"></a>
</div>
</div>
<div class="paragraph">
<p>After this configuration, follow the build steps in "From Ionic to Android project" and the first three steps in "From Android project to emulated device".</p>
</div>
</div>
<div class="sect3">
<h4 id="send-apk-to-android-through-usb"><a class="anchor" href="#send-apk-to-android-through-usb"></a>8.13. Send APK to Android through USB</h4>
<div class="paragraph">
<p>To send the built application to a device, you can connect computer and mobile through USB, but first, it is necessary to unlock developer options.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open "Settings" and go to "System".</p>
</li>
<li>
<p>Click on "About".</p>
</li>
<li>
<p>Click "Build number" seven times to unlock developer options.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/enable-developer-options1_2_3.png"><img src="_images/images/ionic-to-android/enable-developer-options1_2_3.png" alt="Steps to enable developer options: 1, 2, 3" width="700"></a>
</div>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Go to "System" again an then to "Developer options"</p>
</li>
<li>
<p>Check that the options are "On".</p>
</li>
<li>
<p>Check that "USB debugging" is activated.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/enable-developer-options4_5_6.png"><img src="_images/images/ionic-to-android/enable-developer-options4_5_6.png" alt="Steps to enable developer options: 4, 5, 6" width="700"></a>
</div>
</div>
<div class="paragraph">
<p>After this, do the step four in "From Android project to emulated device" and choose the connected smartphone.</p>
</div>
</div>
<div class="sect3">
<h4 id="send-apk-to-android-through-email"><a class="anchor" href="#send-apk-to-android-through-email"></a>8.14. Send APK to Android through email</h4>
<div class="paragraph">
<p>When you build an APK, a dialog gives two options: locate or analyze. If the first one is chosen, Windows file explorer will be opened showing an APK that can be send using email. Download the APK on your phone and click it to install.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/locate-apk.png"><img src="_images/images/ionic-to-android/locate-apk.png" alt="Steps to enable developer options: 4, 5, 6" width="300"></a>
</div>
</div>
</div>
<div class="sect3">
<h4 id="result"><a class="anchor" href="#result"></a>8.15. Result</h4>
<div class="paragraph">
<p>If everything goes correctly, the Ionic application will be ready to be tested.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ionic-to-android/real-device.png"><img src="_images/images/ionic-to-android/real-device.png" alt="Application running on a real device" width="300"></a>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="ionic-progressive-web-app"><a class="anchor" href="#ionic-progressive-web-app"></a>8.16. Ionic Progressive Web App</h4>
<div class="paragraph">
<p>This guide is a continuation of the guide <a href="guide-angular-pwa">Angular PWAs</a>, therefore, valid concepts explained there are still valid in this page but focused on Ionic.</p>
</div>
</div>
<div class="sect3">
<h4 id="assumptions-3"><a class="anchor" href="#assumptions-3"></a>8.17. Assumptions</h4>
<div class="paragraph">
<p>This guide assumes that you already have installed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>NodeJS</p>
</li>
<li>
<p>npm package manager</p>
</li>
<li>
<p>Angular CLI / Nx CLI</p>
</li>
<li>
<p>Ionic 5 CLI</p>
</li>
<li>
<p>Capacitor</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also, it is a good idea to read the document about PWA using Angular.</p>
</div>
</div>
<div class="sect3">
<h4 id="sample-application-2"><a class="anchor" href="#sample-application-2"></a>8.18. Sample Application</h4>
<div class="imageblock">
<div class="content">
<img src="_images/images/ionic/ionic-pwa/base.png" alt="Ionic 5 PWA Base" width="250 link="images/ionic/ionic-pwa/base.png"">
</div>
<div class="title">Figure 52. Basic ionic PWA.</div>
</div>
<div class="paragraph">
<p>To explain how to build progressive web apps (PWA) using Ionic, a basic application is going to be built. This app will be able to take photos even without network using PWA elements.</p>
</div>
</div>
<div class="sect3">
<h4 id="step-1-create-a-new-project-2"><a class="anchor" href="#step-1-create-a-new-project-2"></a>8.19. Step 1: Create a new project</h4>
<div class="paragraph">
<p>This step can be completed with one simple command: <code>ionic start &lt;name&gt; &lt;template&gt;</code>, where <code>&lt;name&gt;</code> is the name and <code>&lt;template&gt;</code> a model for the app. In this case, the app is going to be named <code><strong>basic-ion-pwa</strong></code>.</p>
</div>
<div class="paragraph">
<p>If you are using Nx, there is a pre-requisite to this step. And that is, you have to add the <code>@nxtend/ionic-angular</code> plugin to your Nx workspace. The command for that is <code>npm install --save-dev @nxtend/ionic-angular</code>. Once you have the plugin installed, you can generate an ionic app in your Nx workspace with the command <code>nx generate @nxtend/ionic-angular:app basic-ion-pwa</code>. (You can refer <a href="https://github.com/devonfw/devon4ng/wiki/guide-creating-angular-app-with-nx-cli">this guide</a> if you want to get started with Nx).</p>
</div>
</div>
<div class="sect3">
<h4 id="step-2-structures-and-styles"><a class="anchor" href="#step-2-structures-and-styles"></a>8.20. Step 2: Structures and styles</h4>
<div class="paragraph">
<p>The styles (scss) and structures (html) do not have anything specially relevant, just colors and ionic web components. The code can be found in <a href="https://github.com/devonfw-sample/devon4ts-samples/tree/master/apps/ionic-basic-pwa">devon4ts-samples</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="step-3-add-functionality"><a class="anchor" href="#step-3-add-functionality"></a>8.21. Step 3: Add functionality</h4>
<div class="paragraph">
<p>After this step, the app will allow users to take photos and display them in the main screen.
First we have to import three important elements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DomSanitizer</code>: Sanitizes values to be safe to use.</p>
</li>
<li>
<p><code>SafeResourceUrl</code>: Interface for values that are safe to use as URL.</p>
</li>
<li>
<p>Plugins: Capacitor constant value used to access to the device&#8217;s camera and toast dialogs.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  import { DomSanitizer, SafeResourceUrl } from '@angular/platform-browser';
  import { Plugins, CameraResultType } from '@capacitor/core';</code></pre>
</div>
</div>
<div class="paragraph">
<p>The process of taking a picture is enclosed in a <code>takePicture()</code> method. <code>takePicture()</code> calls the Camera&#8217;s <code>getPhoto()</code> function which returns an URL or an exception. If a photo is taken then the image displayed in the main page will be changed for the new picture, else, if the app is closed without changing it, a toast message will be displayed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  export class HomePage {
    image: SafeResourceUrl;
    ...

    async takePicture() {
      try {
        const image = await Plugins.Camera.getPhoto({
          quality: 90,
          allowEditing: true,
          resultType: CameraResultType.Uri,
        });

        // Change last picture shown
        this.image = this.sanitizer.bypassSecurityTrustResourceUrl(image.webPath);
      } catch (e) {
        this.show('Closing camera');
      }
    }

    async show(message: string) {
      await Plugins.Toast.show({
        text: message,
      });
    }
  }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="step-4-pwa-elements"><a class="anchor" href="#step-4-pwa-elements"></a>8.22. Step 4: PWA Elements</h4>
<div class="paragraph">
<p>When Ionic apps are not running natively, some resources like Camera do not work by default but can be enabled using PWA Elements. To use Capacitor&#8217;s PWA elements run <code>npm install @ionic/pwa-elements</code> and modify src/main.ts as shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>...

// Import for PWA elements
import { defineCustomElements } from '@ionic/pwa-elements/loader';

if (environment.production) {
  enableProdMode();
}

platformBrowserDynamic().bootstrapModule(AppModule)
  .catch(err =&gt; console.log(err));

// Call the element loader after the platform has been bootstrapped
defineCustomElements(window);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="step-5-make-it-progressive-2"><a class="anchor" href="#step-5-make-it-progressive-2"></a>8.23. Step 5: Make it Progressive.</h4>
<div class="paragraph">
<p>Turning an Ionic 5 app into a PWA is pretty easy. The same module used to turn Angular apps into PWAs has to be added. To do so, run: <code>ng add @angular/pwa</code>. This command also creates an <strong>icons</strong> folder inside <strong>src/assets</strong> and contains angular icons for multiple resolutions. (Note: In an Nx workspace, you have to add it like a normal package using <code>npm install @angular/pwa</code>, and you have to manually add the icons). If you want to use other images, be sure that they have the same resolution, the names can be different but the file <strong>manifest.json</strong> has to be changed accordingly.</p>
</div>
</div>
<div class="sect3">
<h4 id="step-6-configure-the-app-2"><a class="anchor" href="#step-6-configure-the-app-2"></a>8.24. Step 6: Configure the app</h4>
<div class="paragraph">
<p><strong>manifest.json</strong></p>
</div>
<div class="paragraph">
<p>Default configuration.</p>
</div>
<div class="paragraph">
<p><strong>ngsw-config.json</strong></p>
</div>
<div class="paragraph">
<p>At <code>assetGroups</code> &#8594; <code>resources</code> add a URLs field and a pattern to match PWA Elements scripts and other resources (images, styles, &#8230;&#8203;):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  "urls": ["https://unpkg.com/@ionic/pwa-elements@1.0.2/dist/**"]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="step-7-check-that-your-app-is-a-pwa-2"><a class="anchor" href="#step-7-check-that-your-app-is-a-pwa-2"></a>8.25. Step 7: Check that your app is a PWA</h4>
<div class="paragraph">
<p>To check if an app is a PWA lets compare its normal behavior against itself but built for production. Run in the project&#8217;s root folder the commands below:</p>
</div>
<div class="paragraph">
<p><code>ionic build --configuration production</code> to build the app using production settings. (<code>nx build basic-ion-pwa --configuration production</code> in your Nx workspace root).</p>
</div>
<div class="paragraph">
<p><code>npm install http-server</code> to install an npm module that can serve your built application. Documentation <a href="https://www.npmjs.com/package/http-server">here</a>. A good alternative is also <code>npm install serve</code>. It can be checked <a href="https://github.com/zeit/serve">here</a>.</p>
</div>
<div class="paragraph">
<p>Go to the <code><strong>www</strong></code> folder running <code>cd www</code>.</p>
</div>
<div class="paragraph">
<p><code>http-server -o</code> or <code>serve</code> to serve your built app.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In order not to install anything not necessary <code>npx</code> can be used directly to serve the app. i.e run <code>npx serve [folder]</code> will automatically download and run this HTTP server without installing it in the project dependencies.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/ionic/ionic-pwa/http-server.png" alt="Http server running" width="600 link="images/ionic/ionic-pwa/http-server.png"">
</div>
<div class="title">Figure 53. Http server running on localhost:8081.</div>
</div>
<div class="paragraph">
<p>&#160;<br>
In another console instance run <code>ionic serve</code> (<code>nx serve basic-ion-pwa</code> if using Nx CLI) to open the common app (not built).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/ionic/ionic-pwa/ionic-serve.png" alt="Ionic serve on Visual Studio Code console" width="600 link="images/ionic/ionic-pwa/ionic-serve.png"">
</div>
<div class="title">Figure 54. Ionic server running on localhost:8100.</div>
</div>
<div class="paragraph">
<p>&#160;<br>
The first difference can be found on <em>Developer tools &#8594; application</em>, here it is seen that the PWA application (left) has a service worker and the common one does not.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/ionic/ionic-pwa/pwa-nopwa-app.png" alt="Application comparison" width="800 link="images/ionic/ionic-pwa/pwa-nopwa-app.png"">
</div>
<div class="title">Figure 55. Application service worker comparison.</div>
</div>
<div class="paragraph">
<p>&#160;<br>
If the "offline" box is checked, it will force a disconnection from network. In situations where users do not have connectivity or have a slow, one the PWA can still be accessed and used.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/ionic/ionic-pwa/online-offline.png" alt="Online offline apps" width="800 link="images/ionic/ionic-pwa/online-offline.png"">
</div>
<div class="title">Figure 56. Offline application.</div>
</div>
<div class="paragraph">
<p>&#160;<br>
Finally, plugins like <a href="https://chrome.google.com/webstore/detail/lighthouse/blipmdconlkpinefehnmjammfjpmpbjk">Lighthouse</a> can be used to test whether an application is progressive or not.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/ionic/ionic-pwa/lighthouse.png" alt="Lighthouse report" width="800 link="images/ionic/ionic-pwa/lighthouse.png"">
</div>
<div class="title">Figure 57. Lighthouse report.</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="layouts-2"><a class="anchor" href="#layouts-2"></a>9. Layouts</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="angular-material-layout"><a class="anchor" href="#angular-material-layout"></a>9.1. Angular Material Layout</h4>
<div class="paragraph">
<p>The purpose of this guide is to get a basic understanding of creating layouts using <a href="https://material.angular.io">Angular Material</a> in a devon4ng application. We will create an application with a header containing some menu links and a sidenav with some navigation links.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/1-finished-application.png"><img src="_images/images/layout-angular-material/1-finished-application.png" alt="Finished application" width="700"></a>
</div>
<div class="title">Figure 58. This is what the finished application will look like</div>
</div>
</div>
<div class="sect3">
<h4 id="create-a-new-angular-application"><a class="anchor" href="#create-a-new-angular-application"></a>9.2. Create a new angular application</h4>
<div class="paragraph">
<p>We start with opening the devonfw IDE(right-click anywhere in your workspace and click "Open devonfw CMD shell here") and running the following command to start a project named devon4ng-mat-layout</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ng new devon4ng-mat-layout --routing --style=scss</code>. If you are using Nx, the command would be <code>nx generate @nrwl/angular:app devon4ng-mat-layout --routing --style=scss</code> in your Nx workspace. <a href="https://github.com/devonfw/devon4ng/wiki/guide-creating-angular-app-with-nx-cli">Click here</a> to get started with using Nx.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We are providing the <code>routing</code> flag so that a routing module is generated, and we are also setting the style sheet format to SCSS with <code>--style=scss</code>.</p>
</div>
<div class="paragraph">
<p>Once the creation process is complete, open your newly created application in Visual Studio Code. Try running the empty application by running the following command in the integrated terminal:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ng serve</code>. (If you are using Nx, you have to specify the project name along with the --project flag, so the command becomes <code>ng serve --project=devon4ng-mat-layout</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Angular will spin up a server and you can check your application by visiting <a href="http://localhost:4200/" class="bare">http://localhost:4200/</a> in your browser.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/2-blank-application.png"><img src="_images/images/layout-angular-material/2-blank-application.png" alt="Blank application" width="700"></a>
</div>
<div class="title">Figure 59. Blank application</div>
</div>
</div>
<div class="sect3">
<h4 id="adding-angular-material-library-to-the-project"><a class="anchor" href="#adding-angular-material-library-to-the-project"></a>9.3. Adding Angular Material library to the project</h4>
<div class="paragraph">
<p>Next we will add Angular Material to our application. In the integrated terminal, press <code>Ctrl + C</code> to terminate the running application and run the following command:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>npm install --save @angular/material @angular/cdk @angular/animations</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also use Yarn to install the dependencies if you prefer that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>yarn add @angular/material @angular/cdk @angular/animations</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once the dependencies are installed, we need to import the <code>BrowserAnimationsModule</code> in our <code>AppModule</code> for animations support.</p>
</div>
<div class="listingblock">
<div class="title">Listing 88. Importing <code>BrowserAnimationsModule</code> in <code>AppModule</code></div>
<div class="content">
<pre class="highlightjs highlight"><code>import {BrowserAnimationsModule} from '@angular/platform-browser/animations';

@NgModule({
  ...
  imports: [BrowserAnimationsModule],
  ...
})
export class AppModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Angular Material provides a host of components for designing our application. All the components are well structured into individual <code>NgModules</code>. For each component from the Angular Material library that we want to use, we have to import the respective <code>NgModule</code>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 89. We will be using the following components in our application:</div>
<div class="content">
<pre class="highlightjs highlight"><code>import { MatIconModule, MatButtonModule, MatMenuModule, MatListModule, MatToolbarModule, MatSidenavModule } from '@angular/material';

@NgModule({
  ...
  imports: [
	...
    MatIconModule,
    MatButtonModule,
    MatMenuModule,
    MatListModule,
    MatToolbarModule,
    MatSidenavModule,
	...
	],
  ...
})
export class AppModule { }</code></pre>
</div>
</div>
<div class="paragraph">
<p>A better approach is to import and then export all the required components in a shared  module. But for the sake of simplicity, we are importing all the required components in the <code>AppModule</code> itself.</p>
</div>
</div>
<div class="sect3">
<h4 id="-5"><a class="anchor" href="#-5"></a>==</h4>
<div class="literalblock">
<div class="content">
<pre>  You can find a working copy of this application https://github.com/devonfw-sample/devon4ts-samples/tree/master/apps/angular-material-basic-layout[here]. The sample application is part of a Nx workspace, which means it is one of the many apps in a monorepo and capable of importing reusable code from a shared library. This guide describes the implementaion by assuming a stand-alone single-repo application, but the pages and layout described in this sample app are similar to the ones used in another sample app in the monorepo (https://github.com/devonfw-sample/devon4ts-samples/tree/master/apps/angular-material-theming[angular-material-theming]), which is why we have exported the required components from a shared library and reused them in both the apps. As a result, the code in our monorepo will be slightly different. It would still help you in following this guide.
== ==</pre>
</div>
</div>
<div class="paragraph">
<p>Next, we include a theme in our application. Angular Material comes with four pre-defined themes: <code>indigo-pink</code>, <code>deeppurple-amber</code>, <code>pink-bluegrey</code> and <code>purple-green</code>. It is also possible to create our own custom theme, but that is beyond the scope of this guide. Including a theme is required to apply all of the core and theme styles to your application.
We will include the indigo-pink theme in our application by importing the <code>indigo-pink.css</code> file in our <code>src/styles.scss</code>:</p>
</div>
<div class="listingblock">
<div class="title">Listing 90. In <code>src/styles.scss</code>:</div>
<div class="content">
<pre class="highlightjs highlight"><code>@import "~@angular/material/prebuilt-themes/indigo-pink.css";</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use <a href="https://material.io/icons/">Material Design Icons</a> along with the <code>mat-icon</code> component, we will load the Material Icons library in our <code>src/index.html</code> file</p>
</div>
<div class="listingblock">
<div class="title">Listing 91. In src/index.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code>&lt;link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="development"><a class="anchor" href="#development"></a>9.4. Development</h4>
<div class="paragraph">
<p>Now that we have all the Angular Material related dependencies set up in our project, we can start coding. Let&#8217;s begin by adding a suitable <code>margin</code> and <code>font</code> to the <code>body</code> element of our single page application. We will add it in the <code>src/styles.scss</code> file to apply it globally:</p>
</div>
<div class="listingblock">
<div class="title">Listing 92. In <code>src/styles.scss</code>:</div>
<div class="content">
<pre class="highlightjs highlight"><code>body {
  margin: 0;
  font-family: "Segoe UI", Roboto, sans-serif;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point, if we run our application, this is how it will look like:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/3-material-added.png"><img src="_images/images/layout-angular-material/3-material-added.png" alt="Angular Material added to the application" width="700"></a>
</div>
<div class="title">Figure 60. Application with Angular Material set up</div>
</div>
<div class="paragraph">
<p>We will clear the <code>app.component.html</code> file and setup a header with a menu button and some navigational links. We will use <code>mat-toolbar</code>, <code>mat-button</code>, <code>mat-menu</code>, <code>mat-icon</code> and <code>mat-icon-button</code> for this:</p>
</div>
<div class="listingblock">
<div class="title">Listing 93. app.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code>&lt;mat-toolbar color="primary"&gt;
  &lt;button mat-icon-button aria-label="menu"&gt;
    &lt;mat-icon&gt;menu&lt;/mat-icon&gt;
  &lt;/button&gt;
  &lt;button mat-button [matMenuTriggerFor]="submenu"&gt;Menu 1&lt;/button&gt;
  &lt;button mat-button&gt;Menu 2&lt;/button&gt;
  &lt;button mat-button&gt;Menu 3&lt;/button&gt;

  &lt;mat-menu #submenu="matMenu"&gt;
    &lt;button mat-menu-item&gt;Sub-menu 1&lt;/button&gt;
    &lt;button mat-menu-item [matMenuTriggerFor]="submenu2"&gt;Sub-menu 2&lt;/button&gt;
  &lt;/mat-menu&gt;

  &lt;mat-menu #submenu2="matMenu"&gt;
    &lt;button mat-menu-item&gt;Menu Item 1&lt;/button&gt;
    &lt;button mat-menu-item&gt;Menu Item 2&lt;/button&gt;
    &lt;button mat-menu-item&gt;Menu Item 3&lt;/button&gt;
  &lt;/mat-menu&gt;

&lt;/mat-toolbar&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The color attribute on the <code>mat-toolbar</code> element will give it the primary (indigo) color as defined by our theme. The color attribute works with most Angular Material components; the possible values are 'primary', 'accent' and 'warn'.
The mat-toolbar is a suitable component to represent a header. It serves as a placeholder for elements we want in our header.
Inside the mat-toolbar, we start with a button having mat-icon-button attribute, which itself contains a mat-icon element having the value <code>menu</code>. This will serve as a menu button which we can use to toggle the sidenav.
We follow it with some sample buttons having the mat-button attribute. Notice the first button has a property <code>matMenuTriggerFor</code> bound to a local reference <code>submenu</code>. As the property name suggests, the click of this button will display the <code>mat-menu</code> element with the specified local reference as a drop-down menu. The rest of the code is self explanatory.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/4-header.png"><img src="_images/images/layout-angular-material/4-header.png" alt="Header added to the application" width="700"></a>
</div>
<div class="title">Figure 61. This is how our application looks with the first menu button (Menu 1) clicked.</div>
</div>
<div class="paragraph">
<p>We want to keep the sidenav toggling menu button on the left and move the rest to the right to make it look better. To do this we add a class to the menu icon button:</p>
</div>
<div class="listingblock">
<div class="title">Listing 94. app.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code>...
  &lt;button mat-icon-button aria-label="menu" class="menu"&gt;
    &lt;mat-icon&gt;menu&lt;/mat-icon&gt;
  &lt;/button&gt;
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>And in the <code>app.component.scss</code> file, we add the following style:</p>
</div>
<div class="listingblock">
<div class="title">Listing 95. <code>app.component.scss</code>:</div>
<div class="content">
<pre class="highlightjs highlight"><code>.menu {
    margin-right: auto;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The mat-toolbar element already has it&#8217;s display property set to <code>flex</code>. Setting the menu icon button&#8217;s <code>margin-right</code> property to <code>auto</code> keeps itself on the left and pushes the other elements to the right.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/5-header-layout-final.png"><img src="_images/images/layout-angular-material/5-header-layout-final.png" alt="Final look of the header" width="700"></a>
</div>
<div class="title">Figure 62. Final look of the header.</div>
</div>
<div class="paragraph">
<p>Next, we will create a sidenav. But before that lets create a couple of components to navigate between, the links of which we will add to the sidenav.
We will use the <code>ng generate component</code> (or <code>ng g c</code> command for short) to create <em>Home</em> and <em>Data</em> components. (Append <code>--project=devon4ng-mat-layout</code> to the command in a Nx workspace). We nest them in the <code>pages</code> sub-directory since they represent our pages.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ng g c pages/home</code></p>
</li>
<li>
<p><code>ng g c pages/data;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let us set up the routing such that when we visit <code><a href="http://localhost:4200/" class="bare">http://localhost:4200/</a></code> root url we see the <code>HomeComponent</code> and when we visit <code><a href="http://localhost:4200/data" class="bare">http://localhost:4200/data</a></code> url we see the  <code>DataComponent</code>.
We had opted for routing while creating the application, so we have the routing module <code>app-routing.module.ts</code> setup for us. In this file, we have the empty <code>routes</code> array where we set up our routes.</p>
</div>
<div class="listingblock">
<div class="title">Listing 96. app-routing.module.ts:</div>
<div class="content">
<pre class="highlightjs highlight"><code>import { HomeComponent } from './pages/home/home.component';
import { DataComponent } from './pages/data/data.component';

	const routes: Routes = [
	  { path: '', component: HomeComponent },
	  { path: 'data', component: DataComponent }
	];</code></pre>
</div>
</div>
<div class="paragraph">
<p>We need to provide a hook where the components will be loaded when their respective URLs are loaded. We do that by using the <code>router-outlet</code> directive in the <code>app.component.html</code>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 97. app.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code>...
	&lt;/mat-toolbar&gt;
	&lt;router-outlet&gt;&lt;/router-outlet&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now when we visit the defined URLs we see the appropriate components rendered on screen.</p>
</div>
<div class="paragraph">
<p>Lets change the contents of the components to have something better.</p>
</div>
<div class="listingblock">
<div class="title">Listing 98. home.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code>&lt;h2&gt;Home Page&lt;/h2&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 99. <code>home.component.scss</code>:</div>
<div class="content">
<pre class="highlightjs highlight"><code>h2 {
    text-align: center;
    margin-top: 50px;
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 100. data.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code>&lt;h2&gt;Data Page&lt;/h2&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 101. <code>data.component.scss</code>:</div>
<div class="content">
<pre class="highlightjs highlight"><code>h2 {
    text-align: center;
    margin-top: 50px;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The pages look somewhat better now:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/6-home-page.png"><img src="_images/images/layout-angular-material/6-home-page.png" alt="Home page" width="700"></a>
</div>
<div class="title">Figure 63. Home page</div>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/7-data-page.png"><img src="_images/images/layout-angular-material/7-data-page.png" alt="Data page" width="700"></a>
</div>
<div class="title">Figure 64. Data page</div>
</div>
<div class="paragraph">
<p>Let us finally create the sidenav. To implement the sidenav we need to use 3 Angular Material components: <code>mat-sidenav-container</code>, <code>mat-sidenav</code> and <code>mat-sidenav-content</code>.
The <code>mat-sidenav-container</code>, as the name suggests, acts as a container for the sidenav and the associated content. So it is the parent element, and <code>mat-sidenav</code> and <code>mat-sidenav-content</code> are the children sibling elements. <code>mat-sidenav</code> represents the sidenav. We can put any content we want, though it is usually used to contain a list of navigational links. The <code>mat-sidenav-content</code> element is for containing the contents of our current page. Since we need the sidenav application-wide, we will put it in the <code>app.component.html</code>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 102. app.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code>...
&lt;/mat-toolbar&gt;

&lt;mat-sidenav-container&gt;
  &lt;mat-sidenav mode="over" [disableClose]="false" #sidenav&gt;
    Sidenav
  &lt;/mat-sidenav&gt;
  &lt;mat-sidenav-content&gt;
    &lt;router-outlet&gt;&lt;/router-outlet&gt;
  &lt;/mat-sidenav-content&gt;
&lt;/mat-sidenav-container&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>mat-sidenav</code> has a <code>mode</code> property, which accepts one of the 3 values: <code>over</code>, <code>push</code> and <code>side</code>. It decides the behavior of the sidenav. <code>mat-sidenav</code> also has a <code>disableClose</code> property which accents a boolean value. It toggles the behavior where we click on the backdrop or press the <code>Esc</code> key to close the sidenav. There are other properties which we can use to customize the appearance, behavior and position of the sidenav. You can find the properties documented online at <a href="https://material.angular.io/components/sidenav/api" class="bare">https://material.angular.io/components/sidenav/api</a>
We moved the <code>router-outlet</code> directive inside the <code>mat-sidenav-content</code> where it will render the routed component.
But if you check the running application in the browser, we don&#8217;t see the sidenav yet. That is because it is closed. We want to have the sidenav opened/closed at the click of the menu icon button on the left side of the header we implemented earlier. Notice we have set a local reference <code>#sidenav</code> on the <code>mat-sidenav</code> element. We can access this element and call its <code>toggle()</code> function to toggle open or close the sidenav.</p>
</div>
<div class="listingblock">
<div class="title">Listing 103. app.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code>...
  &lt;button mat-icon-button aria-label="menu" class="menu" (click)="sidenav.toggle()"&gt;
    &lt;mat-icon&gt;menu&lt;/mat-icon&gt;
  &lt;/button&gt;
...</code></pre>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/8-sidenav-started.png"><img src="_images/images/layout-angular-material/8-sidenav-started.png" alt="Sidenav works" width="700"></a>
</div>
<div class="title">Figure 65. Sidenav is implemented</div>
</div>
<div class="paragraph">
<p>We can now open the sidenav by clicking the menu icon button. But it does not look right. The sidenav is only as wide as its content. Also the page does not stretch the entire viewport due to lack of content.
Let&#8217;s add the following styles to make the page fill the viewport:</p>
</div>
<div class="listingblock">
<div class="title">Listing 104. app.component.scss:</div>
<div class="content">
<pre class="highlightjs highlight"><code>...
mat-sidenav-container {
    position: absolute;
    top: 64px;
    left: 0;
    right: 0;
    bottom: 0;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The sidenav width will be corrected when we add the navigational links to it. That is the only thing remaining to be done. Lets implement it now:</p>
</div>
<div class="listingblock">
<div class="title">Listing 105. app.component.html:</div>
<div class="content">
<pre class="highlightjs highlight"><code>...
  &lt;mat-sidenav [disableClose]="false" mode="over" #sidenav&gt;
	&lt;mat-nav-list&gt;
      &lt;a
        id="home"
        mat-list-item
        [routerLink]="['./']"
        (click)="sidenav.close()"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{exact: true}"
      &gt;
        &lt;mat-icon matListAvatar&gt;home&lt;/mat-icon&gt;
        &lt;h3 matLine&gt;Home&lt;/h3&gt;
        &lt;p matLine&gt;sample home page&lt;/p&gt;
      &lt;/a&gt;
      &lt;a
        id="sampleData"
        mat-list-item
        [routerLink]="['./data']"
        (click)="sidenav.close()"
        routerLinkActive="active"
      &gt;
        &lt;mat-icon matListAvatar&gt;grid_on&lt;/mat-icon&gt;
        &lt;h3 matLine&gt;Data&lt;/h3&gt;
        &lt;p matLine&gt;sample data page&lt;/p&gt;
      &lt;/a&gt;
    &lt;/mat-nav-list&gt;
  &lt;/mat-sidenav&gt;
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>We use the <code>mat-nav-list</code> element to set a list of navigational links. We use the <code>a</code> tags with <code>mat-list-item</code> directive. We implement a <code>click</code> listener on each link to close the sidenav when it is clicked. The <code>routerLink</code> directive is used to provide the URLs to navigate to. The <code>routerLinkActive</code> directive is used to provide the class name which will be added to the link when it&#8217;s URL is visited. Here we name the class`active`. To style it, let' modify the <code>app.component.scss</code> file:</p>
</div>
<div class="listingblock">
<div class="title">Listing 106. <code>app.component.scss</code>:</div>
<div class="content">
<pre class="highlightjs highlight"><code>...
mat-sidenav-container {
...
	a.active {
        background: #8e8d8d;
        color: #fff;

        p {
            color: #4a4a4a;
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we have a working application with a basic layout: a header with some menu and a sidenav with some navigational links.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/layout-angular-material/9-finished.png"><img src="_images/images/layout-angular-material/9-finished.png" alt="Finished application" width="700"></a>
</div>
<div class="title">Figure 66. Finished application</div>
</div>
</div>
<div class="sect3">
<h4 id="conclusion-2"><a class="anchor" href="#conclusion-2"></a>9.5. Conclusion</h4>
<div class="paragraph">
<p>The purpose of this guide was to provide a basic understanding of creating layouts with Angular Material. The Angular Material library has a huge collection of ready to use components which can be found at <a href="https://material.angular.io/components/categories" class="bare">https://material.angular.io/components/categories</a>
It has provided documentation and example usage for each of its components.  Going through the documentation will give a better understanding of using Angular Material components in our devon4ng applications.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ngrx-2"><a class="anchor" href="#ngrx-2"></a>10. NgRx</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="introduction-to-ngrx"><a class="anchor" href="#introduction-to-ngrx"></a>10.1. Introduction to NgRx</h4>
<div class="paragraph">
<p><a href="https://github.com/ngrx">NgRx</a> is a state management framework for Angular based on the <a href="https://redux.js.org/">Redux</a> pattern.</p>
</div>
</div>
<div class="sect3">
<h4 id="the-need-for-client-side-state-management"><a class="anchor" href="#the-need-for-client-side-state-management"></a>10.2. The need for client side state management</h4>
<div class="paragraph">
<p>You may wonder why you should bother with state management. Usually data resides in a back-end storage system, e.g. a database, and is retrieved by the client on a per-need basis. To add, update, or delete entities from this store, clients have to invoke API endpoints at the back-end. Mimicking database-like transactions on the client side may seem redundant. However, there are many use cases for which a global client-side state is appropriate:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the client has some kind of global state which should survive the destruction of a component, but does not warrant server side persistence, for example: volume level of media, expansion status of menus</p>
</li>
<li>
<p>sever side data should not be retrieved every time it is needed, either because multiple components consume it, or because it should be cached, e.g. the personal watchlist in an online streaming app</p>
</li>
<li>
<p>the app provides a rich experience with offline functionality, e.g. a native app built with <a href="guilde-ionic-getting-started">Ionic</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Saving global states inside the services they originates from results in a data flow that is hard to follow and state becoming inconsistent due to unordered state mutations. Following the <em>single source of truth</em> principle, there should be a central location holding all your application&#8217;s state, just like a server side database does. State management libraries for Angular provide tools for storing, retrieving, and updating client-side state.</p>
</div>
</div>
<div class="sect3">
<h4 id="why-ngrx"><a class="anchor" href="#why-ngrx"></a>10.3. Why NgRx?</h4>
<div class="paragraph">
<p>As stated in the <a href="home">introduction</a>, devon4ng does not stipulate a particular state library, or require using one at all. However, NgRx has proven to be a robust, mature solution for this task, with good tooling and 3rd-party library support. Albeit introducing a level of indirection that requires additional effort even for simple features, the Redux concept enforces a clear separation of concerns leading to a cleaner architecture.</p>
</div>
<div class="paragraph">
<p>Nonetheless, you should always compare different approaches to state management and pick the best one suiting your use case. Here&#8217;s a (non-exhaustive) list of competing state management libraries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Plain RxJS using the simple store described in <a href="cookbook-abstract-class-store">Abstract Class Store</a></p>
</li>
<li>
<p><a href="https://github.com/ngxs">NgXS</a> reduces some boilerplate of NgRx by leveraging the power of decorators and moving side effects to the store</p>
</li>
<li>
<p><a href="https://github.com/mobxjs/mobx">MobX</a> follows a more imperative approach in contrast to the functional Redux pattern</p>
</li>
<li>
<p><a href="https://github.com/datorama/akita">Akita</a> also uses an imperative approach with direct setters in the store, but keeps the concept of immutable state transitions</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="setup-5"><a class="anchor" href="#setup-5"></a>10.4. Setup</h4>
<div class="paragraph">
<p>To get a quick start, use the provided <a href="https://github.com/devonfw-forge/devon4ng-ngrx-template">template for devon4ng + NgRx</a>.</p>
</div>
<div class="paragraph">
<p>To manually install the core store package together with a set of useful extensions:</p>
</div>
<div class="paragraph">
<p>NPM:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`npm install @ngrx/store @ngrx/effects @ngrx/entity @ngrx/store-devtools --save`</pre>
</div>
</div>
<div class="paragraph">
<p>Yarn:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`yarn add @ngrx/store @ngrx/effects @ngrx/entity @ngrx/store-devtools`</pre>
</div>
</div>
<div class="paragraph">
<p>We recommend to add the NgRx schematics to your project so you can create code artifacts from the command line:</p>
</div>
<div class="paragraph">
<p>NPM:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`npm install @ngrx/schematics --save-dev`</pre>
</div>
</div>
<div class="paragraph">
<p>Yarn:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`yarn add @ngrx/schematics --dev`</pre>
</div>
</div>
<div class="paragraph">
<p>Afterwards, make NgRx your default schematics provider, so you don&#8217;t have to type the qualified package name every time:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`ng config cli.defaultCollection @ngrx/schematics`</pre>
</div>
</div>
<div class="paragraph">
<p>If you have custom settings for Angular schematics, you have to <a href="https://ngrx.io/guide/schematics">configure them as described here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="concept"><a class="anchor" href="#concept"></a>10.5. Concept</h4>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/ngrx-concept.svg"><img src="_images/images/ngrx-concept.svg" alt="NgRx Architecture"></a>
</div>
<div class="title">Figure 67. NgRx architecture overview</div>
</div>
<div class="paragraph">
<p>Figure 1 gives an overview of the NgRx data flow. The single source of truth is managed as an immutable state object by the store. Components dispatch actions to trigger state changes. Actions are handed over to reducers, which take the current state and action data to compute the next state. Actions are also consumed by-effects, which perform side-effects such as retrieving data from the back-end, and may dispatch new actions as a result. Components subscribe to state changes using selectors.</p>
</div>
<div class="paragraph">
<p>Continue with <a href="guide-ngrx-simple-store">Creating a Simple Store</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="state-selection-and-reducers"><a class="anchor" href="#state-selection-and-reducers"></a>10.6. State, Selection and Reducers</h4>

</div>
<div class="sect3">
<h4 id="creating-a-simple-store"><a class="anchor" href="#creating-a-simple-store"></a>10.7. Creating a Simple Store</h4>
<div class="paragraph">
<p>In the following pages we use the example of an online streaming service. We will model a particular feature, a watchlist that can be populated by the user with movies she or he wants to see in the future.</p>
</div>
</div>
<div class="sect3">
<h4 id="initializing-ngrx"><a class="anchor" href="#initializing-ngrx"></a>10.8. Initializing NgRx</h4>
<div class="paragraph">
<p>If you&#8217;re starting fresh, you first have to initialize NgRx and create a root state. The fastest way to do this is using the schematic:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`ng generate @ngrx/schematics:store State --root --module app.module.ts`</pre>
</div>
</div>
<div class="paragraph">
<p>This will automatically generate a root store and register it in the app module. Next we generate a feature module for the watchlist:</p>
</div>
<div class="paragraph">
<p>` ng generate module watchlist`</p>
</div>
<div class="paragraph">
<p>and create a corresponding feature store:</p>
</div>
<div class="paragraph">
<p>` ng generate store watchlist/Watchlist -m watchlist.module.ts`</p>
</div>
<div class="paragraph">
<p>This generates a file <code>watchlist/reducers/index.ts</code> with the reducer function, and registers the store in the watchlist module declaration.</p>
</div>
</div>
<div class="sect3">
<h4 id="-6"><a class="anchor" href="#-6"></a>== =</h4>
<div class="paragraph">
<p>If you&#8217;re getting an error <em>Schematic "store" not found in collection "@schematics/angular"</em>, this means you forgot to register the NgRx schematics as default.
== == =</p>
</div>
<div class="paragraph">
<p>Next, add the <code>WatchlistModule</code> to the <code>AppModule</code> imports so the feature store is registered when the application starts. We also added the <strong>store devtools</strong> which we will use later, resulting in the following file:</p>
</div>
<div class="paragraph">
<p><strong>app.module.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { BrowserModule } from '@angular/platform-browser';
import { NgModule } from '@angular/core';

import { AppComponent } from './app.component';
import { EffectsModule } from '@ngrx/effects';
import { AppEffects } from './app.effects';
import { StoreModule } from '@ngrx/store';
import { reducers, metaReducers } from './reducers';
import { StoreDevtoolsModule } from '@ngrx/store-devtools';
import { environment } from '../environments/environment';
import { WatchlistModule } from './watchlist/watchlist.module';

@NgModule({
  declarations: [
    AppComponent
  ],
  imports: [
    BrowserModule,
    WatchlistModule,
    StoreModule.forRoot(reducers, { metaReducers }),
    // Instrumentation must be imported after importing StoreModule (config is optional)
    StoreDevtoolsModule.instrument({
      maxAge: 25, // Retains last 25 states
      logOnly: environment.production, // Restrict extension to log-only mode
    }),
    !environment.production ? StoreDevtoolsModule.instrument() : []
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="create-an-entity-model-and-initial-state"><a class="anchor" href="#create-an-entity-model-and-initial-state"></a>10.9. Create an entity model and initial state</h4>
<div class="paragraph">
<p>We need a simple model for our list of movies. Create a file <code>watchlist/models/movies.ts</code> and insert the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface Movie {
    id: number;
    title: string;
    releaseYear: number;
    runtimeMinutes: number;
    genre: Genre;
}

export type Genre = 'action' | 'fantasy' | 'sci-fi' | 'romantic' | 'comedy' | 'mystery';

export interface WatchlistItem {
    id: number;
    movie: Movie;
    added: Date;
    playbackMinutes: number;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="-7"><a class="anchor" href="#-7"></a>== =</h4>
<div class="paragraph">
<p>We discourage putting several types into the same file and do this only for the sake of keeping this tutorial brief.
== == =</p>
</div>
<div class="paragraph">
<p>Later we will learn how to retrieve data from the back-end using effects. For now we will create an initial state for the user with a default movie.</p>
</div>
<div class="paragraph">
<p>State is defined and transforms by a reducer function. Let&#8217;s create a watchlist reducer:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>```
cd watchlist/reducers
ng g reducer WatchlistData --reducers index.ts
```</pre>
</div>
</div>
<div class="paragraph">
<p>Open the generated file <code>watchlist-data.reducer.ts</code>. You see three exports: The <strong>State</strong> interface defines the shape of the state. There is only one instance of a feature state in the store at all times. The <code><strong>initialState</strong></code> constant is the state at application creation time. The <strong>reducer</strong> function will later be called by the store to produce the next state instance based on the current state and an action object.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s put a movie into the user&#8217;s watchlist:</p>
</div>
<div class="paragraph">
<p><strong>watchlist-data.reducer.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface State {
  items: WatchlistItem[];
}

export const initialState: State = {
  items: [
    {
      id: 42,
      movie: {
        id: 1,
        title: 'Die Hard',
        genre: 'action',
        releaseYear: 1988,
        runtimeMinutes: 132
      },
      playbackMinutes: 0,
      added: new Date(),
    }
  ]
};</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="select-the-current-watchlist"><a class="anchor" href="#select-the-current-watchlist"></a>10.10. Select the current watchlist</h4>
<div class="paragraph">
<p>State slices can be retrieved from the store using selectors.</p>
</div>
<div class="paragraph">
<p>Create a watchlist component:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`ng g c watchlist/Watchlist`</pre>
</div>
</div>
<div class="paragraph">
<p>and add it to the exports of <code>WatchlistModule</code>. Also, replace <code>app.component.html</code> with</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;app-watchlist&gt;&lt;/app-watchlist&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>State observables are obtained using selectors. They are memoized by default, meaning that you don&#8217;t have to worry about performance if you use complicated calculations when deriving state&#8201;&#8212;&#8201;these are only performed once per state emission.</p>
</div>
<div class="paragraph">
<p>Add a selector to <code>watchlist-data.reducer.ts</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`export const getAllItems = (state: State) =&gt; state.items;`</pre>
</div>
</div>
<div class="paragraph">
<p>Next, we have to re-export the selector for this sub-state in the feature reducer. Modify the <code>watchlist/reducers/index.ts</code> like this:</p>
</div>
<div class="paragraph">
<p><strong>watchlist/reducers/index.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import {
  ActionReducer,
  ActionReducerMap,
  createFeatureSelector,
  createSelector,
  MetaReducer
} from '@ngrx/store';
import { environment } from 'src/environments/environment';
import * as fromWatchlistData from './watchlist-data.reducer';
import * as fromRoot from 'src/app/reducers/index';

export interface WatchlistState { <i class="conum" data-value="1"></i><b>(1)</b>
  watchlistData: fromWatchlistData.State;
}

export interface State extends fromRoot.State { <i class="conum" data-value="2"></i><b>(2)</b>
  watchlist: WatchlistState;
}

export const reducers: ActionReducerMap&lt;WatchlistState&gt; = { <i class="conum" data-value="3"></i><b>(3)</b>
  watchlistData: fromWatchlistData.reducer,
};

export const metaReducers: MetaReducer&lt;WatchlistState&gt;[] = !environment.production ? [] : [];

export const getFeature = createFeatureSelector&lt;State, WatchlistState&gt;('watchlist'); <i class="conum" data-value="4"></i><b>(4)</b>

export const getWatchlistData = createSelector( <i class="conum" data-value="5"></i><b>(5)</b>
  getFeature,
  state =&gt; state.watchlistData
);

export const getAllItems = createSelector( <i class="conum" data-value="6"></i><b>(6)</b>
  getWatchlistData,
  fromWatchlistData.getAllItems
);</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The feature state, each member is managed by a different reducer</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Feature states are registered by the <code>forFeature</code> method. This interface provides a typesafe path from root to feature state.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Tie sub-states of a feature state to the corresponding reducers</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Create a selector to access the 'watchlist' feature state</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>select the <code>watchlistData</code> sub state</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>re-export the selector</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note how <code>createSelector</code> allows to chain selectors. This is a powerful tool that also allows for selecting from multiple states.</p>
</div>
<div class="paragraph">
<p>You can use selectors as pipeable operators:</p>
</div>
<div class="paragraph">
<p><strong>watchlist.component.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export class WatchlistComponent {
  watchlistItems$: Observable&lt;WatchlistItem[]&gt;;

  constructor(
    private store: Store&lt;fromWatchlist.State&gt;
  ) {
    this.watchlistItems$ = this.store.pipe(select(fromWatchlist.getAllItems));
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>watchlist.component.html</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">&lt;h1&gt;Watchlist&lt;/h1&gt;
&lt;ul&gt;
    &lt;li *ngFor="let item of watchlistItems$ | async"&gt;{{item.movie.title}} ({{item.movie.releaseYear}}): {{item.playbackMinutes}}/{{item.movie.runtimeMinutes}} min watched&lt;/li&gt;
&lt;/ul&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dispatching-an-action-to-update-watched-minutes"><a class="anchor" href="#dispatching-an-action-to-update-watched-minutes"></a>10.11. Dispatching an action to update watched minutes</h4>
<div class="paragraph">
<p>We track the user&#8217;s current progress at watching a movie as the <code>playbackMinutes</code> property. After closing a video, the watched minutes have to be updated. In NgRx, state is being updated by dispatching actions. An action is an option with a (globally unique) type discriminator and an optional payload.</p>
</div>
</div>
<div class="sect3">
<h4 id="creating-the-action"><a class="anchor" href="#creating-the-action"></a>10.12. ==  Creating the action</h4>
<div class="paragraph">
<p>Create a file <code>playback/actions/index.ts</code>. In this example, we do not further separate the actions per sub state. Actions can be defined by using action creators:</p>
</div>
<div class="paragraph">
<p><strong>playback/actions/index.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { createAction, props, union } from '@ngrx/store';

export const playbackFinished = createAction('[Playback] Playback finished', props&lt;{ movieId: number, stoppedAtMinute: number }&gt;());

const actions = union({
    playbackFinished
});

export type ActionsUnion = typeof actions;</code></pre>
</div>
</div>
<div class="paragraph">
<p>First we specify the type, followed by a call to the payload definition function. Next, we create a union of all possible actions for this file using <code>union</code>, which allows us a to access action payloads in the reducer in a typesafe way.</p>
</div>
</div>
<div class="sect3">
<h4 id="-8"><a class="anchor" href="#-8"></a>== =</h4>
<div class="paragraph">
<p>Action types should follow the naming convention <code>[Source] Event</code>, e.g. <code>[Recommended List] Hide Recommendation</code> or <code>[Auth API] Login Success</code>. Think of actions rather as events than commands. You should never use the same action at two different places (you can still handle multiple actions the same way). This facilitate tracing the source of an action. For details see <a href="https://www.youtube.com/watch?v=JmnsEvoy-gY">Good Action Hygiene with NgRx</a> by Mike Ryan (video).
== == =</p>
</div>
</div>
<div class="sect3">
<h4 id="dispatch"><a class="anchor" href="#dispatch"></a>10.13. ==  Dispatch</h4>
<div class="paragraph">
<p>We skip the implementation of an actual video playback page and simulate watching a movie in 10 minute segments by adding a link in the template:</p>
</div>
<div class="paragraph">
<p><strong>watchlist-component.html</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">&lt;li *ngFor="let item of watchlistItems$ | async"&gt;... &lt;button (click)="stoppedPlayback(item.movie.id, item.playbackMinutes + 10)"&gt;Add 10 Minutes&lt;/button&gt;&lt;/li&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>watchlist-component.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import * as playbackActions from 'src/app/playback/actions';
...
  stoppedPlayback(movieId: number, stoppedAtMinute: number) {
    this.store.dispatch(playbackActions.playbackFinished({ movieId, stoppedAtMinute }));
  }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="state-reduction"><a class="anchor" href="#state-reduction"></a>10.14. ==  State reduction</h4>
<div class="paragraph">
<p>Next, we handle the action inside the <code>watchlistData</code> reducer. Note that actions can be handled by multiple reducers and effects at the same time to update different states, for example if we&#8217;d like to show a rating modal after playback has finished.</p>
</div>
<div class="paragraph">
<p><strong>watchlist-data.reducer.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export function reducer(state = initialState, action: playbackActions.ActionsUnion): State {
  switch (action.type) {
    case playbackActions.playbackFinished.type:
      return {
        ...state,
        items: state.items.map(updatePlaybackMinutesMapper(action.movieId, action.stoppedAtMinute))
      };

    default:
      return state;
  }
}

export function updatePlaybackMinutesMapper(movieId: number, stoppedAtMinute: number) {
  return (item: WatchlistItem) =&gt; {
    if (item.movie.id == movieId) {
      return {
        ...item,
        playbackMinutes: stoppedAtMinute
      };
    } else {
      return item;
    }
  };
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note how we changed the reducer&#8217;s function signature to reference the actions union. The switch-case handles all incoming actions to produce the next state. The default case handles all actions a reducer is not interested in by returning the state unchanged. Then we find the watchlist item corresponding to the movie with the given id and update the playback minutes. Since state is immutable, we have to clone all objects down to the one we would like to change using the object spread operator (<code>&#8230;&#8203;</code>).</p>
</div>
</div>
<div class="sect3">
<h4 id="-9"><a class="anchor" href="#-9"></a>== =</h4>
<div class="paragraph">
<p>Selectors rely on object identity to decide whether the value has to be recalculated. Do not clone objects that are not on the path to the change you want to make. This is why <code>updatePlaybackMinutesMapper</code> returns the same item if the movie id does not match.
== == =</p>
</div>
</div>
<div class="sect3">
<h4 id="alternative-state-mapping-with-immer"><a class="anchor" href="#alternative-state-mapping-with-immer"></a>10.15. ==  Alternative state mapping with Immer</h4>
<div class="paragraph">
<p>It can be hard to think in immutable changes, especially if your team has a strong background in imperative programming. In this case, you may find the <a href="https://github.com/immerjs/immer">Immer</a> library convenient, which allows to produce immutable objects by manipulating a proxied draft. The same reducer can then be written as:</p>
</div>
<div class="paragraph">
<p><strong>watchlist-data.reducer.ts</strong> with Immer</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { produce } from 'immer';
...
case playbackActions.playbackFinished.type:
      return produce(state, draft =&gt; {
        const itemToUpdate = draft.items.find(item =&gt; item.movie.id == action.movieId);
        if (itemToUpdate) {
          itemToUpdate.playbackMinutes = action.stoppedAtMinute;
        }
      });</code></pre>
</div>
</div>
<div class="paragraph">
<p>Immer works out of the box with plain objects and arrays.</p>
</div>
</div>
<div class="sect3">
<h4 id="redux-devtools"><a class="anchor" href="#redux-devtools"></a>10.16. ==  Redux devtools</h4>
<div class="paragraph">
<p>If the <code>StoreDevToolsModule</code> is instrumented as described above, you can use the browser extension <a href="https://github.com/reduxjs/redux-devtools">Redux devtools</a> to see all dispatched actions and the resulting state diff, as well as the current state, and even travel back in time by undoing actions.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="images/ngrx-devtools.png"><img src="_images/images/ngrx-devtools.png" alt="Redux Devtools"></a>
</div>
<div class="title">Figure 68. Redux devtools</div>
</div>
<div class="paragraph">
<p>Continue with <a href="guide-ngrx-effects">learning about effects</a></p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="side-effects-with-ngrxeffects"><a class="anchor" href="#side-effects-with-ngrxeffects"></a>10.17. Side effects with NgRx/Effects</h4>
<div class="paragraph">
<p>Reducers are pure functions, meaning they are side-effect free and deterministic. Many actions however have side effects like sending messages or displaying a toast notification. NgRx encapsulates these actions in effects.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s build a recommended movies list so the user can add movies to their watchlist.</p>
</div>
</div>
<div class="sect3">
<h4 id="obtaining-the-recommendation-list-from-the-server"><a class="anchor" href="#obtaining-the-recommendation-list-from-the-server"></a>10.18. Obtaining the recommendation list from the server</h4>
<div class="paragraph">
<p>Create a module for recommendations and add stores and states as in the previous chapter. Add <code>EffectsModule.forRoot([])</code> to the imports in <code>AppModule</code> below <code>StoreModule.forRoot()</code>. Add effects to the feature module:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ng generate effect recommendation/Recommendation -m recommendation/recommendation.module.ts</pre>
</div>
</div>
<div class="paragraph">
<p>We need actions for loading the movie list, success and failure cases:</p>
</div>
<div class="paragraph">
<p><strong>recommendation/actions/index.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">import { createAction, props, union } from '@ngrx/store';
import { Movie } from 'src/app/watchlist/models/movies';

export const loadRecommendedMovies = createAction('[Recommendation List] Load movies');
export const loadRecommendedMoviesSuccess = createAction('[Recommendation API] Load movies success', props&lt;{movies: Movie[]}&gt;());
export const loadRecommendedMoviesFailure = createAction('[Recommendation API] Load movies failure', props&lt;{error: any}&gt;());

const actions = union({
    loadRecommendedMovies,
    loadRecommendedMoviesSuccess,
    loadRecommendedMoviesFailure
});

export type ActionsUnion = typeof actions;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the reducer, we use a loading flag so the UI can show a loading spinner. The store is updated with arriving data.</p>
</div>
<div class="paragraph">
<p><strong>recommendation/actions/index.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface State {
  items: Movie[];
  loading: boolean;
}

export const initialState: State = {
  items: [],
  loading: false
};

export function reducer(state = initialState, action: recommendationActions.ActionsUnion): State {
  switch (action.type) {
    case '[Recommendation List] Load movies':
      return {
        ...state,
        items: [],
        loading: true
      };

    case '[Recommendation API] Load movies failure':
      return {
        ...state,
          loading: false
      };

    case '[Recommendation API] Load movies success':
      return {
        ...state,
        items: action.movies,
        loading: false
      };

    default:
      return state;
  }
}

export const getAll = (state: State) =&gt; state.items;
export const isLoading = (state: State) =&gt; state.loading;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We need an API service to talk to the server. For demonstration purposes, we simulate an answer delayed by one second:</p>
</div>
<div class="paragraph">
<p><code>recommendation/services/recommendation-api.service.ts</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Injectable({
  providedIn: 'root'
})
export class RecommendationApiService {

  private readonly recommendedMovies: Movie[] = [
    {
      id: 2,
      title: 'The Hunger Games',
      genre: 'sci-fi',
      releaseYear: 2012,
      runtimeMinutes: 144
    },
    {
      id: 4,
      title: 'Avengers: Endgame',
      genre: 'fantasy',
      releaseYear: 2019,
      runtimeMinutes: 181
    }
  ];

  loadRecommendedMovies(): Observable&lt;Movie[]&gt; {
    return of(this.recommendedMovies).pipe(delay(1000));
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here are the effects:</p>
</div>
<div class="paragraph">
<p><code>recommendation/services/recommendation-api.service.ts</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Injectable()
export class RecommendationEffects {

  constructor(
    private actions$: Actions,
    private recommendationApi: RecommendationApiService,
  ) { }

  @Effect()
  loadBooks$ = this.actions$.pipe(
    ofType(recommendationActions.loadRecommendedMovies.type),
    switchMap(() =&gt; this.recommendationApi.loadRecommendedMovies().pipe(
      map(movies =&gt; recommendationActions.loadRecommendedMoviesSuccess({ movies })),
      catchError(error =&gt; of(recommendationActions.loadRecommendedMoviesFailure({ error })))
    ))
  );
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Effects are always observables and return actions. In this example, we consume the actions observable provided by NgRx and listen only for the <code>loadRecommendedMovies</code> actions by using the <code>ofType</code> operator. Using <code>switchMap</code>, we map to a new observable, one that loads movies and maps the successful result to a new <code>loadRecommendedMoviesSuccess</code> action or a failure to <code>loadRecommendedMoviesFailure</code>. In a real application we would show a notification in the error case.</p>
</div>
</div>
<div class="sect3">
<h4 id="-10"><a class="anchor" href="#-10"></a>==</h4>
<div class="paragraph">
<p>If an effect should not dispatch another action, return an empty observable.
== ==</p>
</div>
<div class="paragraph">
<p><a href="guide-ngrx-entity">Continue reading how to simplify CRUD (Create Read Update Delete) operations using <code>@ngrx/entity</code></a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="simplifying-crud-with-ngrxentity"><a class="anchor" href="#simplifying-crud-with-ngrxentity"></a>10.19. Simplifying CRUD with NgRx/Entity</h4>
<div class="paragraph">
<p>Most of the time when manipulating entries in the store, we like to create, add, update, or delete entries (CRUD). NgRx/Entity provides convenience functions if each item of a collection has an id property. Luckily all our entities already have this property.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s add functionality to add a movie to the <code>watchlist</code>. First, create the required action:</p>
</div>
<div class="paragraph">
<p><strong>recommendation/actions/index.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export const addToWatchlist = createAction('[Recommendation List] Add to watchlist',
    props&lt;{ watchlistItemId: number, movie: Movie, addedAt: Date }&gt;());</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="-11"><a class="anchor" href="#-11"></a>==</h4>
<div class="paragraph">
<p>You may wonder why the Date object is not created inside the reducer instead, since it should always be the current time. However, remember that reducers should be deterministic state machines&#8201;&#8212;&#8201;State A + Action B should always result in the same State C. This makes reducers easily testable.
== ==</p>
</div>
<div class="paragraph">
<p>Then, rewrite the <code>watchlistData</code> reducer to make use of NgRx/Entity:</p>
</div>
<div class="paragraph">
<p><strong>recommendation/actions/index.ts</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export interface State extends EntityState&lt;WatchlistItem&gt; { <i class="conum" data-value="1"></i><b>(1)</b>
}

export const entityAdapter = createEntityAdapter&lt;WatchlistItem&gt;(); <i class="conum" data-value="2"></i><b>(2)</b>

export const initialState: State = entityAdapter.getInitialState(); <i class="conum" data-value="3"></i><b>(3)</b>

const entitySelectors = entityAdapter.getSelectors();

export function reducer(state = initialState, action: playbackActions.ActionsUnion | recommendationActions.ActionsUnion): State {
  switch (action.type) {
    case playbackActions.playbackFinished.type:
      const itemToUpdate = entitySelectors
      .selectAll(state) <i class="conum" data-value="4"></i><b>(4)</b>
      .find(item =&gt; item.movie.id == action.movieId);
      if (itemToUpdate) {
        return entityAdapter.updateOne({ <i class="conum" data-value="5"></i><b>(5)</b>
          id: itemToUpdate.id,
          changes: { playbackMinutes: action.stoppedAtMinute } <i class="conum" data-value="6"></i><b>(6)</b>
        }, state);
      } else {
        return state;
      }

    case recommendationActions.addToWatchlist.type:
      return entityAdapter.addOne({id: action.watchlistItemId, movie: action.movie, added: action.addedAt, playbackMinutes: 0}, state);

    default:
      return state;
  }
}


export const getAllItems = entitySelectors.selectAll;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>NgRx/Entity requires state to extend <code>EntityState</code>. It provides a list of ids and a dictionary of id &#8658; entity entries</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The entity adapter provides data manipulation operations and selectors</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The state can be initialized with <code>getInitialState()</code>, which accepts an optional object to define any additional state beyond <code>EntityState</code></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>selectAll</code> returns an array of all entities</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>All adapter operations consume the state object as the last argument and produce a new state</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Update methods accept a partial change definition; you don&#8217;t have to clone the object</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This concludes the tutorial on NgRx. If you want to learn about advanced topics such as selectors with arguments, testing, or router state, head over to the <a href="https://ngrx.io/docs">official NgRx documentation</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cookbook-2"><a class="anchor" href="#cookbook-2"></a>11. Cookbook</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="abstract-class-store"><a class="anchor" href="#abstract-class-store"></a>11.1. Abstract Class Store</h4>
<div class="paragraph">
<p>The following solution presents a base class for implementing stores which handle state and its transitions.
Working with the base class achieves:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>common API across all stores</p>
</li>
<li>
<p>logging (when activated in the constructor)</p>
</li>
<li>
<p>state transitions are asynchronous by design - sequential order problems are avoided</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Listing 107. Usage Example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">@Injectable()
export class ModalStore extends Store&lt;ModalState&gt; {

  constructor() {
    super({ isOpen: false }, !environment.production);
  }

  closeDialog() {
    this.dispatchAction('Close Dialog', (currentState) =&gt; ({...currentState, isOpen: false}));
  }

  openDialog() {
    this.dispatchAction('Open Dialog', (currentState) =&gt; ({...currentState, isOpen: true}));
  }

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 108. Abstract Base Class Store</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import { OnDestroy } from '@angular/core';
import { BehaviorSubject } from 'rxjs/BehaviorSubject';
import { Observable } from 'rxjs/Observable';
import { intersection, difference } from 'lodash';
import { map, distinctUntilChanged, observeOn } from 'rxjs/operators';
import { Subject } from 'rxjs/Subject';
import { queue } from 'rxjs/scheduler/queue';
import { Subscription } from 'rxjs/Subscription';

interface Action&lt;T&gt; {
  name: string;
  actionFn: (state: T) =&gt; T;
}

/** Base class for implementing stores. */
export abstract class Store&lt;T&gt; implements OnDestroy {

  private actionSubscription: Subscription;
  private actionSource: Subject&lt;Action&lt;T&gt;&gt;;
  private stateSource: BehaviorSubject&lt;T&gt;;
  state$: Observable&lt;T&gt;;

  /**
   * Initializes a store with initial state and logging.
   * @param initialState Initial state
   * @param logChanges When true state transitions are logged to the console.
   */
  constructor(initialState: T, public logChanges = false) {
    this.stateSource = new BehaviorSubject&lt;T&gt;(initialState);
    this.state$ = this.stateSource.asObservable();
    this.actionSource = new Subject&lt;Action&lt;T&gt;&gt;();

    this.actionSubscription = this.actionSource.pipe(observeOn(queue)).subscribe(action =&gt; {
      const currentState = this.stateSource.getValue();
      const nextState = action.actionFn(currentState);

      if (this.logChanges) {
        this.log(action.name, currentState, nextState);
      }

      this.stateSource.next(nextState);
    });
  }

  /**
   * Selects a property from the stores state.
   * Will do distinctUntilChanged() and map() with the given selector.
   * @param selector Selector function which selects the needed property from the state.
   * @returns Observable of return type from selector function.
   */
  select&lt;TX&gt;(selector: (state: T) =&gt; TX): Observable&lt;TX&gt; {
    return this.state$.pipe(
      map(selector),
      distinctUntilChanged()
    );
  }

  protected dispatchAction(name: string, action: (state: T) =&gt; T) {
    this.actionSource.next({ name, actionFn: action });
  }

  private log(actionName: string, before: T, after: T) {
    const result: { [key: string]: { from: any, to: any} } = {};
    const sameProbs = intersection(Object.keys(after), Object.keys(before));
    const newProbs = difference(Object.keys(after), Object.keys(before));
    for (const prop of newProbs) {
      result[prop] = { from: undefined, to: (&lt;any&gt;after)[prop] };
    }

    for (const prop of sameProbs) {
      if ((&lt;any&gt;before)[prop] !==  (&lt;any&gt;after)[prop]) {
        result[prop] = { from: (&lt;any&gt;before)[prop], to: (&lt;any&gt;after)[prop] };
      }
    }

    console.log(this.constructor.name, actionName, result);
  }

  ngOnDestroy() {
    this.actionSubscription.unsubscribe();
  }

}</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="add-electron-to-an-angular-application-using-angular-cli"><a class="anchor" href="#add-electron-to-an-angular-application-using-angular-cli"></a>11.2. Add Electron to an Angular application using Angular CLI</h4>
<div class="paragraph">
<p>This cookbook recipe explains how to integrate Electron in an Angular 10+ application. <a href="https://electronjs.org/">Electron</a> is a framework for creating native applications with web technologies like JavaScript, HTML, and CSS. As an example, very well known applications as Visual Studio Code, Atom, Slack or Skype (and many more) are using Electron too.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
At the moment of this writing Angular 11.2.0, Electron 11.2.3 and Electron-builder 22.9.1 were the versions available.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here are the steps to achieve this goal. Follow them in order.</p>
</div>
</div>
<div class="sect3">
<h4 id="add-electron-and-other-relevant-dependencies"><a class="anchor" href="#add-electron-and-other-relevant-dependencies"></a>11.3. Add Electron and other relevant dependencies</h4>
<div class="paragraph">
<p>There are two different approaches to add the dependencies in the <code>package.json</code> file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Writing the dependencies directly in that file.</p>
</li>
<li>
<p>Installing using <code>npm install</code> or <code>yarn add</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Please remember if the project has a <code>package-lock.json</code> or <code>yarn.lock</code> file use <code>npm</code> or <code>yarn</code> respectively.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to add the dependencies directly in the <code>package.json</code> file, include the following lines in the <code>devDependencies</code> section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"devDependencies": {
...
    "electron": "^11.2.3",
    "electron-builder": "^22.9.1",
...
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>As indicated above, instead of this <code>npm install</code> can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install -D electron electron-builder</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or with <code>yarn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn add -D electron electron-builder</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="create-the-necessary-typescript-configurations"><a class="anchor" href="#create-the-necessary-typescript-configurations"></a>11.4. Create the necessary typescript configurations</h4>
<div class="paragraph">
<p>In order to initiate electron in an angular app we need to modify the <code>tsconfig.json</code> file and create a <code>tsconfig.serve.json</code> and a <code>tsconfig.base.json</code> in the root folder.</p>
</div>
</div>
<div class="sect3">
<h4 id="tsconfig-json"><a class="anchor" href="#tsconfig-json"></a>11.5. ==  <code>tsconfig.json</code></h4>
<div class="paragraph">
<p>This file needs to be modified to create references to <code>./src/tsconfig.app.json</code> and <code>./src/tsconfig.spec.json</code> to support different configurations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "files": [],
  "references": [
    {
      "path": "./src/tsconfig.app.json"
    },
    {
      "path": "./src/tsconfig.spec.json"
    }
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tsconfig-app-json"><a class="anchor" href="#tsconfig-app-json"></a>11.6. ==  <code>tsconfig.app.json</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "extends": "../tsconfig.base.json",
  "compilerOptions": {
    "outDir": "../app",
    "module": "es2015",
    "baseUrl": "",
    "types": []
  },
  "include": [
    "**/*.ts",
  ],
  "exclude": [
    "**/*.spec.ts"
  ],
  "angularCompilerOptions": {
    "fullTemplateTypeCheck": true,
    "strictInjectionParameters": true,
    "preserveWhitespaces": true
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tsconfig-spec-json"><a class="anchor" href="#tsconfig-spec-json"></a>11.7. ==  <code>tsconfig.spec.json</code></h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "extends": "../tsconfig.base.json",
  "compilerOptions": {
    "outDir": "../spec",
    "module": "commonjs",
    "types": [
      "jasmine",
      "node"
    ]
  },
  "files": [
    "test.ts",
  ],
  "include": [
    "**/*.spec.ts",
    "**/*.d.ts"
  ],
  "exclude": [
    "dist",
    "release",
    "node_modules"
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tsconfig-base-json"><a class="anchor" href="#tsconfig-base-json"></a>11.8. ==  <code>tsconfig.base.json</code></h4>
<div class="paragraph">
<p>This is shared between <code>tsconfig.app.json</code> and <code>tsconfig.spec.json</code> and it will be extended on each config file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "compileOnSave": false,
  "compilerOptions": {
    "outDir": "./dist",
    "sourceMap": true,
    "declaration": false,
    "moduleResolution": "node",
    "emitDecoratorMetadata": true,
    "experimentalDecorators": true,
    "target": "es5",
    "typeRoots": [
      "node_modules/@types"
    ],
    "lib": [
      "es2017",
      "es2016",
      "es2015",
      "dom"
    ]
  },
  "files": [
    "electron-main.ts"
    "src/polyfills.ts"
  ],
  "include": [
    "src/**/*.d.ts"
  ],
  "exclude": [
    "node_modules"
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="tsconfig-serve-json"><a class="anchor" href="#tsconfig-serve-json"></a>11.9. ==  <code>tsconfig.serve.json</code></h4>
<div class="paragraph">
<p>In the root, <code>tsconfig.serve.json</code> needs to be created. This typescript config file is going to be used when we serve electron:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "compilerOptions": {
    "outDir": ".",
    "sourceMap": true,
    "declaration": false,
    "moduleResolution": "node",
    "emitDecoratorMetadata": true,
    "experimentalDecorators": true,
    "target": "es5",
    "typeRoots": [
      "node_modules/@types"
    ],
    "lib": [
      "es2017",
      "dom"
    ]
  },
  "include": [
    "electron-main.ts"
  ],
  "exclude": [
    "node_modules",
    "**/*.spec.ts"
  ]
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="add-electron-build-configuration"><a class="anchor" href="#add-electron-build-configuration"></a>11.10. Add Electron build configuration</h4>
<div class="paragraph">
<p>In order to configure electron builds properly we need to create a new json on our application, let&#8217;s call it electron-builder.json. For more information and fine tuning please refer to the <a href="https://www.electron.build/configuration/configuration">Electron Builder official documentation</a>.</p>
</div>
<div class="paragraph">
<p>The contents of the file will be something similar to the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "productName": "devon4ngElectron",
  "directories":{
    "output": "./builder-release"
  },
  "win": {
    "icon": "dist/assets/icons",
    "target": [
      "portable"
    ]
  },
  "mac": {
    "icon": "dist/assets/icons",
    "target": [
      "dmg"
    ]
  },
  "linux": {
    "icon": "dist/assets/icons",
    "target": [
      "AppImage"
    ]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are two important things in this files:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>"output": this is where electron builder is going to build our application</p>
</li>
<li>
<p>"icon": in every OS possible there is an icon parameter, the route to the icon folder that will be created after building with angular needs to be used here. This will make it so the electron builder can find the icons and build.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="modify-angular-json"><a class="anchor" href="#modify-angular-json"></a>11.11. Modify angular.json</h4>
<div class="paragraph">
<p><code>angular.json</code> has to to be modified so the project is build inside <em>/dist</em> without an intermediate folder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "architect": {
    "build": {
      "outputPath": "dist"
    }
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="create-the-electron-window-in-electron-main-ts"><a class="anchor" href="#create-the-electron-window-in-electron-main-ts"></a>11.12. Create the electron window in <code>electron-main.ts</code></h4>
<div class="paragraph">
<p>In order to use electron, a file needs to be created at the root of the application (<code>main.ts</code>). This file will create a window with different settings checking if we are using <code>--serve</code> as an argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import { app, BrowserWindow } from 'electron';
import * as path from 'path';
import * as url from 'url';

let win: any;
const args: any = process.argv.slice(1);
const serve: any = args.some((val) =&gt; val == '--serve');

const createWindow:any = ()=&gt;{
  // Create the browser window.
  win = new BrowserWindow({
    fullscreen: true,
    webPreferences: {
      nodeIntegration: true,
    }
  });

  if (serve) {
    require('electron-reload')(__dirname, {
      electron: require(`${__dirname}/node_modules/electron`)
    });
    win.loadURL('http://localhost:4200');
  } else {
    win.loadURL(
      url.format({
        pathname: path.join(__dirname, 'dist/index.html'),
        protocol: 'file:',
        slashes: true
      })
    );
  }

  if (serve) {
    win.webContents.openDevTools();
  }

  // Emitted when the window is closed.
  win.on('closed', () =&gt; {
    // Dereference the window object, usually you would store window
    // in an array if your app supports multi windows, this is the time
    // when you should delete the corresponding element.
    // tslint:disable-next-line:no-null-keyword
    win = null;
  });
}

try {
  // This method will be called when Electron has finished
  // initialization and is ready to create browser windows.
  // Some APIs can only be used after this event occurs.
  app.on('ready', createWindow);

   // Quit when all windows are closed.
  app.on('window-all-closed', () =&gt; {
    // On OS X it is common for applications and their menu bar
    // to stay active until the user quits explicitly with Cmd + Q
    if (process.platform !==  'darwin') {
      app.quit();
    }
  });

   app.on('activate', () =&gt; {
    // On OS X it's common to re-create a window in the app when the
    // dock icon is clicked and there are no other windows open.
    if (win == null) {
      createWindow();
    }
  });
} catch (e) {
  // Catch Error
  // throw e;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="add-the-electron-window-and-improve-the-package-json-scripts"><a class="anchor" href="#add-the-electron-window-and-improve-the-package-json-scripts"></a>11.13. Add the electron window and improve the <code>package.json</code> scripts</h4>
<div class="paragraph">
<p>Inside <code>package.json</code> the electron window that will be transformed to <code>electron-main.js</code> when building needs to be added.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  ....
  "main": "electron-main.js",
  "scripts": {...}
  ....
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>scripts</code> section in the <code>package.json</code> can be improved to avoid running too verbose commands. As a very complete example we can take a look to the My Thai Star&#8217;s <code>scripts</code> section and copy the lines useful in your project. In any case, at least we recommend to add the following lines:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">  "scripts": {
    "ng": "ng",
    "start": "ng serve",
    "build": "ng build",
    "test": "ng test",
    "lint": "ng lint",
    "e2e": "ng e2e",
    "electron:tsc": "tsc -p tsconfig.serve.json",
    "electron:run": "npm run electron:tsc &amp;&amp; ng build --base-href ./ &amp;&amp; npx electron .",
    "electron:serve": "npm run electron:tsc &amp;&amp; npx electron . --serve",
    "electron:pack": "npm run electron:tsc &amp;&amp; electron-builder --dir --config electron-builder.json",
    "electron:build": "npm run electron:tsc &amp;&amp; electron-builder --config electron-builder.json build"
  },</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>electron:</code> scripts do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>electron:tsc</code>: Compiles electron TS files.</p>
</li>
<li>
<p><code>electron:run</code>: Serves Angular app and runs electron.</p>
</li>
<li>
<p><code>electron:serve</code>: Serves electron with an already running angular app (i.e. a <code>ng serve</code> command running on another terminal).</p>
</li>
<li>
<p><code>electron:pack</code>: Packs electron app.</p>
</li>
<li>
<p><code>electron:build</code>: Builds electron app.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="add-electron-to-an-angular-application-using-nx-cli"><a class="anchor" href="#add-electron-to-an-angular-application-using-nx-cli"></a>11.14. Add Electron to an Angular application using Nx CLI</h4>
<div class="paragraph">
<p>Creating an Electron app is very easy and straight-forward if you are using Nx CLI. As a pre-requisite, you should already have an application in your Nx workspace which you want to run as a front-end in your Electron app. (You can follow <a href="https://github.com/devonfw/devon4ng/wiki/guide-creating-angular-app-with-nx-cli">this guide</a> if you want to get started with Nx).</p>
</div>
<div class="paragraph">
<p>Follow the steps below to develop an Electron app in your Nx workspace:</p>
</div>
</div>
<div class="sect3">
<h4 id="install-nx-electron"><a class="anchor" href="#install-nx-electron"></a>11.15. Install <code>nx-electron</code></h4>
<div class="paragraph">
<p>Install <code>nx-electron</code> using the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  npm install -D nx-electron</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will add the packages <code>electron</code> and <code>nx-electron</code> as dev dependencies to your Nx workspace. This will help us generate our Electron app in the next step.</p>
</div>
</div>
<div class="sect3">
<h4 id="generate-your-electron-app"><a class="anchor" href="#generate-your-electron-app"></a>11.16. Generate your Electron app</h4>
<div class="paragraph">
<p>Once you have installed <code>nx-electron</code>, you can generate your electron app using the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  nx g nx-electron:app &lt;electron-app-name&gt; --frontendProject=&lt;frontend-app-name&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>And that is it! You have generated your Electron app already. All the configuration files (<code>tsconfig.*</code>) are generated for you under &lt;electron-app-name&gt; in your Nx workspace.</p>
</div>
</div>
<div class="sect3">
<h4 id="serving-your-app"><a class="anchor" href="#serving-your-app"></a>11.17. Serving your app</h4>
<div class="paragraph">
<p>You can use this command to serve your Electron app:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  nx run-many --target=serve --projects=&lt;frontend-app-name&gt;,&lt;electron-app-name&gt; --parallel</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you see a blank application, it is because the Electron app was served before the front-end was served. To avoid this, you can serve the front-end and back-end separately, (that is, serve the back-end only after the front-end is served).</p>
</div>
</div>
<div class="sect3">
<h4 id="building-your-app"><a class="anchor" href="#building-your-app"></a>11.18. Building your app</h4>
<div class="paragraph">
<p>The command for building your Electron app in Nx is similar to the <code>serve</code> command above, you only change the target from <code>serve</code> to <code>build</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  nx run-many --target=build --projects=&lt;frontend-app-name&gt;,&lt;electron-app-name&gt; --parallel</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="packaging-your-app"><a class="anchor" href="#packaging-your-app"></a>11.19. Packaging your app</h4>
<div class="paragraph">
<p>Make sure you have build your app before you try to package it using the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  nx run &lt;electron-app-name&gt;:package [--options]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The options that can be passed can be found <a href="https://github.com/bennymeg/nx-electron/blob/master/src/builders/package/schema.json">here</a>.</p>
</div>
<div class="paragraph">
<p>You can find a working example of an Electron app in <a href="https://github.com/devonfw-sample/devon4ts-samples/tree/master/apps/angular-electron-test">devon4ts-samples</a>.</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/devon4ng.wiki/master-devon4ng.adoc - include::guide-angular-mock-service.adoc.adoc[]</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="testing-e2e-with-cypress"><a class="anchor" href="#testing-e2e-with-cypress"></a>11.20. Testing e2e with Cypress</h4>
<div class="paragraph">
<p>This guide will cover the basics of e2e testing using Cypress.</p>
</div>
<div class="paragraph">
<p>Cypress is a framework “all in one” that provides the necessary libraries to write specific e2e tests, without the need of Selenium.</p>
</div>
<div class="paragraph">
<p>Why Cypress?</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Uses JavaScript</p>
</li>
<li>
<p>It works directly with the browser so the compatibility with the front-end framework the project uses (in this case Angular) is not a problem.</p>
</li>
<li>
<p>Easy cross browser testing</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="setup-6"><a class="anchor" href="#setup-6"></a>11.21. Setup</h4>
<div class="paragraph">
<p><strong>Install</strong>
First of all we need to install it, we can use <code>npm install</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm install -D cypress</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or we can install it with <code>yarn</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn add -D cypress</code></pre>
</div>
</div>
<div class="paragraph">
<p>We need to run Cypress in order to get the folder tree downloaded, then create a <code>tsconfig.json</code> file inside <code>cypress folder</code> to add the typescript configuration.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ . /node_modules/.bin/cypress open</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 109. <code>tsconfig.json</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "compilerOptions": {
    "strict": true,
    "baseUrl": "../node_modules",
    "target": "es5",
    "lib": ["es5", "dom"],
    "types": ["cypress"]
  },
  "include": [
    "**/*.ts"
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><code>BaseUrl</code></strong></p>
</div>
<div class="paragraph">
<p>Let&#8217;s setup the base URL so when we run the tests cypress will "navigate" to the right place, go to <code>cypress.json</code> on the root of the project.</p>
</div>
<div class="listingblock">
<div class="title">Listing 110. cypress.json</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "baseUrl": "http://localhost:4200"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="files-structure"><a class="anchor" href="#files-structure"></a>11.22. Files / Structure</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">/cypress
  tsconfig.json
  /fixtures
    - example.json
  /integration
    - button.spec.ts
    - test.spec.ts
    /examples
  /plugins
    - index.js
  /support
    - commands.js
    - index.js</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>tsconfig.json</code> for typescript configuration.</p>
</div>
<div class="paragraph">
<p><code>fixtures</code> to store our mock data or files (images, mp3&#8230;&#8203;) to use on our tests.</p>
</div>
<div class="paragraph">
<p><code>integration</code> is where our tests go, by default it comes with an examples folder with tested samples.</p>
</div>
<div class="paragraph">
<p><code>plugins</code> is where the configuration files of the plugins go.</p>
</div>
<div class="paragraph">
<p><code>support</code> to add custom commands.</p>
</div>
</div>
<div class="sect3">
<h4 id="-12"><a class="anchor" href="#-12"></a>== =</h4>
<div class="paragraph">
<p>If you are using Nx, it automatically generates a e2e cypress project for every project that you generate. So you already get the configuration files like <code>tsconfig.json</code> and <code>cypress.json</code> and also get the folder structure described above. This helps you focus more on writing your tests rather than setting up Cypress.</p>
</div>
</div>
<div class="sect3">
<h4 id="-13"><a class="anchor" href="#-13"></a>11.23. == =</h4>

</div>
<div class="sect3">
<h4 id="tests"><a class="anchor" href="#tests"></a>11.24. Tests</h4>
<div class="paragraph">
<p>The structure is the same than Mocha.</p>
</div>
<div class="paragraph">
<p>First, we create a file, for example <code>form.spec.ts</code>, inside we define a context to group all our tests referred to the same subject.</p>
</div>
<div class="listingblock">
<div class="title">Listing 111. form.spec.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">context('Button page', () =&gt; {
  beforeEach(() =&gt; {
    cy.visit('/');
  });
  it('should have button',()=&gt;{
    cy.get('button').should('exist');
  });
  it('should contain PRESS',()=&gt;{
    cy.contains('button', 'PRESS');
  });
});</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title"><code>beforeEach</code></div>
<p>Visit '/' before every test.</p>
</div>
<div class="paragraph">
<div class="title">it</div>
<p>Inside we write the test.</p>
</div>
<div class="paragraph">
<p>The result:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/cypress/contextImg.jpg" alt="contextImg">
</div>
</div>
<div class="paragraph">
<p>For more info check <a href="docs.cypress.io/guides/core-concepts/writing-and-organizing-tests.html#Folder-Structure">Cypress documentation</a></p>
</div>
<div class="paragraph">
<p>On <a href="https://github.com/cypress-io/cypress-example-kitchensink">kitchensink</a>
you can find an official cypress demo with all the commands being used.</p>
</div>
</div>
<div class="sect3">
<h4 id="fixtures"><a class="anchor" href="#fixtures"></a>11.25. Fixtures</h4>
<div class="paragraph">
<p>We use fixtures to mock data, it can be a json, an image, video&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "name": "Dummy name",
  "phone": 999 99 99 99,
  "body": "Mock data"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can store multiple mocks on the same fixture file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "create":{"name": "e2etestBox"},
  "boxFruit":{
    "uuid":"3376339576e33dfb9145362426a33333",
    "name":"e2etestBox",
    "visibility":true,
    "items":[
      {"name":"apple","units":3},
      {"name":"kiwi","units":2},
    ]
  },
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To access data we don&#8217;t need to import any file, we just call <code>cy.fixture(filename)</code> inside the <code>**.spec.ts</code>. We can name it as we want.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.fixture('box.json').as('fruitBox')</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>cy.fixture('box.json')</code> we get access to <code>box.json</code>
<code>.as(fruitBox)</code> is used to create an alias <code>(fruitBox)</code> to the fixture.</p>
</div>
<div class="paragraph">
<p>For more info check <a href="https://docs.cypress.io/api/commands/fixture.html#Syntax">Fixtures documentation</a></p>
</div>
</div>
<div class="sect3">
<h4 id="request-route"><a class="anchor" href="#request-route"></a>11.26. Request / Route</h4>
<div class="paragraph">
<p>With cypress you can test your application with real data or with mocks.</p>
</div>
<div class="paragraph">
<p>Not using mocks guarantees that your tests are real e2e test but makes them vulnerable to external issues.
When you mock data you don&#8217;t know exactly if the data and the structure received from the backend is correct because you are forcing a mock on the response, but you can avoid external issues, run test faster and have better control on the structure and status.</p>
</div>
<div class="paragraph">
<p>To get more information go to <a href="https://docs.cypress.io/guides/guides/network-requests.html#Testing-Strategies">Testing Strategies</a></p>
</div>
</div>
<div class="sect3">
<h4 id="route"><a class="anchor" href="#route"></a>11.27. Route</h4>
<div class="paragraph">
<p>Cypress can intercept a XHR request and interact with it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.server();
cy.route(
  'GET',
  '/apiUrl/list',
  [{"name":"apple", "units":3},{"name":"kiwi", "units":2}]
)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>cy.server(options)</code> start a server to interact with the responses.</p>
</div>
<div class="ulist">
<div class="title"><code>cy.route(options)</code> intercepts a <code>XMLHttpRequests</code></div>
<ul>
<li>
<p>method <code>GET</code></p>
</li>
<li>
<p>URL <code>/apiUrl/list'</code></p>
</li>
<li>
<p>response <code>[{"name":"apple", "units":3},{"name":"kiwi", "units":2}]</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Waits</strong></p>
</div>
<div class="paragraph">
<p>Every cypress action has a default await time to avoid asynchronous issues, but this time can be short for some particular actions like API calls, for those cases we can use <code>cy.wait()</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.server();
cy.route('/apiUrl/list').as('list');
cy.visit('/boxList');
cy.wait('@list');</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can find more information about <code>cy.wait()</code> <a href="https://docs.cypress.io/guides/guides/network-requests.html#Waiting">here</a></p>
</div>
<div class="paragraph">
<p>To mock data with fixtures:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.fixture('box')
  .then(({boxFruit}) =&gt; {
    cy.route(
      'GET',
      '/apiUrl/list',
      boxFruit
    ).as('boxFruit');
    cy.get('#button').click();
    cy.wait('@journalsList');
    cy.get('#list').contains('apple');
  })</code></pre>
</div>
</div>
<div class="paragraph">
<p>We get <code>boxFruit</code> data from the box fixture and then we mock the API call with it so now the response of the call is <code>boxFruit</code> object.
When the button is clicked, it waits to receive the response of the call and then checks if the list contains one of the elements of the <code>fruitBox</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="request"><a class="anchor" href="#request"></a>11.28. Request</h4>
<div class="paragraph">
<p>Make a HTTP request.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.server();
cy.request('http://localhost:4200/')
  .its('body')
  .should('include', '&lt;h1&gt;Welcome to Devon4ngAngularElementsTest!&lt;/h1&gt;');</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we have <code>'http://localhost:4200'</code> as <code>baseUrl</code> on <code>cypress.json</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.server();
cy.request('/')
  .its('body')
  .should('include', '&lt;h1&gt;Welcome to Devon4ngAngularElementsTest!&lt;/h1&gt;');
// Goes to http://localhost:4200/</code></pre>
</div>
</div>
<div class="paragraph">
<p>We can add other options, like we can send the body of a form.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">cy.server();
cy.request({
  method: 'POST',
  url: '/send',
  form: true,
  body: {
    name: 'name task',
    description: 'description of the task'
  }
});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="custom-commands"><a class="anchor" href="#custom-commands"></a>11.29. Custom commands</h4>
<div class="paragraph">
<p>If you see yourself writing the same test more than once (login is a common one), you can create a custom command to make things faster.</p>
</div>
<div class="paragraph">
<p><code>Cypress.Commands.add('name', ()&#8658;{})</code> to create the test.</p>
</div>
<div class="listingblock">
<div class="title">Listing 112. commands.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">Cypress.Commands.add('checkPlaceholder', (name) =&gt; {
  cy.get(`[name='${name}']`).click();
  cy.get('mat-form-field.mat-focused').should('exist');
});</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">index.ts</div>
<p>To use the commands we need to import the files on support/index.ts</p>
</div>
<div class="listingblock">
<div class="title">Listing 113. index.ts</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">import './commands'
import './file1'
import './folder/file2'</code></pre>
</div>
</div>
<div class="paragraph">
<p>index.ts is where all our custom commands files unite so Cypress knows where to find them.</p>
</div>
<div class="paragraph">
<p>And as we are using typescript we need to define a <code>namespace</code>, <code>interface</code> and define our function.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>index.d.ts</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>declare namespace Cypress {
  interface Chainable&lt;Subject&gt; {
    checkPlaceholder(name:string):Chainable&lt;void&gt;
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Check <a href="https://docs.cypress.io/guides/tooling/typescript-support.html#Types-for-custom-commands">typescript custom commands</a></p>
</div>
</div>
<div class="sect3">
<h4 id="cross-browser-testing"><a class="anchor" href="#cross-browser-testing"></a>11.30. Cross browser testing</h4>
<div class="paragraph">
<p>By default the browser used by Cypress is Chrome, it has compatibility with it&#8217;s family browsers (including Microsoft Edge) and has beta support for Mozilla Firefox.</p>
</div>
<div class="paragraph">
<p>To change the browser on the panel we can do it by selecting the desired one on the browsers tab before running the spec file.</p>
</div>
<div class="paragraph">
<p><code>Cypress will detect and display, except electron, only the browsers that you have already installed on your machine.</code></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/cypress/browserTab.jpg" alt="browserTab">
</div>
</div>
<div class="paragraph">
<p>Once the browser is selected, you can run your tests.</p>
</div>
<div class="paragraph">
<p>To change the browser on the automatic test run, you can add a flag on the node command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cypress run --browser edge</code></pre>
</div>
</div>
<div class="paragraph">
<p>Only if we use the <code>cypress run</code> command.</p>
</div>
<div class="paragraph">
<p>Or we can change the script file.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cypress/script.js</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">const runTests= async ()=&gt;{
  ...
  const {totalFailed} = await cypress.run({browser:'edge'});
  ...
};</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://docs.cypress.io/guides/guides/cross-browser-testing.html#Continuous-Integration-Strategies">Cypress documentation</a></p>
</div>
</div>
<div class="sect3">
<h4 id="viewport"><a class="anchor" href="#viewport"></a>11.31. Viewport</h4>
<div class="paragraph">
<p>Cypress allow us to create tests depending on the Viewport, so we can test responsiveness.</p>
</div>
<div class="paragraph">
<p>There are different ways to use it:</p>
</div>
<div class="paragraph">
<p>Inside a test case</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Typescript hljs" data-lang="Typescript">it('should change title when viewport is less than 320px', ()=&gt;{
  cy.get('.title-l').should('be.visible');
  cy.get('.title-s').should('not.be.visible');
  cy.viewport(320, 480);
  cy.get('.title-l').should('not.be.visible');
  cy.get('.title-s').should('be.visible');
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Passing the configuration as an option</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Typescript hljs" data-lang="Typescript">describe('page display on medium size screen', {
  viewportHeight: 1000,
  viewportWidth: 400
}, () =&gt; {
  ...
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or we can set a default</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cypress.json</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>...
{
 "viewportHeight": 1000
 "viewportWidth": 400,
}
...</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://docs.cypress.io/api/commands/viewport.html#Syntax">Viewport documentation</a></p>
</div>
</div>
<div class="sect3">
<h4 id="test-retries"><a class="anchor" href="#test-retries"></a>11.32. Test retries</h4>
<div class="paragraph">
<p>We can get false negatives intermittently due external issues that can affect our tests, because of that we can add, in the configuration, a retries entry so Cypress can run again a certain failed test the selected number of times to verify that the error is real.</p>
</div>
<div class="paragraph">
<p>We can set retries for run or open mode.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cypress.json</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>...
"retries": {
    "runMode": 3,
    "openMode": 3
  }
...</pre>
</div>
</div>
<div class="paragraph">
<p>The retries can be configured on the <code>cypress.json</code> or directly on a specific test.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Typescript hljs" data-lang="Typescript">it('should get button', {
  retries: {
    runMode: 2,
    openMode: 2
  }
}, () =&gt; {
  ...
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>This retries those not shown on the test log.</p>
</div>
<div class="paragraph">
<p>Check more on <a href="https://docs.cypress.io/guides/guides/test-retries.html#Introduction">retries documentation</a></p>
</div>
</div>
<div class="sect3">
<h4 id="reporter"><a class="anchor" href="#reporter"></a>11.33. Reporter</h4>
<div class="paragraph">
<p>The tests results appear on the terminal, but to have a more friendly view we can add a reporter.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/cypress/reporter.jpg" alt="reporter">
</div>
</div>
</div>
<div class="sect3">
<h4 id="mochawesome"><a class="anchor" href="#mochawesome"></a>11.34. Mochawesome</h4>
<div class="paragraph">
<p>In this case we are going to use Mochawesome, initially its a Mocha reporter but as Cypress uses Mocha it works the same.</p>
</div>
<div class="paragraph">
<p><strong>Install</strong></p>
</div>
<div class="paragraph">
<p>npm</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install --save-dev mochawesome</code></pre>
</div>
</div>
<div class="paragraph">
<p>yarn</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">yarn add -D mochawesome</code></pre>
</div>
</div>
<div class="paragraph">
<p>To run the reporter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cypress run --reporter mochawesome</code></pre>
</div>
</div>
<div class="paragraph">
<p>Mochawesome saves by default the generated files on <em>`./mochawesome-report/`</em> but we can add options to change this behavior.</p>
</div>
<div class="paragraph">
<p>Options can be passed to the reporter in two ways</p>
</div>
<div class="paragraph">
<p>Using a flag</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cypress run --reporter mochawesome --reporter-options reportDir=report</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or on <em>cypress.json</em></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "baseUrl": "http://localhost:4200",
  "reporter": "mochawesome",
  "reporterOptions": {
    "overwrite": false,
    "html": false,
    "json": true,
    "reportDir": "cypress/report"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Overwrite:false</code> to not overwrite every **:spec.ts test report, we want them to create a merged version later.</p>
</div>
<div class="paragraph">
<p><code>reportDir</code> to set a custom directory.</p>
</div>
<div class="paragraph">
<p><code>html:false</code> because we don&#8217;t need it.</p>
</div>
<div class="paragraph">
<p><code>json:true</code> to save them on json.</p>
</div>
<div class="paragraph">
<p>Mochawesome only creates the html file of the last .spec.ts file that the tests run, that&#8217;s why we don&#8217;t generate html reports directly, in order to stack them all on the same final html we need to merge the reports.</p>
</div>
<div class="paragraph">
<p>Check the <a href="https://www.npmjs.com/package/mochawesome-report-generator">mochawesome documentation</a></p>
</div>
<div class="paragraph">
<p><strong><code>mochawesome-merge</code></strong></p>
</div>
<div class="paragraph">
<p><code>Mochawesome-merge</code> is a library that helps us to merge the different json.</p>
</div>
<div class="paragraph">
<p>npm</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm install --save-dev mochawesome-merge
npm install --save-dev mochawesome-report-generator</code></pre>
</div>
</div>
<div class="paragraph">
<p>yarn</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">yarn add -D mochawesome-merge
yarn add -D mochawesome-report-generator</code></pre>
</div>
</div>
<div class="paragraph">
<p>To merge the files we execute this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mochawesome-merge cypress/report/*.json &gt; cypress/reportFinal.json</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>reportFinal.json</code> is the result of this merge, whit that we have the data of all the spec files in one json.</p>
</div>
<div class="paragraph">
<p>We can also automate the test, merge and conversion to html using a script.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-TypeScript hljs" data-lang="TypeScript">const cypress = require('cypress');
const fse = require('fs-extra');
const { merge } = require('mochawesome-merge');
const generator = require('mochawesome-report-generator');
const runTests= async ()=&gt;{
  await fse.remove('mochawesome-report');
  await fse.remove('cypress/report');
  const {totalFailed} = await cypress.run();
  const reporterOptions = {
    files: ["cypress/report/*.json"]
  };
  await generateReport(reporterOptions);
  if(totalFailed !==  0){
    process.exit(2);
  };
};
const generateReport = (options)=&gt; {
  return merge(options).then((jsonReport)=&gt;{
    generator.create(jsonReport).then(()=&gt;{
      process.exit();
    });
  });
};
runTests();</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>fse.remove()</code> to remove older reports data.</p>
</div>
<div class="paragraph">
<p><code>cypress.run()</code> to run the tests.</p>
</div>
<div class="paragraph">
<p><code>merge(options)</code> we merge the <code>json</code> output from running the tests.</p>
</div>
<div class="paragraph">
<p><code>generator.create(jsonReport)</code> then we generate the html view of the report.</p>
</div>
<div class="paragraph">
<p>Check the <a href="https://www.npmjs.com/package/mochawesome-merge"><code>mochawesome-merge</code> documentation</a></p>
</div>
<div class="paragraph">
<p>On <a href="https://github.com/cypress-io/cypress-example-kitchensink">kitchensink</a>
you can find an official cypress demo with all the commands being used.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="angular-eslint-support"><a class="anchor" href="#angular-eslint-support"></a>11.35. Angular ESLint support</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
ESLint is supported in Angular 10.1.0 onward.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="what-about-tslint"><a class="anchor" href="#what-about-tslint"></a>11.36. What about TSLint?</h4>
<div class="paragraph">
<p>TSLint is a fantastic tool. It is a linter that was written specifically to work based on the TypeScript <code>AST</code> format. This has advantages and disadvantages, as with most decisions we are faced with in software engineering!</p>
</div>
<div class="paragraph">
<p>One advantage is there is no tooling required to reconcile differences between ESLint and TypeScript <code>AST</code> formats, but the major disadvantage is that the tool is therefore unable to reuse any of the previous work which has been done in the JavaScript ecosystem around linting, and it has to re-implement everything from scratch. Everything from rules to auto-fixing capabilities and more.</p>
</div>
<div class="paragraph">
<p>However, the backers behind TSLint announced in 2019 that <strong>they would be deprecating TSLint in favor of supporting</strong> <code>typescript-eslint</code> in order to benefit the community. You can read more about that <a href="https://medium.com/palantir/tslint-in-2019-1a144c2317a9">here</a></p>
</div>
<div class="paragraph">
<p>The TypeScript Team themselves also announced their plans to move the TypeScript codebase from TSLint to <code>typescript-eslint</code>, and they have been big supporters of this project. More details at <a href="https://github.com/microsoft/TypeScript/issues/30553" class="bare">https://github.com/microsoft/TypeScript/issues/30553</a></p>
</div>
<div class="paragraph">
<p>Angular ESLint support comes from the <a href="https://github.com/angular-eslint/angular-eslint">angular-eslint</a> tooling package. Angular documentation also links to this repository as you can check in the <a href="https://angular.io/cli/lint"><code>ng lint</code> section</a> of the Angular CLI documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="quick-start-with-angular-and-eslint"><a class="anchor" href="#quick-start-with-angular-and-eslint"></a>11.37. Quick start with Angular and ESLint</h4>
<div class="paragraph">
<p>In order to create a brand new Angular CLI workspace which uses ESLint instead of TSLint and Codelyzer, simply run the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">##Install the Angular CLI and @angular-eslint/schematics globally however you want (e.g. npm, yarn, volta etc)

$ npm i -g @angular/cli @angular-devkit/core @angular-devkit/schematics @angular-eslint/schematics

##Create a new Angular CLI workspace using the @angular-eslint/schematics collection (instead of the default)

$ ng new --collection=@angular-eslint/schematics</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="migrating-an-angular-cli-project-from-codelyzer-and-tslint"><a class="anchor" href="#migrating-an-angular-cli-project-from-codelyzer-and-tslint"></a>11.38. Migrating an Angular CLI project from Codelyzer and TSLint</h4>

</div>
<div class="sect3">
<h4 id="1-add-relevant-dependencies"><a class="anchor" href="#1-add-relevant-dependencies"></a>11.39. 1 - Add relevant dependencies</h4>
<div class="paragraph">
<p>The first step is to run the schematic to add <code>@angular-eslint</code> to your project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ng add @angular-eslint/schematics</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will handle installing the latest version of all the relevant packages for you and adding them to the <code>devDependencies</code> of your package.json.</p>
</div>
</div>
<div class="sect3">
<h4 id="2-run-the-convert-tslint-to-eslint-schematic-on-a-project"><a class="anchor" href="#2-run-the-convert-tslint-to-eslint-schematic-on-a-project"></a>11.40. 2 - Run the <code>convert-tslint-to-eslint</code> schematic on a project</h4>
<div class="paragraph">
<p>The next thing to do is consider which "project" you want to migrate to use ESLint. If you have a single application in your workspace you will likely have just a single entry in the projects configuration object within your <code>angular.json</code> file. If you have a <code>projects/`</code> directory in your workspace, you will have multiple entries in your <code>projects</code> configuration and you will need to chose which one you want to migrate using the <code>convert-tslint-to-eslint</code> schematic.</p>
</div>
<div class="paragraph">
<p>You can run it like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ ng g @angular-eslint/schematics:convert-tslint-to-eslint {{YOUR_PROJECT_NAME_GOES_HERE}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>From now on, <code>ng lint</code> will use ESLint!</p>
</div>
</div>
<div class="sect3">
<h4 id="3-remove-root-tslint-configuration-and-use-only-eslint"><a class="anchor" href="#3-remove-root-tslint-configuration-and-use-only-eslint"></a>11.41. 3 - Remove root TSLint configuration and use only ESLint</h4>
<div class="paragraph">
<p>Once you are happy with your ESLint setup, you simply need to remove the root-level <code>tslint.json</code> and potentially uninstall TSLint and any TSLint-related plugins/dependencies if your Angular CLI workspace is now no longer using TSLint at all.</p>
</div>
<div class="paragraph">
<p>More info at <a href="https://github.com/angular-eslint/angular-eslint" class="bare">https://github.com/angular-eslint/angular-eslint</a></p>
</div>
<div class="paragraph">
<p>==.net</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="architecture-basics"><a class="anchor" href="#architecture-basics"></a>12. Architecture basics</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="introduction-5"><a class="anchor" href="#introduction-5"></a>12.1. Introduction</h4>
<div class="paragraph">
<p>The <a href="https://devonfw.com"><em>devonfw platform</em></a> provides a solution to building applications which combine best-in-class frameworks and libraries as well as industry proven practices and code conventions.
It massively speeds up development, reduces risks and helps you to deliver better results.</p>
</div>
</div>
<div class="sect3">
<h4 id="overview-onion-design"><a class="anchor" href="#overview-onion-design"></a>12.2. Overview Onion Design</h4>
<div class="paragraph">
<p>This guide shows the overall proposed architecture in terms of separated layers making use the Onion architecture pattern. Each layers represents a logical group of components and functionality. In this guide you will learn the basics of the proposed architecture based in layers in order to develop software making use of the best practices.</p>
</div>
</div>
<div class="sect3">
<h4 id="layer-specification"><a class="anchor" href="#layer-specification"></a>12.3. Layer specification</h4>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>It is important to understand the distinction between layers and tiers. <em>Layers</em> describe the logical groupings of the functionality and components in an application; whereas <em>tiers</em> describe the physical distribution of the functionality and components on separate servers, computers, networks, or remote locations. Although both layers and tiers use the same set of names (presentation, business, services, and data), remember that only tiers imply a physical separation. It is quite common to locate more than one layer on the same physical machine (the same tier). You can think of the term tier as referring to physical distribution patterns such as two-tier, three-tier, and <em>n</em>-tier.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Layered Application Guidelines<br>
<cite>MSDN Microsoft</cite>
</div>
</div>
<div class="paragraph">
<p>The proposed architecture makes use of cooperating components called layers. To develop specific functionality each layer contains a set of components which is capable to develop such functionalities.</p>
</div>
<div class="paragraph">
<p>The next figure represents the different layers:</p>
</div>
<div id="img-t-architecture" class="imageblock">
<div class="content">
<a class="image" href="images/onion_architecture.png"><img src="_images/images/onion_architecture.png" alt="technical architecture" width="450"></a>
</div>
<div class="title">Figure 69. High level architecture representation</div>
</div>
<div class="paragraph">
<p>The layers are separated in physical tiers making use of interfaces. This pattern makes possible to be flexible in different kind of projects maximizing performance and deployment strategies (synchronous/asynchronous access, security, component deployment in different environments, microservices&#8230;&#8203;). Another important point is to provide automated unit testing or test-driven development (TDD) facilities.</p>
</div>
</div>
<div class="sect3">
<h4 id="application-layer"><a class="anchor" href="#application-layer"></a>12.4. ==  Application layer</h4>
<div class="paragraph">
<p>The <em>Application Layer</em> encapsulates the different .Net projects and its resource dependencies and manages the user interaction depending on the project&#8217;s nature.</p>
</div>
<div id="img-t-architecture" class="imageblock">
<div class="content">
<a class="image" href="images/project_nature.png"><img src="_images/images/project_nature.png" alt="technical architecture" width="850"></a>
</div>
<div class="title">Figure 70. Net application stack</div>
</div>
<div class="paragraph">
<p>The provided application template implements an dotnet API application. Also integrates by default the Swagger client. This provides the possibility to share the contract with external applications (angular, mobile apps, external services&#8230;&#8203;).</p>
</div>
</div>
<div class="sect3">
<h4 id="business-layer"><a class="anchor" href="#business-layer"></a>12.5. ==  Business layer</h4>
<div class="paragraph">
<p>The business layer implements the core functionality of the application and encapsulates the component&#8217;s logic.
This layer provides the interface between the data transformation and the application exposition. This allow the data to be optimized and ready for different data consumers.</p>
</div>
<div class="paragraph">
<p>This layer may implement for each main entity the API controller, the entity related service and other classes to support the application logic.</p>
</div>
<div class="paragraph">
<p>In order to implement the service logic, the services class must follow the next specification:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c# hljs" data-lang="c#">    public class Service&lt;TContext&gt; : IService where TContext: DbContext</code></pre>
</div>
</div>
<div class="paragraph">
<p>PE: devon4Net API template shows how to implement the TODOs service as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c# hljs" data-lang="c#">    public class TodoService: Service&lt;TodoContext&gt;, ITodoService</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <em>Service</em> is the base service class to be inherited and have full access for the <em>Unit of work</em>, <code><em>TodoContext</em></code> is the TODOs database context and <em>ITodoService</em> is the interface of the service, which exposes the public extended methods to be implemented.</p>
</div>
</div>
<div class="sect3">
<h4 id="data-layer"><a class="anchor" href="#data-layer"></a>12.6. ==  Data layer</h4>
<div class="paragraph">
<p>The data layer orchestrates the data obtained between the <em>Domain Layer</em> and the <em>Business Layer</em>. Also transforms the data to be used more efficiently between layers.</p>
</div>
<div class="paragraph">
<p>So, if a service needs the help of another service or repository, the implemented Dependency Injection is the solution to accomplish the task.</p>
</div>
<div class="paragraph">
<p>The main aim of this layer is to implement the repository for each entity. The repository&#8217;s interface is defined in the Domain layer.</p>
</div>
<div class="paragraph">
<p>In order to implement the repository logic, the repository class must follow the next specification:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c# hljs" data-lang="c#">    Repository&lt;T&gt; : IRepository&lt;T&gt; where T : class</code></pre>
</div>
</div>
<div class="paragraph">
<p>PE: devon4Net API template shows how to implement the TODOs repository as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c# hljs" data-lang="c#">    public class TodoRepository : Repository&lt;Todos&gt;, ITodoRepository</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <em>Repository</em> is the the base repository class to be inherited and have full access for the basic CRUD operations, <em>Todos</em> is the entity defined in the database context. <em>ITodoRepository</em> is the interface of the repository, which exposes the public extended methods to be implemented.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please remember that &lt;T&gt; is the mapped class which reference the entity from the database context. This abstraction allows to write services implementation with different database contexts
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="domain-layer"><a class="anchor" href="#domain-layer"></a>12.7. ==  Domain layer</h4>
<div class="paragraph">
<p>The domain layer provides access to data directly exposed from other systems. The main source is used to be a data base system. The provided template makes use of <em>Entity Framework</em> solution from Microsoft in order to achieve this functionality.</p>
</div>
<div class="paragraph">
<p>To make a good use of this technology, <em>Repository Pattern</em> has been implemented with the help of <em>Unit Of Work</em> pattern. Also, the use of generic types are makes this solution to be the most flexible.</p>
</div>
<div class="paragraph">
<p>Regarding to data base source, each entity is mapped as a class. Repository pattern allows to use this mapped classes to access the data base via Entity framework:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#"> public class UnitOfWork&lt;TContext&gt; : IUnitOfWork&lt;TContext&gt; where TContext : DbContext</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Where &lt;T&gt; is the mapped class which reference the entity from the database.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The repository and unit of work patterns are create an abstraction layer between the data access layer and the business logic layer of an application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Domain Layer has no dependencies with other layers. It contains the Entities, datasources and the Repository Interfaces.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-architecture-layer-implementation"><a class="anchor" href="#devon4net-architecture-layer-implementation"></a>12.8. devon4Net architecture layer implementation</h4>
<div class="paragraph">
<p>The next picture shows how the devon4Net API template implements the architecture described in previous points:</p>
</div>
<div id="img-t-architecture" class="imageblock">
<div class="content">
<a class="image" href="images/onion_architecture_solution.png"><img src="_images/images/onion_architecture_solution.png" alt="devon4Net api template architecture implementation" width="400"></a>
</div>
<div class="title">Figure 71. devon4Net architecture implementations</div>
</div>
</div>
<div class="sect3">
<h4 id="cross-cutting-concerns"><a class="anchor" href="#cross-cutting-concerns"></a>12.9. ==  Cross-Cutting concerns</h4>
<div class="paragraph">
<p>Cross-cutting provides the implementation functionality that spans layers. Each functionality is implemented through components able to work stand alone. This approach provides better reusability and maintainability.</p>
</div>
<div class="paragraph">
<p>A common component set of cross cutting components include different types of functionality regarding to authentication, authorization, security, caching, configuration, logging, and communication.</p>
</div>
</div>
<div class="sect3">
<h4 id="communication-between-layers-interfaces"><a class="anchor" href="#communication-between-layers-interfaces"></a>12.10. Communication between Layers: Interfaces</h4>
<div class="paragraph">
<p>The main target of the use of interfaces is to loose coupling between layers and minimize dependencies.</p>
</div>
<div class="paragraph">
<p>Public interfaces allow to hide implementation details of the components within the layers making use of dependency inversion.</p>
</div>
<div class="paragraph">
<p>In order to make this possible, we make use of <em>Dependency Injection Pattern</em> (implementation of dependency inversion) given by default in <em>.Net Core</em>.</p>
</div>
<div class="paragraph">
<p>The provided <em>Data Layer</em> contains the abstract classes to inherit from. All new repository and service classes must inherit from them, also the must implement their own interfaces.</p>
</div>
<div id="img-t-architecture" class="imageblock">
<div class="content">
<a class="image" href="images/layer_arch_detail.png"><img src="_images/images/layer_arch_detail.png" alt="technical architecture" width="750"></a>
</div>
<div class="title">Figure 72. Architecture representation in deep</div>
</div>
</div>
<div class="sect3">
<h4 id="templates"><a class="anchor" href="#templates"></a>12.11. Templates</h4>

</div>
<div class="sect3">
<h4 id="state-of-the-art"><a class="anchor" href="#state-of-the-art"></a>12.12. State of the art</h4>
<div class="paragraph">
<p>The provided bundle contains the devon4Net API template based on .net core. The template allows to create a microservice solution with minimal configuration.</p>
</div>
<div class="paragraph">
<p>Also, the devon4Net framework can be added to third party templates such as the Amazon API template to use lambdas in serverless environments.</p>
</div>
<div class="paragraph">
<p>Included features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Logging:</p>
</li>
<li>
<p>Text File</p>
</li>
<li>
<p>Sqlite database support</p>
</li>
<li>
<p>Serilog Seq Server support</p>
</li>
<li>
<p>Graylog integration ready through TCP/UDP/HTTP protocols</p>
</li>
<li>
<p>API Call params interception (simple and compose objects)</p>
</li>
<li>
<p>API error exception management</p>
</li>
<li>
<p>Swagger:</p>
</li>
<li>
<p>Swagger autogenerating client from comments and annotations on controller classes</p>
</li>
<li>
<p>Full swagger client customization (Version, Title, Description, Terms, License, Json end point definition)</p>
</li>
<li>
<p>Easy configuration with just one configuration node in your settings file</p>
</li>
<li>
<p>JWT:</p>
</li>
<li>
<p>Issuer, audience, token expiration customization by external file configuration</p>
</li>
<li>
<p>Token generation via certificate</p>
</li>
<li>
<p>MVC inherited classes to access JWT user properties</p>
</li>
<li>
<p>API method security access based on JWT Claims</p>
</li>
<li>
<p>CORS:</p>
</li>
<li>
<p>Simple CORS definition ready</p>
</li>
<li>
<p>Multiple CORS domain origin definition with specific headers and verbs</p>
</li>
<li>
<p>Headers:</p>
</li>
<li>
<p>Automatic header injection with middleware.</p>
</li>
<li>
<p>Supported header definitions: <code>AccessControlExposeHeader, StrictTransportSecurityHeader, XFrameOptionsHeader, XssProtectionHeader, XContentTypeOptionsHeader, ContentSecurityPolicyHeader, PermittedCrossDomainPoliciesHeader, ReferrerPolicyHeader</code></p>
</li>
<li>
<p>Reporting server:</p>
</li>
<li>
<p>Partial implementation of reporting server based on <code>My-FyiReporting</code> (now runs on linux container)</p>
</li>
<li>
<p>Testing:</p>
</li>
<li>
<p>Integration test template with sqlite support</p>
</li>
<li>
<p>Unit test template</p>
</li>
<li>
<p>Moq, xunit frameworks integrated</p>
</li>
<li>
<p>Circuit breaker:</p>
</li>
<li>
<p>Integrated with HttpClient factory</p>
</li>
<li>
<p>Client Certificate customization</p>
</li>
<li>
<p>Number of retries customizables</p>
</li>
<li>
<p>LiteDB:</p>
</li>
<li>
<p>Support for LiteDB</p>
</li>
<li>
<p>Provided basic repository for CRUD operations</p>
</li>
<li>
<p><code>RabbitMq</code>:</p>
</li>
<li>
<p>Use of EasyQNet library to perform CQRS main functions between different microservices</p>
</li>
<li>
<p>Send commands / Subscribe queues with one C# sentence</p>
</li>
<li>
<p>Events management: Handled received commands to subscribed messages</p>
</li>
<li>
<p>Automatic messaging backup when sent and handled (Internal database via LiteDB and database backup via Entity Framework)</p>
</li>
<li>
<p><code>MediatR</code>:</p>
</li>
<li>
<p>Use of <code>MediatR</code> library to perform CQRS main functions in memory</p>
</li>
<li>
<p>Send commands / Subscribe queues with one C# sentence</p>
</li>
<li>
<p>Events management: Handled received commands to subscribed messages</p>
</li>
<li>
<p>Automatic messaging backup when sent and handled (Internal database via LiteDB and database backup via Entity Framework)</p>
</li>
<li>
<p><code>SmaxHcm</code>:</p>
</li>
<li>
<p>Component to manage Microfocus <code>SMAX</code> for cloud infrastructure services management</p>
</li>
<li>
<p>CyberArk:</p>
</li>
<li>
<p>Manage safe credentials with CyberArk</p>
</li>
<li>
<p><code>AnsibleTower</code>:</p>
</li>
<li>
<p>Ansible automates the cloud infrastructure. devon4net integrates with Ansible Tower via API consumption endpoints</p>
</li>
<li>
<p>gRPC+Protobuf:</p>
</li>
<li>
<p>Added Client + Server basic templates sample gRPC with Google&#8217;s Protobuf protocol using devon4net</p>
</li>
<li>
<p>Kafka:</p>
</li>
<li>
<p>Added Apache Kafka support for deliver/consume messages and create/delete topics as well</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="software-stack"><a class="anchor" href="#software-stack"></a>12.13. Software stack</h4>
<div class="paragraph">
<div class="title">Technology Stack of devon4Net</div>
<p>|== == == == == == == == == == == =
|<strong>Topic</strong>|<strong>Detail</strong>|<strong>Implementation</strong>
|runtime|language &amp; VM|.Net Core Version 3.0
|<a href="guide-dataaccess-layer">persistence</a>|OR-mapper| <a href="https://msdn.microsoft.com/en-us/data/ee712907.aspx">Entity Framework Core</a>
|<a href="guide-service-layer">service</a>|<a href="guide-service-layer#rest">REST services</a>|https://www.asp.net/web-api[Web API]
|<a href="guide-service-layer">service - integration to external systems - optional</a>|<a href="guide-service-layer#soap">SOAP services</a>|https://msdn.microsoft.com/en-us/library/dd456779(v=vs.110).aspx[WCF]
|<a href="guide-logging">logging</a>|framework|https://github.com/serilog/serilog-extensions-logging[Serilog]
|<a href="guide-validation">validation</a>|framework| <a href="https://www.newtonsoft.com/jsonschema/help/html/GenerateWithDataAnnotations.htm"><code>NewtonSoft</code> Json</a>, <a href="http://www.asp.net/mvc/overview/older-versions-1/models-data/validation-with-the-data-annotation-validators-cs"><code>DataAnnotations</code></a>
|component management|<a href="guide-dependency-injection">dependency injection</a>| <a href="https://unity.codeplex.com">Unity</a>
|<a href="guide-security">security</a>|Authentication &amp; Authorization| <a href="https://jwt.io">JWT</a> <a href="https://msdn.microsoft.com/en-us/library/fkytk30f(v=vs.110).aspx">.Net Security - Token based, local Authentication Provider</a>
|unit tests|framework|https://github.com/xunit/xunit[xUnit]
|Circuit breaker|framework, allows retry pattern on http calls|https://github.com/App-vNext/Polly[Polly]
|CQRS|Memory events and queue events| <a href="https://github.com/jbogard/MediatR"><code>MediatR</code></a> - <a href="https://github.com/EasyNetQ/EasyNetQ">EasyNetQ</a> - <a href="https://github.com/confluentinc/confluent-kafka-dotnet">Kafka</a>
|Kafka| Kafka support for enterprise applications| <a href="https://github.com/confluentinc/confluent-kafka-dotnet">Confluent.Kafka</a>
|Fluent Validation| Fluent validation for class instances|https://fluentvalidation.net/[Fluent validation]
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect3">
<h4 id="target-platforms"><a class="anchor" href="#target-platforms"></a>12.14. Target platforms</h4>
<div class="paragraph">
<p>Thanks to the new .Net Core platform from Microsoft, the developed software can be published Windows, Linux, OS, X and Android platforms.</p>
</div>
</div>
<div class="sect3">
<h4 id="external-links"><a class="anchor" href="#external-links"></a>12.15. External links</h4>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/dotnet/standard/frameworks">.Net Frameworks</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/ef/">Entity Framework documentation from Microsoft</a></p>
</div>
<div class="paragraph">
<p><a href="https://swagger.io/">Swagger API tooling</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection">Dependency Injection in .NET Core</a></p>
</div>
<div class="paragraph">
<p><a href="https://jwt.io">Json Web Token</a></p>
</div>
<div class="paragraph">
<p><a href="https://github.com/xunit/xunit">Unit Testing (xUnit)</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/dotnet/core/rid-catalog">Runtime IDentifier for publishing</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="user-guide"><a class="anchor" href="#user-guide"></a>13. User guide</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div id="img-t-architecture" class="imageblock">
<div class="content">
<a class="image" href="images/devon.png"><img src="_images/images/devon.png" alt="technical architecture" width="450"></a>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-guide"><a class="anchor" href="#devon4net-guide"></a>13.1. devon4net Guide</h4>

</div>
<div class="sect3">
<h4 id="introduction-6"><a class="anchor" href="#introduction-6"></a>13.2. Introduction</h4>
<div class="paragraph">
<p>Welcome to devon4net framework user guide. In this document you will find the information regarding how to start and deploy your project using the guidelines proposed in our solution.</p>
</div>
<div class="paragraph">
<p>All the  guidelines shown and used in this document are a set of rules and conventions proposed and supported by Microsoft and the industry.</p>
</div>
</div>
<div class="sect3">
<h4 id="the-package"><a class="anchor" href="#the-package"></a>13.3. The package</h4>
<div class="paragraph">
<p><code>Devon4Net</code> package solution contains:</p>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|<strong>File / Folder</strong>|<strong>Content</strong>
|Documentation| User documentation in HTML format
|Modules| Contains the source code of the different devon4net modules
|Samples| Different samples implemented in .NET and .NET Core. Also includes My Thai Star Devon flagship restaurant application
|Templates| Main .net Core template to start developing from scratch
|License| License agreement
|README.md| Github main page
|TERMS_OF_USE.adoc| The devon4net terms of use
|LICENSE| The devon license
|Other files| Such the code of conduct and contributing guide
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect3">
<h4 id="application-templates"><a class="anchor" href="#application-templates"></a>13.4. Application templates</h4>
<div class="paragraph">
<p>The application templates given in the bundle are ready to use.</p>
</div>
<div class="paragraph">
<p>At the moment .net Core template is supported. The template is ready to be used as a simple console Kestrel application or being deployed in a web server like IIS.</p>
</div>
</div>
<div class="sect3">
<h4 id="samples"><a class="anchor" href="#samples"></a>13.5. Samples</h4>

</div>
<div class="sect3">
<h4 id="my-thai-star"><a class="anchor" href="#my-thai-star"></a>13.6. ==  My Thai Star</h4>
<div class="paragraph">
<p>You can find My Thai Star .NET port application at <a href="https://github.com/devonfw/my-thai-star/tree/develop/net">Github</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As devon4net has been migrated to the latest version of .net core, the template is not finished yet.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="cookbook-3"><a class="anchor" href="#cookbook-3"></a>13.7. Cookbook</h4>

</div>
<div class="sect3">
<h4 id="data-management"><a class="anchor" href="#data-management"></a>13.8. Data management</h4>
<div class="paragraph">
<p>To use Entity Framework Core, install the package for the database provider(s) you want to target. This walk-through uses SQL Server.</p>
</div>
<div class="paragraph">
<p>For a list of available providers see <a href="https://docs.microsoft.com/en-us/ef/core/providers/index">Database Providers</a></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to <strong>Tools &gt; NuGet Package Manager &gt; Package Manager Console</strong></p>
</li>
<li>
<p>Run <strong>Install-Package Microsoft.EntityFrameworkCore.SqlServer</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We will be using some Entity Framework Tools to create a model from the database. So we will install the tools package as well:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Run <strong>Install-Package Microsoft.EntityFrameworkCore.Tools</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We will be using some ASP.NET Core Scaffolding tools to create controllers and views later on. So we will install this design package as well:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Run <strong>Install-Package Microsoft.VisualStudio.Web.CodeGeneration.Design</strong></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="entity-framework-code-first"><a class="anchor" href="#entity-framework-code-first"></a>13.9. ==  Entity Framework Code first</h4>
<div class="paragraph">
<p>In order to design your database model from scratch, we encourage to follow the Microsoft guidelines described  <a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/complex-data-model">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="entity-framework-database-first"><a class="anchor" href="#entity-framework-database-first"></a>13.10. ==  Entity Framework Database first</h4>
<div class="ulist">
<ul>
<li>
<p>Go to <strong>Tools &gt; NuGet Package Manager &gt; Package Manager Console</strong></p>
</li>
<li>
<p>Run the following command to create a model from the existing database:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Scaffold-DbContext "Your connection string to existing database" Microsoft.EntityFrameworkCore.SqlServer -OutputDir Models</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command will create the database context and the mapped entities as well inside of Models folder.</p>
</div>
</div>
<div class="sect3">
<h4 id="register-your-context-with-dependency-injection"><a class="anchor" href="#register-your-context-with-dependency-injection"></a>13.11. ==  Register your context with dependency injection</h4>
<div class="paragraph">
<p>Services are registered with dependency injection during application startup.</p>
</div>
<div class="paragraph">
<p>In order to register your database context (or multiple database context as well) you can add the following line at ConfigureDbService method at startup.cs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>       private void SetupDatabase(IServiceCollection services)
        {
            services.SetupDatabase&lt;TodoContext&gt;(Configuration, "Default", WebAPI.Configuration.Enums.DatabaseType.InMemory);
        }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|<strong>Param</strong>|<strong>Description</strong>
|<code>TodoContext</code>| Is the database context definition
|Default| Is the connection string defined at <code><em>ConnectionString</em></code> node at the appsettings configuration file
|<code>WebAPI.Configuration.Enums.DatabaseType.InMemory</code>| Is the database driver selection. In this case <code>InMemory</code> data base is chosen
|== == == == == == == == == == == =</p>
</div>
<div class="paragraph">
<p>The supported databases are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SqlServer</p>
</li>
<li>
<p>Sqlite</p>
</li>
<li>
<p>InMemory</p>
</li>
<li>
<p>Cosmos</p>
</li>
<li>
<p>PostgreSQL</p>
</li>
<li>
<p>MySql</p>
</li>
<li>
<p>MariaDb</p>
</li>
<li>
<p>FireBird</p>
</li>
<li>
<p>Oracle</p>
</li>
<li>
<p>MSAccess</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="repositories-and-services"><a class="anchor" href="#repositories-and-services"></a>13.12. Repositories and Services</h4>
<div class="paragraph">
<p><em>Services</em> and <em>Repositories</em> are an important part of devon4net proposal. To make them work properly, first of all must be declared and injected at Startup.cs at <em>DI</em> Region.</p>
</div>
<div class="paragraph">
<p><em>Services</em> are declared in devon4net.Business.Common and injected in Controller classes when needed. Use services to build your application logic.</p>
</div>
<div id="img-t-architecture" class="imageblock">
<div class="content">
<a class="image" href="images/business_ide_ext.png"><img src="_images/images/business_ide_ext.png" alt="technical architecture" width="450"></a>
</div>
<div class="title">Figure 73. Screenshot of devon4net.Business.Common project in depth</div>
</div>
<div class="paragraph">
<p>For example, My Thai Star Booking controller constructor looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>        public BookingController(IBookingService bookingService, IMapper mapper)
        {
            BookingService = bookingService;
            Mapper = mapper;

        }</pre>
</div>
</div>
<div class="paragraph">
<p>Currently devon4net has a <em>Unit of Work</em> class in order to perform CRUD operations to database making use of your designed model context.</p>
</div>
<div class="paragraph">
<p><em>Repositories</em> are declared at <code><em>devon4net.Domain.UnitOfWork</em></code> project and make use of <em>Unit of Work</em> class.</p>
</div>
<div class="paragraph">
<p>The common methods to perform CRUD operations (where &lt;T&gt; is an entity from your model) are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Sync methods:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>IList&lt;T&gt; GetAll(Expression&lt;Func&lt;T, bool&gt;&gt; predicate = null);
T Get(Expression&lt;Func&lt;T, bool&gt;&gt; predicate = null);
IList&lt;T&gt; GetAllInclude(IList&lt;string&gt; include, Expression&lt;Func&lt;T, bool&gt;&gt; predicate = null);
T Create(T entity);
void Delete(T entity);
void DeleteById(object id);
void Delete(Expression&lt;Func&lt;T, bool&gt;&gt; where);
void Edit(T entity);</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Async methods:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Task&lt;IList&lt;T&gt;&gt; GetAllAsync(Expression&lt;Func&lt;T, bool&gt;&gt; predicate = null);
Task&lt;T&gt; GetAsync(Expression&lt;Func&lt;T, bool&gt;&gt; predicate = null);
Task&lt;IList&lt;T&gt;&gt; GetAllIncludeAsync(IList&lt;string&gt; include, Expression&lt;Func&lt;T, bool&gt;&gt; predicate = null);</pre>
</div>
</div>
<div class="paragraph">
<p>If you perform a Commit operation and an error happens, changes will be rolled back.</p>
</div>
</div>
<div class="sect3">
<h4 id="swagger-integration"><a class="anchor" href="#swagger-integration"></a>13.13. Swagger integration</h4>
<div class="paragraph">
<p>The given templates allow you to specify the API contract through Swagger integration and the controller classes are the responsible of exposing methods making use of comments in the source code.</p>
</div>
<div class="paragraph">
<p>The next example shows how to comment the method with summaries in order to define the contract. Add (Triple Slash) XML Documentation To Swagger:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/// &lt;summary&gt;
/// Method to get reservations
/// &lt;/summary&gt;
/// &lt;response code="201"&gt;Ok.&lt;/response&gt;
/// &lt;response code="400"&gt;Bad request. Parser data error.&lt;/response&gt;
/// &lt;response code="401"&gt;Unauthorized. Authentication fail.&lt;/response&gt;
/// &lt;response code="403"&gt;Forbidden. Authorization error.&lt;/response&gt;
/// &lt;response code="500"&gt;Internal Server Error. The search process ended with error.&lt;/response&gt;
[HttpPost]
[Route("/mythaistar/services/rest/bookingmanagement/v1/booking/search")]
//[Authorize(Policy = "MTSWaiterPolicy")]
[AllowAnonymous]
[EnableCors("CorsPolicy")]
public async Task&lt;IActionResult&gt; BookingSearch([FromBody]BookingSearchDto bookingSearchDto)
{</pre>
</div>
</div>
<div class="paragraph">
<p>In order to be effective and make use of the comments to build the API contract, the project which contains the controller classes must generate the XML document file. To achieve this, the XML documentation file must be checked in project settings tab:</p>
</div>
<div id="img-t-architecture" class="imageblock">
<div class="content">
<a class="image" href="images/project_doc.png"><img src="_images/images/project_doc.png" alt="technical architecture" width="450"></a>
</div>
<div class="title">Figure 74. Project settings tab</div>
</div>
<div class="paragraph">
<p>We propose to generate the file under the <code>XmlDocumentation</code> folder. For example in devon4net.Domain.Entities project in My Thai Star .NET implementation the output folder is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`XmlDocumentation\devon4net.Business.Common.xml`</pre>
</div>
</div>
<div class="paragraph">
<p>The file <em>devon4net.Business.Common.xml</em> won&#8217;t appear until you build the project. Once the file is generated, please modify its properties as a resource and set it to be <em>Copy always</em> .</p>
</div>
<div id="img-t-architecture" class="imageblock">
<div class="content">
<a class="image" href="images/doc_copy_always.png"><img src="_images/images/doc_copy_always.png" alt="technical architecture" width="450"></a>
</div>
<div class="title">Figure 75. Swagger XML document file properties</div>
</div>
<div class="paragraph">
<p>Once you have this, the swagger user interface will show the method properties defined in your controller comments.</p>
</div>
<div class="paragraph">
<p>Making use of this technique controller are not encapsulated to the application project. Also, you can develop your controller classes in different projects obtain code reusability.</p>
</div>
<div class="paragraph">
<p>Swagger comment:</p>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|<strong>Comment</strong>|<strong>Functionality</strong>
|&lt;summary&gt;| Will map to the operation&#8217;s summary
|&lt;remarks&gt;| Will map to the operation&#8217;s description (shown as "Implementation Notes" in the UI)
|&lt;response code="###"&gt;| Specifies the different response of the target method
|&lt;param&gt;| Will define the parameter(s) of the target method
|
|== == == == == == == == == == == =</p>
</div>
<div class="paragraph">
<p>Please check <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/xmldoc/recommended-tags-for-documentation-comments">Microsoft&#8217;s site</a> regarding to summary notations.</p>
</div>
</div>
<div class="sect3">
<h4 id="logging-module"><a class="anchor" href="#logging-module"></a>13.14. Logging module</h4>
<div class="paragraph">
<p>An important part of life software is the need of using log and traces. devon4net has a log module pre-configured to achieve this important point.</p>
</div>
<div class="paragraph">
<p>By default Microsoft provides a logging module on .NET Core applications. This module is open and can it can be extended. devon4net uses the <a href="https://serilog.net/">Serilog</a> implementation. This implementation provides a huge quantity information about events and traces.</p>
</div>
</div>
<div class="sect3">
<h4 id="log-file"><a class="anchor" href="#log-file"></a>13.15. ==  Log file</h4>
<div class="paragraph">
<p>devon4net can write the log information to a simple text file. You can configure the file name and folder at appsettings.json file (<code>LogFile</code> attribute) at devon4net.Application.WebApi project.</p>
</div>
</div>
<div class="sect3">
<h4 id="database-log"><a class="anchor" href="#database-log"></a>13.16. ==  Database log</h4>
<div class="paragraph">
<p>devon4net can write the log information to a SQLite database. You can configure the file name and folder at appsettings.json file (<code>LogDatabase</code> attribute) at devon4net.Application.WebApi project.</p>
</div>
<div class="paragraph">
<p>With this method you can launch queries in order to search the information you are looking for.</p>
</div>
</div>
<div class="sect3">
<h4 id="seq-log"><a class="anchor" href="#seq-log"></a>13.17. ==  Seq log</h4>
<div class="paragraph">
<p>devon4net can write the log information to a Serilog server. You can configure the Serilog URL at appsettings.json file <code>(SeqLogServerUrl attribute)</code> at devon4net.Application.WebApi project.</p>
</div>
<div class="paragraph">
<p>With this method you can make queries via HTTP.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/serilog_seq.png"><img src="_images/images/serilog_seq.png" alt="serilog seq"></a>
</div>
</div>
<div class="paragraph">
<p>By default you can find the log information at <em>Logs</em> folder.</p>
</div>
</div>
<div class="sect3">
<h4 id="jwt-module"><a class="anchor" href="#jwt-module"></a>13.18. JWT module</h4>
<div class="paragraph">
<p>JSON Web Tokens are an open, industry standard RFC 7519 method for representing claims securely between two parties allowing you to decode, verify and generate JWT.</p>
</div>
<div class="paragraph">
<p>You should use JWT for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Authentication : allowing the user to access routes, services, and resources that are permitted with that token.</p>
</li>
<li>
<p>Information Exchange: JSON Web Tokens are a good way of securely transmitting information between parties.  Additionally, as the signature is calculated using the header and the payload, you can also verify that the content.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The JWT module is configured at Startup.cs inside devon4net.Application.WebApi project from .NET Core template. In this class you can configure the different authentication policy and JWT properties.</p>
</div>
<div class="paragraph">
<p>Once the user has been authenticated, the client perform the call to the backend with the attribute <em>Bearer</em> plus the token generated at server side.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/jwt.png"><img src="_images/images/jwt.png" alt="jwt"></a>
</div>
</div>
<div class="paragraph">
<p>On My Thai Star sample there are two predefined users: user0 and Waiter. Once they log in the application, the client (Angular/Xamarin) will manage the server call with the json web token. With this method we can manage the server authentication and authorization.</p>
</div>
<div class="paragraph">
<p>You can find more information about JWT at  <a href="https://jwt.io">jwt.io</a></p>
</div>
</div>
<div class="sect3">
<h4 id="aop-module"><a class="anchor" href="#aop-module"></a>13.19. AOP module</h4>
<div class="paragraph">
<p>AOP (Aspect Oriented Programming) tracks all information when a method is call.<code>AOP</code> also tracks the input and output data when a method is call.</p>
</div>
<div class="paragraph">
<p>By default devon4net has <code>AOP</code> module pre-configured and activated for controllers at Startup.cs file at devon4net.Application.WebApi:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>options.Filters.Add(new Infrastructure.AOP.AopControllerAttribute(Log.Logger));

options.Filters.Add(new Infrastructure.AOP.AopExceptionFilter(Log.Logger));</pre>
</div>
</div>
<div class="paragraph">
<p>This configuration allows all Controller classes to be tracked. If you don&#8217;t need to track the info comment the lines written before.</p>
</div>
</div>
<div class="sect3">
<h4 id="docker-support"><a class="anchor" href="#docker-support"></a>13.20. Docker support</h4>
<div class="paragraph">
<p>devon4net Core projects are ready to be integrated with docker.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/devonfw/my-thai-star/tree/develop/net">My Thai Star application</a> sample is ready to be use with linux docker containers. The Readme file explains how to launch and setup the sample application.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>angular</strong> : Angular client to support backend. Just binaries.</p>
</li>
<li>
<p><strong>database</strong> : Database scripts and .bak file</p>
</li>
<li>
<p><strong>mailservice</strong>: Microservice implementation to send notifications.</p>
</li>
<li>
<p><strong>netcore</strong>: Server side using .net core 2.0.x.</p>
</li>
<li>
<p><strong>xamarin</strong>: Xamarin client based on Excalibur framework from The Netherlands using XForms.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Docker configuration and docker-compose files are provided.</p>
</div>
</div>
<div class="sect3">
<h4 id="testing-with-xunit"><a class="anchor" href="#testing-with-xunit"></a>13.21. Testing with XUnit</h4>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>xUnit.net is a free, open source, community-focused unit testing tool for the .NET Framework. Written by the original inventor of NUnit v2, xUnit.net is the latest technology for unit testing C#, F#, VB.NET and other .NET languages. xUnit.net works with <code>ReSharper</code>, <code>CodeRush</code>, <code>TestDriven.NET</code> and Xamarin. It is part of the .NET Foundation, and operates under their code of conduct. It is licensed under Apache 2 (an OSI approved license).</p>
</div>
</blockquote>
<div class="attribution">
&#8212; About xUnit.net<br>
<cite>https://xunit.github.io/#documentation</cite>
</div>
</div>
<div class="paragraph">
<p><em>Facts</em> are tests which are always true. They test invariant conditions.</p>
</div>
<div class="paragraph">
<p><em>Theories</em> are tests which are only true for a particular set of data.</p>
</div>
</div>
<div class="sect3">
<h4 id="the-first-test"><a class="anchor" href="#the-first-test"></a>13.22. The first test</h4>
<div class="listingblock">
<div class="content">
<pre>using Xunit;

namespace MyFirstUnitTests
{
    public class Class1
    {
        [Fact]
        public void PassingTest()
        {
            Assert.Equal(4, Add(2, 2));
        }

        [Fact]
        public void FailingTest()
        {
            Assert.Equal(5, Add(2, 2));
        }

        int Add(int x, int y)
        {
            return x + y;
        }
    }
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="the-first-test-with-theory"><a class="anchor" href="#the-first-test-with-theory"></a>13.23. The first test with theory</h4>
<div class="paragraph">
<p><em>Theory</em> attribute is used to create tests with input params:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[Theory]
[InlineData(3)]
[InlineData(5)]
[InlineData(6)]
public void MyFirstTheory(int value)
{
    Assert.True(IsOdd(value));
}

bool IsOdd(int value)
{
    return value % 2 ==  1;
}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="cheat-sheet"><a class="anchor" href="#cheat-sheet"></a>13.24. Cheat Sheet</h4>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|Operation| Example
|Test|</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public void Test()
{
}
|Setup|public class TestFixture {
public TestFixture()
{

...

    }

}
|Teardown|public class TestFixture : IDisposable

{

public void Dispose() {

 ...
 }

}</pre>
</div>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect3">
<h4 id="console-runner-return-codes"><a class="anchor" href="#console-runner-return-codes"></a>13.25. Console runner return codes</h4>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|Code| Meaning
|0|The tests ran successfully.
|1|One or more of the tests failed.
|2|The help page was shown, either because it was requested, or because the user did not provide any command line arguments.
|3|	There was a problem with one of the command line options passed to the runner.
|4|There was a problem loading one or more of the test assemblies (for example, if a 64-bit only assembly is run with the 32-bit test runner).
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect3">
<h4 id="publishing"><a class="anchor" href="#publishing"></a>13.26. Publishing</h4>

</div>
<div class="sect3">
<h4 id="nginx"><a class="anchor" href="#nginx"></a>13.27. ==  Nginx</h4>
<div class="paragraph">
<p>In order to deploy your application to a Nginx server on Linux platform you can follow the instructions from <em>Microsoft</em> <a href="./offline/nginx.html">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="iis"><a class="anchor" href="#iis"></a>13.28. ==  IIS</h4>
<div class="paragraph">
<p>In this point is shown the configuration options that must implement the .Net Core application.</p>
</div>
<div class="paragraph">
<p>Supported operating systems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Windows 7 and newer</p>
</li>
<li>
<p>Windows Server 2008 R2 and newer*</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>WebListener</code> server will not work in a reverse-proxy configuration with IIS. You must use the <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/servers/kestrel?tabs=aspnetcore2x">Kestrel server</a>.</p>
</div>
<div class="paragraph">
<p><span class="underline">IIS configuration</span></p>
</div>
<div class="paragraph">
<p>Enable the Web Server (IIS) role and establish role services.</p>
</div>
<div class="paragraph">
<p><strong>Windows desktop operating systems</strong></p>
</div>
<div class="paragraph">
<p>Navigate to Control Panel &gt; Programs &gt; Programs and Features &gt; Turn Windows features on or off (left side of the screen). Open the group for Internet Information Services and Web Management Tools. Check the box for IIS Management Console. Check the box for World Wide Web Services. Accept the default features for World Wide Web Services or customize the IIS features to suit your needs.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/iis_1.png"><img src="_images/images/iis_1.png" alt="iis 1"></a>
</div>
</div>
<div class="paragraph">
<p>*Conceptually, the IIS configuration described in this document also applies to hosting ASP.NET Core applications on Nano Server IIS, but refer to ASP.NET Core with IIS on Nano Server for specific instructions.</p>
</div>
<div class="paragraph">
<p><strong>Windows Server operating systems</strong>
For server operating systems, use the Add Roles and Features wizard via the Manage menu or the link in Server Manager. On the Server Roles step, check the box for Web Server (IIS).</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/iis_2.png"><img src="_images/images/iis_2.png" alt="iis 2"></a>
</div>
</div>
<div class="paragraph">
<p>On the Role services step, select the IIS role services you desire or accept the default role services provided.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/iis_3.png"><img src="_images/images/iis_3.png" alt="iis 3"></a>
</div>
</div>
<div class="paragraph">
<p>Proceed through the Confirmation step to install the web server role and services. A server/IIS restart is not required after installing the Web Server (IIS) role.</p>
</div>
<div class="paragraph">
<p><span class="underline">Install the .NET Core Windows Server Hosting bundle</span></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install the .NET Core Windows Server Hosting bundle on the hosting system. The bundle will install the .NET Core Runtime, .NET Core Library, and the ASP.NET Core Module. The module creates the reverse-proxy between IIS and the Kestrel server. Note: If the system doesn&#8217;t have an Internet connection, obtain and install the Microsoft Visual C++ 2015 Re-distributable before installing the .NET Core Windows Server Hosting bundle.</p>
</li>
<li>
<p>Restart the system or execute net stop was /y followed by net start w3svc from a command prompt to pick up a change to the system <code>PATH</code>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you use an IIS Shared Configuration, see ASP.NET Core Module with IIS Shared Configuration.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To configure IISIntegration service options, include a service configuration for IISOptions in <code>ConfigureServices</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c# hljs" data-lang="c#">services.Configure&lt;IISOptions&gt;(options =&gt;
{
    ...
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|Option|Default|Setting
|<code>AutomaticAuthentication</code>| true |If true, the authentication middleware sets the <code>HttpContext.User</code> and responds to generic challenges. If false, the authentication middleware only provides an identity (<code>HttpContext.User</code>) and responds to challenges when explicitly requested by the Authentication Scheme. Windows Authentication must be enabled in IIS for <code>AutomaticAuthentication</code> to function.
|<code>AuthenticationDisplayName</code> | null| 	Sets the display name shown to users on login pages.
|<code>ForwardClientCertificate</code> |true|If true and the <code>MS-ASPNETCORE-CLIENTCERT</code> request header is present, the <code>HttpContext.Connection.ClientCertificate</code> is populated.
|== == == == == == == == == == == =</p>
</div>
<div class="paragraph">
<p><span class="underline">web.config</span></p>
</div>
<div class="paragraph">
<p>The web.config file configures the ASP.NET Core Module and provides other IIS configuration. Creating, transforming, and publishing web.config is handled by Microsoft.NET.Sdk.Web, which is included when you set your project&#8217;s SDK at the top of your .csproj file, &lt;Project Sdk="Microsoft.NET.Sdk.Web"&gt;. To prevent the <code>MSBuild</code> target from transforming your web.config file, add the <code>&lt;IsTransformWebConfigDisabled&gt;</code> property to your project file with a setting of true:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;PropertyGroup&gt;
  &lt;IsTransformWebConfigDisabled&gt;true&lt;/IsTransformWebConfigDisabled&gt;
&lt;/PropertyGroup&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="azure"><a class="anchor" href="#azure"></a>13.29. ==  Azure</h4>
<div class="paragraph">
<p>In order to deploy your application to Azure platform you can follow the instructions from <em>Microsoft</em>:</p>
</div>
<div class="paragraph">
<p><strong>Set up the development environment</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Install the latest&nbsp;<a href="https://www.visualstudio.com/vs/azure-tools/">Azure SDK for Visual Studio</a>. The SDK installs Visual Studio if you don&#8217;t already have it.</p>
</li>
<li>
<p>Verify your&nbsp;<a href="https://portal.azure.com/">Azure account</a>. You can&nbsp;<a href="https://azure.microsoft.com/pricing/free-trial/">open a free Azure account</a>&nbsp;or&nbsp;<a href="https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/">Activate Visual Studio subscriber benefits</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Create a web app</strong></p>
</div>
<div class="paragraph">
<p>In the Visual Studio Start Page, select&nbsp;<strong>File &gt; New &gt; Project&#8230;&#8203;</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/file_new_project.png" alt="File menu">
</div>
</div>
<div class="paragraph">
<p>Complete the&nbsp;<strong>New Project</strong>&nbsp;dialog:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the left pane, select&nbsp;<strong>.NET Core</strong>.</p>
</li>
<li>
<p>In the center pane, select&nbsp;<strong>ASP.NET Core Web Application</strong>.</p>
</li>
<li>
<p>Select&nbsp;<strong>OK</strong>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/new_prj.png" alt="New Project dialog">
</div>
</div>
<div class="paragraph">
<p>In the&nbsp;<strong>New ASP.NET Core Web Application</strong>&nbsp;dialog:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select&nbsp;<strong>Web Application</strong>.</p>
</li>
<li>
<p>Select&nbsp;<strong>Change Authentication</strong>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/new_prj_2.png" alt="New Project dialog">
</div>
</div>
<div class="paragraph">
<p>The&nbsp;<strong>Change Authentication</strong>&nbsp;dialog appears.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select&nbsp;<strong>Individual User Accounts</strong>.</p>
</li>
<li>
<p>Select&nbsp;<strong>OK</strong>&nbsp;to return to the&nbsp;<strong>New ASP.NET Core Web Application</strong>, then select&nbsp;<strong>OK</strong>&nbsp;again.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/new_prj_auth.png" alt="New ASP.NET Core Web authentication dialog">
</div>
</div>
<div class="paragraph">
<p>Visual Studio creates the solution.</p>
</div>
<div class="paragraph">
<p><strong>Run the app locally</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Choose&nbsp;<strong>Debug</strong>&nbsp;then&nbsp;<strong>Start Without Debugging</strong>&nbsp;to run the app locally.</p>
</li>
<li>
<p>Click the&nbsp;<strong>About</strong>&nbsp;and&nbsp;<strong>Contact</strong>&nbsp;links to verify the web application works.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/show.png" alt="Web application open in Microsoft Edge on localhost">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select&nbsp;<strong>Register</strong>&nbsp;and register a new user. You can use a fictitious email address. When you submit, the page displays the following error:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>"Internal Server Error: A database operation failed while processing the request. SQL exception: Cannot open the database. Applying existing migrations for Application DB context may resolve this issue."</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select&nbsp;<strong>Apply Migrations</strong>&nbsp;and, once the page updates, refresh the page.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="offline/azure_files/mig.png" alt="Internal Server Error: A database operation failed while processing the request. SQL exception: Cannot open the database. Applying existing migrations for Application DB context may resolve this issue.">
</div>
</div>
<div class="paragraph">
<p>The app displays the email used to register the new user and a&nbsp;<strong>Log out</strong>&nbsp;link.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/hello.png" alt="Web application open in Microsoft Edge. The Register link is replaced by the text Hello email@domain.com!">
</div>
</div>
<div class="paragraph">
<p><strong>Deploy the app to Azure</strong></p>
</div>
<div class="paragraph">
<p>Close the web page, return to Visual Studio, and select&nbsp;<strong>Stop Debugging</strong>&nbsp;from the&nbsp;<strong>Debug</strong>&nbsp;menu.</p>
</div>
<div class="paragraph">
<p>Right-click on the project in Solution Explorer and select&nbsp;<strong>Publish&#8230;&#8203;</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/pub.png" alt="Contextual menu open with Publish link highlighted">
</div>
</div>
<div class="paragraph">
<p>In the&nbsp;<strong>Publish</strong>&nbsp;dialog, select&nbsp;<strong>Microsoft Azure App Service</strong>&nbsp;and click&nbsp;<strong>Publish</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/maas1.png" alt="Publish dialog">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Name the app a unique name.</p>
</li>
<li>
<p>Select a subscription.</p>
</li>
<li>
<p>Select&nbsp;<strong>New&#8230;&#8203;</strong>&nbsp;for the resource group and enter a name for the new resource group.</p>
</li>
<li>
<p>Select&nbsp;<strong>New&#8230;&#8203;</strong>&nbsp;for the app service plan and select a location near you. You can keep the name that is generated by default.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/newrg1.png" alt="App Service dialog">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the&nbsp;<strong>Services</strong>&nbsp;tab to create a new database.</p>
</li>
<li>
<p>Select the green&nbsp;<strong>+</strong>&nbsp;icon to create a new SQL Database</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/sql.png" alt="New SQL Database">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select&nbsp;<strong>New&#8230;&#8203;</strong>&nbsp;on the&nbsp;<strong>Configure SQL Database</strong>&nbsp;dialog to create a new database.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/conf.png" alt="New SQL Database and server">
</div>
</div>
<div class="paragraph">
<p>The&nbsp;<strong>Configure SQL Server</strong>&nbsp;dialog appears.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enter an administrator user name and password, and then select&nbsp;<strong>OK</strong>. Don&#8217;t forget the user name and password you create in this step. You can keep the default&nbsp;<strong>Server Name</strong>.</p>
</li>
<li>
<p>Enter names for the database and connection string.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="note"><a class="anchor" href="#note"></a>13.30. == Note</h4>
<div class="paragraph">
<p>"admin" is not allowed as the administrator user name.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/conf_servername.png" alt="Configure SQL Server dialog">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select&nbsp;<strong>OK</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Visual Studio returns to the&nbsp;<strong>Create App Service</strong>&nbsp;dialog.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select&nbsp;<strong>Create</strong>&nbsp;on the&nbsp;<strong>Create App Service</strong>&nbsp;dialog.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/azure_files/conf_final.png" alt="Configure SQL Database dialog">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Click the&nbsp;<strong>Settings</strong>&nbsp;link in the&nbsp;<strong>Publish</strong>&nbsp;dialog.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/pubc.png" alt="Publish dialog: Connection panel">
</div>
</div>
<div class="paragraph">
<p>On the&nbsp;<strong>Settings</strong>&nbsp;page of the&nbsp;<strong>Publish</strong>&nbsp;dialog:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Expand&nbsp;<strong>Databases</strong>&nbsp;and check&nbsp;<strong>Use this connection string at runtime</strong>.</p>
</li>
<li>
<p>Expand&nbsp;<strong>Entity Framework Migrations</strong>&nbsp;and check&nbsp;<strong>Apply this migration on publish</strong>.</p>
</li>
<li>
<p>Select&nbsp;<strong>Save</strong>. Visual Studio returns to the&nbsp;<strong>Publish</strong>&nbsp;dialog.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/pubs.png" alt="Publish dialog: Settings panel">
</div>
</div>
<div class="paragraph">
<p>Click&nbsp;<strong>Publish</strong>. Visual Studio will publish your app to Azure and launch the cloud app in your browser.</p>
</div>
<div class="paragraph">
<p><strong>Test your app in Azure</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Test the&nbsp;<strong>About</strong>&nbsp;and&nbsp;<strong>Contact</strong>&nbsp;links</p>
</li>
<li>
<p>Register a new user</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/register.png" alt="Web application opened in Microsoft Edge on Azure App Service">
</div>
</div>
<div class="paragraph">
<p><strong>Update the app</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Edit <code>the&nbsp;<em>Pages/About.cshtml</em>&nbsp;Razor</code> page and change its contents. For example, you can modify the paragraph to say "Hello ASP.NET Core!":</p>
<div class="literalblock">
<div class="content">
<pre>html&lt;button class="action copy" data-bi-name="copy"&gt;Copy&lt;/button&gt;</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c# hljs" data-lang="c#">@page
@model AboutModel
@{
    ViewData["Title"] = "About";
}
&lt;h2&gt;@ViewData["Title"]&lt;/h2&gt;
&lt;h3&gt;@Model.Message&lt;/h3&gt;

    &lt;p&gt;Hello ASP.NET Core!&lt;/p&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Right-click on the project and select&nbsp;<strong>Publish&#8230;&#8203;</strong>&nbsp;again.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/pub.png" alt="Contextual menu open with Publish link highlighted">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>After the app is published, verify the changes you made are available on Azure.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/final.png" alt="Verify task is complete">
</div>
</div>
<div class="paragraph">
<p><strong>Clean up</strong></p>
</div>
<div class="paragraph">
<p>When you have finished testing the app, go to the&nbsp;<a href="https://portal.azure.com/">Azure portal</a>&nbsp;and delete the app.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select&nbsp;<strong>Resource groups</strong>, then select the resource group you created.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/portalrg.png" alt="Azure Portal: Resource Groups in sidebar menu">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>In the&nbsp;<strong>Resource groups</strong>&nbsp;page, select&nbsp;<strong>Delete</strong>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/offline/azure_files/rgd.png" alt="Azure Portal: Resource Groups page">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Enter the name of the resource group and select&nbsp;<strong>Delete</strong>. Your app and all other resources created in this tutorial are now deleted from Azure.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="external-links-2"><a class="anchor" href="#external-links-2"></a>13.31. External links</h4>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/publishing/iis?tabs=aspnetcore2x">Publishing .Net Core on IIS</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/hosting/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration">IIS Shared configuration</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/publishing/linuxproduction?tabs=aspnetcore2x">Publishing to Nginx</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/publishing/docker">Publishing to Docker</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/ef/core/miscellaneous/connection-strings">Connection strings</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/ef/core/get-started/aspnetcore/new-db#create-the-model">Entity Framework basics</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/complex-data-model">Entity framework advanced design</a></p>
</div>
<div class="paragraph">
<p><a href="https://github.com/domaindrivendev/Swashbuckle.AspNetCore#include-descriptions-from-xml-comments">Swagger annotations</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/xmldoc/recommended-tags-for-documentation-comments">Summary notation</a></p>
</div>
<div class="paragraph">
<p><a href="https://jwt.io/">JWT Official Site</a></p>
</div>
<div class="paragraph">
<p><a href="https://serilog.net/">Serilog</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="how-to-section"><a class="anchor" href="#how-to-section"></a>14. How To section</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="introduction-7"><a class="anchor" href="#introduction-7"></a>14.1. Introduction</h4>
<div class="paragraph">
<p>The aim of this document is to show  how to get devon4net things done in a easy way.</p>
</div>
</div>
<div class="sect3">
<h4 id="how-to"><a class="anchor" href="#how-to"></a>14.2. How to</h4>

</div>
<div class="sect3">
<h4 id="start-a-new-devonfw-project"><a class="anchor" href="#start-a-new-devonfw-project"></a>14.3. Start a new devonfw project</h4>
<div class="paragraph">
<p>The <em>.Net Core 3.1</em> template allows you to start developing an n-layer server application to provide the latest features. The template can be used in Visual Studio Code and Visual Studio 2019.</p>
</div>
<div class="paragraph">
<p>The application result can be deployed as a console application, microservice or web page.</p>
</div>
<div class="paragraph">
<p>To start developing with devon4Net template, please follow this instructions:</p>
</div>
</div>
<div class="sect3">
<h4 id="using-devon4net-template"><a class="anchor" href="#using-devon4net-template"></a>14.4. ==  Using devon4Net template</h4>

</div>
<div class="sect3">
<h4 id="option-1"><a class="anchor" href="#option-1"></a>14.5. ==  Option 1</h4>
<div class="listingblock">
<div class="content">
<pre>Open your favourite terminal (Win/Linux/iOS)
Go to future project's path
Type dotnet new --install Devon4Net.WebAPI.Template
Type dotnet new Devon4NetAPI
Go to project's path
You are ready to start developing with devon4Net</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="option-2"><a class="anchor" href="#option-2"></a>14.6. ==  Option 2</h4>
<div class="listingblock">
<div class="content">
<pre>Create a new dotnet` API` project from scratch
Add the NuGet package reference to your project:
Install-Package Devon4Net.Application.WebAPI.Configuration</pre>
</div>
</div>
<div class="paragraph">
<p>Set up your project as follows in program.cs file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c# hljs" data-lang="c#">        public static void Main(string[] args)
        {
            // Please use
            // Devonfw.Configure&lt;Startup&gt;(args);
            // Or :

            WebHost.CreateDefaultBuilder(args)
                .UseStartup&lt;Startup&gt;()
                .InitializeDevonFw()
                .Build()
                .Run();
        }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Set up your project as follows in startup.cs file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>    private IConfiguration Configuration { get; }


   public Startup(IConfiguration configuration)
    {
        Configuration = configuration;
    }

    public void ConfigureServices(IServiceCollection services)
    {

        services.ConfigureDevonFw(Configuration);
        SetupDatabase(services);

        ...
    }


    private void SetupDatabase(IServiceCollection services)
    {
        // Default is the database connection name in appsettings.json file
        services.SetupDatabase&lt;TodoContext&gt;(Configuration, "Default", DatabaseType.InMemory);
    }

    public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
    {
        app.ConfigureDevonFw();
        ...
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the devonfw configuration options in your appsettings.json file</p>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-configuration-files"><a class="anchor" href="#devon4net-configuration-files"></a>14.7. devon4net configuration files</h4>
<div class="paragraph">
<p>To start using devon4net in your .net core application add this configuration in your appsettings.json file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"> "devonfw": {
    "UseDetailedErrorsKey": true,
    "UseIIS": false,
    "UseSwagger": true,
    "Environment": "Development",
    "KillSwitch": {
      "killSwitchSettingsFile": "killswitch.appsettings.json"
    },
    "Kestrel": {
      "UseHttps": true,
      "HttpProtocol": "Http2", //Http1, Http2, Http1AndHttp2, none
      "ApplicationPort": 8082,
      "KeepAliveTimeout": 120, //in seconds
      "MaxConcurrentConnections": 100,
      "MaxConcurrentUpgradedConnections": 100,
      "MaxRequestBodySize": 28.6, //In MB. The default maximum request body size is 30,000,000 bytes, which is approximately 28.6 MB
      "Http2MaxStreamsPerConnection": 100,
      "Http2InitialConnectionWindowSize": 131072, // From 65,535 and less than 2^31 (2,147,483,648)
      "Http2InitialStreamWindowSize": 98304, // From 65,535 and less than 2^31 (2,147,483,648)
      "AllowSynchronousIO": true,
      "SslProtocol": "Tls12", //Tls, Tls11,Tls12, Tls13, Ssl2, Ssl3, none. For Https2 Tls12 is needed
      "ServerCertificate": {
        "Certificate": "localhost.pfx",
        "CertificatePassword": "localhost"
      },
      "ClientCertificate": {
        "DisableClientCertificateCheck": true,
        "RequireClientCertificate": false,
        "CheckCertificateRevocation": true,
        "ClientCertificates": {
          "Whitelist": [
            "3A87A49460E8FE0E2A198E63D408DC58435BC501"
          ],
          "DisableClientCertificateCheck": false
        }
      }
    },
    "IIS": {
      "ForwardClientCertificate": true,
      "AutomaticAuthentication": true,
      "AuthenticationDisplayName" : ""
    }
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, for start using the devon4net components, you should add the next json options in your appsettings.json or appsettings.Development.json file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>{
  "ExtraSettingsFiles": [
    "Put a directory path (relative/absolute/linux-like) like /run/secrets/global where there are many settings/secret files to load",
    "Put a specific file name (with/without path) like /app-configs/app/extra-settings.json"
  ],
  "ConnectionStrings": {
    "Default": "Todos",
    "Employee": "Employee",
    "RabbitMqBackup": "Add your database connection string here for messaging backup",
    "MediatRBackup": "Add your database connection string here for messaging backup"
  },
  "Logging": {
    "LogLevel": {
      "Default": "Debug",
      "System": "Information",
      "Microsoft": "Information"
    }
  },
  "Swagger": {
    "Version": "v1",
    "Title": "devon4net API",
    "Description": "devon4net API Contract",
    "Terms": "https://www.devonfw.com/terms-of-use/",
    "Contact": {
      "Name": "devonfw",
      "Email": "sample@mail.com",
      "Url": "https://www.devonfw.com"
    },
    "License": {
      "Name": "devonfw - Terms of Use",
      "Url": "https://www.devonfw.com/terms-of-use/"
    },
    "Endpoint": {
      "Name": "V1 Docs",
      "Url": "/swagger/v1/swagger.json",
      "UrlUi": "swagger",
      "RouteTemplate": "swagger/v1/{documentName}/swagger.json"
    }
  },
  "JWT": {
    "Audience": "devon4Net",
    "Issuer": "devon4Net",
    "TokenExpirationTime": 60,
    "ValidateIssuerSigningKey": true,
    "ValidateLifetime": true,
    "ClockSkew": 5,
    "Security": {
      "SecretKeyLengthAlgorithm": "",
      "SecretKeyEncryptionAlgorithm": "",
      "SecretKey": "",
      "Certificate": "",
      "CertificatePassword": "",
      "CertificateEncryptionAlgorithm": ""
    }
  },
  "Cors": []
  //[
  //  {
  //    "CorsPolicy": "CorsPolicy1",
  //    "Origins": "http://example.com,http://www.contoso.com",
  //    "Headers": "accept,content-type,origin,x-custom-header",
  //    "Methods": "GET,POST,HEAD",
  //    "AllowCredentials": true
  //  },
  //  {
  //    "CorsPolicy": "CorsPolicy2",
  //    "Origins": "http://example.com,http://www.contoso.com",
  //    "Headers": "accept,content-type,origin,x-custom-header",
  //    "Methods": "GET,POST,HEAD",
  //    "AllowCredentials": true
  //  }
  //]
  ,
  "CircuitBreaker": {
    "CheckCertificate": false,
    "Endpoints": [
      {
        "Name": "AnsibleTower",
        "BaseAddress": "PUT THE IP ADDRESS HERE",
        "Headers": {
        },
        "WaitAndRetrySeconds": [
          0.0001,
          0.0005,
          0.001
        ],
        "DurationOfBreak": 0.0005,
        "UseCertificate": false,
        "Certificate": "localhost.pfx",
        "CertificatePassword": "localhost",
        "SslProtocol": "3072" //TLS12
      },
      {
        "Name": "CyberArk",
        "BaseAddress": "PUT THE IP ADDRESS HERE",
        "Headers": {
        },
        "WaitAndRetrySeconds": [
          0.0001,
          0.0005,
          0.001
        ],
        "DurationOfBreak": 0.0005,
        "UseCertificate": false,
        "Certificate": "localhost.pfx",
        "CertificatePassword": "localhost",
        "SslProtocol": "3072" //TLS12
      },
      {
        "Name": "SmaxHcm",
        "BaseAddress": "PUT THE IP ADDRESS HERE",
        "Headers": {
        },
        "WaitAndRetrySeconds": [
          0.0001,
          0.0005,
          0.001
        ],
        "DurationOfBreak": 0.0005,
        "UseCertificate": false,
        "Certificate": "localhost.pfx",
        "CertificatePassword": "localhost",
        "SslProtocol": "3072" //TLS12
      }
    ]
  },
  "Headers": {
    "AccessControlExposeHeader": "Authorization",
    "StrictTransportSecurityHeader": "",
    "XFrameOptionsHeader": "DENY",
    "XssProtectionHeader": "1;mode=block",
    "XContentTypeOptionsHeader": "nosniff",
    "ContentSecurityPolicyHeader": "",
    "PermittedCrossDomainPoliciesHeader": "",
    "ReferrerPolicyHeader": ""
  },
  "Log": {
    "UseAOPTrace": false,
    "LogLevel": "Debug",
    "SqliteDatabase": "logs/log.db",
    "LogFile": "logs/{0}_devonfw.log",
    "SeqLogServerHost": "http://127.0.0.1:5341",
    "GrayLog": {
      "GrayLogHost": "127.0.0.1",
      "GrayLogPort": "12201",
      "GrayLogProtocol": "UDP",
      "UseSecureConnection": true,
      "UseAsyncLogging": true,
      "RetryCount": 5,
      "RetryIntervalMs": 15,
      "MaxUdpMessageSize": 8192
    }
  },
  "RabbitMq": {
    "EnableRabbitMq": false,
    "Hosts": [
      {
        "Host": "127.0.0.1",
        "Port": 5672,
        "Ssl": false,
        "SslServerName": "localhost",
        "SslCertPath": "localhost.pfx",
        "SslCertPassPhrase": "localhost",
        "SslPolicyErrors": "RemoteCertificateNotAvailable" //None, RemoteCertificateNotAvailable, RemoteCertificateNameMismatch, RemoteCertificateChainErrors
      }
    ],

    "VirtualHost": "/",
    "UserName": "admin",
    "Password": "password",
    "Product": "devon4net",
    "RequestedHeartbeat": 10, //Set to zero for no heartbeat
    "PrefetchCount": 50,
    "PublisherConfirms": false,
    "PersistentMessages": true,
    "Platform": "localhost",
    "Timeout": 10,
    "Backup": {
      "UseLocalBackup": false,
      "DatabaseName": "devon4netMessageBackup.db"
    }
  },
  "MediatR": {
    "EnableMediatR": false,
    "Backup": {
      "UseLocalBackup": false,
      "DatabaseName": "devon4netMessageBackup.db"
    }
  },
  "LiteDb": {
    "DatabaseLocation": "devon4net.db"
  },
  "AnsibleTower": {
    "EnableAnsible": false,
    "Name": "AnsibleTower",
    "CircuitBreakerName": "AnsibleTower",
    "ApiUrlBase": "/api/v2/?format=json",
    "Version": "1.0.5.29",
    "Username": "",
    "Password": ""
  },
  "CyberArk": {
    "EnableCyberArk": false,
    "Username": "",
    "Password": "",
    "CircuitBreakerName": "CyberArk"
  },
  "SmaxHcm": {
    "EnableSmax": false,
    "Username": "",
    "Password": "",
    "TenantId": "",
    "CircuitBreakerName": "SmaxHcm",
    "ProviderId": ""
  },
  "Kafka": {
    "EnableKafka": true,
    "Administration": [
      {
        "AdminId": "Admin1",
        "Servers": "127.0.0.1:9092"
      }
    ],
    "Producers": [
      {
        "ProducerId": "Producer1", // devon identifier
        "Servers": "127.0.0.1:9092", // Initial list of brokers as a CSV list of broker host or host:port. The application may also use `rd_kafka_brokers_add()` to add brokers during runtime
        "ClientId": "client1", //Client identifier
        "Topic": "devonfw", // topics to deliver the message
        "MessageMaxBytes": 1000000, //Maximum Kafka protocol request message size. Due to differing framing overhead between protocol versions the producer is unable to reliably enforce a strict max message limit at produce time and may exceed the maximum size by one message in protocol ProduceRequests, the broker will enforce the the topic's `max.message.bytes` limit (see Apache Kafka documentation)
        "CompressionLevel": -1, // [0-9] for gzip; [0-12] for lz4; only 0 for snappy; -1 = codec-dependent default compression level
        "CompressionType": "None", // None, Gzip, Snappy, Lz4, Zstd
        "ReceiveMessageMaxBytes": 100000000,
        "EnableSslCertificateVerification": false,
        "CancellationDelayMaxMs": 100, // The maximum length of time (in milliseconds) before a cancellation request is acted on. Low values may result in measurably higher CPU usage
        "Ack": "None", //Zero=Broker does not send any response/ack to client, One=The leader will write the record to its local log but will respond without awaiting full acknowledgement from all followers. All=Broker will block until message is committed by all in sync replicas (ISRs). If there are less than min.insync.replicas (broker configuration) in the ISR set the produce request will fail
        "Debug": "", //A comma-separated list of debug contexts to enable. Detailed Producer debugging: broker,topic,msg. Consumer: consumer,cgrp,topic,fetch
        "BrokerAddressTtl": 1000, //How long to cache the broker address resolving results (milliseconds)
        "BatchNumMessages": 1000000, // Maximum size (in bytes) of all messages batched in one MessageSet, including protocol framing overhead. This limit is applied after the first message has been added to the batch, regardless of the first message's size, this is to ensure that messages that exceed batch.size are produced. The total MessageSet size is also limited by batch.num.messages and message.max.bytes
        "EnableIdempotence": false, //When set to `true`, the producer will ensure that messages are successfully produced exactly once and in the original produce order. The following configuration properties are adjusted automatically (if not modified by the user) when idempotence is enabled: `max.in.flight.requests.per.connection=5` (must be less than or equal to 5), `retries=INT32_MAX` (must be greater than 0), `acks=all`, `queuing.strategy=fifo`. Producer instantation will fail if user-supplied configuration is incompatible
        "MaxInFlight": 5,
        "MessageSendMaxRetries": 5,
        "BatchSize": 100000000 // Maximum size (in bytes) of all messages batched in one MessageSet, including protocol framing overhead. This limit is applied after the first message has been added to the batch, regardless of the first message's size, this is to ensure that messages that exceed batch.size are produced. The total MessageSet size is also limited by batch.num.messages and message.max.bytes
      }
    ],
    "Consumers": [
      {
        "ConsumerId": "Consumer1", // devon identifier
        "Servers": "127.0.0.1:9092",
        "GroupId": "group1",
        "Topics": "devonfw", // Comma separated topics to subscribe
        "AutoCommit": true, //Automatically and periodically commit offsets in the background. Note: setting this to false does not prevent the consumer from fetching previously committed start offsets. To circumvent this behaviour set specific start offsets per partition in the call to assign()
        "StatisticsIntervalMs": 0, //librdkafka statistics emit interval. The application also needs to register a stats callback using `rd_kafka_conf_set_stats_cb()`. The granularity is 1000ms. A value of 0 disables statistics
        "SessionTimeoutMs": 10000, //Client group session and failure detection timeout. The consumer sends periodic heartbeats (heartbeat.interval.ms) to indicate its liveness to the broker. If no hearts are received by the broker for a group member within the session timeout, the broker will remove the consumer from the group and trigger a rebalance. The allowed range is configured with the **broker** configuration properties `group.min.session.timeout.ms` and `group.max.session.timeout.ms`. Also see `max.poll.interval.ms`
        "AutoOffsetReset": "Largest", //Action to take when there is no initial offset in offset store or the desired offset is out of range: 'smallest','earliest' - automatically reset the offset to the smallest offset, 'largest','latest' - automatically reset the offset to the largest offset, 'error' - trigger an error which is retrieved by consuming messages and checking 'message-&amp;gt;err'
        "EnablePartitionEof": true, //Verify CRC32 of consumed messages, ensuring no on-the-wire or on-disk corruption to the messages occurred. This check comes at slightly increased CPU usage
        "IsolationLevel": "ReadCommitted", //Controls how to read messages written transactionally: `ReadCommitted` - only return transactional messages which have been committed. `ReadUncommitted` - return all messages, even transactional messages which have been aborted.
        "EnableSslCertificateVerification": false,
        "Debug": "" //A comma-separated list of debug contexts to enable. Detailed Producer debugging: broker,topic,msg. Consumer: consumer,cgrp,topic,fetch
      }
    ]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-cobigen-guide"><a class="anchor" href="#devon4net-cobigen-guide"></a>14.8. devon4net Cobigen Guide</h4>

</div>
<div class="sect3">
<h4 id="overview-2"><a class="anchor" href="#overview-2"></a>14.9. Overview</h4>
<div class="paragraph">
<p>In this guide we will explain how to generate a new WebApi project from an OpenAPI 3.0.0 specification. This  means that we are going to use a “contract first” strategy. This is going to be possible due to these type of files that contain all the information about entities, operations, etc…</p>
</div>
<div class="paragraph">
<p>In order to make it work we are using <a href="https://github.com/devonfw/cobigen">CobiGen</a>, a powerful tool for generating source code. CobiGen allows users to generate all the structure and code of the components, helping to save a lot of time otherwise wasted on repetitive tasks.</p>
</div>
</div>
<div class="sect3">
<h4 id="getting-things-ready"><a class="anchor" href="#getting-things-ready"></a>14.10. Getting things ready</h4>

</div>
<div class="sect3">
<h4 id="devonfw-distribution"><a class="anchor" href="#devonfw-distribution"></a>14.11. ==  devonfw Distribution</h4>
<div class="paragraph">
<p>The devonfw distributions can be obtained from <a href="https://repository.sonatype.org/service/local/artifact/maven/redirect?r=central-proxy&amp;g=com.devonfw.tools.ide&amp;a=devonfw-ide-scripts&amp;v=LATEST&amp;p=tar.gz">here</a>. You can find all releases in <a href="https://repo.maven.apache.org/maven2/com/devonfw/tools/ide/devonfw-ide-scripts/">maven central</a>.</p>
</div>
<div class="paragraph">
<p>It is not necessary to install nor configure anything. Just extracting the zip content is enough to have a fully functional devonfw. The only thing you have to do is run <strong>create-or-update-workspace.bat</strong> and then <strong>update-all-workspaces.bat</strong> to set up all the needed tools.</p>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-templates"><a class="anchor" href="#devon4net-templates"></a>14.12. ==  devon4net Templates</h4>
<div class="paragraph">
<p>We are going to use the template of devon4net as a base to generate all the code, so what we have to do now is to download said template using the following steps.</p>
</div>
<div class="paragraph">
<p>First of all you have to set up all the environment for .NET, you can do this using <a href="https://devon4net.github.io/environment.html">the following tutorial</a>. Next we are going to create a new folder where we want to have the WebAPI project, lastly we are going to open the terminal there.</p>
</div>
<div class="paragraph">
<p>Type the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>dotnet new -i Devon4Net.WebAPI.Template</pre>
</div>
</div>
<div class="paragraph">
<p>and then:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>dotnet new Devon4NetAPI</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="openapi-file"><a class="anchor" href="#openapi-file"></a>14.13. ==  OpenAPI File</h4>
<div class="paragraph">
<p>In order to let CobiGen generate all the files, we first have to make some modifications to our OpenAPI file.</p>
</div>
<div class="paragraph">
<p>It is obligatory to put the <em>“x-rootpackage”</em> tag to indicate where CobiGen will place the generated files as well as the <em>"x-component"</em> tags for each component, keep in mind that due to CobiGen&#8217;s limitations each component <strong><em>must</em></strong> have its own entity.</p>
</div>
<div class="paragraph">
<p>You can read more information about how to configure your OpenAPI file and a working example <a href="https://github.com/devonfw/cobigen/wiki/cobigen-openapipluginfull-example">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="generating-files"><a class="anchor" href="#generating-files"></a>14.14. Generating files</h4>
<div class="paragraph">
<p>Cobigen allow us to generate the files in two different ways. One of them is using Eclipse which it can be done by using the its graphical interface. The other way to generate the code is using the Cobigen` CLI` tool.</p>
</div>
</div>
<div class="sect3">
<h4 id="generating-files-through-eclipse"><a class="anchor" href="#generating-files-through-eclipse"></a>14.15. ==  Generating files through Eclipse</h4>
<div class="paragraph">
<p>In order to generate the files using Eclipse we need to follow some simple steps.</p>
</div>
<div class="paragraph">
<p>First we are going to import our basic devon4net WebAPI Project into Eclipse. to do so open Eclipse with the “eclipse-main.bat” file that can be found in the devon distribution root folder. Once we are inside of Eclipse we go to <strong>File &gt; Open projects from file system&#8230;&#8203;</strong> and, under "Directory", search for your project.</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/Project_selection.png""><img src="_images/images/Project_selection.png" alt="cobigen" width="= "600""></a>
</div>
</div>
<div class="paragraph">
<p>Next we copy our OpenAPI file into the root folder of the project.</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/OpenAPI_file_root_folder.png""><img src="_images/images/OpenAPI_file_root_folder.png" alt="cobigen" width="= "300""></a>
</div>
</div>
<div class="paragraph">
<p>And then we right click on OpenAPI file and then select <strong>CobiGen &gt; Generate&#8230;&#8203;</strong> It will display a window like this:</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/cobigen_generate0.png""><img src="_images/images/cobigen_generate0.png" alt="cobigen" width="= "800""></a>
</div>
</div>
<div class="paragraph">
<p>To select all .NET features choose <strong>CRUD devon4net Server</strong> otherwise you can select only those that interest you.</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/cobigen_generate1.png"><img src="_images/images/cobigen_generate1.png" alt="cobigen" width="= "800""></a>
</div>
</div>
<div class="paragraph">
<p>Ones you select all the files that you want to generate, click on the <em>“Finish”</em> button to generate all the source code.</p>
</div>
</div>
<div class="sect3">
<h4 id="generating-files-through-cobigen-cli"><a class="anchor" href="#generating-files-through-cobigen-cli"></a>14.16. ==  Generating files through Cobigen` CLI`</h4>
<div class="paragraph">
<p>In order to generate the files using the Cobigen` CLI` it is needed to do the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to devonfw distribution folder</p>
</li>
<li>
<p>Run <strong>console.bat</strong>, this will open a console.</p>
</li>
<li>
<p>Go to the folder you downloaded the <strong>devon4net template</strong> and your <strong>yml</strong> file.</p>
</li>
<li>
<p>Run the command:</p>
<div class="literalblock">
<div class="content">
<pre>cobigen generate {yourOpenAPIFile}.yml</pre>
</div>
</div>
</li>
<li>
<p>A list of increments will be printed so that you can start the generation. It has to be selected <strong>CRUD devon4net Server</strong> increment.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="configuration-3"><a class="anchor" href="#configuration-3"></a>14.17. Configuration</h4>

</div>
<div class="sect3">
<h4 id="dependency-injection-configuration"><a class="anchor" href="#dependency-injection-configuration"></a>14.18. ==  Dependency Injection configuration</h4>
<div class="paragraph">
<p>At this point it is needed to make some modifications in the code in order to configure correctly the server. To do so it is needed to locate the services and the repositories files that were created in <strong>Devon4Net.WebAPI.Implementation</strong></p>
</div>
<div class="paragraph">
<p>Services location:</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/Services.png"><img src="_images/images/Services.png" alt="cobigen" width="= "300""></a>
</div>
</div>
<div class="paragraph">
<p>Repositories location:</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/Repositories.png"><img src="_images/images/Repositories.png" alt="cobigen" width="= "300""></a>
</div>
</div>
<div class="paragraph">
<p>Now, we are going to open the following file <strong>Devon4Net.WebAPI.Implementation\Configure\DevonConfiguration.cs</strong>.
In there we have to add the Dependency Injection for the services and the repositories that Cobigen has generated. The following image is an example of what is needed to add.</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/BussinessConfiguration.png"><img src="_images/images/BussinessConfiguration.png" alt="cobigen" width="= "800""></a>
</div>
</div>
<div class="paragraph">
<p>Moreover it is needed to remove the last line in order to be able to run the application:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`throw new NotImplementedException(...);`</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configure-data-base"><a class="anchor" href="#configure-data-base"></a>14.19. ==  Configure data base</h4>
<div class="paragraph">
<p>Cobigen is generating an empty context that has to be filled with manually in order to be able to work with the database. The context can be found in <strong>[Project_Name]/Devon4Net.WebAPI.Implementation/Domain/Database/CobigenContext.cs</strong>.</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/CobigenContextLocation.png"><img src="_images/images/CobigenContextLocation.png" alt="cobigen" width="= "350""></a>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configure-services"><a class="anchor" href="#configure-services"></a>14.20. ==  Configure services</h4>
<div class="paragraph">
<p>In order to finish the configuration of the services it is needed to go to each service file of the managements generated.</p>
</div>
<div class="paragraph">
<p>In there we will see some <code>"NotImplementedExceptions"</code>, so it is needed to read carefully each comment inside of each exception in order to be able to use the service. It can be shown an example of the service with its <code>NotImplementedExceptions</code> comments:</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/ServiceExample.png"><img src="_images/images/ServiceExample.png" alt="cobigen" width="= "800""></a>
</div>
</div>
</div>
<div class="sect3">
<h4 id="run-the-application"><a class="anchor" href="#run-the-application"></a>14.21. ==  Run the application</h4>
<div class="paragraph">
<p>After doing all the steps defined above, open a terminal in path: <strong>[Project_Name]/Devon4Net.Application.WebAPI</strong> and then type:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>dotnet run</pre>
</div>
</div>
<div class="paragraph">
<p>This will deploy our application in our localhost with the port 8081, so when you click <a href="https://localhost:8082/swagger/index.html">here</a> (<a href="https://localhost:8082/swagger" class="bare">https://localhost:8082/swagger</a>) you can see, in swagger, all the services and the data model.</p>
</div>
</div>
<div class="sect3">
<h4 id="use-http2-protocol"><a class="anchor" href="#use-http2-protocol"></a>14.22. Use HTTP2 protocol</h4>
<div class="paragraph">
<p>You can specify the` HTTP` protocol to be used on your devon4net application modifying some node values at <em>devonfw</em> node in your appsettings configuration file.</p>
</div>
</div>
<div class="sect3">
<h4 id="httpprotocol"><a class="anchor" href="#httpprotocol"></a>14.23. HttpProtocol</h4>
<div class="paragraph">
<p>The supported protocols are:</p>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|<strong>Protocol</strong>|<strong>Description</strong>
|Http1| Http1 protocol
|Http2| Http2 Protocol
|Http1AndHttp2| Both supported
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect3">
<h4 id="ssl"><a class="anchor" href="#ssl"></a>14.24. =` SSL`</h4>
<div class="paragraph">
<p>To activate the HTTP2, the <em>SslProtocol</em> node must be set to <em>Tls12</em> value.</p>
</div>
<div class="paragraph">
<p>The` SSL` protocol supported version values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tls</p>
</li>
<li>
<p>Tls11</p>
</li>
<li>
<p>Tls12</p>
</li>
<li>
<p>Tls13</p>
</li>
<li>
<p>Ssl2</p>
</li>
<li>
<p>Ssl3</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="create-a-certificate-for-development-purposes"><a class="anchor" href="#create-a-certificate-for-development-purposes"></a>14.25. Create a certificate for development purposes</h4>
<div class="paragraph">
<p>In order to create a valid certificate for development purposes the Open` SSL` tools are needed.</p>
</div>
</div>
<div class="sect3">
<h4 id="certificate-authority-ca"><a class="anchor" href="#certificate-authority-ca"></a>14.26. Certificate authority (CA)</h4>
<div class="paragraph">
<p>Run the next commands in a shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-numbered hljs" data-lang="numbered">1. openssl req -x509 -nodes -new -sha256 -days 1024 -newkey rsa:2048 -keyout RootCA.key -out RootCA.pem -subj "/C=ES/ST=Valencia/L=Valencia/O=Certificates/CN=localhost.local"

2. openssl x509 -outform pem -in RootCA.pem -out RootCA.crt</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to convert your certificate run the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-numbered hljs" data-lang="numbered">openssl pkcs12 -export -out localhost.pfx -inkey RootCA.key -in RootCA.crt</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="domain-name-certificate"><a class="anchor" href="#domain-name-certificate"></a>14.27. Domain name certificate</h4>
<div class="paragraph">
<p>Run the next commands in a shell:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-numbered hljs" data-lang="numbered">1. openssl req -new -nodes -newkey rsa:2048 -keyout localhost.key -out localhost.csr -subj "/C=ES/ST=Valencia/L=Valencia/O=Certificates/CN=localhost.local"

2. openssl x509 -req -sha256 -days 1024 -in localhost.csr -CA RootCA.pem -CAkey RootCA.key -CAcreateserial -extfile domains.ext -out localhost.crt</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where the <em>domains.ext</em> file should contain:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-numbered hljs" data-lang="numbered">authorityKeyIdentifier=keyid,issuer
basicConstraints=CA:FALSE
keyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment
subjectAltName = @alt_names
[alt_names]
DNS.1 = localhost
DNS.2 = localhost.local
DNS.3 = 127.0.0.1
DNS.4 = fake1.local
DNS.5 = fake2.local</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to convert your certificate run the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-numbered hljs" data-lang="numbered">openssl pkcs12 -export -out localhost.pfx -inkey localhost.key -in localhost.crt</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="setup-the-database-driver"><a class="anchor" href="#setup-the-database-driver"></a>14.28. Setup the database driver</h4>
<div class="paragraph">
<p>Add the database connection on the <code>SetupDatabase</code> method at Startup.cs</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>       private void SetupDatabase(IServiceCollection services)
        {
            services.SetupDatabase&lt;TodoContext&gt;(Configuration, "Default", WebAPI.Configuration.Enums.DatabaseType.InMemory);
        }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|<strong>Param</strong>|<strong>Description</strong>
|<code>TodoContext</code>| Is the database context definition
|Default| Is the connection string defined at <code><em>ConnectionString</em></code> node at the appsettings configuration file
|<code>WebAPI.Configuration.Enums.DatabaseType.InMemory</code>| Is the database driver selection. In this case InMemory data base is chosen
|== == == == == == == == == == == =</p>
</div>
<div class="paragraph">
<p>The supported databases are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SqlServer</p>
</li>
<li>
<p>Sqlite</p>
</li>
<li>
<p>InMemory</p>
</li>
<li>
<p>Cosmos</p>
</li>
<li>
<p>PostgreSQL</p>
</li>
<li>
<p>MySql</p>
</li>
<li>
<p>MariaDb</p>
</li>
<li>
<p>FireBird</p>
</li>
<li>
<p>Oracle</p>
</li>
<li>
<p>MSAccess</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="change-the-jwt-encryption-algorithm"><a class="anchor" href="#change-the-jwt-encryption-algorithm"></a>14.29. Change the JWT encryption algorithm</h4>
<div class="paragraph">
<p>In the appsettings.json configuration file, you can use the next values on the <code><em>SecretKeyLengthAlgorithm</em></code> and <code><em>SecretKeyEncryptionAlgorithm</em></code> nodes at JWT configuration:</p>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|<strong>Algorithm</strong>|<strong>Description</strong>
|<code>Aes128Encryption</code>|"http://www.w3.org/2001/04/xmlenc#aes128-cbc"
|<code>Aes192Encryption</code>|"http://www.w3.org/2001/04/xmlenc#aes192-cbc"
|<code>Aes256Encryption</code>|"http://www.w3.org/2001/04/xmlenc#aes256-cbc"
|<code>DesEncryption</code>|"http://www.w3.org/2001/04/xmlenc#des-cbc"
|<code>Aes128KeyWrap</code>|"http://www.w3.org/2001/04/xmlenc#kw-aes128"
|<code>Aes192KeyWrap</code>|"http://www.w3.org/2001/04/xmlenc#kw-aes192"
|<code>Aes256KeyWrap</code>|"http://www.w3.org/2001/04/xmlenc#kw-aes256"
|<code>RsaV15KeyWrap</code>|"http://www.w3.org/2001/04/xmlenc#rsa-1_5"
|<code>Ripemd160Digest</code>|"http://www.w3.org/2001/04/xmlenc#ripemd160"
|<code>RsaOaepKeyWrap</code>|"http://www.w3.org/2001/04/xmlenc#rsa-oaep"
|<code>Aes128KW</code>|"A128KW"
|<code>Aes256KW</code>|"A256KW"
|<code>RsaPKCS1</code>|<code>"RSA1_5"</code>
|<code>RsaOAEP</code>|<code>"RSA-OAEP"</code>
|<code>ExclusiveC14n</code>|"http://www.w3.org/2001/10/xml-exc-c14n#"
|<code>ExclusiveC14nWithComments</code>|"http://www.w3.org/2001/10/xml-exc-c14n#WithComments"
|<code>EnvelopedSignature</code>|"http://www.w3.org/2000/09/xmldsig#enveloped-signature"
|<code>Sha256Digest</code>|"http://www.w3.org/2001/04/xmlenc#sha256"
|<code>Sha384Digest</code>|"http://www.w3.org/2001/04/xmldsig-more#sha384"
|<code>Sha512Digest</code>|"http://www.w3.org/2001/04/xmlenc#sha512"
|<code>Sha256</code>|"SHA256"
|<code>Sha384</code>|"SHA384"
|<code>Sha512</code>|"SHA512"
|<code>EcdsaSha256Signature</code>|"http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256"
|<code>EcdsaSha384Signature</code>|"http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384"
|<code>EcdsaSha512Signature</code>|"http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512"
|<code>HmacSha256Signature</code>|"http://www.w3.org/2001/04/xmldsig-more#hmac-sha256"
|<code>HmacSha384Signature</code>|"http://www.w3.org/2001/04/xmldsig-more#hmac-sha384"
|<code>HmacSha512Signature</code>|"http://www.w3.org/2001/04/xmldsig-more#hmac-sha512"
|<code>RsaSha256Signature</code>|"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"
|<code>RsaSha384Signature</code>|"http://www.w3.org/2001/04/xmldsig-more#rsa-sha384"
|<code>RsaSha512Signature</code>|"http://www.w3.org/2001/04/xmldsig-more#rsa-sha512"
|<code>RsaSsaPssSha256Signature</code>|"http://www.w3.org/2007/05/xmldsig-more#sha256-rsa-MGF1"
|<code>RsaSsaPssSha384Signature</code>|"http://www.w3.org/2007/05/xmldsig-more#sha384-rsa-MGF1"
|<code>RsaSsaPssSha512Signature</code>|"http://www.w3.org/2007/05/xmldsig-more#sha512-rsa-MGF1"
|<code>EcdsaSha256</code>|"ES256"
|<code>EcdsaSha384</code>|"ES384"
|<code>EcdsaSha512</code>|"ES512"
|<code>HmacSha256</code>|"HS256"
|<code>HmacSha384</code>|"HS384"
|<code>HmacSha512</code>|"HS512"
|None|"none"
|<code>RsaSha256</code>|"RS256"
|<code>RsaSha384</code>|"RS384"
|<code>RsaSha512</code>|"RS512"
|<code>RsaSsaPssSha256</code>|"PS256"
|<code>RsaSsaPssSha384</code>|"PS384"
|<code>RsaSsaPssSha512</code>|"PS512"
|<code>Aes128CbcHmacSha256</code>|"A128CBC-HS256"
|<code>Aes192CbcHmacSha384</code>|"A192CBC-HS384"
|<code>Aes256CbcHmacSha512</code>|"A256CBC-HS512"
|== == == == == == == == == == == =</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cobigen-guide"><a class="anchor" href="#cobigen-guide"></a>15. Cobigen guide</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="devon4net-cobigen-guide-2"><a class="anchor" href="#devon4net-cobigen-guide-2"></a>15.1. devon4net Cobigen Guide</h4>

</div>
<div class="sect3">
<h4 id="overview-3"><a class="anchor" href="#overview-3"></a>15.2. Overview</h4>
<div class="paragraph">
<p>In this guide we will explain how to generate a new <code>WebApi</code> project from an OpenAPI 3.0.0 specification. This  means that we are going to use a “contract first” strategy. This is going to be possible due to these type of files that contain all the information about entities, operations, etc…</p>
</div>
<div class="paragraph">
<p>In order to make it work we are using <a href="https://github.com/devonfw/cobigen"><code>CobiGen</code></a>, a powerful tool for generating source code. <code>CobiGen</code> allows users to generate all the structure and code of the components, helping to save a lot of time otherwise wasted on repetitive tasks.</p>
</div>
</div>
<div class="sect3">
<h4 id="getting-things-ready-2"><a class="anchor" href="#getting-things-ready-2"></a>15.3. Getting things ready</h4>

</div>
<div class="sect3">
<h4 id="devonfw-distribution-2"><a class="anchor" href="#devonfw-distribution-2"></a>15.4. devonfw Distribution</h4>
<div class="paragraph">
<p>The devonfw distributions can be obtained from the <a href="https://coconet.capgemini.com/sf/frs/do/listReleases/projects.apps2_devon/frs.devon_distribution"><code>TeamForge</code> releases library</a> and are packaged in zips files that include all the needed tools, software and configurations.</p>
</div>
<div class="paragraph">
<p>It is not necessary to install nor configure anything. Just extracting the zip content is enough to have a fully functional devonfw. The only thing you have to do is run <strong>create-or-update-workspace.bat</strong> and then <strong>update-all-workspaces.bat</strong> to set up all the needed tools.</p>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-templates-2"><a class="anchor" href="#devon4net-templates-2"></a>15.5. devon4net Templates</h4>
<div class="paragraph">
<p>We are going to use the template of devon4net as a base to generate all the code, so what we have to do now is to download said template using the following steps.</p>
</div>
<div class="paragraph">
<p>First of all you have to set up all the environment for .NET, you can do this using <a href="https://devon4net.github.io/environment.html">the following tutorial</a>. Next we are going to create a new folder where we want to have the WebAPI project, lastly we are going to open the terminal there.</p>
</div>
<div class="paragraph">
<p>Type the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>dotnet new -i `Devon4Net`.WebAPI.Template</pre>
</div>
</div>
<div class="paragraph">
<p>and then:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>dotnet new Devon4NetAPI</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="openapi-file-2"><a class="anchor" href="#openapi-file-2"></a>15.6. OpenAPI File</h4>
<div class="paragraph">
<p>In order to let <code>CobiGen</code> generate all the files, we first have to make some modifications to our OpenAPI file.</p>
</div>
<div class="paragraph">
<p>It is obligatory to put the <em>“x-rootpackage”</em> tag to indicate where <code>CobiGen</code> will place the generated files as well as the <em>"x-component"</em> tags for each component, keep in mind that due to `CobiGen&#8217;s limitations each component <strong><em>must</em></strong> have its own entity.</p>
</div>
<div class="paragraph">
<p>You can read more information about how to configure your OpenAPI file and a working example <a href="https://github.com/devonfw/cobigen/wiki/cobigen-openapiplugin#full-example">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="generating-files-2"><a class="anchor" href="#generating-files-2"></a>15.7. Generating files</h4>
<div class="paragraph">
<p>Cobigen allow us to generate the files in two different ways. One of them is using Eclipse which it can be done by using the its graphical interface. The other way to generate the code is using the Cobigen CLI tool.</p>
</div>
</div>
<div class="sect3">
<h4 id="generating-files-through-eclipse-2"><a class="anchor" href="#generating-files-through-eclipse-2"></a>15.8. Generating files through Eclipse</h4>
<div class="paragraph">
<p>In order to generate the files using Eclipse we need to follow some simple steps.</p>
</div>
<div class="paragraph">
<p>First we are going to import our basic devon4net WebAPI Project into Eclipse. to do so open Eclipse with the “eclipse-main.bat” file that can be found in the devon distribution root folder. Once we are inside of Eclipse we go to <strong>File &gt; Open projects from file system&#8230;&#8203;</strong> and, under "Directory", search for your project.</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/Project_selection.png""><img src="_images/images/Project_selection.png" alt="cobigen" width="= "600""></a>
</div>
</div>
<div class="paragraph">
<p>Next we copy our OpenAPI file into the root folder of the project.</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/OpenAPI_file_root_folder.png""><img src="_images/images/OpenAPI_file_root_folder.png" alt="cobigen" width="= "300""></a>
</div>
</div>
<div class="paragraph">
<p>And then we right click on OpenAPI file and then select <strong>CobiGen &gt; Generate&#8230;&#8203;</strong> It will display a window like this:</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/cobigen_generate0.png""><img src="_images/images/cobigen_generate0.png" alt="cobigen" width="= "800""></a>
</div>
</div>
<div class="paragraph">
<p>To select all .NET features choose <strong>CRUD devon4net Server</strong> otherwise you can select only those that interest you.</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/cobigen_generate1.png"><img src="_images/images/cobigen_generate1.png" alt="cobigen" width="= "800""></a>
</div>
</div>
<div class="paragraph">
<p>Ones you select all the files that you want to generate, click on the <em>“Finish”</em> button to generate all the source code.</p>
</div>
</div>
<div class="sect3">
<h4 id="generating-files-through-cobigen-cli-2"><a class="anchor" href="#generating-files-through-cobigen-cli-2"></a>15.9. Generating files through Cobigen CLI</h4>
<div class="paragraph">
<p>In order to generate the files using the Cobigen CLI it is needed to do the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to devonfw distribution folder</p>
</li>
<li>
<p>Run <strong>console.bat</strong>, this will open a console.</p>
</li>
<li>
<p>Go to the folder you downloaded the <strong>devon4net template</strong> and your <strong>yml</strong> file.</p>
</li>
<li>
<p>Run the command:</p>
<div class="literalblock">
<div class="content">
<pre>cobigen generate {yourOpenAPIFile}.yml</pre>
</div>
</div>
</li>
<li>
<p>A list of increments will be printed so that you can start the generation. It has to be selected <strong>CRUD devon4net Server</strong> increment.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="configuration-4"><a class="anchor" href="#configuration-4"></a>15.10. Configuration</h4>

</div>
<div class="sect3">
<h4 id="dependency-injection-configuration-2"><a class="anchor" href="#dependency-injection-configuration-2"></a>15.11. Dependency Injection configuration</h4>
<div class="paragraph">
<p>At this point it is needed to make some modifications in the code in order to configure correctly the server. To do so it is needed to locate the services and the repositories files that were created in <strong>Devon4Net.WebAPI.Implementation</strong></p>
</div>
<div class="paragraph">
<p>Services location:</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/Services.png"><img src="_images/images/Services.png" alt="cobigen" width="= "300""></a>
</div>
</div>
<div class="paragraph">
<p>Repositories location:</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/Repositories.png"><img src="_images/images/Repositories.png" alt="cobigen" width="= "300""></a>
</div>
</div>
<div class="paragraph">
<p>Now, we are going to open the following file <code><strong>Devon4Net.WebAPI.Implementation\Configure\DevonConfiguration.cs</strong></code>.
In there we have to add the Dependency Injection for the services and the repositories that Cobigen has generated. The following image is an example of what is needed to add.</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/BussinessConfiguration.png"><img src="_images/images/BussinessConfiguration.png" alt="cobigen" width="= "800""></a>
</div>
</div>
<div class="paragraph">
<p>Moreover it is needed to remove the last line in order to be able to run the application:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`throw new NotImplementedException(...);`</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configure-data-base-2"><a class="anchor" href="#configure-data-base-2"></a>15.12. Configure data base</h4>
<div class="paragraph">
<p>Cobigen is generating an empty context that has to be filled with manually in order to be able to work with the database. The context can be found in <code><strong>[Project_Name]/Devon4Net.WebAPI.Implementation/Domain/Database/CobigenContext.cs</strong></code>.</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/CobigenContextLocation.png"><img src="_images/images/CobigenContextLocation.png" alt="cobigen" width="= "350""></a>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configure-services-2"><a class="anchor" href="#configure-services-2"></a>15.13. Configure services</h4>
<div class="paragraph">
<p>In order to finish the configuration of the services it is needed to go to each service file of the managements generated.</p>
</div>
<div class="paragraph">
<p>In there we will see some <code>"NotImplementedExceptions"</code>, so it is needed to read carefully each comment inside of each exception in order to be able to use the service. It can be shown an example of the service with its <code>NotImplementedExceptions</code> comments:</p>
</div>
<div id="img-cobigen" class="imageblock">
<div class="content">
<a class="image" href="= "images/ServiceExample.png"><img src="_images/images/ServiceExample.png" alt="cobigen" width="= "800""></a>
</div>
</div>
</div>
<div class="sect3">
<h4 id="run-the-application-2"><a class="anchor" href="#run-the-application-2"></a>15.14. Run the application</h4>
<div class="paragraph">
<p>After doing all the steps defined above, open a terminal in path: <strong>[Project_Name]/Devon4Net.Application.WebAPI</strong> and then type:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>dotnet run</pre>
</div>
</div>
<div class="paragraph">
<p>This will deploy our application in our localhost with the port 8081, so when you click <a href="https://localhost:8082/swagger/index.html">here</a> (<a href="https://localhost:8082/swagger" class="bare">https://localhost:8082/swagger</a>) you can see, in swagger, all the services and the data model.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="coding-conventions"><a class="anchor" href="#coding-conventions"></a>16. Coding conventions</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="paragraph">
<p>==Code conventions</p>
</div>
<div class="sect3">
<h4 id="introduction-8"><a class="anchor" href="#introduction-8"></a>16.1. <span class="navy">Introduction</span></h4>
<div class="paragraph">
<p>This document covers .NET Coding Standards and is recommended to be read by team <code>leaders/sw</code> architects and developing teams operating in the Microsoft .NET environment.</p>
</div>
<div class="paragraph">
<p>“All the code in the system looks as if it was written by a single – very competent – individual” (K. Beck)</p>
</div>
</div>
<div class="sect3">
<h4 id="capitalization-conventions"><a class="anchor" href="#capitalization-conventions"></a>16.2. <span class="navy">Capitalization Conventions</span></h4>
<div class="sect4">
<h5 id="terminology"><a class="anchor" href="#terminology"></a><span class="navy">Terminology</span></h5>
<div class="sect5">
<h6 id="camel-case-camelcase"><a class="anchor" href="#camel-case-camelcase"></a>Camel Case (camelCase)</h6>
<div class="paragraph">
<p>Each word or abbreviation in the middle of the phrase begins with a capital letter, with no intervening spaces or punctuation.</p>
</div>
<div class="paragraph">
<p>The camel case convention, used only for parameter names, capitalizes the first character of each word except the first word, as shown in the following examples. As the example also shows, two-letter acronyms that begin a camel-cased identifier are both lowercase.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-up"></i></span> use <code>camelCasing</code> for parameter names.</p>
</div>
</div>
<div class="sect5">
<h6 id="pascal-case-pascalcase"><a class="anchor" href="#pascal-case-pascalcase"></a>Pascal Case (<code>PascalCase</code>)</h6>
<div class="paragraph">
<p>The first letter of each concatenated word is capitalized. No other characters are used to separate the words, like hyphens or underscores.</p>
</div>
<div class="paragraph">
<p>The <code>PascalCasing</code> convention, used for all identifiers except parameter names, capitalizes the first character of each word (including acronyms over two letters in length).</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-up"></i></span> use <code>PascalCasing</code> for all public member, type, and namespace names consisting of multiple words.</p>
</div>
</div>
<div class="sect5">
<h6 id="underscore-prefix-_underscore"><a class="anchor" href="#underscore-prefix-_underscore"></a>Underscore Prefix (_underScore)</h6>
<div class="paragraph">
<p>For underscore ( _ ), the word after _ use camelCase terminology.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="general-naming-conventions"><a class="anchor" href="#general-naming-conventions"></a>16.3. <span class="navy">General Naming Conventions</span></h4>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-up"></i></span> choose easily readable identifier names.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-up"></i></span> favor readability over brevity.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>◦ e.g.: `GetLength` is a better name than GetInt.
◦ Aim for the “ubiquitous language” (E. Evans): A language distilled from the domain language, which helps the team clarifying domain concepts and communicating with domain experts.</pre>
</div>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-up"></i></span> prefer adding a suffix rather than a prefix to indicate a new version of an existing <code>API</code>.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-up"></i></span> use a numeric suffix to indicate a new version of an existing <code>API</code>, particularly if the existing name of the <code>API</code> is the only name that makes sense (i.e., if it is an industry standard) and if adding any meaningful suffix (or changing the name) is not an appropriate option.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-down"></i></span> do not use underscores, hyphens, or any other non-alphanumeric characters.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-down"></i></span> do not use Hungarian notation.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-down"></i></span> avoid using identifiers that conflict with keywords of widely used programming languages.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-down"></i></span> do not use abbreviations or contractions as part of identifier names.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-down"></i></span> do not use any acronyms that are not widely accepted, and even if they are, only when necessary.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-down"></i></span> do not use the "Ex" (or a similar) suffix for an identifier to distinguish it from an earlier version of the same <code>API</code>.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-down"></i></span> do not use C# reserved words as names.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-down"></i></span> do not use Hungarian notation. Hungarian notation is the practice of including a prefix in identifiers to encode some metadata about the parameter, such as the data type of the identifier.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>◦ `e.g.: iNumberOfClients, sClientName`</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="names-of-assemblies-and-dlls"><a class="anchor" href="#names-of-assemblies-and-dlls"></a>16.4. <span class="navy">Names of Assemblies and DLLs</span></h4>
<div class="paragraph">
<p>An assembly is the unit of deployment and identity for managed code programs. Although assemblies can span one or more files, typically an assembly maps one-to-one with a` DLL`. Therefore, this section describes only` DLL` naming conventions, which then can be mapped to assembly naming conventions.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-up"></i></span> choose names for your assembly DLLs that suggest large chunks of functionality, such as System.Data.</p>
</div>
<div class="paragraph">
<p>Assembly and <code>DLL</code> names don’t have to correspond to namespace names, but it is reasonable to follow the namespace name when naming assemblies. A good rule of thumb is to name the <code>DLL</code> based on the common prefix of the assemblies contained in the assembly. For example, an assembly with two namespaces, <code>MyCompany.MyTechnology.FirstFeature</code> and <code>MyCompany.MyTechnology.SecondFeature</code>, could be called <code>MyCompany.MyTechnology.dll</code>.</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-thumbs-o-up"></i></span> consider naming DLLs according to the following pattern:<br>
&lt;Company&gt;.&lt;Component&gt;.dll
where &lt;Component&gt; contains one or more dot-separated clauses.</p>
</div>
<div class="paragraph">
<p>For example:
Litware.Controls.dll.</p>
</div>
</div>
<div class="sect3">
<h4 id="general-coding-style"><a class="anchor" href="#general-coding-style"></a>16.5. <span class="navy">General coding style</span></h4>
<div class="ulist">
<ul>
<li>
<p>Source files: One Namespace per file and one class per file.</p>
</li>
<li>
<p>Braces: On new line. Always use braces when optional.</p>
</li>
<li>
<p>Indention: Use tabs with size of 4.</p>
</li>
<li>
<p>Comments: Use // for simple comment or /// for summaries. Do not /* … */ and do not flower box.</p>
</li>
<li>
<p>Use Use built-in C# native data types vs .NET <code>CTS</code> types (string instead of String)</p>
</li>
<li>
<p>Avoid changing default type in Enums.</p>
</li>
<li>
<p>Use <em>base</em> or <em>this</em> only in constructors or within an override.</p>
</li>
<li>
<p>Always check for null before invoking events.</p>
</li>
<li>
<p>Avoid using <em>Finalize</em>. Use C# Destructors and do not create Finalize() method.</p>
</li>
<li>
<p>Suggestion: Use blank lines, to make it much more readable by dividing it into small, easy-to-digest sections:</p>
<div class="literalblock">
<div class="content">
<pre>◦ Use a single blank line to separate logical groups of code, such as control structures.
◦ Use two blank lines to separate method definitions</pre>
</div>
</div>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Case</strong></th>
<th class="tableblock halign-left valign-top"><strong>Convention</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Source File</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pascal case. Match class name and file name</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Namespace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pascal case</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pascal case</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Interface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pascal case</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generics</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single capital letter (T or <code>K</code>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Methods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pascal case (use a Verb or Verb+Object)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pascal case</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Private field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Camel case with underscore (_) prefix</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Static field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pascal case</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pascal case. Try to use get and and set convention {get;set;}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pascal case</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pascal case</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variable (inline)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Camel case</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Param</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Camel case</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="use-of-region-guideline"><a class="anchor" href="#use-of-region-guideline"></a>16.6. <span class="navy">Use of Region guideline</span></h4>
<div class="paragraph">
<p>Regions can be used to collapse code inside Visual Studio .NET. Regions are ideal candidates to hide boiler plate style code that adds little value to the reader on your code. Regions can then be expanded to provide progressive disclosure of the underlying details of the class or method.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Do Not regionalise entire type definitions that are of an important nature. Types such as enums (which tend to be fairly static in their nature) can be regionalised – their permissible values show up in Intellisense anyway.</p>
</li>
<li>
<p>Do Not regionalise an entire file. When another developer opens the file, all they will see is a single line in the code editor pane.</p>
</li>
<li>
<p>Do regionalise boiler plate type code.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="use-of-comment-guideline"><a class="anchor" href="#use-of-comment-guideline"></a>16.7. <span class="navy">Use of Comment guideline</span></h4>
<div class="paragraph">
<p>Code is the only completely reliable documentation: write “good code” first!</p>
</div>
<div class="sect4">
<h5 id="avoid-unnecessary-comments"><a class="anchor" href="#avoid-unnecessary-comments"></a><span class="navy">Avoid Unnecessary comments</span></h5>
<div class="ulist">
<ul>
<li>
<p>Choosing good names for fields, methods, parameters, etc. “let the code speak” (K. Beck) by itself reducing the need for comments and documentation</p>
</li>
<li>
<p>Avoid “repeating the code” and commenting the obvious</p>
</li>
<li>
<p>Avoid commenting “tricky code”: rewrite it! If there’s no time at present to refactor a tricky section, mark it with a <code>TODO</code> and schedule time to take care of it as soon as possible.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="effective-comments"><a class="anchor" href="#effective-comments"></a><span class="navy">Effective comments</span></h5>
<div class="ulist">
<ul>
<li>
<p>Use comments to summarize a section of code</p>
</li>
<li>
<p>Use comments to clarify sensitive pieces of code</p>
</li>
<li>
<p>Use comments to clarify the intent of the code</p>
</li>
<li>
<p>Bad written or out-of-date comments are more damaging than helpful:</p>
</li>
<li>
<p>Write clear and effective comments</p>
</li>
<li>
<p>Pay attention to pre-existing comments when modifying code or copying&amp;pasting code</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="external-links-3"><a class="anchor" href="#external-links-3"></a>16.8. <span class="navy">External links</span></h4>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/naming-guidelines">Naming guidelines</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/general-naming-conventions">General naming conventions</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/capitalization-conventions">Capitalization conventions</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/names-of-assemblies-and-dlls">Assembly and Name Spaces conventions</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="environment"><a class="anchor" href="#environment"></a>17. Environment</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="environment-2"><a class="anchor" href="#environment-2"></a>17.1. Environment</h4>

</div>
<div class="sect3">
<h4 id="overview-4"><a class="anchor" href="#overview-4"></a>17.2. <span class="navy">Overview</span></h4>

</div>
<div class="sect3">
<h4 id="required-software"><a class="anchor" href="#required-software"></a>17.3. <span class="navy">Required software</span></h4>
<div class="paragraph">
<p><a href="https://code.visualstudio.com/">Visual Studio Code</a></p>
</div>
<div class="paragraph">
<p><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.csharp">C# Extension for VS Code</a></p>
</div>
<div class="paragraph">
<p><a href="https://www.microsoft.com/net/core">.Net Core SDK</a></p>
</div>
</div>
<div class="sect3">
<h4 id="setting-up-the-environment"><a class="anchor" href="#setting-up-the-environment"></a>17.4. <span class="navy">Setting up the environment</span></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download and install <a href="https://code.visualstudio.com/">Visual Studio Code</a></p>
</li>
<li>
<p>Download and install <a href="https://www.microsoft.com/net/core">.Net Core SDK</a></p>
</li>
<li>
<p><a href="https://code.visualstudio.com/docs/editor/extension-gallery">Intall the extension</a> <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.csharp">Omnisharp</a> in Visual Studio Code</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="hello-world"><a class="anchor" href="#hello-world"></a>17.5. ==  <span class="navy">Hello world</span></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a project:</p>
<div class="ulist">
<ul>
<li>
<p>Open Visual Studio Code.</p>
</li>
<li>
<p>Click on the Explorer icon on the left menu and then click <strong>Open Folder</strong>.</p>
</li>
<li>
<p>Select the folder you want your C# project to be in and click <strong>Select Folder</strong>. For our example, we&#8217;ll create a folder for our project named <code>'HelloWorld'</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Initialize a C# project:</p>
<div class="ulist">
<ul>
<li>
<p>Open the Integrated Terminal from Visual Studio Code by typing <code>CTRL+(backtick)</code>. Alternatively, you can select <strong>View</strong> &gt; <strong>Integrated Terminal</strong> from the main menu.</p>
</li>
<li>
<p>In the terminal window, type <code>dotnet new console</code>.</p>
</li>
<li>
<p>This creates a <code>Program.cs</code> file in your folder with a simple "Hello World" program already written, along with a C# project file named <code>HelloWorld.csproj</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Resolve the build assets:</p>
<div class="ulist">
<ul>
<li>
<p>For <strong>.NET Core 2.0</strong>, this step is optional. The <code>dotnet restore</code> command executes automatically when a new project is created.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Run the "Hello World" program:</p>
<div class="ulist">
<ul>
<li>
<p>Type <code>dotnet run</code>.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="debug"><a class="anchor" href="#debug"></a>17.6. <span class="navy">Debug</span></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open Program.cs by clicking on it. The first time you open a C# file in Visual Studio Code, OmniSharp will load in the editor.</p>
</li>
<li>
<p>Visual Studio Code will prompt you to add the missing assets to build and debug your app. Select Yes.</p>
</li>
<li>
<p>To open the Debug view, click on the Debugging icon on the left side menu.</p>
</li>
<li>
<p>Locate the green arrow at the top of the pane. Make sure the drop-down next to it has <code>.NET Core Launch (console)</code> selected.</p>
</li>
<li>
<p>Add a breakpoint to your project by clicking on the <strong>editor margin</strong> (the space on the left of the line numbers in the editor).</p>
</li>
<li>
<p>Select F5 or the green arrow to start debugging. The debugger stops execution of your program when it reaches the breakpoint you set in the previous step.</p>
<div class="ulist">
<ul>
<li>
<p>While debugging you can view your local variables in the top left pane or use the debug console.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Select the green arrow at the top to continue debugging, or select the red square at the top to stop.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="-14"><a class="anchor" href="#-14"></a>==</h4>
<div class="paragraph">
<p>For more information and troubleshooting tips on .NET Core debugging with OmniSharp in Visual Studio Code, see <a href="https://github.com/OmniSharp/omnisharp-vscode/blob/master/debugger.md">Instructions for setting up the .NET Core debugger</a>.
== ==</p>
</div>
</div>
<div class="sect3">
<h4 id="external-links-4"><a class="anchor" href="#external-links-4"></a>17.7. <span class="navy">External links</span></h4>
<div class="paragraph">
<p><a href="https://www.microsoft.com/net/core">.Net Core</a></p>
</div>
<div class="paragraph">
<p><a href="https://code.visualstudio.com/docs/other/dotnet">Using .NET Core in Visual Studio Code</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/dotnet/core/tutorials/with-visual-studio-code">.Net Core in Visual Studio Code tutorial</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="packages-2"><a class="anchor" href="#packages-2"></a>18. Packages</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="packages-3"><a class="anchor" href="#packages-3"></a>18.1. Packages</h4>

</div>
<div class="sect3">
<h4 id="packages-overview"><a class="anchor" href="#packages-overview"></a>18.2. Packages overview</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<em>devon4Net</em> is composed by a number of packages that increases the functionality and boosts time development. Each package has it&#8217;s own configuration to make them work properly. In <em>appsettings.json</em> set up your environment. On <em>appsettings.{environment}.json</em> you can configure each component.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="the-packages"><a class="anchor" href="#the-packages"></a>18.3. The packages</h4>
<div class="paragraph">
<p>You can get the devon4Net packages on <a href="https://www.nuget.org/packages?q=devonfw">nuget.org</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-application-webapi-configuration"><a class="anchor" href="#devon4net-application-webapi-configuration"></a>18.4. <code>Devon4Net</code>.Application.WebAPI.Configuration</h4>

</div>
<div class="sect3">
<h4 id="description"><a class="anchor" href="#description"></a>18.5. ==  Description</h4>
<div class="paragraph">
<p>The devon4Net web API configuration core.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-5"><a class="anchor" href="#configuration-5"></a>18.6. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Install package on your solution:</p>
<div class="literalblock">
<div class="content">
<pre>PM&gt; Install-Package Devon4Net.Application.WebAPI.Configuration</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="default-configuration-values"><a class="anchor" href="#default-configuration-values"></a>18.7. ==  Default configuration values</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  "devonfw": {
    "UseDetailedErrorsKey": true,
    "UseIIS": false,
    "UseSwagger": true,
    "Environment": "Development",
    "KillSwitch": {
      "killSwitchSettingsFile": "killswitch.appsettings.json"
    },
    "Kestrel": {
      "UseHttps": true,
      "HttpProtocol": "Http2", //Http1, Http2, Http1AndHttp2, none
      "ApplicationPort": 8082,
      "KeepAliveTimeout": 120, //in seconds
      "MaxConcurrentConnections": 100,
      "MaxConcurrentUpgradedConnections": 100,
      "MaxRequestBodySize": 28.6, //In MB. The default maximum request body size is 30,000,000 bytes, which is approximately 28.6 MB
      "Http2MaxStreamsPerConnection": 100,
      "Http2InitialConnectionWindowSize": 131072, // From 65,535 and less than 2^31 (2,147,483,648)
      "Http2InitialStreamWindowSize": 98304, // From 65,535 and less than 2^31 (2,147,483,648)
      "AllowSynchronousIO": true,
      "SslProtocol": "Tls12", //Tls, Tls11,Tls12, Tls13, Ssl2, Ssl3, none. For Https2 Tls12 is needed
      "ServerCertificate": {
        "Certificate": "localhost.pfx",
        "CertificatePassword": "localhost"
      },
      "ClientCertificate": {
        "DisableClientCertificateCheck": true,
        "RequireClientCertificate": false,
        "CheckCertificateRevocation": true,
        "ClientCertificates": {
          "Whitelist": [
            "3A87A49460E8FE0E2A198E63D408DC58435BC501"
          ],
          "DisableClientCertificateCheck": false
        }
      }
    },
    "IIS": {
      "ForwardClientCertificate": true,
      "AutomaticAuthentication": true,
      "AuthenticationDisplayName" : ""
    }
  }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-infrastructure-circuitbreaker"><a class="anchor" href="#devon4net-infrastructure-circuitbreaker"></a>18.8. Devon4Net.Infrastructure.CircuitBreaker</h4>

</div>
<div class="sect3">
<h4 id="description-2"><a class="anchor" href="#description-2"></a>18.9. ==  Description</h4>
<div class="paragraph">
<p>The Devon4Net.Infrastructure.CircuitBreaker component implements the retry pattern for HTTP/HTTPS calls.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-6"><a class="anchor" href="#configuration-6"></a>18.10. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Install package on your solution:</p>
<div class="literalblock">
<div class="content">
<pre>PM&gt; Install-Package Devon4Net.Infrastructure.CircuitBreaker</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="default-configuration-values-2"><a class="anchor" href="#default-configuration-values-2"></a>18.11. ==  Default configuration values</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>  "CircuitBreaker": {
    "CheckCertificate": true,
    "Endpoints": [
      {
        "Name": "SampleService",
        "BaseAddress": "https://localhost:5001/",
        "Headers": {
        },
        "WaitAndRetrySeconds": [
          0.0001,
          0.0005,
          0.001
        ],
        "DurationOfBreak": 0.0005,
        "UseCertificate": true,
        "Certificate": "localhost.pfx",
        "CertificatePassword": "localhost",
        "SslProtocol": "3072" //TLS12
      }
    ]
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|<strong>Property</strong>|<strong>Description</strong>
|<code>CheckCertificate</code>| True if HTTPS is required. This is useful when developing an API Gateway needs a secured HTTP, disabling this on development we can use communications with a valid server certificate
|Endpoints| Array with predefined sites to connect with
|Name| The name key to identify the destination URL
|Headers| Not ready yet
|WaitAndRetrySeconds| Array which determines the number of retries and the lapse period between each retry. The value is in milliseconds.
|Certificate| Ceritificate client to use to perform the HTTP call
|<code>SslProtocol</code>| The secure protocol to use on the call
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect3">
<h4 id="protocols"><a class="anchor" href="#protocols"></a>18.12. ==  Protocols</h4>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|<strong>Protocol</strong>|<strong>Key</strong>|<strong>Description</strong>
|SSl3|48| Specifies the Secure Socket Layer (SSL) 3.0 security protocol. SSL 3.0 has been superseded by the Transport Layer Security (TLS) protocol and is provided for backward compatibility only.
|TLS|192|Specifies the Transport Layer Security (TLS) 1.0 security protocol. The TLS 1.0 protocol is defined in IETF RFC 2246.
|TLS11|768| Specifies the Transport Layer Security (TLS) 1.1 security protocol. The TLS 1.1 protocol is defined in IETF RFC 4346. On Windows systems, this value is supported starting with Windows 7.
|TLS12|3072| Specifies the Transport Layer Security (TLS) 1.2 security protocol. The TLS 1.2 protocol is defined in IETF RFC 5246. On Windows systems, this value is supported starting with Windows 7.
|TLS13|12288| Specifies the TLS 1.3 security protocol. The TLS protocol is defined in IETF RFC 8446.</p>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect3">
<h4 id="usage-6"><a class="anchor" href="#usage-6"></a>18.13. ==  Usage</h4>
<div class="paragraph">
<p>Add via Dependency Injection the circuit breaker instance. PE:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">    public class FooService : Service&lt;TodosContext&gt;, ILoginService
    {
 public FooService(IUnitOfWork&lt;AUTContext&gt; uoW,  ICircuitBreakerHttpClient circuitBreakerClient,
            ILogger&lt;LoginService&gt; logger) : base(uoW)
        {
        ...
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point you can use the circuit breaker functionality in your code.</p>
</div>
<div class="paragraph">
<p>To perform a POST call you should use your circuit breaker instance as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">await circuitBreakerClient.PostAsync&lt;YourOutputClass&gt;(NameOftheService, EndPoint, InputData, MediaType.ApplicationJson).ConfigureAwait(false);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|<strong>Property</strong>|<strong>Description</strong>
|YourOutputClass| The type of the class that you are expecting to retrieve from the POST call
|NameOftheService| The key name of the endpoint provided in the appsettings.json file at Endpoints[] node
|<code>EndPoint</code>|Part of the url to use with the base address. PE: <em>/validate</em>
|<code>InputData</code>| Your instance of the class with values that you want to use in the POST call
|<code>MediaType.ApplicationJson</code>| The media type flag for the POST call
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-domain-unitofwork"><a class="anchor" href="#devon4net-domain-unitofwork"></a>18.14. devon4Net.Domain.UnitOfWork</h4>

</div>
<div class="sect3">
<h4 id="description-3"><a class="anchor" href="#description-3"></a>18.15. ==  Description</h4>
<div class="paragraph">
<p>Unit of work implementation for devon4net solution. This unit of work provides the different methods to access the data layer with an atomic context. Sync and Async repository operations are provided. Customized Eager Loading method also provided for custom entity properties.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This component will move on next releases to Infrastructure instead of being part of Domain components
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="configuration-7"><a class="anchor" href="#configuration-7"></a>18.16. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Install package on your solution:</p>
<div class="literalblock">
<div class="content">
<pre>PM&gt; Install-Package devon4Net.Domain.UnitOfWork</pre>
</div>
</div>
</li>
<li>
<p>Adding the database connection information:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add the database connection on the <code>SetupDatabase</code> method at Startup.cs</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">       private void SetupDatabase(IServiceCollection services)
        {
            services.SetupDatabase&lt;TodoContext&gt;(Configuration, "Default", WebAPI.Configuration.Enums.DatabaseType.InMemory);
        }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|<strong>Param</strong>|<strong>Description</strong>
|<code>TodoContext</code>| Is the database context definition
|Default| Is the connection string defined at <em>ConnectionString</em> node at the appsettings configuration file
|WebAPI.Configuration.Enums.DatabaseType.InMemory| Is the database driver selection. In this case <code>InMemory</code> data base is chosen
|== == == == == == == == == == == =</p>
</div>
<div class="paragraph">
<p>The supported databases are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SqlServer</code></p>
</li>
<li>
<p>Sqlite</p>
</li>
<li>
<p><code>InMemory</code></p>
</li>
<li>
<p>Cosmos</p>
</li>
<li>
<p>PostgreSQL</p>
</li>
<li>
<p><code>MySql</code></p>
</li>
<li>
<p><code>MariaDb</code></p>
</li>
<li>
<p><code>FireBird</code></p>
</li>
<li>
<p>Oracle</p>
</li>
<li>
<p>MSAccess</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="notes"><a class="anchor" href="#notes"></a>18.17. ==  Notes</h4>
<div class="paragraph">
<p>Now you can use the unit of work via dependency injection on your classes:</p>
</div>
<div id="img-t-architecture" class="imageblock">
<div class="content">
<a class="image" href="images/uow_sample.png"><img src="_images/images/uow_sample.png" alt="UOW `DI` Sample" width="*"></a>
</div>
<div class="title">Figure 76. Use of Unit of work via dependency injection</div>
</div>
<div class="paragraph">
<p>As you can see in the image, you can use Unit Of Work class with your defined <code>ModelContext</code> classes.</p>
</div>
<div class="paragraph">
<p><em>Predicate expression builder</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use this expression builder to generate lambda expressions dynamically.</p>
<div class="literalblock">
<div class="content">
<pre>var predicate =  PredicateBuilder.True&lt;T&gt;();</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Where <code>T</code> is a class. At this moment, you can build your expression and apply it to obtain your results in a efficient way and not retrieving data each time you apply an expression.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Example from My Thai Star .Net Core implementation:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">public async Task&lt;PaginationResult&lt;Dish&gt;&gt; GetpagedDishListFromFilter(int currentpage, int pageSize, bool isFav, decimal maxPrice, int minLikes, string searchBy, IList&lt;long&gt; categoryIdList, long userId)
{
    var includeList = new List&lt;string&gt;{"DishCategory","DishCategory.IdCategoryNavigation", "DishIngredient","DishIngredient.IdIngredientNavigation","IdImageNavigation"};

    //Here we create our predicate builder
    var dishPredicate = PredicateBuilder.True&lt;Dish&gt;();


    //Now we start applying the different criteria:
    if (!string.IsNullOrEmpty(searchBy))
    {
        var criteria = searchBy.ToLower();
        dishPredicate = dishPredicate.And(d =&gt; d.Name.ToLower().Contains(criteria) || d.Description.ToLower().Contains(criteria));
    }

    if (maxPrice &gt; 0) dishPredicate = dishPredicate.And(d=&gt;d.Price&lt;=maxPrice);

    if (categoryIdList.Any())
    {
        dishPredicate = dishPredicate.And(r =&gt; r.DishCategory.Any(a =&gt; categoryIdList.Contains(a.IdCategory)));
    }

    if (isFav &amp;&amp; userId &gt;= 0)
    {
        var favourites = await UoW.Repository&lt;UserFavourite&gt;().GetAllAsync(w=&gt;w.IdUser ==  userId);
        var dishes = favourites.Select(s =&gt; s.IdDish);
        dishPredicate = dishPredicate.And(r=&gt; dishes.Contains(r.Id));
    }

    // Now we can use the predicate to retrieve data from database with just one call
    return await UoW.Repository&lt;Dish&gt;().GetAllIncludePagedAsync(currentpage, pageSize, includeList, dishPredicate);

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-infrastructure-extensions"><a class="anchor" href="#devon4net-infrastructure-extensions"></a>18.18. devon4Net.Infrastructure.Extensions</h4>

</div>
<div class="sect3">
<h4 id="description-4"><a class="anchor" href="#description-4"></a>18.19. ==  Description</h4>
<div class="paragraph">
<p>Miscellaneous extension library which contains :
- Predicate expression builder
- <code>DateTime</code> formatter
- <code>HttpClient</code>
- <code>HttpContext</code> (Middleware support)</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-8"><a class="anchor" href="#configuration-8"></a>18.20. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Install package on your solution:</p>
<div class="literalblock">
<div class="content">
<pre>PM&gt; Install-Package devon4Net.Infrastructure.Extensions</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>HttpContext</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p>TryAddHeader method is used on <em>devon4Net.Infrastructure.Middleware</em> component to add automatically response header options such authorization.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-infrastructure-jwt"><a class="anchor" href="#devon4net-infrastructure-jwt"></a>18.21. devon4Net.Infrastructure.JWT</h4>

</div>
<div class="sect3">
<h4 id="description-5"><a class="anchor" href="#description-5"></a>18.22. ==  Description</h4>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>JSON Web Token (JWT) is an open standard (RFC 7519) that defines a compact and self-contained way for securely transmitting information between parties as a JSON object. This information can be verified and trusted because it is digitally signed. JWTs can be signed using a secret (with the` HMAC` algorithm) or a public/private key pair using <code>RSA</code> or <code>ECDSA</code>.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; What is JSON Web Token?<br>
<cite>https://jwt.io/introduction/</cite>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>devon4Net component to manage  JWT standard to provide security to .Net API applications.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="configuration-9"><a class="anchor" href="#configuration-9"></a>18.23. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Install package on your solution:</p>
<div class="literalblock">
<div class="content">
<pre>PM&gt; devon4Net.Infrastructure.JWT</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="default-configuration-values-3"><a class="anchor" href="#default-configuration-values-3"></a>18.24. ==  Default configuration values</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>"JWT": {
    "Audience": "devon4Net",
    "Issuer": "devon4Net",
    "TokenExpirationTime": 60,
    "ValidateIssuerSigningKey": true,
    "ValidateLifetime": true,
    "ClockSkew": 5,
    "Security": {
      "SecretKeyLengthAlgorithm": "",
      "SecretKeyEncryptionAlgorithm": "",
      "SecretKey": "",
      "Certificate": "",
      "CertificatePassword": "",
      "CertificateEncryptionAlgorithm": ""
    }
  }</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>ClockSkew</em></code> indicates the token expiration time in minutes</p>
</li>
<li>
<p><code><em>Certificate</em></code> you can specify the name of your certificate (if it is on the same path) or the full path of the certificate. If the certificate does not exists an exception will be raised.</p>
</li>
<li>
<p><code><em>SecretKeyLengthAlgorithm</em></code>, <code><em>SecretKeyEncryptionAlgorithm</em></code> and <code><em>CertificateEncryptionAlgorithm</em></code> supported algorithms are:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|<strong>Algorithm</strong>|<strong>Description</strong>
|<code>Aes128Encryption</code>|"http://www.w3.org/2001/04/xmlenc#aes128-cbc"
|<code>Aes192Encryption</code>|"http://www.w3.org/2001/04/xmlenc#aes192-cbc"
|<code>Aes256Encryption</code>|"http://www.w3.org/2001/04/xmlenc#aes256-cbc"
|<code>DesEncryption</code>|"http://www.w3.org/2001/04/xmlenc#des-cbc"
|Aes128KeyWrap|"http://www.w3.org/2001/04/xmlenc#kw-aes128"
|Aes192KeyWrap|"http://www.w3.org/2001/04/xmlenc#kw-aes192"
|Aes256KeyWrap|"http://www.w3.org/2001/04/xmlenc#kw-aes256"
|RsaV15KeyWrap|"http://www.w3.org/2001/04/xmlenc#rsa-1_5"
|<code>Ripemd160Digest</code>|"http://www.w3.org/2001/04/xmlenc#ripemd160"
|RsaOaepKeyWrap|"http://www.w3.org/2001/04/xmlenc#rsa-oaep"
|Aes128KW|"A128KW"
|Aes256KW|"A256KW"
|RsaPKCS1|"RSA1_5"
|RsaOAEP|"RSA-OAEP"
|<code>ExclusiveC14n</code>|"http://www.w3.org/2001/10/xml-exc-c14n#"
|ExclusiveC14nWithComments|"http://www.w3.org/2001/10/xml-exc-c14n#WithComments"
|<code>EnvelopedSignature</code>|"http://www.w3.org/2000/09/xmldsig#enveloped-signature"
|<code>Sha256Digest</code>|"http://www.w3.org/2001/04/xmlenc#sha256"
|<code>Sha384Digest</code>|"http://www.w3.org/2001/04/xmldsig-more#sha384"
|<code>Sha512Digest</code>|"http://www.w3.org/2001/04/xmlenc#sha512"
|Sha256|"SHA256"
|Sha384|"SHA384"
|Sha512|"SHA512"
|EcdsaSha256Signature|"http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256"
|EcdsaSha384Signature|"http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384"
|EcdsaSha512Signature|"http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512"
|HmacSha256Signature|"http://www.w3.org/2001/04/xmldsig-more#hmac-sha256"
|HmacSha384Signature|"http://www.w3.org/2001/04/xmldsig-more#hmac-sha384"
|HmacSha512Signature|"http://www.w3.org/2001/04/xmldsig-more#hmac-sha512"
|RsaSha256Signature|"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"
|RsaSha384Signature|"http://www.w3.org/2001/04/xmldsig-more#rsa-sha384"
|RsaSha512Signature|"http://www.w3.org/2001/04/xmldsig-more#rsa-sha512"
|RsaSsaPssSha256Signature|"http://www.w3.org/2007/05/xmldsig-more#sha256-rsa-MGF1"
|RsaSsaPssSha384Signature|"http://www.w3.org/2007/05/xmldsig-more#sha384-rsa-MGF1"
|RsaSsaPssSha512Signature|"http://www.w3.org/2007/05/xmldsig-more#sha512-rsa-MGF1"
|<code>EcdsaSha256</code>|"ES256"
|<code>EcdsaSha384</code>|"ES384"
|<code>EcdsaSha512</code>|"ES512"
|<code>HmacSha256</code>|"HS256"
|<code>HmacSha384</code>|"HS384"
|<code>HmacSha512</code>|"HS512"
|None|"none"
|<code>RsaSha256</code>|"RS256"
|<code>RsaSha384</code>|"RS384"
|<code>RsaSha512</code>|"RS512"
|RsaSsaPssSha256|"PS256"
|RsaSsaPssSha384|"PS384"
|RsaSsaPssSha512|"PS512"
|Aes128CbcHmacSha256|"A128CBC-HS256"
|Aes192CbcHmacSha384|"A192CBC-HS384"
|Aes256CbcHmacSha512|"A256CBC-HS512"
|== == == == == == == == == == == =</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please check <a href="https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/wiki/Supported-Algorithms">Microsoft documentation</a> to get the lastest updates on supported encryption algorithms
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Add this line of code  (only if you use this component stand alone):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>services.AddBusinessCommonJwtPolicy();</code></pre>
</div>
</div>
<div class="paragraph">
<p>On</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Startup.cs</pre>
</div>
</div>
<div class="paragraph">
<p>or on:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>devon4Net.Application.Configuration.Startup/JwtApplicationConfiguration/ConfigureJwtPolicy method.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Inside the <code><em>AddBusinessCommonJwtPolicy</em></code> method you can add your  JWT Policy like in My Thai Star application sample:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#"> services.ConfigureJwtAddPolicy("MTSWaiterPolicy", "role", "waiter");</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="notes-2"><a class="anchor" href="#notes-2"></a>18.25. ==  Notes</h4>
<div class="ulist">
<ul>
<li>
<p>The certificate will be used to generate the key to encrypt the json web token.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-infrastructure-middleware"><a class="anchor" href="#devon4net-infrastructure-middleware"></a>18.26. devon4Net.Infrastructure.Middleware</h4>

</div>
<div class="sect3">
<h4 id="description-6"><a class="anchor" href="#description-6"></a>18.27. ==  Description</h4>
<div class="ulist">
<ul>
<li>
<p>devon4Net support for middleware classes.</p>
</li>
<li>
<p>In ASP.NET Core, middleware classes can handle an HTTP request or response. Middleware can either:</p>
<div class="ulist">
<ul>
<li>
<p>Handle an incoming HTTP request by generating an HTTP response.</p>
</li>
<li>
<p>Process an incoming HTTP request, modify it, and pass it on to another piece of middleware.</p>
</li>
<li>
<p>Process an outgoing HTTP response, modify it, and pass it on to either another piece of middleware, or the ASP.NET Core web server.</p>
</li>
</ul>
</div>
</li>
<li>
<p>devon4Net supports the following automatic response headers:</p>
<div class="ulist">
<ul>
<li>
<p><code>AccessControlExposeHeader</code></p>
</li>
<li>
<p><code>StrictTransportSecurityHeader</code></p>
</li>
<li>
<p><code>XFrameOptionsHeader</code></p>
</li>
<li>
<p><code>XssProtectionHeader</code></p>
</li>
<li>
<p><code>XContentTypeOptionsHeader</code></p>
</li>
<li>
<p><code>ContentSecurityPolicyHeader</code></p>
</li>
<li>
<p><code>PermittedCrossDomainPoliciesHeader</code></p>
</li>
<li>
<p><code>ReferrerPolicyHeader:toc: macro</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="configuration-10"><a class="anchor" href="#configuration-10"></a>18.28. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Install package on your solution:</p>
<div class="literalblock">
<div class="content">
<pre>PM&gt; Install-Package devon4Net.Infrastructure.Middleware</pre>
</div>
</div>
</li>
<li>
<p>You can configure your Middleware configuration on <em>appsettings.{environment}.json</em>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>"Middleware": {
    "Headers": {
      "AccessControlExposeHeader": "Authorization",
      "StrictTransportSecurityHeader": "",
      "XFrameOptionsHeader": "DENY",
      "XssProtectionHeader": "1;mode=block",
      "XContentTypeOptionsHeader": "nosniff",
      "ContentSecurityPolicyHeader": "",
      "PermittedCrossDomainPoliciesHeader": "",
      "ReferrerPolicyHeader": ""
    }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>On the above sample, the server application will add to response header the <code>AccessControlExposeHeader</code>, XFrameOptionsHeader, XssProtectionHeader and XContentTypeOptionsHeader headers.</p>
</li>
<li>
<p>If the header response type does not have a value, it will not be added to the response headers.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-infrastructure-swagger"><a class="anchor" href="#devon4net-infrastructure-swagger"></a>18.29. devon4Net.Infrastructure.Swagger</h4>

</div>
<div class="sect3">
<h4 id="description-7"><a class="anchor" href="#description-7"></a>18.30. ==  Description</h4>
<div class="ulist">
<ul>
<li>
<p>devon4net Swagger abstraction to provide full externalized easy configuration.</p>
</li>
<li>
<p>Swagger offers the easiest to use tools to take full advantage of all the capabilities of the OpenAPI Specification (OAS).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="configuration-11"><a class="anchor" href="#configuration-11"></a>18.31. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Install package on your solution:</p>
<div class="literalblock">
<div class="content">
<pre>PM&gt; devon4Net.Infrastructure.Swagger</pre>
</div>
</div>
</li>
<li>
<p>You can configure your Swagger configuration on <em>appsettings.{environment}.json</em>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>"Swagger": {
    "Version": "v1",
    "Title": "devon4net API",
    "Description": "devon4net API Contract",
    "Terms": "https://www.devonfw.com/terms-of-use/",
    "Contact": {
      "Name": "devonfw",
      "Email": "sample@mail.com",
      "Url": "https://www.devonfw.com"
    },
    "License": {
      "Name": "devonfw - Terms of Use",
      "Url": "https://www.devonfw.com/terms-of-use/"
    },
    "Endpoint": {
      "Name": "V1 Docs",
      "Url": "/swagger/v1/swagger.json",
      "UrlUi": "swagger",
      "RouteTemplate": "swagger/v1/{documentName}/swagger.json"
    }
  }</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Add this line of code (only if you use this component stand alone):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">services.ConfigureSwaggerService();</code></pre>
</div>
</div>
<div class="paragraph">
<p>On</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Startup.cs</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Also add this line of code  (only if you use this component stand alone):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">app.ConfigureSwaggerApplication();</code></pre>
</div>
</div>
<div class="paragraph">
<p>On</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Startup.cs/Configure(IApplicationBuilder app, IHostingEnvironment env)</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Ensure your API actions and non-route parameters are decorated with explicit "Http" and "From" bindings.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="notes-3"><a class="anchor" href="#notes-3"></a>18.32. ==  Notes</h4>
<div class="ulist">
<ul>
<li>
<p>To access to swagger UI launch your API project and type in your html browser the url <em><a href="http://localhost:yourPort/swagger" class="bare">http://localhost:yourPort/swagger</a></em>.</p>
</li>
<li>
<p>In order to generate the documentation annotate your actions with summary, remarks and response tags:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>/// &lt;summary&gt;
/// Method to make a reservation with potential guests. The method returns the reservation token with the format: {(CB_|GB_)}{now.Year}{now.Month:00}{now.Day:00}{_}{MD5({Host/Guest-email}{now.Year}{now.Month:00}{now.Day:00}{now.Hour:00}{now.Minute:00}{now.Second:00})}
/// &lt;/summary&gt;
/// &lt;param name="bookingDto"&gt;&lt;/param&gt;
/// &lt;response code="201"&gt;Ok.&lt;/response&gt;
/// &lt;response code="400"&gt;Bad request. Parser data error.&lt;/response&gt;
/// &lt;response code="401"&gt;Unauthorized. Authentication fail.&lt;/response&gt;
/// &lt;response code="403"&gt;Forbidden. Authorization error.&lt;/response&gt;
/// &lt;response code="500"&gt;Internal Server Error. The search process ended with error.&lt;/response&gt;
[HttpPost]
[HttpOptions]
[Route("/mythaistar/services/rest/bookingmanagement/v1/booking")]
[AllowAnonymous]
[EnableCors("CorsPolicy")]
public async Task&lt;IActionResult&gt; Booking([FromBody]BookingDto bookingDto)
{
    try
    {

    ...</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Ensure that your project has the <em>generateXMLdocumentationfile</em> check active on build menu:</p>
</li>
</ul>
</div>
<div id="img-t-architecture" class="imageblock">
<div class="content">
<a class="image" href="images/swaggerDocXMLCheck.png"><img src="_images/images/swaggerDocXMLCheck.png" alt="Generate documentation XML check" width="*"></a>
</div>
<div class="title">Figure 77. Swagger documentation</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Ensure that your XML files has the attribute copy always to true:</p>
</li>
</ul>
</div>
<div id="img-t-architecture" class="imageblock">
<div class="content">
<a class="image" href="images/swaggerDoc.png"><img src="_images/images/swaggerDoc.png" alt="Generate documentation XML check" width="*"></a>
</div>
<div class="title">Figure 78. Swagger documentation</div>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-infrastructure-test"><a class="anchor" href="#devon4net-infrastructure-test"></a>18.33. devon4Net.Infrastructure.Test</h4>

</div>
<div class="sect3">
<h4 id="description-8"><a class="anchor" href="#description-8"></a>18.34. ==  Description</h4>
<div class="paragraph">
<p>devon4Net Base classes to create unit tests and integration tests with Moq and <code>xUnit</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-12"><a class="anchor" href="#configuration-12"></a>18.35. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Load the template:
&gt; dotnet new -i devon4Net.Test.Template
&gt; dotnet new devon4NetTest</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="notes-4"><a class="anchor" href="#notes-4"></a>18.36. ==  Notes</h4>
<div class="ulist">
<ul>
<li>
<p>At this point you can find this classes:</p>
<div class="ulist">
<ul>
<li>
<p>BaseManagementTest</p>
</li>
<li>
<p>DatabaseManagementTest&lt;T&gt; (Where <code>T</code> is a <em>devon4NetBaseContext</em> class)</p>
</li>
</ul>
</div>
</li>
<li>
<p>For unit testing, inherit a class from <em>BaseManagementTest</em>.</p>
</li>
<li>
<p>For integration tests, inherit a class from <em>DatabaseManagementTest</em>.</p>
</li>
<li>
<p>The recommended databases in integration test are <em>in memory database</em> or <em>SQlite database</em>.</p>
</li>
<li>
<p>Please check <em>My thai Star</em> test project.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="deperecated-packages"><a class="anchor" href="#deperecated-packages"></a>18.37. Deperecated packages</h4>

</div>
<div class="sect3">
<h4 id="devon4net-domain-context"><a class="anchor" href="#devon4net-domain-context"></a>18.38. devon4Net.Domain.Context</h4>

</div>
<div class="sect3">
<h4 id="description-9"><a class="anchor" href="#description-9"></a>18.39. ==  Description</h4>
<div class="paragraph">
<p>devon4Net.Domain.Context contains the extended class devon4NetBaseContext in order to make easier the process of having a model context configured against different database engines. This configuration allows an easier testing configuration against local and in memory databases.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-13"><a class="anchor" href="#configuration-13"></a>18.40. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Install package on your solution:</p>
<div class="literalblock">
<div class="content">
<pre>PM&gt; Install-Package devon4Net.Domain.Context</pre>
</div>
</div>
</li>
<li>
<p>Add to <em>appsettings.{environment}.json</em> file your database connections:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>"ConnectionStrings":
{
"DefaultConnection":
"Server=localhost;Database=MyThaiStar;User Id=sa;Password=sa;MultipleActiveResultSets=True;",

"AuthConnection":
"Server=(localdb)\\mssqllocaldb;Database=aspnet-DualAuthCore-5E206A0B-D4DA-4E71-92D3-87FD6B120C5E;Trusted_Connection=True;MultipleActiveResultSets=true",

"SqliteConnection": "Data Source=c:\\tmp\\membership.db;"
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>On Startup.cs :</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">void ConfigureServices(IServiceCollection services)</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Add your database connections defined on previous point:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">services.ConfigureDataBase(
new Dictionary&lt;string, string&gt; {
{ConfigurationConst.DefaultConnection, Configuration.GetConnectionString(ConfigurationConst.DefaultConnection) }});</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>On devon4Net.Application.Configuration.Startup/DataBaseConfiguration/ConfigureDataBase configure your connections.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-infrastructure-applicationuser"><a class="anchor" href="#devon4net-infrastructure-applicationuser"></a>18.41. devon4Net.Infrastructure.ApplicationUser</h4>

</div>
<div class="sect3">
<h4 id="description-10"><a class="anchor" href="#description-10"></a>18.42. ==  Description</h4>
<div class="paragraph">
<p>devon4Net Application user classes to implement basic Microsoft&#8217;s basic authentication in order to be used on authentication methodologies such Jason Web Token (JWT).</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-14"><a class="anchor" href="#configuration-14"></a>18.43. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Install package on your solution:</p>
<div class="literalblock">
<div class="content">
<pre>PM&gt; devon4Net.Infrastructure.ApplicationUser</pre>
</div>
</div>
</li>
<li>
<p>Add the database connection string for user management on <em>appsettings.{environment}.json</em>:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>"ConnectionStrings":
{
"AuthConnection":
"Server=(localdb)\\mssqllocaldb;Database=aspnet-DualAuthCore-5E206A0B-D4DA-4E71-92D3-87FD6B120C5E;Trusted_Connection=True;MultipleActiveResultSets=true"
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the following line of code</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>services.AddApplicationUserDependencyInjection();</code></pre>
</div>
</div>
<div class="paragraph">
<p>On</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Startup.cs/ConfigureServices(IServiceCollection services)</pre>
</div>
</div>
<div class="paragraph">
<p>or on:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>devon4Net.Application.Configuration.Startup/DependencyInjectionConfiguration/ConfigureDependencyInjectionService method.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the data seeder on Configure method on start.cs class:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">public void Configure(IApplicationBuilder app, IHostingEnvironment env, DataSeeder seeder)
{
    ...

    app.UseAuthentication();
    seeder.SeedAsync().Wait();

    ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="notes-5"><a class="anchor" href="#notes-5"></a>18.44. ==  Notes</h4>
<div class="ulist">
<ul>
<li>
<p>You can use the following methods to set up the database configuration:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>public static void AddApplicationUserDbContextInMemoryService(this IServiceCollection services)

public static void AddApplicationUserDbContextSQliteService(this IServiceCollection services, string connectionString)

public static void AddApplicationUserDbContextSQlServerService(this IServiceCollection services, string connectionString)</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The method <code><em>AddApplicationUserDbContextInMemoryService</em></code> uses the <em>AuthContext</em> connection string name to set up the database.</p>
</li>
<li>
<p>This component is used with the components <em>devon4Net.Infrastructure.JWT</em> and <em>devon4Net.Infrastructure.JWT.MVC</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-infrastructure-communication"><a class="anchor" href="#devon4net-infrastructure-communication"></a>18.45. devon4Net.Infrastructure.Communication</h4>

</div>
<div class="sect3">
<h4 id="description-11"><a class="anchor" href="#description-11"></a>18.46. ==  Description</h4>
<div class="paragraph">
<p>Basic client classes to  invoke` GET`/POST methods asynchronously. This component has the minimal classes to send basic data. For more complex operations please use <em>ASP4Net.Infrastructure.Extensions</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-15"><a class="anchor" href="#configuration-15"></a>18.47. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Install package on your solution:</p>
<div class="literalblock">
<div class="content">
<pre>PM&gt; devon4Net.Infrastructure.Communication</pre>
</div>
</div>
</li>
<li>
<p>Create an instance of <em>RestManagementService</em> class.</p>
</li>
<li>
<p>Use next methods to use GET/POST basic options:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>public Task&lt;string&gt; CallGetMethod(string url);
public Task&lt;Stream&gt; CallGetMethodAsStream(string url);
public Task&lt;string&gt; CallPostMethod&lt;T&gt;(string url, T dataToSend);
public Task&lt;string&gt; CallPutMethod&lt;T&gt;(string url, T dataToSend);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="notes-6"><a class="anchor" href="#notes-6"></a>18.48. ==  Notes</h4>
<div class="ulist">
<ul>
<li>
<p>Example:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">private async Task RestManagementServiceSample(EmailDto dataToSend)
{
    var url = Configuration["EmailServiceUrl"];
    var restManagementService = new RestManagementService();
    await restManagementService.CallPostMethod(url, dataToSend);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-infrastructure-jwt-mvc"><a class="anchor" href="#devon4net-infrastructure-jwt-mvc"></a>18.49. devon4Net.Infrastructure.JWT.MVC</h4>

</div>
<div class="sect3">
<h4 id="description-12"><a class="anchor" href="#description-12"></a>18.50. ==  Description</h4>
<div class="ulist">
<ul>
<li>
<p>devon4Net Extended controller to interact with  JWT features</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="configuration-16"><a class="anchor" href="#configuration-16"></a>18.51. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Extend your _ Microsoft.AspNetCore.Mvc.Controller_ class with <em>devon4NetJWTController</em> class:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">public class LoginController : devon4NetJWTController
{
    private readonly ILoginService _loginService;

    public LoginController(ILoginService loginService,  SignInManager&lt;ApplicationUser&gt;  signInManager, UserManager&lt;ApplicationUser&gt; userManager, ILogger&lt;LoginController&gt; logger, IMapper mapper) : base(logger,mapper)
    {
        _loginService = loginService;
    }

    ....</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="notes-7"><a class="anchor" href="#notes-7"></a>18.52. ==  Notes</h4>
<div class="ulist">
<ul>
<li>
<p>In order to generate a  JWT, you should implement the  JWT generation on user login. For example, in My Thai Star is created as follows:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>public async Task&lt;IActionResult&gt; Login([FromBody]LoginDto loginDto)
{
    try
    {
        if (loginDto ==  null) return Ok();
        var logged = await _loginService.LoginAsync(loginDto.UserName, loginDto.Password);

        if (logged)
        {
            var user = await _loginService.GetUserByUserNameAsync(loginDto.UserName);

            var encodedJwt = new JwtClientToken().CreateClientToken(_loginService.GetUserClaimsAsync(user));

            Response.Headers.Add("Access-Control-Expose-Headers", "Authorization");

            Response.Headers.Add("Authorization", $"{JwtBearerDefaults.AuthenticationScheme} {encodedJwt}");

            return Ok(encodedJwt);
        }
        else
        {
            Response.Headers.Clear();
            return StatusCode((int)HttpStatusCode.Unauthorized, "Login Error");
        }

    }
    catch (Exception ex)
    {
        return StatusCode((int)HttpStatusCode.InternalServerError, $"{ex.Message} : {ex.InnerException}");
    }
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>In My Thai Star the  JWT will contain the user information such id, roles&#8230;&#8203;</p>
</li>
<li>
<p>Once you extend your controller with <em>devon4NetJWTController</em> you will have available these methods to simplify user management:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">    public interface Idevon4NetJWTController
    {
        // Gets the current user
        JwtSecurityToken GetCurrentUser();

        // Gets an specific assigned claim of current user
        Claim GetUserClaim(string claimName, JwtSecurityToken jwtUser = null);

        // Gets all the assigned claims of current user
        IEnumerable&lt;Claim&gt; GetUserClaims(JwtSecurityToken jwtUser = null);
    }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-infrastructure-mvc"><a class="anchor" href="#devon4net-infrastructure-mvc"></a>18.53. devon4Net.Infrastructure.MVC</h4>

</div>
<div class="sect3">
<h4 id="description-13"><a class="anchor" href="#description-13"></a>18.54. ==  Description</h4>
<div class="paragraph">
<p>Common classes to extend controller functionality on API. Also provides support for paged results in devon4Net applications and automapper injected class.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-17"><a class="anchor" href="#configuration-17"></a>18.55. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Install package on your solution:</p>
<div class="literalblock">
<div class="content">
<pre>PM&gt; devon4Net.Infrastructure.MVC</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="notes-8"><a class="anchor" href="#notes-8"></a>18.56. ==  Notes</h4>
<div class="ulist">
<ul>
<li>
<p>The generic class <em>ResultObjectDto&lt;T&gt;</em> provides a typed result object with pagination.</p>
</li>
<li>
<p>The extended class provides the following methods:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">        ResultObjectDto&lt;T&gt; GenerateResultDto&lt;T&gt;(int? page, int? size, int? total);
        ResultObjectDto&lt;T&gt; GenerateResultDto&lt;T&gt;(List&lt;T&gt; result, int? page = null, int? size = null);</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><em>GenerateResultDto</em> provides typed <em>ResultObjectDto</em> object or a list of typed <em>ResultObjectDto</em> object. The aim of this methods is to provide a clean management for result objects and not repeating code through the different controller classes.</p>
</li>
<li>
<p>The following sample from <em>My Thai Star</em> shows how to use it:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">public async Task&lt;IActionResult&gt; Search([FromBody] FilterDtoSearchObject filterDto)
{
    if (filterDto ==  null) filterDto = new FilterDtoSearchObject();

    try
    {
        var dishList = await _dishService.GetDishListFromFilter(false, filterDto.GetMaxPrice(), filterDto.GetMinLikes(), filterDto.GetSearchBy(),filterDto.GetCategories(), -1);


        return new OkObjectResult(GenerateResultDto(dishList).ToJson());
    }
    catch (Exception ex)
    {
        return StatusCode((int)HttpStatusCode.InternalServerError, $"{ex.Message} : {ex.InnerException}");
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-infrastructure-aop"><a class="anchor" href="#devon4net-infrastructure-aop"></a>18.57. devon4Net.Infrastructure.AOP</h4>

</div>
<div class="sect3">
<h4 id="description-14"><a class="anchor" href="#description-14"></a>18.58. ==  Description</h4>
<div class="paragraph">
<p>Simple AOP Exception handler for .Net Controller classes integrated with Serilog.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-18"><a class="anchor" href="#configuration-18"></a>18.59. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Install package on your solution:</p>
<div class="literalblock">
<div class="content">
<pre>PM&gt; Install-Package devon4Net.Domain.AOP</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Add this line of code on <code>ConfigureServices</code> method on Startup.cs</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>services.AddAopAttributeService();</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="notes-9"><a class="anchor" href="#notes-9"></a>18.60. ==  Notes</h4>
<div class="paragraph">
<p>Now automatically your exposed API methods exposed on controller classes will be tracked on the methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>OnActionExecuting</p>
</li>
<li>
<p>OnActionExecuted</p>
</li>
<li>
<p>OnResultExecuting</p>
</li>
<li>
<p>OnResultExecuted</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If an exception occurs, a message will be displayed on log with the stack trace.</p>
</div>
</div>
<div class="sect3">
<h4 id="devon4net-infrastructure-cors"><a class="anchor" href="#devon4net-infrastructure-cors"></a>18.61. devon4Net.Infrastructure.Cors</h4>

</div>
<div class="sect3">
<h4 id="description-15"><a class="anchor" href="#description-15"></a>18.62. ==  Description</h4>
<div class="paragraph">
<p>Enables CORS configuration for devon4Net application. Multiple domains can be configured from configuration. Mandatory to web clients (p.e. Angular) to prevent making AJAX requests to another domain.</p>
</div>
<div class="paragraph">
<p>Cross-Origin Resource Sharing (CORS) is a mechanism that uses additional HTTP headers to tell a browser to let a web application running at one origin (domain) have permission to access selected resources from a server at a different origin. A web application makes a cross-origin HTTP request when it requests a resource that has a different origin (domain, protocol, and port) than its own origin.</p>
</div>
<div class="paragraph">
<p>Please refer to <a href="https://docs.microsoft.com/en-us/aspnet/core/security/cors?view=aspnetcore-2.1">this link</a> to get more information about CORS and .Net core.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-19"><a class="anchor" href="#configuration-19"></a>18.63. ==  Configuration</h4>
<div class="ulist">
<ul>
<li>
<p>Install package on your solution:</p>
<div class="literalblock">
<div class="content">
<pre>PM&gt; devon4Net.Infrastructure.Cors</pre>
</div>
</div>
</li>
<li>
<p>You can configure your Cors configuration on <em>appsettings.{environment}.json</em>:</p>
<div class="literalblock">
<div class="content">
<pre>`CorsPolicy`: indicates the name of the policy. You can use this name to add security headers on your API exposed methods.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Origins: The allowed domains</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Headers: The allowed headers such accept,content-type,origin,x-custom-header</pre>
</div>
</div>
</li>
<li>
<p>If you specify the cors configuration as empty array, a default cors-policy will be used with all origins enabled:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">  "Cors": []</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>On the other hand, you can specify different Cors policies in your solution as follows:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>"Cors": []
[
  {
    "CorsPolicy": "CorsPolicy1",
    "Origins": "http:example.com,http:www.contoso.com",
    "Headers": "accept,content-type,origin,x-custom-header",
    "Methods": "GET,POST,HEAD",
    "AllowCredentials": true
  },
  {
    "CorsPolicy": "CorsPolicy2",
    "Origins": "http:example.com,http:www.contoso.com",
    "Headers": "accept,content-type,origin,x-custom-header",
    "Methods": "GET,POST,HEAD",
    "AllowCredentials": true
  }
]</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="notes-10"><a class="anchor" href="#notes-10"></a>18.64. ==  Notes</h4>
<div class="ulist">
<ul>
<li>
<p>To use CORS in your API methods, use the next notation:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>[EnableCors("YourCorsPolicy")]
public IActionResult Index() {
    return View();
}</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>if you want to disable the CORS check use the following annotation:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-C# hljs" data-lang="C#">[DisableCors]
public IActionResult Index() {
    return View();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="required-software-2"><a class="anchor" href="#required-software-2"></a>18.65. Required software</h4>
<div class="paragraph">
<p><a href="https://code.visualstudio.com/">Visual Studio Code</a></p>
</div>
<div class="paragraph">
<p><a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.csharp">C# Extension for VS Code</a></p>
</div>
<div class="paragraph">
<p><a href="https://www.microsoft.com/net/core">.Net Core SDK</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/security/cors?view=aspnetcore-2.1">CORS in .Net Core</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="templates-2"><a class="anchor" href="#templates-2"></a>19. Templates</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="paragraph">
<p>==Templates</p>
</div>
<div class="sect3">
<h4 id="overview-5"><a class="anchor" href="#overview-5"></a>19.1. Overview</h4>
<div class="paragraph">
<p>The .Net Core and .Net Framework given templates allows to start coding an application with the following functionality ready to use:</p>
</div>
<div class="paragraph">
<p>Please refer to <a href="userguide.html">User guide</a> in order to start developing.</p>
</div>
</div>
<div class="sect3">
<h4 id="net-core-3-0"><a class="anchor" href="#net-core-3-0"></a>19.2. Net Core 3.0</h4>
<div class="paragraph">
<p>The <em>.Net Core 3.0</em> template allows you to start developing an n-layer server application to provide the latest features. The template can be used in Visual Studio Code and Visual Studio 2019.</p>
</div>
<div class="paragraph">
<p>The application result can be deployed as a console application, microservice or web page.</p>
</div>
<div class="paragraph">
<p>To start developing with devon4Net template, please follow this instructions:</p>
</div>
<div class="sect5">
<h6 id="using-devon4net-template-2"><a class="anchor" href="#using-devon4net-template-2"></a>Using devon4Net template</h6>

</div>
<div class="sect5">
<h6 id="option-1-2"><a class="anchor" href="#option-1-2"></a>Option 1</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open your favourite terminal (Win/Linux/iOS)</p>
</li>
<li>
<p>Go to future project&#8217;s path</p>
</li>
<li>
<p>Type <em>dotnet new --install Devon4Net.WebAPI.Template</em></p>
</li>
<li>
<p>Type <em>dotnet new Devon4NetAPI</em></p>
</li>
<li>
<p>Go to project&#8217;s path</p>
</li>
<li>
<p>You are ready to start developing with <em>devon4Net</em></p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="option-2-2"><a class="anchor" href="#option-2-2"></a>Option 2</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new dotnet API project from scratch</p>
</li>
<li>
<p>Add the NuGet package reference to your project</p>
</li>
<li>
<p>Type <em>dotnet new --install Devon4Net.WebAPI.Template</em></p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="net-core-2-1-x"><a class="anchor" href="#net-core-2-1-x"></a>19.3. Net Core 2.1.x</h4>
<div class="paragraph">
<p>The <em>.Net Core 2.1.x</em> template allows you to start developing an n-layer server application to provide the latest features. The template can be used in Visual Studio Code and Visual Studio 2017.</p>
</div>
<div class="paragraph">
<p>The application result can be deployed as a console application, microservice or web page.</p>
</div>
<div class="paragraph">
<p>To start developing with devon4Net template, please follow this instructions:</p>
</div>
<div class="sect5">
<h6 id="using-devon4net-template-3"><a class="anchor" href="#using-devon4net-template-3"></a>Using devon4Net template</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open your favourite terminal (Win/Linux/iOS)</p>
</li>
<li>
<p>Go to future project&#8217;s path</p>
</li>
<li>
<p>Type <em>dotnet new --install Devon4Net.WebAPI.Template::1.0.8</em></p>
</li>
<li>
<p>Type <em>dotnet new Devon4NetAPI</em></p>
</li>
<li>
<p>Go to project&#8217;s path</p>
</li>
<li>
<p>You are ready to start developing with <em>devon4Net</em></p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For the latest updates on references packages, please get the sources from <a href="https://github.com/devonfw/devon4net">Github</a>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="links"><a class="anchor" href="#links"></a>19.4. Links</h4>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-floppy-o"></i></span>  <a href="https://github.com/devonfw/devon4net/tree/develop/source/Templates">.Net templates</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="samples-2"><a class="anchor" href="#samples-2"></a>20. Samples</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="samples-3"><a class="anchor" href="#samples-3"></a>20.1. Samples</h4>

</div>
<div class="sect3">
<h4 id="my-thai-star-restaurant"><a class="anchor" href="#my-thai-star-restaurant"></a>20.2. My Thai Star Restaurant</h4>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-floppy-o"></i></span>  <a href="resources/samples/mts/MyThaiStar.zip">My Thai Star (.Net Core Server + Angular client)</a></p>
</div>
<div class="videoblock">
<div class="content">
<video src="_images/videos/mts_startup.mp4#t=0" width="640" autoplay controls>
Your browser does not support the video tag.
</video>
</div>
</div>
</div>
<div class="sect3">
<h4 id="angular-requirements"><a class="anchor" href="#angular-requirements"></a>20.3. Angular requirements</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://nodejs.org/es/download/">Node</a></p>
</li>
<li>
<p><a href="https://cli.angular.io/">Angular CLI</a></p>
</li>
<li>
<p><a href="https://yarnpkg.com/lang/en/docs/install/">Yarn</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="angular-client"><a class="anchor" href="#angular-client"></a>20.4. Angular client</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install Node.js LTS version</p>
</li>
<li>
<p>Install Angular CLI from command line:</p>
<div class="ulist">
<ul>
<li>
<p>npm install -g @angular/cli</p>
</li>
</ul>
</div>
</li>
<li>
<p>Install Yarn</p>
</li>
<li>
<p>Go to Angular client from command line</p>
</li>
<li>
<p>Execute : <em>yarn install</em></p>
</li>
<li>
<p>Launch the app from command line: <em>ng serve</em> and check <em><a href="http://localhost:4200" class="bare">http://localhost:4200</a></em></p>
</li>
<li>
<p>You are ready</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="net-core-server"><a class="anchor" href="#net-core-server"></a>20.5. .Net Core server</h4>

</div>
<div class="sect3">
<h4 id="basic-architecture-details"><a class="anchor" href="#basic-architecture-details"></a>20.6. ==  Basic architecture details</h4>
<div class="paragraph">
<p>Following the devonfw conventions the .Net Core 2.0 My Thai Star backend is going to be developed dividing the application in <em>Components</em> and using a n-layer architecture.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/project_modules.png"><img src="_images/images/project_modules.png" alt="project modules"></a>
</div>
</div>
</div>
<div class="sect3">
<h4 id="components"><a class="anchor" href="#components"></a>20.7. ==  Components</h4>
<div class="paragraph">
<p>The application is going to be divided in different components to encapsulate the different domains of the application functionalities.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/mtsn_components.png"><img src="_images/images/mtsn_components.png" alt="mtsn components"></a>
</div>
</div>
<div class="paragraph">
<p>As <em>main components</em> we will find:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>_BookingService</code>: Manages the bookings part of the application. With this component the users (anonymous/logged in) can create new bookings or cancel an existing booking. The users with waiter role can see all scheduled bookings.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>-<code><em>OrderService</em></code>: This component handles the process to order dishes (related to bookings). A user (as a host or as a guest) can create orders (that contain dishes) or cancel an existing one. The users with waiter role can see all ordered orders.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>DishService</em></code>: This component groups the logic related to the menu (dishes) view. Its main feature is to provide the client with the data of the available dishes but also can be used by other components (Ordermanagement) as a data provider in some processes.</p>
</li>
<li>
<p><code><em>UserService</em></code>: Takes care of the User Profile management, allowing to create and update the data profiles.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As <em>common components</em> (that don&#8217;t exactly represent an application&#8217;s area but provide functionalities that can be used by the <em>main components</em>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Mailservice</em>: with this service we will provide the functionality for sending email notifications. This is a shared service between different app components such as <em>bookingmanagement</em> or <em>ordercomponent</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Other components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Security (will manage the access to the <em>private</em> part of the application using a <a href="https://jwt.io/">jwt</a> implementation).</p>
</li>
<li>
<p>Twitter integration: planned as a <em>Microservice</em> will provide the twitter integration needed for some specific functionalities of the application.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="layers-7"><a class="anchor" href="#layers-7"></a>20.8. Layers</h4>

</div>
<div class="sect3">
<h4 id="introduction-9"><a class="anchor" href="#introduction-9"></a>20.9. ==  Introduction</h4>
<div class="paragraph">
<p>The .Net Core backend for My Thai Star application is going to be based on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>devon4NET</strong> as the .Net Core framework</p>
</li>
<li>
<p><strong>VSCode</strong> as the Development environment</p>
</li>
<li>
<p><strong>TOBAGO</strong> as code generation tool</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="application-layer-2"><a class="anchor" href="#application-layer-2"></a>20.10. ==  Application layer</h4>
<div class="paragraph">
<p>This layer will expose the REST api to exchange information with the client applications.</p>
</div>
<div class="paragraph">
<p>The application will expose the services on port 8081 and it can be launched as a self host console application (microservice approach) and as a Web Api application hosted on IIS/IIS Express.</p>
</div>
</div>
<div class="sect3">
<h4 id="business-layer-2"><a class="anchor" href="#business-layer-2"></a>20.11. ==  Business layer</h4>
<div class="paragraph">
<p>This layer will define the controllers which will be used on the application layer to expose the different services. Also, will define the swagger contract making use of summary comments and framework attributes.</p>
</div>
<div class="paragraph">
<p>This layer also includes the object response classes in order to interact with external clients.</p>
</div>
</div>
<div class="sect3">
<h4 id="service-layer-2"><a class="anchor" href="#service-layer-2"></a>20.12. ==  Service layer</h4>
<div class="paragraph">
<p>The layer in charge of hosting the business logic of the application. Also orchestrates the object conversion between object response and entity objects defined in <em>Data layer</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="data-layer-2"><a class="anchor" href="#data-layer-2"></a>20.13. ==  Data layer</h4>
<div class="paragraph">
<p>The layer to communicate with the data base.</p>
</div>
<div class="paragraph">
<p>Data layer makes use of <em>Entity Framework</em>.
The Database context is defined on <code><em>DataAccessLayer</em></code> assembly (<code>ModelContext</code>).</p>
</div>
<div class="paragraph">
<p>This layer makes use of the <em>Repository pattern</em> and <em>Unit of work</em> in order to encapsulate the complexity. Making use of this combined patterns we ensure an organized and easy work model.</p>
</div>
<div class="paragraph">
<p>As in the previous layers, the <em>data access</em> layer will have both <em>interface</em> and <em>implementation</em> tiers. However, in this case, the implementation will be slightly different due to the use of <em>generics</em>.</p>
</div>
</div>
<div class="sect3">
<h4 id="cross-cutting-concerns-2"><a class="anchor" href="#cross-cutting-concerns-2"></a>20.14. ==  Cross-Cutting concerns</h4>
<div class="paragraph">
<p>the layer to make use of transversal components such JWT and mailing.</p>
</div>
</div>
<div class="sect3">
<h4 id="jwt-basics"><a class="anchor" href="#jwt-basics"></a>20.15. Jwt basics</h4>
<div class="ulist">
<ul>
<li>
<p>A user will provide a username / password combination to our auth server.</p>
</li>
<li>
<p>The auth server will try to identify the user and, if the credentials match, will issue a token.</p>
</li>
<li>
<p>The user will send the token as the <em>Authorization</em> header to access resources on server protected by  JWT Authentication.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/jwt_schema.png"><img src="_images/images/jwt_schema.png" alt="jwt schema"></a>
</div>
</div>
</div>
<div class="sect3">
<h4 id="jwt-implementation-details"><a class="anchor" href="#jwt-implementation-details"></a>20.16. Jwt implementation details</h4>
<div class="paragraph">
<p>The <em>Json Web Token</em> pattern will be implemented based on the <a href="https://blogs.msdn.microsoft.com/webdev/2017/04/06/jwt-validation-and-authorization-in-asp-net-core/"><em>jwt on .net core</em></a> framework that is provided by default in the <em>devon4Net</em> projects.</p>
</div>
</div>
<div class="sect3">
<h4 id="authentication-3"><a class="anchor" href="#authentication-3"></a>20.17. Authentication</h4>
<div class="paragraph">
<p>Based on <em>Microsoft</em> approach, we will implement a class to define the security <em>entry point</em> and filters. Also, as <em>My Thai Star</em> is a mainly <em>public</em> application, we will define here the resources that won&#8217;t be secured.</p>
</div>
<div class="paragraph">
<p>On devon4Net.Infrastructure.JWT assembly is defined a subset of <em>Microsoft&#8217;s authorization schema</em> Database. It is started up the first time the application launches.</p>
</div>
<div class="paragraph">
<p>You can read more about _Authorization on:</p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/security/authorization/">Authorization in ASP.NET Core</a></p>
</div>
<div class="paragraph">
<p><a href="https://docs.microsoft.com/en-us/aspnet/core/security/authorization/claims">Claim based authorization</a></p>
</div>
</div>
<div class="sect3">
<h4 id="dependency-injection"><a class="anchor" href="#dependency-injection"></a>20.18. Dependency injection</h4>
<div class="paragraph">
<p>As it is explained in the <a href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection">Microsoft documentation</a> we are going to implement the <em>dependency injection</em> pattern basing our solution on <em>.Net Core</em>.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/dependency_injection.png"><img src="_images/images/dependency_injection.png" alt="dependency injection"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Separation of API and implementation: Inside each layer we will separate the elements in different tiers: <em>interface</em> and <em>implementation</em>. The <em>interface</em> tier will store the <em>interface</em> with the methods definition and inside the <em>implementation</em> we will store the class that implements the <em>interface</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="layer-communication-method"><a class="anchor" href="#layer-communication-method"></a>20.19. Layer communication method</h4>
<div class="paragraph">
<p>The connection between layers, to access to the functionalities of each one, will be solved using the <em>dependency injection</em>.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/layer_impl.png"><img src="_images/images/layer_impl.png" alt="layer impl"></a>
</div>
</div>
<div class="paragraph">
<p><strong>Connection <code>BookingService</code> - Logic</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c# hljs" data-lang="c#"> public class BookingService : EntityService&lt;Booking&gt;, IBookingService
    {
        private readonly IBookingRepository _bookingRepository;
        private readonly IRepository&lt;Order&gt; _orderRepository;
        private readonly IRepository&lt;InvitedGuest&gt; _invitedGuestRepository;
        private readonly IOrderLineRepository _orderLineRepository;
        private readonly IUnitOfWork _unitOfWork;

        public BookingService(IUnitOfWork unitOfWork,
            IBookingRepository repository,
            IRepository&lt;Order&gt; orderRepository,
            IRepository&lt;InvitedGuest&gt; invitedGuestRepository,
            IOrderLineRepository orderLineRepository) : base(unitOfWork, repository)
        {
            _unitOfWork = unitOfWork;
            _bookingRepository = repository;
            _orderRepository = orderRepository;
            _invitedGuestRepository = invitedGuestRepository;
            _orderLineRepository = orderLineRepository;
        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To give service to the defined <em>User Stories</em> we will need to implement the following services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>provide all available dishes.</p>
</li>
<li>
<p>save a booking.</p>
</li>
<li>
<p>save an order.</p>
</li>
<li>
<p>provide a list of bookings (only for waiters) and allow filtering.</p>
</li>
<li>
<p>provide a list of orders (only for waiters) and allow filtering.</p>
</li>
<li>
<p>login service (see the <em>Security</em> section).</p>
</li>
<li>
<p>provide the <em>current user</em> data (see the <em>Security</em> section)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Following the [naming conventions] proposed for <em>devon4Net</em> applications we will define the following <em>end points</em> for the listed services.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(POST) <code>/mythaistar/services/rest/dishmanagement/v1/dish/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/bookingmanagement/v1/booking</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/bookingmanagement/v1/booking/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/filter</code> (to filter with fields that does not belong to the Order entity).</p>
</li>
<li>
<p>(POST) <code>/mythaistar/login</code>.</p>
</li>
<li>
<p>(GET) <code>/mythaistar/services/rest/security/v1/currentuser/</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find all the details for the services implementation in the <a href="https://github.com/devonfw/my-thai-star/blob/develop/swagger/mythaistar.yaml">Swagger definition</a> included in the My Thai Star project on Github.</p>
</div>
</div>
<div class="sect3">
<h4 id="api-exposed"><a class="anchor" href="#api-exposed"></a>20.20. Api Exposed</h4>
<div class="paragraph">
<p>The <em>devon4Net.Business.Controller</em> assembly in the <em>business</em> layer of a <em>component</em> will store the definition of the service by a  <em>interface</em>. In this definition of the service we will set-up the <em>endpoints</em> of the service, the type of data expected and returned, the <em>HTTP</em> method for each endpoint of the service and other configurations if needed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c# hljs" data-lang="c#">        /// &lt;summary&gt;
        /// Method to make a reservation with potential guests. The method returns the reservation token with the format: {(CB_|GB_)}{now.Year}{now.Month:00}{now.Day:00}{_}{MD5({Host/Guest-email}{now.Year}{now.Month:00}{now.Day:00}{now.Hour:00}{now.Minute:00}{now.Second:00})}
        /// &lt;/summary&gt;

        /// &lt;param name="bookingView"&gt;&lt;/param&gt;
        /// &lt;response code="201"&gt;Ok.&lt;/response&gt;
        /// &lt;response code="400"&gt;Bad request. Parser data error.&lt;/response&gt;
        /// &lt;response code="401"&gt;Unauthorized. Authentication fail.&lt;/response&gt;
        /// &lt;response code="403"&gt;Forbidden. Authorization error.&lt;/response&gt;
        /// &lt;response code="500"&gt;Internal Server Error. The search process ended with error.&lt;/response&gt;
        [HttpPost]
        [HttpOptions]
        [Route("/mythaistar/services/rest/bookingmanagement/v1/booking")]
        [AllowAnonymous]
        [EnableCors("CorsPolicy")]
        public IActionResult BookingBooking([FromBody]BookingView bookingView)
        {
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using the summary annotations and attributes will tell to swagger the contract via the XML doc generated on compiling time. This doc will be stored in <code><em>XmlDocumentation</em></code> folder.</p>
</div>
<div class="paragraph">
<p>The Api methods will be exposed on the application layer.</p>
</div>
</div>
<div class="sect3">
<h4 id="google-mail-api-consumer"><a class="anchor" href="#google-mail-api-consumer"></a>20.21. Google Mail API Consumer</h4>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-floppy-o"></i></span>  <a href="resources/samples/components/GMailAPIConsumer.zip">Google Mail API Consumer</a></p>
</div>
<div class="paragraph">
<p>|== == == == == == == == == == == =
|Application| <code>MyThaiStarEmailService.exe</code>
|Config file| <code>MyThaiStarEmailService.exe.Config</code>
|Default port|8080
|== == == == == == == == == == == =</p>
</div>
</div>
<div class="sect3">
<h4 id="overview-6"><a class="anchor" href="#overview-6"></a>20.22. Overview</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Execute <code>MyThaiStarEmailService.exe</code>.</p>
</li>
<li>
<p>The first time google will ask you for credentials
(just one time) in your default browser:</p>
<div class="ulist">
<ul>
<li>
<p>Account: <a href="mailto:mythaistarrestaurant@gmail.com">mythaistarrestaurant@gmail.com</a></p>
</li>
<li>
<p>Password: mythaistarrestaurant2501</p>
</li>
</ul>
</div>
</li>
<li>
<p>Visit the url: <a href="http://localhost:8080/swagger" class="bare">http://localhost:8080/swagger</a></p>
</li>
<li>
<p>Your server is ready!</p>
</li>
</ol>
</div>
<div id="img-t-architecture" class="imageblock">
<div class="content">
<a class="image" href="images/email_swagger.png"><img src="_images/images/email_swagger.png" alt="GMail Service" width="820"></a>
</div>
<div class="title">Figure 79. GMail Server Swagger contract page</div>
</div>
</div>
<div class="sect3">
<h4 id="json-example"><a class="anchor" href="#json-example"></a>20.23. JSON Example</h4>
<div class="paragraph">
<p>This is the JSON example to test with swagger client. Please read the swagger documentation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
   "EmailFrom":"mythaistarrestaurant@gmail.com",
   "EmailAndTokenTo":{
      "MD5Token1":" Email_Here!@gmail.com",
      "MD5Token2":" Email_Here!@gmail.com"
   },
   "EmailType":0,
   "DetailMenu":[
      "Thai Spicy Basil Fried Rice x2",
      "Thai green chicken curry x2"
   ],
   "BookingDate":"2017-05-31T12:53:39.7864723+02:00",
   "Assistants":2,
   "BookingToken":"MD5Booking",
   "Price":20.0,
   "ButtonActionList":{
      "http://accept.url":"Accept",
      "http://cancel.url":"Cancel"
   },
   "Host":{
      " Email_Here!@gmail.com":"José Manuel"
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configure-the-service-port"><a class="anchor" href="#configure-the-service-port"></a>20.24. Configure the service port</h4>
<div class="paragraph">
<p>If you want to change the default port, please edit the config file and
change the next entry in <code>appSettings</code> node:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;appSettings&gt;
   &lt;add key="LocalListenPort" value="8080" /&gt;
&lt;/appSettings&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="external-links-5"><a class="anchor" href="#external-links-5"></a>20.25. ==  External links</h4>
<div class="paragraph">
<p><a href="https://console.developers.google.com/flows/enableapi?apiid=gmail">Google API Account Configuration</a></p>
</div>
<div class="paragraph">
<p><a href="https://developers.google.com/gmail/api/auth/scopes">About Scopes</a></p>
</div>
</div>
<div class="sect3">
<h4 id="downloads"><a class="anchor" href="#downloads"></a>20.26. Downloads</h4>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-= fa-floppy-o"></i></span>  <a href="https://github.com/devonfw/my-thai-star/tree/develop/net">My Thai Star (.Net Core Server + Angular client)</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="nodejs"><a class="anchor" href="#nodejs"></a>21. NodeJS</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://www.devonfw.com/">devonfw</a> is a platform which provides solutions to building business applications which combine best-in-class frameworks and libraries as well as industry proven practices and code conventions. devonfw is 100% Open Source (Apache License version 2.0) since the beginning of 2018.</p>
</div>
<div class="paragraph">
<p>devon4node is the NodeJS stack of devonfw. It allows you to build business applications (backends) using NodeJS technology in standardized way based on established best-practices.</p>
</div>
<div class="paragraph">
<p>devon4node is based on <a href="https://nestjs.com/">NestJS</a>. Nest (NestJS) is a framework for building efficient, scalable Node.js server-side applications. It uses progressive TypeScript and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming).</p>
</div>
<!-- toc disabled -->
<div class="sect2">
<h3 id="devon4node-architecture"><a class="anchor" href="#devon4node-architecture"></a>21.1. devon4node Architecture</h3>
<div class="paragraph">
<p>As we have mentioned in the introduction, devon4node is based on <a href="https://nestjs.com/">NestJS</a>. Nest (NestJS) is a framework for building efficient, scalable Node.js server-side applications.</p>
</div>
</div>
<div class="sect2">
<h3 id="http-layer"><a class="anchor" href="#http-layer"></a>21.2. HTTP layer</h3>
<div class="paragraph">
<p>By using <a href="https://nestjs.com/">NestJS</a>, devon4node is a platform-agnostic framework. NestJS focuses only on the logical layer, and delegates the transport layer to another framework, such as ExpressJS. You can see it in the following diagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/devon4node-architecture.png" alt="devon4node architecture">
</div>
</div>
<div class="paragraph">
<p>As you can see, NestJS do not listen directly for incoming request. It has an adapter to communicate with ExpressJS and ExpressJS is the responsible for that. ExpressJS is only one of the frameworks that NestJS can work with. We have also another adapter available out-of-the-box: the <a href="https://www.fastify.io/">Fastify</a> adapter. With that, you can replace ExpressJS for Fastify But you can still use all your NestJS components. You can also create your own adapter to make NestJS work with other HTTP framework.</p>
</div>
<div class="paragraph">
<p>At this point, you may think: why is NestJS (and devon4node) using ExpressJS by default instead of Fastify? Because, as you can see in the previous diagram, there is a component that is dependent on the HTTP framework: the middleware. As ExpressJS is the most widely used framework, there exists a lot of middleware for it, so, in order to reuse them in our NestJS applications, NestJS use ExpressJS by default. Anyway, you may think which HTTP framework best fits your requirements.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4node-layers"><a class="anchor" href="#devon4node-layers"></a>21.3. devon4node layers</h3>
<div class="paragraph">
<p>As other devonfw technologies, devon4node separates the application into layers.</p>
</div>
<div class="paragraph">
<p>Those layers are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="layer-controller">Controller layer</a></p>
</li>
<li>
<p><a href="layer-service">Service layer</a></p>
</li>
<li>
<p><a href="layer-dataaccess">Data Access layer</a></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/plantuml/layers.png" alt="layers">
</div>
</div>
</div>
<div class="sect2">
<h3 id="devon4node-application-structure"><a class="anchor" href="#devon4node-application-structure"></a>21.4. devon4node application structure</h3>
<div class="paragraph">
<p>Although there are many frameworks to create backend applications in NodeJS, none of them effectively solve the main problem of - Architecture. This is the main reason we have chosen NestJS for the devon4node applications. Besides, NestJS is highly inspired by <a href="https://angular.io/">Angular</a>, therefore a developer who knows Angular can use his already acquired knowledge to write devon4node applications.</p>
</div>
<div class="paragraph">
<p>NestJS adopts various Angular concepts, such as dependency injection, piping, interceptors and modularity, among others. By using modularity we can reuse some of our modules between applications. One example that devon4node provide is the <a href="guides-mailer">mailer module</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="modules-4"><a class="anchor" href="#modules-4"></a>21.5. Modules</h3>
<div class="paragraph">
<p>Create a application module is simple, you only need to create an empty class with the decorator <code>Module</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Module({})
export class AppModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the module you can define:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Imports: the list of imported modules that export the providers which are required in this module</p>
</li>
<li>
<p>Controllers: the set of controllers defined in this module which have to be instantiated</p>
</li>
<li>
<p>Providers: the providers that will be instantiated by the Nest injector and that may be shared at least across this module</p>
</li>
<li>
<p>Exports: the subset of providers that are provided by this module and should be available in other modules which import this module</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The main difference between Angular and NestJS is NestJS modules encapsulates providers by default. This means that it&#8217;s impossible to inject providers that are neither directly part of the current module nor exported from the imported modules. Thus, you may consider the exported providers from a module as the module&#8217;s public interface, or API. Example of modules graph:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/plantuml/modules.png" alt="modules">
</div>
</div>
<div class="paragraph">
<p>In devon4node we three different kind of modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AppModule</code>: this is the root module. Everything that our application need must be imported here.</p>
</li>
<li>
<p>Global Modules: this is a special kind of modules. When you make a module global, it&#8217;s accessible for every module in your application. Your can see it in the next diagram. It&#8217;s the same as the previous one, but now the <code>CoreModule</code> is global:</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/plantuml/module2.png" alt="module2">
</div>
</div>
<div class="paragraph">
<p>One example of global module is the <code>CoreModule</code>. In the <code>CoreModule</code> you must import every module which have providers that needs to be accessible in all modules of you application</p>
</div>
</li>
<li>
<p>Feature (or application) modules: modules which contains the logic of our application. We must import it in the <code>AppModule</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about modules, see <a href="https://docs.nestjs.com/modules">NestJS documentation page</a></p>
</div>
</div>
<div class="sect2">
<h3 id="folder-structure"><a class="anchor" href="#folder-structure"></a>21.6. Folder structure</h3>
<div class="paragraph">
<p>devon4node defines a folder structure that every devon4node application must follow. The folder structure is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>├───src
│   ├───app
│   │   ├───core
│   │   │   ├───auth
│   │   │   ├───configuration
│   │   │   ├───user
│   │   │   └───core.module.ts
│   │   ├───shared
│   │   └───feature
│   │       ├───sub-module
│   │       │   ├───controllers
│   │       │   ├───...
│   │       │   ├───services
│   │       │   └───sub-module.module.ts
│   │       ├───controllers
│   │       ├───interceptors
│   │       ├───pipes
│   │       ├───guards
│   │       ├───filters
│   │       ├───middlewares
│   │       ├───model
│   │       │   ├───dto
│   │       │   └───entities
│   │       ├───services
│   │       └───feature.module.ts
│   ├───config
│   └───migration
├───test
└───package.json</pre>
</div>
</div>
<div class="paragraph">
<p><a href="guides-code-generation">devon4node schematics</a> ensures this folder structure so, please, do not create files by your own, use the <a href="guides-code-generation">devon4node schematics</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="nestjs-components"><a class="anchor" href="#nestjs-components"></a>21.7. NestJS components</h3>
<div class="paragraph">
<p>NestJS provides several components that you can use in your application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.nestjs.com/controllers">Controllers</a></p>
</li>
<li>
<p><a href="https://docs.nestjs.com/providers">Providers</a></p>
</li>
<li>
<p><a href="https://docs.nestjs.com/middleware">Middleware</a></p>
</li>
<li>
<p><a href="https://docs.nestjs.com/guards">Guards</a></p>
</li>
<li>
<p><a href="https://docs.nestjs.com/interceptors">Interceptors</a></p>
</li>
<li>
<p><a href="https://docs.nestjs.com/pipes">Pipes</a></p>
</li>
<li>
<p><a href="https://docs.nestjs.com/exception-filters">Exception filters</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the <a href="https://docs.nestjs.com">NestJS documentation</a> you can find all information about each component. But, something that is missing in the documentation is the execution order. Every component can be defined in different levels: globally, in the controller or in the handler. As middleware is part of the HTTP server we can define it in a different way: globally or in the module.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/plantuml/components.png" alt="components">
</div>
</div>
<div class="paragraph">
<p>It is not necessary to have defined components in every level. For example, you can have defined a interceptor globally but you do not have any other in the controller or handler level. If nothing is defined in some level, the request will continue to the next component.</p>
</div>
<div class="paragraph">
<p>As you can see in the previous image, the first component which receive the request is the global defined middleware. Then, it send the request to the module middleware. Each of them can return a response to the client, without passing the request to the next level.</p>
</div>
<div class="paragraph">
<p>Then, the request continue to the guards: first the global guard, next to controller guard and finally to the handler guard. At this point, we can throw an exception in all components and the exception filter will catch it and send a proper error message to the client. We do not paint the filters in the graphic in order to simplify it.</p>
</div>
<div class="paragraph">
<p>After the guards, is time to interceptors: global interceptors, controller interceptors and handler interceptors. And last, before arrive to the handler inside the controller, the request pass through the pipes.</p>
</div>
<div class="paragraph">
<p>When the handler has the response ready to send to the client, it does not go directly to the client. It come again to the interceptors, so we can also intercept the response. The order this time is the reverse: handler interceptors, controller interceptors and global interceptors. After that, we can finally send the response to the client.</p>
</div>
<div class="paragraph">
<p>Now, with this in mind, you are able to create the components in a better way.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="layers-8"><a class="anchor" href="#layers-8"></a>22. Layers</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="controller-layer"><a class="anchor" href="#controller-layer"></a>22.1. Controller Layer</h4>
<div class="paragraph">
<p>The controller layer is responsible for handling the requests/responses to the client. This layer knows everything about the endpoints exposed, the expected input (and also <a href="guides-validation">validate</a> it), the response schema, the HTTP codes for the response and the HTTP errors that every endpoint can send.</p>
</div>
</div>
<div class="sect3">
<h4 id="how-to-implement-the-controller-layer"><a class="anchor" href="#how-to-implement-the-controller-layer"></a>22.2. How to implement the controller layer</h4>
<div class="paragraph">
<p>This layer is implemented by the <a href="https://docs.nestjs.com/controllers">NestJS controllers</a>. Let&#8217;s see how it works with an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Controller('coffee/coffees')
export class CoffeeController {
  constructor(private readonly coffeeService: CoffeeService) {}

  @Post('search')
  @HttpCode(200)
  async searchCoffees(@Body() search: CoffeeSearch): Promise&lt;Array&lt;Coffee&gt;&gt; {
    try {
      return await this.coffeeService.searchCoffees(search);
    } catch (error) {
      throw new BadRequestException(error.message, error);
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see in the example, to create a controller you only need to decorate a class with the <code>Controller</code> decorator. This example is handling all request to <code>coffee/coffees</code>.</p>
</div>
<div class="paragraph">
<p>Also, you have defined one handler. This handler is listening to POST request for the route <code>coffee/coffees/search</code>. In addition, this handler is waiting for a <code>CoffeeSearch</code> object and returns an array of Coffee. In order to keep it simple, that&#8217;s all that you need in order to define one route.</p>
</div>
<div class="paragraph">
<p>One important thing that can be observed in this example is that there is no business logic. It delegates to the service layer and return the response to the client. At this point, transformations from the value that you receive from the service layer to the desired return type are also allowed.</p>
</div>
<div class="paragraph">
<p>By default, every POST handler return an HTTP 204 response with the returned value as body, but you can change it in a easy way by using decorators. As you can see in the example, the handler will return a HTTP 200 response (<code>@HttpCode(200)</code>).</p>
</div>
<div class="paragraph">
<p>Finally, if the service layer throws an error, this handler will catch it and return a HTTP 400 Bad Request response. The controller layer is the only one that knows about the answers to the client, therefore it is the only one that knows which error codes should be sent.</p>
</div>
</div>
<div class="sect3">
<h4 id="validation"><a class="anchor" href="#validation"></a>22.3. Validation</h4>
<div class="paragraph">
<p>In order to do not propagate errors in the incoming payload, we need to validate all data in the controller layer. See the <a href="guides-validation">validation guide</a> for more information.</p>
</div>
</div>
<div class="sect3">
<h4 id="error-handling"><a class="anchor" href="#error-handling"></a>22.4. Error handling</h4>
<div class="paragraph">
<p>In the previous example, we catch all errors using the try/catch statement. This is not the usual implementation. In order to catch properly the errors you must use the <a href="https://docs.nestjs.com/exception-filters">exception filters</a>. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Controller('coffee/coffees')
export class CoffeeController {
  constructor(private readonly coffeeService: CoffeeService) {}

  @Post('search')
  @HttpCode(200)
  @UseFilters(CaffeExceptionFilter)
  async searchCoffees(@Body() search: CoffeeSearch): Promise&lt;Array&lt;Coffee&gt;&gt; {
    return await this.coffeeService.searchCoffees(search);
  }
}</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="service-layer-3"><a class="anchor" href="#service-layer-3"></a>22.5. Service Layer</h4>
<div class="paragraph">
<p>The logic layer is the heart of the application and contains the main business logic. It knows everything about the business logic, but it does not know about the response to the client and the HTTP errors. That&#8217;s why this layer is separated from the controller layer.</p>
</div>
</div>
<div class="sect3">
<h4 id="how-to-implement-the-service-layer"><a class="anchor" href="#how-to-implement-the-service-layer"></a>22.6. How to implement the service layer</h4>
<div class="paragraph">
<p>This layer is implemented by services, a specific kind of <a href="https://docs.nestjs.com/providers">providers</a>. Let&#8217;s see one example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Injectable()
export class CoffeeService {
  constructor(private readonly coffeeService: CoffeeService) {}

  async searchCoffees(@InjectRepository(Coffee) coffeeRepository: Repository&lt;Coffee&gt;): Promise&lt;Array&lt;Coffee&gt;&gt; {
    const coffees = this.coffeeRepository.find();

    return doSomeBusinessLogic(coffees);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is the <code>CoffeeService</code> that we inject in the example of <a href="layer-controller">controller layer</a>. As you can see, a service is a regular class with the <code>Injectable</code> decorator. Also, it inject as dependency the data access layer (in this specific case, the Repository&lt;Coffee&gt;).</p>
</div>
<div class="paragraph">
<p>The services expose methods in order to transform the input from the controllers by applying some business logic. They can also request data from the data access layer. And that&#8217;s all.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="data-access-layer-2"><a class="anchor" href="#data-access-layer-2"></a>22.7. Data Access Layer</h4>
<div class="paragraph">
<p>The data access layer is responsible for all outgoing connections to access and process data. This is mainly about accessing data from a persistent data-store but also about invoking external services.</p>
</div>
<div class="paragraph">
<p>This layer is implemented using providers. Those providers could be: services, repositories and others. Although services can be used for this layer, they should not be confused with the service layer. Services in this layer are responsible for data access, while services in the service layer are responsible for business logic.</p>
</div>
</div>
<div class="sect3">
<h4 id="database-2"><a class="anchor" href="#database-2"></a>22.8. Database</h4>
<div class="paragraph">
<p>We strongly recommend <a href="https://typeorm.io">TypeORM</a> for database management in devon4node applications. Although services can be used for this layer, they should not be confused with the service layer. Services in this layer are responsible for data access, while services in the service layer are responsible for business logic. TypeORM supports the most commonly used relational databases, link Oracle, MySQL, MariaDB, PostgreSQL, SQLite, MSSQL and others. Also, it supports no-relational databases like MongoDB.</p>
</div>
<div class="paragraph">
<p>TypeORM supports <a href="https://en.wikipedia.org/wiki/Active_record_pattern">Active Record</a> and Repository patterns. We recommend to use the Repository pattern. This pattern allows you to separate the data objects from the methods to manipulate the database.</p>
</div>
</div>
<div class="sect3">
<h4 id="external-apis"><a class="anchor" href="#external-apis"></a>22.9. External APIs</h4>
<div class="paragraph">
<p>In order to manage the data in a external API, you need to create a service for that purpose. In order to manage the connections with the external API, we strongly recommend the <a href="https://docs.nestjs.com/techniques/http-module">NestJS HTTP module</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="guides-6"><a class="anchor" href="#guides-6"></a>23. Guides</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="key-principles-3"><a class="anchor" href="#key-principles-3"></a>23.1. Key Principles</h4>
<div class="paragraph">
<p>devon4node is built following some basic principles like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/SOLID">SOLID</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Software_design_pattern">Patterns</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Open-source_model">Open</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>But key principles that best define devon4node (and are inherited from NestJS) are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Simplicity (aka <a href="https://en.wikipedia.org/wiki/KISS_principle">KISS</a>)</p>
</li>
<li>
<p>Reusability</p>
</li>
<li>
<p>Productivity</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="simplicity"><a class="anchor" href="#simplicity"></a>23.2. Simplicity</h4>
<div class="paragraph">
<p>In devon4node we tried to do everything as simple as possible. Following this principle we will be able to do easy to maintain applications.</p>
</div>
<div class="paragraph">
<p>For example, in order to expose all CRUD operations for an entity, you only need to create a controller like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Crud({
  model: {
    type: Employee,
  },
})
@CrudType(Employee)
@Controller('employee/employees')
export class EmployeeCrudController {
  constructor(public service: EmployeeCrudService) {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can find this code in the <a href="samples">employee example</a>. Only with this code your exposing the full CRUD operations for the employee entity. As you can see, it&#8217;s an empty class with some decorators and the <code>EmployeeCrudService</code> injected as dependency. Simple, isn&#8217;t it? The <code>EmployeeCrudService</code> is also simple:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Injectable()
export class EmployeeCrudService extends TypeOrmCrudService&lt;Employee&gt; {
  constructor(@InjectRepository(Employee) repo: Repository&lt;Employee&gt;) {
    super(repo);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another empty class which extends from <code>TypeOrmCrudService&lt;Employee&gt;</code> and injects the Employee Repository as dependency. Nothing else.</p>
</div>
<div class="paragraph">
<p>With these examples you can get an idea of how simple it can be to code a devon4node application .</p>
</div>
</div>
<div class="sect3">
<h4 id="reusability"><a class="anchor" href="#reusability"></a>23.3. Reusability</h4>
<div class="paragraph">
<p>NestJS (and devon4node) applications are designed in a modular way. This allows you to isolate some functionality in a module, and then reuse it in every application that you need. This is the same behaviour that Angular has. You can see it in the NestJS modules like <a href="https://github.com/nestjs/typeorm">TypeORM</a>, <a href="https://github.com/nestjs/swagger">Swagger</a> and others. Also, in devon4node we have the <a href="https://www.npmjs.com/package/@devon4node/mailer">Mailer module</a>.</p>
</div>
<div class="paragraph">
<p>In your applications, you only need to import those modules and then you will be able to use the functionality that they implement. Example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Module({
  imports: [ AuthModule, ConfigurationModule ],
})
export class SomeModule {}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="productivity"><a class="anchor" href="#productivity"></a>23.4. Productivity</h4>
<div class="paragraph">
<p>devon4node is designed to create secure enterprise applications. But also, it allow you to do it in a fast way. To increase the productivity devon4node, devon4node provide schematics in order to generate some boilerplate code.</p>
</div>
<div class="paragraph">
<p>For example, to create a module you need to create a new file for a module (or copy it) and write the code, then you need to import it in the <code>AppModule</code>. This is a easy example, but you can introduce some errors: forget to import it in the <code>AppModule</code>, introduce errors with the copy/paste and so on. By using the command <code>nest g module --name &lt;module-name&gt;</code> it will do everything for you. Just a simple command. In this specific case probably you do not see any advantage, but there are other complex cases where you can generate more complex code with nest and devon4node schematics command.</p>
</div>
<div class="paragraph">
<p>See <a href="guides-code-generation">code generation</a> in order to know how to increase your productivity creating devon4node applications.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="code-generation"><a class="anchor" href="#code-generation"></a>23.5. Code Generation</h4>
<div class="paragraph">
<p>As we mention in the page <a href="guide-key-principles">key principles</a>, one of our key principles is Productivity. In order to provide that productivity, we have some tools to generate code. These tools will help you generate the common parts of the application so that you can focus only on the specific functionality.</p>
</div>
<div class="paragraph">
<p>Those tools are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.npmjs.com/package/@devon4node/schematics">devon4node schematics through Nest CLI</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen">CobiGen</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="nest-cli-and-devon4node-schematics"><a class="anchor" href="#nest-cli-and-devon4node-schematics"></a>23.6. Nest CLI and Devon4node schematics</h4>
<div class="paragraph">
<p>We are going to use the Nest CLI to generate code of our application, you can know more about NodeJs CLI in the official <a href="https://docs.nestjs.com/cli/overview:">documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="install-devon4node-schematics"><a class="anchor" href="#install-devon4node-schematics"></a>23.7. Install devon4node schematics</h4>
<div class="paragraph">
<p>First of all, you need to install Nest CLI</p>
</div>
<div class="paragraph">
<p>Execute the command <code>yarn global add @nestjs/cli</code>.
You can also use npm: <code>npm install -g @nestjs/cli</code></p>
</div>
<div class="paragraph">
<p>And then Devon4node schematics globally with the following command:</p>
</div>
<div class="paragraph">
<p><code>yarn global add @devon4node/schematics</code> or <code>npm install -g @devon4node/schematics</code></p>
</div>
</div>
<div class="sect3">
<h4 id="-15"><a class="anchor" href="#-15"></a>==</h4>
<div class="paragraph">
<p>If you get an error trying execute any devon4node schematic related to collection not found, try to reinstall devon4node/schematics on the project folder or be sure that schematics folder is inside @devon4node in node_modules.
<code>yarn add @devon4node/schematics</code>
== ==</p>
</div>
</div>
<div class="sect3">
<h4 id="generate-new-devon4node-application"><a class="anchor" href="#generate-new-devon4node-application"></a>23.8. Generate new devon4node application</h4>
<div class="paragraph">
<p>To start creating a devon4node application, execute the command:</p>
</div>
<div class="paragraph">
<p><code>nest g -c @devon4node/schematics application [application-name]</code></p>
</div>
<div class="paragraph">
<p>If you do not put a name, the command line will ask you for one.</p>
</div>
</div>
<div class="sect3">
<h4 id="generate-code-for-typeorm"><a class="anchor" href="#generate-code-for-typeorm"></a>23.9. Generate code for TypeORM</h4>
<div class="paragraph">
<p>Initialize TypeORM into your current project in a correct way.</p>
</div>
<div class="paragraph">
<p><code>nest g -c @devon4node/schematics typeorm</code></p>
</div>
<div class="paragraph">
<p>Then, you will be asked about which DB you want to use.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/typeorm-schematic.PNG" alt="typeorm schematic"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="generate-crud"><a class="anchor" href="#generate-crud"></a>23.10. Generate CRUD</h4>
<div class="paragraph">
<p>Generate CRUD methods for a entity. Requires TypeORM installed in the project.</p>
</div>
<div class="paragraph">
<p>It will add the @nestjsx/crud module as a project dependency. Then, generates an entity, a CRUD controller and a CRUD service. It also register the entity, controller and service in the module.</p>
</div>
<div class="paragraph">
<p>Execute <code>nest g -c @devon4node/schematics crud</code> and then you will need to write a name for the crud.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/crud-schematic.PNG" alt="crud schematic">
</div>
</div>
</div>
<div class="sect3">
<h4 id="generate-typeorm-entity"><a class="anchor" href="#generate-typeorm-entity"></a>23.11. Generate TypeORM entity</h4>
<div class="paragraph">
<p>Add a TypeORM entity to your project. Requires TypeORM installed in the project.</p>
</div>
<div class="paragraph">
<p>Execute <code>nest g -c @devon4node/schematics entity</code> and you will be asked for an entity name.</p>
</div>
</div>
<div class="sect3">
<h4 id="add-config-module"><a class="anchor" href="#add-config-module"></a>23.12. Add config-module</h4>
<div class="paragraph">
<p>Add the config module to the project.</p>
</div>
<div class="paragraph">
<p>It will add the @devon4node/common module as a project dependency. Then, it will generate the configuration module into your project and add it in the core module. Also, it generates the config files for the most common environments.</p>
</div>
<div class="paragraph">
<p>The command to execute will be <code>nest g -c @devon4node/schematics config-module</code></p>
</div>
</div>
<div class="sect3">
<h4 id="add-mailer-module"><a class="anchor" href="#add-mailer-module"></a>23.13. Add mailer module</h4>
<div class="paragraph">
<p>Add @devon4node/mailer module to project.</p>
</div>
<div class="paragraph">
<p>It will add the @devon4node/mailer module as a project dependency. Also, it will add it to the core module and it will generate some email template examples.</p>
</div>
<div class="paragraph">
<p>Write the command <code>nest g -c @devon4node/schematics mailer</code></p>
</div>
</div>
<div class="sect3">
<h4 id="add-swagger-module"><a class="anchor" href="#add-swagger-module"></a>23.14. Add swagger module</h4>
<div class="paragraph">
<p>Add swagger module to project.</p>
</div>
<div class="paragraph">
<p>It will add the @nestjs/swagger module as a project dependency. Also, it will update the main.ts file in order to expose the endpoint for swagger. The default endpoint is: /v1/api</p>
</div>
<div class="paragraph">
<p>Execute the command <code>nest g -c @devon4node/schematics swagger</code></p>
</div>
</div>
<div class="sect3">
<h4 id="add-auth-jwt-module"><a class="anchor" href="#add-auth-jwt-module"></a>23.15. Add auth-jwt module</h4>
<div class="paragraph">
<p>Add the auth JWT module to the project.</p>
</div>
<div class="paragraph">
<p>It will add to your project the auth-jwt and user module. Also, it will import those modules into the core module.</p>
</div>
<div class="paragraph">
<p>Execute <code>nest g -c @devon4node/schematics auth-jwt</code></p>
</div>
</div>
<div class="sect3">
<h4 id="add-security"><a class="anchor" href="#add-security"></a>23.16. Add security</h4>
<div class="paragraph">
<p>Add cors and helmet to your project.</p>
</div>
<div class="paragraph">
<p>It will add helmet package as project dependency and update the main.ts file in order to enable the cors and helmet in your application.</p>
</div>
<div class="paragraph">
<p>Execute <code>nest g -c @devon4node/schematics security</code></p>
</div>
</div>
<div class="sect3">
<h4 id="generate-database-migrations"><a class="anchor" href="#generate-database-migrations"></a>23.17. Generate database migrations</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate database migrations</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In order to create migration scripts with TypeORM, you need to install ts-node: <code>yarn global add ts-node</code> or <code>npm i -g ts-node</code></p>
</li>
<li>
<p>Generate the tables creation migration: <code>yarn run typeorm migration:generate -n CreateTables</code></p>
<div class="imageblock">
<div class="content">
<img src="_images/images/insert-data.PNG" alt="insert data">
</div>
</div>
<div class="paragraph">
<p>It will connect to the database, read all entities and then it will generate a migration file with all sql queries need to transform the current status of the database to the status defined by the entities. If the database is empty, it will generate all sql queries need to create all tables defined in the entities. You can find a example in the todo example</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>As TypeORM is the tool used for DB. You can check official documentation for more information.
See <a href="https://typeorm.io/#/using-cli">TypeORM CLI documentation</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="cobigen-2"><a class="anchor" href="#cobigen-2"></a>23.18. CobiGen</h4>
<div class="paragraph">
<p>Currently, we do not have templates to generate devon4node code (we have planned to do that in the future). Instead, we have templates that read the code of a devon4node application and generate a devon4ng application. Visit the <a href="https://github.com/devonfw/cobigen">CobiGen</a> page for more information.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="coding-conventions-2"><a class="anchor" href="#coding-conventions-2"></a>23.19. Coding Conventions</h4>
<div class="paragraph">
<p>devon4node defines some coding conventions in order to improve the readability, reduce the merge conflicts and be able to develop applications in an industrialized way.</p>
</div>
<div class="paragraph">
<p>In order to ensure that you are following the devon4node coding conventions, you can use the following tools:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ESLint</code>: <a href="https://eslint.org/">ESLint</a> ESLint is a tool for identifying and reporting on patterns found in ECMAScript/JavaScript code, with the goal of making code more consistent and avoiding bugs. We recommend to use the <a href="https://marketplace.visualstudio.com/items?itemName=dbaeumer.vscode-eslint">ESLint VSCode extension</a> (included in the devonfw Platform Extension Pack) in order to be able to see the linting errors while you are developing.</p>
</li>
<li>
<p><code>Prettier</code>: <a href="https://prettier.io/">Prettier</a> is a code formatter. We recommend to use the Prettier VSCode extension (included in the devonfw Platform Extension Pack) and enable the <code>editor.formatOnSave</code> option.</p>
</li>
<li>
<p><code>devon4node application schematic</code>: this tool will generate code following the devon4node coding conventions. Also, when you generate a new project using the devon4node application schematic, it generates the configuration files for TSLint and Prettier that satisfy the devon4node coding conventions.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you combine all tools, you can be sure that you follow the devon4node coding conventions.</p>
</div>
</div>
<div class="sect3">
<h4 id="detailed-devon4node-coding-conventions"><a class="anchor" href="#detailed-devon4node-coding-conventions"></a>23.20. Detailed devon4node Coding Conventions</h4>
<div class="paragraph">
<p>Here we will detail some of most important devon4node coding conventions. To be sure that you follows all devon4node coding conventions use the tools described before.</p>
</div>
</div>
<div class="sect3">
<h4 id="indentation"><a class="anchor" href="#indentation"></a>23.21. Indentation</h4>
<div class="paragraph">
<p>All devon4node code files must be indented using spaces. The indentation with must be 2 spaces.</p>
</div>
</div>
<div class="sect3">
<h4 id="white-space"><a class="anchor" href="#white-space"></a>23.22. White space</h4>
<div class="paragraph">
<p>In order to improve the readability of your code, you must introduce whitespaces. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">if(condition){</code></pre>
</div>
</div>
<div class="paragraph">
<p>must be</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">if (condition) {</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="naming-conventions-4"><a class="anchor" href="#naming-conventions-4"></a>23.23. Naming conventions</h4>

</div>
<div class="sect3">
<h4 id="file-naming"><a class="anchor" href="#file-naming"></a>23.24. ==  File naming</h4>
<div class="paragraph">
<p>The file name must follow the pattern: (name in kebab case).(kind of component).(extension)
The test file name must follow the pattern: (name in kebab case).(kind of component).spec.(extension)</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>auth-jwt.service.ts
auth-jwt.service.spec.ts</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="interface-naming"><a class="anchor" href="#interface-naming"></a>23.25. ==  Interface naming</h4>
<div class="paragraph">
<p>The interface names must be in pascal case, and must start with I. There is some controversy in starting the interface names with an I, but we decided to do it because is most of cases you will have an interface and a class with the same name, so, to differentiate them, we decided to start the interfaces with I. Other devonfw stacks solves it by adding the suffix <code>Impl</code> in the class implementations.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>interface ICoffee {}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="class-naming"><a class="anchor" href="#class-naming"></a>23.26. ==  Class naming</h4>
<div class="paragraph">
<p>The class names must be in pascal case.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>class Coffee {}</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="variable-naming"><a class="anchor" href="#variable-naming"></a>23.27. ==  Variable naming</h4>
<div class="paragraph">
<p>All variable names must be in camel case.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>const coffeeList: Coffe[];</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="declarations"><a class="anchor" href="#declarations"></a>23.28. Declarations</h4>
<div class="paragraph">
<p>For all variable declarations we must use <code>const</code> or <code>let</code>. <code>var</code> is forbidden. We prefer to use  <code>const</code> when possible.</p>
</div>
</div>
<div class="sect3">
<h4 id="programming-practices"><a class="anchor" href="#programming-practices"></a>23.29. Programming practices</h4>

</div>
<div class="sect3">
<h4 id="trailing-comma"><a class="anchor" href="#trailing-comma"></a>23.30. ==  Trailing comma</h4>
<div class="paragraph">
<p>All statements must end with a trailing comma. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">{
  one: 'one',
  two: 'two'  // bad
}
{
  one: 'one',
  two: 'two', // good
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="arrow-functions"><a class="anchor" href="#arrow-functions"></a>23.31. ==  Arrow functions</h4>
<div class="paragraph">
<p>All anonymous functions must be defined with the arrow function notation. In most of cases it&#8217;s not a problem, but sometimes, when you do not want to bind <code>this</code> when you define the function, you can use the other function definition. In this special cases you must disable the linter for those sentence.</p>
</div>
</div>
<div class="sect3">
<h4 id="comments"><a class="anchor" href="#comments"></a>23.32. ==  Comments</h4>
<div class="paragraph">
<p>Comments must start with a whitespace. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">//This is a bad comment
// This is OK</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="quotemarks"><a class="anchor" href="#quotemarks"></a>23.33. ==  Quotemarks</h4>
<div class="paragraph">
<p>For string definitions, we must use single quotes.</p>
</div>
</div>
<div class="sect3">
<h4 id="if-statements"><a class="anchor" href="#if-statements"></a>23.34. ==  if statements</h4>
<div class="paragraph">
<p>In all if statements you always must use brackets. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">// Bad if statement
if (condition)
  return true;

// Good if statement
if (condition) {
  return true;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="pre-commit-hooks"><a class="anchor" href="#pre-commit-hooks"></a>23.35. Pre-commit hooks</h4>
<div class="paragraph">
<p>In order to ensure that your new code follows the coding conventions, devon4node uses by default husky. Husky is a tool that allows you to configure git hooks easily in your project. When you make a <code>git commit</code> in your devon4node project, it will execute two actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prettify the staged files</p>
</li>
<li>
<p>Execute the linter in the staged files</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any action fails, you won&#8217;t be able to commit your new changes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you want to skip the git hooks, you can do a commit passing the <code>--no-verify</code> flag.
</td>
</tr>
</table>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="dependency-injection-2"><a class="anchor" href="#dependency-injection-2"></a>23.36. Dependency Injection</h4>
<div class="paragraph">
<p>The <a href="https://en.wikipedia.org/wiki/Dependency_injection">dependency injection</a> is a well-known common design pattern applied by frameworks in all languages, like <a href="https://spring.io/">Spring</a> in Java, <a href="https://angular.io/">Angular</a> and others. The intention of this page is not to explain how dependency injection works, but instead how it is addressed by NestJS.</p>
</div>
<div class="paragraph">
<p>NestJS resolve the dependency injection in their modules. When you define a provider in a module, it can be injected in all components of the module. By default, those providers are only available in the module where it is defined. The only way to export a module provider to other modules which import it is adding those provider to the export array. You can also reexport modules.</p>
</div>
</div>
<div class="sect3">
<h4 id="inject-dependencies-in-nestjs"><a class="anchor" href="#inject-dependencies-in-nestjs"></a>23.37. Inject dependencies in NestJS</h4>
<div class="paragraph">
<p>In order to inject a dependency in a NestJS component, you need to declare it in the component constructor. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export class CoffeeController {
  constructor(public readonly conffeeService: CoffeeService) {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>NestJS can resolve all dependencies that are defined in the module as provider, and also the dependencies exported by the modules imported. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Module({
  controllers: [CoffeeController],
  providers: [CoffeeService],
})
export class CoffeeModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Inject dependencies in the constructor is the is the preferred choice, but, sometimes it is not possible. For example, when you are extending another class and want to keep the constructor definition. In this specific cases we can inject dependencies in the class properties. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export class CoffeeController {
  @Inject(CoffeeService)
  private readonly conffeeService: CoffeeService;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="dependency-graph"><a class="anchor" href="#dependency-graph"></a>23.38. Dependency Graph</h4>
<div class="imageblock">
<div class="content">
<img src="_images/images/plantuml/dependency-injection1.png" alt="dependency injection1">
</div>
</div>
<div class="paragraph">
<p>In the previous image, the Module A can inject dependencies exported by Module B, Module E and Module F. If module B reexport Module C and Module D, they are also accessible by Module A.</p>
</div>
<div class="paragraph">
<p>If there is a conflict with the injection token, it resolves the provider with less distance with the module. For example: if the modules C and F exports a <code>UserService</code> provider, the Module A will resolve the <code>UserService</code> exported by the Module F, because the distance from Module A to Module F is 1, and the distance from Module A to Module C is 2.</p>
</div>
<div class="paragraph">
<p>When you define a module as global, the dependency injection system is the same. The only difference is now all modules as a link to the global module. For example, if we make the Module C as global the dependency graph will be:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/plantuml/dependency-injection2.png" alt="dependency injection2">
</div>
</div>
</div>
<div class="sect3">
<h4 id="custom-providers"><a class="anchor" href="#custom-providers"></a>23.39. Custom providers</h4>
<div class="paragraph">
<p>When you want to change the provider name, you can use a NestJS feature called <a href="https://docs.nestjs.com/fundamentals/custom-providers">custom providers</a>. For example, if you want to define a provider called <code>MockUserService</code> with the provider token <code>UserService</code> you can define it like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Module({
  providers: [{
    provide: UserService,
    useValue: MockUserService,
  }],
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this, when you inject want to inject <code>UserService</code> as dependency, the <code>MockUserService</code> will be injected.</p>
</div>
<div class="paragraph">
<p>Custom provider token can be also a string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Module({
  providers: [{
    provide: 'USER_SERVICE',
    useValue: MockUserService,
  }],
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>but now, when you want to inject it as dependency you need to use the @Inject decorator.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">constructor(@Inject('USER_SERVICE') userService: any) {}</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="configuration-module"><a class="anchor" href="#configuration-module"></a>23.40. Configuration Module</h4>
<div class="paragraph">
<p>devon4node provides a way to generate a configuration module inside your application. To generate it you only need to execute the command <code>nest g -c @devon4node/schematics config-module</code>. This command will generate inside your application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configuration module inside the core module.</p>
</li>
<li>
<p>config folder where all environment configuration are stored.</p>
<div class="ulist">
<ul>
<li>
<p>default configuration: configuration for your local development environment.</p>
</li>
<li>
<p>develop environment configuration for the develop environment.</p>
</li>
<li>
<p>uat environment configuration for the uat environment.</p>
</li>
<li>
<p>production environment configuration for the production environment.</p>
</li>
<li>
<p>production environment configuration for the production environment.</p>
</li>
<li>
<p>test environment configuration used by test.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
some code generators will add some properties to this module, so, be sure that the config module is the first module that you generate in your application.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="use-the-configuration-service"><a class="anchor" href="#use-the-configuration-service"></a>23.41. Use the configuration service</h4>
<div class="paragraph">
<p>To use the configuration service, you only need to inject it as dependency. As configuration module is defined in the core module, it will be available everywhere in your application. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export class MyProvider {
  constructor(public readonly configService: ConfigurationService) {}

  myMethod() {
    return this.confiService.isDev;
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="choose-an-environment-file"><a class="anchor" href="#choose-an-environment-file"></a>23.42. Choose an environment file</h4>
<div class="paragraph">
<p>By default, when you use the configuration service it will take the properties defined in the default.ts file. If you want to change the configuration file, you only need to set the NODE_ENV environment property with the name of the desired environment. Examples: in windows execute <code>set NODE_ENV=develop</code> before executing the application, in linux execute <code>NODE_ENV=develop</code> before executing the application or <code>NODE_ENV=develop yarn start</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="override-configuration-properties"><a class="anchor" href="#override-configuration-properties"></a>23.43. Override configuration properties</h4>
<div class="paragraph">
<p>Sometimes, you want to keep some configuration property secure, and you do not want to publish it to the repository, or you want to reuse some configuration file but you need to change some properties. For those scenarios, you can override configuration properties by defining a environment variable with the same name. For example, if you want to override the property host, you can do: <code>set host="newhost"</code>. It also works with objects. For example, if you want to change the value of secret in the property <code>jwtConfig</code> for <a href="https://github.com/devonfw/devon4node/blob/develop/samples/employee/src/config/develop.ts">this example</a>, you can set a environment variable like this: <code>set jwtConfig="{"secret": "newsecret"}"</code>. As you can see, this environment variable has a JSON value. It will take object and merge the <code>jwtConfig</code> property with the properties defined inside the environment variable. It other properties maintain their value. The behaviour is the same for the nested objects.</p>
</div>
</div>
<div class="sect3">
<h4 id="add-a-configuration-property"><a class="anchor" href="#add-a-configuration-property"></a>23.44. Add a configuration property</h4>
<div class="paragraph">
<p>In order to add a new property to the configuration module, you need to follow some steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add the property to IConfig interface in <code>src/app/core/configuration/types.ts</code> file. With this, we can ensure that the <code>ConfigurationService</code> and the environment files has those property at compiling time.</p>
</li>
<li>
<p>Add the new property getter to <code>ConfigurationService</code>. You must use the <code>get</code> method of <code>ConfigurationService</code> to ensure that the property will be loaded from the desired config file. You can also add extra logic if needed.</p>
</li>
<li>
<p>Add the property to all config files inside the <code>src/config</code> folder.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>We want to add the property <code>devonfwUrl</code> to our ConfigurationService, so:</p>
</div>
<div class="paragraph">
<p>We add the following code in IConfig interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">devonfwUrl: string;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, we add the getter in the <code>ConfigurationService</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">get devonfwUrl(): string {
  return this.get('devonfwUrl')!;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, we add the definition in all config files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">devonfwUrl: 'https://devonfw.com',</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="auth-jwt-module"><a class="anchor" href="#auth-jwt-module"></a>23.45. Auth JWT module</h4>
<div class="paragraph">
<p>devon4node provides a way to generate a default authentication module using JWT (JSON Web Token). It uses the <code>@nestjs/passport</code> library describe <a href="https://docs.nestjs.com/techniques/authentication">here</a>.</p>
</div>
<div class="paragraph">
<p>To generate the devon4node auth-jwt module you only need to execute the command: <code>nest generate -c @devon4node/schematics auth-jwt</code>. We generate this module inside the applications instead of distributing a npm package because this module is prone to be modified depending on the requirements. It also generate a basic user module.</p>
</div>
<div class="paragraph">
<p>In this page we will explain the default implementation provided by devon4node. For more information about authentication, JWT, passport and other you can see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://jwt.io/introduction/">JWT</a></p>
</li>
<li>
<p><a href="https://docs.nestjs.com/techniques/authentication">NestJS authentication</a></p>
</li>
<li>
<p><a href="https://www.npmjs.com/package/passport">Passport</a></p>
</li>
<li>
<p><a href="https://www.npmjs.com/package/passport-jwt">Passport JWT</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="auth-jwt-endpoints"><a class="anchor" href="#auth-jwt-endpoints"></a>23.46. Auth JWT endpoints</h4>
<div class="paragraph">
<p>In order to execute authentication operations, the auth-jwt module exposes the following endpoints:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>POST /auth/login</code>: receive an username and a password and return the token in the header if the combination of username and password is correct.</p>
</li>
<li>
<p><code>POST /auth/register</code>: register a new user.</p>
</li>
<li>
<p><code>GET /auth/currentuser</code>: return the user data if he is authenticated.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="protect-endpoints-with-auth-jwt"><a class="anchor" href="#protect-endpoints-with-auth-jwt"></a>23.47. Protect endpoints with auth-jwt</h4>
<div class="paragraph">
<p>In order to protect your endpoints with auth-jwt module you only need to add the <code>AuthGuard()</code> in the <code>UseGuards</code> decorator. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Get('currentuser')
@UseGuards(AuthGuard())
currentUser(@Request() req: UserRequest) {
  return req.user;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, all request to currentuser are protected by the <code>AuthGuard</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="role-based-access-control"><a class="anchor" href="#role-based-access-control"></a>23.48. Role based Access Control</h4>
<div class="paragraph">
<p>The auth-jwt module provides also a way to control the access to some endpoints by using roles. For example, if you want to grant access to a endpoint only to admins, you only need to add the <code>Roles</code> decorator to those endpoints with the roles allowed. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Get('currentuser')
@UseGuards(AuthGuard())
@Roles(roles.ADMIN)
currentUser(@Request() req: UserRequest) {
  return req.user;
}</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="swagger"><a class="anchor" href="#swagger"></a>23.49. Swagger</h4>
<div class="paragraph">
<p>We can use swagger (OpenAPI) in order to describe the endpoints that our application exposes.</p>
</div>
<div class="paragraph">
<p>NestJS provides a module which will read the code of our application and will expose one endpoint where we can see the swagger.</p>
</div>
<div class="paragraph">
<p>Add swagger to a devon4node application is simple, you only need to execute the command <code>nest g -c @devon4node/schematics swagger</code> and it will do everything for you. The next time that you start your application, you will be able to see the swagger at <code>/v1/api</code> endpoint.</p>
</div>
<div class="paragraph">
<p>The swagger module can read your code in order to create the swagger definition, but sometimes you need to help him by decorating your handlers.</p>
</div>
<div class="paragraph">
<p>For more information about decorators and other behaviour about swagger module, you can see the <a href="https://docs.nestjs.com/recipes/swagger">NestJS swagger documentation page</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the OpenAPI specification that this module supports is v2.0. The OpenAPI v3.0 is not available yet by using this module.
</td>
</tr>
</table>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="typeorm"><a class="anchor" href="#typeorm"></a>23.50. TypeORM</h4>
<div class="paragraph">
<p>TypeORM is the default ORM provided by devon4node. It supports MySQL, MariaDB, Postgres, CockroachDB, SQLite, Microsoft SQL Server, Oracle, sql.js relational database and also supports MongoDB NoSQL database.</p>
</div>
<div class="paragraph">
<p>Add TypeORM support to a devon4node application is very easy: you only need to execute the command <code>nest g -c @devon4node/schematics typeorm</code> and it will add all required dependencies to the project and also imports the <code>@nestjs/typeorm</code> module.</p>
</div>
<div class="paragraph">
<p>For more information about TypeORM and the integration with NestJS you can visit <a href="https://typeorm.io">TypeORM webpage</a>, <a href="https://github.com/typeorm/typeorm">TypeORM GitHub repository</a> and <a href="https://docs.nestjs.com/recipes/sql-typeorm">NestJS TypeORM documentation page</a></p>
</div>
</div>
<div class="sect3">
<h4 id="configuration-20"><a class="anchor" href="#configuration-20"></a>23.51. Configuration</h4>
<div class="paragraph">
<p>When you have the configuration module, the TypeORM generator will add one property in order to be able to configure the database depending on the environment. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">database: {
  type: 'sqlite',
  database: ':memory:',
  synchronize: false,
  migrationsRun: true,
  logging: true,
  entities: ['dist/**/*.entity.js'],
  migrations: ['dist/migration/**/*.js'],
  subscribers: ['dist/subscriber/**/*.js'],
  cli: {
    entitiesDir: 'src/entity',
    migrationsDir: 'src/migration',
    subscribersDir: 'src/subscriber',
  },
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>This object is a TypeORM <code>ConnectionOptions</code>. For fore information about it visit the <a href="https://typeorm.io/#/connection-options/">TypeORM Connection Options page</a>.</p>
</div>
<div class="paragraph">
<p>There is also a special case: the default configuration. As the devon4node CLI need the database configuration when you use the <code>devon4node db</code> command, we also provide the ormconfig.json file. In this file you must put the configuration for you local environment. In order to do not have duplicated the configuration for local environment, in the default config file the database property is set-up like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">database: require('../../ormconfig.json'),</code></pre>
</div>
</div>
<div class="paragraph">
<p>So, you only need to maintain the ormconfig.json file for the local environment.</p>
</div>
</div>
<div class="sect3">
<h4 id="entity-2"><a class="anchor" href="#entity-2"></a>23.52. Entity</h4>
<div class="paragraph">
<p>Entity is a class that maps to a database table. The devon4node schematics has a generator to create new entities. You only need to execute the command <code>nest g -c @devon4node/schematics entity &lt;entity-name&gt;</code> and it generate the entity.</p>
</div>
<div class="paragraph">
<p>In the entity, you must define all columns, relations, primary keys of your database table. By default, devon4node provides a class named <code>BaseEntity</code>. All entities created with the devon4node schematics will extends the <code>BaseEntity</code>. This entity provides you some common columns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>id</code>: the primary key of you table</p>
</li>
<li>
<p><code>version</code>: the version of the entry (used for auditing purposes)</p>
</li>
<li>
<p><code>createdAt</code>: creation date of the entry (used for auditing purposes)</p>
</li>
<li>
<p><code>updatedAt</code>: last update date of the entry (used for auditing purposes)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about Entities, please visit the <a href="https://typeorm.io/#/entities">TypeORM entities page</a></p>
</div>
</div>
<div class="sect3">
<h4 id="repository-3"><a class="anchor" href="#repository-3"></a>23.53. Repository</h4>
<div class="paragraph">
<p>With repositories, you can manage (insert, update, delete, load, etc.) a concrete entity. Using this pattern, we have separated the data (Entities) from the methods to manage it (Repositories).</p>
</div>
<div class="paragraph">
<p>To use a repository you only need to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Import it in the module as follows:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Module({
  imports: [TypeOrmModule.forFeature([Employee])],
})</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
if you generate the entities with the devon4node schematic, this step is not necessary, devon4node schematic will do it for you.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Inject the repository as dependency in your service:</p>
<div class="listingblock">
<div class="content">
<pre>constructor(@InjectRepository(Employee) employeeRepository: Repository&lt;Employee&gt;) {}</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can see more details in the <a href="https://docs.nestjs.com/techniques/database">NestJS database</a> and <a href="https://docs.nestjs.com/recipes/sql-typeorm">NestJS TypeORM</a> documentation pages.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="serializer"><a class="anchor" href="#serializer"></a>23.54. Serializer</h4>
<div class="paragraph">
<p>Serialization is the process of translating data structures or object state into a format that can be transmitted across network and reconstructed later.</p>
</div>
<div class="paragraph">
<p>NestJS by default serialize all data to JSON (JSON.stringify). Sometimes this is not enough. In some situations you need to exclude some property (e.g password). Instead doing it manually, devon4node provides an interceptor (<code>ClassSerializerInterceptor</code>) that will do it for you. You only need to return a class instance as always and the interceptor will transform those class to the expected data.</p>
</div>
<div class="paragraph">
<p>The <code>ClassSerializerInterceptor</code> takes the <a href="https://github.com/typestack/class-transformer">class-transformer</a> decorators in order to know how to transform the class and then send the result to the client.</p>
</div>
<div class="paragraph">
<p>Some of class-transformer decorators are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Expose</p>
</li>
<li>
<p>Exclude</p>
</li>
<li>
<p>Type</p>
</li>
<li>
<p>Transform</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And methods to transform data:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>plainToClass</p>
</li>
<li>
<p>plainToClassFromExist</p>
</li>
<li>
<p>classToPlain</p>
</li>
<li>
<p>classToClass</p>
</li>
<li>
<p>serialize</p>
</li>
<li>
<p>deserialize</p>
</li>
<li>
<p>deserializeArray</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/typestack/class-transformer">class-transformer</a> page for more information.</p>
</div>
<div class="paragraph">
<p>See <a href="https://docs.nestjs.com/techniques/serialization">NestJS serialization page</a> for more information about <code>ClassSerializerInterceptor</code>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="validation-2"><a class="anchor" href="#validation-2"></a>23.55. Validation</h4>
<div class="paragraph">
<p>To be sure that your application will works well, you must validate any input data. devon4node by default provides a <code>ValidationPipe</code>. This <code>ValidationPipe</code> is the responsible of validate the request input and, if the input do not pass the validation process, it returns a <code>400 Bad Request</code> error.</p>
</div>
</div>
<div class="sect3">
<h4 id="defining-validators"><a class="anchor" href="#defining-validators"></a>23.56. Defining Validators</h4>
<div class="paragraph">
<p>The <code>ValidationPipe</code> needs to know how to validate the input. For that purpose we use the <code>class-validator</code> package. This package allows you to define the validation of a class by using decorators.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export class Coffee {
  @IsDefined()
  @IsString()
  @MaxLength(255)
  name: string;

  @IsDefined()
  @IsString()
  @MaxLength(25)
  type: string;

  @IsDefined()
  @IsNumber()
  quantity: number;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see in the previous example, we used some decorators in order to define the validators for every property of the Coffee class. You can find all decorators in the <a href="https://github.com/typestack/class-validator">class-validator github repository</a>.</p>
</div>
<div class="paragraph">
<p>Now, when you want to receive a Coffee as input in some endpoint, it will execute the validations before executing the handler function.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In order to be able to use the class-validator package, you must use classes instead of interfaces. As you know interfaces disappear at compiling time, and class-validator need to know the metadata of the properties in order to be able to validate.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>ValidationPipe</code> only works if you put a specific type in the handler definition. For example, if you define a handler like <code>getCoffee(@Body() coffee: any): Coffee {}</code> the ValidationPipe will not do anything. You must specify the type of the input: <code>getCoffee(@Body() coffee: Coffee): Coffee {}</code>
</td>
</tr>
</table>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="logger"><a class="anchor" href="#logger"></a>23.57. Logger</h4>
<div class="paragraph">
<p>When you create a new devon4node application, it already has a logger: <code>src/app/shared/logger/winston.logger.ts</code>. This logger provide the methods <code>log</code>, <code>error</code> and <code>warn</code>. All of those methods will write a log message, but with a different log level.</p>
</div>
<div class="paragraph">
<p>The winston logger has two transports: one to log everything inside the file logs/general.log and the other to log only the error logs inside the file logs/error.log. In addition, it uses the default NestJS logger in order to show the logs in the console.</p>
</div>
<div class="paragraph">
<p>As you can see it is a simple example about how to use logger in a devon4node application. It will be update to a complex one in the next versions.</p>
</div>
</div>
<div class="sect3">
<h4 id="how-to-use-logger"><a class="anchor" href="#how-to-use-logger"></a>23.58. How to use logger</h4>
<div class="paragraph">
<p>In order to use the logger you only need to inject the logger as a dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">constructor(logger: WinstonLogger){}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and then use it</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">async getAll() {
  this.service.getAll();
  this.logger.log('Returning all data');
}</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="mailer-module"><a class="anchor" href="#mailer-module"></a>23.59. Mailer Module</h4>
<div class="paragraph">
<p>This module enables you to send emails in devon4node. It also provides a template engine using Handlebars.</p>
</div>
<div class="paragraph">
<p>It is a NestJS module that inject into your application a <code>MailerService</code>, which is the responsible to send the emails using the nodemailer library.</p>
</div>
</div>
<div class="sect3">
<h4 id="installing"><a class="anchor" href="#installing"></a>23.60. Installing</h4>
<div class="paragraph">
<p>Execute the following command in a devon4node project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">yarn add @devon4node/mailer</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="configuring"><a class="anchor" href="#configuring"></a>23.61. Configuring</h4>
<div class="paragraph">
<p>To configure the mailer module, you only need to import it in your application into another module. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Module({
  ...
  imports: [
    MailerModule.forRoot(),
  ],
  ...
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your must pass the configuration using the <code>forRoot</code> or <code>forRootAsync</code> methods.</p>
</div>
</div>
<div class="sect3">
<h4 id="forroot"><a class="anchor" href="#forroot"></a>23.62. <code>forRoot()</code></h4>
<div class="paragraph">
<p>The <code>forRoot</code> method receives an <code>MailerModuleOptions</code> object as parameter. It configures the <code>MailerModule</code> using the input <code>MailerModuleOptions</code> object.</p>
</div>
<div class="paragraph">
<p>The structure of <code>MailerModuleOptions</code> is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">{
  hbsOptions?: {
    templatesDir: string;
    extension?: string;
    partialsDir?: string;
    helpers?: IHelperFunction[];
    compilerOptions?: ICompileOptions;
  },
  mailOptions?: nodemailerSmtpTransportOptions;
  emailFrom: string;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, you need to specify the <a href="https://handlebarsjs.com/api-reference/compilation.html#handlebars-compile-template-options">Handlebars compile options</a>, the <a href="https://nodemailer.com/smtp">nodemailer transport options</a> and the email address which will send the emails.
Then, you need to call to <code>forRoot</code> function in the module imports. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Module({
  ...
  imports: [
    MailerModule.forRoot({
      mailOptions: {
        host: 'localhost',
        port: 1025,
        secure: false,
        tls: {
          rejectUnauthorized: false,
        },
      },
      emailFrom: 'noreply@capgemini.com',
      hbsOptions: {
        templatesDir: join(__dirname, '../..', 'templates/views'),
        partialsDir: join(__dirname, '../..', 'templates/partials'),
        helpers: [{
          name: 'fullname',
          func: person =&gt; `${person.name} ${person.surname}`,s
        }],
      },
    }),
  ...
})</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="forrootasync"><a class="anchor" href="#forrootasync"></a>23.63. <code>forRootAsync()</code></h4>
<div class="paragraph">
<p>The method <code>forRootAsync</code> enables you to get the mailer configuration in a asynchronous way. It is useful when you need to get the configuration using, for example, a service (e.g. <code>ConfigurationService</code>).</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Module({
  ...
  imports: [
    MailerModule.forRootAsync({
      imports: [ConfigurationModule],
      useFactory: (config: ConfigurationService) =&gt; {
        return config.mailerConfig;
      },
      inject: [ConfigurationService],
    }),
  ...
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, we use the <code>ConfigurationService</code> in order to get the <code>MailerModuleOptions</code> (the same as <code>forRoot</code>)</p>
</div>
</div>
<div class="sect3">
<h4 id="usage-7"><a class="anchor" href="#usage-7"></a>23.64. Usage</h4>
<div class="paragraph">
<p>In order to use, you only need to inject using the dependency injection the <code>MailerService</code>.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Injectable()
export class CatsService {
  constructor(private readonly mailer: MailerService) {}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, you only need to use the methods provided by the <code>MailerService</code> in your service. Take into account that you can inject it in every place that support NestJS dependency injection.</p>
</div>
</div>
<div class="sect3">
<h4 id="mailerservice-methods"><a class="anchor" href="#mailerservice-methods"></a>23.65. <code>MailerService</code> methods</h4>

</div>
<div class="sect3">
<h4 id="sendplainmail"><a class="anchor" href="#sendplainmail"></a>23.66. ==  <code>sendPlainMail</code></h4>
<div class="paragraph">
<p>The method <code>sendPlainMail</code> receive a string sends a email.</p>
</div>
<div class="paragraph">
<p>The method signatures are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">sendPlainMail(emailOptions: SendMailOptions): Promise&lt;SentMessageInfo&gt;;
sendPlainMail(to: string, subject: string, mail: string): Promise&lt;SentMessageInfo&gt;;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">this.mailer.sendPlainMail({
  to: 'example@example.com',
  subject: 'This is a subject',
  html: '&lt;h1&gt;Hello world&lt;/h1&gt;'
});
this.mailer.sendPlainMail('example@example.com', 'This is a subject', '&lt;h1&gt;Hello world&lt;/h1&gt;');</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="sendtemplatemail"><a class="anchor" href="#sendtemplatemail"></a>23.67. ==  <code>sendTemplateMail</code></h4>
<div class="paragraph">
<p>The method <code>sendTemplateMail</code> sends a email based on a Handlebars template. The templates are registered using the <code>templatesDir</code> option or using the <code>addTemplate</code> method.
The template name is the name of the template (without extension) or the first parameter of the method <code>addTemplate</code>.</p>
</div>
<div class="paragraph">
<p>The method signatures are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">sendTemplateMail(emailOptions: SendMailOptions, templateName: string, emailData: any, hbsOptions?: RuntimeOptions): Promise&lt;SentMessageInfo&gt;;
sendTemplateMail(to: string, subject: string, templateName: string, emailData: any, hbsOptions?: RuntimeOptions): Promise&lt;SentMessageInfo&gt;;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">this.mailer.sendTemplateMail({
  to: 'example@example.com',
  subject: 'This is a subject',
  html: '&lt;h1&gt;Hello world&lt;/h1&gt;'
}, 'template1', { person: {name: 'Dario', surname: 'Rodriguez'}});
this.mailer.sendTemplateMail('example@example.com', 'This is a subject', 'template1', { person: {name: 'Dario', surname: 'Rodriguez'}});</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="addtemplate"><a class="anchor" href="#addtemplate"></a>23.68. ==  <code>addTemplate</code></h4>
<div class="paragraph">
<p>Adds a new template to the <code>MailerService</code>.</p>
</div>
<div class="paragraph">
<p>Method signature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">addTemplate(name: string, template: string, options?: CompileOptions): void;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">this.mailer.addTemplate('newTemplate', '&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;{{&gt;partial1}}&lt;/body&gt;&lt;/html&gt;')</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="registerpartial"><a class="anchor" href="#registerpartial"></a>23.69. ==  <code>registerPartial</code></h4>
<div class="paragraph">
<p>Register a new partial in Handlebars.</p>
</div>
<div class="paragraph">
<p>Method signature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">registerPartial(name: string, partial: Handlebars.Template&lt;any&gt;): void;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">this.mailer.registerPartial('partial', '&lt;h1&gt;Hello World&lt;/h1&gt;')</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="registerhelper"><a class="anchor" href="#registerhelper"></a>23.70. ==  <code>registerHelper</code></h4>
<div class="paragraph">
<p>Register a new helper in Handlebars.</p>
</div>
<div class="paragraph">
<p>Method signature:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">registerHelper(name: string, helper: Handlebars.HelperDelegate): void;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">this.mailer.registerHelper('fullname', person =&gt; `${person.name} ${person.surname}`)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="handlebars-templates"><a class="anchor" href="#handlebars-templates"></a>23.71. Handlebars templates</h4>
<div class="paragraph">
<p>As mentioned above, this module allow you to use Handlebars as template engine, but it is optional. If you do not need the Handlebars, you just need to keep the <code>hbsOptions</code> undefined.</p>
</div>
<div class="paragraph">
<p>In order to get the templates form the file system, you can specify the template folder, the partials folder and the helpers.
At the moment of module initialization, it will read the content of the template folder, and will register every file with the name (without extension) and the content as Handlebars template. It will do the same for the partials.</p>
</div>
<div class="paragraph">
<p>You can specify the extension of template files using the <code>extension</code> parameter. The default value is <code>.handlebars</code></p>
</div>
</div>
<div class="sect3">
<h4 id="local-development"><a class="anchor" href="#local-development"></a>23.72. Local development</h4>
<div class="paragraph">
<p>If you want to work with this module but you don&#8217;t have a SMTP server, you can use the <code>streamTransport</code>. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">{
  mailOptions: {
    streamTransport: true,
    newline: 'windows',
  },
  emailFrom: ...
  hbsOptions: ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, you need to get the <code>sendPlainMail</code> or <code>sendTemplateMail</code> result, and print the email to the standard output (<code>STDOUT</code>). Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">const mail = await this.mailer.sendTemplateMail(...);

mail.message.pipe(process.stdout);</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="importing-your-eslint-reports-into-sonarqube"><a class="anchor" href="#importing-your-eslint-reports-into-sonarqube"></a>23.73. Importing your ESLint reports into SonarQube</h4>
<div class="paragraph">
<p>This guide covers the import of ESLint reports into SonarQube instances in CI environments, as this is the recommended way of using ESLint and SonarQube for devon4node projects. The prerequisites for this process are a CI environment, preferably a <a href="https://github.com/devonfw/production-line">Production Line</a> instance, and the <a href="https://eslint.org/docs/user-guide/command-line-interface">ESLint CLI</a>, which is already included when generating a new devon4node project.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuring-the-eslint-analysis"><a class="anchor" href="#configuring-the-eslint-analysis"></a>23.74. Configuring the ESLint analysis</h4>
<div class="paragraph">
<p>You can configure the ESLint analysis parameters in the <code>.eslintrc.js</code> file inside the top-level directory of your project. If you created your node project using the devon4node application schematic, this file will already exist. If you want to make further adjustments to it, have a look at the <a href="https://eslint.org/docs/user-guide/configuring">ESLint documentation</a>.</p>
</div>
<div class="paragraph">
<p>The ESLint analysis script <code>lint</code> is already configured in the <code>scripts</code> part of your <code>package.json</code>. Simply add <code>-f json &gt; report.json</code>, so that the output of the analysis is saved in a .json file. Additional information to customization options for the ESLint CLI can be found <a href="https://eslint.org/docs/user-guide/command-line-interface#options">here</a>.</p>
</div>
<div class="paragraph">
<p>To run the analysis, execute the script with <code>npm run lint</code> inside the base directory of your project.</p>
</div>
</div>
<div class="sect3">
<h4 id="configuring-sonarqube"><a class="anchor" href="#configuring-sonarqube"></a>23.75. Configuring SonarQube</h4>
<div class="paragraph">
<p>If you haven&#8217;t already generated your CICD-related files, follow the tutorial on the <a href="https://github.com/devonfw/cicdgen/wiki/devon4node-schematic">devon4node schematic</a> of our CICDGEN project, as you will need a Jenkinsfile configured in your project to proceed.</p>
</div>
<div class="paragraph">
<p>Inside the script for the SonarQube code analysis in your Jenkinsfile, add the parameter <code>-Dsonar.eslint.reportPaths=report.json</code>. Now, whenever a SonarQube analysis is triggered by your CI environment, the generated report will be loaded into your SonarQube instance.
To avoid duplicated issues, you can associate an empty TypeScript quality profile with your project in its server configurations.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="devon4node-applications"><a class="anchor" href="#devon4node-applications"></a>24. devon4node applications</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="devon4node-samples"><a class="anchor" href="#devon4node-samples"></a>24.1. devon4node Samples</h4>
<div class="paragraph">
<p>In the folder /samples, you can find some devon4node examples that could be useful for you in order to understand better the framework.</p>
</div>
<div class="paragraph">
<p>The samples are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4node/tree/develop/samples/employee">Employee</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4node/tree/develop/samples/components-example">Components example</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also, we have another realistic example in the <a href="https://github.com/devonfw/my-thai-star/tree/develop/node">My Thai Star repository</a>. This example is the implementation of My Thai Star backend, which is compatible with the frontend made with Angular. To do that, this node implementation exposes the same API as Java backend. Take care with this example, as we need to follow the Java API, some components do not follow the devon4node patterns and code conventions.</p>
</div>
</div>
<div class="sect3">
<h4 id="todo-example"><a class="anchor" href="#todo-example"></a>24.2. Todo example</h4>
<div class="paragraph">
<p>This example is the backend part of an TO-DO application. It exposes and API where you can create, read, update and delete a TO-DO list.</p>
</div>
<div class="paragraph">
<p>In order to start the application, run the following commands in the todo folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn
$ yarn build
$ yarn start</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, you can access to the application using the url <code><a href="http://localhost:3000/v1/todo/todos" class="bare">http://localhost:3000/v1/todo/todos</a></code>. If you want to now all endpoints exposed, you can see the swagger at: <code><a href="http://localhost:3000/v1/api" class="bare">http://localhost:3000/v1/api</a></code>.</p>
</div>
<div class="paragraph">
<p>Also, in this example we show you how to control the access to you application by implementing an authentication mechanism using JWT and rol based strategy. In order to access to the list of todos (<code><a href="http://localhost:3000/v1/todo/todos" class="bare">http://localhost:3000/v1/todo/todos</a></code>), first you need to call to <code>POST <a href="http://localhost:3000/v1/auth/login" class="bare">http://localhost:3000/v1/auth/login</a></code> and in the body you need to send the user information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "username": "user",
  "password": "password"
}</pre>
</div>
</div>
<div class="paragraph">
<p>It will return a JWT token for the user <code>user</code>. The rol of this user is USER, so you can only access to the methods GET, POST and DELETE of the endpoint <code><a href="http://localhost:3000/v1/todo/todos" class="bare">http://localhost:3000/v1/todo/todos</a></code>. If you login with the user admin/admin, you will be able to access to the methods UPDATE and PATCH.</p>
</div>
</div>
<div class="sect3">
<h4 id="employee-example"><a class="anchor" href="#employee-example"></a>24.3. Employee example</h4>
<div class="paragraph">
<p>This is an example of employee management application. With the application you can create, read, update and delete employees.</p>
</div>
<div class="paragraph">
<p>In order to start the application, run the following commands in the todo folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn
$ yarn build
$ yarn start</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, you can access to the application using the url <code><a href="http://localhost:8081/v1/employee/employees" class="bare">http://localhost:8081/v1/employee/employees</a></code>. If you want to now all endpoints exposed, you can see the swagger at: <code><a href="http://localhost:8081/v1/api" class="bare">http://localhost:8081/v1/api</a></code>.</p>
</div>
<div class="paragraph">
<p>This is a simple example without authentication. With this example you can learn how to work with database migrations. You can find them in the folder /src/migrations. The TypeORM is configured in order to execute the migrations every time that you start this application at ormconfig.json with the following flag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>"migrationsRun": true</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also execute the migration manually by typing the command <code>devon4node db migration:run</code>, or revert executing <code>devon4node db migration:revert</code>. Take into account that the database that this application is using is an in-memory sqlite, so every time that you stop the application all data is lost.</p>
</div>
</div>
<div class="sect3">
<h4 id="components-example"><a class="anchor" href="#components-example"></a>24.4. Components example</h4>
<div class="paragraph">
<p>This example allow you to understand better the execution order of the components of a devon4node application (guards, pipes, interceptors, filters, middleware).</p>
</div>
<div class="paragraph">
<p>In order to start the application, run the following commands in the todo folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ yarn
$ yarn build
$ yarn start</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to see the execution order, you can call to <code><a href="http://localhost:3000/v1" class="bare">http://localhost:3000/v1</a></code>. It will show you the execution order of all components except the filters. If you want to know the execution order while a filter is applied, call to the endpoint with the following queries: <code>?hello=error</code>, <code>?hello=controller</code>, <code>?hello=global</code>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect3">
<h4 id="create-the-employee-sample-step-by-step"><a class="anchor" href="#create-the-employee-sample-step-by-step"></a>24.5. Create the employee sample step by step</h4>

</div>
<div class="sect3">
<h4 id="application-requisites"><a class="anchor" href="#application-requisites"></a>24.6. Application requisites</h4>
<div class="paragraph">
<p>The employee application needs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A configuration module</p>
</li>
<li>
<p>A SQLite in memory database</p>
</li>
<li>
<p>Security: CORS</p>
</li>
<li>
<p>Swagger support</p>
</li>
<li>
<p>Authentication using JWT</p>
</li>
<li>
<p>CRUD for manage employees. The employees will have the following properties:</p>
<div class="ulist">
<ul>
<li>
<p>name</p>
</li>
<li>
<p>surname</p>
</li>
<li>
<p>email</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="create-the-application"><a class="anchor" href="#create-the-application"></a>24.7. Create the application</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install Nest CLI</p>
<div class="paragraph">
<p>Execute the command <code>yarn global add @nestjs/cli</code></p>
</div>
</li>
<li>
<p>Install devon4node schematics</p>
</li>
<li>
<p>Execute the command <code>yarn global add @devon4node/schematics</code></p>
</li>
<li>
<p>Create the new application</p>
<div class="paragraph">
<p>Execute the command <code>nest g -c @devon4node/schematics application employee</code></p>
</div>
</li>
<li>
<p>Then, we need to add some components, go inside the project folder and execute the following commands:</p>
<div class="paragraph">
<p>Go inside project folder: <code>cd employee</code>.</p>
</div>
<div class="paragraph">
<p>Config module: <code>nest g -c @devon4node/schematics config-module</code>.</p>
</div>
<div class="paragraph">
<p>TypeORM database, choose sqlite DB when asked <code>nest g -c @devon4node/schematics typeorm</code>.</p>
</div>
<div class="paragraph">
<p>Add security: <code>nest g -c @devon4node/schematics security</code>.</p>
</div>
<div class="paragraph">
<p>Swagger module: <code>nest g -c @devon4node/schematics swagger</code>.</p>
</div>
<div class="paragraph">
<p>Auth-jwt authentication: <code>nest g -c @devon4node/schematics auth-jwt</code>.</p>
</div>
<div class="paragraph">
<p>Add an application module: <code>nest g -c @devon4node/schematics module employee</code>.</p>
</div>
<div class="paragraph">
<p>Add CRUD component: <code>nest g -c @devon4node/schematics crud employee/employee</code>.</p>
</div>
<div class="paragraph">
<p>With this, you will generate the following files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/employee/.prettierrc
/employee/nest-cli.json
/employee/package.json
/employee/README.md
/employee/tsconfig.build.json
/employee/tsconfig.json
/employee/tslint.json
/employee/src/main.ts
/employee/test/app.e2e-spec.ts
/employee/test/jest-e2e.json
/employee/src/app/app.controller.spec.ts
/employee/src/app/app.controller.ts
/employee/src/app/app.module.ts
/employee/src/app/app.service.ts
/employee/src/app/core/core.module.ts
/employee/src/app/shared/logger/winston.logger.ts
/employee/src/app/core/configuration/configuration.module.ts
/employee/src/app/core/configuration/model/index.ts
/employee/src/app/core/configuration/model/types.ts
/employee/src/app/core/configuration/services/configuration.service.spec.ts
/employee/src/app/core/configuration/services/configuration.service.ts
/employee/src/app/core/configuration/services/index.ts
/employee/src/config/default.ts
/employee/src/config/develop.ts
/employee/src/config/production.ts
/employee/src/config/test.ts
/employee/src/config/uat.ts
/employee/docker-compose.yml
/employee/ormconfig.json
/employee/src/app/shared/model/entities/base-entity.entity.ts
/employee/src/app/core/auth/auth.module.ts
/employee/src/app/core/auth/controllers/auth.controller.spec.ts
/employee/src/app/core/auth/controllers/auth.controller.ts
/employee/src/app/core/auth/controllers/index.ts
/employee/src/app/core/auth/decorators/index.ts
/employee/src/app/core/auth/decorators/roles.decorator.spec.ts
/employee/src/app/core/auth/decorators/roles.decorator.ts
/employee/src/app/core/auth/guards/index.ts
/employee/src/app/core/auth/guards/roles.guard.spec.ts
/employee/src/app/core/auth/guards/roles.guard.ts
/employee/src/app/core/auth/model/index.ts
/employee/src/app/core/auth/model/roles.enum.ts
/employee/src/app/core/auth/model/user-request.interface.ts
/employee/src/app/core/auth/services/auth.service.spec.ts
/employee/src/app/core/auth/services/auth.service.ts
/employee/src/app/core/auth/services/index.ts
/employee/src/app/core/auth/strategies/index.ts
/employee/src/app/core/auth/strategies/jwt.strategy.spec.ts
/employee/src/app/core/auth/strategies/jwt.strategy.ts
/employee/src/app/core/user/user.module.ts
/employee/src/app/core/user/model/index.ts
/employee/src/app/core/user/model/dto/user-payload.dto.ts
/employee/src/app/core/user/model/entities/user.entity.ts
/employee/src/app/core/user/services/index.ts
/employee/src/app/core/user/services/user.service.spec.ts
/employee/src/app/core/user/services/user.service.ts
/employee/test/auth/auth.service.mock.ts
/employee/test/user/user.repository.mock.ts
/employee/src/app/employee/employee.module.ts
/employee/src/app/employee/model/entities/employee.entity.ts
/employee/src/app/employee/model/index.ts
/employee/src/app/employee/controllers/employee.crud.controller.ts
/employee/src/app/employee/services/employee.crud.service.ts
/employee/src/app/employee/services/index.ts
/employee/src/app/employee/controllers/index.ts</pre>
</div>
</div>
</li>
<li>
<p>Open the VSCode</p>
<div class="paragraph">
<p>Execute the commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>yarn install
code .</pre>
</div>
</div>
</li>
<li>
<p>Fill in the entity: src/app/employee/model/entities/employee.entity.ts</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Add the columns</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Entity()
export class Employee extends BaseEntity {
  @Column('varchar', { length: 255, nullable: true })
  name?: string;

  @Column('varchar', { length: 255, nullable: true })
  surname?: string;

  @Column('varchar', { length: 255, nullable: true })
  email?: string;
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add the validations</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Entity()
export class Employee extends BaseEntity {
  @IsDefined({ groups: [CrudValidationGroups.CREATE] })
  @IsOptional({ groups: [CrudValidationGroups.UPDATE] })
  @MaxLength(255)
  @Column('varchar', { length: 255, nullable: true })
  name?: string;

  @IsDefined({ groups: [CrudValidationGroups.CREATE] })
  @IsOptional({ groups: [CrudValidationGroups.UPDATE] })
  @MaxLength(255)
  @Column('varchar', { length: 255, nullable: true })
  surname?: string;

  @IsDefined({ groups: [CrudValidationGroups.CREATE] })
  @IsOptional({ groups: [CrudValidationGroups.UPDATE] })
  @MaxLength(255)
  @IsEmail()
  @Column('varchar', { length: 255, nullable: true })
  email?: string;
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add the transformations</p>
<div class="paragraph">
<p>In this specific case, we will not transform any property, but you can see an example in the <code>src/app/shared/model/entities/base-entity.entity.ts</code> file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export abstract class BaseEntity {
  @PrimaryGeneratedColumn('increment')
  id!: number;

  @VersionColumn({ default: 1 })
  @Exclude({ toPlainOnly: true })
  version!: number;

  @CreateDateColumn()
  @Exclude({ toPlainOnly: true })
  createdAt!: string;

  @UpdateDateColumn()
  @Exclude({ toPlainOnly: true })
  updatedAt!: string;
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add swagger metadata</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@Entity()
export class Employee extends BaseEntity {
  @ApiPropertyOptional()
  @IsDefined({ groups: [CrudValidationGroups.CREATE] })
  @IsOptional({ groups: [CrudValidationGroups.UPDATE] })
  @MaxLength(255)
  @Column('varchar', { length: 255, nullable: true })
  name?: string;

  @ApiPropertyOptional()
  @IsDefined({ groups: [CrudValidationGroups.CREATE] })
  @IsOptional({ groups: [CrudValidationGroups.UPDATE] })
  @MaxLength(255)
  @Column('varchar', { length: 255, nullable: true })
  surname?: string;

  @ApiPropertyOptional()
  @IsDefined({ groups: [CrudValidationGroups.CREATE] })
  @IsOptional({ groups: [CrudValidationGroups.UPDATE] })
  @MaxLength(255)
  @IsEmail()
  @Column('varchar', { length: 255, nullable: true })
  email?: string;
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Add swagger metadata to <code>src/app/employee/controllers/employee.crud.controller.ts</code></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">@ApiTags('employee')</code></pre>
</div>
</div>
</li>
<li>
<p>Generate database migrations</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Build the application: <code>yarn build</code></p>
</li>
<li>
<p>In order to create migration scripts with TypeORM, you need to install ts-node: <code>yarn global add ts-node</code></p>
</li>
<li>
<p>Generate the tables creation migration: <code>yarn run typeorm migration:generate -n CreateTables</code></p>
<div class="imageblock">
<div class="content">
<img src="_images/images/sample/generate-migrations.PNG" alt="generate migrations">
</div>
</div>
<div class="paragraph">
<p>The output will be something similar to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export class CreateTables1572480273012 implements MigrationInterface {
  name = 'CreateTables1572480273012';

  public async up(queryRunner: QueryRunner): Promise&lt;any&gt; {
    await queryRunner.query(
      `CREATE TABLE "user" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "version" integer NOT NULL DEFAULT (1), "createdAt" datetime NOT NULL DEFAULT (datetime('now')), "updatedAt" datetime NOT NULL DEFAULT (datetime('now')), "username" varchar(255) NOT NULL, "password" varchar(255) NOT NULL, "role" integer NOT NULL DEFAULT (0))`,
      undefined,
    );
    await queryRunner.query(
      `CREATE TABLE "employee" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "version" integer NOT NULL DEFAULT (1), "createdAt" datetime NOT NULL DEFAULT (datetime('now')), "updatedAt" datetime NOT NULL DEFAULT (datetime('now')), "name" varchar(255), "surname" varchar(255), "email" varchar(255))`,
      undefined,
    );
  }

  public async down(queryRunner: QueryRunner): Promise&lt;any&gt; {
    await queryRunner.query(`DROP TABLE "employee"`, undefined);
    await queryRunner.query(`DROP TABLE "user"`, undefined);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The number in the name is a timestamp, so may change in your application.</p>
</div>
</li>
<li>
<p>Create a migration to insert data:`yarn run typeorm migration:generate -n InsertData`</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/sample/insert-data.PNG" alt="insert data">
</div>
</div>
<div class="paragraph">
<p>and fill in with the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">export class InsertData1572480830290 implements MigrationInterface {
  public async up(queryRunner: QueryRunner): Promise&lt;any&gt; {
    await queryRunner.query(
      `INSERT INTO EMPLOYEE(id, name, surname, email) VALUES(1, 'Santiago', 'Fowler', 'Santiago.Fowler@example.com');`,
    );
    await queryRunner.query(
      `INSERT INTO EMPLOYEE(id, name, surname, email) VALUES(2, 'Clinton', 'Thornton', 'Clinton.Thornton@example.com');`,
    );
    await queryRunner.query(
      `INSERT INTO EMPLOYEE(id, name, surname, email) VALUES(3, 'Lisa', 'Rodriquez', 'Lisa.Rodriquez@example.com');`,
    );
    await queryRunner.query(
      `INSERT INTO EMPLOYEE(id, name, surname, email) VALUES(4, 'Calvin', 'Becker', 'Calvin.Becker@example.com');`,
    );
    await queryRunner.query(`INSERT INTO USER(id, username, password, role) VALUES(?, ?, ?, ?);`, [
      1,
      'user',
      await hash('password', await genSalt(12)),
      roles.USER,
    ]);
    await queryRunner.query(`INSERT INTO USER(id, username, password, role) VALUES(?, ?, ?, ?);`, [
      2,
      'admin',
      await hash('admin', await genSalt(12)),
      roles.ADMIN,
    ]);
  }

  public async down(queryRunner: QueryRunner): Promise&lt;any&gt; {
    await queryRunner.query(`DELETE FROM EMPLOYEE`);
    await queryRunner.query(`DELETE FROM USER`);
  }
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Start the application: <code>yarn start:dev</code></p>
<div class="imageblock">
<div class="content">
<img src="_images/images/sample/start-app.png" alt="start app">
</div>
</div>
</li>
<li>
<p>Check the swagger endpoint: <code><a href="http://localhost:3000/v1/api" class="bare">http://localhost:3000/v1/api</a></code></p>
<div class="imageblock">
<div class="content">
<img src="_images/images/sample/swagger.png" alt="swagger">
</div>
</div>
</li>
<li>
<p>Make petitions to the employee CRUD: <code><a href="http://localhost:3000/v1/employee/employees" class="bare">http://localhost:3000/v1/employee/employees</a></code></p>
<div class="imageblock">
<div class="content">
<img src="_images/images/sample/employees.png" alt="employees">
</div>
</div>
</li>
<li>
<p>Write the tests</p>
<div class="paragraph">
<p>As we do not create any method, only add some properties to the entity, all application must be tested by the autogenerated code. As we add some modules, you need to uncomment some lines in the <code>src/app/core/configuration/services/configuration.service.spec.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-typescript hljs" data-lang="typescript">describe('ConfigurationService', () =&gt; {
  const configService: ConfigurationService = new ConfigurationService();

  it('should return the values of test config file', () =&gt; {
    expect(configService.isDev).toStrictEqual(def.isDev);
    expect(configService.host).toStrictEqual(def.host);
    expect(configService.port).toStrictEqual(def.port);
    expect(configService.clientUrl).toStrictEqual(def.clientUrl);
    expect(configService.globalPrefix).toStrictEqual(def.globalPrefix);
    // Remove comments if you add those modules
    expect(configService.database).toStrictEqual(def.database);
    expect(configService.swaggerConfig).toStrictEqual(def.swaggerConfig);
    expect(configService.jwtConfig).toStrictEqual(def.jwtConfig);
    // expect(configService.mailerConfig).toStrictEqual(def.mailerConfig);
  });
  it('should take the value of environment varible if defined', () =&gt; {
    process.env.isDev = 'true';
    process.env.host = 'notlocalhost';
    process.env.port = '123456';
    process.env.clientUrl = 'http://theclienturl.net';
    process.env.globalPrefix = 'v2';
    process.env.swaggerConfig = JSON.stringify({
      swaggerTitle: 'Test Application',
    });
    process.env.database = JSON.stringify({
      type: 'oracle',
      cli: { entitiesDir: 'src/notentitiesdir' },
    });
    process.env.jwtConfig = JSON.stringify({ secret: 'NOTSECRET' });
    // process.env.mailerConfig = JSON.stringify({ mailOptions: { host: 'notlocalhost' }});

    expect(configService.isDev).toBe(true);
    expect(configService.host).toBe('notlocalhost');
    expect(configService.port).toBe(123456);
    expect(configService.clientUrl).toBe('http://theclienturl.net');
    expect(configService.globalPrefix).toBe('v2');
    const database: any = { ...def.database, type: 'oracle' };
    database.cli.entitiesDir = 'src/notentitiesdir';
    expect(configService.database).toStrictEqual(database);
    expect(configService.swaggerConfig).toStrictEqual({
      ...def.swaggerConfig,
      swaggerTitle: 'Test Application',
    });
    expect(configService.jwtConfig).toStrictEqual({
      ...def.jwtConfig,
      secret: 'NOTSECRET',
    });
    // const mail: any = { ...def.mailerConfig };
    // mail.mailOptions.host = 'notlocalhost';
    // expect(configService.mailerConfig).toStrictEqual(mail);

    process.env.isDev = undefined;
    process.env.host = undefined;
    process.env.port = undefined;
    process.env.clientUrl = undefined;
    process.env.globalPrefix = undefined;
    process.env.database = undefined;
    process.env.swaggerConfig = undefined;
    process.env.jwtConfig = undefined;
    // process.env.mailerConfig = undefined;
  });
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the output should be:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/sample/test.png" alt="test">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="choosing-your-database"><a class="anchor" href="#choosing-your-database"></a>25. Choosing your Database</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect2">
<h3 id="database-3"><a class="anchor" href="#database-3"></a>25.1. Database</h3>
<div class="paragraph">
<p>For your business application with devonfw you need to choose the right database.
In devonfw we are not biased for a particular product so you have the freedom of choice.</p>
</div>
</div>
<div class="sect2">
<h3 id="rdbms"><a class="anchor" href="#rdbms"></a>25.2. RDBMS</h3>
<div class="paragraph">
<p>The classical and well-established form of a database is a relational database management system (RDBMS).
In devonfw we recommend to use an RDBMS unless you have specific need.
However, in case you have the need for big data, graph-data, BLOB focus, or schema-less dynamic data you can have a look at <a href="#nosql">NoSQL</a> options but be aware that these may be experimental and are not fully supported by devonfw.</p>
</div>
</div>
<div class="sect2">
<h3 id="options"><a class="anchor" href="#options"></a>25.3. Options</h3>
<div class="paragraph">
<p>In devonfw we are not biased for a particular RDBMS so you have the freedom of choice.
Here are the most common options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-hana.adoc">SAP Hana</a> (high performance in-memory, many advanced features)</p>
</li>
<li>
<p><a href="guide-oracle.adoc">Oracle</a> (most established, well featured for enterprise)</p>
</li>
<li>
<p><a href="guide-postgresql.adoc">PostgreSQL</a> (great open-source RDBMS)</p>
</li>
<li>
<p><a href="guide-mariadb.adoc">MariaDB</a> (true OSS successor of MySQL)</p>
</li>
<li>
<p><a href="guide-mysqlserver.adoc">MS SQL Server</a> (best choice for Microsoft and Windows dominated IT landscapes)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please click on any of the above choices and go to the according guide to find specific detials such as client/driver.</p>
</div>
</div>
<div class="sect2">
<h3 id="nosql"><a class="anchor" href="#nosql"></a>25.4. NoSQL</h3>
<div class="paragraph">
<p>While not (yet) officially supported and recommendet there are also interesting NoSQL (Not Only SQL) databases that could be an interesting alternative. Please be aware that you will typically not be able to use <a href="guide-jpa.adoc">JPA</a> (and hibernate). Further before choosing a NoSQL database you should check the following aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Is the database of choice reliable and mature enough for your project?</p>
</li>
<li>
<p>Can the operators of your product support the database of choice properly (provisioning, administration, backup, scaling &amp; clustering, monitoring, etc.)?</p>
</li>
<li>
<p>Does the database of choice meet the requirements of your project (ACID vs. eventual consistencey, CAP theorem)?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are good reasons to choose a particular NoSQL database in specific cases (e.g. extreme demand for big-data, throughput or scaling).
But as indicated by the questions above you need to be fully aware of what you are doing.
NoSQL databases can be <em>schemaless</em> (untyped, dynamic &amp; flexible) and/or <em>schemaful</em> (typed, structured &amp; strict).
Furhter, there are different types of NoSQL databases that are discussed in the following sub-sections:</p>
</div>
</div>
<div class="sect2">
<h3 id="java-2"><a class="anchor" href="#java-2"></a>25.5. Java</h3>

</div>
<div class="sect2">
<h3 id="column-db"><a class="anchor" href="#column-db"></a>25.6. ==  Column DB</h3>
<div class="paragraph">
<p>Column NoSQL databases are more related to a regular <a href="#rdbms">RDBMS</a> with their tables and columns.
However, they typically do not offer relational support with joins to the same level as you expect from an RDBMS.
Therefore, you have to carefully design your data-model upfront with the all the knowledge how you later want to query your data.</p>
</div>
<div class="paragraph">
<p>The most prominent options are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-cassandra.adoc">Cassandra</a> (high-performance, schema-based DB)</p>
</li>
<li>
<p><a href="guide-hbase.adoc">HBase</a> (distributed, big-data Hadoop database)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="key-value-db"><a class="anchor" href="#key-value-db"></a>25.7. ==  Key-Value DB</h3>
<div class="paragraph">
<p>As indicated by the name, a key-value database stores objects as key/value pairs similar to <code>Properties</code> or <code>Map</code> in Java.</p>
</div>
<div class="paragraph">
<p>The most prominent options are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-redis.adoc">Redis</a> (in-memory key/value store, especially used as cache or message broker)</p>
</li>
<li>
<p><a href="guide-aerospike.adoc">aerospike</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="document-db"><a class="anchor" href="#document-db"></a>25.8. ==  Document DB</h3>
<div class="paragraph">
<p>A document database is similar to a key-value database, but it stores objects in standard structured formats such as XML, JSON, or BSON.
Therefore not only flat key/value pairs but even trees of hierarchical data can be stored, retrieved and queried.</p>
</div>
<div class="paragraph">
<p>The most prominent options are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-mongodb.adoc">MongoDB</a></p>
</li>
<li>
<p><a href="guide-couchdb.adoc">CouchDB</a></p>
</li>
<li>
<p><a href="guide-ravendb.adoc">RavenDB</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="graph-db"><a class="anchor" href="#graph-db"></a>25.9. ==  Graph DB</h3>
<div class="paragraph">
<p>If the connections (links/relations) between your data is key and an <a href="#rdbms">RDBMS</a> is just not flexible or fast enough for your plans, then a graph database can help you.
They are very strong on storing and querying complex connections between entities.
For queries there are even specific standards and languages like <a href="https://tinkerpop.apache.org/gremlin.html">Gremlin</a>.</p>
</div>
<div class="paragraph">
<p>The most prominent options are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-neo4j.adoc">neo4j</a></p>
</li>
<li>
<p><a href="guide-blazegraph.adoc">blazegraph</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="hybrid-db"><a class="anchor" href="#hybrid-db"></a>25.10. ==  Hybrid DB</h3>
<div class="paragraph">
<p>In addition to the above types there are some NoSQL databases that are hybrid and combine the features and aspects of these types.
While as an architect and developer you might love the idea to get all in one, you have to be careful with your choice.
If you do not exactly know your problem, you are not ready to make the right choice for your database.
Further, you might still be best-off with an good old <a href="#rdbms">RDBMS</a> if you need to address multiple aspects together.
Anyhow, for experiments, PoCs, or small microservices with little risk it might be a great idea to choose a hybrid NoSQL database.
If you have collected very positive, profound and productive experience with such product you can grow on it.</p>
</div>
<div class="paragraph">
<p>The most prominent options are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-orientdb.adoc">OrientDB</a> (object-oriented, hyper-flexible, column- and graph-based)</p>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="sap-hana"><a class="anchor" href="#sap-hana"></a>25.11. SAP HANA</h3>
<div class="paragraph">
<p>This section contains hints for those who use <a href="https://www.sap.com/products/hana.html">SAP HANA</a>, a very powerful and fast RDBMS. Besides general hints about the driver there are tips for more tight integration with other SAP features or products.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-3"><a class="anchor" href="#java-3"></a>25.12. Java</h3>

</div>
<div class="sect2">
<h3 id="driver"><a class="anchor" href="#driver"></a>25.13. Driver</h3>
<div class="paragraph">
<p>SAP Hana is a commercial and professional product.
However, the hana JDBC driver is available in Maven Central what makes it easy to integrate.
All you need is the following maven dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>&lt;dependency&gt;
  &lt;groupId&gt;com.sap.cloud.db.jdbc&lt;/groupId&gt;
  &lt;artifactId&gt;ngdbc&lt;/artifactId&gt;
  &lt;version&gt;${hana.driver.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course the version (<code>${hana.driver.version}</code>) needs to be adopted to your needs (Hana installtion in production, e.g. <code>2.4.64</code>).
For an overview of available driver versions see <a href="https://mvnrepository.com/artifact/com.sap.cloud.db.jdbc/ngdbc/">here</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="developer-usage"><a class="anchor" href="#developer-usage"></a>25.14. Developer Usage</h3>
<div class="paragraph">
<p>For your local development environment you will love the free <a href="https://developers.sap.com/topics/sap-hana-express.html">SAP HANA, Express Edition</a>.</p>
</div>
<div class="paragraph">
<p>You can run HANA in several ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On-premise</p>
<div class="ulist">
<ul>
<li>
<p>Via a <a href="https://developers.sap.com/tutorials/hxe-ua-install-using-docker.html">Docker image</a> (Linux only)</p>
</li>
<li>
<p>Via a pre-configured <a href="https://developers.sap.com/group.hxe-install-vm.html">virtual machine</a> (Windows, Linux, OS X)</p>
</li>
<li>
<p>Installed natively on your <a href="https://developers.sap.com/group.hxe-install-binary.html">local machine</a> (Linux only)</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the cloud</p>
<div class="ulist">
<ul>
<li>
<p>Refer <a href="https://cloud.google.com/solutions/sap/docs/sap-hana-deployment-guide">Google Cloud Platform</a></p>
</li>
<li>
<p>Refer <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/workloads/sap/hana-example-installation">Microsoft Azure Cloud</a></p>
</li>
<li>
<p>Refer <a href="https://aws.amazon.com/sap/solutions/saphana/">Amazon Web Services</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>To get started with SAP HANA, Express Edition you can check out the <a href="https://developers.sap.com/topics/sap-hana-express.html#tutorials">tutorials</a> at the <a href="https://developers.sap.com/">SAP Developer Center</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="pooling-2"><a class="anchor" href="#pooling-2"></a>25.15. Pooling</h3>
<div class="paragraph">
<p>See <a href="https://help.sap.com/viewer/2a4cd05443e84e59bdde9170fa693ddb/1.0.00.0/en-US/0fdda954c7004ad1b889b7785bf82b2e.html">Overriding the JDBC Connection Pool Settings</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="fuzzy-search"><a class="anchor" href="#fuzzy-search"></a>25.16. Fuzzy Search</h3>
<div class="paragraph">
<p>See <a href="https://blogs.sap.com/2015/08/28/dynamism-of-fuzzy-search-in-sap-hana/" class="bare">https://blogs.sap.com/2015/08/28/dynamism-of-fuzzy-search-in-sap-hana/</a> or the <a href="https://help.sap.com/viewer/691cb949c1034198800afde3e5be6570/latest/en-US/cc602780bb5710148aa2bf6cab3c015b.html">SAP HANA Search Developer Guide</a></p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="oracle-rdbms"><a class="anchor" href="#oracle-rdbms"></a>25.17. Oracle RDBMS</h3>
<div class="paragraph">
<p>This section contains hints for those who use Oracle RDBMS. Besides general hints about the driver there are tips for more tight integration with other Oracle features or products. However, if you work for a project where Oracle RDBMS is settled and not going to be replaced (you are in a vendor lock-in anyway), you might want to use even more from Oracle technology to take advantage from a closer integration.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-4"><a class="anchor" href="#java-4"></a>25.18. Java</h3>

</div>
<div class="sect2">
<h3 id="xe"><a class="anchor" href="#xe"></a>25.19. XE</h3>
<div class="paragraph">
<p>For local development you should setup Oracle XE (eXpress Edition).
You need an oracle account, then you can download it from <a href="https://www.oracle.com/technetwork/database/database-technologies/express-edition/downloads/index.html">here</a>.</p>
</div>
<div class="paragraph">
<p>The most comfortable way to run it as needed is using docker. You can build your own docker image from the downloaded RPM using the <a href="https://github.com/oracle/docker-images/tree/master/OracleDatabase/SingleInstance">instructions and dockerfile from oracle</a>. The following commands will build and start Oracle XE <code>18.4.0</code> on your machine:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>git clone https://github.com/oracle/docker-images.git
cd docker-images/OracleDatabase/SingleInstance/dockerfiles
./buildDockerImage.sh -x -v 18.4.0
docker run -d -p 1521:1521 --name=oracle-xe --restart=always -e ORACLE_PWD=«my-sys-pwd» oracle/database:18.4.0-xe</code></pre>
</div>
</div>
<div class="paragraph">
<p>Please note that the <code>buildDockerImage.sh</code> will take a long time. Further after <code>docker run</code> has passed you need to give time for your new container to startup and setup the Oracle XE DB. So be patient and give it some time.
(In case the build of the docker-image <a href="https://github.com/oracle/docker-images/issues/1133">fails reproducibly</a> and you want to give up with the Dockerfiles from Oracle you can also try this inofficial <a href="https://github.com/fuzziebrain/docker-oracle-xe">docker-oracle-xe</a> solution. However, this is not recommended and may lead to other problems.).</p>
</div>
<div class="paragraph">
<p>Starting with XE 18c you need to be aware that oracle introduced a <a href="https://docs.oracle.com/database/121/CNCPT/cdbovrvw.htm">multi-tenant architecture</a>. Hence <code>xe</code> refers to the root <code>CDB</code> while you typically want to connect to the <code>PDB</code> (pluggable database) and XE ships with exactly one of this called <code>xepdb1</code>.
To connect to your local XE database you need to use <code>xepdb1</code> as the <code>Service Name</code> (typically in <code>SQL Developer</code>). The <code>hostname</code> should be <code>localhost</code> and the <code>port</code> is by default <code>1521</code> if you did not remap it with docker to something else.
In order to create schema users, use <code>sys</code> as <code>Username</code> and change <code>Role</code> to <code>SYSDBA</code>.</p>
</div>
<div class="paragraph">
<p>Hint: If you happen to end up connected to <code>xe</code> instead of <code>xepdb1</code> in some case (e.g. in sqlplus), you may switch using this statement:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ALTER SESSION SET CONTAINER = XEPDB1;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The JDBC URL for your Oracle XE Database is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>jdbc:oracle:thin:@//localhost:1521/xepdb1</code></pre>
</div>
</div>
<div class="paragraph">
<p>To locally connect as sysdba without password use the following command (<code>connect / as sysdba</code> is not working anymore):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>sqlplus sys/Oracle18@localhost/XE as sysdba</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="driver-2"><a class="anchor" href="#driver-2"></a>25.20. Driver</h3>
<div class="paragraph">
<p>The oracle JDBC driver is <a href="https://blogs.oracle.com/developers/oracle-database-client-libraries-for-java-now-on-maven-central">available in maven central</a>.
Oracle JDBC drivers usually are backward and forward compatible so you should be able to use an older driver with a newer Oracle DB, etc.
Your dependency for the oracle driver should look as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>&lt;dependency&gt;
  &lt;groupId&gt;com.oracle.database.jdbc&lt;/groupId&gt;
  &lt;artifactId&gt;ojdbc10&lt;/artifactId&gt;
  &lt;version&gt;${oracle.driver.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the most recent Oracle DB 19 the property <code>oracle.driver.version</code> should be <code>19.8.0.0</code>. The number in the <code>artifactId</code> correlates to the minimum Java Version so for Java8 <code>artifactId</code> should be <code>ojdbc8</code> instead. It is fine to use <code>ojdbc10</code> with Java11 or higher.</p>
</div>
</div>
<div class="sect2">
<h3 id="pooling-3"><a class="anchor" href="#pooling-3"></a>25.21. Pooling</h3>
<div class="paragraph">
<p>In order to boost performance JDBC connections should be pooled and reused. If you are using Oracle RDBMS and do not plan to change that you can use the Oracle specific connection pool "Universal Connection Pool (UCP)" that is perfectly integrated with the Oracle driver. According to the documentation, UCP can even be used to <a href="https://docs.oracle.com/database/122/JJUCP/third-party-integration.htm#JJUCP8141">manage third party data sources</a>.
Like the JDBC driver also the UCP is available in maven central. The dependency should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>&lt;dependency&gt;
  &lt;groupId&gt;com.oracle.database.jdbc&lt;/groupId&gt;
  &lt;artifactId&gt;ucp&lt;/artifactId&gt;
  &lt;version&gt;${oracle.ucp.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>with property <code>oracle.ucp.version</code> analogue to <code>oracle.driver.version</code>.</p>
</div>
<div class="paragraph">
<p>Configuration is done via application.properties like this (example):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>#Oracle UCP
##Datasource for accessing the database
spring.datasource.url=jdbc:oracle:thin:@192.168.58.2:1521:xe
spring.jpa.database-platform=org.hibernate.dialect.Oracle12cDialect
spring.datasource.user=MyUser
spring.datasource.password=ThisIsMyPassword
spring.datasource.driver-class-name=oracle.jdbc.OracleDriver
spring.datasource.schema=MySchema

spring.datasource.type=oracle.ucp.jdbc.PoolDataSourceImpl
spring.datasource.factory=oracle.ucp.jdbc.PoolDataSourceFactory
spring.datasource.factory-method=getPoolDataSource
spring.datasource.connectionFactoryClassName=oracle.jdbc.pool.OracleDataSource
spring.datasource.validateConnectionOnBorrow=true
spring.datasource.connectionPoolName=MyPool
spring.datasource.jmx-enabled=true

##Optional: Set the log level to INTERNAL_ERROR, SEVERE, WARNING, INFO, CONFIG, FINE, TRACE_10, FINER, TRACE_20, TRACE_30, or FINEST
##logging.level.oracle.ucp=INTERNAL_ERROR
##Optional: activate tracing
##logging.level.oracle.ucp.jdbc.oracle.OracleUniversalPooledConnection=TRACE

#Optional: Configures pool size manually
#spring.datasource.minPoolSize=10
#spring.datasource.maxPoolSize=40
#spring.datasource.initialPoolSize=20</code></pre>
</div>
</div>
<div class="paragraph">
<p>Resources: <a href="http://www.oracle.com/technetwork/database/application-development/default-2248812.html">FAQ</a>, <a href="https://docs.oracle.com/database/122/JJUCP/toc.htm">developer&#8217;s guide</a>, <a href="https://docs.oracle.com/database/122/JJUAR/toc.htm">Java API Reference</a>. For an in-depth discussion on how to use JDBC and UCP, see the Oracle documentation <a href="http://www.oracle.com/technetwork/database/application-development/jdbc-ucp-conn-mgmt-strategies-3045654.pdf">Connection Management Strategies for Java Applications using JDBC and UCP</a>.</p>
</div>
<div class="paragraph">
<p>Note: there is a bug in UCP 12.1.0.2 that results in the creation of thousands of java.lang.Timer threads over hours or days of system uptime (see <a href="https://stackoverflow.com/questions/37245827/too-many-ucp-timer-threads">article on stackoverflow</a>). Also, Oracle has a strange bug fixing / patching policy: instead of producing a fixed version 12.1.0.3 or 12.1.0.2.x, Oracle publishes collections of *.class files that must be manually patched into the ucp.jar! Therefore, use the newest versions only.</p>
</div>
</div>
<div class="sect2">
<h3 id="messaging"><a class="anchor" href="#messaging"></a>25.22. Messaging</h3>
<div class="paragraph">
<p>In case you want to do messaging based on JMS you might consider the <a href="https://docs.oracle.com/cd/E11882_01/server.112/e11013/aq_intro.htm">Oracle JMS</a> also called Oracle Streams Advanced Queuing, or Oracle Advanced Queuing, or OAQ or AQ for short. OAQ is a JMS provider based on the Oracle RDBMS and included in the DB product for no extra fee. OAQ has some features that exceed the JMS standard like a retention time (i.e. a built-in backup mechanism that allows to make messages "unread" within a configurable period of time so that these messages do not have to be resent by the sending application). Also, OAQ messages are stored in relational tables so they can easily be observed by a test driver in a system test scenario.
Capgemini has used the <a href="https://projects.spring.io/spring-data-jdbc-ext/">Spring Data JDBC Extension</a> in order to process OAQ messages within <strong>the same technical transaction</strong> as the resulting Oracle RDBMS data changes <strong>without</strong> using 2PC and an XA-compliant transaction manager - which is not available out of the box in Tomcat. This is possible only due to the fact that OAQ queues and RDBMS tables actually reside in the same database. However, this is higher magic and should only be tried if high transaction rates must be achieved by avoiding 2PC.</p>
</div>
</div>
<div class="sect2">
<h3 id="general-notes-on-the-use-of-oracle-products"><a class="anchor" href="#general-notes-on-the-use-of-oracle-products"></a>25.23. General Notes on the use of Oracle products</h3>
<div class="paragraph">
<p>Oracle sells commercial products and receives licence fees for them. This includes access to a support organization. Therefore, at an early stage of your project, prepare for contacting <a href="https://support.oracle.com">oracle support</a> in case of technical problems. You will need the Oracle support ID <strong>of your customer</strong> [i.e. the legal entity who pays the licence fee and runs the RDBMS] and your customer must grant you permission to use it in a service request - it is not legal to use a your own support ID in a customer-related project. Your customer pays for that service anyway, so use it in case of a problem!</p>
</div>
<div class="paragraph">
<p>Software components like the JDBC driver or the UCP may be available without a registration or fee but they are protected by the Oracle Technology Network (OTN) License Agreement. The most important aspect of this licence agreement is the fact that an IT service provider is not allowed to simply download the Oracle software component, bundle it in a software artefact and deliver it to the customer. Instead, the Oracle software component must be (from a legal point of view) provided by the owner of the Oracle DB licence (i.e. your customer). This can be achieved in two ways: Advise your customer to install the Oracle software component in the application server as a library that can be used by your custom built system. Or, in cases where this is not feasible, e.g. in a OpenShift environment where the IT service provider delivers complete Docker images, you must advise your customer to (legally, i.e. documented in a written form) provide the Oracle software component to you, i.e. you don&#8217;t download the software component from the Oracle site but receive it from your customer.</p>
</div>
</div>
<div class="sect2">
<h3 id="fix-for-tns-listener-issues"><a class="anchor" href="#fix-for-tns-listener-issues"></a>25.24. Fix for TNS-Listener issues</h3>
<div class="paragraph">
<p>When switching networks (e.g. due to VPN) you might end up that your local Oracle XE stopps working with this error:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Listener refused the connection with the following error:
ORA-12505, TNS:listener does not currently know of SID given in connect descriptor</code></pre>
</div>
</div>
<div class="paragraph">
<p>While a reboot resolves this problem, it is a huge pain to reboot every time this error occurs as this wastes a lot of time.
Therefore we suggest the following fix:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Go to your oracle installation and open the folder <code>product/«version»/dbhomeXE/network/admin</code>.</p>
</li>
<li>
<p>Edit the file <code>listener.ora</code> and change the value of the property <code>HOST</code> from your qualified hostname to <code>localhost</code> (<code>HOST = localhost</code>).</p>
</li>
<li>
<p>Edit the file <code>tnsnames.ora</code> and change the value of the <code>HOST</code> properties (two occurences) from your qualified hostname to <code>localhost</code> (<code>HOST = localhost</code>).</p>
</li>
<li>
<p>Reboot your machine or (on windows) restart the service <code>OracleServiceXE</code> via <code>services.msc</code>.</p>
</li>
<li>
<p>Now this problem should be gone forever and you can continue your work.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On older XE versions until 11g you could run the following SQL (<code>sqlplus / as sysdba @reset_tns_listener.sql</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>WHENEVER SQLERROR EXIT;
ALTER SYSTEM SET local_listener = '(ADDRESS = (PROTOCOL = TCP)(HOST = 127.0.0.1)(PORT = 1521))';
ALTER SYSTEM REGISTER;
EXIT;</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="ms-sql-server"><a class="anchor" href="#ms-sql-server"></a>25.25. MS-SQL-Server</h3>
<div class="paragraph">
<p>This section gives guidance and hints for those who use <a href="https://www.microsoft.com/en-us/sql-server/">Microsoft SQL Server</a> as <a href="guide-database.adoc#rdbms">RDBMS</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-5"><a class="anchor" href="#java-5"></a>25.26. Java</h3>

</div>
<div class="sect2">
<h3 id="driver-3"><a class="anchor" href="#driver-3"></a>25.27. Driver</h3>
<div class="paragraph">
<p>Microsoft SQL Server is a commercial and professional product.
However, the JDBC driver is MIT licensed and available in Maven Central what makes it easy to integrate.
Your dependency for the driver should look as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.microsoft.sqlserver&lt;/groupId&gt;
    &lt;artifactId&gt;mssql-jdbc&lt;/artifactId&gt;
    &lt;version&gt;${mssqlserver.driver.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course the version (<code>${mssqlserver.driver.version}</code>) needs to be adopted to your needs (SQL Server installtion in production and JDK version, e.g. <code>7.4.1.jre8</code>).
For an overview of available driver versions see <a href="https://mvnrepository.com/artifact/com.microsoft.sqlserver/mssql-jdbc">here</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="postgresql"><a class="anchor" href="#postgresql"></a>25.28. PostgreSQL</h3>
<div class="paragraph">
<p>This section gives guidance and hints for those who use <a href="https://www.postgresql.org/">PostgreSQL</a> as <a href="guide-database.adoc#rdbms">RDBMS</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-6"><a class="anchor" href="#java-6"></a>25.29. Java</h3>

</div>
<div class="sect2">
<h3 id="driver-4"><a class="anchor" href="#driver-4"></a>25.30. Driver</h3>
<div class="paragraph">
<p>PostgreSQL is fully open-source. The driver is therefore available in maven central.
Your dependency for the driver should look as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;postgresql&lt;/groupId&gt;
    &lt;artifactId&gt;postgresql&lt;/artifactId&gt;
    &lt;version&gt;${postgresql.driver.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course the version (<code>${postgresql.driver.version}</code>) needs to be adopted to your needs (PostgreSQL installtion in production and JDBC level suitable for your JDK, e.g. <code>9.1-901-1.jdbc4</code>).
For an overview of available driver versions see <a href="https://mvnrepository.com/artifact/postgresql/postgresql">here</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="mariadb"><a class="anchor" href="#mariadb"></a>25.31. MariaDB</h3>
<div class="paragraph">
<p>This section gives guidance and hints for those who use <a href="https://mariadb.org/">MariaDB</a> as <a href="guide-database.adoc#rdbms">RDBMS</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-7"><a class="anchor" href="#java-7"></a>25.32. Java</h3>

</div>
<div class="sect2">
<h3 id="driver-5"><a class="anchor" href="#driver-5"></a>25.33. Driver</h3>
<div class="paragraph">
<p>MariaDB is fully open-source. The driver is therefore available in maven central.
Your dependency for the driver should look as following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.mariadb.jdbc&lt;/groupId&gt;
    &lt;artifactId&gt;mariadb-java-client&lt;/artifactId&gt;
    &lt;version&gt;${mariadb.driver.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course the version (<code>${mariadb.driver.version}</code>) needs to be adopted to your needs (MariaDB installtion in production and JDK version, e.g. <code>2.5.1</code>).
For an overview of available driver versions see <a href="https://mvnrepository.com/artifact/org.mariadb.jdbc/mariadb-java-client">here</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="database-4"><a class="anchor" href="#database-4"></a>25.34. Database</h3>
<div class="paragraph">
<p>For your business application with devonfw you need to choose the right database.
In devonfw we are not biased for a particular product so you have the freedom of choice.</p>
</div>
</div>
<div class="sect2">
<h3 id="rdbms-2"><a class="anchor" href="#rdbms-2"></a>25.35. RDBMS</h3>
<div class="paragraph">
<p>The classical and well-established form of a database is a relational database management system (RDBMS).
In devonfw we recommend to use an RDBMS unless you have specific need.
However, in case you have the need for big data, graph-data, BLOB focus, or schema-less dynamic data you can have a look at <a href="#nosql">NoSQL</a> options but be aware that these may be experimental and are not fully supported by devonfw.</p>
</div>
</div>
<div class="sect2">
<h3 id="options-2"><a class="anchor" href="#options-2"></a>25.36. Options</h3>
<div class="paragraph">
<p>In devonfw we are not biased for a particular RDBMS so you have the freedom of choice.
Here are the most common options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-hana.adoc">SAP Hana</a> (high performance in-memory, many advanced features)</p>
</li>
<li>
<p><a href="guide-oracle.adoc">Oracle</a> (most established, well featured for enterprise)</p>
</li>
<li>
<p><a href="guide-postgresql.adoc">PostgreSQL</a> (great open-source RDBMS)</p>
</li>
<li>
<p><a href="guide-mariadb.adoc">MariaDB</a> (true OSS successor of MySQL)</p>
</li>
<li>
<p><a href="guide-mysqlserver.adoc">MS SQL Server</a> (best choice for Microsoft and Windows dominated IT landscapes)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please click on any of the above choices and go to the according guide to find specific detials such as client/driver.</p>
</div>
</div>
<div class="sect2">
<h3 id="nosql-2"><a class="anchor" href="#nosql-2"></a>25.37. NoSQL</h3>
<div class="paragraph">
<p>While not (yet) officially supported and recommendet there are also interesting NoSQL (Not Only SQL) databases that could be an interesting alternative. Please be aware that you will typically not be able to use <a href="guide-jpa.adoc">JPA</a> (and hibernate). Further before choosing a NoSQL database you should check the following aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Is the database of choice reliable and mature enough for your project?</p>
</li>
<li>
<p>Can the operators of your product support the database of choice properly (provisioning, administration, backup, scaling &amp; clustering, monitoring, etc.)?</p>
</li>
<li>
<p>Does the database of choice meet the requirements of your project (ACID vs. eventual consistencey, CAP theorem)?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are good reasons to choose a particular NoSQL database in specific cases (e.g. extreme demand for big-data, throughput or scaling).
But as indicated by the questions above you need to be fully aware of what you are doing.
NoSQL databases can be <em>schemaless</em> (untyped, dynamic &amp; flexible) and/or <em>schemaful</em> (typed, structured &amp; strict).
Furhter, there are different types of NoSQL databases that are discussed in the following sub-sections:</p>
</div>
</div>
<div class="sect2">
<h3 id="java-8"><a class="anchor" href="#java-8"></a>25.38. Java</h3>

</div>
<div class="sect2">
<h3 id="column-db-2"><a class="anchor" href="#column-db-2"></a>25.39. ==  Column DB</h3>
<div class="paragraph">
<p>Column NoSQL databases are more related to a regular <a href="#rdbms">RDBMS</a> with their tables and columns.
However, they typically do not offer relational support with joins to the same level as you expect from an RDBMS.
Therefore, you have to carefully design your data-model upfront with the all the knowledge how you later want to query your data.</p>
</div>
<div class="paragraph">
<p>The most prominent options are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-cassandra.adoc">Cassandra</a> (high-performance, schema-based DB)</p>
</li>
<li>
<p><a href="guide-hbase.adoc">HBase</a> (distributed, big-data Hadoop database)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="key-value-db-2"><a class="anchor" href="#key-value-db-2"></a>25.40. ==  Key-Value DB</h3>
<div class="paragraph">
<p>As indicated by the name, a key-value database stores objects as key/value pairs similar to <code>Properties</code> or <code>Map</code> in Java.</p>
</div>
<div class="paragraph">
<p>The most prominent options are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-redis.adoc">Redis</a> (in-memory key/value store, especially used as cache or message broker)</p>
</li>
<li>
<p><a href="guide-aerospike.adoc">aerospike</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="document-db-2"><a class="anchor" href="#document-db-2"></a>25.41. ==  Document DB</h3>
<div class="paragraph">
<p>A document database is similar to a key-value database, but it stores objects in standard structured formats such as XML, JSON, or BSON.
Therefore not only flat key/value pairs but even trees of hierarchical data can be stored, retrieved and queried.</p>
</div>
<div class="paragraph">
<p>The most prominent options are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-mongodb.adoc">MongoDB</a></p>
</li>
<li>
<p><a href="guide-couchdb.adoc">CouchDB</a></p>
</li>
<li>
<p><a href="guide-ravendb.adoc">RavenDB</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="graph-db-2"><a class="anchor" href="#graph-db-2"></a>25.42. ==  Graph DB</h3>
<div class="paragraph">
<p>If the connections (links/relations) between your data is key and an <a href="#rdbms">RDBMS</a> is just not flexible or fast enough for your plans, then a graph database can help you.
They are very strong on storing and querying complex connections between entities.
For queries there are even specific standards and languages like <a href="https://tinkerpop.apache.org/gremlin.html">Gremlin</a>.</p>
</div>
<div class="paragraph">
<p>The most prominent options are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-neo4j.adoc">neo4j</a></p>
</li>
<li>
<p><a href="guide-blazegraph.adoc">blazegraph</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="hybrid-db-2"><a class="anchor" href="#hybrid-db-2"></a>25.43. ==  Hybrid DB</h3>
<div class="paragraph">
<p>In addition to the above types there are some NoSQL databases that are hybrid and combine the features and aspects of these types.
While as an architect and developer you might love the idea to get all in one, you have to be careful with your choice.
If you do not exactly know your problem, you are not ready to make the right choice for your database.
Further, you might still be best-off with an good old <a href="#rdbms">RDBMS</a> if you need to address multiple aspects together.
Anyhow, for experiments, PoCs, or small microservices with little risk it might be a great idea to choose a hybrid NoSQL database.
If you have collected very positive, profound and productive experience with such product you can grow on it.</p>
</div>
<div class="paragraph">
<p>The most prominent options are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="guide-orientdb.adoc">OrientDB</a> (object-oriented, hyper-flexible, column- and graph-based)</p>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="cassandra"><a class="anchor" href="#cassandra"></a>25.44. Cassandra</h3>
<div class="paragraph">
<p>This section is the place to share experience for those who use <a href="https://cassandra.apache.org/">Cassandra</a> as <a href="guide-database.adoc#nosql">NoSQL database</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-9"><a class="anchor" href="#java-9"></a>25.45. Java</h3>

</div>
<div class="sect2">
<h3 id="attention"><a class="anchor" href="#attention"></a>25.46. Attention</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
devonfw did not focus on the integration of this database so far. No reports have been given from our users about successfully integrating this database with any devonfw tech stack. If you want to share your knowledge or report usage, please contribute by clicking on the pen next to the section headline.If you need help on devonfw tech stack knowledge to get the integration working for you, stay in contact at <a href="https://github.com/devonfw/devonfw-guide/issues">GitHub.</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="driver-6"><a class="anchor" href="#driver-6"></a>25.47. Driver</h3>
<div class="paragraph">
<p>Please be aware that there is not a regular JDBC driver in case you are using Java (devon4j).
For driver options see <a href="https://cassandra.apache.org/doc/latest/getting_started/drivers.html">here</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="spring-data"><a class="anchor" href="#spring-data"></a>25.48. Spring-Data</h3>
<div class="paragraph">
<p>There is spring-data support available for cassandra via <a href="https://spring.io/projects/spring-data-cassandra">spring-data-cassandra</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Please note that some time ago we had feedback from projects that had issues with spring-data-cassandra and switched back to using the driver natively. We assume the issues are meanwhile resolved. TODO: collect more feedback and update this guide.
</td>
</tr>
</table>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="neo4j"><a class="anchor" href="#neo4j"></a>25.49. neo4j</h3>
<div class="paragraph">
<p>This section is the place to share experience for those who use <a href="https://neo4j.com/">neo4j</a> as <a href="guide-database.adoc#nosql">NoSQL database</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-10"><a class="anchor" href="#java-10"></a>25.50. Java</h3>

</div>
<div class="sect2">
<h3 id="attention-2"><a class="anchor" href="#attention-2"></a>25.51. Attention</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
devonfw did not focus on the integration of this database so far. No reports have been given from our users about successfully integrating this database with any devonfw tech stack. If you want to share your knowledge or report usage, please contribute by clicking on the pen next to the section headline.If you need help on devonfw tech stack knowledge to get the integration working for you, stay in contact at <a href="https://github.com/devonfw/devonfw-guide/issues">GitHub.</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="driver-7"><a class="anchor" href="#driver-7"></a>25.52. Driver</h3>
<div class="paragraph">
<p>Please be aware that there is not a regular JDBC driver in case you are using Java (devon4j).
For driver options see <a href="https://neo4j.com/developer/java/">here</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="spring-data-2"><a class="anchor" href="#spring-data-2"></a>25.53. Spring-Data</h3>
<div class="paragraph">
<p>There is spring-data integration available via <a href="https://neo4j.com/developer/spring-data-neo4j/">spring-data-neo4j</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="mongodb"><a class="anchor" href="#mongodb"></a>25.54. MongoDB</h3>
<div class="paragraph">
<p>This section is the place to share experience for those who use <a href="https://www.mongodb.com/">MongoDB</a> as <a href="guide-database.adoc#nosql">NoSQL database</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-11"><a class="anchor" href="#java-11"></a>25.55. Java</h3>

</div>
<div class="sect2">
<h3 id="attention-3"><a class="anchor" href="#attention-3"></a>25.56. Attention</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
devonfw did not focus on the integration of this database so far. No reports have been given from our users about successfully integrating this database with any devonfw tech stack. If you want to share your knowledge or report usage, please contribute by clicking on the pen next to the section headline.If you need help on devonfw tech stack knowledge to get the integration working for you, stay in contact at <a href="https://github.com/devonfw/devonfw-guide/issues">GitHub.</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="driver-8"><a class="anchor" href="#driver-8"></a>25.57. Driver</h3>
<div class="paragraph">
<p>Please be aware that there is not a regular JDBC driver in case you are using Java (devon4j).
For driver options see <a href="https://docs.mongodb.com/ecosystem/drivers/java/">here</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="couchdb"><a class="anchor" href="#couchdb"></a>25.58. CouchDB</h3>
<div class="paragraph">
<p>This section is the place to share experience for those who use <a href="https://couchdb.apache.org/">CouchDB</a> as <a href="guide-database.adoc#nosql">NoSQL database</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-12"><a class="anchor" href="#java-12"></a>25.59. Java</h3>

</div>
<div class="sect2">
<h3 id="attention-4"><a class="anchor" href="#attention-4"></a>25.60. Attention</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
devonfw did not focus on the integration of this database so far. No reports have been given from our users about successfully integrating this database with any devonfw tech stack. If you want to share your knowledge or report usage, please contribute by clicking on the pen next to the section headline.If you need help on devonfw tech stack knowledge to get the integration working for you, stay in contact at <a href="https://github.com/devonfw/devonfw-guide/issues">GitHub.</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="driver-9"><a class="anchor" href="#driver-9"></a>25.61. Driver</h3>
<div class="paragraph">
<p>Please be aware that there is not a regular JDBC driver in case you are using Java (devon4j).
For driver options see <a href="https://cwiki.apache.org/confluence/display/COUCHDB/Java">here</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="redis"><a class="anchor" href="#redis"></a>25.62. Redis</h3>
<div class="paragraph">
<p>This section is the place to share experience for those who use <a href="https://redis.io/">Redis</a> as <a href="guide-database.adoc#nosql">NoSQL database</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-13"><a class="anchor" href="#java-13"></a>25.63. Java</h3>

</div>
<div class="sect2">
<h3 id="attention-5"><a class="anchor" href="#attention-5"></a>25.64. Attention</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
devonfw did not focus on the integration of this database so far. No reports have been given from our users about successfully integrating this database with any devonfw tech stack. If you want to share your knowledge or report usage, please contribute by clicking on the pen next to the section headline.If you need help on devonfw tech stack knowledge to get the integration working for you, stay in contact at <a href="https://github.com/devonfw/devonfw-guide/issues">GitHub.</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="driver-10"><a class="anchor" href="#driver-10"></a>25.65. Driver</h3>
<div class="paragraph">
<p>Please be aware that there is not a regular JDBC driver in case you are using Java (devon4j).
For driver options see <a href="https://redis.io/clients#java">here</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="orientdb"><a class="anchor" href="#orientdb"></a>25.66. OrientDB</h3>
<div class="paragraph">
<p>This section is the place to share experience for those who use <a href="https://orientdb.com/">OrientDB</a> (see also <a href="https://orientdb.org/">Open-Source community edition</a>) as <a href="guide-database.adoc#nosql">NoSQL database</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-14"><a class="anchor" href="#java-14"></a>25.67. Java</h3>

</div>
<div class="sect2">
<h3 id="attention-6"><a class="anchor" href="#attention-6"></a>25.68. Attention</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
devonfw did not focus on the integration of this database so far. No reports have been given from our users about successfully integrating this database with any devonfw tech stack. If you want to share your knowledge or report usage, please contribute by clicking on the pen next to the section headline.If you need help on devonfw tech stack knowledge to get the integration working for you, stay in contact at <a href="https://github.com/devonfw/devonfw-guide/issues">GitHub.</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="driver-11"><a class="anchor" href="#driver-11"></a>25.69. Driver</h3>
<div class="paragraph">
<p>For driver options see <a href="https://orientdb.com/docs/2.1.x/Programming-Language-Bindings.html">here</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="administration"><a class="anchor" href="#administration"></a>25.70. Administration</h3>
<div class="paragraph">
<p>OrientDB comes with a powerful, impressive admin interface for your web-browser called <a href="https://orientdb.com/docs/2.0/orientdb-studio.wiki/Home-page.html">Studio</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="blazegraph"><a class="anchor" href="#blazegraph"></a>25.71. Blazegraph</h3>
<div class="paragraph">
<p>This section is the place to share experience for those who use <a href="https://blazegraph.com/">Blazegraph</a> as <a href="guide-database.adoc#nosql">NoSQL database</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-15"><a class="anchor" href="#java-15"></a>25.72. Java</h3>

</div>
<div class="sect2">
<h3 id="attention-7"><a class="anchor" href="#attention-7"></a>25.73. Attention</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
devonfw did not focus on the integration of this database so far. No reports have been given from our users about successfully integrating this database with any devonfw tech stack. If you want to share your knowledge or report usage, please contribute by clicking on the pen next to the section headline.If you need help on devonfw tech stack knowledge to get the integration working for you, stay in contact at <a href="https://github.com/devonfw/devonfw-guide/issues">GitHub.</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="driver-12"><a class="anchor" href="#driver-12"></a>25.74. Driver</h3>
<div class="paragraph">
<p>Please be aware that there is not a regular JDBC driver in case you are using Java (devon4j).
For driver options see <a href="https://wiki.blazegraph.com/wiki/index.php/Client_Libraries">here</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="hbase"><a class="anchor" href="#hbase"></a>25.75. HBase</h3>
<div class="paragraph">
<p>This section is the place to share experience for those who use <a href="https://hbase.apache.org/">HBase</a> as <a href="guide-database.adoc#nosql">NoSQL database</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-16"><a class="anchor" href="#java-16"></a>25.76. Java</h3>

</div>
<div class="sect2">
<h3 id="attention-8"><a class="anchor" href="#attention-8"></a>25.77. Attention</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
devonfw did not focus on the integration of this database so far. No reports have been given from our users about successfully integrating this database with any devonfw tech stack. If you want to share your knowledge or report usage, please contribute by clicking on the pen next to the section headline.If you need help on devonfw tech stack knowledge to get the integration working for you, stay in contact at <a href="https://github.com/devonfw/devonfw-guide/issues">GitHub.</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="driver-13"><a class="anchor" href="#driver-13"></a>25.78. Driver</h3>
<div class="paragraph">
<p>Please be aware that there is not a regular JDBC driver in case you are using Java (devon4j).
For driver options see <a href="https://hbase.apache.org/book.html#client_dependencies">here</a> and
<a href="http://www.corejavaguru.com/bigdata/hbase-tutorial/hbase-java-api-class">hbase-java-api tutorial</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="ravendb"><a class="anchor" href="#ravendb"></a>25.79. RavenDB</h3>
<div class="paragraph">
<p>This section is the place to share experience for those who use <a href="https://ravendb.net/">RavenDB</a> as <a href="guide-database.adoc#nosql">NoSQL database</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-17"><a class="anchor" href="#java-17"></a>25.80. Java</h3>

</div>
<div class="sect2">
<h3 id="attention-9"><a class="anchor" href="#attention-9"></a>25.81. Attention</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
devonfw did not focus on the integration of this database so far. No reports have been given from our users about successfully integrating this database with any devonfw tech stack. If you want to share your knowledge or report usage, please contribute by clicking on the pen next to the section headline.If you need help on devonfw tech stack knowledge to get the integration working for you, stay in contact at <a href="https://github.com/devonfw/devonfw-guide/issues">GitHub.</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="driver-14"><a class="anchor" href="#driver-14"></a>25.82. Driver</h3>
<div class="paragraph">
<p>Please be aware that there is not a regular JDBC driver in case you are using Java (devon4j).
For driver options see <a href="https://github.com/ravendb/ravendb-jvm-client">ravendb-jvm-client</a> and <a href="https://ravendb.net/features/clients/java">Java Client Features</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="gigaspaces-xap-smart-cache"><a class="anchor" href="#gigaspaces-xap-smart-cache"></a>25.83. GigaSpaces XAP (Smart Cache)</h3>
<div class="paragraph">
<p>This section is the place to share experience for those who use <a href="https://www.gigaspaces.com/products/xap/">GigaSpaces XAP</a> as <a href="guide-database.adoc#nosql">NoSQL database</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="java-18"><a class="anchor" href="#java-18"></a>25.84. Java</h3>

</div>
<div class="sect2">
<h3 id="attention-10"><a class="anchor" href="#attention-10"></a>25.85. Attention</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A sample for GigaSpaces integration has been contributed from a graduate work, which will be described here. No reports have been given from our users about successfully integrating this database with any devonfw tech stack. If you want to share your knowledge or report usage, please contribute by clicking on the pen next to the section headline.If you need help on devonfw tech stack knowledge to get the integration working for you, stay in contact at <a href="https://github.com/devonfw/devonfw-guide/issues">GitHub.</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="possible-approach"><a class="anchor" href="#possible-approach"></a>25.86. Possible Approach</h3>
<div class="paragraph">
<p>GigaSpaces is currently not in the central maven repository, therefore an additional repository needs to be added along with the dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>&lt;repositories&gt;
    &lt;repository&gt;
	&lt;id&gt;org.openspaces&lt;/id&gt;
	&lt;url&gt;http://maven-repository.openspaces.org&lt;/url&gt;
    &lt;/repository&gt;
&lt;/repositories&gt;

&lt;dependency&gt;
    &lt;groupId&gt;org.gigaspaces&lt;/groupId&gt;
    &lt;artifactId&gt;xap-openspaces&lt;/artifactId&gt;
    &lt;version&gt;${gsVersion}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course the version (<code>${gsVersion}</code>) needs to be adopted to your needs.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Configuration
public class ContextConfiguration {
  @Bean
  public GigaSpace space() {
    UrlSpaceConfigurer urlSpaceConfigurer = new UrlSpaceConfigurer("jini://*/*/my-space");
    return new GigaSpaceConfigurer(urlSpaceConfigurer).gigaSpace();
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To establish a connection with a running instance of GigaSpaces, a Configuration Class is required. Here a Bean will be created that retrieves via URL the name of a Space e.g. my-space (a Space is equivalent to a Database Schema). Of course a Space needs to be firstly created in order to use it (see also the <a href="#example">Example</a>). This bean can be used for all database typical operations e.g. create, read, update and delete data (a complete list can be found <a href="https://resources.gigaspaces.com/api/15.8.0/java/org/openspaces/core/GigaSpace.html">here</a>). Another possibility to execute those operations is via spring-data (see section below). The spring-data-gigaspaces automatically detects if a GigaSpaces Bean exists.</p>
</div>
</div>
<div class="sect2">
<h3 id="spring-data-3"><a class="anchor" href="#spring-data-3"></a>25.87. Spring-Data</h3>
<div class="paragraph">
<p>There is spring-data support available for GigaSpaces XAP (Smart Cache) via <a href="https://docs.gigaspaces.com/solution-hub/spring-data-quick-start.html">spring-data-gigaspaces</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="example-5"><a class="anchor" href="#example-5"></a>25.88. Example</h3>
<div class="paragraph">
<p>There is an implementation of the sample application, My Thai Star, using GigaSpaces XAP (Smart Cache) as data storage. More details can be found on <a href="https://github.com/devonfw-forge/mts-gigaspaces">mts-gigaspaces</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="tools-2"><a class="anchor" href="#tools-2"></a>26. Tools</h2>
<div class="sectionbody">
<div class="paragraph">
<p>==CobiGen&#8201;&#8212;&#8201;Code-based incremental Generator
:title-logo-image: images/logo/cobigen_logo.png</p>
</div>
<div class="sect2">
<h3 id="document-description"><a class="anchor" href="#document-description"></a>26.1. Document Description</h3>
<div class="paragraph">
<p>This document contains the documentation of the CobiGen core module as well as all CobiGen plug-ins and the CobiGen eclipse integration.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>DISCLAIMER: All CobiGen plugins are compatible with the latest release of Devonfw unless otherwise denoted.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Current versions:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>CobiGen - Eclipse Plug-in v7.1.0</p>
</li>
<li>
<p>CobiGen - Maven Build Plug-in v7.1.0</p>
</li>
<li>
<p>CobiGen CLI v1.2.0</p>
</li>
</ul>
</div>
<hr>
<div class="ulist">
<ul>
<li>
<p>CobiGen v7.1.0</p>
</li>
<li>
<p>CobiGen - Java Plug-in v7.1.0</p>
</li>
<li>
<p>CobiGen - XML Plug-in v7.0.0</p>
</li>
<li>
<p>CobiGen - TypeScript Plug-in v7.1.0</p>
</li>
<li>
<p>CobiGen - Property Plug-in v7.1.0</p>
</li>
<li>
<p>CobiGen - Text Merger v7.1.1</p>
</li>
<li>
<p>CobiGen - JSON Plug-in v7.0.0</p>
</li>
<li>
<p>CobiGen - HTML Plug-in v7.0.0</p>
</li>
<li>
<p>CobiGen - Open API Plug-in v7.1.0</p>
</li>
<li>
<p>CobiGen - FreeMarker Template Engine v7.0.0</p>
</li>
<li>
<p>CobiGen - Velocity Template Engine v7.0.0</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Authors:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>* Malte Brunnlieb
* Jaime Diaz Gonzalez
* Steffen Holzer
* Ruben Diaz Martinez
* Joerg Hohwiller
* Fabian Kreis
* Lukas Goerlach
* Krati Shah
* Christian Richter
* Erik Grüner
* Mike Schumacher
* Marco Rose
* Mohamed Ghanmi</code></pre>
</div>
</div>
<div class="paragraph">
<p>==Guide to the Reader</p>
</div>
<div class="paragraph">
<p>Dependent on the intention you are reading this document, you might be most interested in the following chapters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If this is <strong>your first contact with CobiGen</strong>, you will be interested in the <a href="home.adoc">general purpose</a> of CobiGen, in the <a href="mgmt_license-agreement.adoc">licensing of CobiGen</a>, as well as in the <a href="mgmt_shared-service.adoc">Shared Service</a> provided for CobiGen. Additionally, there are some <a href="cobigen-usecases.adoc">general use cases</a>, which are currently implemented and maintained to be used out of the box.</p>
</li>
<li>
<p>As a <strong>user of the CobiGen Eclipse integration</strong>, you should focus on the <a href="cobigen-eclipse_installation">Installation</a> and <a href="cobigen-eclipse_usage">Usage</a> chapters to get a good introduction about how to use CobiGen in eclipse.</p>
</li>
<li>
<p>As a <strong>user of the Maven integration</strong>, you should focus on the <a href="cobigen-maven_configuration">Maven configuration</a> chapter, which guides you through the integration of CobiGen into your build configuration.</p>
</li>
<li>
<p>If you like to <strong>adapt the configuration of CobiGen</strong>, you have to step deeper into the <a href="cobigen-core_configuration.adoc">configuration guide</a> as well as into the plug-in configuration extensions for the <a href="cobigen-javaplugin.adoc">Java Plug-in</a>, <a href="cobigen-xmlplugin.adoc">XML-Plugin</a>, <a href="cobigen-propertyplugin.adoc">Java Property Plug-in</a>, as well as for the <a href="cobigen-textmerger.adoc">Text-Merger Plug-in</a>.</p>
</li>
<li>
<p>Finally, if you want to <strong>develop your own templates</strong>, you will be thankful for <a href="cobigen-templates_helpful-links.adoc">helpful links</a> in addition to the plug-ins documentation as referenced in the previous point.</p>
</li>
</ul>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==CobiGen - Code-based incremental Generator</p>
</div>
<div class="sect4">
<h5 id="overview-7"><a class="anchor" href="#overview-7"></a>Overview</h5>
<div class="paragraph">
<p>CobiGen is a <strong>generic incremental generator</strong> for end to end code generation tasks, mostly used in Java projects.
Due to a template-based approach, CobiGen <strong>generates any set of text-based documents and document fragments</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Input (currently):</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java classes</p>
</li>
<li>
<p>XML-based files</p>
</li>
<li>
<p>OpenAPI documents</p>
</li>
<li>
<p>Possibly more inputs like WSDL, which is currently not implemented.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Output:</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>any text-based document or document fragments specified by templates</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="architecture-3"><a class="anchor" href="#architecture-3"></a>Architecture</h5>
<div class="paragraph">
<p>CobiGen is build as an extensible framework for incremental code generation. It provides extension points for new input readers which allow reading new input types and converting them to an internally processed model. The model is used to process templates of different kinds to generate patches. The template processing will be done by different template engines. There is an extension point for template engines to support multiple ones as well. Finally, the patch will be structurally merged into potentially already existing code. To allow structural merge on different programming languages, the extension point for structural mergers has been introduced. Here you will see an overview of the currently available extension points and plug-ins:</p>
</div>
</div>
<div class="sect4">
<h5 id="features-and-characteristics"><a class="anchor" href="#features-and-characteristics"></a>Features and Characteristics</h5>
<div class="ulist">
<ul>
<li>
<p>Generate fresh files across all the layers of a application - ready to run.</p>
</li>
<li>
<p>Add on to existing files merging code into it. E.g. generate new methods into existing java classes or adding nodes to an XML file. Merging of contents into existing files will be done using structural merge mechanisms.</p>
</li>
<li>
<p>Structural merge mechanisms are currently implemented for Java, XML, Java Property Syntax, JSON, Basic <code>HTML</code>, Text Append, TypeScript.</p>
</li>
<li>
<p>Conflicts can be resolved individually but automatically by former configuration for each template.</p>
</li>
<li>
<p>CobiGen provides an <a href="cobigen-eclipse_usage.adoc">Eclipse integration</a> as well as a <a href="cobigen-maven_configuration.adoc">Maven Integration</a>.</p>
</li>
<li>
<p>CobiGen comes with an extensive documentation for <a href="cobigen-eclipse_installation.adoc">users</a> and <a href="cobigen-core_configuration.adoc">developers</a>.</p>
</li>
<li>
<p>Templates can be fully tailored to project needs - this is considered as a simple task.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="selection-of-current-and-past-cobigen-applications"><a class="anchor" href="#selection-of-current-and-past-cobigen-applications"></a>Selection of current and past CobiGen applications</h5>
<div class="paragraph">
<p>General applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Generation of a <strong>Java CRUD application based on <a href="https://github.com/devonfw/">devonfw</a> architecture</strong> including all software-layers on the server plus code for JS-clients (Angular). You can find details <a href="cobigen-usecases.adoc">here</a>.</p>
</li>
<li>
<p>Generation of a <strong>Java <code>CRUD</code> application according to the Register Factory architecture</strong>. Persistence entities are the input for generation.</p>
</li>
<li>
<p>Generation of <strong>builder classes for generating test data</strong> for JUnit-Tests. Input are the persistence entities.</p>
</li>
<li>
<p>Generation of a <strong><code>EXT JS</code> 6</strong> client with full <code>CRUD</code> operations connected a devon4j server.</p>
</li>
<li>
<p>Generation of a <strong><code>Angular</code> 6</strong> client with full <code>CRUD</code> operations connected a devon4j server.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Project-specific applications in the past:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Generation of an <strong>additional Java type hierarchy on top of existing Java classes</strong> in combination with additional methods to be integrated in the modified classes. Hibernate entities were considered as input as well as output of the generation. The rational in this case, was to generate an additional business object hierarchy on top of an existing data model for efficient business processing.</p>
</li>
<li>
<p>Generation of <strong>hash- and equals-methods</strong> as well as copy constructors depending on the field types of the input Java class. Furthermore, CobiGen is able to re-generate these methods/constructors triggered by the user, i.e, when fields have been changed.</p>
</li>
<li>
<p><strong>Extraction of JavaDoc</strong> of test classes and their methods for generating a csv test documentation. This test documentation has been further processed manually in Excel to provide a good overview about the currently available tests in the software system, which enables further human analysis.</p>
</li>
</ul>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==General use cases</p>
</div>
<div class="paragraph">
<p>In addition to the <a href="Home#selection-of-current-and-past-cobigen-applications">selection of CobiGen applications</a> introduced before, this chapter provides a more detailed overview about the currently implemented and maintained general use cases. These can be used by any project following a supported reference architecture as e.g. the <a href="https://github.com/devonfw">devonfw</a> or <a href="http://www.bva.bund.de/SharedDocs/Downloads/DE/BIT/RegisterFactory/Whitepaper_Register_Factory.html">Register Factory</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="devon4j"><a class="anchor" href="#devon4j"></a>devon4j</h5>
<div class="paragraph">
<p>With our templates for <a href="https://github.com/devonfw/devon4j">devon4j</a>, you can generate a whole CRUD application from a single Entity class. You save the effort for creating, DAOs, Transfer Objects, simple CRUD use cases with REST services and even the client application can be generated.</p>
</div>
<div class="sect5">
<h6 id="crud-server-application-for-devon4j"><a class="anchor" href="#crud-server-application-for-devon4j"></a>CRUD server application for devon4j</h6>
<div class="paragraph">
<p>For the server, the required files for all architectural layers (Data access, logic, and service layer) can be created based on your Entity class. After the generation, you have CRUD functionality for the entity from bottom to top which can be accessed via a RESTful web service. Details are provided in the <a href="https://github.com/devonfw/devon/wiki/tutorial-devon-generator">devonfw wiki</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="crud-client-application-for-devon4ng"><a class="anchor" href="#crud-client-application-for-devon4ng"></a>CRUD client application for devon4ng</h6>
<div class="paragraph">
<p>Based on the REST services on the server, you can also generate an <a href="https://angularjs.org/">Angular</a> client based on <a href="https://github.com/devonfw/devon4ng">devon4ng</a>. With the help of <a href="https://nodejs.org/">Node.js</a>, you have a working client application for displaying your entities within minutes!</p>
</div>
</div>
<div class="sect5">
<h6 id="test-data-builder-for-devon4j"><a class="anchor" href="#test-data-builder-for-devon4j"></a>Test data Builder for devon4j</h6>
<div class="paragraph">
<p>Generating a builder pattern for POJOs to easily create test data in your tests. CobiGen is not only able to generate a plain builder pattern but rather builder, which follow a specific concept to minimize test data generation efforts in your unit tests. The following <code>Person</code> class as an example:</p>
</div>
<div class="listingblock">
<div class="title">Listing 114. Person class</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class Person {

    private String firstname;
    private String lastname;
    private int birthyear;
    @NotNull
    private Address address;

    @NotNull
    public String getFirstname() {
        return this.firstname;
    }

    // additional default setter and getter
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is a simple POJO with a validation annotation, to indicate, that <code>firstname</code> should never be <code>null</code>. Creating this object in a test would imply to call every setter, which is kind of nasty. Therefore, the Builder Pattern has been introduced for quite a long time in software engineering, allowing to easily create POJOs with a fluent API. See below.</p>
</div>
<div class="listingblock">
<div class="title">Listing 115. Builder pattern example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Person person = new PersonBuilder()
                .firstname("Heinz")
                .lastname("Erhardt")
                .birthyear(1909)
                .address(
                    new AddressBuilder().postcode("22222")
                        .city("Hamburg").street("Luebecker Str. 123")
                        .createNew())
                .addChild(
                    new PersonBuilder()[...].createNew()).createNew();</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Builder API generated by CobiGen allows you to set any setter accessible field of a POJO in a fluent way. But in addition lets assume a test, which should check the birth year as precondition for any business operation. So specifying all other fields of <code>Person</code>, especially <code>firstname</code> as it is mandatory to enter business code, would not make sense. The test behavior should just depend on the specification of the birth year and on no other data. So we would like to just provide this data to the test.</p>
</div>
<div class="paragraph">
<p>The Builder classes generated by CobiGen try to tackle this inconvenience by providing the ability to declare default values for any mandatory field due to validation or database constraints.</p>
</div>
<div class="listingblock">
<div class="title">Listing 116. Builder Outline</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class PersonBuilder {

    private void fillMandatoryFields() {
        firstname("lasdjfaöskdlfja");
        address(new AddressBuilder().createNew());
    };
    private void fillMandatoryFields_custom() {...};

    public PersonBuilder firstname(String value);
    public PersonBuilder lastname(String value);
    ...

    public Person createNew();
    public Person persist(EntityManager em);
    public List&lt;Person&gt; persistAndDuplicate(EntityManager em, int count);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Looking at the plotted builder API generated by CobiGen, you will find two <code>private</code> methods. The method <code>fillMandatoryFields</code> will be generated by CobiGen and regenerated every time CobiGen generation will be triggered for the <code>Person</code> class. This method will set every automatically detected field with not <code>null</code> constraints to a default value. However, by implementing <code>fillMandatoryFields_custom</code> on your own, you can reset these values or even specify more default values for any other field of the object. Thus, running <code>new PersonBuilder().birthyear(1909).createNew();</code> will create a valid object of <code>Person</code>, which is already pre-filled such that it does not influence the test execution besides the fact that it circumvents database and validation issues.</p>
</div>
<div class="paragraph">
<p>This even holds for complex data structures as indicated by <code>address(new AddressBuilder().createNew());</code>. Due to the use of the <code>AddressBuilder</code> for setting the default value for the field <code>address</code>, also the default values for <code>Address</code> will be set automatically.</p>
</div>
<div class="paragraph">
<p>Finally, the builder API provides different methods to create new objects.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>createNew()</code> just creates a new object from the builder specification and returns it.</p>
</li>
<li>
<p><code>persist(EntityManager)</code> will create a new object from the builder specification and persists it to the database.</p>
</li>
<li>
<p><code>persistAndDuplicate(EntityManager, int)</code> will create the given amount of objects form the builder specification and persists all of these. After the initial generation of each builder, you might want to adapt the method body as you will most probably not be able to persist more than one object with the same field assignments to the database due to <code>unique</code> constraints. Thus, please see the generated comment in the method to adapt <code>unique</code> fields accordingly before persisting to the database.</p>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="custom-builder-for-business-needs"><a class="anchor" href="#custom-builder-for-business-needs"></a>Custom Builder for Business Needs</h7>
<div class="paragraph">
<p>CobiGen just generates basic builder for any POJO. However, for project needs you probably would like to have even more complex builders, which enable the easy generation of more complex test data which are encoded in a large object hierarchy. Therefore, the generated builders can just be seen as a tool to achieve this. You can define your own business driven builders in the same way as the generated builders, but explicitly focusing on your business needs. Just take this example as a demonstration of that idea:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  University uni = new ComplexUniversityBuilder()
    .withStudents(200)
    .withProfessors(4)
    .withExternalStudent()
    .createNew();</code></pre>
</div>
</div>
<div class="paragraph">
<p>E.g. the method <code>withExternalStudent()</code> might create a person, which is a student and is flagged to be an external student. Basing this implementation on the generated builders will even assure that you would benefit from any default values you have set before. In addition, you can even imagine any more complex builder methods setting values driven your reusable testing needs based on the specific business knowledge.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="register-factory"><a class="anchor" href="#register-factory"></a>Register Factory</h5>
<div class="sect5">
<h6 id="crud-server-application"><a class="anchor" href="#crud-server-application"></a>CRUD server application</h6>
<div class="paragraph">
<p>Generates a CRUD application with persistence entities as inputs. This includes DAOs, TOs, use cases, as well as a CRUD JSF user interface if needed.</p>
</div>
</div>
<div class="sect5">
<h6 id="test-data-builder"><a class="anchor" href="#test-data-builder"></a>Test data Builder</h6>
<div class="paragraph">
<p>Analogous to <a href="#testdata-builder-for-devon4j">Test data Builder for devon4J</a></p>
</div>
</div>
<div class="sect5">
<h6 id="test-documentation"><a class="anchor" href="#test-documentation"></a>Test documentation</h6>
<div class="paragraph">
<p>Generate test documentation from test classes. The input are the doclet tags of several test classes, which e.g. can specify a description, a cross-reference, or a test target description. The result currently is a csv file, which lists all tests with the corresponding meta-information. Afterwards, this file might be styled and passed to the customer if needed and it will be up-to-date every time!</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cobigen-3"><a class="anchor" href="#cobigen-3"></a>26.2. CobiGen</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Configuration</p>
</div>
<div class="paragraph">
<p>CobiGen is maintaining a home directory further referenced in this documentation as <code>$cghome</code>, which is used to maintain temporary or transient data. The home folder is determined with the following location fall-back:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>System environment variable <code>COBIGEN_HOME</code> (e.g. <code>C:\project\ide\conf\cobigen-home</code>)</p>
</li>
<li>
<p><code>.cobigen</code> directory in OS user home (e.g. <code>~/.cobigen</code>)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The actual configuration of CobiGen is maintained by a single folder or jar. The location can be configured with respect to the implemented configuration fall-back mechanism. CobiGen will search for the location of the configuration in the following order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A configuration jar or directory, which is passed to CobiGen by the Maven or Eclipse integration or any other program using the CobiGen programming interface:
1.1. the Maven integration allows to configure a jar dependency to be included in the currently running classpath <em>(of interest for <a href="cobigen-maven_configuration#plugin-injection-since-v3.adoc">maven configuration</a></em>
1.2. the Eclipse integration allows to specify a <code>CobiGen_Templates</code> project in the eclipse workspace</p>
</li>
<li>
<p>The file <code>$cghome/.cobigen</code> exists and the property <code>templates</code> is set to a valid configuration (e.g. <code>templates=C:\project\ide\conf\templates</code> or <code>templates=C:\project\ide\conf\templates.jar</code>) <em>Hint: Check for log entry like <code>Value of property templates in $cghome/.cobigen is invalid</code> to identify an invalid configuration which is not taken up as expected</em></p>
</li>
<li>
<p>The folder <code>$cghome/templates/CobiGen_Templates</code> exists</p>
</li>
<li>
<p>The lexicographical sorted first configuration jar of the following path pattern <code>$cghome/templates/templates-([^-]+)-(\\d+\\.?)+.jar</code> if exists (e.g. <code>templates-devon4j-2020.04.001</code>)</p>
</li>
<li>
<p>CobiGen will automatically download the latest jar configuration from maven central with <code>groupId</code> <code>com.devonfw.cobigen</code> and <code>artifactId</code> <code>templates-devon4j</code> and take it like described in 4.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Within the configuration jar or directory you will find the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>CobiGen_Templates
 |- templateFolder1
    |- templates.xml
 |- templateFolder2
    |- templates.xml
 |- context.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Find some examples <a href="https://github.com/devonfw/cobigen/tree/master/cobigen-templates">here</a>.</p>
</div>
<div class="sect4">
<h5 id="context-configuration"><a class="anchor" href="#context-configuration"></a>Context Configuration</h5>
<div class="paragraph">
<p>The context configuration (<code>context.xml</code>) always has the following root structure:</p>
</div>
<div class="listingblock">
<div class="title">Listing 117. Context Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;contextConfiguration xmlns="http://capgemini.com"
                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                      version="1.0"&gt;
    &lt;triggers&gt;
        ...
    &lt;/triggers&gt;
&lt;/contextConfiguration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The context configuration has a <code>version</code> attribute, which should match the XSD version the context configuration is an instance of. It should not state the version of the currently released version of CobiGen. This attribute should be maintained by the context configuration developers. If configured correctly, it will provide a better feedback for the user and thus higher user experience. Currently there is only the version v1.0. For further version there will be a changelog later on.</p>
</div>
<div class="sect5">
<h6 id="trigger-node"><a class="anchor" href="#trigger-node"></a>Trigger Node</h6>
<div class="paragraph">
<p>As children of the <code>&lt;triggers&gt;</code> node you can define different triggers. By defining a <code>&lt;trigger&gt;</code> you declare a mapping between special inputs and a <code>templateFolder</code>, which contains all templates, which are worth to be generated with the given input.</p>
</div>
<div class="listingblock">
<div class="title">Listing 118. trigger configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="..." templateFolder="..." inputCharset="UTF-8" &gt;
    ...
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The attribute <code>id</code> should be unique within an context configuration. It is necessary for efficient internal processing.</p>
</li>
<li>
<p>The attribute <code>type</code> declares a specific <em>trigger interpreter</em>, which might be provided by additional plug-ins. A <em>trigger interpreter</em> has to provide an <em>input reader</em>, which reads specific inputs and creates a template object model out of it to be processed by the FreeMarker template engine later on. Have a look at the plug-in&#8217;s documentation of your interest and see, which trigger types and thus inputs are currently supported.</p>
</li>
<li>
<p>The attribute <code>templateFolder</code> declares the relative path to the template folder, which will be used if the trigger gets activated.</p>
</li>
<li>
<p>The attribute <code>inputCharset</code> <em>(optional)</em> determines the charset to be used for reading any input file.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="matcher-node"><a class="anchor" href="#matcher-node"></a>Matcher Node</h6>
<div class="paragraph">
<p>A trigger will be activated if its matchers hold the following formula:</p>
</div>
<div class="paragraph">
<p><code>!(NOT || &#8230;&#8203; || NOT) &amp;&amp; AND &amp;&amp; &#8230;&#8203; &amp;&amp; AND &amp;&amp; (OR || &#8230;&#8203; || OR)</code></p>
</div>
<div class="paragraph">
<p>Whereas NOT/AND/OR describes the <code>accumulationType</code> of a <em>matcher</em> (see below) and e.g. <code>NOT</code> means 'a <em>matcher</em> with <code>accumulationType</code> NOT matches a given input'. Thus additionally to an <em>input reader</em>, a <em>trigger interpreter</em> has to define at least one set of <em>matchers</em>, which are satisfiable, to be fully functional. A <code>&lt;matcher&gt;</code> node declares a specific characteristics a valid input should have.</p>
</div>
<div class="listingblock">
<div class="title">Listing 119. Matcher Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;matcher type="..." value="..." accumulationType="..."&gt;
    ...
&lt;/matcher&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The attribute <code>type</code> declares a specific type of <em>matcher</em>, which has to be provided by the surrounding <em>trigger interpreter</em>. Have a look at the plug-in&#8217;s documentation, which also provides the used trigger type for more information about valid matcher and their functionalities.</p>
</li>
<li>
<p>The attribute <code>value</code> might contain any information necessary for processing the <em>matcher&#8217;s</em> functionality. Have a look at the relevant plug-in&#8217;s documentation for more detail.</p>
</li>
<li>
<p>The attribute <code>accumulationType</code> <em>(optional)</em> specifies how the matcher will influence the trigger activation. Valid values are:</p>
<div class="ulist">
<ul>
<li>
<p>OR (default): if any matcher of accumulation type OR <em>matches</em>, the trigger will be activated as long as there are no further matchers with different accumulation types</p>
</li>
<li>
<p>AND: if any matcher with AND accumulation type does <em>not match</em>, the trigger will <em>not</em> be activated</p>
</li>
<li>
<p>NOT: if any matcher with NOT accumulation type <em>matches</em>, the trigger will <em>not</em> be activated</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="variable-assignment-node"><a class="anchor" href="#variable-assignment-node"></a>Variable Assignment Node</h6>
<div class="paragraph">
<p>Finally, a <code>&lt;matcher&gt;</code> node can have multiple <code>&lt;variableAssignment&gt;</code> nodes as children. <em>Variable assignments</em> allow to parametrize the generation by additional values, which will be added to the object model for template processing. The variables declared using <em>variable assignments</em>, will be made accessible in the templates.xml as well in the object model for template processing via the namespace <code>variables.*</code>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 120. Complete Configuration Pattern</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;contextConfiguration xmlns="http://capgemini.com"
                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                      version="1.0"&gt;
    &lt;triggers&gt;
        &lt;trigger id="..." type="..." templateFolder="..."&gt;
            &lt;matcher type="..." value="..."&gt;
                &lt;variableAssignment type="..." key="..." value="..." /&gt;
            &lt;/matcher&gt;
        &lt;/trigger&gt;
    &lt;/triggers&gt;
&lt;/contextConfiguration&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The attribute <code>type</code> declares the type of <em>variable assignment</em> to be processed by the <em>trigger interpreter</em> providing plug-in. This attribute enables <em>variable assignments</em> with different dynamic value resolutions.</p>
</li>
<li>
<p>The attribute <code>key</code> declares the namespace under which the resolved value will be accessible later on.</p>
</li>
<li>
<p>The attribute <code>value</code> might declare a constant value to be assigned or any hint for value resolution done by the <em>trigger interpreter</em> providing plug-in. For instance, if <code>type</code> is <code>regex</code>, then on <code>value</code> you will assign the matched group number by the regex (1, 2, 3&#8230;&#8203;)</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="container-matcher-node"><a class="anchor" href="#container-matcher-node"></a>Container Matcher Node</h6>
<div class="paragraph">
<p>The <code>&lt;containerMatcher&gt;</code> node is an additional matcher for matching containers of multiple input objects.
Such a container might be a package, which encloses multiple types or---more generic---a model, which encloses multiple elements. A container matcher can be declared side by side with other matchers:</p>
</div>
<div class="listingblock">
<div class="title">Listing 121. <code>ContainerMatcher</code> Declaration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;contextConfiguration xmlns="http://capgemini.com"
                      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                      version="1.0"&gt;
    &lt;triggers&gt;
        &lt;trigger id="..." type="..." templateFolder="..." &gt;
            &lt;containerMatcher type="..." value="..." retrieveObjectsRecursively="..." /&gt;
            &lt;matcher type="..." value="..."&gt;
                &lt;variableAssignment type="..." variable="..." value="..." /&gt;
            &lt;/matcher&gt;
        &lt;/trigger&gt;
    &lt;/triggers&gt;
&lt;/contextConfiguration&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The attribute <code>type</code> declares a specific type of <em>matcher</em>, which has to be provided by the surrounding <em>trigger interpreter</em>. Have a look at the plug-in&#8217;s documentation, which also provides the used trigger type for more information about valid matcher and their functionalities.</p>
</li>
<li>
<p>The attribute <code>value</code> might contain any information necessary for processing the <em>matcher&#8217;s</em> functionality. Have a look at the relevant plug-in&#8217;s documentation for more detail.</p>
</li>
<li>
<p>The attribute <code>retrieveObjectsRecursively</code> <em>(optional boolean)</em> states, whether the children of the input should be retrieved recursively to find matching inputs for generation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The semantics of a container matchers are the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>&lt;containerMatcher&gt;</code> does not declare any <code>&lt;variableAssignment&gt;</code> nodes</p>
</li>
<li>
<p>A <code>&lt;containerMatcher&gt;</code> matches an input if and only if one of its enclosed elements satisfies a set of <code>&lt;matcher&gt;</code> nodes of the same <code>&lt;trigger&gt;</code></p>
</li>
<li>
<p>Inputs, which match a <code>&lt;containerMatcher&gt;</code> will cause a generation for each enclosed element</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="templates-configuration"><a class="anchor" href="#templates-configuration"></a>Templates Configuration</h5>
<div class="paragraph">
<p>The template configuration (<code>templates.xml</code>) specifies, which templates exist and under which circumstances it will be generated. There are two possible configuration styles:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure the template meta-data for each template file by <a href="#template-node">template nodes</a></p>
</li>
<li>
<p><code><em>(since cobigen-core-v1.2.0)</em></code>: Configure <code><a href="#templatescan-node">templateScan nodes</a></code> to automatically retrieve a default configuration for all files within a configured folder and possibly modify the automatically configured templates using <a href="#templateextension-node"><code>templateExtension</code> nodes</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To get an intuition of the idea, the following will initially describe the first (more extensive) configuration style. Such an configuration root structure looks as follows:</p>
</div>
<div class="listingblock">
<div class="title">Listing 122. Extensive Templates Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;templatesConfiguration xmlns="http://capgemini.com"
                        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                        version="1.0" templateEngine="FreeMarker"&gt;
    &lt;templates&gt;
            ...
    &lt;/templates&gt;
    &lt;increments&gt;
            ...
    &lt;/increments&gt;
&lt;/templatesConfiguration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The root node <code>&lt;templatesConfiguration&gt;</code> specifies two attributes. The attribute <code>version</code> provides further usability support and will be handled analogous to the <code>version</code> attribute of the <a href="#context-configuration">context configuration</a>. The optional attribute <code>templateEngine</code> specifies the template engine to be used for processing the templates (<em>since `cobigen-core-4.0.0`</em>). By default it is set to FreeMarker.</p>
</div>
<div class="paragraph">
<p>The node <code>&lt;templatesConfiguration&gt;</code> allows two different grouping nodes as children. First, there is the <code>&lt;templates&gt;</code> node, which groups all declarations of templates. Second, there is the <code>&lt;increments&gt;</code> node, which groups all declarations about increments.</p>
</div>
<div class="sect5">
<h6 id="template-node"><a class="anchor" href="#template-node"></a>Template Node</h6>
<div class="paragraph">
<p>The <code>&lt;templates&gt;</code> node groups multiple <code>&lt;template&gt;</code> declarations, which enables further generation. Each template file should be registered at least once as a template to be considered.</p>
</div>
<div class="listingblock">
<div class="title">Listing 123. Example Template Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;templates&gt;
    &lt;template name="..." destinationPath="..." templateFile="..." mergeStrategy="..." targetCharset="..." /&gt;
    ...
&lt;/templates&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>A template declaration consist of multiple information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The attribute <code>name</code> specifies an unique ID within the templates configuration, which will later be reused in the <a href="#increment-node">increment definitions</a>.</p>
</li>
<li>
<p>The attribute <code>destinationPath</code> specifies the destination path the template will be generated to. It is possible to use all variables defined by <a href="#variableassignment-node">variable assignments</a> within the path declaration using the FreeMarker syntax <code>${variables.*}</code>. While resolving the variable expressions, each dot within the value will be automatically replaced by a slash. This behavior is accounted for by the transformations of Java packages to paths as CobiGen has first been developed in the context of the Java world. Furthermore, the destination path variable resolution provides the following additional built-in operators analogue to the FreeMarker syntax:</p>
<div class="ulist">
<ul>
<li>
<p><code>?cap_first</code> analogue to <a href="http://freemarker.org/docs/ref_builtins_string.html#ref_builtin_cap_first">FreeMarker</a></p>
</li>
<li>
<p><code>?uncap_first</code> analogue to <a href="http://freemarker.org/docs/ref_builtins_string.html#ref_builtin_uncap_first">FreeMarker</a></p>
</li>
<li>
<p><code>?lower_case</code> analogue to <a href="http://freemarker.org/docs/ref_builtins_string.html#ref_builtin_lower_case">FreeMarker</a></p>
</li>
<li>
<p><code>?upper_case</code> analogue to <a href="http://freemarker.org/docs/ref_builtins_string.html#ref_builtin_upper_case">FreeMarker</a></p>
</li>
<li>
<p><code>?replace(regex, replacement)</code> - Replaces all occurrences of the regular expression <code>regex</code> in the variable&#8217;s value with the given <code>replacement</code> string. (since <code>cobigen-core v1.1.0</code>)</p>
</li>
<li>
<p><code>?removeSuffix(suffix)</code> - Removes the given <code>suffix</code> in the variable&#8217;s value iff the variable&#8217;s value ends with the given <code>suffix</code>. Otherwise nothing will happen. (since <code>cobigen-core v1.1.0</code>)</p>
</li>
<li>
<p><code>?removePrefix(prefix)</code> - Analogue to <code>?removeSuffix</code> but removes the prefix of the variable&#8217;s value. (since <code>cobigen-core v1.1.0</code>)</p>
</li>
</ul>
</div>
</li>
<li>
<p>The attribute <code>templateFile</code> describes the relative path dependent on the template folder specified in the <a href="#trigger-node">trigger</a> to the template file to be generated.</p>
</li>
<li>
<p>The attribute <code>mergeStrategy</code> <em>(optional)</em> can be <em>optionally</em> specified and declares the type of merge mechanism to be used, when the <code>destinationPath</code> points to an already existing file. CobiGen by itself just comes with a <code>mergeStrategy</code> <code>override</code>, which enforces file regeneration in total. Additional available merge strategies have to be obtained from the different plug-in&#8217;s documentations (see here for <a href="cobigen-javaplugin#merger-extensions.adoc">java</a>, <a href="cobigen-xmlplugin#merger-extensions.adoc">XML</a>, <a href="cobigen-propertyplugin#merger-extensions.adoc">properties</a>, and <a href="cobigen-textmerger#merger-extensions.adoc">text</a>). Default: <em>not set</em> (means not mergeable)</p>
</li>
<li>
<p>The attribute <code>targetCharset</code> <em>(optional)</em> can be <em>optionally</em> specified and declares the encoding with which the contents will be written into the destination file. This also includes reading an existing file at the destination path for merging its contents with the newly generated ones. Default: <em>UTF-8</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>(Since version 4.1.0)</em> It is possible to reference external <code>template</code> (templates defined on another trigger), thanks to using <code>&lt;incrementRef &#8230;&#8203;&gt;</code> that are explained <a href="#increment-node">here</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="template-scan-node"><a class="anchor" href="#template-scan-node"></a>Template Scan Node</h6>
<div class="paragraph">
<p><em>(since <code>cobigen-core-v1.2.0</code>)</em></p>
</div>
<div class="paragraph">
<p>The second configuration style for template meta-data is driven by initially scanning all available templates and automatically configure them with a default set of meta-data. A scanning configuration might look like this:</p>
</div>
<div class="listingblock">
<div class="title">Listing 124. Example of Template-scan configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;templatesConfiguration xmlns="http://capgemini.com"
                        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                        version="1.2"&gt;
    &lt;templateScans&gt;
        &lt;templateScan templatePath="templates" templateNamePrefix="prefix_" destinationPath="src/main/java"/&gt;
    &lt;/templateScans&gt;
&lt;/templatesConfiguration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can specify multiple <code>&lt;templateScan &#8230;&#8203;&gt;</code> nodes for different <code>templatePaths</code> and different <code>templateNamePrefixes</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>name</code> can be specified to later on reference the templates found by a template-scan within an <a href="#increment-node">increment</a>. <em>(since <code>cobigen-core-v2.1.</code>)</em></p>
</li>
<li>
<p>The <code>templatePath</code> specifies the relative path from the <code>templates.xml</code> to the root folder from which the template scan should be performed.</p>
</li>
<li>
<p>The <code>templateNamePrefix</code> <em>(optional)</em> defines a common id prefix, which will be added to all found and automatically configured templates.</p>
</li>
<li>
<p>The <code>destinationPath</code> defines the root folder all found templates should be generated to, whereas the root folder will be a prefix for all found and automatically configured templates.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <code>templateScan</code> will result in the following <strong>default configuration of templates</strong>. For each file found, new <a href="#template-node">template</a> will be created virtually with the following default values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>id</code>: file name without <code>.ftl</code> extension prefixed by <code>templateNamePrefix</code> from <code>template-scan</code></p>
</li>
<li>
<p><code>destinationPath</code>: relative file path of the file found with the prefix defined by <code>destinationPath</code> from <code>template-scan</code>. Furthermore,</p>
<div class="ulist">
<ul>
<li>
<p>it is possible to use the syntax for accessing and modifying variables as described for the attribute <code>destinationPath</code> of the <a href="#template-node">template node</a>, besides the only difference, that due to file system restrictions you have to replace all <code>?</code>-signs (for built-ins) with <code>#</code>-signs.</p>
</li>
<li>
<p>the files to be scanned, should provide their final file extension by the following file naming convention: <code>&lt;filename&gt;.&lt;extension&gt;.ftl</code> Thus the file extension <code>.ftl</code> will be removed after generation.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>templateFile</code>: relative path to the file found</p>
</li>
<li>
<p><code>mergeStrategy</code>: <em>(optional)</em> not set means not mergeable</p>
</li>
<li>
<p><code>targetCharset</code>:  <em>(optional)</em> defaults to UTF-8</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>(Since version 4.1.0)</em> It is possible to reference external <code>templateScan</code> (<code>templateScans</code> defined on another trigger), thanks to using <code>&lt;incrementRef &#8230;&#8203;&gt;</code> that are explained <a href="#increment-node">here</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="template-extension-node"><a class="anchor" href="#template-extension-node"></a>Template Extension Node</h6>
<div class="paragraph">
<p><em>(since <code>cobigen-core-v1.2.0</code>)</em></p>
</div>
<div class="paragraph">
<p>Additionally to the <code><a href="#templatescan-node">templateScan declaration</a></code> it is easily possible to rewrite specific attributes for any scanned and automatically configured template.</p>
</div>
<div class="listingblock">
<div class="title">Listing 125. Example Configuration of a <code>TemplateExtension</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;templates&gt;
    &lt;templateExtension ref="prefix_FooClass.java" mergeStrategy="javamerge" /&gt;
&lt;/templates&gt;

&lt;templateScans&gt;
    &lt;templateScan templatePath="foo" templateNamePrefix="prefix_" destinationPath="src/main/java/foo"/&gt;
&lt;/templateScans&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Lets assume, that the above example declares a <code>template-scan</code> for the folder <code>foo</code>, which contains a file <code>FooClass.java.ftl</code> in any folder depth. Thus the template scan will automatically create a virtual <a href="#template-node">template</a> declaration with <code>id=prefix_FooClass.java</code> and further <code><a href="#templatescan-node">default configuration</a></code>.</p>
</div>
<div class="paragraph">
<p>Using the <code>templateExtension</code> declaration above will reference the scanned template by the attribute <code>ref</code> and overrides the <code>mergeStrategy</code> of the automatically configured template by the value <code>javamerge</code>. Thus we are able to minimize the needed templates configuration.</p>
</div>
<div class="paragraph">
<p><em>(Since version 4.1.0)</em> It is possible to reference external <code>templateExtension</code> (<code>templateExtensions</code> defined on another trigger), thanks to using <code>&lt;incrementRef &#8230;&#8203;&gt;</code> that are explained <a href="#increment-node">here</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="increment-node"><a class="anchor" href="#increment-node"></a>Increment Node</h6>
<div class="paragraph">
<p>The <code>&lt;increments&gt;</code> node groups multiple <code>&lt;increment&gt;</code> nodes, which can be seen as a collection of templates to be generated. An increment will be defined by a unique <code>id</code> and a human readable <code>description</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;increments&gt;
    &lt;increment id="..." description="..."&gt;
        &lt;incrementRef ref="..." /&gt;
        &lt;templateRef ref="..." /&gt;
        &lt;templateScanRef ref="..." /&gt;
    &lt;/increment&gt;
&lt;/increments&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>An increment might contain multiple increments and/or templates, which will be referenced using <code>&lt;incrementRef &#8230;&#8203;&gt;</code>, <code>&lt;templateRef &#8230;&#8203;&gt;</code>, resp. <code>&lt;templateScanRef &#8230;&#8203;&gt;</code> nodes. These nodes only declare the attribute <code>ref</code>, which will reference an increment, a template, or a template-scan by its <code>id</code> or <code>name</code>.</p>
</div>
<div class="paragraph">
<p><em>(Since version 4.1.0)</em>  An special case of <code>&lt;incrementRef &#8230;&#8203;&gt;</code> is the external <code>incrementsRef</code>. By default, <code>&lt;incrementRef &#8230;&#8203;&gt;</code> are used to reference increments defined in the same <code>templates.xml</code> file. So for example, we could have:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;increments&gt;
    &lt;increment id="incA" description="..."&gt;
        &lt;incrementRef ref="incB" /&gt;
    &lt;/increment&gt;
    &lt;increment id="incB" description="..."&gt;
        &lt;templateRef .... /&gt;
        &lt;templateScan .... /&gt;
    &lt;/increment&gt;
&lt;/increments&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>However, if we want to reference an increment that it is not defined inside our <code>templates.xml</code> (an increment defined for another trigger), then we can use external <code>incrementRef</code> as shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;increment name="..." description="..."&gt;
    &lt;incrementRef ref="trigger_id::increment_id"/&gt;
&lt;/increment&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The ref string is split using as delimiter <code>::</code>. The first part of the string, is the <code>trigger_id</code> to reference. That trigger contains an <code>increment_id</code>. Currently, this functionality only works when both templates use the same kind of input file.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="java-template-logic"><a class="anchor" href="#java-template-logic"></a>Java Template Logic</h5>
<div class="paragraph">
<p><em>since <code>cobigen-core-3.0.0</code> which is included in the Eclipse and Maven Plugin since version 2.0.0</em>
In addition, it is possible to implement more complex template logic by custom Java code. To enable this feature, you can simply import the the <code>CobiGen_Templates</code> by clicking on <em>Adapt Templates</em>, turn it into a simple maven project (if it is not already) and implement any Java logic in the common maven layout (e.g. in the source folder <code>src/main/java</code>). Each Java class will be instantiated by CobiGen for each generation process. Thus, you can even store any state within a Java class instance during generation. However, there is currently no guarantee according to the template processing order.</p>
</div>
<div class="paragraph">
<p>As a consequence, you have to implement your Java classes with a public default (non-parameter) constructor to be used by any template. Methods of the implemented Java classes can be called within templates by the simple standard FreeMarker expression for calling Bean methods: <code>SimpleType.methodName(param1)</code>. Until now, CobiGen will shadow multiple types with the same simple name non-deterministically. So please prevent yourself from that situation.</p>
</div>
<div class="paragraph">
<p>Finally, if you would like to do some reflection within your Java code accessing any type of the template project or any type referenced by the input, you should load classes by making use of the classloader of the util classes. CobiGen will take care of the correct classloader building including the classpath of the input source as well as of the classpath of the template project. If you use any other classloader or build it by your own, there will be no guarantee, that generation succeeds.</p>
</div>
</div>
<div class="sect4">
<h5 id="template-properties"><a class="anchor" href="#template-properties"></a>Template Properties</h5>
<div class="paragraph">
<p><em>since <code>cobigen-core-4.0.0`</em>
Using a configuration with `<a href="#templatescan-node">template scan</a></code>, you can make use of properties in templates specified in property files named <code>cobigen.properties</code> next to the templates. The property files are specified as <a href="https://en.wikipedia.org/wiki/.properties">Java property files</a>. Property files can be nested in sub-folders. Properties will be resolved including property shading. Properties defined nearest to the template to be generated will take precedence.
In addition, a <code>cobigen.properties</code> file can be specified in the target folder root (in eclipse plugin, this is equal to the source project root). These properties take precedence over template properties specified in the template folder.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is not allowed to override context variables in <code>cobigen.properties</code> specifications as we have not found any interesting use case. This is most probably an error of the template designer, CobiGen will raise an error in this case.
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="multi-module-support-or-template-target-path-redirects"><a class="anchor" href="#multi-module-support-or-template-target-path-redirects"></a>Multi module support or template target path redirects</h6>
<div class="paragraph">
<p><em>since <code>cobigen-core-4.0.0`</em>
One special property you can specify in the template properties is the property `relocate</code>. It will cause the current folder and its sub-folders to be relocated at destination path resolution time. Take the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>folder
  - sub1
    Template.java.ftl
    cobigen.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let the <code>cobigen.properties</code> file contain the line <code>relocate=../sub2/${cwd}</code>. Given that, the relative destination path of <code>Template.java.ftl</code> will be resolved to <code>folder/sub2/Template.java</code>. Compare <code><a href="#templatescan-node">template scan</a></code> configuration for more information about basic path resolution. The <code>relocate</code> property specifies a relative path from the location of the <code>cobigen.properties</code>. The <code>${cwd}</code> placeholder will contain the remaining relative path from the <code>cobigen.properties</code> location to the template file. In this basic example it just contains <code>Template.java.ftl</code>, but it may even be any relative path including sub-folders of sub1 and its templates.
Given the <code>relocate</code> feature, you can even step out of the root path, which in general is the project/maven module the input is located in. This enables template designers to even address, e.g., maven modules located next to the module the input is coming from.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="basic-template-model"><a class="anchor" href="#basic-template-model"></a>Basic Template Model</h5>
<div class="paragraph">
<p>In addition to what is served by the different model builders of the different plug-ins, CobiGen provides a minimal model based on context variables as well as CobiGen properties. The following model is independent of the input format and will be served as a template model all the time:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>variables</p>
<div class="ulist">
<ul>
<li>
<p>all triggered <code><a href="#variableassignment-node.adoc" class="page unresolved">context variables</a></code> mapped to its assigned/mapped value</p>
</li>
<li>
<p>all <a href="#template-properties.adoc" class="page unresolved">template properties</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>all simple names of <a href="#java-template-logic.adoc" class="page unresolved">Java template logic</a> implementation classes</p>
</li>
<li>
<p>all full qualified names of <a href="#java-template-logic.adoc" class="page unresolved">Java template logic</a> implementation classes</p>
</li>
<li>
<p>further input related model, e.g. <a href="cobigen-javaplugin#template-object-model.adoc">model from Java inputs</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="plugin-mechanism"><a class="anchor" href="#plugin-mechanism"></a>Plugin Mechanism</h5>
<div class="paragraph">
<p>Since <code>cobigen-core 4.1.0</code>, we changed the plug-in discovery mechanism. So far it was necessary to register new plugins programmatically, which introduces the need to let every tool integration, i.e. for eclipse or maven, be dependent on every plug-in, which should be released. This made release cycles take long time as all plug-ins have to be integrated into a final release of maven or eclipse integration.</p>
</div>
<div class="paragraph">
<p>Now, plug-ins are automatically discovered by the Java <a href="https://docs.oracle.com/javase/tutorial/ext/basics/spi.html">Service Loader</a> mechanism from the classpath. This also effects the setup of <a href="cobigen-eclipse_installation#upgrading-to-v3.adoc">eclipse</a> and <a href="cobigen-maven_configuration#additions-since-v3.adoc">maven</a> integration to allow modular releases of CobiGen in future. We are now able to provide faster rollouts of bug-fixes in any of the plug-ins as they can be released completely independently.</p>
</div>
</div>
<div class="sect3">
<h4 id="plug-ins"><a class="anchor" href="#plug-ins"></a>26.2.7. Plug-ins</h4>
<!-- toc disabled -->
<div class="paragraph">
<p>==Java Plug-in
The CobiGen Java Plug-in comes with a new input reader for java artifacts, new java related trigger and matchers, as well as a merging mechanism for Java sources.</p>
</div>
<div class="sect5">
<h6 id="trigger-extension"><a class="anchor" href="#trigger-extension"></a>Trigger extension</h6>
<div class="paragraph">
<p>The Java Plug-in provides a new trigger for Java related inputs. It accepts different representations as inputs (see <a href="#java-input-reader">Java input reader</a>) and provides additional matching and variable assignment mechanisms. The configuration in the <code>context.xml</code> for this trigger looks like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'java'</p>
<div class="listingblock">
<div class="title">Listing 126. Example of a java trigger definition</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    ...
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger type enables Java elements as inputs.</p>
</div>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="matcher-types"><a class="anchor" href="#matcher-types"></a>Matcher types</h7>
<div class="paragraph">
<p>With the trigger you might define matchers, which restrict the input upon specific aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type <code>fqn</code> &#8594; full qualified name matching</p>
<div class="listingblock">
<div class="title">Listing 127. Example of a java trigger definition with a full qualified name matcher</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    &lt;matcher type="fqn" value="(.+)\.persistence\.([^\.]+)\.entity\.([^\.]+)"&gt;
        ...
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger will be enabled if the full qualified name (<code>fqn</code>) of the declaring input class matches the given regular expression (<code>value</code>).</p>
</div>
</li>
<li>
<p>type 'package' &#8594; package name of the input</p>
<div class="listingblock">
<div class="title">Listing 128. Example of a java trigger definition with a package name matcher</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    &lt;matcher type="package" value="(.+)\.persistence\.([^\.]+)\.entity"&gt;
        ...
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger will be enabled if the package name (<code>package</code>) of the declaring input class matches the given regular expression (<code>value</code>).</p>
</div>
</li>
<li>
<p>type 'expression'</p>
<div class="listingblock">
<div class="title">Listing 129. Example of a java trigger definition with a package name matcher</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    &lt;matcher type="expression" value="instanceof java.lang.String"&gt;
        ...
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger will be enabled if the expression evaluates to true. Valid expressions are</p>
</div>
</li>
<li>
<p><code>instanceof fqn</code>: checks an 'is a' relation of the input type</p>
</li>
<li>
<p><code>isAbstract</code>: checks, whether the input type is declared abstract</p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="container-matcher-types"><a class="anchor" href="#container-matcher-types"></a>Container Matcher types</h7>
<div class="paragraph">
<p>Additionally, the java plugin provides the ability to match packages (containers) as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'package'</p>
<div class="listingblock">
<div class="title">Listing 130. Example of a java trigger definition with a container matcher for packages</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    &lt;containerMatcher type="package" value="com\.example\.app\.component1\.persistence.entity" /&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The container matcher matches packages provided by the type <code>com.capgemini.cobigen.javaplugin.inputreader.to.PackageFolder</code> with a regular expression stated in the <code>value</code> attribute. (See <a href="cobigen-core_configuration#containermatcher-node.adoc"><code>containerMatcher</code> semantics</a> to get more information about <code>containerMatchers</code> itself.)</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="variable-assignment-types"><a class="anchor" href="#variable-assignment-types"></a>Variable Assignment types</h7>
<div class="paragraph">
<p>Furthermore, it provides the ability to extract information from each input for further processing in the templates. The values assigned by variable assignments will be made available in template and the <code>destinationPath</code> of <code>context.xml</code> through the namespace <code>variables.&lt;key&gt;</code>. The Java Plug-in currently provides two different mechanisms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'regex' &#8594; regular expression group</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    &lt;matcher type="fqn" value="(.+)\.persistence\.([^\.]+)\.entity\.([^\.]+)"&gt;
        &lt;variableAssignment type="regex" key="rootPackage" value="1" /&gt;
        &lt;variableAssignment type="regex" key="component" value="2" /&gt;
        &lt;variableAssignment type="regex" key="pojoName" value="3" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This variable assignment assigns the value of the given regular expression group number to the given <code>key</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'constant' &#8594; constant parameter</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="java" templateFolder="..."&gt;
    &lt;matcher type="fqn" value="(.+)\.persistence\.([^\.]+)\.entity\.([^\.]+)"&gt;
        &lt;variableAssignment type="constant" key="domain" value="restaurant" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This variable assignment assigns the <code>value</code> to the <code>key</code> as a constant.</p>
</div>
</div>
<div class="sect6">
<h7 id="java-input-reader"><a class="anchor" href="#java-input-reader"></a>Java input reader</h7>
<div class="paragraph">
<p>The CobiGen Java Plug-in implements an input reader for parsed java sources as well as for java <code>Class&lt;?&gt;</code> objects (loaded by reflection). So API user can pass <code>Class&lt;?&gt;</code> objects as well as <code>JavaClass</code> objects for generation. The latter depends on <a href="https://github.com/paul-hammant/qdox">QDox</a>, which will be used for parsing and merging java sources. For getting the right parsed java inputs you can easily use the <code>JavaParserUtil</code>, which provides static functionality to parse java files and get the appropriate <code>JavaClass</code> object.</p>
</div>
<div class="paragraph">
<p>Furthermore, due to restrictions on both inputs according to model building (see below), it is also possible to provide an array of length two as an input, which contains the <code>Class&lt;?&gt;</code> as well as the <code>JavaClass</code> object of the same class.</p>
</div>
<div class="sect7">
<h8 id="template-object-model"><a class="anchor" href="#template-object-model"></a>Template object model</h8>
<div class="paragraph">
<p>No matter whether you use reflection objects or parsed java classes as input, you will get the following object model for template creation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>classObject</code></strong> ('Class' :: Class object of the Java input)</p>
</li>
<li>
<p><strong>POJO</strong></p>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> ('String' :: Simple name of the input class)</p>
</li>
<li>
<p><strong>package</strong> ('String' :: Package name of the input class)</p>
</li>
<li>
<p><strong><code>canonicalName</code></strong> ('String' :: Full qualified name of the input class)</p>
</li>
<li>
<p><strong>annotations</strong> ('Map&lt;String, Object&gt;' :: Annotations, which will be represented by a mapping of the full qualified type of an annotation to its value. To gain template compatibility, the key will be stored with '_' instead of '.' in the full qualified annotation type. Furthermore, the annotation might be recursively defined and thus be accessed using the same type of mapping. Example <code>${pojo.annotations.javax_persistence_Id}</code>)</p>
</li>
<li>
<p><strong>JavaDoc</strong> ('Map&lt;String, Object&gt;') :: A generic way of addressing all available JavaDoc doclets and comments. The only fixed variable is <code>comment</code> (see below). All other provided variables depend on the doclets found while parsing. The value of a doclet can be accessed by the doclets name (e.g. <code>${&#8230;&#8203;JavaDoc.author}</code>). In case of doclet tags that can be declared multiple times (currently <code>@param</code> and <code>@throws</code>), you will get a map, which you access in a specific way (see below).</p>
<div class="ulist">
<ul>
<li>
<p><strong>comment</strong> ('String' :: JavaDoc comment, which does not include any doclets)</p>
</li>
<li>
<p><strong>params</strong> ('Map&lt;String,String&gt; :: JavaDoc parameter info. If the comment follows proper conventions, the key will be the name of the parameter and the value being its description. You can also access the parameters by their number, as in <code>arg0</code>, <code>arg1</code> etc, following the order of declaration in the signature, not in order of JavaDoc)</p>
</li>
<li>
<p><strong>throws</strong> ('Map&lt;String,String&gt; :: JavaDoc exception info. If the comment follows proper conventions, the key will be the name of the thrown exception and the value being its description)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>extendedType</code></strong> ('Map&lt;String, Object&gt;' :: The supertype, represented by a set of mappings <em>(since <code>cobigen-javaplugin v1.1.0</code>)</em></p>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> ('String' :: Simple name of the supertype)</p>
</li>
<li>
<p><strong><code>canonicalName</code></strong> ('String' :: Full qualified name of the supertype)</p>
</li>
<li>
<p><strong>package</strong> ('String' :: Package name of the supertype)</p>
</li>
</ul>
</div>
</li>
<li>
<p><code><strong>implementedTypes</strong></code> ('List&lt;Map&lt;String, Object&gt;&gt;' :: A list of all <code>implementedTypes</code> (interfaces) represented by a set of mappings <em>(since <code>cobigen-javaplugin v1.1.0</code>)</em></p>
<div class="ulist">
<ul>
<li>
<p><strong>interface</strong> ('Map&lt;String, Object&gt;' :: List element)</p>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> ('String' :: Simple name of the interface)</p>
</li>
<li>
<p><strong><code>canonicalName</code></strong> ('String' :: Full qualified name of the interface)</p>
</li>
<li>
<p><strong>package</strong> ('String' :: Package name of the interface)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>fields</strong> ('List&lt;Map&lt;String, Object&gt;&gt;' :: List of fields of the input class) <em>(renamed since <code>cobigen-javaplugin v1.2.0</code>; previously <strong>attributes</strong>)</em></p>
<div class="ulist">
<ul>
<li>
<p>field ('Map&lt;String, Object&gt;' :: List element)</p>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> ('String' :: Name of the Java field)</p>
</li>
<li>
<p><strong>type</strong> ('String' :: Type of the Java field)</p>
</li>
<li>
<p><code><strong>canonicalType</strong></code> ('String' :: Full qualified type declaration of the Java field&#8217;s type)</p>
</li>
<li>
<p>'<strong><code>isId</code></strong>' (<code>Deprecated</code> :: <code>boolean</code> :: true if the Java field or its setter or its getter is annotated with the <code>javax.persistence.Id</code> annotation, false otherwise. Equivalent to <code>${pojo.attributes[i].annotations.javax_persistence_Id?has_content}</code>)</p>
</li>
<li>
<p><strong>JavaDoc</strong> (see <code>pojo.JavaDoc</code>)</p>
</li>
<li>
<p><strong>annotations</strong> (see <code>pojo.annotations</code> with the remark, that for fields all annotations of its setter and getter will also be collected)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code><strong>methodAccessibleFields</strong></code> ('List&lt;Map&lt;String, Object&gt;&gt;' :: List of fields of the input class or its inherited classes, which are accessible using setter and getter methods)</p>
<div class="ulist">
<ul>
<li>
<p>same as for <em>field</em> (but without JavaDoc!)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>methods</strong> ('List&lt;Map&lt;String, Object&gt;&gt;' :: The list of all methods, whereas one method will be represented by a set of property mappings)</p>
<div class="ulist">
<ul>
<li>
<p>method ('Map&lt;String, Object&gt;' :: List element)</p>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> ('String' :: Name of the method)</p>
</li>
<li>
<p><strong>JavaDoc</strong> (see <code>pojo.JavaDoc</code>)</p>
</li>
<li>
<p><strong>annotations</strong> (see <code>pojo.annotations</code>)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Furthermore, when providing a <code>Class&lt;?&gt;</code> object as input, the Java Plug-in will provide additional functionalities as template methods <em>(deprecated)</em>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>isAbstract(String fqn)</code> (Checks whether the type with the given full qualified name is an abstract class. Returns a Boolean value.) <em>(since <code>cobigen-javaplugin v1.1.1</code>)</em>  <em>(deprecated)</em></p>
</li>
<li>
<p><code>isSubtypeOf(String subType, String superType)</code> (Checks whether the <code>subType</code> declared by its full qualified name is a sub type of the <code>superType</code> declared by its full qualified name. Equals the Java expression <code>subType instanceof superType</code> and so also returns a Boolean value.) <em>(since <code>cobigen-javaplugin v1.1.1</code>)</em>  <em>(deprecated)</em></p>
</li>
</ol>
</div>
</div>
<div class="sect7">
<h8 id="model-restrictions"><a class="anchor" href="#model-restrictions"></a>Model Restrictions</h8>
<div class="paragraph">
<p>As stated before both inputs (<code>Class&lt;?&gt;</code> objects and <code>JavaClass</code> objects ) have their restrictions according to model building. In the following these restrictions are listed for both models, the <code>ParsedJava</code> Model which results from an <code>JavaClass</code> input and the <code>ReflectedJava</code> Model, which results from a Class&lt;?&gt; input.</p>
</div>
<div class="paragraph">
<p>It is important to understand, that these restrictions are only present if you work with either Parsed Model <strong>OR</strong> the Reflected Model. If you use the <em>Maven Build Plug-in</em> or <em>Eclipse Plug-in</em> these two models are merged together so that they can mutually compensate their weaknesses.</p>
</div>
<div class="sect8">
<h9 id="parsed-model"><a class="anchor" href="#parsed-model"></a>Parsed Model</h9>
<div class="ulist">
<ul>
<li>
<p>annotations of the input&#8217;s supertype are not accessible due to restrictions in the <a href="https://github.com/paul-hammant/qdox">QDox</a> library. So <code>pojo.methodAccessibleFields[i].annotations</code> will always be empty for super type fields.</p>
</li>
<li>
<p>annotations' parameter values are available as Strings only (e.g. the Boolean value <code>true</code> is transformed into <code>"true"</code>). This also holds for the Reflected Model.</p>
</li>
<li>
<p>fields of "supertypes" of the input <code>JavaClass</code> are not available at all. So <code>pojo.methodAccessibleFields</code> will only contain the input type&#8217;s and the direct superclass&#8217;s fields.</p>
</li>
<li>
<p>[resolved, since <code>cobigen-javaplugin 1.3.1</code>] field types of supertypes are always canonical. So <code>pojo.methodAccessibleFields[i].type</code> will always provide the same value as <code>pojo.methodAccessibleFields[i].canonicalType</code> (e.g. <code>java.lang.String</code> instead of the expected <code>String</code>) for super type fields.</p>
</li>
</ul>
</div>
</div>
<div class="sect8">
<h9 id="reflected-model"><a class="anchor" href="#reflected-model"></a>Reflected Model</h9>
<div class="ulist">
<ul>
<li>
<p>annotations' parameter values are available as Strings only (e.g. the Boolean value <code>true</code> is transformed into <code>"true"</code>). This also holds for the Parsed Model.</p>
</li>
<li>
<p>annotations are only available if the respective annotation has <code>@Retention(value=RUNTIME)</code>, otherwise the annotations are to be discarded by the compiler or by the VM at run time. For more information see <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/annotation/RetentionPolicy.html">RetentionPolicy</a>.</p>
</li>
<li>
<p>information about generic types is lost. E.g. a field&#8217;s/ methodAccessibleField&#8217;s type for <code>List&lt;String&gt;</code> can only be provided as <code>List&lt;?&gt;</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="merger-extensions"><a class="anchor" href="#merger-extensions"></a>Merger extensions</h6>
<div class="paragraph">
<p>The Java Plug-in provides two additional merging strategies for Java sources, which can be configured in the <code>templates.xml</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Merge strategy <code>javamerge</code> (merges two Java resources and keeps the existing Java elements on conflicts)</p>
</li>
<li>
<p>Merge strategy <code>javamerge_override</code> (merges two Java resources and overrides the existing Java elements on conflicts)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In general merging of two Java sources will be processed as follows:</p>
</div>
<div class="paragraph">
<p>Precondition of processing a merge of generated contents and existing ones is a common Java root class resp. surrounding class. If this is the case this class and all further inner classes will be merged recursively. Therefore, the following Java elements will be merged and conflicts will be resolved according to the configured merge strategy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>extends</code> and <code>implements</code> relations of a class: Conflicts can only occur for the extends relation.</p>
</li>
<li>
<p>Annotations of a class: Conflicted if an annotation declaration already exists.</p>
</li>
<li>
<p>Fields of a class: Conflicted if there is already a field with the same name in the existing sources. (Will be replaced / ignored in total, also including annotations)</p>
</li>
<li>
<p>Methods of a class: Conflicted if there is already a method with the same signature in the existing sources. (Will be replaced / ignored in total, also including annotations)</p>
</li>
</ul>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Property Plug-in
The CobiGen Property Plug-in currently only provides different merge mechanisms for documents written in <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Properties.html">Java property syntax</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="merger-extensions-2"><a class="anchor" href="#merger-extensions-2"></a>Merger extensions</h6>
<div class="paragraph">
<p>There are two merge strategies for Java properties, which can be configured in the templates.xml:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Merge strategy <code>propertymerge</code> (merges two properties documents and keeps the existing properties on conflicts)</p>
</li>
<li>
<p>Merge strategy <code>propertymerge_override</code> (merges two properties documents and overrides the existing properties on conflicts)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both documents (base and patch) will be parsed using the <a href="http://docs.oracle.com/javase/7/docs/api/java/util/Properties.html">Java 7 API</a> and will be compared according their keys. Conflicts will occur if a key in the patch already exists in the base document.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==XML Plug-in
The CobiGen XML Plug-in comes with an input reader for XML artifacts, XML related trigger and matchers and provides different merge mechanisms for XML result documents.</p>
</div>
</div>
<div class="sect5">
<h6 id="trigger-extension-2"><a class="anchor" href="#trigger-extension-2"></a>Trigger extension</h6>
<div class="paragraph">
<p><em>(since <code>cobigen-xmlplugin v2.0.0</code>)</em></p>
</div>
<div class="paragraph">
<p>The XML Plug-in provides a trigger for XML related inputs. It accepts XML documents as input (see <code><a href="#xml-input-reader">XML input reader</a></code>) and provides additional matching and variable assignment mechanisms. The configuration in the <code>context.xml</code> for this trigger looks like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'xml'</p>
<div class="listingblock">
<div class="title">Listing 131. Example of a XML trigger definition.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="xml" templateFolder="..."&gt;
    ...
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger type enables XML documents as inputs.</p>
</div>
</li>
<li>
<p>type <code>xpath</code></p>
<div class="listingblock">
<div class="title">Listing 132. Example of a <code>xpath</code> trigger definition.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="xpath" templateFolder="..."&gt;
    ...
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger type enables XML documents as container inputs, which consists of several sub-documents.</p>
</div>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="container-matcher-type"><a class="anchor" href="#container-matcher-type"></a>Container Matcher type</h7>
<div class="paragraph">
<p>A <code>ContainerMatcher</code> check if the input is a valid container.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>xpath</code>: type: <code>xpath</code></p>
<div class="listingblock">
<div class="title">Listing 133. Example of a XML trigger definition with a node name matcher.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="xml" templateFolder="..."&gt;
    &lt;containerMatcher type="xpath" value="./uml:Model//packagedElement[@xmi:type='uml:Class']"&gt;
        ...
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Before applying any Matcher, this <code>containerMatcher</code> checks if the XML file contains a node <code>uml:Model</code> with a childnode <code>packagedElement</code> which contains an attribute <code>xmi:type</code> with the value <code>uml:Class</code>.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="matcher-types-2"><a class="anchor" href="#matcher-types-2"></a>Matcher types</h7>
<div class="paragraph">
<p>With the trigger you might define matchers, which restrict the input upon specific aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>XML: type <code>nodename</code> &#8594; document&#8217;s root name matching</p>
<div class="listingblock">
<div class="title">Listing 134. Example of a XML trigger definition with a node name matcher</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="xml" templateFolder="..."&gt;
    &lt;matcher type="nodename" value="\D\w*"&gt;
        ...
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger will be enabled if the root name of the declaring input document matches the given regular expression (<code>value</code>).</p>
</div>
</li>
<li>
<p><code>xpath</code>: type: <code>xpath</code> &#8594; matching a node with a <code>xpath</code> value</p>
<div class="listingblock">
<div class="title">Listing 135. Example of a <code>xpath</code> trigger definition with a <code>xpath</code> matcher.</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="xml" templateFolder="..."&gt;
    &lt;matcher type="xpath" value="/packagedElement[@xmi:type='uml:Class']"&gt;
        ...
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger will be enabled if the XML file contains a node <code>/packagedElement</code> where the <code>xmi:type</code> property equals <code>uml:Class</code>.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="variable-assignment-types-2"><a class="anchor" href="#variable-assignment-types-2"></a>Variable Assignment types</h7>
<div class="paragraph">
<p>Furthermore, it provides the ability to extract information from each input for further processing in the templates. The values assigned by variable assignments will be made available in template and the <code>destinationPath</code> of <code>context.xml</code> through the namespace <code>variables.&lt;key&gt;</code>. The XML Plug-in currently provides only one mechanism:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'constant' &#8594; constant parameter</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="xml" templateFolder="..."&gt;
    &lt;matcher type="nodename" value="\D\w*"&gt;
        &lt;variableAssignment type="constant" key="domain" value="restaurant" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This variable assignment assigns the <code>value</code> to the <code>key</code> as a constant.</p>
</div>
</div>
<div class="sect6">
<h7 id="xml-input-reader"><a class="anchor" href="#xml-input-reader"></a>XML input reader</h7>
<div class="paragraph">
<p>The CobiGen XML Plug-in implements an input reader for parsed XML documents. So API user can pass <code>org.w3c.dom.Document</code> objects for generation. For getting the right parsed XML inputs you can easily use the <code>xmlplugin.util.XmlUtil</code>, which provides static functionality to parse XML files or input streams and get the appropriate <code>Document</code> object.</p>
</div>
<div class="sect7">
<h8 id="template-object"><a class="anchor" href="#template-object"></a>Template object</h8>
<div class="paragraph">
<p>Due to the heterogeneous structure an XML document can have, the XML input reader does not always create exactly the same model structure (in contrast to the java input reader). For example the model&#8217;s depth differs strongly, according to it&#8217;s input document. To allow navigational access to the nodes, the model also depends on the document&#8217;s element&#8217;s node names. All child elements with unique names, are directly accessible via their names. In addition it is possible to iterate over all child elements with held of the child list <code>Children</code>. So it is also possible to access child elements with non unique names.</p>
</div>
<div class="paragraph">
<p>The XML input reader will create the following object model for template creation (<code><sub>EXAMPLEROOT</sub>, <sub>EXAMPLENODE1</sub>, <sub>EXAMPLENODE2</sub>, <sub>EXAMPLEATTR1</sub>,&#8230;&#8203;</code> are just used here as examples. Of course they will be replaced later by the actual node or attribute names):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>~EXAMPLEROOT~</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>_nodeName_</code></strong> ('String' :: Simple name of the root node)</p>
</li>
<li>
<p><strong><code>_text_</code></strong> ('String' :: Concatenated text content (<code>PCDATA</code>) of the root node)</p>
</li>
<li>
<p><strong><code>TextNodes</code></strong> ('List&lt;String&gt;' :: List of all the root&#8217;s text node contents)</p>
</li>
<li>
<p><strong><code>_at_~EXAMPLEATTR1~</code></strong> ('String' :: String representation of the attribute&#8217;s value)</p>
</li>
<li>
<p><strong><code>_at_~EXAMPLEATTR2~</code></strong> ('String' :: String representation of the attribute&#8217;s value)</p>
</li>
<li>
<p><strong>_at_&#8230;&#8203;</strong></p>
</li>
<li>
<p><strong>Attributes</strong> ('List&lt;Map&lt;String, Object&gt;&gt;' :: List of the root&#8217;s attributes</p>
<div class="ulist">
<ul>
<li>
<p>at ('Map&lt;String, Object&gt;' :: List element)</p>
<div class="ulist">
<ul>
<li>
<p><code><strong>_attName_</strong> ('String' :: Name of the attribute)</code></p>
</li>
<li>
<p><code><strong>_attValue_</strong> ('String' :: String representation of the attribute&#8217;s value)</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Children</strong> ('List&lt;Map&lt;String, Object&gt;&gt;' :: List of the root&#8217;s child elements</p>
<div class="ulist">
<ul>
<li>
<p>child ('Map&lt;String, Object&gt;' :: List element)</p>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203;common element sub structure&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>~EXAMPLENODE1~</code></strong> ('Map&lt;String, Object&gt;' :: One of the root&#8217;s child nodes)</p>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203;common element structure&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>~EXAMPLENODE2~</code></strong> ('Map&lt;String, Object&gt;' :: One of the root&#8217;s child nodes)</p>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203;common element sub structure&#8230;&#8203;</p>
</li>
<li>
<p><strong><code>~EXAMPLENODE21~</code></strong> ('Map&lt;String, Object&gt;' :: One of the nodes' child nodes)</p>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203;common element structure&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>~EXAMPLENODE&#8230;&#8203;~</code></strong></p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>~EXAMPLENODE&#8230;&#8203;~</code></strong></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In contrast to the java input reader, this XML input reader does currently not provide any additional template methods.</p>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="merger-extensions-3"><a class="anchor" href="#merger-extensions-3"></a>Merger extensions</h6>
<div class="paragraph">
<p>The XML plugin uses the <a href="https://github.com/maybeec/lexeme"><code>LeXeMe</code></a> merger library to produce semantically correct merge products. The merge strategies can be found in the <a href="https://github.com/devonfw/cobigen/blob/master/cobigen/cobigen-xmlplugin/src/main/java/com/devonfw/cobigen/xmlplugin/merger/delegates/MergeType.java#L11"><code>MergeType enum</code></a> and can be configured in the <code>templates.xml</code> as a <code>mergeStrategy</code> attribute:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mergeStrategy xmlmerge</code></p>
<div class="listingblock">
<div class="title">Listing 136. Example of a template using the <code>mergeStrategy</code> <code>xmlmerge</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;templates&gt;
	&lt;template name="..." destinationPath="..." templateFile="..." mergeStrategy="xmlmerge"/&gt;
&lt;/templates&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Currently only the document types included in LeXeMe are supported.
On how the merger works consult the <a href="https://github.com/maybeec/lexeme/wiki">LeXeMe Wiki</a>.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Text Merger Plug-in
The Text Merger Plug-in enables merging result free text documents to existing free text documents. Therefore, the algorithms are also very rudimentary.</p>
</div>
</div>
<div class="sect5">
<h6 id="extensions"><a class="anchor" href="#extensions"></a>Merger extensions</h6>
<div class="paragraph">
<p>There are currently three main merge strategies that apply for the whole document:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>merge strategy <code>textmerge_append</code> (appends the text directly to the end of the existing document)
_Remark_: If no anchors are defined, this will simply append the patch.</p>
</li>
<li>
<p>merge strategy <code>textmerge_appendWithNewLine</code> (appends the text after adding a new line break to the existing document)
_Remark_: empty patches will not result in appending a new line any more since v1.0.1
<em>Remark</em>: Only suitable if no anchors are defined, otherwise it will simply act as <code>textmerge_append</code></p>
</li>
<li>
<p>merge strategy <code>textmerge_override</code> (replaces the contents of the existing file with the patch)
_Remark_: If anchors are defined, override is set as the default <code>mergestrategy</code> for every text block if not redefined in an anchor specification.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="anchor-functionality"><a class="anchor" href="#anchor-functionality"></a>Anchor functionality</h6>
<div class="paragraph">
<p>If a template contains text that fits the definition of <code>anchor:${documentpart}:${mergestrategy}:anchorend</code> or more specifically the regular expression <code>(.*)anchor:([<sup>:]+):(newline_)?([</sup>:]+)(_newline)?:anchorend\\s*(\\r\\n|\\r|\\n)</code>, some additional functionality becomes available about specific parts of the incoming text and the way it will be merged with the existing text. These anchors always change things about the text to come up until the next anchor, text before it is ignored.</p>
</div>
<div class="paragraph">
<p>If no anchors are defined, the complete patch will be appended depending on your choice for the template in the file <code>templates.xml</code>.</p>
</div>
<div class="paragraph">
<p>[[<code>anchordef</code>]]</p>
</div>
<div class="sect6">
<h7 id="anchor-definition"><a class="anchor" href="#anchor-definition"></a>Anchor Definition</h7>
<div class="paragraph">
<p>Anchors should always be defined as a comment of the language the template results in, as you do not want them to appear in your readable version, but cannot define them as FreeMarker comments in the template, or the merger will not know about them.
Anchors will also be read when they are not comments due to the merger being able to merge multiple types of text-based languages, thus making it practically impossible to filter for the correct comment declaration. <strong>That is why anchors have to always be followed by line breaks</strong>. That way there is a universal way to filter anchors that should have anchor functionality and ones that should appear in the text.
<em>Remark:</em> If the resulting language has closing tags for comments, they have to appear in the next line.
<em>Remark:</em> If you do not put the anchor into a new line, all the text that appears before it will be added to the anchor.</p>
</div>
</div>
<div class="sect6">
<h7 id="document-parts"><a class="anchor" href="#document-parts"></a>Document parts</h7>
<div class="paragraph">
<p>In general, <code>${documentpart}</code> is an id to mark a part of the document, that way the merger knows what parts of the text to merge with which parts of the patch (e.g. if the existing text contains <code>anchor:table:${}:anchorend</code> that part will be merged with the part tagged <code>anchor:table:${}:anchorend</code> of the patch).</p>
</div>
<div class="paragraph">
<p>If the same <code>documentpart</code> is defined multiple times, it can lead to errors, so instead of defining <code>table</code> multiple times, use <code>table1</code>, <code>table2</code>, <code>table3</code> etc.</p>
</div>
<div class="paragraph">
<p>If a <code>${documentpart}</code> is defined in the document but not in the patch and they are in the same position, it is processed in the following way: If only the <code>documentparts header</code>, <code>test</code> and <code>footer</code> are defined in the document in that order, and the patch contains <code>header</code>, <code>order</code> and <code>footer</code>, the resulting order will be <code>header</code>, <code>test</code>, <code>order</code> then <code>footer</code>.</p>
</div>
<div class="paragraph">
<p>The following <code>documentparts</code> have default functionality:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>anchor:header:${mergestrategy}:anchorend</code> marks the beginning of a header, that will be added once when the document is created, but not again.
<em>Remark:</em> This is only done once, if you have <code>header</code> in another anchor, it will be ignored</p>
</li>
<li>
<p><code>anchor:footer:${mergestrategy}:anchorend</code> marks the beginning of a footer, that will be added once when the document is created, but not again. Once this is invoked, all following text will be included in the footer, including other anchors.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>[[<code>mergestrategies</code>]]</p>
</div>
</div>
<div class="sect6">
<h7 id="mergestrategies"><a class="anchor" href="#mergestrategies"></a><code>Mergestrategies</code></h7>
<div class="paragraph">
<p><code>Mergestrategies</code> are only relevant in the patch, as the merger is only interested in how text in the patch should be managed, not how it was managed in the past.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>anchor:${documentpart}::anchorend</code> will use the merge strategy from <code>templates.xml</code>, see <a href="#extensions">Merger-Extensions</a>.</p>
</li>
<li>
<p><code>anchor:${}:${mergestrategy}_newline:anchorend</code> or <code>anchor:${}:newline_${mergestrategy}:anchorend</code> states that a new line should be appended before or after this anchors text, depending on where the newline is (before or after the <code>mergestrategy</code>). <code>anchor:${documentpart}:newline:anchorend</code> puts a new line after the anchors text.
<em>Remark:</em> Only works with appending strategies, not merging/replacing ones. These strategies currently include: <code>appendbefore</code>, <code>append</code>/<code>appendafter</code></p>
</li>
<li>
<p><code>anchor:${documentpart}:override:anchorend</code> means that the new text of this <code>documentpart</code> will replace the existing one completely</p>
</li>
<li>
<p><code>anchor:${documentpart}:appendbefore:anchorend</code> or <code>anchor:${documentpart}:appendafter:anchorend</code>/<code>anchor:${documentpart}:append:anchorend</code> specifies whether the text of the patch should come before the existing text or after.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect5">
<h6 id="usage-examples"><a class="anchor" href="#usage-examples"></a>Usage Examples</h6>
<div class="sect6">
<h7 id="general-2"><a class="anchor" href="#general-2"></a>General</h7>
<div class="paragraph">
<p>Below you can see how a file with anchors might look like (using adoc comment tags), with examples of what you might want to use the different functions for.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>// anchor:header:append:anchorend

Table of contents
Introduction/Header

// anchor:part1:appendafter:anchorend

Lists
Table entries

// anchor:part2:nomerge:anchorend

Document Separators
adoc table definitions

// anchor:part3:override:anchorend

Anything that you only want once but changes from time to time

// anchor:footer:append:anchorend

Copyright Info
Imprint</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="merging"><a class="anchor" href="#merging"></a>Merging</h7>
<div class="paragraph">
<p>In this section you will see a comparison on what files look like before and after merging</p>
</div>
<div class="sect7">
<h8 id="override"><a class="anchor" href="#override"></a>override</h8>
<div class="listingblock">
<div class="title">Listing 137. Before</div>
<div class="content">
<pre>// anchor:part:override:anchorend
Lorem Ipsum</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 138. Patch</div>
<div class="content">
<pre>// anchor:part:override:anchorend
Dolor Sit</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 139. After</div>
<div class="content">
<pre>// anchor:part:override:anchorend
Dolor Sit</pre>
</div>
</div>
</div>
<div class="sect7">
<h8 id="appending"><a class="anchor" href="#appending"></a>Appending</h8>
<div class="listingblock">
<div class="title">Listing 140. Before</div>
<div class="content">
<pre>// anchor:part:append:anchorend
Lorem Ipsum
// anchor:part2:appendafter:anchorend
Lorem Ipsum
// anchor:part3:appendbefore:anchorend
Lorem Ipsum</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 141. Patch</div>
<div class="content">
<pre>// anchor:part:append:anchorend
Dolor Sit
// anchor:part2:appendafter:anchorend
Dolor Sit
// anchor:part3:appendbefore:anchorend
Dolor Sit</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 142. After</div>
<div class="content">
<pre>// anchor:part:append:anchorend
Lorem Ipsum
Dolor Sit
// anchor:part2:appendafter:anchorend
Lorem Ipsum
Dolor Sit
// anchor:part3:appendbefore:anchorend
Dolor Sit
Lorem Ipsum</pre>
</div>
</div>
</div>
<div class="sect7">
<h8 id="newline"><a class="anchor" href="#newline"></a>Newline</h8>
<div class="listingblock">
<div class="title">Listing 143. Before</div>
<div class="content">
<pre>// anchor:part:newline_append:anchorend
Lorem Ipsum
// anchor:part:append_newline:anchorend
Lorem Ipsum
(end of file)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 144. Patch</div>
<div class="content">
<pre>// anchor:part:newline_append:anchorend
Dolor Sit
// anchor:part:append_newline:anchorend
Dolor Sit
(end of file)</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 145. After</div>
<div class="content">
<pre>// anchor:part:newline_append:anchorend
Lorem Ipsum

Dolor Sit
// anchor:part:append_newline:anchorend
Lorem Ipsum
Dolor Sit

(end of file)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="error-list"><a class="anchor" href="#error-list"></a>Error List</h6>
<div class="ulist">
<ul>
<li>
<p>If there are anchors in the text, but either base or patch do not start with one, the merging process will be aborted, as text might go missing this way.</p>
</li>
<li>
<p>Using <code>_newline</code> or <code>newline_</code> with <code>mergestrategies</code> that don&#8217;t support it , like <code>override</code>, will abort the merging process. See &lt;&lt;`mergestrategies`,Merge Strategies&gt;&gt; &#8594;2 for details.</p>
</li>
<li>
<p>Using undefined <code>mergestrategies</code> will abort the merging process.</p>
</li>
<li>
<p>Wrong anchor definitions, for example <code>anchor:${}:anchorend</code> will abort the merging process, see &lt;&lt;`anchordef`,Anchor Definition&gt;&gt; for details.</p>
</li>
</ul>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==JSON Plug-in
At the moment the plug-in can be used for merge generic JSON files depending on the merge strategy defined at the templates.</p>
</div>
</div>
<div class="sect5">
<h6 id="merger-extensions-4"><a class="anchor" href="#merger-extensions-4"></a>Merger extensions</h6>
<div class="paragraph">
<p>There are currently these merge strategies:</p>
</div>
<div class="paragraph">
<p><strong>Generic JSON Merge</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>merge strategy <code>jsonmerge</code>(add the new code respecting the existent is case of conflict)</p>
</li>
<li>
<p>merge strategy <code>jsonmerge_override</code> (add the new code overwriting the existent in case of conflict)</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>JsonArray&#8217;s</code> will be ignored / replaced in total</p>
</li>
<li>
<p><code>JsonObjects</code> in conflict will be processed recursively ignoring adding non existent elements.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="merge-process"><a class="anchor" href="#merge-process"></a>Merge Process</h6>
<div class="sect6">
<h7 id="generic-json-merging"><a class="anchor" href="#generic-json-merging"></a>Generic JSON Merging</h7>
<div class="paragraph">
<p>The merge process will be:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add non existent JSON Objects from patch file to base file.</p>
</li>
<li>
<p>For existent object in both files, will add non existent keys from patch to base object. This process will be done recursively for all existent objects.</p>
</li>
<li>
<p>For JSON Arrays existent in both files, the arrays will be just concatenated.</p>
</li>
</ol>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==TypeScript Plug-in</p>
</div>
<div class="paragraph">
<p>The TypeScript Plug-in enables merging result TS files to existing ones. This plug-in is used at the moment for generate an Angular2 client with all CRUD functionalities enabled. The plug-in also generates i18n functionality just appending at the end of the word the <code>ES</code> or <code>EN</code> suffixes, to put into the developer knowledge that this words must been translated to the correspondent language. Currently, the generation of Angular2 client requires an <code>ETO</code> java object as input so, there is no need to implement an input reader for ts artifacts for the moment.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="trigger-extensions"><a class="anchor" href="#trigger-extensions"></a>Trigger Extensions</h6>
<div class="paragraph">
<p>As for the Angular2 generation the input is a java object, the trigger expressions (including matchers and variable assignments) are implemented as <a href="https://github.com/devonfw/cobigen/wiki/cobigen-javaplugin#trigger-extension">Java</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="merger-extensions-5"><a class="anchor" href="#merger-extensions-5"></a>Merger extensions</h6>
<div class="paragraph">
<p>This plugin uses the <a href="https://github.com/devonfw/ts-merger">TypeScript Merger</a> to merge files. There are currently two merge strategies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>merge strategy <code>tsmerge</code> (add the new code respecting the existing is case of conflict)</p>
</li>
<li>
<p>merge strategy <code>tsmerge_override</code> (add the new code overwriting the existent in case of conflict)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
The merge algorithm mainly handles the following <code>AST</code> nodes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>ImportDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>Will add non existent imports whatever the merge strategy is.</p>
</li>
<li>
<p>For different imports from same module, the import clauses will be merged.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import { a } from 'b';
import { c } from 'b';
//Result
import { a, c } from 'b';</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ClassDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>Adds non existent base properties from patch based on the name property.</p>
</li>
<li>
<p>Adds non existent base methods from patch based on the name signature.</p>
</li>
<li>
<p>Adds non existent annotations to class, properties and methods.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>PropertyDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>Adds non existent decorators.</p>
</li>
<li>
<p>Merge existent decorators.</p>
</li>
<li>
<p>With override strategy, the value of the property will be replaced by the patch value.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>MethodDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>With override strategy, the body will be replaced.</p>
</li>
<li>
<p>The parameters will be merged.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ParameterDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>Replace type and modifiers with override merge strategy, adding non existent from patch into base.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ConstructorDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>Merged in the same way as Method is.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>FunctionDeclaration</code></strong></p>
<div class="ulist">
<ul>
<li>
<p>Merged in the same way as Method is.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="input-reader"><a class="anchor" href="#input-reader"></a>Input reader</h6>
<div class="paragraph">
<p>The TypeScript input reader is based on the one that the <a href="https://github.com/devonfw/ts-merger">TypeScript merger</a> uses. The current extensions are additional module fields giving from which library any entity originates.
<code>module: null</code> specifies a standard entity or type as <code>string</code> or <code>number</code>.</p>
</div>
<div class="sect6">
<h7 id="object-model"><a class="anchor" href="#object-model"></a>Object model</h7>
<div class="paragraph">
<p>To get a first impression of the created object after parsing, let us start with analyzing a small example, namely the parsing of a simple <a href="https://typeorm.io/#/">type-orm</a> model written in TypeScript.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Typescript hljs" data-lang="Typescript">import {Entity, PrimaryGeneratedColumn, Column} from "typeorm";

@Entity()
export class User {

    @PrimaryGeneratedColumn()
    id: number;

    @Column()
    firstName: string;

    @Column()
    lastName: string;

    @Column()
    age: number;

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The returned object has the following structure</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JSON hljs" data-lang="JSON">{
  "importDeclarations": [
    {
      "module": "typeorm",
      "named": [
        "Entity",
        "PrimaryGeneratedColumn",
        "Column"
      ],
      "spaceBinding": true
    }
  ],
  "classes": [
    {
      "identifier": "User",
      "modifiers": [
        "export"
      ],
      "decorators": [
        {
          "identifier": {
            "name": "Entity",
            "module": "typeorm"
          },
          "isCallExpression": true
        }
      ],
      "properties": [
        {
          "identifier": "id",
          "type": {
            "name": "number",
            "module": null
          },
          "decorators": [
            {
              "identifier": {
                "name": "PrimaryGeneratedColumn",
                "module": "typeorm"
              },
              "isCallExpression": true
            }
          ]
        },
        {
          "identifier": "firstName",
          "type": {
            "name": "string",
            "module": null
          },
          "decorators": [
            {
              "identifier": {
                "name": "Column",
                "module": "typeorm"
              },
              "isCallExpression": true
            }
          ]
        },
        {
          "identifier": "lastName",
          "type": {
            "name": "string",
            "module": null
          },
          "decorators": [
            {
              "identifier": {
                "name": "Column",
                "module": "typeorm"
              },
              "isCallExpression": true
            }
          ]
        },
        {
          "identifier": "age",
          "type": {
            "name": "number",
            "module": null
          },
          "decorators": [
            {
              "identifier": {
                "name": "Column",
                "module": "typeorm"
              },
              "isCallExpression": true
            }
          ]
        }
      ]
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we only consider the first level of the JSON response, we spot two lists of <code>imports</code> and <code>classes</code>, providing information about the only import statement and the only <strong>User</strong> class, respectively. Moving one level deeper we observe that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Every import statement is translated to an import declaration entry in the declarations list, containing the module name, as well as a list of entities imported from the given module.</p>
</li>
<li>
<p>Every class entry provides besides the class identifier, its decoration(s), modifier(s), as well as a list of properties that the original class contains.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that, for each given type, the module from which it is imported is also given as in</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JSON hljs" data-lang="JSON">  "identifier": {
    "name": "Column",
    "module": "typeorm"
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Returning to the general case, independently from the given TypeScript file, an object having the following Structure will be created.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>importDeclarations</code></strong>: A list of import statement as described above</p>
</li>
<li>
<p><strong><code>exportDeclarations</code></strong>: A list of export declarations</p>
</li>
<li>
<p><strong>classes</strong>: A list of classes extracted from the given file, where each entry is full of class specific fields, describing its properties and decorator for example.</p>
</li>
<li>
<p><strong>interfaces</strong>: A list of interfaces.</p>
</li>
<li>
<p><strong>variables</strong>: A list of variables.</p>
</li>
<li>
<p><strong>functions</strong>: A list of functions.</p>
</li>
<li>
<p><strong>enums</strong>: A list of enumerations.</p>
</li>
</ul>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==HTML Plug-in</p>
</div>
<div class="paragraph">
<p>The HTML Plug-in enables merging result HTML files to existing ones. This plug-in is used at the moment for generate an Angular2 client. Currently, the generation of Angular2 client requires an ETO java object as input so, there is no need to implement an input reader for ts artifacts for the moment.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="trigger-extensions-2"><a class="anchor" href="#trigger-extensions-2"></a>Trigger Extensions</h6>
<div class="paragraph">
<p>As for the Angular2 generation the input is a java object, the trigger expressions (including matchers and variable assignments) are implemented as <a href="https://github.com/devonfw/cobigen/wiki/cobigen-javaplugin#trigger-extension">Java</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="merger-extensions-6"><a class="anchor" href="#merger-extensions-6"></a>Merger extensions</h6>
<div class="paragraph">
<p>There are currently two merge strategies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>merge strategy <code>html-ng*</code> (add the new code respecting the existing is case of conflict)</p>
</li>
<li>
<p>merge strategy <code>html-ng*_override</code> (add the new code overwriting the existent in case of conflict)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The merging of two Angular2 files will be processed as follows:</p>
</div>
<div class="paragraph">
<p>The merge algorithm handles the following AST nodes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>md-nav-list</p>
</li>
<li>
<p>a</p>
</li>
<li>
<p>form</p>
</li>
<li>
<p>md-input-container</p>
</li>
<li>
<p>input</p>
</li>
<li>
<p>name (for name attribute)</p>
</li>
<li>
<p>ngIf</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Be aware, that the HTML merger is not generic and only handles the described tags needed for merging code of a basic Angular client implementation. For future versions, it is planned to implement a more generic solution.
</td>
</tr>
</table>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==OpenAPI Plug-in</p>
</div>
<div class="paragraph">
<p>The OpenAPI Plug-in enables the support for Swagger files that follows the <code>OpenAPI 3.0</code> standard as input for CobiGen. Until now, CobiGen was thought to follow a "code first" generation, with this plugin, now it can also follow the "contract first" strategy</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Code First</strong></p>
<div class="ulist">
<ul>
<li>
<p>Generating from a file with code (Java/XML code in our case)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Contract First</strong></p>
<div class="ulist">
<ul>
<li>
<p>Generation from a full definition file (Swagger in this case). This file contains all the information about entities, operations, etc&#8230;&#8203;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are not a CobiGen developer, you will be more interested in <a href="#usage">usage</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="trigger-extensions-3"><a class="anchor" href="#trigger-extensions-3"></a>Trigger Extensions</h6>
<div class="paragraph">
<p>The OpenAPI Plug-in provides a new trigger for <code>Swagger OpenAPI 3.0</code> related inputs. It accepts different representations as inputs (see <a href="#OpenAPI-input-reader">OpenAPI input reader</a>) and provides additional matching and variable assignment mechanisms. The configuration in the <code>context.xml</code> for this trigger looks like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type <code>openapi</code></p>
<div class="listingblock">
<div class="title">Listing 146. Example of a OpenAPI trigger definition</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    ...
&lt;/trigger&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This trigger type enables OpenAPI elements as inputs.</p>
</div>
</li>
</ul>
</div>
<div class="sect6">
<h7 id="matcher-type"><a class="anchor" href="#matcher-type"></a>Matcher type</h7>
<div class="paragraph">
<p>With the trigger you might define matchers, which restrict the input upon specific aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'element' &#8594; An object</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This trigger will be enabled if the element (Java Object) of the input file is and <code>EntityDef</code> (<code>value</code>).</p>
</div>
</div>
<div class="sect6">
<h7 id="container-matcher-type-2"><a class="anchor" href="#container-matcher-type-2"></a>Container Matcher type</h7>
<div class="paragraph">
<p>Additionally, the java plugin provides the ability to match packages (<code>containers</code>) as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'element'</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The container matcher matches elements as Java Objects, in this case will be always an <code>OpenAPIFile</code> object. (See <a href="cobigen-core_configuration#containermatcher-node.adoc"><code>containerMatcher</code> semantics</a> to get more information about <code>containerMatchers</code> itself.)</p>
</div>
</div>
<div class="sect6">
<h7 id="openapi-variable-assignment"><a class="anchor" href="#openapi-variable-assignment"></a>Variable Assignment types</h7>
<div class="paragraph">
<p>Furthermore, it provides the ability to extract information from each input for further processing in the templates. The values assigned by variable assignments will be made available in template and the <code>destinationPath</code> of context.xml through the namespace <code>variables.&lt;key&gt;</code>. The OpenAPI Plug-in currently provides two different mechanisms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'constant' &#8594; constant parameter</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    &lt;containerMatcher type="element" value="OpenApiFile"/&gt;
    &lt;matcher type="element" value="EntityDef"&gt;
        &lt;variableAssignment type="constant" key="rootPackage" value="com.capgemini.demo" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This variable assignment assigns the value of the given regular expression group number to the given <code>key</code>.
In this case, the constant type <code>variableAssignment</code> is used to specify the root package where the generate will place the files generated.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'extension' &#8594; Extraction of the info extensions and the extensions of each entity. (the tags that start with <code>"x-&#8230;&#8203;"</code>).</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">  &lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    &lt;containerMatcher type="element" value="OpenApiFile"/&gt;
    &lt;matcher type="element" value="EntityDef"&gt;
      &lt;variableAssignment type="extension" key="testingAttribute" value="x-test"/&gt;
      &lt;variableAssignment type="extension" key="rootPackage" value="x-rootpackage"/&gt;
      &lt;variableAssignment type="extension" key="globalVariable" value="x-global"/&gt;
    &lt;/matcher&gt;
  &lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The 'extension' variable assignment tries to find 'extensions' (tags that start with <code>"x-&#8230;&#8203;")</code> on the 'info'
part of your file and on the extensions of each entity. <code>value</code> is the extension that our plug-in will try to find on your OpenAPI file. The result will
be stored in the variable <code>key</code>.</p>
</div>
<div class="paragraph">
<p>As you will see on the figure below, there are two types of variables: The global ones, that are defined
on the 'info' part of the file, and the local ones, that are defined inside each entity.</p>
</div>
<div class="paragraph">
<p>Therefore, if you want to define the root package, then you will have to declare it on the 'info' part.
That way, all your entities will be generated under the same root package (e.g. com.devonfw.project).</p>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/howtos/openapi-gen/extensionPropertyFile.png"><img src="_images/images/howtos/openapi-gen/extensionPropertyFile.png" alt="Swagger at devon4j Project" height="520"></a></span></p>
</div>
<div class="paragraph">
<p>If no extension with that name was found, then an empty string will be assigned. In the case of not defining the root package, then the code will be generated into <code>src/main/java</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type 'property' &#8594; property of the Java Object</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    &lt;containerMatcher type="element" value="OpenApiFile"/&gt;
    &lt;matcher type="element" value="EntityDef"&gt;
        &lt;variableAssignment type="property" key="entityName" value="name" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The 'property' variable assignment tries to find the property <code>value</code> of the entities defined on the schema.
The value is assigned to the <code>key</code>. The current properties that you will able to get are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>ComponentDef <strong>component</strong></code>: It is an object that stores the configuration of an devon4j component. Its only
property is <code>List&lt;PathDef&gt; <strong>paths</strong></code> which contains the paths as the ones shown <a href="#paths">here</a>.</p>
</li>
<li>
<p><code>String <strong>componentName</strong></code>: Stores the name of the <code>x-component</code> tag for this entity.</p>
</li>
<li>
<p><code>String <strong>name</strong></code>: Name of this entity (as shown on the example above).</p>
</li>
<li>
<p><code>String <strong>description</strong></code>: Description of this entity.</p>
</li>
<li>
<p><code>List&lt;PropertyDef&gt; <strong>properties</strong></code>: List containing all the properties of this entity. <code>PropertyDef</code> is an object that has the next properties:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>String name.</p>
</li>
<li>
<p>String type.</p>
</li>
<li>
<p>String format.</p>
</li>
<li>
<p>String description.</p>
</li>
<li>
<p>Boolean <code>isCollection</code>.</p>
</li>
<li>
<p>Boolean <code>isEntity</code>.</p>
</li>
<li>
<p>Boolean required.</p>
</li>
<li>
<p>Map&lt;String, Object&gt; constraints</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>If no property with that name was found, then it will be set to <code>null</code>.</p>
</div>
</div>
<div class="sect6">
<h7 id="full-trigger-configuration"><a class="anchor" href="#full-trigger-configuration"></a>Full trigger configuration</h7>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;trigger id="..." type="openapi" templateFolder="..."&gt;
    &lt;containerMatcher type="element" value="OpenApiFile"&gt;
    &lt;matcher type="element" value="EntityDef"&gt;
        &lt;variableAssignment type="constant" key="rootPackage" value="com.capgemini.demo" /&gt;
        &lt;variableAssignment type="property" key="component" value="componentName" /&gt;
        &lt;variableAssignment type="property" key="entityName" value="name" /&gt;
    &lt;/matcher&gt;
&lt;/trigger&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="OpenAPI-input-reader"><a class="anchor" href="#OpenAPI-input-reader"></a>Input reader</h6>
<div class="paragraph">
<p>The CobiGen OpenAPI Plug-in implements an input reader for <code>OpenAPI 3.0</code> files. The XML input reader will create the following object model for template creation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>model</strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>header</strong> (<code>HeaderDef</code> :: Definition of the header found at the top of the file)</p>
</li>
<li>
<p><strong>name</strong> ('String' :: Name of the current Entity)</p>
</li>
<li>
<p><strong><code>componentName</code></strong> ('String' :: name of the component the entity belongs to)</p>
</li>
<li>
<p><strong>component</strong> (<code>ComponentDef</code> :: Full definition of the component that entity belongs to)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: Description of the Entity)</p>
</li>
<li>
<p><strong>properties</strong> (<code>List&lt;PropertyDef&gt;</code> :: List of properties the entity has)</p>
</li>
<li>
<p><strong><code>relationShips</code></strong> (<code>List&lt;RelationShip&gt;</code> :: List of Relationships the entity has)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>HeaderDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>info</strong> (<code>InfoDef</code> :: Definition of the info found in the header)</p>
</li>
<li>
<p><strong>servers</strong> (<code>List&lt;ServerDef&gt;</code> :: List of servers the specification uses)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>InfoDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>title</strong> ('String' :: The title of the specification)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: The description of the specification)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ServerDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>URI</code></strong> ('String' :: String representation of the Server location)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: description of the server)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ComponentDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>paths</strong> (<code>List&lt;PathDef&gt;</code> :: List of services for this component)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>PropertyDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>name</strong> ('String' :: Name of the property)</p>
</li>
<li>
<p><strong>type</strong> ('String' :: type of the property)</p>
</li>
<li>
<p><strong>format</strong> ('String' :: format of the property (i.e. int64))</p>
</li>
<li>
<p><strong><code>isCollection</code></strong> (<code>boolean</code> :: <strong>true</strong> if the property is a collection, false by default)</p>
</li>
<li>
<p><strong><code>isEntity</code></strong> (<code>boolean</code> :: <strong>true</strong> if the property refers to another entity, false by default)</p>
</li>
<li>
<p><strong><code>sameComponent</code></strong> (<code>boolean</code> :: <strong>true</strong> if the entity that the property refers to belongs to the same component, false by default)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: Description of the property)</p>
</li>
<li>
<p><strong>required</strong> (<code>boolean</code> :: <strong>true</strong> if the property is set as required)</p>
</li>
<li>
<p><strong>constraints</strong> ('Map&lt;String, Object&gt;')</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>RelationShip</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>type</strong> ('String' :: type of the relationship (<code>OneToOne</code>, <code>ManyToMany</code>, etc&#8230;&#8203;))</p>
</li>
<li>
<p><strong>entity</strong> ('String' :: destination entity name)</p>
</li>
<li>
<p><strong><code>sameComponent</code></strong> (<code>boolean</code> :: <strong>true</strong> if the destination entity belongs to the same component of the source entity, false by default)</p>
</li>
<li>
<p><strong><code>unidirectional</code></strong> (<code>boolean</code> :: <strong>true</strong> if the relationship is unidirectional, false by default)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>PathDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>rootComponent</code></strong> ('String' :: the first segment of the path)</p>
</li>
<li>
<p><strong>version</strong> ('String' :: version of the service)</p>
</li>
<li>
<p><strong><code>pathURI</code></strong> ('String' :: URI of the path, the segment after the version)</p>
</li>
<li>
<p><strong>operations</strong> (<code>List&lt;OperationDef&gt;</code> :: List of operations for this path)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>OperationDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong>type</strong> ('String' :: type of the operation (GET, PUT, etc&#8230;&#8203;))</p>
</li>
<li>
<p><strong>parameters</strong> (<code>List&lt;ParameterDef&gt;</code> :: List of parameters)</p>
</li>
<li>
<p><strong><code>operationId</code></strong> ('String' :: name of the operation prototype)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: <code>JavaDoc</code> Description of the operation)</p>
</li>
<li>
<p><strong>summary</strong> (<code>List&lt;PropertyDef&gt;</code> :: <code>JavaDoc</code> operation Summary)</p>
</li>
<li>
<p><strong>tags</strong> ('List&lt;String&gt;' :: List of different tags)</p>
</li>
<li>
<p><strong>responses</strong> (<code>List&lt;ResponseDef&gt;</code> :: Responses of the operation)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ParameterDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>isSearchCriteria</code></strong> (<code>boolean</code> :: <strong>true</strong> if the response is an <code>SearchCriteria</code> object)</p>
</li>
<li>
<p><strong><code>inPath</code></strong> (<code>boolean</code> :: <strong>true</strong> if this parameter is contained in the request path)</p>
</li>
<li>
<p><strong><code>inQuery</code></strong> (<code>boolean</code> :: <strong>true</strong> if this parameter is contained in a query)</p>
</li>
<li>
<p><strong><code>isBody</code></strong> (<code>boolean</code> :: <strong>true</strong> if this parameter is a response body)</p>
</li>
<li>
<p><strong><code>inHeader</code></strong> (<code>boolean</code> :: <strong>true</strong> if this parameter is contained in a header)</p>
</li>
<li>
<p><strong><code>mediaType</code></strong> ('String' :: String representation of the media type of the parameter)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong><code>ResponseDef</code></strong> ('Map&lt;String, Object&gt;' :: common element structure)</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>isArray</code></strong> (<code>boolean</code> :: <strong>true</strong> if the type of the response is an Array)</p>
</li>
<li>
<p><strong><code>isPaginated</code></strong> (<code>boolean</code> :: <strong>true</strong> if the type of the response is paginated)</p>
</li>
<li>
<p><strong><code>isVoid</code></strong> (<code>boolean</code> :: <strong>true</strong> if there is no type/an empty type)</p>
</li>
<li>
<p><strong><code>isEntity</code></strong> (<code>boolean</code> :: <strong>true</strong> if the type of the response is an Entity)</p>
</li>
<li>
<p><strong><code>entityRef</code></strong> (<code>EntityDef</code> :: Incomplete <code>EntityDef</code> containing the name and properties of the referenced Entity)</p>
</li>
<li>
<p><strong>type</strong> ('String' :: String representation of the attribute&#8217;s value)</p>
</li>
<li>
<p><strong>code</strong> ('String' :: String representation of the HTTP status code)</p>
</li>
<li>
<p><strong><code>mediaTypes</code></strong> ('List&lt;String&gt;' :: List of media types that can be returned)</p>
</li>
<li>
<p><strong>description</strong> ('String' :: Description of the response)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="merger-extensions-7"><a class="anchor" href="#merger-extensions-7"></a>Merger extensions</h6>
<div class="paragraph">
<p>This plugin only provides an input reader, there is no support for OpenAPI merging. Nevertheless, the files generated from an OpenAPI file will be Java, XML, JSON, TS, etc&#8230;&#8203; so,
for each file to be generated defined at templates.xml, must set the <code>mergeStrategy</code> for the specific language (<code>javamerge</code>, <code>javamerge_override</code>, <code>jsonmerge</code>, etc&#8230;&#8203;)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;templates&gt;
    ...
    &lt;templateExtension ref="${variables.entityName}.java" mergeStrategy="javamerge"/&gt;
    ...
    &lt;templateExtension ref="${variables.entityName}dataGrid.component.ts" mergeStrategy="tsmerge"/&gt;
    ...
    &lt;templateExtension ref="en.json" mergeStrategy="jsonmerge"/&gt;
&lt;/templates&gt;</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="usage-8"><a class="anchor" href="#usage-8"></a>Usage</h6>
<div class="sect6">
<h7 id="writing-openapi-3-0-contract-file"><a class="anchor" href="#writing-openapi-3-0-contract-file"></a>Writing <code>OpenAPI 3.0</code> contract file</h7>
<div class="paragraph">
<p>The Swagger file must follow the <code>OpenAPI 3.0</code> standard to be readable by CobiGen, otherwise and error will be thrown.
A full documentation about how to follow this standard can be found <a href="https://swagger.io/docs/specification/about/">Swagger3 Docs</a>.</p>
</div>
<div class="paragraph">
<p>The Swagger file must be at the core folder of your devon4j project, like shown below:</p>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/howtos/openapi-gen/openapi_howto1.png"><img src="_images/images/howtos/openapi-gen/openapi_howto1.png" alt="Swagger at devon4j Project" width="450"></a></span></p>
</div>
<div class="paragraph">
<p>To be compatible with CobiGen and devon4j, it must follow some specific configurations. This configurations allows us to avoid redundant definitions as <code>SearchCriteria</code> and <code>PaginatedList</code> objects are used at the services definitions.</p>
</div>
</div>
<div class="sect6">
<h7 id="paths"><a class="anchor" href="#paths"></a>Paths</h7>
<div class="ulist">
<ul>
<li>
<p>Just adding the <em>tags</em> property at the end of the service definitions with the items <em>`SearchCriteria`</em> and/or <em>paginated</em> put into CobiGen knowledge that an standard devon4j <code>SearchCriteria</code> and/or <code>PaginateListTo</code> object must be generated. That way, the Swagger file will be easier to write and even more understandable.</p>
</li>
<li>
<p>The path must start with the component name, and define an <code>x-component</code> tag with the component name. That way this service will be included into the component services list.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">  /componentnamemanagement/v1/entityname/customOperation/:
    x-component: componentnamemanagement
    post:
      summary: 'Summary of the operation'
      description: Description of the operation.
      operationId: customOperation
      responses:
        '200':
          description: Description of the response.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/EntityName'
      requestBody:
        $ref: '#/components/requestBodies/EntityName'
      tags:
        - searchCriteria
        - paginated</code></pre>
</div>
</div>
<div class="paragraph">
<p>That way, CobiGen will be able to generate the endpoint (REST service) <code>customOperation</code> on <code>componentmanagement</code>. If you do not specify the component to generate to (the <code>x-component</code> tag) then this service will not be taken into account for generation.</p>
</div>
</div>
<div class="sect6">
<h7 id="service"><a class="anchor" href="#service"></a>Service based generation</h7>
<div class="paragraph">
<p>In previous CobiGen versions, we were able to generate code from a contract-first OpenAPI specification only when we defined components like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">components:
    schemas:
        Shop:
          x-component: shopmanagement
          description: Entity definition of Shop
          type: object
          properties:
            shopExample:
              type: string
              maxLength: 100
              minLength: 5
              uniqueItems: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>We could not generate services without the definition of those components.</p>
</div>
<div class="paragraph">
<p>In our current version, we have overcome it, so that now we are able to generate all the services independently. You just need to add an <code>x-component</code> tag with the name of the component that will make use of that service. See <a href="#paths">here</a>.</p>
</div>
<div class="paragraph">
<p>An small OpenAPI example defining only services can be found below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">openapi: 3.0.0
servers:
  - url: 'https://localhost:8081/server/services/rest'
    description: Just some data
info:
  title: Devon Example
  description: Example of a API definition
  version: 1.0.0
  x-rootpackage: com.capgemini.spoc.openapi
paths:
  /salemanagement/v1/sale/{saleId}:
    x-component: salemanagement
    get:
      operationId: findSale
      parameters:
        - name: saleId
          in: path
          required: true
          description: The id of the pet to retrieve
          schema:
            type: string
      responses:
        '200':
          description: Any
  /salemanagement/v1/sale/{bla}:
    x-component: salemanagement
    get:
      operationId: findSaleBla
      parameters:
        - name: bla
          in: path
          required: true
          schema:
            type: integer
            format: int64
            minimum: 10
            maximum: 200
      responses:
        '200':
          description: Any</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, the increment that you need to select for generating those services is <em>Crud devon4ng Service based Angular</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><a class="image" href="images/howtos/openapi-gen/service_based.png"><img src="_images/images/howtos/openapi-gen/service_based.png" alt="Service based generation" width="450"></a></span></p>
</div>
</div>
<div class="sect6">
<h7 id="full-example"><a class="anchor" href="#full-example"></a>Full example</h7>
<div class="paragraph">
<p>This example yaml file can be download from <a href="files/devonfw.yml">here</a>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
As you will see on the file, "x-component" tags are obligatory if you want to generate components (entities). They have to be defined for each one.
In addition, you will find the global variable "x-rootpackage" that are explained &lt;&lt;,here&gt;&gt;.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">openapi: 3.0.0
servers:
  - url: 'https://localhost:8081/server/services/rest'
    description: Just some data
info:
  title: Devon Example
  description: Example of a API definition
  version: 1.0.0
  x-rootpackage: com.devonfw.angular.test
paths:
  /shopmanagement/v1/shop/{shopId}:
    x-component: shopmanagement
    get:
      operationId: findShop
      parameters:
        - name: shopId
          in: path
          required: true
          schema:
            type: integer
            format: int64
            minimum: 0
            maximum: 50
      responses:
        '200':
          description: Any
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Shop'
            text/plain:
              schema:
                type: string
        '404':
          description: Not found
  /salemanagement/v1/sale/{saleId}:
    x-component: salemanagement
    get:
      operationId: findSale
      parameters:
        - name: saleId
          in: path
          required: true
          description: The id of the pet to retrieve
          schema:
            type: string
      responses:
        '200':
          description: Any
  /salemanagement/v1/sale/:
    x-component: salemanagement
    post:
      responses:
        '200':
          description: Any
      requestBody:
        $ref: '#/components/requestBodies/SaleData'
      tags:
       - searchCriteria
  /shopmanagement/v1/shop/new:
    x-component: shopmanagement
    post:
      responses:
       '200':
          description: Any
      requestBody:
        $ref: '#/components/requestBodies/ShopData'
components:
    schemas:
        Shop:
          x-component: shopmanagement
          description: Entity definition of Shop
          type: object
          properties:
            shopExample:
              type: string
              maxLength: 100
              minLength: 5
              uniqueItems: true
            sales:
              type: array # Many to One relationship
              items:
                $ref: '#/components/schemas/Sale'
        Sale:
          x-component: salemanagement
          description: Entity definition of Shop
          type: object
          properties:
            saleExample:
              type: number
              format: int64
              maximum: 100
              minimum: 0
          required:
            - saleExample

    requestBodies:
        ShopData:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Shop'
          required: true
        SaleData:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Sale'
          required: true</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cobigen-cli"><a class="anchor" href="#cobigen-cli"></a>26.3. CobiGen CLI</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==CobiGen CLI</p>
</div>
<div class="paragraph">
<p>The command line interface (CLI) for CobiGen enables the generation of code using few commands. This feature allows us to decouple CobiGen from Eclipse.</p>
</div>
<div class="sect4">
<h5 id="install-cobigen-cli"><a class="anchor" href="#install-cobigen-cli"></a>Install CobiGen CLI</h5>
<div class="paragraph">
<p>In order to install the CobiGen CLI you will need to use the <a href="https://github.com/devonfw/ide">devonfw/ide</a>. In a console run <code>devon cobigen</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="commands-and-options"><a class="anchor" href="#commands-and-options"></a>Commands and options</h5>
<div class="paragraph">
<p>Using the following command and option you will be able to customize your generation as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cobigen, cg</code>:  Main entry point of the CLI. If no arguments are passed, man page will be printed.</p>
</li>
<li>
<p><code>[generate, g]</code>: Command used for code generation.</p>
<div class="ulist">
<ul>
<li>
<p><code>InputGlob</code>: Glob pattern of the input file or the whole path of the input file from which the code will be generated.</p>
</li>
<li>
<p><code>&lt; --increment, -i &gt;</code>  : Specifies an increment ID to be generated. You can also search increments by name and CobiGen will output the resultant list. If an exact match found, code generation will happen.</p>
</li>
<li>
<p><code>&lt; --template, -t &gt;</code> : specifies a template ID to be generated. You can also search templates by name and CobiGen will output the resultant list.</p>
</li>
<li>
<p><code>&lt; --outputRootPath, -out &gt;</code>: The project file path in which you want to generate your code. If no output path is given, CobiGen will use the project of your input file.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>[adapt-templates, a]</code>: Generates a new templates folder next to the CobiGen CLI and stores its location inside a configuration file. After executing this command, the CLI will attempt to use the specified Templates folder.</p>
</li>
<li>
<p><code>&lt; --verbose, -v &gt;</code> : Prints debug information, verbose log.</p>
</li>
<li>
<p><code>&lt; --help, -h &gt;</code> : Prints man page.</p>
</li>
<li>
<p><code>&lt; update, u&gt;</code> : This command compare the artificial pom plug-ins version with central latest version available and user can update any  outdated plug-ins version .</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="cli-execution-steps"><a class="anchor" href="#cli-execution-steps"></a>CLI Execution steps:</h5>
<div class="paragraph">
<p>CobiGen CLI is installed inside your devonfw distribution. In order to execute it follow the next steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run <code>console.bat</code>, this will open a console.</p>
</li>
<li>
<p>Execute <code>cobigen</code> or <code>cg</code> and the man page should be printed.</p>
</li>
<li>
<p>Use a valid CobiGen input file and run <code>cobigen generate &lt;pathToInputFile&gt;</code>. <strong>Note:</strong> On the first execution of the CLI, CobiGen will download all the needed dependencies, please be patient.</p>
</li>
<li>
<p>A list of increments will be printed so that you can start the generation.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Preview of the man page for <code>generate</code> command:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/CLI/WithoutParam.PNG"><img src="_images/images/howtos/CLI/WithoutParam.PNG" alt="Generation path"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="examples"><a class="anchor" href="#examples"></a>Examples</h5>
<div class="paragraph">
<p>A selection of commands that you can use with the CLI:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cobigen generate foo\bar\EmployeeEntity.java</code>: As no output path has been defined, CobiGen will try to find the <code>pom.xml</code> of the current project in order to set the generation root path.</p>
</li>
<li>
<p><code>cobigen generate foo\bar\*.java --out other\project</code>: Will retrieve all the Java files on that input folder and generate the code on the path specified by <code>--out</code>.</p>
</li>
<li>
<p><code>cg g foo\bar\webServices.yml --increment TO</code>: Performs a string search using <code>TO</code> and will print the closest increments like in the following image:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/CLI/selectedIncr.PNG"><img src="_images/images/howtos/CLI/selectedIncr.PNG" alt="Generation path"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cg g foo\bar\webServices.yml -i 1,4,6</code>: Directly generates increments with IDs <code>1</code>, <code>4</code> and <code>6</code>. CobiGen will not request you any other input.</p>
</li>
<li>
<p><code>cg a</code>: Downloads the latest CobiGen_Templates and unpacks them next to the CLI. CobiGen will from now on use these unpacked Templates for generation.</p>
</li>
<li>
<p><code>cg a -cl C:\my\custom\location</code>: Downloads the latest CobiGen_Templates and unpacks them in <code>C:\my\custom\location</code>. CobiGen will from now on use these unpacked Templates for generation.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="cli-update-command"><a class="anchor" href="#cli-update-command"></a>CLI update command</h5>
<div class="paragraph">
<p>Example of Update Command :</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/CLI/updateCommand.PNG"><img src="_images/images/howtos/CLI/updateCommand.PNG" alt="Generation path"></a>
</div>
</div>
<div class="paragraph">
<p>Select the plug-ins which you want to update like below :</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/CLI/updatePlugin.PNG"><img src="_images/images/howtos/CLI/updatePlugin.PNG" alt="Generation path"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="cli-custom-templates"><a class="anchor" href="#cli-custom-templates"></a>CLI custom templates</h5>
<div class="paragraph">
<p>To use custom templates, it&#8217;s necessary to set up a custom configuration path as described <a href="cobigen-core_configuration">here</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="troubleshooting"><a class="anchor" href="#troubleshooting"></a>Troubleshooting</h5>
<div class="paragraph">
<p>When generating code from a Java file, CobiGen makes use of Java reflection for generating templates. In order to do that, the CLI needs to find the compiled source code of your project.</p>
</div>
<div class="paragraph">
<p>If you find an error like <code>Compiled class foo\bar\EmployeeEntity.java has not been found</code>, it means you need to run <code>mvn clean install</code> on the input project so that a new <code>target</code> folder gets created with the needed compiled sources.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="maven-build-integration"><a class="anchor" href="#maven-build-integration"></a>26.4. Maven Build Integration</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Maven Build Integration</p>
</div>
<div class="paragraph">
<p>For maven integration of CobiGen you can include the following build plugin into your build:</p>
</div>
<div class="listingblock">
<div class="title">Listing 147. Build integration of CobiGen</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
      &lt;artifactId&gt;cobigen-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;VERSION-YOU-LIKE&lt;/version&gt;
      &lt;executions&gt;
        &lt;execution&gt;
          &lt;id&gt;cobigen-generate&lt;/id&gt;
          &lt;phase&gt;generate-resources&lt;/phase&gt;
          &lt;goals&gt;
            &lt;goal&gt;generate&lt;/goal&gt;
          &lt;/goals&gt;
        &lt;/execution&gt;
      &lt;/executions&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Available goals</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>generate</code>: Generates contents configured by the standard non-compiled configuration folder. Thus generation can be controlled/configured due to an location URI of the configuration and template or increment ids to be generated for a set of inputs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Available phases</strong> are all phases, which already provide compiled sources such that CobiGen can perform reflection on it. Thus possible phases are for example package, site.</p>
</div>
<div class="sect4">
<h5 id="provide-template-set"><a class="anchor" href="#provide-template-set"></a>Provide Template Set</h5>
<div class="paragraph">
<p>For generation using the CobiGen maven plug-in, the CobiGen configuration can be provided in two different styles:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>By a <code>configurationFolder</code>, which should be available on the file system whenever you are running the generation. The value of <code>configurationFolder</code> should correspond to the maven file path syntax.</p>
<div class="listingblock">
<div class="title">Listing 148. Provide CobiGen configuration by configuration folder (file)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      ...
      &lt;configuration&gt;
        &lt;configurationFolder&gt;cobigen-templates&lt;/configurationFolder&gt;
      &lt;/configuration&gt;
       ...
     &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>By maven dependency, whereas the maven dependency should stick on the same conventions as the configuration folder. This explicitly means that it should contain non-compiled resources as well as the <code>context.xml</code> on top-level.</p>
<div class="listingblock">
<div class="title">Listing 149. Provide CobiGen configuration by maven dependency (jar)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      ...
      &lt;dependencies&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
          &lt;artifactId&gt;templates-XYZ&lt;/artifactId&gt;
          &lt;version&gt;VERSION-YOU-LIKE&lt;/version&gt;
        &lt;/dependency&gt;
      &lt;/dependencies&gt;
      ...
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>We currently provide a generic deployed version of the templates on the devonfw-nexus for Register Factory (<code>&lt;artifactId&gt;cobigen-templates-rf&lt;/artifactId&gt;</code>) and for the devonfw itself (<code>&lt;artifactId&gt;cobigen-templates-devonfw&lt;/artifactId&gt;</code>).</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="build-configuration"><a class="anchor" href="#build-configuration"></a>Build Configuration</h5>
<div class="paragraph">
<p>Using the following configuration you will be able to customize your generation as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;destinationRoot&gt;</code> specifies the root directory the relative <code>destinationPath</code> of <a href="cobigen-core_configuration#Templates-configuration.adoc">CobiGen templates configuration</a> should depend on. <em>Default ${basedir}</em></p>
</li>
<li>
<p><code>&lt;inputPackage&gt;</code> declares a package name to be used as input for batch generation. This refers directly to the CobiGen Java Plug-in <a href="cobigen-javaplugin#<code>ContainerMatcher</code>-types.adoc">container matchers of type package</a> configuration.</p>
</li>
<li>
<p><code>&lt;inputFile&gt;</code> declares a file to be used as input. The CobiGen maven plug-in will try to parse this file to get an appropriate input to be interpreted by any CobiGen plug-in.</p>
</li>
<li>
<p><code>&lt;increment&gt;</code> specifies an <a href="cobigen-core_configuration#increment-node.adoc">increment</a> ID to be generated. You can specify one single increment with content <code>ALL</code> to generate all increments matching the input(s).</p>
</li>
<li>
<p><code>&lt;template&gt;</code> specifies a <a href="cobigen-core_configuration#increment-node.adoc">template</a> ID to be generated. You can specify one single template with content <code>ALL</code> to generate all templates matching the input(s).</p>
</li>
<li>
<p><code>&lt;forceOverride&gt;</code> specifies an overriding behavior, which enables non-mergeable resources to be completely rewritten by generated contents. For mergeable resources this flag indicates, that conflicting fragments during merge will be replaced by generated content. <em>Default: false</em></p>
</li>
<li>
<p><code>&lt;failOnNothingGenerated&gt;</code> specifies whether the build should fail if the execution does not generate anything.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">Listing 150. Example for a simple build configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
       ...
      &lt;configuration&gt;
        &lt;destinationRoot&gt;${basedir}&lt;/destinationRoot&gt;
        &lt;inputPackages&gt;
          &lt;inputPackage&gt;package.to.be.used.as.input&lt;/inputPackage&gt;
        &lt;/inputPackages&gt;
        &lt;inputFiles&gt;
          &lt;inputFile&gt;path/to/file/to/be/used/as/input&lt;/inputFile&gt;
        &lt;/inputFiles&gt;
        &lt;increments&gt;
          &lt;increment&gt;IncrementID&lt;/increment&gt;
        &lt;/increments&gt;
        &lt;templates&gt;
          &lt;template&gt;TemplateID&lt;/template&gt;
        &lt;/templates&gt;
        &lt;forceOverride&gt;false&lt;/forceOverride&gt;
      &lt;/configuration&gt;
        ...
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="plugin-injection-since-v3"><a class="anchor" href="#plugin-injection-since-v3"></a>Plugin Injection Since v3</h5>
<div class="paragraph">
<p>Since version 3.0.0, the <a href="cobigen-core_configuration#plugin-mechanism.adoc">plug-in mechanism</a> has changed to support modular releases of the CobiGen plug-ins. Therefore, you need to add all plug-ins to be used for generation. Take the following example to get the idea:</p>
</div>
<div class="listingblock">
<div class="title">Listing 151. Example of a full configuration including plugins</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
      &lt;artifactId&gt;cobigen-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;VERSION-YOU-LIKE&lt;/version&gt;
      &lt;executions&gt;
        ...
      &lt;/executions&gt;
      &lt;configuration&gt;
        ...
      &lt;/configuration&gt;
      &lt;dependencies&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;groupId&gt;
          &lt;artifactId&gt;templates-devon4j&lt;/artifactId&gt;
          &lt;version&gt;2.0.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
          &lt;artifactId&gt;tempeng-freemarker&lt;/artifactId&gt;
          &lt;version&gt;1.0.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
          &lt;artifactId&gt;javaplugin&lt;/artifactId&gt;
          &lt;version&gt;1.6.0&lt;/version&gt;
        &lt;/dependency&gt;
      &lt;/dependencies&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="a-full-example"><a class="anchor" href="#a-full-example"></a>A full example</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A complete maven configuration example</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
      &lt;artifactId&gt;cobigen-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;6.0.0&lt;/version&gt;
      &lt;executions&gt;
        &lt;execution&gt;
          &lt;id&gt;generate&lt;/id&gt;
          &lt;phase&gt;package&lt;/phase&gt;
          &lt;goals&gt;
            &lt;goal&gt;generate&lt;/goal&gt;
          &lt;/goals&gt;
        &lt;/execution&gt;
      &lt;/executions&gt;
      &lt;configuration&gt;
        &lt;inputFiles&gt;
          &lt;inputFile&gt;src/main/java/io/github/devonfw/cobigen/generator/dataaccess/api/InputEntity.java&lt;/inputFile&gt;
        &lt;/inputFiles&gt;
        &lt;increments&gt;
          &lt;increment&gt;dataaccess_infrastructure&lt;/increment&gt;
          &lt;increment&gt;daos&lt;/increment&gt;
        &lt;/increments&gt;
        &lt;failOnNothingGenerated&gt;false&lt;/failOnNothingGenerated&gt;
      &lt;/configuration&gt;
      &lt;dependencies&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
          &lt;artifactId&gt;templates-devon4j&lt;/artifactId&gt;
          &lt;version&gt;2.0.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
          &lt;artifactId&gt;tempeng-freemarker&lt;/artifactId&gt;
          &lt;version&gt;2.0.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
          &lt;artifactId&gt;javaplugin&lt;/artifactId&gt;
          &lt;version&gt;1.6.0&lt;/version&gt;
        &lt;/dependency&gt;
      &lt;/dependencies&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="eclipse-integration"><a class="anchor" href="#eclipse-integration"></a>26.5. Eclipse Integration</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Installation</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Remark:</strong> CobiGen is preinstalled in the <a href="https://github.com/devonfw/devon-ide">devonfw/devon-ide</a>.</p>
</div>
</blockquote>
</div>
<div class="sect4">
<h5 id="preconditions"><a class="anchor" href="#preconditions"></a>Preconditions</h5>
<div class="ulist">
<ul>
<li>
<p>Eclipse 4.x</p>
</li>
<li>
<p>Java 7 Runtime (for starting eclipse with CobiGen). This is independent from the target version of your developed code.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="installation-steps"><a class="anchor" href="#installation-steps"></a>Installation steps</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open the eclipse installation dialog<br>
menu bar &#8594; <em>Help</em> &#8594; <em>Install new Software&#8230;&#8203;</em></p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/installation/01-install-new-software.png" alt="01 install new software"></span></p>
</div>
</li>
<li>
<p>Open CobiGen&#8217;s update site<br>
Insert the update site of your interest into the filed <em>Work with</em> and press <em>Add &#8230;&#8203;</em><br>
Unless you know what you are doing we recommend you install every plugin as shown in the picture below.</p>
<div class="ulist">
<ul>
<li>
<p>Stable releases: <a href="https://devonfw.com/cobigen/updatesite/stable/" class="bare">https://devonfw.com/cobigen/updatesite/stable/</a><br>
<span class="image"><img src="_images/images/howtos/installation/02-select-update-site.png" alt="02 select update site"></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>Follow the installation wizard<br>
Select <em>CobiGen Eclipse Plug-in</em> &#8594; <em>Next</em> &#8594; <em>Next</em> &#8594; accept the license &#8594; <em>Finish</em> &#8594; <em>OK</em> &#8594; <em>Yes</em></p>
</li>
<li>
<p>Once installed, a new menu entry named "CobiGen" will show up in the <em>Package Explorer&#8217;s</em> context menu. In the sub menu there will the <em>Generate&#8230;&#8203;</em> command, which may ask you to update the templates, and then you can start the generation wizard of CobiGen. You can adapt the templates by clicking on <em>Adapt Templates</em> which will give you the possibility to import the <em>CobiGen_Templates</em> automatically so that you can modified them.</p>
</li>
<li>
<p>Checkout (clone) your project&#8217;s templates folder or use the current templates released with CobiGen (<a href="https://github.com/devonfw/cobigen/tree/master/cobigen-templates" class="bare">https://github.com/devonfw/cobigen/tree/master/cobigen-templates</a>) and then choose Import -&gt; General -&gt; Existing Projects into Workspace to import the templates into your workspace.<br></p>
</li>
<li>
<p>Now you can start generating. To get an introduction of CobiGen try the devon4j templates and work on the devon4j sample application. There you might want to start with Entity objects as a selection to run CobiGen with, which will give you a good overview of what CobiGen can be used for right out of the box in devon4j based development. If you need some more introduction in how to come up with your templates and increments, please be referred to the documentation of the <a href="cobigen-core_configuration#context-configuration.adoc">context configuration</a> and the <a href="cobigen-core_configuration#templates-configuration">templates configuration</a></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Dependent on your context configuration menu entry <em>Generate&#8230;&#8203;</em> may be gray out or not. See  for more information about valid selections for generation.</p>
</div>
</div>
<div class="sect4">
<h5 id="updating"><a class="anchor" href="#updating"></a>Updating</h5>
<div class="paragraph">
<p>In general updating CobiGen for eclipse is done via the update mechanism of eclipse directly, as shown on image below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/installation/03-update-software.png" alt="03 update software"></span></p>
</div>
<div class="paragraph">
<p>Upgrading eclipse CobiGen plug-in to v3.0.0 needs some more attention of the user due to a changed plug-in architecture of CobiGen&#8217;s <a href="cobigen-core_configuration#plugin-mechanism.adoc">core module</a> and the eclipse integration. Eventually, we were able to provide any plug-in of CobiGen separately as its own eclipse bundle (fragment), which is automatically discovered by the main CobiGen Eclipse plug-in after installation.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Usage</p>
</div>
<div class="paragraph">
<p>CobiGen has two different generation modes depending on the input selected for generation. The first one is the <em>simple mode</em>, which will be started if the input contains only one input artifact, e.g. for Java an input artifact currently is a Java file. The second one is the <em>batch  mode</em>, which will be started if the input contains multiple input artifacts, e.g. for Java this means a list of files. In general this means also that the batch mode might be started when selecting complex models as inputs, which contain multiple input artifacts. The latter scenario has only been covered in the research group,yet.</p>
</div>
</div>
<div class="sect4">
<h5 id="simple-mode"><a class="anchor" href="#simple-mode"></a>Simple Mode</h5>
<div class="paragraph">
<p>Selecting the menu entry <em>Generate&#8230;&#8203;</em> the generation wizard will be opened:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/generate_wizard_page1.png" alt="generate wizard page1"></span></p>
</div>
<div class="paragraph">
<p>The left side of the wizard shows all available increments, which can be selected to be generated. Increments are a container like concept encompassing multiple files to be generated, which should result in a semantically closed generation output.
On the right side of the wizard all files are shown, which might be effected by the generation - dependent on the increment selection of files on the left side. The type of modification of each file will be encoded into following color scheme if the files are selected for generation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>green:</strong> files, which are currently non-existent in the file system. These files will be created during generation</p>
</li>
<li>
<p><strong>yellow:</strong> files, which are currently existent in the file system and which are configured to be merged with generated contents.</p>
</li>
<li>
<p><strong>red:</strong> files, which are currently existent in the file system. These files will be overwritten if manually selected.</p>
</li>
<li>
<p><strong>no color:</strong> files, which are currently existent in the file system. Additionally files, which were deselected and thus will be ignored during generation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Selecting an increment on the left side will initialize the selection of all shown files to be generated on the right side, whereas green and yellow categorized files will be selected initially. A manual modification of the pre-selection can be performed by switching to the customization tree using the <em>Customize</em> button on the right lower corner.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Optional:</strong> If you want to customize the generation object model of a Java input class, you might continue with the <em>Next &gt;</em> button instead of finishing the generation wizard. The next generation wizard page is currently available for Java file inputs and lists all non-static fields of the input. deselecting entries will lead to an adapted object model for generation, such that deselected fields will be removed in the object model for generation. By default all fields will be included in the object model.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Using the <em>Finish</em> button, the generation will be performed. Finally, CobiGen runs the eclipse internal <em>organize imports</em> and <em>format source code</em> for all generated sources and modified sources. Thus it is possible, that---especially <em>organize imports</em> opens a dialog if some types could not be determined automatically. This dialog can be easily closed by pressing on <em>Continue</em>. If the generation is finished, the <em>Success!</em> dialog will pop up.</p>
</div>
</div>
<div class="sect4">
<h5 id="batch-mode"><a class="anchor" href="#batch-mode"></a>Batch mode</h5>
<div class="paragraph">
<p>If there are multiple input elements selected, e.g., Java files, CobiGen will be started in batch mode. For the generation wizard dialog this means, that the generation preview will be constrained to the first selected input element. It does <em>not</em> preview the generation for each element of the selection or of a complex input. The selection of the files to be generated will be generated for each input element analogously afterwards.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/generate_wizard_page1_batch.png" alt="generate wizard page1 batch"></span></p>
</div>
<div class="paragraph">
<p>Thus the color encoding differs also a little bit:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>yellow:</strong> files, which are configured to be merged.</p>
</li>
<li>
<p><strong>red:</strong> files, which are not configured with any merge strategy and thus will be created if the file does not exist or overwritten if the file already exists</p>
</li>
<li>
<p><strong>no color:</strong> files, which will be ignored during generation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Initially all possible files to be generated will be selected.</p>
</div>
</div>
<div class="sect4">
<h5 id="health-check-2"><a class="anchor" href="#health-check-2"></a>Health Check</h5>
<div class="paragraph">
<p>To check whether CobiGen runs appropriately for the selected element(s) the user can perform a <em>Health Check</em> by activating the respective menu entry as shown below.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_menu_entry.png" alt="health check menu entry"></span></p>
</div>
<div class="paragraph">
<p>The simple <em>Health Check</em> includes 3 checks. As long as any of these steps fails, the <em>Generate</em> menu entry is grayed out.</p>
</div>
<div class="paragraph">
<p>The first step is to check whether the generation configuration is available at all. If this check fails you will see the following message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_no_templates.png" alt="health check no templates"></span></p>
</div>
<div class="paragraph">
<p>This indicates, that there is no Project named <em>CobiGen_Templates</em> available in the current workspace. To run CobiGen appropriately, it is necessary to have a configuration project named <em>CobiGen_Templates</em> imported into your workspace. For more information see chapter <a href="cobigen-eclipse_installation#Installation-steps.adoc">Eclipse Installation</a>.</p>
</div>
<div class="paragraph">
<p>The second step is to check whether the template project includes a valid <em>context.xml</em>. If this check fails, you will see the following message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_invalid_config.png" alt="health check invalid config"></span></p>
</div>
<div class="paragraph">
<p>This means that either your <em>context.xml</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p>does not exist (or has another name)</p>
</li>
<li>
<p>or it is not valid one in any released version of CobiGen</p>
</li>
<li>
<p>or there is simply no automatic routine of upgrading your context configuration to a valid state.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If all this is not the case, such as, there is a <em>context.xml</em>, which can be successfully read by CobiGen, you might get the following information:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_old_context.png" alt="health check old context"></span></p>
</div>
<div class="paragraph">
<p>This means that your <em>context.xml</em> is available with the correct name but it is outdated (belongs to an older CobiGen version). In this case just click on <em>Upgrade Context Configuration</em> to get the latest version.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><strong>Remark:</strong> This will create a backup of your current context configuration and converts your old configuration to the new format. The upgrade will remove all comments from the file, which could be retrieved later on again from the backup.
If the creation of the backup fails, you will be asked to continue or to abort.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The third step checks whether there are templates for the selected element(s). If this check fails, you will see the following message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_no_matching_triggers.png" alt="health check no matching triggers"></span></p>
</div>
<div class="paragraph">
<p>This indicates, that there no trigger has been activated, which matches the current selection. The reason might be that your selection is faulty or that you imported the wrong template project (e.g. you are working on a devon4j project, but imported the Templates for the Register Factory). If you are a template developer, have a look at the  <a href="cobigen-core_configuration#trigger-node.adoc">trigger configuration</a> and at the corresponding available plug-in implementations of triggers, like e.g., <a href="cobigen-javaplugin#Trigger-extension.adoc">Java Plug-in</a> or <a href="cobigen-xmlplugin#Trigger-extension.adoc">XML Plug-in</a>.</p>
</div>
<div class="paragraph">
<p>If all the checks are passed you see the following message:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_all_OK.png" alt="health check all OK"></span></p>
</div>
<div class="paragraph">
<p>In this case everything is OK and the <em>Generate</em> button is not grayed out anymore so that you are able to trigger it and see the <a href="#simple-mode">Simple Mode</a>.</p>
</div>
<div class="paragraph">
<p>In addition to the basic check of the context configuration, you also have the opportunity to perform an  <em>Advanced Health Check</em>, which will check all available templates configurations (<em>templates.xml</em>) of path-depth=1 from the configuration project root according to their compatibility.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/eclipse/health_check_advanced_up_to_date.png" alt="health check advanced up to date"></span></p>
</div>
<div class="paragraph">
<p>Analogous to the upgrade of the <em>context configuration</em>, the <em>Advanced Health Check</em> will also provide upgrade functionality for <em>templates configurations</em> if available.</p>
</div>
</div>
<div class="sect4">
<h5 id="update-templates"><a class="anchor" href="#update-templates"></a>Update Templates</h5>
<div class="paragraph">
<p>Update Template: Select Entity file and right click then select CobiGen Update Templates after that click on download then download successfully message will be come .</p>
</div>
</div>
<div class="sect4">
<h5 id="adapt-templates"><a class="anchor" href="#adapt-templates"></a>Adapt Templates</h5>
<div class="paragraph">
<p>Adapt Template: Select any file and right click, then select `cobigen &#8594; <em>Adapt Templates</em> `.If CobiGen templates jar is not available then it downloads them automatically. If CobiGen templates is already present then it will override existing template in workspace and click on OK then imported template successfully message will be come.</p>
</div>
<div class="paragraph">
<p>Finally, please change the Java version of the project to 1.8 so that you don&#8217;t have any compilation errors.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Logging</p>
</div>
<div class="paragraph">
<p>If you have any problem with the CobiGen eclipse plug-in, you might want to enable logging to provide more information for further problem analysis. This can be done easily by adding the <code>logback.xml</code> to the root of the CobiGen_templates configuration folder. The file should contain at least the following contents, whereas you should specify an absolute path to the target log file (at the <code>TODO</code>). If you are using the (<a href="https://github.com/devonfw/cobigen/tree/master/cobigen-templates">cobigen-templates</a> project, you might have the contents already specified but partially commented.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!-- This file is for logback classic. The file contains the configuration for sl4j logging --&gt;
&lt;configuration&gt;
    &lt;appender name="FILE" class="ch.qos.logback.core.FileAppender"&gt;
        &lt;file&gt;&lt;!-- TODO choose your log file location --&gt;&lt;/file&gt;
        &lt;encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder"&gt;
            &lt;Pattern&gt;%n%date %d{HH:mm:ss.SSS} [%thread] %-5level %logger - %msg%n
            &lt;/Pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;
    &lt;root level="DEBUG"&gt;
        &lt;appender-ref ref="FILE" /&gt;
    &lt;/root&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="how-to-2"><a class="anchor" href="#how-to-2"></a>26.6. How to</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Enterprise Architect client generation</p>
</div>
<div class="paragraph">
<p>We are going to show you <strong>how to</strong> generate source code from an <a href="http://sparxsystems.com/products/ea/">Enterprise Architect</a> diagram
using CobiGen.</p>
</div>
<div class="sect4">
<h5 id="prerequisites-2"><a class="anchor" href="#prerequisites-2"></a>Prerequisites</h5>
<div class="paragraph">
<p>If <em>CobiGen_Templates</em> is not already imported into your workspace, follow the next steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Click on the Eclipse&#8217;s menu <em>File &gt; Import &gt; Existing Projects into Workspace</em> and browse to select the <code>workspaces/main/CobiGen_Templates</code> directory.</p>
</li>
<li>
<p>Click <em>Finish</em> and you should have the <em>CobiGen_Templates</em> as a new project in Eclipse&#8217;s workspace.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also verify that you have the <strong>latest templates of CobiGen</strong>. Your templates folder must contain the <code>crud_java_ea_uml</code> folder.
If you do not see it, please follow the next steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Download the <a href="https://e-3d.capgemini.com/sites/ESC113658/proj13658/Lists/REF_release/Attachments/2/win_accumulative_patch_22062018.zip">accumulative patch</a>.</p>
</li>
<li>
<p>Open the zip file and extract its content inside the root folder of your Devonfw distribution <strong>Devon-dist_2.4.0/</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After following those steps correctly, you should have the latest version of the templates ready to use.</p>
</div>
</div>
<div class="sect4">
<h5 id="generation"><a class="anchor" href="#generation"></a>Generation</h5>
<div class="paragraph">
<p>In this tutorial, we are going to generate the entity infrastructure using as input a class diagram, modelled with <a href="http://sparxsystems.com/products/ea/">Enterprise Architect</a> (EA). First, create a class diagram, an example is shown on figure below:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/EA-gen/classdiagram.png"><img src="_images/images/howtos/EA-gen/classdiagram.png" alt="Eclipse CobiGen generation" width="500"></a>
</div>
</div>
<div class="paragraph">
<p>When you are finished, you will have to export that UML diagram into an XMI version 2.1 file. This is the file format that CobiGen understands. See below a figure showing this process:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/EA-gen/exporting.png"><img src="_images/images/howtos/EA-gen/exporting.png" alt="Eclipse CobiGen generation" width="500"></a>
</div>
</div>
<div class="paragraph">
<p>To open that window, see <a href="http://sparxsystems.com/enterprise_architect_user_guide/13.5/model_publishing/exporttoxmi.html">this</a> tutorial.</p>
</div>
<div class="paragraph">
<p>After having that exported file, change its extension from <code>xmi</code> to <code>xml</code>. Then create an <a href="https://github.com/devonfw/devon4j/wiki/tutorial-newapp">devon4j project</a> and import the exported file into the <code>core</code> of your devon4j project.</p>
</div>
<div class="paragraph">
<p>Now we are going to start the generation, right-click your exported file and select  <em>CobiGen &gt; Generate</em>, finally select the entity infrastructure increment:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/EA-gen/generating.png"><img src="_images/images/howtos/EA-gen/generating.png" alt="Eclipse CobiGen generation" width="500"></a>
</div>
</div>
<div class="paragraph">
<p>After following all these steps, your generated files should be inside <code>src\main\java</code> folder. If you want an XMI example, you will find it <a href="https://github.com/devonfw/cobigen/blob/master/cobigen/cobigen-xmlplugin/src/test/resources/testdata/integrationtest/uml-classdiag/completeUmlXmi.xml">here</a>.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Angular 8 Client Generation</p>
</div>
<div class="paragraph">
<p>The generation can create a full Angular 8 client using the devon4ng-application-template package located at <code>workspaces/examples</code> folder of the distribution. For more details about this package, please refer <a href="https://github.com/devonfw/devon4ng-application-template">here</a>.</p>
</div>
<div class="paragraph">
<p>Take into account that the TypeScript merging for CobiGen needs Node 6 or higher to be installed at your machine.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is a short introduction to the Angular generation. For a deeper tutorial including the generation of the backend, we strongly recommend you to follow <a href="files/HOW-TO-devonfw-ide-CobiGen-PoC-E2E_v3.2.pdf">this document</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="requisites"><a class="anchor" href="#requisites"></a>Requisites</h5>
<div class="paragraph">
<p>Install yarn globally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>npm install -g yarn</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="angular-8-workspace"><a class="anchor" href="#angular-8-workspace"></a>Angular 8 workspace</h5>
<div class="paragraph">
<p>The output location of the generation can be defined editing the <code><strong><em>cobigen.properties</em></strong></code> file located at <strong><em>crud_angular_client_app/templates</em></strong> folder of the <strong><em>CobiGen_Templates</em></strong> project.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/angular4-gen/ng4gen_7.png"><img src="_images/images/howtos/angular4-gen/ng4gen_7.png" alt="`cobigen.properties file`" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>By default, the output path would be into the <em>devon4ng-application-template</em> folder at the root of the devon4j project parent folder:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>root/
 |- devon4ng-application-template/
 |- devon4j-project-parent/
   |- core/
   |- server/</pre>
</div>
</div>
<div class="paragraph">
<p>However, this path can be changed, for example to <code><em>src/main/client</em></code> folder of the devon4j project:</p>
</div>
<div class="paragraph">
<p><code>relocate: ./src/main/client/${cwd}</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>root/
 |- devon4j-project-parent/
   |- core/
      |- src
        |- main
          |- client
   |- server/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the output path is chosen, copy the files of <a href="https://github.com/devonfw/devon4ng-application-template"><code>DEVON4NG-APPLICATION-TEMPLATE</code></a> repository into this output path.</p>
</div>
</div>
<div class="sect4">
<h5 id="install-node-dependencies"><a class="anchor" href="#install-node-dependencies"></a>Install Node dependencies</h5>
<div class="paragraph">
<p>Open a terminal into devon4ng-application-template copied and just run the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">yarn</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will start the installation of all node packages needed by the project into the node_modules folder.</p>
</div>
</div>
<div class="sect4">
<h5 id="generating"><a class="anchor" href="#generating"></a>Generating</h5>
<div class="paragraph">
<p>From an ETO object, right click, CobiGen &#8594; Generate will show the CobiGen wizard relative to client generation:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/angular4-gen/ng4gen_1.png"><img src="_images/images/howtos/angular4-gen/ng4gen_1.png" alt="CobiGen Client Generation Wizard" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>Check all the increments relative to Angular:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Angular devon4j URL increment is only needed for the first generations however, checking it again on next generation will not cause any problem.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As we done on other generations, we click Next to choose which fields to include at the generation or simply clicking Finish will start the generation.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/angular4-gen/ng4gen_3.png"><img src="_images/images/howtos/angular4-gen/ng4gen_3.png" alt="CobiGen Client Generation Wizard 3" width="450"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="routing-2"><a class="anchor" href="#routing-2"></a>Routing</h5>
<div class="paragraph">
<p>Due to the nature of the TypeScript merger, currently is not possible to merge properly the array of paths objects of the routings at app.routing.ts file so, this modification should be done by hand on this file. However, the import related to the new component generated is added.</p>
</div>
<div class="paragraph">
<p>This would be the generated <code>app-routing.module</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import { Routes, RouterModule } from '@angular/router';
import { LoginComponent } from './login/login.component';
import { AuthGuard } from './shared/security/auth-guard.service';
import { InitialPageComponent } from './initial-page/initial-page.component';
import { HomeComponent } from './home/home.component';
import { SampleDataGridComponent } from './sampledata/sampledata-grid/sampledata-grid.component';
//Routing array
const appRoutes: Routes = [{
    path: 'login',
    component: LoginComponent
}, {
    path: 'home',
    component: HomeComponent,
    canActivate: [AuthGuard],
    children: [{
        path: '',
        redirectTo: '/home/initialPage',
        pathMatch: 'full',
        canActivate: [AuthGuard]
    }, {
        path: 'initialPage',
        component: InitialPageComponent,
        canActivate: [AuthGuard]
    }]
}, {
    path: '**',
    redirectTo: '/login',
    pathMatch: 'full'
}];
export const routing = RouterModule.forRoot(appRoutes);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adding the following into the children object of <code>home</code>, will add into the side menu the entry for the component generated:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">{
    path: 'sampleData',
    component: SampleDataGridComponent,
    canActivate: [AuthGuard],
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">import { Routes, RouterModule } from '@angular/router';
import { LoginComponent } from './login/login.component';
import { AuthGuard } from './shared/security/auth-guard.service';
import { InitialPageComponent } from './initial-page/initial-page.component';
import { HomeComponent } from './home/home.component';
import { SampleDataGridComponent } from './sampledata/sampledata-grid/sampledata-grid.component';
//Routing array
const appRoutes: Routes = [{
    path: 'login',
    component: LoginComponent
}, {
    path: 'home',
    component: HomeComponent,
    canActivate: [AuthGuard],
    children: [{
        path: '',
        redirectTo: '/home/initialPage',
        pathMatch: 'full',
        canActivate: [AuthGuard]
    }, {
        path: 'initialPage',
        component: InitialPageComponent,
        canActivate: [AuthGuard]
    }, {
        path: 'sampleData',
        component: SampleDataGridComponent,
        canActivate: [AuthGuard],
    }]
}, {
    path: '**',
    redirectTo: '/login',
    pathMatch: 'full'
}];
export const routing = RouterModule.forRoot(appRoutes);</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/angular4-gen/ng4gen_6.png"><img src="_images/images/howtos/angular4-gen/ng4gen_6.png" alt="`APP SideMenu`" width="450"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="jwt-authentication"><a class="anchor" href="#jwt-authentication"></a><code>JWT</code> Authentication</h5>
<div class="paragraph">
<p>If you are using a backend server with <code>JWT</code> Authentication (there is a sample in <code>workspaces/folder</code> called <code><strong>sampleJwt</strong></code>) you have to specify the Angular application to use this kind of authentication.</p>
</div>
<div class="paragraph">
<p>By default the variable is set to CSRF but you can change it to <code>JWT</code> by going to the <a href="https://github.com/devonfw/devon4ng-application-template/blob/develop/src/environments/environment.ts#L10">Enviroment.ts</a> and setting <code>security: 'jwt'</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="running"><a class="anchor" href="#running"></a>Running</h5>
<div class="paragraph">
<p>First of all, run your devon4j java server by right clicking over <code>SpringBootApp.java</code> Run As &#8594; Java Application. This will start to run the <code>SpringBoot</code> server. Once you see the Started <code>SpringBoot</code> in <code>XX</code> seconds, the backend is running.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/angular4-gen/ng4gen_4.png"><img src="_images/images/howtos/angular4-gen/ng4gen_4.png" alt="Starting `SpringBoot`" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>Once the the server is running, open a Devon console at the output directory defined previously and run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ng serve --open</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will run the Angular 8 application at:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:4200</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/angular4-gen/ng4gen_5.png"><img src="_images/images/howtos/angular4-gen/ng4gen_5.png" alt="Running Angular 8 app" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>Once finished, the browser will open automatically at the previous localhost URL showing the Angular 8 application, using the credentials set at the devon4j java server you will be able to access.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Ionic client generation</p>
</div>
<div class="paragraph">
<p>We are going to show you <strong>how to</strong> generate a CRUD Ionic application from an <strong>ETO</strong>
using CobiGen.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is a short introduction to the Ionic generation. For a deeper tutorial including the generation of the backend, we strongly recommend you to follow <a href="files/HOW-TO-devonfw-ide-CobiGen-PoC-E2E_v3.2.pdf">this document</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="prerequisites-3"><a class="anchor" href="#prerequisites-3"></a>Prerequisites</h5>
<div class="paragraph">
<p>Before starting, make sure you already have in your computer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://ionicframework.com/docs/installation/cli">Ionic</a>: by following the steps defined on that page.
It includes installing:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://nodejs.org/en/">NodeJS</a>: We have to use "NPM" for downloading packages.</p>
</li>
<li>
<p>Ionic CLI.</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://capacitor.ionicframework.com/docs/getting-started/">Capacitor</a>: Necessary to access to native device features.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If <em>CobiGen_Templates</em> are not already downloaded, follow the next steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Right click on any file of your workspace <em>CobiGen &gt; Update Templates</em> and now you are able to start the generation.</p>
</li>
<li>
<p>If you want to adapt them, click <em>Adapt Templates</em> and you should have the <em>CobiGen_Templates</em> as a new project in Eclipse&#8217;s workspace.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After following those steps correctly, you should have the latest version of the templates ready to use.</p>
</div>
</div>
<div class="sect4">
<h5 id="generation-2"><a class="anchor" href="#generation-2"></a>Generation</h5>
<div class="paragraph">
<p>We are going to generate the CRUD into a <strong>sample application</strong> that we have developed for
testing this functionality. It is present on your <code>workspaces/examples</code> folder (devon4ng-ionic-application-template). If you do not see it, you can clone or download it from <a href="https://github.com/devonfw/devon4ng-ionic-application-template">here</a>.</p>
</div>
<div class="paragraph">
<p>After having that sample app, please create an <a href="https://github.com/devonfw/devon4ng/wiki/tutorial-newapp">devon4j project</a> and then start implementing the ETO: You will find an example <a href="https://github.com/devonfw/devon4j/blob/develop/samples/core/src/main/java/io/devonfw/gastronomy/restaurant/tablemanagement/logic/api/to/TableEto.java">here</a>.</p>
</div>
<div class="paragraph">
<p>As you can see, <code>TableEto</code> contains 3 attributes: 2 of them are <code>Long</code> and the third one <code>TableState</code> is an enum that you will find
<a href="https://github.com/devonfw/devon4j/blob/develop/samples/core/src/main/java/io/devonfw/gastronomy/restaurant/tablemanagement/common/api/datatype/TableState.java">here</a>.
The Ionic generation works fine for any Java primitive attribute (Strings, floats, chars, boolean&#8230;&#8203;) and enums. However, if you want to use your own objects, you should
override the <code>toString()</code> method, as explained <a href="https://stackoverflow.com/questions/35361482/typescript-override-tostring">here</a>.</p>
</div>
<div class="paragraph">
<p>The attributes explained above will be used for generating a page that shows a list. Each item of that list
will show the values of those attributes.</p>
</div>
<div class="paragraph">
<p>For generating the files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Right click your ETO file and click on <em>CobiGen &gt; Generate</em> as shown on the figure below.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/rightClick.png"><img src="_images/images/howtos/ionic-gen/rightClick.png" alt="Eclipse CobiGen generation" width="500"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select the Ionic increments for generating as shown below. <em>Increments group a set of templates for generating
different projects</em>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong><code>Ionic List</code></strong> used for generating the page containing the list.</p>
</li>
<li>
<p><strong><code>Ionic devon4ng environments</code></strong>  is for stating the server path.</p>
</li>
<li>
<p><strong><code>Ionic i18n</code></strong> used for generating the different language translations for the <em>`translationService`</em> (currently English and Spanish).</p>
</li>
<li>
<p><strong><code>Ionic routing</code></strong> adds an app-routing.module.ts file to allow navigation similar to the one available in Angular.</p>
</li>
<li>
<p><strong><code>Ionic theme</code></strong> generates the <code>variables.scss</code> file which contains variables to style the application.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/wizardCobiGen.png"><img src="_images/images/howtos/ionic-gen/wizardCobiGen.png" alt="CobiGen Ionic Wizard" width="500"></a>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default, the generated files will be placed inside "devon4ng-ionic-application-template", next to the root of your project&#8217;s folder.
See the image below to know where they are generated. For <strong>changing the generation path</strong> and the name of the application go to <code><em>CobiGen_Templates/crud_ionic_client_app/cobigen.properties</em></code>.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/pathOfGeneration.png"><img src="_images/images/howtos/ionic-gen/pathOfGeneration.png" alt="Generation path" width="500"></a>
</div>
</div>
<div class="paragraph">
<p>Now that we have generated the files, lets start testing them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First change the <strong>SERVER_URL</strong> of your application. For doing that, modify <code><em>src/environments/environments.ts</em></code>, also modify <code><em>src/environments/environments.android.ts</em></code> (android) and <code><em>src/environments/environments.prod.ts</em></code> (production) if you want to test in different environments.</p>
</li>
<li>
<p>Check that there are no duplicated imports. Sometimes there are duplicated imports in <code><em>src/app/app.module.ts</em></code>.
This happens because the merger of CobiGen prefers to duplicate rather than to delete.</p>
</li>
<li>
<p>Run <code>npm install</code> to install all the required dependencies.</p>
</li>
<li>
<p>Run <code>`ionic serve</code> on your console.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After following all these steps your application should start. However, remember that you will need your <strong>server</strong> to be running for access to the list page.</p>
</div>
</div>
<div class="sect4">
<h5 id="running-it-on-android"><a class="anchor" href="#running-it-on-android"></a>Running it on Android</h5>
<div class="paragraph">
<p>To run the application in an android emulated device, it is necessary to have Android Studio and Android SDK. After its installation, the following commands have to be run on your console:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>npx cap init "name-for-the-app (between quotes)" "id-for-the-app (between quotes)"</code></p>
</li>
<li>
<p><code>ionic build --configuration=android</code>. To use this command, you must add an android build configuration at angular.json</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>    "build": {
      ...
      "configurations": {
        ...
        "android": {
          "fileReplacements": [
            {
              "replace": "src/environments/environment.ts",
              "with": "src/environments/environment.android.ts"
            }
          ]
        },
      }
    }</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>npx cap add android</code></p>
</li>
<li>
<p><code>npx cap copy</code></p>
</li>
<li>
<p><code>npx cap open android</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The last steps are done in Android studio: make the project, make the app, build and APK and run in a device.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/and-vsc-make.png"><img src="_images/images/howtos/ionic-gen/and-vsc-make.png" alt="Click on make project" width="500"></a>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/and-vsc-make-app.png"><img src="_images/images/howtos/ionic-gen/and-vsc-make-app.png" alt="click on make app" width="500"></a>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/and-vsc-build-apk.png"><img src="_images/images/howtos/ionic-gen/and-vsc-build-apk.png" alt="click on build APK" width="500"></a>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/ionic-gen/and-vsc-build-run.png"><img src="_images/images/howtos/ionic-gen/and-vsc-build-run.png" alt="click on running device" width="500"></a>
</div>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Implementing a new Plug-in</p>
</div>
<div class="paragraph">
<p>New plug-ins can implement an input reader, a merger, a matcher, a trigger interpreter, and/or a template engine as explained <a href="cobigen-core_development#extension-mechanism">here</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is discouraged to have <code>cobigen-core</code> dependencies at runtime, except for <code>cobigen-core-api</code> which definitely must be present.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="plugin-activator"><a class="anchor" href="#plugin-activator"></a>Plugin Activator</h5>
<div class="paragraph">
<p>Each plug-in has to have an plug-in activator class implementing the interface <code>GeneratorPluginActivator</code> from the <code>core-api</code>. This class will be used to load the plug-in using the <code>PluginRegistry</code> as explained <a href="cobigen-core_development#loadplugin">here</a>. This class implements two methods:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>bindMerger()</code> &#8594; returns a mapping of merge strategies and its implementation to be registered.</p>
</li>
<li>
<p><code>bindTriggerInterpreter()</code>&#8594; returns the trigger interpreters to be provided by this plug-in.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Both methods create and register instances of mergers and trigger interpreters to be provided by the new plug-in.</p>
</div>
</div>
<div class="sect4">
<h5 id="adding-trigger-interpreter"><a class="anchor" href="#adding-trigger-interpreter"></a>Adding Trigger Interpreter</h5>
<div class="paragraph">
<p>The trigger interpreter has to implement the <code>TriggerInterpreter</code> interface from the core. The trigger interpreter defines the type for the new plugin and creates new <code>InputReader</code> and new Matcher objects.</p>
</div>
</div>
<div class="sect4">
<h5 id="adding-input-reader"><a class="anchor" href="#adding-input-reader"></a>Adding Input Reader</h5>
<div class="paragraph">
<p>The input reader is responsible of read the input object and parse it into
 FreeMarker models. The input reader must be implemented for the type of the
 input file. If there is any existent plugin that has the same file type as input,
 there will be no need to add a new input reader to the new plug-in.</p>
</div>
<div class="sect5">
<h6 id="input-reader-interface"><a class="anchor" href="#input-reader-interface"></a>Input Reader Interface</h6>
<div class="paragraph">
<p>The interface needed to add a new input reader is defined at the core. Each new
sub plug-in must implements this interface if is needed an input reader for it.</p>
</div>
<div class="paragraph">
<p>The interface implements the basic methods that an input reader must have,
but if additional methods are required, the developer must add a new interface
that extends the original interface <strong><em>`InputReader.java`</em></strong> from the <code>core-api</code>
and implement that on the sub plug-in.</p>
</div>
<div class="paragraph">
<p>The methods to be implemented by the input reader of the new sub plugin are:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>isValidInput(Object input)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>boolean</strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This function will be called if matching triggers or matching templates should be retrieved for a given input object.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>createModel(Object input)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Map&lt;String, Object&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This function should create the FreeMarker object model from the given input.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>combinesMultipleInputObjects(Object input)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>boolean</strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">States whether the given input object combines multiple input objects to be used for generation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getInputObjects(Object input, Charset inputCharset)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>List&lt;Object&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Will return the set of combined input objects if the given input combines multiple input objects.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getTemplateMethods(Object input)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Map&lt;String, Object&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This method returns available template methods from the plugins as Map. If the plugin which corresponds to the input does not provide any template methods an empty Map will be returned.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getInputObjectsRecursively(Object input, Charset inputCharset)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>List&lt;Object&gt;</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Will return the set of combined input objects if the given input combines multiple input objects.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect5">
<h6 id="model-constants"><a class="anchor" href="#model-constants"></a>Model Constants</h6>
<div class="paragraph">
<p>The Input reader will create a model for FreeMarker. A FreeMarker model must
have variables to use them at the <code>.ftl</code> template file. Refer to <a href="cobigen-javaplugin#java-input-reader">Java Model</a> to see the FreeMarker model example for java input files.</p>
</div>
</div>
<div class="sect5">
<h6 id="registering-the-input-reader"><a class="anchor" href="#registering-the-input-reader"></a>Registering the Input Reader</h6>
<div class="paragraph">
<p>The input reader is an object that can be retrieved using the correspondent get
 method of the trigger interpreter object. The trigger interpreter object is
 loaded at the eclipse plug-in using the load plug-in method explained
 <a href="cobigen-core_development#loadplugin">here</a>.
 That way, when the core needs the input reader, only needs to call that <code>getInputReader</code> method.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="adding-matcher"><a class="anchor" href="#adding-matcher"></a>Adding Matcher</h5>
<div class="paragraph">
<p>The matcher implements the <code>MatcherInterpreter</code> interface from the <code>core-api</code>.
Should be implemented for providing a new input matcher. Input matcher are
defined as part of a trigger and provide the ability to restrict specific
inputs to a set of templates.
This restriction is implemented with a <code>MatcherType</code> <code>enum</code>.</p>
</div>
<div class="paragraph">
<p>E.g <code>JavaPlugin</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private enum MatcherType {
    /** Full Qualified Name Matching */
    FQN,
    /** Package Name Matching */
    PACKAGE,
    /** Expression interpretation */
    EXPRESSION
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Furthermore, matchers may provide several variable assignments, which might be
dependent on any information of the matched input and thus should be resolvable
by the defined matcher.</p>
</div>
<div class="paragraph">
<p>E.g <code>JavaPlugin</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">private enum VariableType {
    /** Constant variable assignment */
    CONSTANT,
    /** Regular expression group assignment */
    REGEX
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="adding-merger"><a class="anchor" href="#adding-merger"></a>Adding Merger</h5>
<div class="paragraph">
<p>The merger is responsible to perform merge action between new output with the
existent data at the file if it already exists. Must implement the Merger
interface from the <code>core-api</code>.
The implementation of the Merge interface must override the following methods:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Method</th>
<th class="tableblock halign-left valign-top">Return Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>getType()</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>String</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Returns the type, this merger should handle.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>merge(File base, String patch, String targetCharset)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>String</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Merges the patch into the base file.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Is important to know that any exception caused by the merger must throw a <code>MergeException</code> from the <code>core-api</code> to the eclipse-plugin handle it.</p>
</div>
</div>
<div class="sect4">
<h5 id="changes-since-eclipse-maven-3-x"><a class="anchor" href="#changes-since-eclipse-maven-3-x"></a>Changes since Eclipse / Maven 3.x</h5>
<div class="paragraph">
<p>Since version 3.x the Eclipse and Maven plugins of CobiGen utilize the Java <code>ServiceLoader</code> mechanic to find and register plugins at runtime. To enable a new plugin to be discovered by this mechanic the following steps are needed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>create the file <code>META-INF/services/com.devonfw.cobigen.api.extension.GeneratorPluginActivator</code> containing just the full qualified name of the class implementing the <code>GeneratorPluginActivator</code> interface, if the plugin provides a <code>Merger</code> and/or a <code>TriggerInterpreter</code></p>
</li>
<li>
<p>create the file <code>META-INF/services/com.devonfw.cobigen.api.extension.TextTemplateEngine</code> containing just the full qualified name of the class implementing the <code>TextTemplateEngine</code> interface, if provided by the plugin</p>
</li>
<li>
<p>include <code>META-INF</code> into the target bundle (i.e. the folder <code>META-INF</code> has to be present in the target jar file)</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Example: Java Plugin</div>
<div class="paragraph">
<p>The java plugin provides both a <code>Merger</code> and a <code>TriggerInterpreter</code>. It contains therefore a <code>com.devonfw.cobigen.api.extension.GeneratorPluginActivator</code> file with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>com.devonfw.cobigen.javaplugin.JavaPluginActivator</code></pre>
</div>
</div>
<div class="paragraph">
<p>This makes the <code>JavaPluginActivator</code> class discoverable by the <code>ServiceLoader</code> at runtime.</p>
</div>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>to properly include the plugin into the current system and use existing infrastructure, you need to add the plugin as a module in <code>/cobigen/pom.xml</code> (in case of a <code>Merger</code>/<code>TriggerInterpreter</code> providing plugin) and declare that as the plugin&#8217;s parent in it&#8217;s own <code>pom.xml</code> via</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;parent&gt;
    &lt;groupId&gt;com.devonfw&lt;/groupId&gt;
    &lt;artifactId&gt;cobigen-parent&lt;/artifactId&gt;
    &lt;version&gt;dev-SNAPSHOT&lt;/version&gt;
&lt;/parent&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>or <code>/cobigen/cobigen-templateengines/pom.xml</code> (in case of a <code>Merger</code>/<code>TriggerInterpreter</code> providing plugin) and declare that as the plugin&#8217;s parent in it&#8217;s own <code>pom.xml</code> via</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;parent&gt;
    &lt;groupId&gt;com.devonfw&lt;/groupId&gt;
    &lt;artifactId&gt;cobigen-tempeng-parent&lt;/artifactId&gt;
    &lt;version&gt;dev-SNAPSHOT&lt;/version&gt;
&lt;/parent&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the plugin provides both just use the <code>/cobigen/pom.xml</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The dependencies of the plugin are included in the bundle</p>
</li>
<li>
<p>To make the plugin available to the Eclipse plugin it must be included into the current <code>compositeContent.xml</code> and <code>compositeArtifacts.xml</code> files. Both files are located in <a href="https://github.com/devonfw/cobigen/tree/gh-pages/updatesite/stable"><code>https://github.com/devonfw/cobigen/tree/gh-pages/updatesite/{test|stable}</code></a>. To do so, add an <code>&lt;child&gt;</code> entry to the <code>&lt;children&gt;</code> tag in both files and adapt the <code>size</code> attribute to match the new number of references. The <code>location</code> attribute of the new <code>&lt;child&gt;</code> tag needs to be the artifact id of the plugins <code>pom.xml</code>.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Example: Java Plugin</div>
<div class="paragraph">
<p>In case of the Java plugin, the entry is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;child location="cobigen-javaplugin"/&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect5">
<h6 id="deployment-3"><a class="anchor" href="#deployment-3"></a>Deployment</h6>
<div class="paragraph">
<p>If you want to create a test release of eclipse you need to run the command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">sh deploy.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>on the cloned CobiGen repository while making sure, that your current version of CobiGen cloned is a snapshot version. This will automatically be detected by the deploy script.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Introduction to CobiGen external plug-ins</p>
</div>
<div class="paragraph">
<p>Since September of 2019, a major change on CobiGen has taken place. CobiGen is written in Java code and previously, it was very hard for developers to create new plug-ins in other languages.</p>
</div>
<div class="paragraph">
<p>Creating a new plug-in means:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Being able to parse a file in that language.</p>
</li>
<li>
<p>Create a human readable model that can be used to generate templates (by retrieving properties from the model).</p>
</li>
<li>
<p>Enable merging files, so that user&#8217;s code does not get removed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the Java plug-in it was relatively easy. As you are inside the Java world, you can use multiple utilities or libraries in order to get the <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">AST</a> or to merge Java code. With this new feature, we wanted that behaviour to be possible for any programming language.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="general-intuition"><a class="anchor" href="#general-intuition"></a>General intuition</h5>
<div class="paragraph">
<p>Below you will find a very high level description of how CobiGen worked in previous versions:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/oldCobiGen.png"><img src="_images/images/howtos/todo-plugin/oldCobiGen.png" alt="Old CobiGen" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>Basically, when a new input file was sent to CobiGen, it called the input reader to create a model of it (see <a href="https://github.com/devonfw/cobigen/wiki/cobigen-tsplugin#object-model">here</a> an example of a model). That model was sent to the template engine.</p>
</div>
<div class="paragraph">
<p>Afterwards, the template engine generated a new file which had to be merged with the original one. All this code was implemented in Java.</p>
</div>
<div class="paragraph">
<p>On the new version, we have implemented a handler (<code>ExternalProcessHandler</code>) which connects through TCP/IP connection to a server (normally on localhost:5000). This server can be implemented in any language (.Net, Node.js, Python&#8230;&#8203;) it just needs to implement a REST API defined <a href="https://github.com/devonfw/cobigen-template-plugin/blob/master/APIContract.yml">here</a>. The most important services are the input reading and merging:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/newCobiGen.png"><img src="_images/images/howtos/todo-plugin/newCobiGen.png" alt="New CobiGen" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>CobiGen acts as a client that sends requests to the server in order to read the input file and create a model. The model is returned to the template engine so that it generates a new file. Finally, it is sent back to get merged with the original file.</p>
</div>
</div>
<div class="sect4">
<h5 id="how-to-create-new-external-plug-in"><a class="anchor" href="#how-to-create-new-external-plug-in"></a>How to create new external plug-in</h5>
<div class="paragraph">
<p>The creation of a new plug-in consists mainly in three steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creation of the server (external process).</p>
</li>
<li>
<p>Creation of a CobiGen plug-in.</p>
</li>
<li>
<p>Creation of templates.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="server-external-process"><a class="anchor" href="#server-external-process"></a>Server (external process)</h6>
<div class="paragraph">
<p>The server can be programmed in any language that is able to implement REST services endpoints. The API that needs to implement is defined with <a href="https://github.com/devonfw/cobigen-template-plugin/blob/master/APIContract.yml">this contract</a>. You can paste the content to <a href="https://editor.swagger.io/" class="bare">https://editor.swagger.io/</a> for a better look.</p>
</div>
<div class="paragraph">
<p>We have already created a NestJS server that implements the API defined above. You can find the code <a href="https://github.com/devonfw/cobigen-devon4node-server/blob/master/cobigen-nest-server/src/processmanagement/processmanagement.controller.ts">here</a> which you can use as an example.</p>
</div>
<div class="paragraph">
<p>As you can see, the endpoints have the following naming convention: <code>processmanagement/todoplugin/nameOfService</code> where you will have to change <code>todo</code> to your plug-in name (e.g. <code>rustplugin</code>, <code>pyplugin</code>, <code>goplugin</code>&#8230;&#8203;)</p>
</div>
<div class="paragraph">
<p>When implementing service <code>getInputModel</code> which returns a model from the input file there are only two restrictions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>path</code> key must be added. Its value can be the full path of the input file or just the file name. It is needed because in CobiGen there is a <a href="https://github.com/devonfw/cobigen/wiki/eclipse-plugin_development#batch-mode">batch mode</a>, in which you can have multiple input objects inside the same input file. You do not need to worry about batch mode for now.</p>
</li>
<li>
<p>On the root of your model, for each found key that is an object (defined with brackets <code>[{}]</code>), CobiGen will try to use it as an input object. For example, this could be a valid model:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JSON hljs" data-lang="JSON">{
  "path": "example/path/employee.entity.ts"
  "classes": [
    {
      "identifier": "Employee",
      "modifiers": [
        "export"
      ],
      "decorators": [
        {
          "identifier": {
            "name": "Entity",
            "module": "typeorm"
          },
          "isCallExpression": true
        }
      ],
      "properties": [
        {
          "identifier": "id",
    ...
    ...
    ...
    }]
    "interfaces": [{
        ...
    }]
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For this model, CobiGen would use as input objects all the <code>classes</code> and <code>interfaces</code> defined. On the templates we would be able to do <code>model.classes[0].identifier</code> to get the class name. These input objects depend on the language, therefore you can use any key.</p>
</div>
<div class="paragraph">
<p>In order to test the server, you will have to deploy it on your local machine (localhost), default port is 5000. If that port is already in use, you can deploy it on higher port values (5001, 5002&#8230;&#8203;). Nevertheless, we explain <a href="#testing_phase">later</a> the testing process as you need to complete the next step before.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Your server must accept one argument when running it. The argument will be the port number (as an integer). This will be used for CobiGen in order to handle blocked ports when deploying your server. Check this <a href="https://github.com/devonfw/cobigen-devon4node-server/blob/master/cobigen-nest-server/src/main.ts#L47">code</a> to see how we implemented that argument on our NestJS server.
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="cobigen-plug-in"><a class="anchor" href="#cobigen-plug-in"></a>CobiGen plug-in</h6>
<div class="paragraph">
<p>You will have to create a new CobiGen plug-in that connects to the server. But <strong>do not worry</strong>, you will not have to implement anything new. We have a CobiGen plug-in template available, the only changes needed are renaming files and setting some properties on the pom.xml. Please follow these steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Get the CobiGen plug-in template from <a href="https://github.com/devonfw/cobigen-template-plugin">here</a>. It is a template repository (new GitHub feature), so you can click on "Use this template" as shown below:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/usePluginTemplate.png"><img src="_images/images/howtos/todo-plugin/usePluginTemplate.png" alt="Plugin CobiGen template" width="550"></a>
</div>
</div>
</li>
<li>
<p>Name your repo as <code>cobigen-name-plugin</code> where <code>name</code> can be python, rust, go&#8230;&#8203; In our case we will create a <code>nest</code> plug-in. It will create a repo with only one commit which contains all the needed files.</p>
</li>
<li>
<p>Clone your just created repo and import folder <code>cobigen-todoplugin</code> as a Maven project on any Java IDE, though we recommend you devonfw ;)</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/importPluginEclipse.png"><img src="_images/images/howtos/todo-plugin/importPluginEclipse.png" alt="Import plugin" width="450"></a>
</div>
</div>
</li>
<li>
<p>Rename all the <code>todoplugin</code> folders, files and class names to <code>nameplugin</code>. In our case <code>nestplugin</code>. In Eclipse you can easily rename by right clicking and then refactor &#8594; rename:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/renamePlugin.png"><img src="_images/images/howtos/todo-plugin/renamePlugin.png" alt="Rename plugin" width="450"></a>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We recommend you to select all the checkboxes
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/renameCheckbox.png"><img src="_images/images/howtos/todo-plugin/renameCheckbox.png" alt="Rename checkbox" width="450"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Remember to change in <code>src/main/java</code> and <code>src/test/java</code> all the package, files and class names to use your plug-in name. The final result would be:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/packageStructure.png"><img src="_images/images/howtos/todo-plugin/packageStructure.png" alt="Package structure" width="300"></a>
</div>
</div>
</li>
<li>
<p>Now we just need to change some strings, this is needed for CobiGen to register all the different plugins (they need unique names). In class <code>TodoPluginActivator</code> (in our case <code>NestPluginActivator</code>), change all the <code>todo</code> to your plug-in name. See below the 3 strings that need to be changed:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/pluginActivator.png"><img src="_images/images/howtos/todo-plugin/pluginActivator.png" alt="Plugin activator" width="450"></a>
</div>
</div>
</li>
<li>
<p>Finally, we will change some properties from the <code>pom.xml</code> of the project. These properties define the server (external process) that is going to be used:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Inside <code>pom.xml</code>, press <em>Ctrl + F</em> to perform a find and replace operation. Replace all <code>todo</code> with your plugin name:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/setPomProperties.png"><img src="_images/images/howtos/todo-plugin/setPomProperties.png" alt="Pom properties" width="550"></a>
</div>
</div>
</li>
<li>
<p>We are going to explain the server properties:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p><code>artifactId</code>: This is the name of your plug-in, that will be used for a future release on Maven Central.</p>
</li>
<li>
<p>plugin.name: does not need to be changed as it uses the property from the <code>artifactId</code>. When connecting to the server, it will send a request to <code>localhost:5000/{plugin.name}plugin/isConnectionReady</code>, that is why it is important to use an unique name for the plug-in.</p>
</li>
<li>
<p>server.name: This defines how the server executable (<em>.exe</em>) file will be named. This <em>.exe</em> file contains all the needed resources for deploying the server. You can use any name you want.</p>
</li>
<li>
<p>server.version: You will specify here the server version that needs to be used. The <em>.exe</em> file will be named as <code>{server.name}-{server.version}.exe</code>.</p>
</li>
<li>
<p>server.url: This will define from where to download the server. We <strong>really</strong> recommend you using NPM which is a package manager we know it works well. We explain <a href="#release_server">here</a> how to release the server on NPM. This will download the <em>.exe</em> file for Windows.</p>
</li>
<li>
<p>server.url.linux: Same as before, but this should download the <em>.exe</em> file for Linux systems. If you do not want to implement a Linux version of the plug-in, just use the same URL from Windows or MacOS.</p>
</li>
<li>
<p>server.url.macos: Same as before, but this should download the <em>.exe</em> file for MacOS systems. If you do not want to implement a MacOS version of the plug-in, just use the same URL from Linux or Windows.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="testing_phase"><a class="anchor" href="#testing_phase"></a>Testing phase</h5>
<div class="paragraph">
<p>Now that you have finished with the implementation of the server and the creation of a new CobiGen plug-in, we are going to explain how you can test that everything works fine:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deploy the server on port 5000.</p>
</li>
<li>
<p>Run <code>mvn clean test</code> on the CobiGen-plugin or run the JUnit tests directly on Eclipse.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If the server and the plug-in are working properly, some tests will pass and other will fail (we need to tweak them).</p>
</li>
<li>
<p>If every test fails, something is wrong in your code.</p>
</li>
</ol>
</div>
</li>
<li>
<p>In order to fix the failing tests, go to <code>src/test/java</code>. The failing tests make use of sample input files that we added in sake of example:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/failingTest.png"><img src="_images/images/howtos/todo-plugin/failingTest.png" alt="Pom properties" width="550"></a>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Replace those files (on <code>src/test/resources/testadata/unittest/files/&#8230;&#8203;</code>) with the correct input files for your server.</p>
</div>
</div>
<div class="sect4">
<h5 id="releasing"><a class="anchor" href="#releasing"></a>Releasing</h5>
<div class="paragraph">
<p>Now that you have already tested that everything works fine, we are going to explain how to release the server and the plug-in.</p>
</div>
<div class="sect5">
<h6 id="release_server"><a class="anchor" href="#release_server"></a>Release the server</h6>
<div class="paragraph">
<p>We are going to use <a href="https://www.npmjs.com/">NPM</a> to store the executable of our server. Even though NPM is a package manager for JavaScript, it can be used for our purpose.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Get the CobiGen server template from <a href="https://github.com/devonfw/cobigen-template-server">here</a>. It is a template repository (new GitHub feature), so you can click on "Use this template" as shown below:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/useServerTemplate.png"><img src="_images/images/howtos/todo-plugin/useServerTemplate.png" alt="Server CobiGen template" width="550"></a>
</div>
</div>
</li>
<li>
<p>Name your repo as <code>cobigen-name-server</code> where <code>name</code> can be python, rust, go&#8230;&#8203; In our case we will create a <code>nest</code> plug-in. It will create a repo with only one commit which contains all the needed files.</p>
</li>
<li>
<p>Clone your just created repo and go to folder <code>cobigen-todo-server</code>. It will just contain two files: <em>ExternalProcessContract.yml</em> is the OpenAPI definition which you can modify with your own server definition (this step is optional), and <em>package.json</em> is a file needed for NPM in order to define where to publish this package:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JSON hljs" data-lang="JSON">{
  "name": "@devonfw/cobigen-todo-server",
  "version": "1.0.0",
  "description": "Todo server to implement the input reader and merger for CobiGen",
  "author": "CobiGen Team",
  "license": "Apache"
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Those are the default properties. This would push a new package <code>cobigen-todo-server</code> on the <code>devonfw</code> organization, with version 1.0.0. We have no restrictions here, you can use any organization, though we always recommend devonfw.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Remember to change all the <code>todo</code> to your server name.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Add your executable file into the <code>cobigen-todo-server</code> folder, just like below. As we said previously, this <em>.exe</em> is the server ready to be deployed.</p>
<div class="listingblock">
<div class="content">
<pre>cobigen-template-server/
 |- cobigen-todo-server/
   |- ExternalProcessContract.yml
   |- package.json
   |- todoserver-1.0.0.exe</pre>
</div>
</div>
</li>
<li>
<p>Finally, we have to publish to NPM. If you have never done it, you can follow this <a href="https://www.freecodecamp.org/news/how-to-make-a-beautiful-tiny-npm-package-and-publish-it-2881d4307f78/">tutorial</a>. Basically you need to login into NPM and run:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cmd hljs" data-lang="cmd">cd cobigen-todo-server/
npm publish --access=public</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To release Linux and MacOS versions of your plug-in, just add the suffix into the package name (e.g. <code>@devonfw/cobigen-todo-server-linux</code>)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>That&#8217;s it! You have published the first version of your server. Now you just need to modify the properties defined on the pom of your CobiGen plug-in. Please see next section for more information.</p>
</div>
</div>
<div class="sect5">
<h6 id="releasing-cobigen-plug-in"><a class="anchor" href="#releasing-cobigen-plug-in"></a>Releasing CobiGen plug-in</h6>
<div class="ulist">
<ul>
<li>
<p>Change the pom.xml to define all the properties. You can see below a final example for <code>nest</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">...
   &lt;groupId&gt;com.devonfw.cobigen&lt;/groupId&gt;
   &lt;artifactId&gt;nestplugin&lt;/artifactId&gt;
   &lt;name&gt;CobiGen - Nest Plug-in&lt;/name&gt;
   &lt;version&gt;1.0.0&lt;/version&gt;
   &lt;packaging&gt;jar&lt;/packaging&gt;
   &lt;description&gt;CobiGen - nest Plug-in&lt;/description&gt;

   &lt;properties&gt;
      &lt;!-- External server properties --&gt;
      &lt;plugin.name&gt;${project.artifactId}&lt;/plugin.name&gt;
      &lt;server.name&gt;nestserver&lt;/server.name&gt;
      &lt;server.version&gt;1.0.0&lt;/server.version&gt;
      &lt;server.url&gt;https\://registry.npmjs.org/@devonfw/cobigen-nest-server/-/cobigen-nest-server-${server.version}.tgz&lt;/server.url&gt;
      &lt;server.url.linux&gt;https\://registry.npmjs.org/@devonfw/cobigen-nest-server-linux/-/cobigen-nest-server-linux-${server.version}.tgz&lt;/server.url.linux&gt;
      &lt;server.url.macos&gt;https\://registry.npmjs.org/@devonfw/cobigen-nest-server-macos/-/cobigen-nest-server-macos-${server.version}.tgz&lt;/server.url.macos&gt;
...</code></pre>
</div>
</div>
</li>
<li>
<p>Deploy to Maven Central.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect4">
<h5 id="templates-creation"><a class="anchor" href="#templates-creation"></a>Templates creation</h5>
<div class="paragraph">
<p>After following above steps, we now have a CobiGen plug-in that connects to a server (external process) which reads your input files, returns a model and is able to merge files.</p>
</div>
<div class="paragraph">
<p>However, we need a key component for our plug-in to be useful. We need to define templates:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fork our CobiGen main repository, from <a href="https://github.com/devonfw/cobigen.git">here</a> and clone it into your PC. Stay in the <code>master</code> branch and import into your IDE <code>cobigen-templates\templates-devon4j</code>. Set the Java version of the project to 1.8 if needed.</p>
</li>
<li>
<p>Create a new folder on <code>src/main/templates</code>, this will contain all your templates. You can use any name, but please use underscores as separators. In our case, we created a folder <code>crud_typescript_angular_client_app</code> to generate an Angular client from a TypeORM entity (NodeJS entity).</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/templatesProject.png"><img src="_images/images/howtos/todo-plugin/templatesProject.png" alt="Templates project" width="450"></a>
</div>
</div>
</li>
<li>
<p>Inside your folder, create a <code>templates</code> folder. As you can see below, the folder structure of the generated files starts here (the sources). Also we need a configuration file <code>templates.xml</code> that should be on the same level as <code>templates/</code> folder. For now, copy and paste a <code>templates.xml</code> file from any of the templates folder.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/templatesInside.png"><img src="_images/images/howtos/todo-plugin/templatesInside.png" alt="Templates project" width="450"></a>
</div>
</div>
</li>
<li>
<p>Start creating your own templates. Our default templates language is Freemarker, but you can also use Velocity. Add the extension to the file (<code>.ftl</code>) and start developing templates! You can find useful documentation <a href="https://github.com/devonfw/cobigen/wiki/cobigen-templates_helpful-links">here</a>.</p>
</li>
<li>
<p>After creating all the templates, you need to modify <code>context.xml</code> which is located on the root of <code>src/main/templates</code>. There you need to define a trigger, which is used for CobiGen to know when to trigger a plug-in. I recommend you to copy and paste the following trigger:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">  &lt;trigger id="crud_typescript_angular_client_app" type="nest" templateFolder="crud_typescript_angular_client_app"&gt;
    &lt;matcher type="fqn" value="([^\.]+).entity.ts"&gt;
      &lt;variableAssignment type="regex" key="entityName" value="1"/&gt;
      &lt;variableAssignment type="regex" key="component" value="1"/&gt;
      &lt;variableAssignment type="constant" key="domain" value="demo"/&gt;
    &lt;/matcher&gt;
  &lt;/trigger&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Change <code>templateFolder</code> to your templates folder name. <code>id</code> you can use any, but it is recommendable to use the same as the template folder name. <code>type</code> is the <code>TRIGGER_TYPE</code> we defined above on the <code>NestPluginActivator</code> class. On <code>matcher</code> just change the <code>value</code>: <code>([^\.]+).entity.ts</code> means that we will only accept input files that contain <code>anyString.entity.ts</code>. This improves usability, so that users only generate using the correct input files. You will find more info about <code>variableAssignment</code> <a href="https://github.com/devonfw/cobigen/wiki/cobigen-core_configuration#variableassignment-node">here</a>.</p>
</li>
<li>
<p>Finally, is time to configure <code>templates.xml</code>. It is needed for organizing templates into increments, please take a look into this <a href="https://github.com/devonfw/cobigen/wiki/cobigen-core_configuration#templates-configuration">documentation</a>.</p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="testing-templates"><a class="anchor" href="#testing-templates"></a>Testing templates</h6>
<div class="ulist">
<ul>
<li>
<p>When you have finished your templates you will like to test them. On the templates-devon4j <code>pom.xml</code> remove the SNAPSHOT from the version (in our case the version will be 3.1.8). Run <code>mvn clean install -DskipTests</code> on the project. We skip tests because you need special permissions to download artifacts from our Nexus. Remember the version that has just been installed:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/templatesSnapshot.png"><img src="_images/images/howtos/todo-plugin/templatesSnapshot.png" alt="Templates snapshot version" width="550"></a>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We always recommend using the devonfw console, which already contains a working Maven version.
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>Now we have your last version of the templates ready to be used. We need to use that latest version in CobiGen. We will use the CobiGen CLI that you will find in your cloned repo, at <code>cobigen-cli/cli</code>. Import the project into your IDE.</p>
</li>
<li>
<p>Inside the project, go to <code>src/main/resources/pom.xml</code>. This pom.xml is used on runtime in order to install all the CobiGen plug-ins and templates. Add there your latest templates version and the previously created plug-in:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/cliPom.png"><img src="_images/images/howtos/todo-plugin/cliPom.png" alt="CLI pom" width="450"></a>
</div>
</div>
</li>
<li>
<p>Afterwards, run <code>mvn clean install -DskipTests</code> and CobiGen will get your plug-ins. Now you have three options to test templates:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Using Eclipse run as:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Inside Eclipse, you can run the CobiGen-CLI as a Java application. Right click class <code>CobiGenCLI.java</code> &#8594; run as &#8594; run configurations&#8230;&#8203; and create a new Java application as shown below:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/runConfigurations.png"><img src="_images/images/howtos/todo-plugin/runConfigurations.png" alt="Create configuration" width="450"></a>
</div>
</div>
</li>
<li>
<p>That will create a <code>CobiGenCLI</code> configuration where we can set arguments to the CLI. Let&#8217;s first begin with showing the CLI version, which should print a list of all plug-ins, including ours.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/runAsArgs.png"><img src="_images/images/howtos/todo-plugin/runAsArgs.png" alt="Run version" width="450"></a>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Text hljs" data-lang="Text"> ...
 name:= propertyplugin version = 2.0.0
 name:= jsonplugin version = 2.0.0
 name:= templates-devon4j version = 3.1.8
 name:= nestplugin version = 1.0.0
 ...</code></pre>
</div>
</div>
</li>
<li>
<p>If that worked, now you can send any arguments to the CLI in order to generate with your templates. Please follow <a href="https://github.com/devonfw/cobigen/wiki/howto_Cobigen-CLI-generation">this guide</a> that explains all the CLI commands.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Modify the already present JUnit tests on the CLI project: They test the generation of templates from multiple plug-ins, you can add your own tests and input files.</p>
</li>
<li>
<p>Use the CLI jar to execute commands:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The <code>mvn clean install -DskipTests</code> command will have created a Cobigen.jar inside your target folder (<em>cobigen-cli/cli/target</em>). Open the jar with any unzipper and extract to the current location <em>class-loader-agent.jar</em>, <em>cobigen.bat</em> and <em>cg.bat</em>:</p>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/todo-plugin/extractFilesCLI.png"><img src="_images/images/howtos/todo-plugin/extractFilesCLI.png" alt="Extract files" width="450"></a>
</div>
</div>
</li>
<li>
<p>Now you can run any CobiGen CLI commands using a console. <a href="https://github.com/devonfw/cobigen/wiki/howto_Cobigen-CLI-generation">This guide</a> explains all the CLI commands.</p>
<div class="imageblock">
<div class="content">
<a class="image" href=""images/howtos/todo-plugin/runningCLI.png"><img src="_images/images/howtos/todo-plugin/runningCLI.png" alt="Run CLI" width="450"></a>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect4">
<h5 id="devon4net-cobigen-guide-3"><a class="anchor" href="#devon4net-cobigen-guide-3"></a><span class="navy">devon4net CobiGen Guide</span></h5>
<div class="sect5">
<h6 id="overview-8"><a class="anchor" href="#overview-8"></a><span class="navy">Overview</span></h6>
<div class="paragraph">
<p>In this guide we will explain how to generate a new <code>WebAPI</code> project from an OpenAPI 3.0.0 specification. This  means that we are going to use a “contract first” strategy. This is going to be possible due to these type of files that contain all the information about entities, operations, etc…</p>
</div>
<div class="paragraph">
<p>In order to make it work we are using <a href="https://github.com/devonfw/cobigen">CobiGen</a>, a powerful tool for generating source code. CobiGen allows users to generate all the structure and code of the components, helping to save a lot of time otherwise wasted on repetitive tasks.</p>
</div>
</div>
<div class="sect5">
<h6 id="getting-things-ready-3"><a class="anchor" href="#getting-things-ready-3"></a><span class="navy">Getting things ready</span></h6>
<div class="sect6">
<h7 id="devonfw-ide-3"><a class="anchor" href="#devonfw-ide-3"></a><span class="navy">devonfw-IDE</span></h7>
<div class="paragraph">
<p>First, we will install the devonfw-IDE. It is a tool that will setup your IDE within minutes. Please follow the install guide <a href="https://github.com/devonfw/ide/blob/master/documentation/setup.adoc">here</a>.</p>
</div>
</div>
<div class="sect6">
<h7 id="devon4net-templates-3"><a class="anchor" href="#devon4net-templates-3"></a><span class="navy">devon4net Templates</span></h7>
<div class="paragraph">
<p>We are going to use the template of devon4net as a base to generate all the code, so what we have to do now is to download said template using the following steps.</p>
</div>
<div class="paragraph">
<p>First of all you have to set up all the environment for .NET, you can do this using <a href="https://devon4net.github.io/environment.html">the following tutorial</a>. Next we are going to create a new folder where we want to have the <code>WebAPI</code> project, lastly we are going to open the terminal there.</p>
</div>
<div class="paragraph">
<p>Type the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`dotnet new -i Devon4Net.WebAPI.Template`</pre>
</div>
</div>
<div class="paragraph">
<p>and then:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`dotnet new Devon4NetAPI`</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="openapi-file-3"><a class="anchor" href="#openapi-file-3"></a><span class="navy">OpenAPI File</span></h7>
<div class="paragraph">
<p>In order to let CobiGen generate all the files, we first have to make some modifications to our OpenAPI file.</p>
</div>
<div class="paragraph">
<p>It is obligatory to put the <em>“x-rootpackage”</em> tag to indicate where CobiGen will place the generated files as well as the <em>"x-component"</em> tags for each component, keep in mind that due to CobiGen&#8217;s limitations each component <strong><em>must</em></strong> have its own entity.</p>
</div>
<div class="paragraph">
<p>You can read more information about how to configure your OpenAPI file and a working example <a href="https://github.com/devonfw/cobigen/wiki/cobigen-openapiplugin#full-example">here</a>.</p>
</div>
</div>
</div>
<div class="sect5">
<h6 id="generating-files-3"><a class="anchor" href="#generating-files-3"></a><span class="navy">Generating files</span></h6>
<div class="paragraph">
<p>CobiGen allow us to generate the files in two different ways. One of them is using Eclipse which it can be done by using the its graphical interface. The other way to generate the code is using the CobiGen CLI tool.</p>
</div>
<div class="sect6">
<h7 id="generating-files-through-eclipse-3"><a class="anchor" href="#generating-files-through-eclipse-3"></a><span class="navy">Generating files through Eclipse</span></h7>
<div class="paragraph">
<p>In order to generate the files using Eclipse we need to follow some simple steps.</p>
</div>
<div class="paragraph">
<p>First we are going to import our basic devon4net <code>WebAPI</code> Project into Eclipse. to do so open Eclipse with the “eclipse-main.bat” file that can be found in the devon distribution root folder. Once we are inside of Eclipse we go to <strong>File &gt; Open projects from file system&#8230;&#8203;</strong> and, under "Directory", search for your project.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="="images/howtos/devon4net/Project_selection.png""><img src="_images/images/howtos/devon4net/Project_selection.png" alt="CobiGen" width="="600""></a>
</div>
</div>
<div class="paragraph">
<p>Next we copy our OpenAPI file into the root folder of the project.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="="images/howtos/devon4net/OpenAPI_file_root_folder.png""><img src="_images/images/howtos/devon4net/OpenAPI_file_root_folder.png" alt="CobiGen" width="="300""></a>
</div>
</div>
<div class="paragraph">
<p>And then we right click on OpenAPI file and then select <strong>CobiGen &gt; Generate&#8230;&#8203;</strong> It will display a window like this:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="="images/howtos/devon4net/cobigen_generate0.png""><img src="_images/images/howtos/devon4net/cobigen_generate0.png" alt="CobiGen" width="="800""></a>
</div>
</div>
<div class="paragraph">
<p>To select all .NET features choose <strong>CRUD devon4net Server</strong> otherwise you can select only those that interest you.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="="images/howtos/devon4net/cobigen_generate1.png"><img src="_images/images/howtos/devon4net/cobigen_generate1.png" alt="CobiGen" width="="800""></a>
</div>
</div>
<div class="paragraph">
<p>Ones you select all the files that you want to generate, click on the <em>“Finish”</em> button to generate all the source code.</p>
</div>
</div>
<div class="sect6">
<h7 id="generating-files-through-cobigen-cli-3"><a class="anchor" href="#generating-files-through-cobigen-cli-3"></a><span class="navy">Generating files through CobiGen CLI</span></h7>
<div class="paragraph">
<p>In order to generate the files using the CobiGen CLI it is needed to do the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to devonfw distribution folder</p>
</li>
<li>
<p>Run <strong>console.bat</strong>, this will open a console.</p>
</li>
<li>
<p>Go to the folder you downloaded the <strong>devon4net template</strong> and your <strong>yml</strong> file.</p>
</li>
<li>
<p>Run the command:</p>
<div class="literalblock">
<div class="content">
<pre>`cobigen generate {yourOpenAPIFile}.yml`</pre>
</div>
</div>
</li>
<li>
<p>A list of increments will be printed so that you can start the generation. It has to be selected <strong>CRUD devon4net Server</strong> increment.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect5">
<h6 id="configuration-21"><a class="anchor" href="#configuration-21"></a><span class="navy">Configuration</span></h6>
<div class="sect6">
<h7 id="data-base"><a class="anchor" href="#data-base"></a><span class="navy">Data base</span></h7>
<div class="paragraph">
<p>CobiGen is generating an empty context that has to be filled with manually in order to be able to work with the database. The context can be found in <code><strong>[Project_Name]/Devon4Net.WebAPI.Implementation/Domain/Database/CobigenContext.cs</strong></code>.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="="images/howtos/devon4net/CobigenContextLocation.png"><img src="_images/images/howtos/devon4net/CobigenContextLocation.png" alt="CobiGen" width="="350""></a>
</div>
</div>
</div>
<div class="sect6">
<h7 id="run-the-application-3"><a class="anchor" href="#run-the-application-3"></a><span class="navy">Run the application</span></h7>
<div class="paragraph">
<p>After the configuration of the database, open a terminal in path: <code><strong>[Project_Name]/Devon4Net.Application.WebAPI</strong></code> and then type:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`dotnet run`</pre>
</div>
</div>
<div class="paragraph">
<p>This will deploy our application in our localhost with the port 8082, so when you click <a href="https://localhost:8082/swagger/index.html">here</a> (<a href="https://localhost:8082/swagger" class="bare">https://localhost:8082/swagger</a>) you can see, in swagger, all the services and the data model.</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==How to update CobiGen</p>
</div>
<div class="paragraph">
<p>In order to update CobiGen from our devonfw distribution, we have two options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open Eclipse, click on <em>Help</em> &#8594; <em>Check for updates</em></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/update_CobiGen/check_updates.png"><img src="_images/images/howtos/update_CobiGen/check_updates.png" alt="Check updates" width="450"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select all the CobiGen plugins listed and click on <em>Next</em>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/update_CobiGen/all_updates.png"><img src="_images/images/howtos/update_CobiGen/all_updates.png" alt="All the updates" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>If this option is not working properly, then you can try the second option:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Open Eclipse, click on <em>Help</em> &#8594; <em>About Eclipse IDE</em>:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/update_CobiGen/about_eclipse.png"><img src="_images/images/howtos/update_CobiGen/about_eclipse.png" alt="About Eclipse" width="450"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Click on <em>Installation details</em>:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/update_CobiGen/installation_details.png"><img src="_images/images/howtos/update_CobiGen/installation_details.png" alt="Installation details" width="350"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Select all the CobiGen plugins and click on <em>Update</em>:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/update_CobiGen/details_all_udpates.png"><img src="_images/images/howtos/update_CobiGen/details_all_udpates.png" alt="All updates details" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>After the update process finishes, remember to restart Eclipse.</p>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="updating-templates"><a class="anchor" href="#updating-templates"></a>Updating templates:</h5>
<div class="paragraph">
<p>To update your CobiGen templates to the latest version, you just need to do one step:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Right click any file on your package explorer, click on <em>CobiGen</em> &#8594; <em>Update templates</em>, then click on <em>download</em>:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/howtos/update_CobiGen/update_templates.png"><img src="_images/images/howtos/update_CobiGen/update_templates.png" alt="Update templates" width="450"></a>
</div>
</div>
<div class="paragraph">
<p>Now you will have the latest templates ready!</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/cobigen.wiki/master-cobigen.adoc - include::howto-Cobigen-CLI-generation.adoc[]</p>
</div>
<!-- toc disabled -->
<div class="paragraph text-center">
<p>==End to End POC Code generation using Entity class
This article helps to create a sample application using cobigen.</p>
</div>
</div>
<div class="sect4">
<h5 id="prerequisites-4"><a class="anchor" href="#prerequisites-4"></a>Prerequisites</h5>
<div class="paragraph">
<p>Download and install devonnfw IDE <a href="https://devonfw.com/website/pages/docs/devonfw-ide-introduction.adoc.html#setup.adoc">here</a>,</p>
</div>
</div>
<div class="sect4">
<h5 id="steps-to-create-a-sample-project-using-cobigen"><a class="anchor" href="#steps-to-create-a-sample-project-using-cobigen"></a>Steps to create a Sample Project using Cobigen</h5>
<div class="paragraph">
<p>The HOW_TO is divided in 2 parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>BE-Back End generator (DB + DAO + services) – CONTRACT FIRST APPROACH</p>
</li>
<li>
<p>FE-Front End generator (Web App Angular + Ionic App) – CONTRACT FIRST APPROACH</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image9.png" alt="cobigen ionic code genartion"></span></p>
</div>
<div class="paragraph">
<p>So, ready to go! We’re going to start from the BE part …</p>
</div>
<div class="sect5">
<h6 id="back-end"><a class="anchor" href="#back-end"></a>Back End</h6>
<div class="paragraph">
<p>run \devonfw-ide-scripts-3.2.4\eclipse-main.bat</p>
</div>
<div class="paragraph">
<p>It will open eclipse</p>
</div>
<div class="paragraph">
<p>create a project using below command from the command prompt</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">devon java create com.example.domain.myapp</code></pre>
</div>
</div>
<div class="paragraph">
<p>Import the project to eclipse as maven project
<span class="image"><img src="_images/images/howtos/e2e_gen/image14.png" alt="eclipse devon"></span></p>
</div>
<div class="paragraph">
<p>Click <strong>FINISH</strong></p>
</div>
<div class="paragraph">
<p>Now We have the following 4 projects.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image15.png" alt="eclipse package explorer"></span></p>
</div>
<div class="paragraph">
<p><strong>BEFORE to start to create an Entity class, remember to create the tables !</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Create a new <strong>SQL</strong> <strong>file</strong> (i.e: V0005<em>CreateTables-ItaPoc.sql) inside </em>myapp-__core and insert the following script:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE TABLE EMPLOYEE (
id BIGINT auto_increment, modificationCounter INTEGER NOT NULL,
employeeid BIGINT auto_increment,
name VARCHAR(255),
surname VARCHAR(255),
email VARCHAR(255),
PRIMARY KEY (employeeid)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><em>WARNING</em></strong>: please note that there are 2 underscore in the name !</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image16.png" alt="sql file"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Now create another SQL file (i.e: V0006__PopulateTables-ItaPoc.sql) and add following script about the INSERT in order to populate the table created before</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong><em>WARNING</em></strong>: please note that there are 2 underscore in the name !</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO EMPLOYEE (id, modificationCounter, employeeid, name, surname,email) VALUES (1, 1, 1, 'Albert','Miller','albert.miller@capgemini.com');
INSERT INTO  EMPLOYEE (id, modificationCounter, employeeid, name, surname,email) VALUES (2, 2, 2, 'Wills','Smith', 'wills.smith@capgemini.com');
INSERT INTO EMPLOYEE (id, modificationCounter, employeeid, name, surname,email) VALUES (3, 3, 3, 'Jaime','Thomas', 'jaime.thomas@capgemini.com');</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image17.png" alt="sql insert"></span></p>
</div>
<div class="paragraph">
<p><strong>Let&#8217;s create the Entity Class for the code generation</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Create a package <strong>employeemanagement.dataaccess.api</strong> under the folder myapp-core. Note: It is important to follow this naming convention for CobiGen to work properly.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/poc-entity-package.png" alt="package"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Now create a JPA Entity class in this package</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Column;
@Entity
@javax.persistence.Table(name = "EMPLOYEE")
public class EmployeeEntity {
  @Column(name = "EMPLOYEEID")
  @GeneratedValue(strategy = GenerationType.IDENTITY)
  private Long employeeId;
  @Column(name = "NAME")
  private String name;
  @Column(name = "SURNAME")
  private String surname;
  @Column(name = "EMAIL")
  private String email;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>then generate getters and setters  for all attributes …</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>Use Cobigen to generate code. Right click on EmployeeEntity. CobiGen &#8594; Generate</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It will ask you to download the templates, click on <em>update</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image19.png" alt="cobigen generate"></span></p>
</div>
<div class="paragraph">
<p>It will automatically download the latest version of <em>CobiGen_Templates</em>.</p>
</div>
<div class="paragraph">
<p><strong>Attention:</strong> If you want to adapt the CobiGen_Templates, (normally this is not neccessary), you will find at the end of this document a tutorial on how to import them and adapt them!</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p>Click on all the option selected as below:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image20.png" alt="cobigen option selection"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="12">
<li>
<p>Click on finish. Below Screen would be seen. Click on continue</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image21.png" alt="cobigen finish"></span></p>
</div>
<div class="paragraph">
<p><strong>The entire <span class="underline">BE layer</span> structure having CRUD operation methods will be auto generated.</strong></p>
</div>
<div class="paragraph">
<p>Some classes will be generated on the api part (<em>myapp-api)</em>, normally it will be interfaces, as shown below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image22.png" alt="be layer"></span></p>
</div>
<div class="paragraph">
<p>Some other classes will be generated on the core part (<em>myapp-core)</em>, normally it will be implementations as shown below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image23.png" alt="core folder"></span></p>
</div>
<div class="paragraph">
<p><strong>BEFORE to generate the FE</strong>, please start the Tomcat server to check that BE Layer has been generated properly.</p>
</div>
<div class="paragraph">
<p>To start a server you just have to right click on <em>SpringBootApp.java</em> &#8594; <em>run as &#8594; Spring Boot app</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image24.png" alt="Eclipse run as"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image25.png" alt="Spring boot run"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image26.png" alt="Spring boot run"></span></p>
</div>
<div class="paragraph">
<p><strong>BE DONE</strong></p>
</div>
<div class="paragraph">
<p>Last but not least: We make a quick REST services test !</p>
</div>
<div class="paragraph">
<p>See in the application.properties the TCP Port and the PATH</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image27.png" alt="application properties"></span></p>
</div>
<div class="paragraph">
<p>Now compose the Rest service URL:</p>
</div>
<div class="paragraph">
<p>service class path&gt;/&lt;service method path&gt;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;server&gt; refers to server with port no. (ie: localhost:8081)</p>
</li>
<li>
<p>&lt;app&gt; is in the application.propeeties (empty in our case, see above)</p>
</li>
<li>
<p>&lt;rest service class path&gt; refers to EmployeemanagementRestService: (i.e: /employeemanagement/v1)</p>
</li>
<li>
<p>&lt;service method path&gt;/employee/{id}  (i.e: for  getEmployee method)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image28.png" alt="url mapping"></span></p>
</div>
<div class="paragraph">
<p>URL of getEmployee for this example is:</p>
</div>
<div class="paragraph">
<p>for all employees</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:8081/services/rest/employeemanagement/v1/employee/search</code></pre>
</div>
</div>
<div class="paragraph">
<p>for the specific employee</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:8081/services/rest/employeemanagement/v1/employee/1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now download <a href="https://www.getpostman.com/apps">Postman</a> to test the rest services.</p>
</div>
<div class="paragraph">
<p>Once done, you have to create a POST Request for the LOGIN and insert in the body the JSON containing the username and password <em>waiter</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image29.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Once done with success (<strong>Status: 200 OK</strong>) …</p>
</div>
<div class="paragraph">
<p>… We create a NEW GET Request in order to get one employee</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image30.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Now you can click <span class="image"><img src="_images/images/howtos/e2e_gen/image34.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Now you ‘ve to check that response has got Status: 200 OK and to see the below Employee</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image31.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Now that We have successfully tested the BE is time to go to create the FE !</p>
</div>
</div>
<div class="sect5">
<h6 id="front-end"><a class="anchor" href="#front-end"></a>Front End</h6>
<div class="paragraph">
<p>Let’s start now with angular Web and then Ionic app.</p>
</div>
<div class="sect6">
<h7 id="angular-web-app"><a class="anchor" href="#angular-web-app"></a>Angular Web App</h7>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To generate angular structure, download or clone <strong>devon4ng-application-template</strong> from</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/devon4ng-application-template</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image36.png" alt="devon dist folder"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Once done, right click on EmployeeEto.java  file present under the package <em>com.devonfw.poc.employeemanagement.logic.api.to</em></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image37.png" alt="eclipse generate"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click on Finish</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image38.png" alt="eclipse"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>The entire ANGULAR structure has been auto generated. The generated code will be merged to the existing.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image39.png" alt="angular ee layer"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>IMPORTANT now you have to add in the <strong><em>app-routing.module.ts</em></strong> file the next content, as a child of HomeComponent, in order to enable the route of the new generated component</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">,\{
path: 'employee',
component: EmployeeGridComponent,
canActivate: [AuthGuard],
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>Following picture explain where to place the above content:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image40.png" alt="routes"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Open the command prompt and execute <em>devon yarn install</em> from the base folder, which would download all the required libraries..</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Check the file <strong>environment.ts</strong> if the server path is correct. (for production you will have to change also the environment.prod.ts file)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image42.png" alt="environment"></span></p>
</div>
<div class="paragraph">
<p>In order to do that it’s important to look at the application.properties to see the values as PATH, TCP port etc …</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image43.png" alt="configure"></span></p>
</div>
<div class="paragraph">
<p>For example in this case the URL should be since the context path is empty the server URLS should be like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export const environment = {
production: false,
restPathRoot: 'http://localhost:8081/',
restServiceRoot: 'http://localhost:8081/services/rest/',
security: 'jwt'
};</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Warning</strong>: REMEMBER to set security filed to <strong>jwt</strong> , if it is not configured already.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Now run the <strong>ng serve -o</strong> command to run the Angular Application.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image44.png" alt="image44"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>If the command execution is <strong>successful</strong>, the below screen will <strong>appear</strong> and it would be automatically redirected to the url:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:4200/login</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image45.png" alt="image45"></span></p>
</div>
<div class="paragraph">
<p><strong>WebApp DONE</strong></p>
</div>
</div>
<div class="sect6">
<h7 id="ionic-mobile-app"><a class="anchor" href="#ionic-mobile-app"></a>Ionic Mobile App</h7>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To generate Ionic structure, download or clone <strong>devon4ng-application-template</strong> from</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/devon4ng-ionic-application-template</code></pre>
</div>
</div>
</li>
<li>
<p>Once done, Right click on the <strong>EmployeeEto</strong> as you already did before in order to use CobiGen.</p>
</li>
<li>
<p>Click on the selected options as seen in the screenshot:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image46.png" alt="image46"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click on Finish</p>
</li>
<li>
<p>The entire ionic structure will be auto generated.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image47.png" alt="image47"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Change the server url (with correct serve url) in environment.ts, environment.prod.ts and environment.android.ts files (i.e: itapoc\devon4ng-ionic-application-template\src\environments\).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The angular.json file inside the project has already a build configuration for android.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image48.png" alt="image48"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Run npm install in the root folder to download the dependecies</p>
</li>
<li>
<p>Run ionic serve</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image49.png" alt="image49"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p></p>
<div class="paragraph">
<p>Once the execution is successful</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image50.png" alt="image50"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mobile App DONE*</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So: well done</p>
</div>
<div class="paragraph">
<p>Starting from an Entity class you’ve successfully generated the Back-End layer (REST, SOAP, DTO, Spring services, Hibernate DAO), the Angular Web App and the Ionic mobile App!</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image51.png" alt="image51"></span></p>
</div>
<div class="sect7">
<h8 id="build-apk"><a class="anchor" href="#build-apk"></a>Build APK</h8>
<div class="paragraph">
<p>Since We’re going to create apk remember the following pre-conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://gradle.org/install/">Gradle</a></p>
</li>
<li>
<p><a href="https://developer.android.com/studio">Android Studio</a></p>
</li>
<li>
<p><a href="https://developer.android.com/studio/#command-tools">Android sdk</a></p>
</li>
<li>
<p><a href="https://capacitor.ionicframework.com/docs/getting-started/">Capacitor</a></p>
</li>
</ul>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Now, open cmd and type the path where your <em>devon4ng-ionic-application-template</em> project is present.</p>
</li>
<li>
<p>Run the following commands:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>npx cap init</p>
</li>
<li>
<p>ionic build --configuration=android</p>
</li>
<li>
<p>npx cap add android</p>
</li>
<li>
<p>npx cap copy</p>
</li>
<li>
<p>npx cap open android</p>
</li>
</ol>
</div>
</li>
<li>
<p>Build the APK using Android studio.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image52.png" alt="image52"></span>
<span class="image"><img src="_images/images/howtos/e2e_gen/image53.png" alt="image53"></span>
<span class="image"><img src="_images/images/howtos/e2e_gen/image54.png" alt="image54"></span>
<span class="image"><img src="_images/images/howtos/e2e_gen/image55.png" alt="image55"></span></p>
</div>
<div class="paragraph">
<p>You can find your apk file in</p>
</div>
<div class="paragraph">
<p>/devon4ng-ionic-application-template/android/app/build/outputs/apk/debug</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="adapt-cobigen_templates"><a class="anchor" href="#adapt-cobigen_templates"></a>Adapt CobiGen_Templates</h5>
<div class="paragraph">
<p>After following this tutorial, you will have the CobiGen_Templates downloaded on your local machine. To import these templates you need to do the following:</p>
</div>
<div class="paragraph">
<p>Right click in any part of the package explorer, then click on CobiGen &#8594; Adapt templates</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image56.png" alt="image56"></span></p>
</div>
<div class="paragraph">
<p>Click <em>Ok</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image57.png" alt="image57"></span></p>
</div>
<div class="paragraph">
<p>Now the CobiGen_Templates project will be automatically imported into your workspace, as shown on the image below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image58.png" alt="image58"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image59.png" alt="image59"></span></p>
</div>
<div class="paragraph">
<p>Now you just need to change the Java version of the project to JRE 1.8. Right click on the JRE system library, and then on <em>Properties:</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image60.png" alt="image60"></span></p>
</div>
<div class="paragraph">
<p>Now change the version to Java 1.8
<span class="image"><img src="_images/images/howtos/e2e_gen/image61.png" alt="image61"></span></p>
</div>
<div class="paragraph">
<p>Now you have successfully imported the CobiGen templates. If you want to edit them, you will find them in the folder <em>src/main/templates.</em> For instance, the Java templates are located here:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image62.png" alt="image62"></span></p>
</div>
<div class="paragraph">
<p>Now you can adapt the templates as much as you want. Documentation about this can be found on:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/tools-cobigen/wiki/Guide-to-the-Reader</code></pre>
</div>
</div>
<!-- toc disabled -->
<!-- toc disabled -->
<div class="paragraph text-center">
<p>==End to End POC Code generation using OpenAPI
This article helps to create a sample application using cobigen.</p>
</div>
</div>
<div class="sect4">
<h5 id="prerequisites-5"><a class="anchor" href="#prerequisites-5"></a>Prerequisites</h5>
<div class="paragraph">
<p>Download and install devonnfw IDE <a href="https://devonfw.com/website/pages/docs/devonfw-ide-introduction.adoc.html#setup.adoc">here</a>,</p>
</div>
</div>
<div class="sect4">
<h5 id="steps-to-create-a-sample-project-using-cobigen-2"><a class="anchor" href="#steps-to-create-a-sample-project-using-cobigen-2"></a>Steps to create a Sample Project using Cobigen</h5>
<div class="paragraph">
<p>The HOW_TO is divided in 2 parts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>BE-Back End generator (DB + DAO + services) – CONTRACT FIRST APPROACH</p>
</li>
<li>
<p>FE-Front End generator (Web App Angular + Ionic App) – CONTRACT FIRST APPROACH</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image9.png" alt="cobigen ionic code genartion"></span></p>
</div>
<div class="paragraph">
<p>So, ready to go! We’re going to star</p>
</div>
<div class="paragraph">
<p>t from the BE part …</p>
</div>
<div class="sect5">
<h6 id="back-end-2"><a class="anchor" href="#back-end-2"></a>Back End</h6>
<div class="paragraph">
<p>run \devonfw-ide-scripts-3.2.4\eclipse-main.bat</p>
</div>
<div class="paragraph">
<p>It will open eclipse</p>
</div>
<div class="paragraph">
<p>create a project using below command from the command prompt</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">devon java create com.example.domain.myapp</code></pre>
</div>
</div>
<div class="paragraph">
<p>Import the project to eclipse as maven project
<span class="image"><img src="_images/images/howtos/e2e_gen/image14.png" alt="eclipse devon"></span></p>
</div>
<div class="paragraph">
<p>Click <strong>FINISH</strong></p>
</div>
<div class="paragraph">
<p>Now We have the following 4 projects.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image15.png" alt="eclipse package explorer"></span></p>
</div>
<div class="paragraph">
<p><strong>BEFORE to start to create an Entity class, remember to create the tables !</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Create a new <strong>SQL</strong> <strong>file</strong> (i.e: V0005<em>CreateTables_ItaPoc.sql) inside </em>jwtsample-__core and insert the following script:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">CREATE TABLE EMPLOYEE (
id BIGINT auto_increment, modificationCounter *INTEGER* *NOT* *NULL*,
employeeid BIGINT auto_increment,
name VARCHAR(255),
surname VARCHAR(255),
email VARCHAR(255),
PRIMARY KEY (employeeid)
);</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong><em>WARNING</em></strong>: please note that there are 2 underscore in the name !</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image16.png" alt="sql file"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Now create another SQL file (i.e: V0006__PopulateTables-ItaPoc.sql) and add following script about the INSERT in order to populate the table created before</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong><em>WARNING</em></strong>: please note that there are 2 underscore in the name !</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">INSERT INTO EMPLOYEE (id, modificationCounter, employeeid, name, surname,email) VALUES (1, 1, 1, 'Stefano','Rossini','stefano.rossini@capgemini.com');
INSERT INTO EMPLOYEE (id, modificationCounter, employeeid, name, surname,email) VALUES (2, 2, 2, 'Angelo','Muresu', 'angelo.muresu@capgemini.com');
INSERT INTO EMPLOYEE (id, modificationCounter, employeeid, name, surname,email) VALUES (3, 3, 3, 'Jaime','Gonzalez', 'jaime.diaz-gonzalez@capgemini.com');</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image17.png" alt="sql insert"></span></p>
</div>
<div class="paragraph">
<p><strong>Let&#8217;s create the yml file for the code generation</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Now create a new file <em>devonfw.yml</em> in the root of your core folder. This will be our OpenAPI contract, like shown below. Then, copy the contents of <a href="https://github.com/devonfw/tools-cobigen/blob/master/documentation/files/devonfw_employee.yml">this file</a> into your OpenAPI. It defines some REST service endpoints and a <em>EmployeeEntity</em> with its properties defined.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Important:</strong> if you want to know how to write an OpenAPI contract compatible with CobiGen, please read <a href="https://github.com/devonfw/tools-cobigen/wiki/cobigen-openapiplugin#usage">this tutorial</a>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image18.png" alt="Swagger at OASP4J Project"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>Right click <em>devonfw.yml</em>. CobiGen &#8594; Generate</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It will ask you to download the templates, click on <em>update</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image19.png" alt="cobigen generate"></span></p>
</div>
<div class="paragraph">
<p>It will automatically download the latest version of <em>CobiGen_Templates</em>.</p>
</div>
<div class="paragraph">
<p><strong>Attention:</strong> If you want to adapt the CobiGen_Templates, (normally this is not neccessary), you will find at the end of this document a tutorial on how to import them and adapt them!</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p>Click on all the option selected as below:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image20.png" alt="cobigen option selection"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="12">
<li>
<p>Click on finish. Below Screen would be seen. Click on continue</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image21.png" alt="cobigen finish"></span></p>
</div>
<div class="paragraph">
<p><strong>The entire <span class="underline">BE layer</span> structure having CRUD operation methods will be auto generated.</strong></p>
</div>
<div class="paragraph">
<p>Some classes will be generated on the api part (<em>jwtsample-api)</em>, normally it will be interfaces, as shown below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image22.png" alt="be layer"></span></p>
</div>
<div class="paragraph">
<p>Some other classes will be generated on the core part (<em>jwtsample-core)</em>, normally it will be implementations as shown below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image23.png" alt="core folder"></span></p>
</div>
<div class="paragraph">
<p><strong>BEFORE to generate the FE</strong>, please start the Tomcat server to check that BE Layer has been generated properly.</p>
</div>
<div class="paragraph">
<p>To start a server you just have to right click on <em>SpringBootApp.java</em> &#8594; <em>run as &#8594; Spring Boot app</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image24.png" alt="Eclipse run as"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image25.png" alt="Spring boot run"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image26.png" alt="Spring boot run"></span></p>
</div>
<div class="paragraph">
<p><strong>BE DONE</strong></p>
</div>
<div class="paragraph">
<p>Last but not least: We make a quick REST services test !</p>
</div>
<div class="paragraph">
<p>See in the application.properties the TCP Port and the PATH</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image27.png" alt="application properties"></span></p>
</div>
<div class="paragraph">
<p>Now compose the Rest service URL:</p>
</div>
<div class="paragraph">
<p>service class path&gt;/&lt;service method path&gt;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&lt;server&gt; refers to server with port no. (ie: localhost:8081)</p>
</li>
<li>
<p>&lt;app&gt; is in the application.propeeties (empty in our case, see above)</p>
</li>
<li>
<p>&lt;rest service class path&gt; refers to EmployeemanagementRestService: (i.e: /employeemanagement/v1)</p>
</li>
<li>
<p>&lt;service method path&gt;/employee/{id}  (i.e: for  getEmployee method)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image28.png" alt="url mapping"></span></p>
</div>
<div class="paragraph">
<p>URL of getEmployee for this example is:</p>
</div>
<div class="paragraph">
<p>For all employees</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:8081/services/rest/employeemanagement/v1/employee/search</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the specific employee</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:8081/services/rest/employeemanagement/v1/employee/1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now download <a href="https://www.getpostman.com/apps">Postman</a> to test the rest services.</p>
</div>
<div class="paragraph">
<p>Once done, you have to create a POST Request for the LOGIN and insert in the body the JSON containing the username and password <em>waiter</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image29.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Once done with success (<strong>Status: 200 OK</strong>) …</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image30.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>… We create a NEW POST Request and We copy the Authorization Bearer field (see above) and We paste it in the Token field (see below)</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image31.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>and specific the JSON parameters for the pagination of the Request that We’re going to send:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image32.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image33.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Now you can click <span class="image"><img src="_images/images/howtos/e2e_gen/image34.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Now you ‘ve to check that response has got <strong>Status: 200 OK</strong> and to see the below list of Employee</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image35.png" alt="postman"></span></p>
</div>
<div class="paragraph">
<p>Now that We have successfully tested the BE is time to go to create the FE !</p>
</div>
</div>
<div class="sect5">
<h6 id="front-end-2"><a class="anchor" href="#front-end-2"></a>Front End</h6>
<div class="paragraph">
<p>Let’s start now with angular Web and then Ionic app.</p>
</div>
<div class="sect6">
<h7 id="angular-web-app-2"><a class="anchor" href="#angular-web-app-2"></a>Angular Web App</h7>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To generate angular structure, download or clone <em>*devon4ng-application-template*</em> from</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/devon4ng-application-template</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image36.png" alt="devon dist folder"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="2">
<li>
<p>Once done, right click on <em>devonfw.yml</em> again (the OpenAPI contract). CobiGen &#8594; Generate</p>
</li>
<li>
<p>Click on the selected options as seen in the screenshot:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image37.png" alt="eclipse generate"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click on Finish</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image38.png" alt="eclipse"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="5">
<li>
<p>The entire ANGULAR structure has been auto generated. The generated code will be merged to the existing.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image39.png" alt="angular ee layer"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>IMPORTANT now you have to add in the <strong><em>app-routing.module.ts</em></strong> file the next content, as a child of HomeComponent, in order to enable the route of the new generated component</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">,\{
path: 'employee',
component: EmployeeGridComponent,
canActivate: [AuthGuard],
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>Following picture explain where to place the above content:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image40.png" alt="routes"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Open the command prompt and execute <em>devon yarn install</em> from the base folder, which would download all the required libraries..</p>
</li>
</ol>
</div>
<div class="olist arabic">
<ol class="arabic" start="8">
<li>
<p>Check the file <strong>environment.ts</strong> if the server path is correct. (for production you will have to change also the environment.prod.ts file)</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image42.png" alt="environment"></span></p>
</div>
<div class="paragraph">
<p>In order to do that it’s important to look at the application.properties to see the values as PATH, TCP port etc …</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image43.png" alt="configure"></span></p>
</div>
<div class="paragraph">
<p>For example in this case the URL should be since the context path is empty the server URLS should be like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ts hljs" data-lang="ts">export const environment = {
production: false,
restPathRoot: 'http://localhost:8081/',
restServiceRoot: 'http://localhost:8081/services/rest/',
security: 'jwt'
};</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Warning</strong>: REMEMBER to set security filed to <strong>jwt</strong> , if it is not configured already.</p>
</div>
<div class="olist arabic">
<ol class="arabic" start="9">
<li>
<p>Now run the <em>*ng serve -o*</em> command to run the Angular Application.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image44.png" alt="image44"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="10">
<li>
<p>If the command execution is <strong>successful</strong>, the below screen will <strong>appear</strong> and it would be automatically redirected to the url:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">http://localhost:4200/login</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image45.png" alt="image45"></span></p>
</div>
<div class="paragraph">
<p><strong>WebApp DONE</strong></p>
</div>
</div>
<div class="sect6">
<h7 id="ionic-mobile-app-2"><a class="anchor" href="#ionic-mobile-app-2"></a>Ionic Mobile App</h7>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To generate Ionic structure, download or clone <em>*devon4ng-application-template*</em> from</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/devon4ng-ionic-application-template</code></pre>
</div>
</div>
</li>
<li>
<p>Once done, Right click on the <strong><em>devonfw.yml</em></strong> as you already did before in order to use CobiGen.</p>
</li>
<li>
<p>Click on the selected options as seen in the screenshot:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image46.png" alt="image46"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="4">
<li>
<p>Click on Finish</p>
</li>
<li>
<p>The entire ionic structure will be auto generated.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image47.png" alt="image47"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="6">
<li>
<p>Change the server url (with correct serve url) in environment.ts, environment.prod.ts and environment.android.ts files (i.e: itapoc\devon4ng-ionic-application-template\src\environments\).</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The angular.json file inside the project has already a build configuration for android.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image48.png" alt="image48"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="7">
<li>
<p>Run npm install in the root folder to download the dependecies</p>
</li>
<li>
<p>Run ionic serve</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image49.png" alt="image49"></span></p>
</div>
<div class="olist arabic">
<ol class="arabic" start="11">
<li>
<p></p>
<div class="paragraph">
<p>Once the execution is successful</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image50.png" alt="image50"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mobile App DONE*</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So: well done</p>
</div>
<div class="paragraph">
<p>Starting from an Entity class you’ve successfully generated the Back-End layer (REST, SOAP, DTO, Spring services, Hibernate DAO), the Angular Web App and the Ionic mobile App!</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image51.png" alt="image51"></span></p>
</div>
<div class="sect7">
<h8 id="build-apk-2"><a class="anchor" href="#build-apk-2"></a>Build APK</h8>
<div class="paragraph">
<p>Since We’re going to create apk remember the following pre-conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://gradle.org/install/">Gradle</a></p>
</li>
<li>
<p><a href="https://developer.android.com/studio">Android Studio</a></p>
</li>
<li>
<p><a href="https://developer.android.com/studio/#command-tools">Android sdk</a></p>
</li>
<li>
<p><a href="https://capacitor.ionicframework.com/docs/getting-started/">Capacitor</a></p>
</li>
</ul>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Now, open cmd and type the path where your <em>devon4ng-ionic-application-template</em> project is present.</p>
</li>
<li>
<p>Run the following commands:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>npx cap init</p>
</li>
<li>
<p>ionic build --configuration=android</p>
</li>
<li>
<p>npx cap add android</p>
</li>
<li>
<p>npx cap copy</p>
</li>
<li>
<p>npx cap open android</p>
</li>
</ol>
</div>
</li>
<li>
<p>Build the APK using Android studio.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image52.png" alt="image52"></span>
<span class="image"><img src="_images/images/howtos/e2e_gen/image53.png" alt="image53"></span>
<span class="image"><img src="_images/images/howtos/e2e_gen/image54.png" alt="image54"></span>
<span class="image"><img src="_images/images/howtos/e2e_gen/image55.png" alt="image55"></span></p>
</div>
<div class="paragraph">
<p>You can find your apk file in</p>
</div>
<div class="paragraph">
<p>/devon4ng-ionic-application-template/android/app/build/outputs/apk/debug</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="adapt-cobigen_templates-2"><a class="anchor" href="#adapt-cobigen_templates-2"></a>Adapt CobiGen_Templates</h5>
<div class="paragraph">
<p>After following this tutorial, you will have the CobiGen_Templates downloaded on your local machine. To import these templates you need to do the following:</p>
</div>
<div class="paragraph">
<p>Right click in any part of the package explorer, then click on CobiGen &#8594; Adapt templates</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image56.png" alt="image56"></span></p>
</div>
<div class="paragraph">
<p>Click <em>Ok</em>:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image57.png" alt="image57"></span></p>
</div>
<div class="paragraph">
<p>Now the CobiGen_Templates project will be automatically imported into your workspace, as shown on the image below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image58.png" alt="image58"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image59.png" alt="image59"></span></p>
</div>
<div class="paragraph">
<p>Now you just need to change the Java version of the project to JRE 1.8. Right click on the JRE system library, and then on <em>Properties:</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image60.png" alt="image60"></span></p>
</div>
<div class="paragraph">
<p>Now change the version to Java 1.8
<span class="image"><img src="_images/images/howtos/e2e_gen/image61.png" alt="image61"></span></p>
</div>
<div class="paragraph">
<p>Now you have successfully imported the CobiGen templates. If you want to edit them, you will find them in the folder <em>src/main/templates.</em> For instance, the Java templates are located here:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image62.png" alt="image62"></span></p>
</div>
<div class="paragraph">
<p>Now you can adapt the templates as much as you want. Documentation about this can be found on:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/tools-cobigen/wiki/Guide-to-the-Reader</code></pre>
</div>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Adapt Templates from CobiGen</p>
</div>
</div>
<div class="sect4">
<h5 id="adapt-cobigen_templates-3"><a class="anchor" href="#adapt-cobigen_templates-3"></a>Adapt CobiGen_Templates</h5>
<div class="paragraph">
<p>After following this tutorial, you will have the CobiGen_Templates downloaded on your local machine. To import these templates you need to do the following:</p>
</div>
<div class="paragraph">
<p>Right click in any part of the package explorer, then click on CobiGen &#8594; Adapt templates</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image56.png" alt="image56"></span></p>
</div>
<div class="paragraph">
<p>Click OK:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image57.png" alt="image57"></span></p>
</div>
<div class="paragraph">
<p>Now the CobiGen_Templates project will be automatically imported into your workspace, as shown on the image below:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image58.png" alt="image58"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image59.png" alt="image59"></span></p>
</div>
<div class="paragraph">
<p>Now you just need to change the Java version of the project to JRE 1.8. Right click on the JRE system library, and then on <em>Properties:</em></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image60.png" alt="image60"></span></p>
</div>
<div class="paragraph">
<p>Now change the version to Java 1.8
<span class="image"><img src="_images/images/howtos/e2e_gen/image61.png" alt="image61"></span></p>
</div>
<div class="paragraph">
<p>Now you have successfully imported the CobiGen templates. If you want to edit them, you will find them in the folder <code><em>src/main/templates.</em></code> For instance, the Java templates are located here:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/howtos/e2e_gen/image62.png" alt="image62"></span></p>
</div>
<div class="paragraph">
<p>Now you can adapt the templates as much as you want. Documentation about this can be found on:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-URL hljs" data-lang="URL">https://github.com/devonfw/tools-cobigen/wiki/Guide-to-the-Reader</code></pre>
</div>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==Enable Composite Primary Keys in Entity</p>
</div>
<div class="paragraph">
<p>In order to enable Composite Primary Keys in entity in CobiGen, the below approach is suggested</p>
</div>
<div class="paragraph">
<p>The templates in CobiGen have been enhanced to support Composite primary keys while still supporting the default <code>devonfw/Cobigen</code> values with Long id.</p>
</div>
<div class="paragraph">
<p>Also, the current generation from Entity still holds good - right click from an Entity object, CobiGen &#8594; Generate will show the CobiGen wizard relative to the entity generation.</p>
</div>
<div class="paragraph">
<p>After generating, below example shows how composite primary keys can be enabled.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Entity
@Table(name = "employee")
public class EmployeeEntity {
	private CompositeEmployeeKey id;
	private String name;
	private String lastName;
	@Override
	@EmbeddedId
	public CompositeEmployeeKey getId() {
		return id;
	}
	@Override
	public void setId(CompositeEmployeeKey id) {
		this.id = id;
	}
	.
	.
	.</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class CompositeEmployeeKey implements Serializable {
  private String companyId;
  private String employeeId;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the generation is complete, implement <code>PersistenceEntity&lt;ID&gt;</code>.java in the <code>EmployeeEntity</code> and pass the composite primary key object which is <code>CompositeEmployeeKey</code> in this case as the parameter <code>ID</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import com.devonfw.module.basic.common.api.entity.PersistenceEntity;
@Entity
@Table(name = "employee")
public class EmployeeEntity implements PersistenceEntity&lt;CompositeEmployeeKey&gt; {
	private CompositeEmployeeKey id;
	private String name;
	private String lastName;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, the <code>modificationCounter</code> methods needs to be implemented from the interface <code>PersistenceEntity&lt;ID&gt;</code>. The sample implementation of the modification counter can be referred below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
  public int getModificationCounter() {
    if (this.persistentEntity != null) {
      // JPA implementations will update modification counter only after the transaction has been committed.
      // Conversion will typically happen before and would result in the wrong (old) modification counter.
      // Therefore we update the modification counter here (that has to be called before serialization takes
      // place).
      this.modificationCounter = this.persistentEntity.getModificationCounter();
    }
    return this.modificationCounter;
  }
  @Override
  public void setModificationCounter(int version) {
    this.modificationCounter = version;
  }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="template-development"><a class="anchor" href="#template-development"></a>26.7. Template Development</h3>
<div class="sect4">
<h5 id="helpful-links-for-template-development"><a class="anchor" href="#helpful-links-for-template-development"></a>Helpful links for template development</h5>
<div class="ulist">
<ul>
<li>
<p><a href="http://freemarker.org/">FreeMarker Root Page</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="http://freemarker.org/docs/dgui_template_exp.html#exp_cheatsheet">Expressions Cheat Sheet</a></p>
</li>
<li>
<p><a href="http://freemarker.org/docs/ref.html">Complete Language reference</a></p>
</li>
<li>
<p><a href="https://try.freemarker.apache.org/">FreeMarker Template Tester</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="cobigen-javaplugin#template-object-model.adoc">Variables to access Java source model</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mrchecker-devonfw-testing-tool"><a class="anchor" href="#mrchecker-devonfw-testing-tool"></a>26.8. MrChecker - devonfw testing tool</h3>

</div>
<div class="sect2">
<h3 id="who-is-mrchecker"><a class="anchor" href="#who-is-mrchecker"></a>26.9. Who Is MrChecker</h3>
<!-- toc disabled -->
<div class="sect4">
<h5 id="who-is-mrchecker-2"><a class="anchor" href="#who-is-mrchecker-2"></a>Who is MrChecker?</h5>
<div class="paragraph">
<p>MrChecker Test Framework is an end to end test automation framework which is written in Java.
It is an automated testing framework for functional testing of web applications, API web services, Service Virtualization, Security, native mobile apps and, in the near future, databases. All modules have tangible examples of how to build resilient integration test cases based on delivered functions.</p>
</div>
</div>
<div class="sect4">
<h5 id="where-does-mrchecker-apply"><a class="anchor" href="#where-does-mrchecker-apply"></a>Where does MrChecker apply?</h5>
<div class="paragraph">
<p>The aim of MrChecker is to achieve standardize way to build BlackBox tests. It provides the possibility to have one common software standard in order to build Component, Integration and System tests.</p>
</div>
<div class="paragraph">
<p>A Test Engineer does not have access to the application source code in order to perform BlackBox tests, but they are able to attach their tests to any application interfaces, such as  - IP address - Domain Name - communication protocol - Command Line Interface.</p>
</div>
</div>
<div class="sect4">
<h5 id="mrchecker-specification"><a class="anchor" href="#mrchecker-specification"></a>MrChecker specification:</h5>
<div class="ulist">
<ul>
<li>
<p>Responsive Web Design application: Selenium Browser</p>
</li>
<li>
<p>REST/SOAP: RestAssure</p>
</li>
<li>
<p>Service Virtualization: Wiremock</p>
</li>
<li>
<p>Database: JDBC drivers for SQL</p>
</li>
<li>
<p>Security: RestAssure + RestAssure Security lib</p>
</li>
<li>
<p>Standalone Java application: SWING</p>
</li>
<li>
<p>Native mobile application for Android: Appium</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="benefits"><a class="anchor" href="#benefits"></a>Benefits</h5>
<div class="paragraph">
<p>Every customer may benefit from using MrChecker Test Framework. The main profits for your project are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resilient and robust building and validation process</p>
</li>
<li>
<p>Quality gates shifted closer to the software development process</p>
</li>
<li>
<p>Team quality awareness increase - including Unit Tests, Static Analysis, Security Tests, Performance in the testing process</p>
</li>
<li>
<p>Test execution environment transparent to any infrastructure</p>
</li>
<li>
<p>Touch base with the Cloud solution</p>
</li>
<li>
<p>Faster Quality and DevOps-driven delivery</p>
</li>
<li>
<p>Proven frameworks, technologies and processes.</p>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="test-stages"><a class="anchor" href="#test-stages"></a>Test stages</h5>

</div>
<div class="sect4">
<h5 id="unit-test"><a class="anchor" href="#unit-test"></a>Unit test</h5>
<div class="paragraph">
<p>A module is the smallest compilable unit of source code. It is often too small to be tested by the functional tests (black-box tests). However, it is the appropriate candidate for white-box testing. White-box tests have to be performed as the first static tests (e.g. Lint and inspections), followed by dynamic tests in order to check boundaries, branches and paths. Usually, this kind of testing would require enabling stubs and special test tools.</p>
</div>
</div>
<div class="sect4">
<h5 id="component-test"><a class="anchor" href="#component-test"></a>Component test</h5>
<div class="paragraph">
<p>This is the black-box test of modules or groups of modules which represent certain functionalities. There are no rules about what could be called a component. Whatever a tester defines as a component, should make sense and be a testable unit. Components can be integrated into bigger components step by step and tested as such.</p>
</div>
</div>
<div class="sect4">
<h5 id="integration-test"><a class="anchor" href="#integration-test"></a>Integration test</h5>
<div class="paragraph">
<p>Functions are tested by feeding them input and examining the output, and internal program structure is rarely considered. The software is completed step by step and tested by  tests covering a collaboration between modules or classes. The integration depends on the kind of system. For example, the steps could be as follows: run the operating system first and gradually add one component after another, then check if the black-box tests are still running (the test cases will be extended together with every added component). The integration is done in the laboratory. It may be also completed by using simulators or emulators. Additionally, the input signals could be stimulated.</p>
</div>
</div>
<div class="sect4">
<h5 id="software-system-test"><a class="anchor" href="#software-system-test"></a>Software / System test</h5>
<div class="paragraph">
<p>System testing is a type of testing conducted on a complete integrated system to evaluate the system’s compliance with its specified requirements. This is a type of black-box testing of the complete software in the target system. The most important factor in successful system testing is that the environmental conditions for the software have to be as realistic as possible (complete original hardware in the destination environment).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="test-framework-modules"><a class="anchor" href="#test-framework-modules"></a>26.10. Test Framework Modules</h3>
<div class="paragraph">
<p>In this section, it is possible to find all the information regarding the main modules of MrChecker:</p>
</div>
</div>
<div class="sect2">
<h3 id="core-test-module"><a class="anchor" href="#core-test-module"></a>26.11. Core Test Module</h3>
<!-- toc disabled -->
<div class="sect5">
<h6 id="core-test-module-2"><a class="anchor" href="#core-test-module-2"></a>Core Test Module</h6>

</div>
<div class="sect5">
<h6 id="what-is-core-test-module"><a class="anchor" href="#what-is-core-test-module"></a>What is Core Test Module</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image1_new.png" alt="image1 new">
</div>
</div>
</div>
<div class="sect5">
<h6 id="core-test-module-functions"><a class="anchor" href="#core-test-module-functions"></a>Core Test Module Functions</h6>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Core-Test-Module-Test-reports-with-logs-and-or-screenshots.adoc">Test reports with logs and/or screenshots</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Core-Test-Module-test-groups-tags.adoc">Test groups/tags</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Core-Test-Module-Data-driven-approach.adoc">Data driven approach</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Core-Test-Module-Test-case-parallel-execution.adoc">Test case parallel execution</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Core-Test-Module-BDD-Gherkin-Cucumber-approach.adoc">BDD - Gherkin - Cucumber approach</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Core-Test-Module-Run-on-independent-Operating-Systems.adoc">Run on independent Operating Systems</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Core-Test-Module-Externalize-test-environment-DEV-QA-SIT-PROD.adoc">Externalize test environment (DEV, QA, SIT, PROD)</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Core-Test-Module-Different-Environments.adoc">Encrypting sensitive data</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="how-to-start"><a class="anchor" href="#how-to-start"></a>How to start?</h6>
<div class="paragraph">
<p>Read: <a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Core-Test-Module-Framework-Test-Class.adoc">Framework Test Class</a></p>
</div>
</div>
<div class="sect5">
<h6 id="allure-logger-bflogger"><a class="anchor" href="#allure-logger-bflogger"></a>Allure Logger &#8594; BFLogger</h6>
<div class="paragraph">
<p>In Allure E2E Test Framework you have ability to use and log any additional information crucial for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>test steps</p>
</li>
<li>
<p>test exection</p>
</li>
<li>
<p>page object actions, and many more.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="where-to-find-saved-logs"><a class="anchor" href="#where-to-find-saved-logs"></a>Where to find saved logs</h6>
<div class="paragraph">
<p>Every logged information is saved in a separate test file, as a result of parallel tests execution.</p>
</div>
<div class="paragraph">
<p>The places they are saved:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In test folder <em>C:\Allure_Test_Framework\allure-app-under-test\logs</em></p>
</li>
<li>
<p>In every Allure Test report, logs are always embedded as an attachment, according to test run.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="how-to-use-logger-2"><a class="anchor" href="#how-to-use-logger-2"></a>How to use logger:</h6>
<div class="ulist">
<ul>
<li>
<p>Start typing</p>
<div class="paragraph">
<p><code>BFLogger</code></p>
</div>
</li>
<li>
<p>Then type . (dot)</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="type-of-logger"><a class="anchor" href="#type-of-logger"></a>Type of logger:</h6>
<div class="ulist">
<ul>
<li>
<p><code>BFLogger.logInfo("Your text")</code> - used for test steps</p>
</li>
<li>
<p><code>BFLogger.logDebug("Your text")</code> - used for non official information, either during test build process or in Page Object files</p>
</li>
<li>
<p><code>BFLogger.logError("Your text")</code> - used to emphasize critical information</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image13.png" alt="image13">
</div>
</div>
<div class="paragraph">
<p>Console output:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image14.png" alt="image14">
</div>
</div>
</div>
<div class="sect5">
<h6 id="allure-reports"><a class="anchor" href="#allure-reports"></a>Allure Reports</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image15.png" alt="image15">
</div>
</div>
<div class="paragraph">
<p>Allure is a tool designed for test reports.</p>
</div>
</div>
<div class="sect5">
<h6 id="generate-report-command-line"><a class="anchor" href="#generate-report-command-line"></a>Generate report - command line</h6>
<div class="paragraph">
<p>You can generate a report using one of the following commands:</p>
</div>
<div class="paragraph">
<p><strong>Since mrchecker-core-module version 5.6.2.1:</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn test allure:serve -Dgroups=TestsTag1</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Prior to mrchecker-core-module version 5.6.2.1:</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn test allure:serve -Dtest=TS_Tag1</pre>
</div>
</div>
<div class="paragraph">
<p>A report will be generated into temp folder. Web server with results will start. You can additionally configure the server timeout. The default value is "3600" (one hour).</p>
</div>
<div class="paragraph">
<p>System property allure.serve.timeout.</p>
</div>
<div class="paragraph">
<p><strong>Since mrchecker-core-module version 5.6.2.1:</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn test allure:report -Dgroups=TestsTag1</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Prior to mrchecker-core-module version 5.6.2.1:</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn test allure:report -Dtest=TS_Tag1</pre>
</div>
</div>
<div class="paragraph">
<p>A report will be generated tо directory: target/site/allure-maven/index.html</p>
</div>
<div class="paragraph">
<p><strong>NOTE</strong>: Please open <em>index.html</em> file under Firefox. Chrome has some limitations to presenting dynamic content. If you want to open a report with a Chromium based Web Browser, you need to launch it first with <code>--allow-file-access-from-files</code> argument.</p>
</div>
</div>
<div class="sect5">
<h6 id="generate-report-eclipse"><a class="anchor" href="#generate-report-eclipse"></a>Generate report - Eclipse</h6>
<div class="paragraph">
<p>A report is created here <em>allure-app-under-test\target\site\allure-report\index.html</em></p>
</div>
<div class="paragraph">
<p><strong>NOTE</strong>: Please open <em>index.html</em> file under Firefox. Chrome has some limitations to presenting dynamic content. If you want to open a report with a Chromium based Web Browser, you need to launch it first with <code>--allow-file-access-from-files</code> argument.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image17.png" alt="image17">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image18.png" alt="image18">
</div>
</div>
</div>
<div class="sect5">
<h6 id="generate-report-jenkins"><a class="anchor" href="#generate-report-jenkins"></a>Generate report - Jenkins</h6>
<div class="paragraph">
<p>In our case, we&#8217;ll use the Allure Jenkins plugin. When integrating Allure in a Jenkins job configuration, we&#8217;ll have direct access to the build&#8217;s test report.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image19.png" alt="image19">
</div>
</div>
<div class="paragraph">
<p>There are several ways to access the Allure Test Reports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Using the "Allure Report" button on the left navigation bar or center of the general job overview</p>
</li>
<li>
<p>Using the "Allure Report" button on the left navigation bar or center of a specific build overview</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Afterwards you&#8217;ll be greeted with either the general Allure Dashboard (showing the newest build) or the Allure Dashboard for a specific (older) build.</p>
</div>
</div>
<div class="sect5">
<h6 id="allure-dashboard"><a class="anchor" href="#allure-dashboard"></a>Allure dashboard</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image20.png" alt="image20">
</div>
</div>
<div class="paragraph">
<p>The Dashboard provides a graphical overview on how many test cases were successful, failed or broken.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Passed</strong> means, that the test case was executed successfully.</p>
</li>
<li>
<p><strong>Broken</strong> means, that there were mistakes, usually inside of the test method or test class. As tests are being treated as code, broken code has to be expected, resulting in occasionally broken test results.</p>
</li>
<li>
<p><strong>Failed</strong> means that an assertion failed.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="defects"><a class="anchor" href="#defects"></a>Defects</h6>
<div class="paragraph">
<p>The defects tab lists out all the defects that occurred, and also descriptions thereof. Clicking on a list item displays the test case which resulted in an error. Clicking on a test case allows the user to have a look at the test case steps, as well as Log files or Screenshots of the failure.</p>
</div>
</div>
<div class="sect5">
<h6 id="graph"><a class="anchor" href="#graph"></a>Graph</h6>
<div class="paragraph">
<p>The graph page includes a pie chart of all tests, showing their result status (failed, passed, etc.). Another graph allows insight into the time elapsed during the tests. This is a very useful information to find and eliminate possible bottlenecks in test implementations.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image21.png" alt="image21">
</div>
</div>
</div>
<div class="sect5">
<h6 id="why-join-test-cases-in-groups-test-suites"><a class="anchor" href="#why-join-test-cases-in-groups-test-suites"></a>Why join Test Cases in groups - Test Suites</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image22.png" alt="image22">
</div>
</div>
</div>
<div class="sect5">
<h6 id="regresion-suite"><a class="anchor" href="#regresion-suite"></a>Regresion Suite:</h6>
<div class="paragraph">
<p>Regression testing is a type of <a href="https://en.wikipedia.org/wiki/Software_testing">software testing</a> which verifies that software which was previously developed and tested still performs the same way after it was changed or interfaced with another software.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/Smoke_testing">Smoke</a></p>
</li>
<li>
<p>Business vital functionalities</p>
</li>
<li>
<p>Full scope of test cases</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="functional-suite"><a class="anchor" href="#functional-suite"></a><a href="https://www.rainforestqa.com/blog/2016-06-27-what-is-functional-testing">Functional Suite</a>:</h6>
<div class="ulist">
<ul>
<li>
<p>Smoke</p>
</li>
<li>
<p>Business function A</p>
</li>
<li>
<p>Business function B</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="single-responsibility-unit"><a class="anchor" href="#single-responsibility-unit"></a><a href="https://en.wikipedia.org/wiki/Single_responsibility_principle">Single Responsibility Unit</a>:</h6>
<div class="ulist">
<ul>
<li>
<p>Single page</p>
</li>
<li>
<p>Specific test case</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="how-to-build-a-test-suite-based-on-tags"><a class="anchor" href="#how-to-build-a-test-suite-based-on-tags"></a>How to build a Test Suite based on tags</h6>

</div>
<div class="sect5">
<h6 id="structure-of-the-test-suite"><a class="anchor" href="#structure-of-the-test-suite"></a>Structure of the Test Suite</h6>
<div class="paragraph">
<p><strong>Since mrchecker-core-module version 5.6.2.1:</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image23_new.png" alt="image23 new">
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@RunWith(JUnitPlatform.class)</code> - use Junit5 runner</p>
</li>
<li>
<p><code>@IncludeTags({"TestsTag1"})</code> - search all test files with the tag <code>"TestsTag1"</code></p>
</li>
<li>
<p><code>@ExcludeTags({"TagToExclude"})</code> - exclude test files with the tag <code>"TagToExclude"</code></p>
</li>
<li>
<p><code>@SelectPackages("com.capgemini.mrchecker.core.groupTestCases.testCases")</code> - search only test files in <code>"com.capgemini.mrchecker.core.groupTestCases.testCases"</code> package</p>
</li>
<li>
<p><code>public class TS_Tag1</code> - the name of the Test Suite is "TS_Tag1"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most commonly used filters to build a Test Suite are ones using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@IncludeTags({ })</code></p>
</li>
<li>
<p><code>@ExcludeTags({ })</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>@IncludeTags({ "TestsTag1" }) , @ExcludeTags({ })</code> &#8594; will execute all test cases with the tag <code>TestsTag1</code></p>
</li>
<li>
<p><code>@IncludeTags({ "TestsTag1" }) , @ExcludeTags({ "SlowTest" })</code> &#8594; will execute all test cases with tag <code>"TestsTag1"</code> although it will exclude from this list the test cases with the tag <code>"SlowTest"</code></p>
</li>
<li>
<p><code>@IncludeTags({ }) , @ExcludeTags({ "SlowTest" })</code> &#8594; It will exclude test cases with the tag <code>"SlowTest"</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Prior to mrchecker-core-module version 5.6.2.1:</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image23.png" alt="image23">
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@RunWith(WildcardPatternSuiteBF.class)</code> - search for test files under <code>/src/test/java</code></p>
</li>
<li>
<p><code>@IncludeCategories({ TestsTag1.class })</code> - search for all test files with the tag <code>"TestsTag1.class"</code></p>
</li>
<li>
<p><code>@ExcludeCategories({ })</code> - exclude test files. In this example, there is no exclusion</p>
</li>
<li>
<p><code>@SuiteClasses({ "**/*Test.class" })</code> - search only test files, where the file name ends with <code>"&lt;anyChar/s&gt;Test.class"</code></p>
</li>
<li>
<p><code>public class TS_Tag1</code> - the name of the Test Suite is "TS_Tag1"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most commonly used filters to build Test Suite are ones using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@IncludeCategories({ })</code></p>
</li>
<li>
<p><code>@ExcludeCategories({ })</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>@IncludeCategories({ TestsTag1.class }) , @ExcludeCategories({ })</code> &#8594; will execute all test cases with the tag <code>TestsTag1.class</code></p>
</li>
<li>
<p><code>@IncludeCategories({ TestsTag1.class }) , @ExcludeCategories({ SlowTest.class })</code> &#8594; will execute all test cases with the tag <code>"TestsTag1.class"</code> although it will exclude from this list the test cases with the tag <code>"SlowTest.class"</code></p>
</li>
<li>
<p><code>@IncludeCategories({ }) , @ExcludeCategories({ SlowTest.class })</code> &#8594; will execute all test cases from <code>/src/test/java</code>, although it will exclude from this list the test cases with the tag <code>"SlowTest.class"</code></p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="structure-of-test-case"><a class="anchor" href="#structure-of-test-case"></a>Structure of Test Case</h6>
<div class="paragraph">
<p><strong>Since mrchecker-core-module version 5.6.2.1:</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image24_new.png" alt="image24 new">
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@TestsTag1, @TestsSmoke, @TestsSelenium</code> - list of tags assigned to this test case - <code>"TestsTag1, TestsSmoke, TestSelenium"</code> annotations</p>
</li>
<li>
<p><code>public class FristTest_tag1_Test</code> - the name of the test case is <code>"FristTest_tag1_Test"</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Prior to mrchecker-core-module version 5.6.2.1:</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image24.png" alt="image24">
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@Category({ TestsTag1.class, TestsSmoke.class, TestSelenium.class })</code> - list of tags / categories assigned to this test case - <code>"TestsTag1.class, TestsSmoke.class, TestSelenium.class"</code></p>
</li>
<li>
<p><code>public class FristTest_tag1_Test</code> - the name of the test case is <code>"FristTest_tag1_Test"</code></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="structure-of-tags-categories"><a class="anchor" href="#structure-of-tags-categories"></a>Structure of Tags / Categories</h6>
<div class="paragraph">
<p><strong>Since mrchecker-core-module version 5.6.2.1:</strong></p>
</div>
<div class="paragraph">
<p>Tag name: <code>TestsTag1</code> annotation</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image25_new.png" alt="image25 new">
</div>
</div>
<div class="paragraph">
<p>Tag name: <code>TestsSmoke</code> annotation</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image26_new.png" alt="image26 new">
</div>
</div>
<div class="paragraph">
<p>Tag name: <code>TestSelenium</code> annotation</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image27_new.png" alt="image27 new">
</div>
</div>
<div class="paragraph">
<p><strong>Prior to mrchecker-core-module version 5.6.2.1:</strong></p>
</div>
<div class="paragraph">
<p>Tag name: <code>TestsTag1.class</code></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image25.png" alt="image25">
</div>
</div>
<div class="paragraph">
<p>Tag name: <code>TestsSmoke.class</code></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image26.png" alt="image26">
</div>
</div>
<div class="paragraph">
<p>Tag name: <code>TestSelenium.class</code></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image27.png" alt="image27">
</div>
</div>
</div>
<div class="sect5">
<h6 id="how-to-run-test-suite"><a class="anchor" href="#how-to-run-test-suite"></a>How to run Test Suite</h6>
<div class="paragraph">
<p>To run a Test Suite you perform the same steps as you do to run a test case</p>
</div>
<div class="paragraph">
<p><em>Command line</em></p>
</div>
<div class="paragraph">
<p><strong>Since mrchecker-core-module version 5.6.2.1:</strong></p>
</div>
<div class="paragraph">
<p>JUnit5 disallows running suite classes from maven. Use -Dgroups=Tag1,Tag2 and -DexcludeGroups=Tag4,Tag5 to create test suites in maven.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn test site -Dgroups=TestsTag1</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Prior to mrchecker-core-module version 5.6.2.1:</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn test site -Dtest=TS_Tag1</pre>
</div>
</div>
<div class="paragraph">
<p><em>Eclipse</em></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image28.png" alt="image28">
</div>
</div>
</div>
<div class="sect5">
<h6 id="data-driven-approach"><a class="anchor" href="#data-driven-approach"></a>Data driven approach</h6>
<div class="paragraph">
<p><strong>Data driven approach</strong> - External <strong>data driven</strong></p>
</div>
<div class="paragraph">
<p><strong>External data driven</strong> - Data as external file injected in <strong>test case</strong></p>
</div>
<div class="paragraph">
<p><strong>Test case</strong> - Categorize <strong>functionality</strong> and <strong>severity</strong></p>
</div>
<div class="paragraph">
<p>You can find more information about data driven  here and here</p>
</div>
<div class="paragraph">
<p>There are a few ways to define parameters for tests.</p>
</div>
</div>
<div class="sect5">
<h6 id="internal-data-driven-approach"><a class="anchor" href="#internal-data-driven-approach"></a>Internal Data driven approach</h6>
<div class="paragraph">
<p>Data as <strong>part</strong> of <strong>test case</strong></p>
</div>
<div class="paragraph">
<p>The different means to pass in parameters are shown below.</p>
</div>
<div class="paragraph">
<p><strong>Since mrchecker-core-module version 5.6.2.1</strong></p>
</div>
<div class="paragraph">
<p>Static methods are used to provide the parameters.</p>
</div>
</div>
<div class="sect5">
<h6 id="a-method-in-the-test-class"><a class="anchor" href="#a-method-in-the-test-class"></a>A method in the test class:</h6>
<div class="listingblock">
<div class="content">
<pre>@ParameterizedTest
@MethodSource("argumentsStream")</pre>
</div>
</div>
<div class="paragraph">
<p><strong>OR</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>@ParameterizedTest
@MethodSource("arrayStream")</pre>
</div>
</div>
<div class="paragraph">
<p>In the first case the arguments are directly mapped to the test method parameters. In the second case the array is passed as the argument.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image30_new.png" alt="image30 new">
</div>
</div>
</div>
<div class="sect5">
<h6 id="a-method-in-a-different-class"><a class="anchor" href="#a-method-in-a-different-class"></a>A method in a different class:</h6>
<div class="listingblock">
<div class="content">
<pre>@ParameterizedTest
@MethodSource("com.capgemini.mrchecker.core.datadriven.MyContainsTestProvider#provideContainsTrueParameters")</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image32_new.png" alt="image32 new">
</div>
</div>
<div class="paragraph">
<p><strong>Prior to mrchecker-core-module version 5.6.2.1</strong></p>
</div>
<div class="paragraph">
<p>Parameters that are passed into tests using the <code>@Parameters</code> annotation must be _Object[]_s</p>
</div>
</div>
<div class="sect5">
<h6 id="in-the-annotation"><a class="anchor" href="#in-the-annotation"></a>In the annotation:</h6>
<div class="listingblock">
<div class="content">
<pre>@Parameters({"1, 2, 3", "3, 4, 7", "5, 6, 11", "7, 8, 15"})</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image30.png" alt="image30">
</div>
</div>
<div class="paragraph">
<p>The parameters must be primitive objects such as integers, strings, or booleans. Each set of parameters is contained within a single string and will be parsed to their correct values as defined by the test method’s signature.</p>
</div>
</div>
<div class="sect5">
<h6 id="in-a-method-named-in-the-annotation"><a class="anchor" href="#in-a-method-named-in-the-annotation"></a>In a method named in the annotation:</h6>
<div class="listingblock">
<div class="content">
<pre>@Parameters(method = "addParameters")</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image31.png" alt="image31">
</div>
</div>
<div class="paragraph">
<p>A separate method can be defined and referred to for parameters. This method must return an <code>Object[]</code> and can contain normal objects.</p>
</div>
</div>
<div class="sect5">
<h6 id="in-a-class"><a class="anchor" href="#in-a-class"></a>In a class:</h6>
<div class="listingblock">
<div class="content">
<pre>@Parameters(source = MyContainsTestProvider.class)</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image32.png" alt="image32">
</div>
</div>
<div class="paragraph">
<p>A separate class can be used to define parameters for the test. This test must contain at least one static method that returns an Object[], and its name must be prefixed with provide. The class could also contain multiple methods that provide parameters to the test, as long as they also meet the required criteria.</p>
</div>
</div>
<div class="sect5">
<h6 id="external-data-driven"><a class="anchor" href="#external-data-driven"></a>External Data Driven</h6>
<div class="paragraph">
<p>Data as <strong>external file injected</strong> in <strong>test case</strong></p>
</div>
<div class="paragraph">
<p><strong>Since mrchecker-core-module version 5.6.2.1</strong></p>
</div>
<div class="paragraph">
<p>Tests use the annotation @CsvFileSource to inject CSVs file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@CsvFileSource(resources = "/datadriven/test.csv", numLinesToSkip = 1)</pre>
</div>
</div>
<div class="paragraph">
<p>A CSV can also be used to contain the parameters for the tests. It is pretty simple to set up, as it’s just a comma-separated list.</p>
</div>
</div>
<div class="sect5">
<h6 id="classic-csv"><a class="anchor" href="#classic-csv"></a>Classic CSV</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image33_new.png" alt="image33 new">
</div>
</div>
<div class="paragraph">
<p>and CSV file structure</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image34.png" alt="image34">
</div>
</div>
</div>
<div class="sect5">
<h6 id="csv-with-headers"><a class="anchor" href="#csv-with-headers"></a>CSV with headers</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image35_new.png" alt="image35 new">
</div>
</div>
<div class="paragraph">
<p>and CSV file structure</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image36.png" alt="image36">
</div>
</div>
</div>
<div class="sect5">
<h6 id="csv-with-specific-column-mapper"><a class="anchor" href="#csv-with-specific-column-mapper"></a>CSV with specific column mapper</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image37_new.png" alt="image37 new">
</div>
</div>
<div class="paragraph">
<p>and Mapper implementation</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image38_new.png" alt="image38 new">
</div>
</div>
<div class="paragraph">
<p><strong>Prior to mrchecker-core-module version 5.6.2.1</strong></p>
</div>
<div class="paragraph">
<p>Tests use the annotation @FileParameters to inject CSVs file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@FileParameters("src/test/resources/datadriven/test.csv")</pre>
</div>
</div>
<div class="paragraph">
<p>A CSV can also be used to contain the parameters for the tests. It is pretty simple to set up, as it’s just a comma-separated list.</p>
</div>
</div>
<div class="sect5">
<h6 id="classic-csv-2"><a class="anchor" href="#classic-csv-2"></a>Classic CSV</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image33.png" alt="image33">
</div>
</div>
<div class="paragraph">
<p>and CSV file structure</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image34.png" alt="image34">
</div>
</div>
</div>
<div class="sect5">
<h6 id="csv-with-headers-2"><a class="anchor" href="#csv-with-headers-2"></a>CSV with headers</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image35.png" alt="image35">
</div>
</div>
<div class="paragraph">
<p>and CSV file structure</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image36.png" alt="image36">
</div>
</div>
</div>
<div class="sect5">
<h6 id="csv-with-specific-column-mapper-2"><a class="anchor" href="#csv-with-specific-column-mapper-2"></a>CSV with specific column mapper</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image37.png" alt="image37">
</div>
</div>
<div class="paragraph">
<p>and Mapper implementation</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image38.png" alt="image38">
</div>
</div>
</div>
<div class="sect5">
<h6 id="what-is-parallel-test-execution"><a class="anchor" href="#what-is-parallel-test-execution"></a>What is "Parallel test execution" ?</h6>
<div class="paragraph">
<p>Parallel test execution means many <em>"Test Classes"</em> can run simultaneously.</p>
</div>
<div class="paragraph">
<p><em>"Test Class"</em>, as this is a Junit Test class, it can have one or more test cases - <em>"Test case methods"</em></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image39.png" alt="image39">
</div>
</div>
</div>
<div class="sect5">
<h6 id="how-many-parallel-test-classes-can-run-simultaneously"><a class="anchor" href="#how-many-parallel-test-classes-can-run-simultaneously"></a>How many parallel test classes can run simultaneously?</h6>
<div class="paragraph">
<p><strong>Since mrchecker-core-module version 5.6.2.1</strong></p>
</div>
<div class="paragraph">
<p>JUnit5 supports parallelism natively. The feature is configured using a property file located at <code>src\test\resources\junit-platform.properties</code>.
As per default configuration, concurrent test execution is set to run test classes in parallel using the thread count equal to a number of your CPUs.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image39a.png" alt="image39a">
</div>
</div>
<div class="paragraph">
<p>Visit <a href="https://junit.org/junit5/docs/snapshot/user-guide/#writing-tests-parallel-execution">JUnit5 site</a> to learn more about parallel test execution.</p>
</div>
<div class="paragraph">
<p><strong>Prior to mrchecker-core-module version 5.6.2.1</strong></p>
</div>
<div class="paragraph">
<p>By default, number of parallel test classes is set to 8.</p>
</div>
<div class="paragraph">
<p>It can be updated as you please, on demand, by command line:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mvn test site -Dtest=TS_Tag1 -Dthread.count=16</pre>
</div>
</div>
<div class="paragraph">
<p><em>-Dthread.count=16</em> - increase number of parallel Test Class execution to 16.</p>
</div>
</div>
<div class="sect5">
<h6 id="overview-9"><a class="anchor" href="#overview-9"></a>Overview</h6>
<div class="paragraph">
<p><strong>Cucumber / Selenium</strong></p>
</div>
<div class="paragraph">
<p>Business and IT don’t always understand each other. Very often misunderstandings between business and IT result in the costly failure of IT projects. With this in mind, Cucumber was developed as a tool to support human collaboration between business and IT.</p>
</div>
<div class="paragraph">
<p>Cucumber uses executable specifications to encourage a close collaboration. This helps teams to keep the business goal in mind at all times. With Cucumber you can merge specification and test documentation into one cohesive whole, allowing your team to maintain one single source of truth. Because these executable specifications are automatically tested by Cucumber, your single source of truth is always up-to-date.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image40.png" alt="image40">
</div>
</div>
<div class="paragraph">
<p>Cucumber supports testers when designing test cases. To automate these test cases, several languages can be used. Cucumber also works well with Browser Automation tools such as Selenium Webdriver.</p>
</div>
</div>
<div class="sect5">
<h6 id="selenium"><a class="anchor" href="#selenium"></a>==  Selenium</h6>
<div class="paragraph">
<p>Selenium automates browsers and is used for automating web applications for testing purposes. Selenium offers testers and developers full access to the properties of objects and the underlying tests, via a scripting environment and integrated debugging options.</p>
</div>
<div class="paragraph">
<p>Selenium consists of many parts. If you want to create robust, browser-based regression automation suites and tests, Selenium Webdriver is most appropriate. With Selenium Webdriver you can also scale and distribute scripts across many environments.</p>
</div>
</div>
<div class="sect5">
<h6 id="strengths"><a class="anchor" href="#strengths"></a>Strengths</h6>

</div>
<div class="sect5">
<h6 id="supports-bdd"><a class="anchor" href="#supports-bdd"></a>==  Supports BDD</h6>
<div class="paragraph">
<p>Those familiar with Behavior Driven Development (BDD) recognize Cucumber as an excellent open source tool that supports this practice.</p>
</div>
</div>
<div class="sect5">
<h6 id="all-in-one-place"><a class="anchor" href="#all-in-one-place"></a>==  All in one place</h6>
<div class="paragraph">
<p>With Cucumber / Selenium you can automate at the UI level. Automation at the unit or API level can also be implemented using Cucumber. This means all tests, regardless of the level at which they are implemented, can be implemented in one tool.</p>
</div>
</div>
<div class="sect5">
<h6 id="maintainable-test-scripts"><a class="anchor" href="#maintainable-test-scripts"></a>==  Maintainable test scripts</h6>
<div class="paragraph">
<p>Many teams seem to prefer UI level automation, despite huge cost of maintaining UI level tests compared to the cost of maintaining API or unit tests. To lessen the maintenance of UI testing, when designing UI level functional tests, you can try describing the test and the automation at three levels: business rule, UI workflow, technical implementation.</p>
</div>
<div class="paragraph">
<p>When using Cucumber combined with Selenium, you can implement these three levels for better maintenance.</p>
</div>
</div>
<div class="sect5">
<h6 id="early-start"><a class="anchor" href="#early-start"></a>==  Early start</h6>
<div class="paragraph">
<p>Executable specifications can and should be written before the functionality is implemented. By starting early, teams get most return on investment from their test automation.</p>
</div>
</div>
<div class="sect5">
<h6 id="supported-by-a-large-community"><a class="anchor" href="#supported-by-a-large-community"></a>==  Supported by a large community</h6>
<div class="paragraph">
<p>Cucumber and Selenium are both open source tools with a large community, online resources and mailing lists.</p>
</div>
</div>
<div class="sect5">
<h6 id="how-to-run-cucumber-tests-in-mr-checker"><a class="anchor" href="#how-to-run-cucumber-tests-in-mr-checker"></a>How to run cucumber tests in Mr.Checker</h6>

</div>
<div class="sect5">
<h6 id="command-line-jenkins"><a class="anchor" href="#command-line-jenkins"></a>Command line / Jenkins</h6>
<div class="ulist">
<ul>
<li>
<p>Run cucumber tests and generate Allure report. Please use this for Jenkins execution. Report is saved under <em>./target/site</em>.</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean -P cucumber test site</pre>
</div>
</div>
</li>
<li>
<p>Run and generate report</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean -P cucumber test site allure:report</pre>
</div>
</div>
</li>
<li>
<p>Run cucumber tests, generate Allure report and start standalone report server</p>
<div class="literalblock">
<div class="content">
<pre>mvn clean -P cucumber test site allure:serve</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="eclipse-ide"><a class="anchor" href="#eclipse-ide"></a>Eclipse IDE</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image41.png" alt="image41">
</div>
</div>
</div>
<div class="sect5">
<h6 id="tooling"><a class="anchor" href="#tooling"></a>Tooling</h6>

</div>
<div class="sect5">
<h6 id="cucumber"><a class="anchor" href="#cucumber"></a>==  Cucumber</h6>
<div class="paragraph">
<p>Cucumber supports over a dozen different software platforms. Every Cucumber implementation provides the same overall functionality, but they also have their own installation procedure and platform-specific functionality. See <a href="https://cucumber.io/docs" class="bare">https://cucumber.io/docs</a> for all Cucumber implementations and framework implementations.</p>
</div>
<div class="paragraph">
<p>Also, IDEs such as Intellij offer several plugins for Cucumber support.</p>
</div>
</div>
<div class="sect5">
<h6 id="selenium-2"><a class="anchor" href="#selenium-2"></a>==  Selenium</h6>
<div class="paragraph">
<p>Selenium has the support of some of the largest browser vendors who have taken (or are taking) steps to make Selenium a native part of their browser. It is also the core technology in countless other browser automation tools, APIs and frameworks.</p>
</div>
</div>
<div class="sect5">
<h6 id="automation-process"><a class="anchor" href="#automation-process"></a>Automation process</h6>

</div>
<div class="sect5">
<h6 id="write-a-feature-file"><a class="anchor" href="#write-a-feature-file"></a>==  Write a feature file</h6>
<div class="paragraph">
<p>Test automation in Cucumber starts with writing a feature file. A feature normally consists of several (test)scenarios and each scenario consists of several steps.</p>
</div>
<div class="paragraph">
<p>Feature: Refund item</p>
</div>
<div class="paragraph">
<p>Scenario: Jeff returns a faulty microwave</p>
</div>
<div class="paragraph">
<p>Given Jeff has bought a microwave for $100</p>
</div>
<div class="paragraph">
<p>And he has a receipt</p>
</div>
<div class="paragraph">
<p>When he returns the microwave</p>
</div>
<div class="paragraph">
<p>Then Jeff should be refunded $100</p>
</div>
<div class="paragraph">
<p>Above example shows a feature “Refund item” with one scenario “Jeff returns a faulty microwave”. The scenario consists of four steps each starting with a key word (Given, And, When, Then).</p>
</div>
</div>
<div class="sect5">
<h6 id="implementing-the-steps"><a class="anchor" href="#implementing-the-steps"></a>==  Implementing the steps</h6>
<div class="paragraph">
<p>Next the steps are implemented. Assuming we use Java to implement the steps, the Java code will look something like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class MyStepdefs \{

	@Given("Jeff has bought a microwave for $(\d+)")

	public void Jeff_has_bought_a_microwave_for(int amount) \{

		// implementation can be plain java

		// or selenium

		driver.findElement(By.name("test")).sendKeys("This is an example\n");

		driver.findElement(By.name("button")).click();// etc
	}
}</pre>
</div>
</div>
<div class="paragraph">
<p>Cucumber uses an annotation (highlighted) to match the step from the feature file with the function implementing the step in the Java class. The name of the class and the function can be as the developer sees fit. Selenium code can be used within the function to automate interaction with the browser.</p>
</div>
</div>
<div class="sect5">
<h6 id="running-scenarios"><a class="anchor" href="#running-scenarios"></a>==  Running scenarios</h6>
<div class="paragraph">
<p>There are several ways to run scenarios with Cucumber, for example the JUnit runner, a command line runner and several third party runners.</p>
</div>
</div>
<div class="sect5">
<h6 id="reporting-test-results"><a class="anchor" href="#reporting-test-results"></a>==  Reporting test results</h6>
<div class="paragraph">
<p>Cucumber can report results in several different formats, using formatter plugins</p>
</div>
</div>
<div class="sect5">
<h6 id="features-3"><a class="anchor" href="#features-3"></a>Features</h6>

</div>
<div class="sect5">
<h6 id="feature-files-using-gherkin"><a class="anchor" href="#feature-files-using-gherkin"></a>==  Feature files using Gherkin</h6>
<div class="paragraph">
<p>Cucumber executes your feature files. As shown in the example below, feature files in Gherkin are easy to read so they can be shared between IT and business. Data tables can be used to execute a scenario with different inputs.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image42.png" alt="image42">
</div>
</div>
</div>
<div class="sect5">
<h6 id="organizing-tests"><a class="anchor" href="#organizing-tests"></a>==  Organizing tests</h6>
<div class="paragraph">
<p>Feature files are placed in a directory structure and together form a feature tree.</p>
</div>
<div class="paragraph">
<p>Tags can be used to group features based on all kinds of categories. Cucumber can include or exclude tests with certain tags when running the tests.</p>
</div>
</div>
<div class="sect5">
<h6 id="reporting-test-results-2"><a class="anchor" href="#reporting-test-results-2"></a>Reporting test results</h6>
<div class="paragraph">
<p>Cucumber can report results in several formats, using formatter plugins.
Not supported option by Shared Services: The output from Cucumber can be used to present test results in Jenkins or Hudson depending of the preference of the project.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image43.png" alt="image43">
</div>
</div>
</div>
<div class="sect5">
<h6 id="how-is-cucumber-selenium-used-at-capgemini"><a class="anchor" href="#how-is-cucumber-selenium-used-at-capgemini"></a>HOW IS Cucumber / Selenium USED AT Capgemini?</h6>

</div>
<div class="sect5">
<h6 id="tool-deployment"><a class="anchor" href="#tool-deployment"></a>Tool deployment</h6>
<div class="paragraph">
<p>Cucumber and Selenium are chosen as one of Capgemini’s test automation industrial tools. We support the Java implementation of Cucumber and Selenium Webdriver. We can help with creating Cucumber, Selenium projects in Eclipse and IntelliJ.</p>
</div>
</div>
<div class="sect5">
<h6 id="application-in-ataas-automated-testing-as-a-service"><a class="anchor" href="#application-in-ataas-automated-testing-as-a-service"></a>Application in ATaaS (Automated Testing as a Service)</h6>
<div class="paragraph">
<p>In the context of industrialisation, Capgemini has developed a range of services to assist and support the projects in process and tools implementation.</p>
</div>
<div class="paragraph">
<p>In this context a team of experts assists projects using test automation.</p>
</div>
<div class="paragraph">
<p>The main services provided by the center of expertise are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Advise on the feasibility of automation.</p>
</li>
<li>
<p>Support with installation.</p>
</li>
<li>
<p>Coaching teams in the use of BDD.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="run-on-independent-operation-systems"><a class="anchor" href="#run-on-independent-operation-systems"></a>Run on independent Operation Systems</h6>
<div class="paragraph">
<p>As <em>E2E Allure test framework</em> is build on top of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Java 1.8</p>
</li>
<li>
<p>Maven 3.3</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>This guarantees portability to all operating systems.</strong></p>
</div>
<div class="paragraph">
<p><em>E2E Allure test framework</em> can run on OS:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Windows,</p>
</li>
<li>
<p>Linux and</p>
</li>
<li>
<p>Mac.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Test creation and maintenance in <em>E2E Allure test framework</em> can be done with any type of IDE:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Eclipse,</p>
</li>
<li>
<p>IntelliJ,</p>
</li>
<li>
<p>WebStorm,</p>
</li>
<li>
<p>Visual Studio Code,</p>
</li>
<li>
<p>many more that support Java + Maven.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="system-under-test-environments"><a class="anchor" href="#system-under-test-environments"></a>System under test environments</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image44.png" alt="image44">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Quality assurance</em> or QA is a way of preventing mistakes or defects in manufactured products and avoiding problems when delivering solutions or services to customers; which ISO 9000 defines as "part of quality management focused on providing confidence that quality requirements will be fulfilled".</p>
</li>
<li>
<p><em>System integration testing</em> or SIT is a high-level software testing process in which testers verify that all related systems maintain data integrity and can operate in coordination with other systems in the same environment. The testing process ensures that all sub-components are integrated successfully to provide expected results.</p>
</li>
<li>
<p><em>Development</em> or <em>Dev</em> testing is performed by the software developer or engineer during the construction phase of the software development life-cycle. Rather than replace traditional QA focuses, it augments it. Development testing aims to eliminate construction errors before code is promoted to QA; this strategy is intended to increase the quality of the resulting software as well as the efficiency of the overall development and QA process.</p>
</li>
<li>
<p><em>Prod</em> If the customer accepts the product, it is deployed to a <em>production</em> environment, making it available to all users of the system.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image45.png" alt="image45">
</div>
</div>
</div>
<div class="sect5">
<h6 id="how-to-use-system-environment"><a class="anchor" href="#how-to-use-system-environment"></a>How to use system environment</h6>
<div class="paragraph">
<p>In Page classes, when you load / start web, it is uncommon to save fixed main url.</p>
</div>
<div class="paragraph">
<p>Value flexibility is a must, when your web application under test, have different main url, dependence on environmnent (DEV, QA, SIT, &#8230;&#8203;, PROD)</p>
</div>
<div class="paragraph">
<p>Instead of hard coded main url variable, you build your Page classe with dynamic variable.</p>
</div>
<div class="paragraph">
<p>Example of dynamic variable <code>GetEnvironmentParam.WWW_FONT_URL</code></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image46.png" alt="image46">
</div>
</div>
</div>
<div class="sect5">
<h6 id="how-to-create-update-system-environment"><a class="anchor" href="#how-to-create-update-system-environment"></a>How to create / update system environment</h6>

</div>
<div class="sect5">
<h6 id="external-file-with-variable-values"><a class="anchor" href="#external-file-with-variable-values"></a>External file with variable values</h6>
<div class="paragraph">
<p>Dynamic variable values are stored under path <em>mrchecker-app-under-test\src\resources\enviroments\environments.csv</em>.</p>
</div>
<div class="paragraph">
<p><strong>NOTE</strong>: As environments.csv is Comma-separated file, please be aware of any edition and then save it under Excel.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image47.png" alt="image47">
</div>
</div>
</div>
<div class="sect5">
<h6 id="encrypting-sensitive-data"><a class="anchor" href="#encrypting-sensitive-data"></a>Encrypting sensitive data</h6>
<div class="paragraph">
<p>Some types of data you might want to store as environment settings are sensitive in nature (e.g. passwords). You might not want to store them (at least not in their plaintext form) in your repository. To be able to encrypt sensitive data you need to do following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a secret (long, random chain of characters) and store it under <em>mrchecker-app-under-test\src\resources\secretData.txt</em>. Example: <code>LhwbTm9V3FUbBO5Tt5PiTUEQrXGgWrDLCMthnzLKNy1zA5FVTFiTdHRQAyPRIGXmsAjPUPlJSoSLeSBM</code></p>
</li>
<li>
<p>Exclude the file from being checked into the git repository by adding it to <em>git.ignore</em>. You will need to pass the file over a different channel among your teammates.</p>
</li>
<li>
<p>Encrypt the values before putting them into the <em>environments.csv</em> file by creating following script (put the script where your jasypt library resides, e.g. <em>C:\MrChecker_Test_Framework\m2\repository\org\jasypt\jasypt\1.9.2)</em>:</p>
<div class="listingblock">
<div class="content">
<pre>@ECHO OFF

set SCRIPT_NAME=encrypt.bat
set EXECUTABLE_CLASS=org.jasypt.intf.cli.JasyptPBEStringEncryptionCLI
set EXEC_CLASSPATH=jasypt-1.9.2.jar
if "%JASYPT_CLASSPATH%" ==  "" goto computeclasspath
set EXEC_CLASSPATH=%EXEC_CLASSPATH%;%JASYPT_CLASSPATH%

:computeclasspath
IF "%OS%" ==  "Windows_NT" setlocal ENABLEDELAYEDEXPANSION
FOR %%c in (%~dp0..\lib\*.jar) DO set EXEC_CLASSPATH=!EXEC_CLASSPATH!;%%c
IF "%OS%" ==  "Windows_NT" setlocal DISABLEDELAYEDEXPANSION

set JAVA_EXECUTABLE=java
if "%JAVA_HOME%" ==  "" goto execute
set JAVA_EXECUTABLE="%JAVA_HOME%\bin\java"

:execute
%JAVA_EXECUTABLE% -classpath %EXEC_CLASSPATH% %EXECUTABLE_CLASS% %SCRIPT_NAME% %*</pre>
</div>
</div>
</li>
<li>
<p>Encrypt the values by calling</p>
<div class="listingblock">
<div class="content">
<pre>.\encrypt.bat input=someinput password=secret

----ENVIRONMENT-----------------

Runtime: Oracle Corporation Java HotSpot(TM) 64-Bit Server VM 25.111-b14



----ARGUMENTS-------------------

input: someinput
password: secret



----OUTPUT----------------------

JN3nOFol2GMZoUxR5z2wI2qdipcNH1UD</pre>
</div>
</div>
</li>
<li>
<p>Mark the value as encrypted by adding a prefix 'ENC(' and suffix ')' like: <code>ENC(JN3nOFol2GMZoUxR5z2wI2qdipcNH1UD)</code></p>
<div class="imageblock">
<div class="content">
<img src="_images/images/image48.png" alt="image48">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="bridge-between-external-file-nad-page-class"><a class="anchor" href="#bridge-between-external-file-nad-page-class"></a>Bridge between external file nad Page class</h6>
<div class="paragraph">
<p>To map values from external file with Page class you ought to use class <code>GetEnvironmentParam</code>.</p>
</div>
<div class="paragraph">
<p>Therefore when you add new variable (row) in <em>environments.csv</em> you might need to add this variable to <code>GetEnvironmentParam</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image49.png" alt="image49">
</div>
</div>
</div>
<div class="sect5">
<h6 id="run-test-case-with-system-environment"><a class="anchor" href="#run-test-case-with-system-environment"></a>Run test case with system environment</h6>
<div class="paragraph">
<p>To run test case with system environment, please use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>-Denv=&lt;NameOfEnvironment&gt;</em></p>
</li>
<li>
<p><em>&lt;NameOfEnvironment&gt;</em> is taken as column name from file <em>mrchecker-app-under-test\src\test\resources\enviroments\environments.csv</em></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="command-line"><a class="anchor" href="#command-line"></a>Command Line</h6>
<div class="literalblock">
<div class="content">
<pre>mvn test site -Dtest=RegistryPageTest -Denv=DEV</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="eclipse-3"><a class="anchor" href="#eclipse-3"></a>Eclipse</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image50.png" alt="image50">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image51.png" alt="image51">
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect5">
<h6 id="system-under-test-environments-2"><a class="anchor" href="#system-under-test-environments-2"></a>System under test environments</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image080.png" alt="image080">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Quality assurance</strong> or <strong>QA</strong> is a way of preventing mistakes or defects in the manufactured products and avoiding problems when delivering solutions or services to customers which ISO 9000 defines as "part of quality management focused on providing confidence that quality requirements will be fulfilled".</p>
</li>
<li>
<p><strong>System integration testing</strong> or <strong>SIT</strong> is a high-level software testing process in which testers verify that all related systems maintain data integrity and can operate in coordination with other systems in the same environment. The testing process ensures that all sub-components are integrated successfully to provide expected results.</p>
</li>
<li>
<p><strong>Development</strong> or <strong>Dev</strong> testing is performed by the software developer or engineer during the construction phase of the software development life-cycle. Rather than replace traditional QA focuses, it augments it. Development testing aims to eliminate construction errors before code is promoted to QA; this strategy is intended to increase the quality of the resulting software as well as the efficiency of the overall development and QA process.</p>
</li>
<li>
<p><strong>Prod</strong> If the customer accepts the product, it is deployed to a <strong>production</strong> environment, making it available to all users of the system.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image051.png" alt="image051">
</div>
</div>
</div>
<div class="sect5">
<h6 id="how-to-use-system-environment-2"><a class="anchor" href="#how-to-use-system-environment-2"></a>How to use system environment</h6>
<div class="paragraph">
<p>In Page classes, when you load / start web, it is uncommon to save fixed main url.</p>
</div>
<div class="paragraph">
<p>Value flexibility is a must, when your web application under test has different main url, depending on the environmnent (DEV, QA, SIT, &#8230;&#8203;, PROD)</p>
</div>
<div class="paragraph">
<p>Instead of <strong>hard coded</strong> main url variable, you build your Page classes with dynamic variable.</p>
</div>
<div class="paragraph">
<p>An example of dynamic variable <strong>GetEnvironmentParam.WWW_FONT_URL</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image081.png" alt="image081">
</div>
</div>
</div>
<div class="sect5">
<h6 id="how-to-create-update-system-environment-2"><a class="anchor" href="#how-to-create-update-system-environment-2"></a>How to create / update system environment</h6>

</div>
<div class="sect5">
<h6 id="external-file-with-variable-values-2"><a class="anchor" href="#external-file-with-variable-values-2"></a>External file with variable values</h6>
<div class="paragraph">
<p>Dynamic variable values are stored under  <strong>mrchecker-app-under-test\src\resources\enviroments\environments.csv</strong>.</p>
</div>
<div class="paragraph">
<p><strong>NOTE:</strong> As environments.csv is a comma-separated file, please be careful while editing and then save it under Excel.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image082.png" alt="image082">
</div>
</div>
</div>
<div class="sect5">
<h6 id="encrypting-sensitive-data-2"><a class="anchor" href="#encrypting-sensitive-data-2"></a>Encrypting sensitive data</h6>
<div class="paragraph">
<p>Some types of data you might want to store as environment settings are sensitive in nature (e.g. passwords). You might not want to store them (at least not in their plaintext form) in your repository. To be able to encrypt sensitive data you need to do following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a secret (long, random chain of characters) and store it under <strong>mrchecker-app-under-test\src\resources\secretData.txt</strong>. Example: <code>LhwbTm9V3FUbBO5Tt5PiTUEQrXGgWrDLCMthnzLKNy1zA5FVTFiTdHRQAyPRIGXmsAjPUPlJSoSLeSBM</code></p>
</li>
<li>
<p>Exclude the file from being checked into the git repository by adding it to <strong>git.ignore</strong>. You will need to pass the file over a different channel among your teammates.</p>
</li>
<li>
<p>Encrypt the values before putting them into the <strong>environments.csv</strong> file by creating following script (put the script where your jasypt library resides, e.g. <strong>C:\MrChecker_Test_Framework\m2\repository\org\jasypt\jasypt\1.9.2</strong>):</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>@ECHO OFF

set SCRIPT_NAME=encrypt.bat
set EXECUTABLE_CLASS=org.jasypt.intf.cli.JasyptPBEStringEncryptionCLI
set EXEC_CLASSPATH=jasypt-1.9.2.jar
if "%JASYPT_CLASSPATH%" ==  "" goto computeclasspath
set EXEC_CLASSPATH=%EXEC_CLASSPATH%;%JASYPT_CLASSPATH%

:computeclasspath
IF "%OS%" ==  "Windows_NT" setlocal ENABLEDELAYEDEXPANSION
FOR %%c in (%~dp0..\lib\*.jar) DO set EXEC_CLASSPATH=!EXEC_CLASSPATH!;%%c
IF "%OS%" ==  "Windows_NT" setlocal DISABLEDELAYEDEXPANSION

set JAVA_EXECUTABLE=java
if "%JAVA_HOME%" ==  "" goto execute
set JAVA_EXECUTABLE="%JAVA_HOME%\bin\java"

:execute
%JAVA_EXECUTABLE% -classpath %EXEC_CLASSPATH% %EXECUTABLE_CLASS% %SCRIPT_NAME% %*</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Encrypt the values by calling</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>.\encrypt.bat input=someinput password=secret

----ENVIRONMENT-----------------

Runtime: Oracle Corporation Java HotSpot(TM) 64-Bit Server VM 25.111-b14



----ARGUMENTS-------------------

input: someinput
password: secret



----OUTPUT----------------------

JN3nOFol2GMZoUxR5z2wI2qdipcNH1UD</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Mark the value as encrypted by adding a prefix 'ENC(' and suffix ')' like: <code>ENC(JN3nOFol2GMZoUxR5z2wI2qdipcNH1UD)</code></p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image083.png" alt="image083">
</div>
</div>
</div>
<div class="sect5">
<h6 id="bridge-between-external-file-nad-page-class-2"><a class="anchor" href="#bridge-between-external-file-nad-page-class-2"></a>Bridge between external file nad Page class</h6>
<div class="paragraph">
<p>To map values from external file with Page class you ought to use class <strong>GetEnvironmentParam</strong></p>
</div>
<div class="paragraph">
<p>Therefore when you add new variable (row) in <strong>environments.csv</strong> you might need to add this variable to <strong>GetEnvironmentParam</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image084.png" alt="image084">
</div>
</div>
</div>
<div class="sect5">
<h6 id="run-test-case-with-system-environment-2"><a class="anchor" href="#run-test-case-with-system-environment-2"></a>Run test case with system environment</h6>
<div class="paragraph">
<p>To run test case with system environment, please use:
* <strong>-Denv=\&lt;NameOfEnvironment\&gt;</strong>
* <strong>\&lt;NameOfEnvironment\&gt;</strong> is taken as column name from file <strong>mrchecker-app-under-test\src\test\resources\enviroments\environments.csv</strong></p>
</div>
<div class="paragraph">
<p><strong>Since mrchecker-core-module version 5.6.2.1</strong>
==  Command Line</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn test site -Dgroups=RegistryPageTestTag -Denv=DEV</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="eclipse-4"><a class="anchor" href="#eclipse-4"></a>Eclipse</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image085.png" alt="image085">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image086_new.png" alt="image086 new">
</div>
</div>
<div class="paragraph">
<p><strong>Prior to mrchecker-core-module version 5.6.2.1</strong>
==  Command Line</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn test site -Dtest=RegistryPageTest -Denv=DEV</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="eclipse-5"><a class="anchor" href="#eclipse-5"></a>Eclipse</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image085.png" alt="image085">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image086.png" alt="image086">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="selenium-module"><a class="anchor" href="#selenium-module"></a>26.12. Selenium Module</h3>
<!-- toc disabled -->
<div class="sect5">
<h6 id="selenium-test-module"><a class="anchor" href="#selenium-test-module"></a>Selenium Test Module</h6>

</div>
<div class="sect5">
<h6 id="what-is-mrchecker-e2e-selenium-test-module"><a class="anchor" href="#what-is-mrchecker-e2e-selenium-test-module"></a>What is MrChecker E2E Selenium Test Module</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image2.png" alt="image2">
</div>
</div>
</div>
<div class="sect5">
<h6 id="selenium-structure"><a class="anchor" href="#selenium-structure"></a>Selenium Structure</h6>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Selenium-Test-Module-What-is-Selenium.adoc">What is Selenium</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Selenium-Test-Module-What-is-WebDriver.adoc">What is WebDriver</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Selenium-Test-Module-What-is-Page-Object-Model-Pattern.adoc">What is Page Object Model/Pattern</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="framework-features"><a class="anchor" href="#framework-features"></a>Framework Features</h6>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Selenium-Test-Module-Construction-of-Framework-Page-Class.adoc">Construction of Framework Page Class</a></p>
<div class="ulist">
<ul>
<li>
<p>Every Page class must extend BasePage</p>
</li>
<li>
<p>What are <code>isLoaded()</code>, <code>load()</code> and <code>pageTitle()</code> for</p>
</li>
<li>
<p>How to create selector variable - <code>private static final By ButtonOkSelector = By.Css(…​)</code></p>
</li>
<li>
<p>How to prepare an 'everlasting' selector</p>
</li>
<li>
<p>Method/action naming convention</p>
</li>
<li>
<p>Why we should use <code>findElementDynamic()</code> and <code>findElementQuietly()</code> instead of classic Selenium <code>findElement</code></p>
</li>
<li>
<p>List of well-rounded groups of user friendly actions (<code>ElementButton</code>, <code>ElementCheckbox</code>, <code>ElementInput</code>, etc.)</p>
</li>
<li>
<p>Verification points of well-defined Page classes and Test classes</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Selenium-Test-Module-Run-with-different-browser-options.adoc">Run on different browsers: Chrome, Firefox, IE, Safari, Edge</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Selenium-Test-Module-Run-on-different-browsers.adoc">Run with different browser options</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Selenium-Test-Module-Run-with-full-range-of-resolution.adoc">Run with full range of resolution (mobile, desktop): Testing responsible Design Webpage</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="how-to-start-2"><a class="anchor" href="#how-to-start-2"></a>How to start?</h6>
<div class="paragraph">
<p>Read: <a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Selenium-Test-Module-Building-basic-Selenium-Test.adoc">My first Selenium Test</a></p>
</div>
</div>
<div class="sect5">
<h6 id="selenium-best-practices"><a class="anchor" href="#selenium-best-practices"></a>Selenium Best Practices</h6>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Selenium-Test-Module-Selenium-Best-Practices.adoc">Table of best practices</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="selenium-uft-comparison"><a class="anchor" href="#selenium-uft-comparison"></a>Selenium UFT Comparison</h6>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Selenium-Test-Module-Selenium-UFT-Comparison.adoc">Selenium UFT Comparison</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="selenium-structure-2"><a class="anchor" href="#selenium-structure-2"></a>26.13. Selenium Structure</h3>
<div class="sect5">
<h6 id="what-is-selenium"><a class="anchor" href="#what-is-selenium"></a>What is Selenium</h6>
<div class="paragraph">
<p>Selenium is a framework for testing browser applications. The test automation supports:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Frequent regression testing</p>
</li>
<li>
<p>Repeating test case executions</p>
</li>
<li>
<p>Documentation of test cases</p>
</li>
<li>
<p>Finding defects</p>
</li>
<li>
<p>Multiple Browsers</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Selenium testing framework consists of multiple tools:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Selenium IDE</strong></p>
<div class="paragraph">
<p>The Selenium Integrated Development Environment is a prototyping tool for building test scripts. It is a Firefox Plugin and provides an easy-to-use interface for developing test cases. Additionally, Selenium IDE contains a recording feature, that allows the user to record user inputs that can be automatically re-executed in future.</p>
</div>
</li>
<li>
<p><strong>Selenium 1</strong></p>
<div class="paragraph">
<p>Selenium 1, also known as Selenium RC, commands a Selenium Server to launch and kill browsers, interpreting the Selenese commands passed from the test program. The Server acts as an HTTP proxy. <strong>This tool is deprecated</strong>.</p>
</div>
</li>
<li>
<p><strong>Selenium 2</strong></p>
<div class="paragraph">
<p>Selenium 2, also known as Selenium WebDriver, is designed to supply a well-designed, object-oriented API that provides improved support for modern advanced web-app testing problems.</p>
</div>
</li>
<li>
<p><strong>Selenium 3.0</strong></p>
<div class="paragraph">
<p>The major change in Selenium 3.0 is removing the original Selenium Core implementation and replacing it with one backed by WebDriver. There is now a W3C specification for browser automation, based on the Open Source WebDriver.</p>
</div>
</li>
<li>
<p><strong>Selenium Grid</strong></p>
<div class="paragraph">
<p>Selenium Grid allows the scaling of Selenium RC test cases, that must be run in multiple and potentially variable environments. The tests can be run in parallel on different remote machines.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="selenium-on-the-production-line"><a class="anchor" href="#selenium-on-the-production-line"></a>Selenium on the Production Line</h6>
<div class="paragraph">
<p>More information on Selenium on the Production Line can be found <a href="https://km3.capgemini.com/book/1051672">here</a>.</p>
</div>
<div class="paragraph">
<p><strong>tl;dr</strong></p>
</div>
<div class="paragraph">
<p>The Production Line has containers running Chrome and Firefox Selenium Nodes. The communication with these nodes is accomplished using Selenium Grid.</p>
</div>
<div class="paragraph">
<p>Having issues using Selenium on the Production Line? Check the Production Line <a href="https://km3.capgemini.com/book/1074416">issue list</a>, maybe it’s a known issue that can be worked around.</p>
</div>
</div>
<div class="sect5">
<h6 id="what-is-webdriver"><a class="anchor" href="#what-is-webdriver"></a>What is WebDriver</h6>
<div class="paragraph">
<p>On the one hand, it is a very convenient API for a programmer that allows for interaction with the browser, on the other hand it is a driver concept that enables this direct communication.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image53.png" alt="image53">
</div>
</div>
</div>
<div class="sect5">
<h6 id="how-does-it-work"><a class="anchor" href="#how-does-it-work"></a>==  How does it work?</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image54.png" alt="image54">
</div>
</div>
<div class="paragraph">
<p>A tester, through their test script, can command WebDriver to perform certain actions on the WAUT on a certain browser. The way the user can command WebDriver to perform something is by using the client libraries or language bindings provided by WebDriver.</p>
</div>
<div class="paragraph">
<p>By using the language-binding client libraries, a tester can invoke browser-specific implementations of WebDriver, such as Firefox Driver, IE Driver, Opera Driver, and so on, to interact with the WAUT of the respective browser. These browser-specific implementations of WebDriver will work with the browser natively and execute commands from outside the browser to simulate exactly what the application user does.</p>
</div>
<div class="paragraph">
<p>After execution, WebDriver will send the test result back to the test script for developer&#8217;s analysis.</p>
</div>
</div>
<div class="sect5">
<h6 id="what-is-page-object-model"><a class="anchor" href="#what-is-page-object-model"></a>What is Page Object Model?</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image55.png" alt="image55">
</div>
</div>
<div class="paragraph">
<p>Creating Selenium test cases can result in an unmaintainable project. One of the reasons is that too much duplicated code is used. Duplicated code could result from duplicated functionality leading to duplicated usage of locators. The main disadvantage of duplicated code is that the project is less maintainable. If a locator changes, you have to walk through the whole test code to adjust locators where necessary. By using the page object model we can make non-brittle test code and reduce or eliminate duplicate test code. In addition, it improves the readability and allows us to create interactive documentation. Last but not least, we can create tests with less keystroke. An implementation of the page object model can be achieved by separating the abstraction of the test object and the test scripts.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image56.png" alt="image56">
</div>
</div>
</div>
<div class="sect5">
<h6 id="basic-web-elements"><a class="anchor" href="#basic-web-elements"></a>Basic Web elements</h6>
<div class="paragraph">
<p>This page will provide an overview of basic web elements.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image57.png" alt="image57">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image58.png" alt="image58">
</div>
</div>
<div class="paragraph">
<p>|== =
|Name
|Method to use element</p>
</div>
<div class="paragraph">
<p>|Form: Input Text
|<code>elementInputText()</code></p>
</div>
<div class="paragraph">
<p>|Form: Label
|<code>elementLabel()</code></p>
</div>
<div class="paragraph">
<p>|Form: Submit Button
|<code>elementButton()</code></p>
</div>
<div class="paragraph">
<p>|Page: Button
|<code>elementButton()</code></p>
</div>
<div class="paragraph">
<p>|Checkbox
|<code>elementCheckbox()</code></p>
</div>
<div class="paragraph">
<p>|Radio
|<code>elementRadioButton()</code></p>
</div>
<div class="paragraph">
<p>|Elements (Tabs, Cards, Account, etc.)
|<code>elementTab()</code></p>
</div>
<div class="paragraph">
<p>|Dropdown List
|<code>elementDropdownList()</code></p>
</div>
<div class="paragraph">
<p>|Link
|-</p>
</div>
<div class="paragraph">
<p>|Combobox
|<code>elementList()</code>
|== =</p>
</div>
<div class="paragraph">
<p>Comparision how picking value from <code>checkbox</code> can be done:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>by classic Selenium atomic actions</p>
</li>
<li>
<p>by our enhanced Selenium wrapper</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Classic Selenium atomic actions</p>
</div>
<div class="listingblock">
<div class="content">
<pre>List&lt;WebElement&gt; checkboxesList = getDriver()
                .findElements(selectorHobby);
WebElement currentElement;
for (int i = 0; i &lt; checkboxesList.size(); i++) {
    currentElement = checkboxesList.get(i);
    if (currentElement.getAttribute("value")
                    .equals(hobby.toString()) &amp;&amp; currentElement.isSelected() != true)
                        {
        currentElement.click();
            }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Enhanced Selenium in E2E test framework</p>
</div>
<div class="listingblock">
<div class="content">
<pre>getDriver().elementCheckbox(selectorHobby)
				.setCheckBoxByValue(hobby.toString());</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="framework-features-2"><a class="anchor" href="#framework-features-2"></a>26.14. Framework Features</h3>
<div class="sect5">
<h6 id="page-class"><a class="anchor" href="#page-class"></a>Page Class</h6>
<div class="paragraph">
<p>Page Object Models allow for the representation of a webpage as a Java Class. The class contains all required web elements like buttons, textfields, labels, etc. When initializing a new project, create a new package to store the Page Object Models in.</p>
</div>
</div>
<div class="sect5">
<h6 id="initialization"><a class="anchor" href="#initialization"></a>Initialization</h6>
<div class="paragraph">
<p><strong>Source folder</strong>: <em>allure-app-under-test/src/main/java</em></p>
</div>
<div class="paragraph">
<p><strong>Name</strong>: <code>com.example.selenium.pages.YOUR_PROJECT</code></p>
</div>
<div class="paragraph">
<p>Classes being created inside of this new package have to extend the <strong>BasePage</strong> class. As a result, a few abstract methods from <strong>BasePage</strong> have to be implemented.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class DemoPage extends BasePage {

	@Override
	public boolean isLoaded() {

	}

	@Override
	public void load() {

	}

	@Override
	public String pageTitle() {

	}
}</pre>
</div>
</div>
<div class="paragraph">
<p>The example above demonstrates a minimum valid Page Object class with all required methods included.</p>
</div>
</div>
<div class="sect5">
<h6 id="basepage-method-isloaded"><a class="anchor" href="#basepage-method-isloaded"></a>BasePage method: isLoaded</h6>
<div class="paragraph">
<p>The inherited method <code>isLoaded()</code> can be used to check if the current Page Object Model has been loaded correctly. There are multiple ways to verify a correctly loaded page. One example would be to compare the actual page title with the expected page title.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public boolean isLoaded() {
	if(getDriver().getTitle().equals("EXPECTED_TITLE")) {
		return true;
	}
	return false;
}</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="basepage-method-load"><a class="anchor" href="#basepage-method-load"></a>BasePage method: load</h6>
<div class="paragraph">
<p>The method <code>load()</code> can be used to tell the webdriver to load a specific page.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public void load() {
	getDriver().get("http://SOME_PAGE");
}</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="basepage-method-pagetitle"><a class="anchor" href="#basepage-method-pagetitle"></a>BasePage method: pageTitle</h6>
<div class="paragraph">
<p>The <code>pageTitle()</code> method returns a String containing the page title.</p>
</div>
</div>
<div class="sect5">
<h6 id="creating-a-selector-variable"><a class="anchor" href="#creating-a-selector-variable"></a>Creating a selector variable</h6>
<div class="paragraph">
<p>To initialize web elements, a large variety of selectors can be used.</p>
</div>
<div class="paragraph">
<p>We recommend creating  a private and constant field for every web element you’d like to represent in Java. Use the guide above to find the preferred selector and place it in the code below at "WEB_ELEMENT_SELECTOR".</p>
</div>
<div class="listingblock">
<div class="content">
<pre>private static final By someWebElementSelector = By.CSS("WEB_ELEMENT_SELECTOR");</pre>
</div>
</div>
<div class="paragraph">
<p>As soon as you create the selector above, you can make use of it to initialize a WebElement object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>WebElement someWebElement = getDriver().findDynamicElement(someWebElementSelector);</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Note</strong>: The examples displayed in the <em>cssSelector.docx</em> file use the Selenium method <code>driver.findElement()</code> to find elements. However, using this framework we recommend  <code>findDynamicElement()</code> or <code>findQuietlyElement().findDynamicElement()</code> allows waiting for dynamic elements, for example buttons that pop up.</p>
</div>
</div>
<div class="sect5">
<h6 id="creating-a-page-method"><a class="anchor" href="#creating-a-page-method"></a>Creating a page method</h6>
<div class="paragraph">
<p>To interact with the page object, we recommend creating methods for each action.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public void enterGoogleSearchInput(String query) {
	...
}</pre>
</div>
</div>
<div class="paragraph">
<p>Creating a method like the one above allows the test case to run something like <code>googleSearchPage.enterGoogleSearchInput("Hello")</code> to interact with the page object.</p>
</div>
</div>
<div class="sect5">
<h6 id="naming-conventions-5"><a class="anchor" href="#naming-conventions-5"></a>Naming Conventions</h6>
<div class="paragraph">
<p>For code uniformity and readability, we provide a few method naming conventions.</p>
</div>
<div class="paragraph">
<p>|== =</p>
</div>
<div class="paragraph">
<p>|Element
|Action
|Name (example)</p>
</div>
<div class="paragraph">
<p>|Form: Input text
|enter
|<code>enterUsernameInput()</code></p>
</div>
<div class="paragraph">
<p>|
|is (label)
|<code>isUsernameInputPresent()</code></p>
</div>
<div class="paragraph">
<p>|
|is (value)
|<code>isUsernameEmpty()</code></p>
</div>
<div class="paragraph">
<p>|
|get
|<code>getUsernameValue()</code></p>
</div>
<div class="paragraph">
<p>|Form: Label
|get
|<code>getCashValue()</code></p>
</div>
<div class="paragraph">
<p>|
|is (value)
|<code>isCashValueEmpty()</code></p>
</div>
<div class="paragraph">
<p>|
|is (label)
|<code>isCashLabelPresent()</code></p>
</div>
<div class="paragraph">
<p>|Form: Submit Button
|submit
|<code>submitLoginForm()</code></p>
</div>
<div class="paragraph">
<p>|
|is
|<code>isLoginFormPresent()</code></p>
</div>
<div class="paragraph">
<p>|Page: Button
|click
|<code>clickInfoButton()</code></p>
</div>
<div class="paragraph">
<p>|
|is
|<code>isInfoButtonpresent()</code></p>
</div>
<div class="paragraph">
<p>|Checkbox
|set
|<code>setRememberMeCheckbox()</code></p>
</div>
<div class="paragraph">
<p>|
|unset
|<code>unsetRememberMeCheckbox()</code></p>
</div>
<div class="paragraph">
<p>|
|is (present)
|<code>isRememberMeCheckboxPresent()</code></p>
</div>
<div class="paragraph">
<p>|
|is (value)
|<code>isRememberMeCheckboxSet()</code></p>
</div>
<div class="paragraph">
<p>|Radio
|set
|<code>setMaleRadioValue("Woman")</code></p>
</div>
<div class="paragraph">
<p>|
|is (present)
|<code>isMaleRadioPresent()</code></p>
</div>
<div class="paragraph">
<p>|
|is (visible)
|<code>isMaleRadioVisible()</code></p>
</div>
<div class="paragraph">
<p>|
|get
|<code>getSelectedMaleValue()</code></p>
</div>
<div class="paragraph">
<p>|Elements (Tabs, Cards, Account, etc.)
|click
|<code>clickPositionTab()</code> / <code>clickMyBilanceCard()</code></p>
</div>
<div class="paragraph">
<p>|
|is
|<code>isMyBilanceCardPresent()</code></p>
</div>
<div class="paragraph">
<p>|Dropdown List
|select
|<code>selectAccountTypeValue(typeName)</code></p>
</div>
<div class="paragraph">
<p>|
|unselect
|<code>unselectAccountTypeValue(typeName)</code></p>
</div>
<div class="paragraph">
<p>|
|multiple select
|<code>selectAccountTypesValues(List typeNames)</code></p>
</div>
<div class="paragraph">
<p>|
|is (list)
|<code>isAccountTypeDropdownListPresent()</code></p>
</div>
<div class="paragraph">
<p>|
|is (element present)
|<code>isAccountTypeElementPresent(typeName)</code></p>
</div>
<div class="paragraph">
<p>|
|is (element selected)
|<code>isAccountTypeSelected(typeName)</code></p>
</div>
<div class="paragraph">
<p>|Link
|click
|<code>clickMoreLink()</code></p>
</div>
<div class="paragraph">
<p>|
|is
|<code>isMoreLinkPresent()</code></p>
</div>
<div class="paragraph">
<p>|Combobox
|select
|<code>selectSortCombobox()</code></p>
</div>
<div class="paragraph">
<p>|
|is (present)
|<code>isSortComboboxPresent(name)</code></p>
</div>
<div class="paragraph">
<p>|
|is (contain)
|<code>selectSortComboboxContain(name)</code></p>
</div>
<div class="paragraph">
<p>|Element Attribute
|get
|<code>getPositionTabCss()</code></p>
</div>
<div class="paragraph">
<p>|
|get
|<code>getMoreLinkHref()</code> / <code>getRememberMeCheckboxName()</code></p>
</div>
<div class="paragraph">
<p>|== =</p>
</div>
<div class="paragraph">
<p>A css selector is used to select elements from an HTML page.</p>
</div>
<div class="paragraph">
<p>Selection by element tag, class or id are the most common selectors.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;p class='myText' id='123'&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This text element (p) can be found by using any one of the following selectors:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>The HTML element: "p". Note: in practical use this will be too generic, if a preceding text section is added, the selected element will change.
The class attribute preceded by ".": ".myText"
The id attribute preceded by "#": "#123"</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="using-other-attributes"><a class="anchor" href="#using-other-attributes"></a>Using other attributes</h6>
<div class="paragraph">
<p>When a class or an id attribute is not sufficient to identify an element, other attributes can be used as well, by using "[attribute=value]": For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;a href='https://ns.nl/example.html'&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This can be selected by using the entire value: "a[href='https://ns.nl/example.html'\]". For selecting links starting with, containing, ending with see the list below.</p>
</div>
</div>
<div class="sect5">
<h6 id="using-sub-elements"><a class="anchor" href="#using-sub-elements"></a>Using sub-elements</h6>
<div class="paragraph">
<p>The css selectors can be stacked, by appending them:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;div id='1'&gt;&lt;a href='ns.nl'&gt;&lt;/div&gt;
&lt;div id='2'&gt;&lt;a href='nsinternational.nl'&gt;&lt;/div&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>In the example above, the link element to nsinternational can be obtained with: "#2 a".</p>
</div>
</div>
<div class="sect5">
<h6 id="when-possible-avoid"><a class="anchor" href="#when-possible-avoid"></a>When possible avoid</h6>
<div class="ulist">
<ul>
<li>
<p>Using paths of commonly used HTML elements within the containers (HTML: div). This will cause failures when a container is added, a common occurrence during development, e.g. "div div p". Use class or id instead, if those are not available, request them to be added in the production code.</p>
</li>
<li>
<p>Magic order numbers. It is possible to get the second text element in its parent container by using the selector "p:nth-child(2)". If the items are representing different items, ask the developer to add specific attributes. It is also possible to request all items, with a selector similar to ".myList li", and iterate through them later.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="list"><a class="anchor" href="#list"></a>List</h6>
<div class="paragraph">
<p>A good list with CSS Selectors can be found at W3Schools:<br>
<a href="https://www.w3schools.com/cssref/css_selectors.asp" class="bare">https://www.w3schools.com/cssref/css_selectors.asp</a></p>
</div>
</div>
<div class="sect5">
<h6 id="selenium-uft-comparison-2"><a class="anchor" href="#selenium-uft-comparison-2"></a>Selenium UFT Comparison</h6>
<div class="paragraph">
<p>|== =</p>
</div>
<div class="paragraph">
<p>|Subject
|HP UFT
|HP LeanFT
|Selenium
|Selenium IDE</p>
</div>
<div class="paragraph">
<p>|Language
|VBScript
|Same as Selenium
|Supports several languages.
Java
|Javascript</p>
</div>
<div class="paragraph">
<p>|Learning curve
|Based on VBScript which is relatively easy to learn
|Less intuitive, more coding knowledge necessary
|Less intuitive, more coding skills necessary
|Record/playback possible. Generated code difficult to maintain</p>
</div>
<div class="paragraph">
<p>|<strong>Project type</strong>
|<strong>Traditional</strong>
|<strong>Agile</strong>
|<strong>Agile</strong>
|<strong>Agile</strong></p>
</div>
<div class="paragraph">
<p>|<strong>User oriented</strong>
|<strong>More Tester</strong>
|<strong>More Developer</strong>
|<strong>More Developer</strong>
|<strong>More Tester</strong></p>
</div>
<div class="paragraph">
<p>|Object recognition
|Test object identification and storage in object repository
|Same as UFT
|With Firebug
|Same as SE</p>
</div>
<div class="paragraph">
<p>|Customizations
|Only the available standard. No custimization
|Same as UFT
|Lots of customizations possible
|Fewer then SE</p>
</div>
<div class="paragraph">
<p>|Framework
|Needed.
Exists in ATaaS
|
|Needed.
Integration with Fitnesse, Cucumber, Gauche
|No Framework. Limited capabilities of the tool.</p>
</div>
<div class="paragraph">
<p>|Operating System support
|Runs on Windows
|Runs on Windows
|Multiple OS support. With Grid: testing on multiple devices at same time
|Plugin for Firefox</p>
</div>
<div class="paragraph">
<p>|<strong>Application coverage</strong>
|<strong>Many</strong>
|<strong>Many</strong>
|<strong>Web only</strong>
|<strong>Web only</strong></p>
</div>
<div class="paragraph">
<p>|Multiple browsers
|In UFT 12.5 available
|In 12.5 available
|Multiple tests in multiple browser windows at once and faster support for new browser versions
|Multiple tests in multiple browser windows at once and faster support for new browser versions</p>
</div>
<div class="paragraph">
<p>|System Load
|High system load (RAM &amp; CPU usage)
|Lower load than HP UFT?
|Lower load than HP UFT
|Lower load than HP UFT</p>
</div>
<div class="paragraph">
<p>|ALM integration
|With HP ALM – full integration
|
|Jira, Jenkins
Not with ALM tool
|Same as SE</p>
</div>
<div class="paragraph">
<p>|Integration with other tools
|A lot can be built, but many are already covered.
|More than UFT.
|Freeware and can be integrated with different open source tools
|Freeware and can be integrated with different open source tools</p>
</div>
<div class="paragraph">
<p>|Addins
|Add-ins necessary to access all capabilities of the tool – license related
|Same as UFT
|See integration with other tools
|See integration with other tools</p>
</div>
<div class="paragraph">
<p>|Reporting
|Complete, link to ALM
|Same as UFT
|No native mechanism for generating reports, but multiple plugins available for reporting
|No native mechanism for generating reports, but multiple plugins available for reporting</p>
</div>
<div class="paragraph">
<p>|Support
|HP full support
|Same as UFT
|Limited support as it is open source
|Limited support as it is open source</p>
</div>
<div class="paragraph">
<p>|<strong>License costs</strong>
|<strong>About 17K – Capgemini price 5K.</strong>
<strong>Included in the S2 service charge</strong>
|<strong>Same price as HP UFT</strong>
|<strong>Free</strong>
|<strong>Free</strong>
<strong>limited functionality (no iterations / conditional statements)</strong></p>
</div>
<div class="paragraph">
<p>|iVAL Service
|ATaaS
|Not in a S2 service
|Not in a S2 service
|Not in a S2 service</p>
</div>
<div class="paragraph">
<p>|== =</p>
</div>
<div class="paragraph">
<p>Bold for key differentiators.</p>
</div>
<div class="paragraph">
<p>Projects also choose an available resource and the knowledge of that resource.</p>
</div>
<div class="paragraph">
<p>Both: Framework determines the quality of automation. Needs to be set up by someone with experience with the tool</p>
</div>
</div>
<div class="sect5">
<h6 id="run-on-different-browsers"><a class="anchor" href="#run-on-different-browsers"></a>Run on different browsers</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image59.png" alt="image59">
</div>
</div>
<div class="paragraph">
<p>To execute each test with a chosen installed browser, specific arguments are required in Run configuration.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image60.png" alt="image60">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image61.png" alt="image61">
</div>
</div>
<div class="paragraph">
<p>It is necessary to enter <em>-Dbrowser=</em> with browser parameter name as an argument (in 'Arguments' tab):</p>
</div>
<div class="paragraph">
<p>firefox
ie
phantomjs
chrome
chromeheadless
For example: <em>-Dbrowser=ie</em></p>
</div>
<div class="literalblock">
<div class="content">
<pre>_-ea_ should be entered as an argument to restore default settings.</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="browser-options"><a class="anchor" href="#browser-options"></a>Browser options</h6>
<div class="paragraph">
<p>To run a browser with specific options during runtime, please use</p>
</div>
<div class="paragraph">
<p><em>-DbrowserOptions="&lt; options &gt;"</em></p>
</div>
<div class="literalblock">
<div class="content">
<pre>&gt; mvn test -DbrowserOptions="param1"
&gt; mvn test -DbrowserOptions="param1=value1"</pre>
</div>
</div>
<div class="paragraph">
<p>examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>One parameter <em>-DbrowserOptions="headless"</em></p>
</li>
<li>
<p>One parameter <em>-DbrowserOptions="--incognito"</em></p>
</li>
<li>
<p>Many parameters <em>-DbrowserOptions="headless;param1=value1;testEquals=FirstEquals=SecondEquals;--testMe"</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>List of options/capabilites supported by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/SeleniumHQ/selenium/wiki/DesiredCapabilities">Selenium Grid</a></p>
</li>
<li>
<p><a href="http://chromedriver.chromium.org/capabilities">Chrome Driver</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="run-with-full-range-of-resolution"><a class="anchor" href="#run-with-full-range-of-resolution"></a>Run with full range of resolution</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image62.png" alt="image62">
</div>
</div>
<div class="paragraph">
<p>In order to execute tests in different browser resolutions, it is required to provide these resolutions as a test parameter.</p>
</div>
<div class="paragraph">
<p>Test example with resolutions included may be found in <em>ResolutionTest</em> test class</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image63.png" alt="image63">
</div>
</div>
<div class="paragraph">
<p>Example of resolution notation is available in <em>ResolutionEnum</em> class</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image64.png" alt="image64">
</div>
</div>
<div class="paragraph">
<p>Test with given resolution parameters will be launched as many times as the number of resolutions provided.</p>
</div>
</div>
<div class="sect5">
<h6 id="selenium-best-practices-2"><a class="anchor" href="#selenium-best-practices-2"></a>Selenium Best Practices</h6>
<div class="paragraph">
<p>The following table displays a few best practices that should be taken into consideration when developing Selenium test cases.</p>
</div>
<div class="paragraph">
<p>|== =</p>
</div>
<div class="paragraph">
<p>|Best Practices
|Description</p>
</div>
<div class="paragraph">
<p>|"Keep it Simple"
|Do not force use every Selenium feature available - Plan before creating the actual test cases</p>
</div>
<div class="paragraph">
<p>|Using Cucumber
|Cucumber can be used to create initial testcases for further decision making</p>
</div>
<div class="paragraph">
<p>|Supporting multiple browsers
|Test on multiple browsers (in parallel, if applicable) if the application is expected to support multiple environments</p>
</div>
<div class="paragraph">
<p>|Test reporting
|Make use of test reporting modules like Junit which is included in the framework</p>
</div>
<div class="paragraph">
<p>|Maintainability
|Always be aware of the maintainability of tests - You should always be able to adapt to changes</p>
</div>
<div class="paragraph">
<p>|Testing types
|Which tests should be created? Rule of thumb: 70% Unit test cases, 20% Integration test cases and 10% UI Test cases</p>
</div>
<div class="paragraph">
<p>|Test data
|Consider before actually developing tests and choosing tools: Where to get test data from, how to reset test data</p>
</div>
<div class="paragraph">
<p>|== =</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="web-api-module"><a class="anchor" href="#web-api-module"></a>26.15. Web API Module</h3>
<!-- toc disabled -->
<div class="sect5">
<h6 id="service-virtualization"><a class="anchor" href="#service-virtualization"></a>Service Virtualization</h6>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Web-API-Test-Module-What-is-service-virtualization.adoc">What is service virtualization</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Web-API-Test-Module-How-plug-in-service-virtualization-into-Application-Under-Test.adoc">How to plug in service virtualization into Application Under Test</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Web-API-Test-Module-How-to-make-virtual-asset.adoc">How to make a virtual asset</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Web-API-Test-Module-Smoke-Tests-virtualization.adoc">Smoke Tests virtualization</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="is-it-doable-to-keep-pace-in-qa-with-todays-software-agile-approach"><a class="anchor" href="#is-it-doable-to-keep-pace-in-qa-with-todays-software-agile-approach"></a>Is it doable to keep pace in QA with today’s software agile approach?</h6>
<div class="paragraph">
<p>DevOps + Microservices + Shift left + Time to Market ==  <strong>? Service virtualization ?</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image72.png" alt="image72">
</div>
</div>
<div class="paragraph">
<p>Test pyramid</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image73.png" alt="image73">
</div>
</div>
</div>
<div class="sect5">
<h6 id="what-is-service-virtualization"><a class="anchor" href="#what-is-service-virtualization"></a>What is service virtualization</h6>
<div class="paragraph">
<p><strong>Service Virtualization has become recognized as one of the best ways to speed up testing and accelerate your time to market.</strong></p>
</div>
<div class="paragraph">
<p>Service virtualization lets you automatically execute tests even when the application under test’s dependent system components (APIs, third-party applications, etc.) cannot be properly accessed or configured for testing. By simulating these dependencies, you can ensure that your tests will encounter the appropriate dependency behaviour and data each and every time that they execute.</p>
</div>
<div class="paragraph">
<p><strong>Service virtualization is the simulation of interfaces – not the virtualization of systems.</strong></p>
</div>
<div class="paragraph">
<p>According to <a href="http://en.wikipedia.org/wiki/Service_virtualization">Wikipedia’s service virtualization</a> entry: <em>Service virtualization emulates the behaviour of software components to remove dependency constraints on development and testing teams. Such constraints occur in complex, interdependent environments when a component connected to the application under test is:</em></p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Not yet completed</em></p>
</li>
<li>
<p><em>Still evolving</em></p>
</li>
<li>
<p><em>Controlled by a third-party or partner</em></p>
</li>
<li>
<p><em>Available for testing only in a limited capacity or at inconvenient times</em></p>
</li>
<li>
<p><em>Difficult to provision or configure in a test environment</em></p>
</li>
<li>
<p><em>Needed for simultaneous access by different teams with varied test data setup and other requirements</em></p>
</li>
<li>
<p><em>Restricted or costly to use for load and performance testing</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For instance, instead of virtualizing an entire database (and performing all associated test data management as well as setting up the database for every test session), you monitor how the application interacts with the database, then you emulate the related database behaviour (the SQL queries that are passed to the database, the corresponding result sets that are returned, and so forth).</p>
</div>
</div>
<div class="sect5">
<h6 id="mocks-stubs-and-virtual-services"><a class="anchor" href="#mocks-stubs-and-virtual-services"></a>Mocks, stubs and virtual services</h6>
<div class="paragraph">
<p>The most commonly discussed categories of test doubles are mocks, stubs and virtual services.</p>
</div>
<div class="paragraph">
<p><strong>Stub</strong>: a minimal implementation of an interface that normally returns hardcoded data that is tightly coupled to the test suite. It is most useful when the suite of tests is simple and keeping the hardcoded data in the stub is not an issue. Some stubs are handwritten; some can be generated by tools. A stub is normally written by a developer for personal use. It can be shared with testers, but wider sharing is typically limited by interoperability issues related to software platform and deployment infrastructure dependencies that were hardcoded. A common practice is when a stub works in-process directly with classes, methods, and functions for the unit, module, and acceptance testing. Some developers will say that a stub can also be primed, but you cannot verify an invocation on a stub. Stubs can also be communicating "over the wire", for example, HTTP, but some would argue that they should be called virtual services in that case.</p>
</div>
<div class="paragraph">
<p><strong>Mock</strong>: a programmable interface observer, that verifies outputs against expectations defined by the test. It is frequently created using a third party library, for example in Java that is Mockito, JMock or WireMock. It is most useful when you have a large suite of tests and a stub will not be sufficient because each test needs a different data set up and maintaining them in a stub would be costly. The mock lets us keep the data set-up in the test. A mock is normally written by a developer for personal use but it can be shared with testers. However, wider sharing is typically limited by interoperability issues related to software platform and deployment infrastructure dependencies that were hardcoded. They are most often work-in-progress directly with classes, methods, and functions for a unit, module, and acceptance testing. Mock provides responses based on a given request satisfying predefined criteria (also called request or parameter matching). A mock also focuses on interactions rather than state so mocks are usually stateful. For example, you can verify how many times a given method was called or the order of calls made to a given object.</p>
</div>
<div class="paragraph">
<p><strong>Virtual service</strong>: a test double often provided as a Software-as-a-Service (SaaS), is always called remotely, and is never working in-process directly with methods or functions. A virtual service is often created by recording traffic using one of the service virtualization platforms instead of building the interaction pattern from scratch based on interface or API documentation. A virtual service can be used to establish a common ground for teams to communicate and facilitate artefact sharing with other development teams as well as testing teams. A virtual service is called remotely (over HTTP, TCP, etc.) normally supports multiple protocols (e.g. HTTP, MQ, TCP, etc.), while a stub or mock normally supports only one. Sometimes virtual services will require users to authorize, especially when deployed in environments with enterprise-wide visibility. Service virtualization tools used to create virtual services will most often have user interfaces that allow less tech-savvy software testers to hit the ground running, before diving into the details of how specific protocols work. They are sometimes backed by a database. They can also simulate non-functional characteristics of systems such as response times or slow connections. You can sometimes find virtual services that provide a set of stubbed responses for given request criteria and pass every other request to a live backend system (partial stubbing). Similar to mocks, virtual services can have quite complex request matchers, that allow having one response returned for many different types of requests. Sometimes, virtual services simulate system behaviours by constructing parts of the response based on request attributes and data.</p>
</div>
<div class="paragraph">
<p>It is often difficult to say definitely which of the following categories a test double fits into. They should be treated as a spectrum rather than strict definitions.</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/mrchecker.wiki/master-mrchecker.adoc - include::Who-Is-MrChecker/Test-Framework-Modules/Web-API-Test-Module-How-plug-in-service-virtualization-into-Application-Under-Test.adoc[]</p>
</div>
</div>
<div class="sect5">
<h6 id="how-to-make-a-virtual-asset"><a class="anchor" href="#how-to-make-a-virtual-asset"></a>How to make a virtual asset</h6>
<div class="paragraph">
<p>This can be done in four ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Record all traffic (Mappings and Responses) that comes through proxy - by UI</p>
</li>
<li>
<p>Record all traffic (Mappings and Responses) that comes through proxy - by Code</p>
</li>
<li>
<p>Create Mappings and Responses manually by text files</p>
</li>
<li>
<p>Create Mappings and Responses manually by code</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="record-all-traffic-mappings-and-responses-that-comes-through-proxy-ui"><a class="anchor" href="#record-all-traffic-mappings-and-responses-that-comes-through-proxy-ui"></a>Record all traffic (Mappings and Responses) that comes through proxy - UI</h6>
<div class="paragraph">
<p>Full article here <a href="http://wiremock.org/docs/record-playback/">Wiremock record-playback</a>.</p>
</div>
<div class="paragraph">
<p>First, start an instance of <a href="http://wiremock.org/docs/running-standalone">WireMock running standalone</a>. Once that’s running, visit the recorder UI page at <a href="http://localhost:8080/__admin/recorder" class="bare">http://localhost:8080/__admin/recorder</a> (assuming you started WireMock on the default port of 8080).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image77.png" alt="image77">
</div>
</div>
<div class="paragraph">
<p>Enter the URL you wish to record from in the target URL field and click the Record button. You can use <a href="http://example.mocklab.io" class="bare">http://example.mocklab.io</a> to try it out.</p>
</div>
<div class="paragraph">
<p>Now you need to make a request through WireMock to the target API so that it can be recorded. If you’re using the example URL, you can generate a request using curl:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ curl http://localhost:8080/recordables/123</pre>
</div>
</div>
<div class="paragraph">
<p>Now click stop. You should see a message indicating that one stub was captured.</p>
</div>
<div class="paragraph">
<p>You should also see that a file has been created called something like <em>recordables_123-40a93c4a-d378-4e07-8321-6158d5dbcb29.json</em> under the mappings directory created when WireMock started up, and that a new mapping has appeared at <a href="http://localhost:8080/__admin/mappings" class="bare">http://localhost:8080/__admin/mappings</a>.</p>
</div>
<div class="paragraph">
<p>Requesting the same URL again (possibly disabling your wifi first if you want a firm proof) will now serve the recorded result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ curl http://localhost:8080/recordables/123

{
"message": "Congratulations on your first recording!"
}</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="record-all-traffic-mappings-and-responses-that-comes-through-proxy-by-code"><a class="anchor" href="#record-all-traffic-mappings-and-responses-that-comes-through-proxy-by-code"></a>Record all traffic (Mappings and Responses) that comes through proxy - by Code</h6>
<div class="paragraph">
<p>An example of how such a record can be achieved</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@Test
public void startRecording() {

    SnapshotRecordResult recordedMappings;

    DriverManager.getDriverVirtualService()
            .start();
    DriverManager.getDriverVirtualService()
            .startRecording("http://example.mocklab.io");
    recordedMappings = DriverManager.getDriverVirtualService()
            .stopRecording();

    BFLogger.logDebug("Recorded messages: " + recordedMappings.toString());

}</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="create-mappings-and-responses-manually-by-text-files"><a class="anchor" href="#create-mappings-and-responses-manually-by-text-files"></a>Create Mappings and Responses manually by text files</h6>
<div class="paragraph">
<p>EMPTY</p>
</div>
</div>
<div class="sect5">
<h6 id="create-mappings-and-responses-manually-by-code"><a class="anchor" href="#create-mappings-and-responses-manually-by-code"></a>Create Mappings and Responses manually by code</h6>
<div class="paragraph">
<p>Link to full file structure: <a href="https://github.com/devonfw/devonfw-testing/blob/develop/mrchecker-framework-modules/mrchecker-webapi-module/src/test/java/com/capgemini/mrchecker/endpoint/rest/REST_FarenheitToCelsiusMethod_Test.java">REST_FarenheitToCelsiusMethod_Test.java</a></p>
</div>
</div>
<div class="sect5">
<h6 id="start-up-virtual-server"><a class="anchor" href="#start-up-virtual-server"></a>Start up Virtual Server</h6>
<div class="listingblock">
<div class="content">
<pre>public void startVirtualServer() {

    // Start Virtual Server
    WireMockServer driverVirtualService = DriverManager.getDriverVirtualService();

    // Get Virtual Server running http and https ports
    int httpPort = driverVirtualService.port();
    int httpsPort = driverVirtualService.httpsPort();

    // Print is Virtual server running
    BFLogger.logDebug("Is Virtual server running: " + driverVirtualService.isRunning());

    String baseURI = "http://localhost";
    endpointBaseUri = baseURI + ":" + httpPort;
}</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="plug-in-a-virtual-asset"><a class="anchor" href="#plug-in-a-virtual-asset"></a>Plug in a virtual asset</h6>
<div class="paragraph">
<p>REST_FarenheitToCelsiusMethod_Test.java</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public void activateVirtualAsset() {
    /*
    * ----------
    * Mock response. Map request with virtual asset from file
    * -----------
    */
    BFLogger.logInfo("#1 Create Stub content message");
    BFLogger.logInfo("#2 Add resource to virtual server");
    String restResourceUrl = "/some/thing";
    String restResponseBody = "{ \"FahrenheitToCelsiusResponse\":{\"FahrenheitToCelsiusResult\":37.7777777777778}}";

    new StubREST_Builder //For active virtual server ...
            .StubBuilder(restResourceUrl) //Activate mapping, for this Url AND
            .setResponse(restResponseBody) //Send this response  AND
            .setStatusCode(200) // With status code 200 FINALLY
            .build(); //Set and save mapping.

}</pre>
</div>
</div>
<div class="paragraph">
<p>Link to full file structure: <a href="https://github.com/devonfw/devonfw-testing/blob/develop/mrchecker-framework-modules/mrchecker-webapi-module/src/main/java/com/capgemini/mrchecker/webapi/endpoint/stubs/StubREST_Builder.java">StubREST_Builder.java</a></p>
</div>
<div class="paragraph">
<p>Source link to <a href="http://wiremock.org/docs/stubbing/">How to create Stub</a>.</p>
</div>
<div class="paragraph">
<p>StubREST_Builder.java</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class StubREST_Builder {

    // required parameters
    private String endpointURI;

    // optional parameters
    private int statusCode;

    public String getEndpointURI() {
        return endpointURI;
    }

    public int getStatusCode() {
        return statusCode;
    }

    private StubREST_Builder(StubBuilder builder) {
        this.endpointURI = builder.endpointURI;
        this.statusCode = builder.statusCode;
    }

    // Builder Class
    public static class StubBuilder {

        // required parameters
        private String endpointURI;

        // optional parameters
        private int     statusCode  = 200;
        private String  response    = "{ \"message\": \"Hello\" }";

        public StubBuilder(String endpointURI) {
            this.endpointURI = endpointURI;
        }

        public StubBuilder setStatusCode(int statusCode) {
            this.statusCode = statusCode;
            return this;
        }

        public StubBuilder setResponse(String response) {
            this.response = response;
            return this;
        }

        public StubREST_Builder build() {

            // GET
            DriverManager.getDriverVirtualService()
                    .givenThat(
                            // Given that request with ...
                            get(urlMatching(this.endpointURI))
                                    .withHeader("Content-Type", equalTo(ContentType.JSON.toString()))
                                    // Return given response ...
                                    .willReturn(aResponse()
                                            .withStatus(this.statusCode)
                                            .withHeader("Content-Type", ContentType.JSON.toString())
                                            .withBody(this.response)
                                            .withTransformers("body-transformer")));

            // POST
            DriverManager.getDriverVirtualService()
                    .givenThat(
                            // Given that request with ...
                            post(urlMatching(this.endpointURI))
                                    .withHeader("Content-Type", equalTo(ContentType.JSON.toString()))
                                    // Return given response ...
                                    .willReturn(aResponse()
                                            .withStatus(this.statusCode)
                                            .withHeader("Content-Type", ContentType.JSON.toString())
                                            .withBody(this.response)
                                            .withTransformers("body-transformer")));

            // PUT
            DriverManager.getDriverVirtualService()
                    .givenThat(
                            // Given that request with ...
                            put(urlMatching(this.endpointURI))
                                    .withHeader("Content-Type", equalTo(ContentType.JSON.toString()))
                                    // Return given response ...
                                    .willReturn(aResponse()
                                            .withStatus(this.statusCode)
                                            .withHeader("Content-Type", ContentType.JSON.toString())
                                            .withBody(this.response)
                                            .withTransformers("body-transformer")));

            // DELETE
            DriverManager.getDriverVirtualService()
                    .givenThat(
                            // Given that request with ...
                            delete(urlMatching(this.endpointURI))
                                    .withHeader("Content-Type", equalTo(ContentType.JSON.toString()))
                                    // Return given response ...
                                    .willReturn(aResponse()
                                            .withStatus(this.statusCode)
                                            .withHeader("Content-Type", ContentType.JSON.toString())
                                            .withBody(this.response)
                                            .withTransformers("body-transformer")));

            // CATCH any other requests
            DriverManager.getDriverVirtualService()
                    .givenThat(
                            any(anyUrl())
                                    .atPriority(10)
                                    .willReturn(aResponse()
                                            .withStatus(404)
                                            .withHeader("Content-Type", ContentType.JSON.toString())
                                            .withBody("{\"status\":\"Error\",\"message\":\"Endpoint not found\"}")
                                            .withTransformers("body-transformer")));

            return new StubREST_Builder(this);
        }
    }
}</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="start-a-virtual-server"><a class="anchor" href="#start-a-virtual-server"></a>Start a virtual server</h6>
<div class="paragraph">
<p>The following picture presents the process of executing Smoke Tests in a virtualized environment:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image78.png" alt="image78">
</div>
</div>
</div>
<div class="sect5">
<h6 id="install-docker-service"><a class="anchor" href="#install-docker-service"></a>Install docker service</h6>
<div class="paragraph">
<p>If docker is not already installed on machine (this should be checked during C2C creation), install docker, docker-compose, apache2-utils, openssl (You can use <strong>script</strong> to install docker &amp; docker-compose OR refer to this <strong>post</strong> and add Alias for this machine &lt;C2C_Alias_Name&gt;):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>run the script</p>
</li>
<li>
<p>sudo apt-get install -y apache2-utils</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="build-a-docker-image"><a class="anchor" href="#build-a-docker-image"></a>Build a docker image</h6>
<div class="paragraph">
<p><strong>Dockerfile:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>FROM docker.xxx.com/ubuntu:16.04
MAINTAINER Maintainer Name "maintainer@email.address"
LABEL name=ubuntu_java \
           version=v1-8.0 \
           base="ubuntu:16.04" \
           build_date="03-22-2018" \
           java="1.8.0_162" \
           wiremock="2.14.0" \
           description="Docker to use with Ubuntu, JAVA and WIREMOCK "

##Update and install the applications needed
COPY 80proxy /etc/apt/apt.conf.d/80proxy
RUN apt-get update
RUN apt-get install -y \
            wget \
            libfontconfig \
            unzip \
            zip
            ksh \
            curl \
            git

COPY wgetrc /etc/wgetrc

#Env parameters

### JAVA PART ###
#TO UPDATE:please verify url link to JDK http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html
##Download and install JAVA JDK8
RUN mkdir /opt/jdk
RUN wget -qq --header "Cookie: oraclelicense=accept-securebackup-cookie" http://download.oracle.com/otn-pub/java/jdk/8u162-b12/0da788060d494f509bf8624735fa2f1/jdk-8u162-linux-x64.tar.gz &amp;&amp; tar -zxf jdk-8u162-linux-x64.tar.gz -C /opt/jdk &amp;&amp; rm jdk-8u162-linux-x64.tar.gz &amp;&amp; update-alternatives --install /usr/bin/javac javac /opt/jdk/jdk1.8.0_162/bin/javac 100 &amp;&amp; java -version &amp;&amp; chmod 755 -R /opt/jdk/jdk1.8.0_162/
RUN java -version

##Add user
RUN useradd -u 29001 -g 100 srvpwiredev

##Add app
RUN mkdir -p -m 777 /app
COPY wiremock-standalone-2.14.0.jar /app/wiremock-standalone-2.14.0.jar

##Expose port
EXPOSE 8080

##Set workdir
WORKDIR /App

##Run app
CDM java -jar /app/wiremock-standalone-2.14.0.jar</pre>
</div>
</div>
<div class="paragraph">
<p>Execute the following steps with a specified version to build a docker image and push it to the repository :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>## Build image
sudo docker build -t docker.xxx.com/app/build/wiremock:v2.14.0.

## Push image
sudo docker login docker.xxx.com
sudo docker push docker.xxx.com/app/build/wiremock:v2.14.0.</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="run-docker-image"><a class="anchor" href="#run-docker-image"></a>Run docker image</h6>
<div class="paragraph">
<p>To run a docker image, execute the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo docker run -td -p 8080:8080 -v /home/wiremock/repo/app/docker/QA/mappings:/app/mappings -v /home/wiremock/repo/app/docker/QA/__files:/app/__files --restart always docker.xxx.com/app/build/wiremock:v2.14.0.</pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="paragraph">
<p><strong>-p</strong> - publish a container’s port to the host</p>
</div>
<div class="paragraph">
<p><strong>-v</strong> - bind mount a volume. WireMock server creates two directories under the current one: mappings and __files. It is necessary to mount directories with already created mappings and responses to make it work.</p>
</div>
<div class="paragraph">
<p><strong>-restart always</strong> - restart policy to apply when a container exists</p>
</div>
<div class="paragraph">
<p>All of the parameters are described in: <a href="https://docs.docker.com/engine/reference/run/">official docker documentation</a></p>
</div>
</div>
<div class="sect5">
<h6 id="map-requests-with-virtual-assets"><a class="anchor" href="#map-requests-with-virtual-assets"></a>Map requests with virtual assets</h6>
<div class="paragraph">
<p><strong>What is WireMock?</strong></p>
</div>
<div class="paragraph">
<p>WireMock is an HTTP mock server. At its core it is a web server that can be primed to serve canned responses to particular requests (stubing) and that captures incoming requests so that they can be checked later (verification). It also has an assortment of other useful features including record/playback of interactions with other APIs, injection of faults and delays, simulation of stateful behaviour.</p>
</div>
<div class="paragraph">
<p>Full documentation can be found under the following link: <a href="http://wiremock.org/docs">WireMock</a></p>
</div>
</div>
<div class="sect5">
<h6 id="record-create-virtual-assets-mappings"><a class="anchor" href="#record-create-virtual-assets-mappings"></a>Record / create virtual assets mappings</h6>
<div class="paragraph">
<p><strong>Record</strong></p>
</div>
<div class="paragraph">
<p>WireMock can create stub mappings from requests it has received. Combined with its proxying feature, this allows you to "record" stub mappings from interaction with existing APIs.</p>
</div>
<div class="paragraph">
<p>Record and playback (Legacy): <a href="http://wiremock.org/docs/record-playback-legacy/">documentation</a></p>
</div>
<div class="literalblock">
<div class="content">
<pre>java -jar wiremock-standalone-2.16.0.jar --proxy-all="http://search.twitter.com" --record-mappings --verbose</pre>
</div>
</div>
<div class="paragraph">
<p>Once it’s started and request is sent to it, it will be redirected to "http://search.twitter.com" and traffic (response) is saved to files in mappings and __files directories for further use.</p>
</div>
<div class="paragraph">
<p>Record and playback (New): <a href="http://wiremock.org/docs/record-playback/">documentation</a></p>
</div>
</div>
<div class="sect5">
<h6 id="enable-mappings-in-a-virtual-server"><a class="anchor" href="#enable-mappings-in-a-virtual-server"></a>Enable mappings in a virtual server</h6>
<div class="paragraph">
<p>When the WireMock server starts, it creates two directories under the current one: mappings and __files. To create a stub, it is necessary to drop a file with a .json extension under mappings.</p>
</div>
<div class="paragraph">
<p><strong>Run docker with mounted volumes</strong></p>
</div>
<div class="paragraph">
<p>Mappings are in a repository. It is necessary to mount directories with already created mappings and responses to make it work:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo docker run -td -p 8080:8080 -v /home/wiremock/repo/app/docker/QA/mappings:/app/mappings -v /home/wiremock/repo/app/docker/QA/__files:/app/__files --restart always docker.xxx.com/app/build/wiremock:v2.14.0.</pre>
</div>
</div>
<div class="paragraph">
<p>The description of how to build and run docker is available under: <a href="https://docs.docker.com/engine/reference/run/">Docker run command description</a></p>
</div>
<div class="paragraph">
<p><strong>Recorded mappings</strong></p>
</div>
<div class="paragraph">
<p>Recorded mappings are kept in the project repository.</p>
</div>
</div>
<div class="sect5">
<h6 id="create-a-user-and-map-them-to-docker-user"><a class="anchor" href="#create-a-user-and-map-them-to-docker-user"></a>Create a user and map them to docker user</h6>
<div class="paragraph">
<p>To enable the connection from Jenkins to Virtual Server (C2C), it is necessary to create a user and map them to docker group user. It can be done using the following command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>adduser -G docker -m wiremock</pre>
</div>
</div>
<div class="paragraph">
<p>To set the password for a wiremock user:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>passwd wiremock</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="create-ssh-private-and-public-keys-for-a-wiremock-user"><a class="anchor" href="#create-ssh-private-and-public-keys-for-a-wiremock-user"></a>Create SSH private and public keys for a wiremock user</h6>
<div class="paragraph">
<p>SSH keys serve as a means of identifying yourself to an SSH server using <a href="https://en.wikipedia.org/wiki/Public-key_cryptography">public-key cryptography</a> and <a href="https://en.wikipedia.org/wiki/Challenge%E2%80%93response_authentication">challenge-response authentication</a>. One immediate advantage this method has over traditional password is that you can be authenticated by the server without ever having to send your password over the network.</p>
</div>
<div class="paragraph">
<p>To create an SSH key, log in as wiremock (previously created user).</p>
</div>
<div class="literalblock">
<div class="content">
<pre>su wiremock</pre>
</div>
</div>
<div class="paragraph">
<p>The .ssh directory is not by default created below user home directory. Therefore, it is necessary to create it:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mkdir ~/.ssh</pre>
</div>
</div>
<div class="paragraph">
<p>Now we can proceed with creating an RSA key using ssh-keygen (a tool for creating new authentication key pairs for SSH):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ssh-keygen -t rsa</pre>
</div>
</div>
<div class="paragraph">
<p>A key should be created under /.ssh/id_rsa
Appending the public keys to authorized_keys:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>wiremock@vc2crptXXXXXXXn:~/ssh$ cat id_rsa.pub &gt;&gt; authorized_keys</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="install-an-ssh-key-in-jenkins"><a class="anchor" href="#install-an-ssh-key-in-jenkins"></a>Install an SSH key in Jenkins</h6>
<div class="paragraph">
<p>To add an SSH key to Jenkins, go to credentials in your job location. Choose the folder within credentials, then 'global credentials', 'Add credentials'. Fill in the fields. Finally, the entry should be created.</p>
</div>
</div>
<div class="sect5">
<h6 id="build-a-jenkins-groovy-script"><a class="anchor" href="#build-a-jenkins-groovy-script"></a>Build a Jenkins Groovy script</h6>
<div class="paragraph">
<p>The description of how to use SSH Agent plugin in Jenkins pipeline can be found under: <a href="https://www.karthikeyan.tech/2017/09/ssh-agent-blue-ocean-via-jenkins.html" class="bare">https://www.karthikeyan.tech/2017/09/ssh-agent-blue-ocean-via-jenkins.html</a></p>
</div>
<div class="paragraph">
<p>Example of use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sshagent (credentials: [env.WIREMOCK_CREDENTIALS]) {
     sh """
         ssh -T -o StrictHostKeyChecking=no -l ${env.WIREMOCK_USERNAME} ${env.WIREMOCK_IP_ADDRESS} "docker container restart ${env.WIREMOCK_CONTAINER_NAME}"
     """
}</pre>
</div>
</div>
<div class="paragraph">
<p>Where: env.WIREMOCK_CREDENTIALS is a credential id of previously created wiremock credentials. Now that it is present, we can execute commands on a remote machine, where in ssh command:
env.WIREMOCK_USERNAME - user name of user connected with configured private key
env.WIREMOCK_IP_ADDRESS - ip address of the machine where this user with this private key exists</p>
</div>
</div>
<div class="sect5">
<h6 id="pull-repository-with-virtual-assets"><a class="anchor" href="#pull-repository-with-virtual-assets"></a>Pull repository with virtual assets</h6>
<div class="paragraph">
<p>To pull the repository on a remote machine, it is necessary to use the previously described SSH Agent plugin. An example of use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>sshagent (credentials: [env.WIREMOCK_CREDENTIALS]) {
withCredentials([usernamePassword(credentialsId: end.STASH_CREDENTIALS, passwordVariable: 'PASS', usernameVariable: 'USER')]) {
     sh """
         ssh -T -o StrictHostKeyChecking=no -l ${env.WIREMOCK_USERNAME} ${env.WIREMOCK_IP_ADDRESS} "cd ~/${env.APPLICATION_DIRECTORY_WIREMOCK}/${env.PROJET_HOME}; git fetch https://&amp;USER:$PASS@${env.GIT_WITHOUT_HTTPS} ${env.GIT_BRANCH}; git reset --hard FETCH_HEAD; git clean -df"
      """
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="paragraph">
<p><strong>withCredentials</strong> allows various kinds of credentials (secrets) to be used in idiosyncratic ways. Each binding will define an environment variable active within the scope of the step. Then the necessary commands are executed:</p>
</div>
<div class="paragraph">
<p><code>cd …​</code> - command will change from current directory to the specified directory with git repository</p>
</div>
<div class="paragraph">
<p><code>git fetch …​ ;git reset …​ ;git clean …​</code> - pull from GIT branch. Git pull or checkout are not used here to prevent the situation with wrong coding between Mac OSX/Linux etc.</p>
</div>
<div class="paragraph">
<p><strong>PLEASE remember that when using this script for the first time, the code from previous block should be changed to:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>stage("ssh-agent"){
        sshagent (credentials: [env.WIREMOCK_CREDENTIALS]) {
            withCredentials([usernamePassword(credentialsId: end.STASH_CREDENTIALS, passwordVariable: 'PASS', usernameVariable: 'USER')]) {
                sh """
                        ssh -T -o StrictHostKeyChecking=no -l ${env.WIREMOCK_USERNAME} ${env.WIREMOCK_IP_ADDRESS} "cd ~/${env.APPLICATION_DIRECTORY_WIREMOCK} ;git clone --depth=1 --branch=develop https://&amp;USER:$PASS@${env.GIT_WITHOUT_HTTPS}"';
                """
    }
}</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="install-an-application-with-smoke-environment"><a class="anchor" href="#install-an-application-with-smoke-environment"></a>Install an application with Smoke environment</h6>

</div>
<div class="sect5">
<h6 id="update-properties-settings-file"><a class="anchor" href="#update-properties-settings-file"></a>Update properties settings file</h6>
<div class="paragraph">
<p>New settings file is pushed to the repository. Example configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>...
   &lt;key&gt;autocomplete&lt;/key&gt;
   &lt;string&gt;http://server:port&lt;/string&gt;
   &lt;key&gt;benefitsummary&lt;/key&gt;
   &lt;string&gt;http://server:port&lt;/string&gt;
   &lt;key&gt;checkscan&lt;/key&gt;
   &lt;string&gt;http://server:port&lt;/string&gt;
   &lt;key&gt;dpesb&lt;/key&gt;
   &lt;string&gt;http://server:port&lt;/string&gt;
...</pre>
</div>
</div>
<div class="paragraph">
<p>Address of service (backend) should be changed to wiremock address as it is shown on listing to change the default route.</p>
</div>
</div>
<div class="sect5">
<h6 id="build-an-application-with-updated-properties-file"><a class="anchor" href="#build-an-application-with-updated-properties-file"></a>Build an application with updated properties file</h6>
<div class="paragraph">
<p>New versions of application are prepared by Jenkins job.</p>
</div>
</div>
<div class="sect5">
<h6 id="install-an-application-on-target-properties-file"><a class="anchor" href="#install-an-application-on-target-properties-file"></a>Install an application on target properties file</h6>
<div class="paragraph">
<p>Installation of an application is actually executed in a non-automated way using SeeTest environment.</p>
</div>
</div>
<div class="sect5">
<h6 id="ui-tests"><a class="anchor" href="#ui-tests"></a>UI tests</h6>

</div>
<div class="sect5">
<h6 id="run-jenkins-job"><a class="anchor" href="#run-jenkins-job"></a>Run Jenkins job</h6>
<div class="paragraph">
<p><strong>Jenkinsfile:</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre>// Jenkins parameters are overriding the properties below
def properties = [

          JENKINS_LABELS                                 : 'PWI_LINUX_DEV',
          APPLICATION_FOLDER                             : 'app_dir',
          PROJECT_HOME                                   : 'app_home_folder',

          //WIREMOCK
          WIREMOCK_CREDENTIALS                           : 'vc2crptXXXXXXn',
          WIREMOCK_USERNAME                              : 'wiremock',
          WIREMOCK_ADDRESS                               : 'http://vc2crptXXXXXXn.xxx.com:8080',
          WIREMOCK_IP_ADDRESS                            : '10.196.67.XXX',
          WIREMOCK_CONTAINER_NAME                        : 'wiremock',
          APPLICATION_DIRECTORY_WIREMOCK                 : 'repo',

          //GIT
          GIT_CREDENTIALS                                : 'e47742cc-bb66-4321-2341-a2342er24f2',
          GIT_BRANCH                                     : 'develop',
          GIT_SSH                                        : 'ssh://git@stash.xxx.com/app/app.git'
          GIT_HTTPS                                      : 'HTTPS://git@stash.xxx.com/app/app.git',

          STASH_CREDENTIALS                              : 'e47742cc-bb66-4321-2341-a2342er24f2',


          //DOCKER
          ARTIFACTORY_USER_CREDENTIALS                   : 'e47742cc-bb66-4321-2341-a2342er24f2',
          SEETEST_DOCKER_IMAGE                           : 'docker.xxx.com/project/images/app:v1-8.3',

          //SEETEST_DOCKER_IMAGE
          SEETEST_APPLICATION_FOLDER                     : 'seetest_dir',
          SEETEST_PROJECT_HOME                           : 'Automated Scripts',
          SEETEST_GIT_SSH                                : 'ssh://git@stash.xxx.com/pr/seetest_automation_cucumber.git'
          SEETEST_GIT_BRANCH                             : 'develop',
          SEETEST_GRID_USER_CREDENTIALS                  : 'e47742cc-bb66-4321-2341-a2342er24f2',
          SEETEST_CUCUMBER_TAG                           : '@Virtualization',
          SEETEST_CLOUD_NAME                             : 'Core Group',
          SEETEST_IOS_VERSION                            : '11',
          SEETEST_IOS_APP_URL                            : '',
          SEETEST_INSTALL_APP                            : 'No',
          SEETEST_APP_ENVIRONMENT                        : 'SmokeTests',
          SEETEST_DEVICE_QUERY                           : '',
]

node(properties.JENKINS_LABELS) {
    try {
        prepareEnv(properties)
        gitCheckout()
        stageStartVirtualServer()
        stageMapApiRequests()
        stageInstallApplication()
        stageUITests()
     } catch(Exception ex) {
        currentBuild.result = 'FAILURE'
        error = 'Error' + ex
     }
}

//== == == == == == == == == == == == == == == == == == END OF PIPELINE== == == == == == == == == == == == == == == == == == == == ==

private void prepareEnv(properties) {
    cleanWorkspace()
    overrideProperties(properties)
    setWorkspace()
}

private void gitCheckout() {
    dir(env.APPLICATION_FOLDER) {
        checkout([$class: 'GitSCM', branches: [[name: env.GIT_BRANCH]], doGenerateSubmoduleConfiguration: false, extensions: [[$class: 'CloneOption', depth: 0, noTags: false, reference: '', shallow: false, timeout: 50]], gitTool: 'Default', submoduleCfg: [], userRemoteConfigs: [[credentialsId: env.GIT_CREDENTIALS, url: env.GIT_SSH]])
     }
}

private void stageStartVirtualServer() {
    def module = load "${env.SUBMODULES_DIR}/stageStartVirtualServer.groovy"
    module()
}

private void stageMapApiRequests() {
    def module = load "${env.SUBMODULES_DIR}/stageMapApiRequests.groovy"
    module()
}

private void stageInstallApplication() {
    def module = load "${env.SUBMODULES_DIR}/stageInstallApplication.groovy"
    module()
}

private void stageUITests() {
    def module = load "${env.SUBMODULES_DIR}/stageUITests.groovy"
    module()
}

private void setWorkspace() {
    String workspace = pwd()
    env.APPLICATION_DIRECTORY = "/${env.APPLICATION_DIRECTORY}"
    env.WORKSPACE_LOCAL - workspace + env.APPLICATION_DIRECTORY
    env.SEETEST_PROJECT_HOME_ABSOLute_PATH = "${workspace}/${env.SEETEST_APPLICATION_FOLDER}/${env.SEETEST_PROJECT_HOME}"
    env.SUBMODULES_DIR = env.WORKSPACE_LOCAL + "/pipelines/SmokeTests.submodules"
    env.COMMONS_DIR    = env.WORKSPACE_LOCAL + "/pipelines/commons"
}

/*
    function ovverrides env vales based on provided properties
*/
private void overrideProperties(properties) {
    for (param in properties) {
        if (env.(param.key) ==  null) {
           echo "Adding parameter '${param.key}' with default value: '$param.value}'"
           env.(param.key) = param.value
        } else {
           echo "Parameter '${param.key}' has overriden value: '${env.(param.key)}'"
        }
     }

     echo sh(script: "env | sort", returnStdout: true)
}

private void cleanWorkspace() {
   sh 'rm-rf *'
}</pre>
</div>
</div>
<div class="paragraph">
<p>stageStartVirtualServer.groovy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>def call () {
    stage("Check virtual server") {
        def statusCode

        try {
            def response = httpRequest "${env.WIREMOCK_ADDRESS}/__admin/"
            statusCode = response.status
        } catch(Exception ex) {
            currentBuild.result = 'FAILURE'
            error 'WireMock server os unreachable.'
        }

        if(statusCode !=200) {
            currentBuild.result = 'FAILURE'
            error 'WireMock server is unreachable. Return code: ${statusCode}'
        }
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>stageMapApiRequests.groovy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>def call() {
    stage("Map API requests with virtual assets") {
        checkoutRepository()
        restartWiremock()
        checkWiremockStatus()
     }
}

private checkoutRepository() {
    extractHTTPSUrl()
    sshagent (credentials: [env.WIREMOCK_CREDENTIALS]) {
        withCredentials([usernamePassword(credentialsId: env.STASH_CREDENTIALS, passwordVariable: 'PASS', usernameVariable: 'USER')]) {
            sh """
                ssh -T -o StrictHostKeyChecking=no -l ${env.WIREMOCK_USERNAME} ${env.WIREMOCK_IP_ADDRESS} "cd~/${env.APPLICATION_DIRECTORY_WIREMOCK}/${env.PROJECT_HOME}; git fetch https://$USER:$PASS@${env.GIT_WITHOUT_HTTPS} ${env.GIT_BRANCH}; git reset --hard FETCH_HEAD; git clean -df"
             """
         }
     }
}

private restartWiremock() {
    sshagent (credentials: [env.WIREMOCK_CREDENTIALS]) {
            sh """
                ssh -T -o StrictHostKeyChecking=no -l ${env.WIREMOCK_USERNAME} ${env.WIREMOCK_IP_ADDRESS} "docker container restart ${env.WIREMOCK_CONTAINER_NAME}"
             """
     }
}

private checkWiremockStatus() {
    int wiremockStatusCheckCounter =6
    int sleepTimeInSeconds = 10
    def wiremockStatus

    for (i = 0; i &lt; wiremockStatusCheckCounter; i++) {
         try {
             wiremockStatus = getHttpRequestStatus()
             echo "WireMock server status code: ${wiremockStatus}"
         } catch(Exceprion ex) {
             echo "Exception when checking connection to WireMock"
         }
         if(wiremockStatus ==  200) break
         else sh "sleep $(sleepTimeInSeconds}"
      }

      if(wiremockStatus != 200) {
          currentBuild.result = 'FAILURE'
          error 'WireMock server is unreachable. Return code: ${wiremockStatus}'
      }
}

private def getHttpRequestStatus() {
    def response = httpRequest "${env.WIREMOCK_ADDRESS}/__admin"
    return response.status

private extractHTTPSUrl() {
    env.GIT_WITHOUT_HTTPS = env.GIT_HTTPS.replace("https://", "")
}

return this</pre>
</div>
</div>
<div class="paragraph">
<p>stageInstallApplication.groovy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>def call() {
    stage('Install application with smoke tests environment') {
        dir(env.SEETEST_APPLICATION_FOLDER) {
            checkout([$class: 'GitSCM', branches: [[name: env.SEETEST_GIT_BRANCH]], doGenerateSubmoduleConfigurations: false, extensions: [], gitTool: 'default', submoduleCfg: [], userRemoteConfigs: [[credentialsId: env.GIT_CREDENTIALS, url: env.SEETEST_GIT_SSH]])
        }
     }
}

return this</pre>
</div>
</div>
<div class="paragraph">
<p>stageUITests.groovy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>def call() {
    stage('UI tests') {
        def utils = load "${env.SUBMODULES_DIR}/utils.groovy"

        try {
            utils.generateUserIDVariable(); //Generate USER_ID and USER_GROUP
            docker.image(env.SEETEST_DOCKER_IMAGE).inside("-u ${env.USER_ID}:${env.USER_GROUP}") {
                withCredentials([[$class: 'UsernamePasswordMultiBinding', credentialsId: "${env.ARTIFACTORY_USER_CREDENTIALS}", passwordVariable: 'ARTIFACTORY_PASSWORD', usernameVariable: 'ARTIFACTORY_USERNAME]]) {
                    executeTests()
                    compressArtifacts()
                    publishJUnitTestResultReport()
                    archiveArtifacts()
                    publishHTMLReports()
                    publishCucumberReports()
                 }
             }
        } catch (Exception exc) {
            throw exc
        }
   }
}

private executeTests() {
    withCredentials([usernamePassword(credentialsId: env.SEETEST_GRID_USER_CREDENTIALS, passwordVariable: 'GRID_USER_PASSWORD', usernameVariable: 'GRID_USER_NAME')]) {
            sh """
                cd ${env.SEETEST_PROJECT_HOME_ABSOLUTE_PATH}
                mvn clean test -B -Ddriver="grid" -Dtags="${env.SEETEST_CUCUMBER_TAG}" -DcloudName="${env.SEETEST_CLOUD_NAME}" -DdeviceQuery="${env.SEETEST_DEVICE_QUERY} -DgridUser="${GRID_USER_NAME}" -DgridPassword="${GRID_USER_PASSWORD}" -Dinstall="${env.SEETEST_INSTALL_APP}" -DiosUrl="${env.SEETEST_IOS_APP_URL}" -DdeviceType="iPhone" -DiosVersion="$env.SEETEST_IOS_VERSION}" -DparallelMode="allonall" -Denv="${env.SEETEST_APP_ENVIRONMENT}" site
             """
     }
}

private compressartifacts() {
    echo "Compressing artifacts from /target/site"
    sh """
        zip -r allure_report.zip **/${env.SEETEST_PROJECT_homE}/target/site
    """

private publishJUnitTestResultReport() {
    echo "Publishing JUnit reports from ${env.SEETEST_APPLICATION_FOLDER}/${env.SEETEST_PROJECT_HOME}/target/surefire-reports/junitreporters/*.xml"

    try {
        junit "${env.SEETEST_APPLICATION_FOLDER}/${env.SEETEST_PROJECT_HOME}/target/surefire-reports/junitreporters/*.xml"
    } catch(e) {
        echo("No JUnit report found")
    }
}

private archiveArtifacts() {
    echo "Archiving artifacts"

    try {
        archiveArtifacts allowEmptyArchive: true, artifacts: "**/allure_report.zip"
    } catch(e) {
        echo("No artifacts found")
    }
}

private publishHTMLReports() {
    echo "Publishing HTML reports from ${env.SEETEST_APPLICATION_FOLDER}/${env.SEETEST_PROJECT_HOME}/target/site/allure-maven-plugin"

    try {
        publishHTML([allowMissing: false, alwaysLinkToLastBuild: true, keepAll: true, reportDir: "${env.SEETEST_APPLICATION_FOLDER/${env.SEETEST_PROJECT_HOME}/target/site/allure-maven-plugin", reportFiles: 'index.html', reportName: 'Allure report', reportTitles: 'Allure report'])
    } catch(e) {
        echo("No artifacts found")
    }
}

private publishCucumberREPORTS() {
    echo "Publishing Cucumber reports from ${env.SEETEST_APPLICATION_FOLDER}/${env.SEETEST_PROJECT_HOME}/target/cucumber-parallel/*.json"

    try {
        step([$class: 'CucumberReportPublisher', fileExcludePattern '', fileIncludePattern: "#{env.SEETEST_APPLICATION_FOLDER}/${env.SEETEST_PROJECT_HOME}/target/cucumber-parallel/*.json", ignoreFailedTests: false, jenkinsBasePath: '', jsonReportDirectory: '', missingFails: false, parallelTesting: false, pendingFails: false, skippedFails: false, undefinedFails: false])
    } catch(e) {
        echo("No Cucumber report found")
    }
}

return this</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Configuration</strong></p>
</div>
<div class="paragraph">
<p>It is possible to configure Jenkins job in two ways. First one is to edit the Jenkinsfile. All of the properties are in properties collection as below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>def properties = [

          JENKINS_LABELS                                : 'PWI_LINUX_DEV'

          ...

          //Docker
          ARTIFACTORY_USER_CREDENTIALS                  : 'ba2e4f46-56f1-4467-ae97-17b356d6s643',
          SEETEST_DOCKER_IMAGE                          : 'docker.XXX.com/app/base-images/seetest:v1-8.3',

          //SeeTest
          SEETEST_APPLICATION_FOLDER                    : 'seetest_dit',
          SEETEST_PROJECT_HOME                          : 'Automated_Scripts',
          SEETEST_GIT_SSH                               : 'ssh://stash.xxx.com/app/seetest_automation_cucumber.git',
          SEETEST_GIT_BRANCH                            : 'develop',

          ...
]</pre>
</div>
</div>
<div class="paragraph">
<p>Second way is to add properties in 'Configure job'. All of the properties there are overriding properties from Jenkinsfile (the have the highest priority). They can then be set durring 'Build with Paremeters' process.</p>
</div>
<div class="paragraph">
<p><strong>Reports</strong></p>
</div>
<div class="paragraph">
<p>After a job execution 'Allure report' and 'Cucumber-JVM' reports should be visible. If any tests fail, You can check on which screen (printscreen from failures is attached, why and etc.)</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="security-module"><a class="anchor" href="#security-module"></a>26.16. Security Module</h3>
<!-- toc disabled -->
<div class="sect5">
<h6 id="security-test-module"><a class="anchor" href="#security-test-module"></a>Security Test Module</h6>

</div>
<div class="sect5">
<h6 id="what-is-security"><a class="anchor" href="#what-is-security"></a>What is Security</h6>
<div class="paragraph">
<p>Application Security is concerned with <strong>Integrity</strong>, <strong>Availability</strong> and <strong>Confidentiality</strong> of data processed, stored and transferred by the application.</p>
</div>
<div class="paragraph">
<p>Application Security is a cross-cutting concern which touches every aspect of the Software Development Lifecycle. You can introduce some SQL injection flaws in your application and make it exploitable, but you can also expose your secrets (which will have nothing to do with code itself) due to poor secret management process, and fail as well.</p>
</div>
<div class="paragraph">
<p>Because of this and many other reasons, not every aspect of security can be automatically verified. Manual tests and audits will still be needed. Nevertheless, every security requirement which is automatically verified will prevent code degeneration and misconfiguration in a continuous manner.</p>
</div>
</div>
<div class="sect5">
<h6 id="how-to-test-security"><a class="anchor" href="#how-to-test-security"></a>How to test Security</h6>
<div class="paragraph">
<p>Security tests can be performed in many different ways, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Static Code Analysis</strong> - improves the security by (usually) automated code review. A good way to search for vulnerabilities, which are 'obvious' on the code level ( e.g. SQL injection). The downside of this approach is that professional tools to perform such scans are very expensive and still produce many false positives.</p>
</li>
<li>
<p><strong>Dynamic Code Analysis</strong> - tests are run against a working environment. A good way to search for vulnerabilities, which require all client- and server-side components to be present and running (like e.g. Cross-Site Scripting). Tests are performed in a semi-automated manner and require a proxy tool (like e.g. OWASP ZAP)</p>
</li>
<li>
<p><strong>Unit tests</strong> - self-written and self-maintained tests. They usually work on the HTTP/REST level (this defines the trust boundary between the client and the server) and run against a working environment. Unit tests are best suited for verifying requirements which involve business knowledge of the system or which assure secure configuration on the HTTP level.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the current release of the Security Module, the main focus will be <strong>Unit Tests</strong>.</p>
</div>
<div class="paragraph">
<p>Although the most common choice of environment for running security tests on will be <strong>integration</strong>(the environment offers the right stability and should mirror the production closely), it is not uncommon for some security tests to run on production as well. This is done for e.g. TLS configuration testing to ensure proper configuration of the most relevant environment in a continuous manner.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="database-module"><a class="anchor" href="#database-module"></a>26.17. Database Module</h3>
<!-- toc disabled -->
<div class="sect5">
<h6 id="database-test-module"><a class="anchor" href="#database-test-module"></a>Database Test Module</h6>

</div>
<div class="sect5">
<h6 id="what-is-mrchecker-database-test-module"><a class="anchor" href="#what-is-mrchecker-database-test-module"></a>What is MrChecker Database Test Module</h6>
<div class="paragraph">
<p>Database module is based on Object-Relational Mapping programming technique. All functionalities are built using Java Persistence API but examples use Hibernate as a main provider.</p>
</div>
</div>
<div class="sect5">
<h6 id="jpa-structure-schema"><a class="anchor" href="#jpa-structure-schema"></a>JPA structure schema</h6>
<div class="paragraph">
<p>This module was written to allow the use of any JPA provider. The structure is represented in the schema below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image3.png" alt="image3">
</div>
</div>
</div>
<div class="sect5">
<h6 id="orm-representation-applied-in-framework"><a class="anchor" href="#orm-representation-applied-in-framework"></a>ORM representation applied in Framework</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image4.png" alt="image4">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mobile-test-module"><a class="anchor" href="#mobile-test-module"></a>26.18. Mobile Test Module</h3>
<!-- toc disabled -->
<div class="sect5">
<h6 id="mobile-test-module-2"><a class="anchor" href="#mobile-test-module-2"></a>Mobile Test Module</h6>

</div>
<div class="sect5">
<h6 id="what-is-mrchecker-e2e-mobile-test-module"><a class="anchor" href="#what-is-mrchecker-e2e-mobile-test-module"></a>What is MrChecker E2E Mobile Test Module</h6>
<div class="paragraph">
<p>MrChecker E2E Mobile test Module is a suitable solution for testing Remote Web Design, Mobile Browsers and application.
A user can write tests suitable for all mobile browsers with a full range of resolution. The way of working is similar to Selenium and uses the same rules and patterns as the Web Driver. For more information please look in the <a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Selenium-Test-Module.adoc">Selenium test module</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="what-is-page-object-architecture"><a class="anchor" href="#what-is-page-object-architecture"></a>What is Page Object Architecture</h6>
<div class="paragraph">
<p>Creating Selenium test cases can result in an unmaintainable project. One of the reasons is that too many duplicated code is used. Duplicated code could be caused by the duplicated functionality and this will result in duplicated usage of locators. The disadvantage of duplicated code is that the project is less maintainable. If some locator will change, you have to walk through the whole test code to adjust locators where necessary. By using the page object model we can make non-brittle test code and reduce or eliminate duplicate test code. Beside of that it improves the readability and allows us to create interactive documentation. Last but not least, we can create tests with less keystroke. An implementation of the page object model can be achieved by separating the abstraction of the test object and the test scripts.</p>
</div>
</div>
<div class="sect5">
<h6 id="page-object-pattern"><a class="anchor" href="#page-object-pattern"></a>Page Object Pattern</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/Pom.png" alt="Pom">
</div>
</div>
</div>
<div class="sect5">
<h6 id="mobile-structure"><a class="anchor" href="#mobile-structure"></a>Mobile Structure</h6>
<div class="paragraph">
<p>It is build on the top of the Appium library.
Appium is an open-source tool for automating native, mobile web, and hybrid applications on iOS mobile, Android mobile, and Windows desktop platforms. Native apps are those written using iOS, Android, or Windows SDKs. Mobile web apps are web apps accessed using a mobile browser (Appium supports Safari on iOS and Chrome or the built-in 'Browser' app on Android). Hybrid apps have a wrapper around a "webview" - a native control that enables interaction with web content.</p>
</div>
</div>
<div class="sect5">
<h6 id="run-on-different-mobile-devices"><a class="anchor" href="#run-on-different-mobile-devices"></a>Run on different mobile devices</h6>
<div class="paragraph">
<p>To execute each test with chosen connected mobile devices, it is required to use specific arguments in Run configuration.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image01.png" alt="image01">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image02.png" alt="image02">
</div>
</div>
<div class="paragraph">
<p>Default supported arguments in MrChecker:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>deviceUrl</code> - http url to Appium Server, default value "http://127.0.0.1:4723"</p>
</li>
<li>
<p><code>automationName</code> - which automation engine to use , default value "Appium"</p>
</li>
<li>
<p><code>platformName</code> - which mobile OS platform to use , default value "Appium"</p>
</li>
<li>
<p><code>platformVersion</code> - mobile OS version , default value ""</p>
</li>
<li>
<p><code>deviceName</code> - the kind of mobile device or emulator to use , default value "Android Emulator"</p>
</li>
<li>
<p><code>app</code> - the absolute local path or remote http URL to a .ipa file (IOS), .app folder (IOS Simulator), .apk file (Android) or .apks file (Android App Bundle), or a .zip file, default value "."</p>
</li>
<li>
<p><code>browserName</code> - name of mobile web browser to automate. Should be an empty string if automating an app instead, default value ""</p>
</li>
<li>
<p><code>newCommandTimeout</code> - how long (in seconds) Appium will wait for a new command from the client before assuming the client quit and ending the session, default value "4000"</p>
</li>
<li>
<p><code>deviceOptions</code> - any other capabilites not covered in essential ones, default value none</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn clean test -Dtest=MyTest -DdeviceUrl="http://192.168.0.1:1234" -DplatformName="iOS" -DdeviceName="iPhone Simulator" -Dapp=".\\Simple_App.ipa"</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn clean test -Dtest=MyTest -Dapp=".\\Simple_App.apk -DdeviceOptions="orientation=LANDSCAPE;appActivity=MainActivity;chromeOptions=['--disable-popup-blocking']"</pre>
</div>
</div>
<div class="paragraph">
<p>Check also:</p>
</div>
<div class="paragraph">
<p>+
<a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Selenium-Test-Module-Building-basic-Selenium-Test.adoc">My First Selenium Test</a></p>
</div>
<div class="paragraph">
<p>+
<a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/Mobile-Test-Module-How-to-use.adoc">How to use Mobile test Module</a></p>
</div>
<div class="paragraph">
<p>+
<a href="https://github.com/devonfw/devonfw-testing/blob/feature/Create-mobile-module-%23213/example/src/test/java/com/capgemini/mrchecker/mobile/simpleapp/SimpleAppTest.java">Example TestCase</a></p>
</div>
<div class="paragraph">
<p>+
Full list of <a href="https://github.com/appium/appium/blob/master/docs/en/writing-running-appium/caps.md#general-capabilities">Generic Capabilities</a></p>
</div>
<div class="paragraph">
<p>+
List of additional capabilities for <a href="https://github.com/appium/appium/blob/master/docs/en/writing-running-appium/caps.md#android-only">Android</a></p>
</div>
<div class="paragraph">
<p>+
List of additional capabilities for <a href="https://github.com/appium/appium/blob/master/docs/en/writing-running-appium/caps.md#ios-only">iOS</a></p>
</div>
<!-- toc disabled -->
</div>
<div class="sect5">
<h6 id="how-to-use-mobile-test-module"><a class="anchor" href="#how-to-use-mobile-test-module"></a>How to use mobile test Module</h6>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install <a href="https://github.com/devonfw/mrchecker/blob/feature/Create-mobile-module-%23213/documentation/MrChecker%20download/Windows/Easy-out-of-the-box.adoc">IDE with MrChecker</a></p>
</li>
<li>
<p>Switch branch to 'feature/Create-mobile-module-#213' - by default it is 'develop'</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>git checkout feature/Create-mobile-module-#213</pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install and setup git checkout feature/Create-mobile-module-#213[Appium Server]</p>
</li>
<li>
<p>Connect to local Device by Appium Server</p>
<div class="literalblock">
<div class="content">
<pre> 1.
Install Android SDK    https://developer.android.com/studio/index.html#command-tools    -&gt;
	2.
Download Platform and Build-Tools  (Android versions - &gt;    https://en.wikipedia.org/wiki/Android_version_history   )
* sdkmanager "platform-tools" "platforms;android-19"
* sdkmanager "build-tools;19.0.0"
* copy from /build-tools  file "aapt.exe"  to /platform-tools
	3.
Set Environment:
ANDROID_SDK_ROOT = D:\sdk-tools-windows-4333796
PATH =  %PATH%; %ANDROID_SDK_ROOT%
	4.
Start Appium Server
	5.
Start Session in Appium Server, capabilities
{
  "platformName": "Android",
            "deviceName": "Android Emulator",
            "app": "D:\\Repo\\mrchecker-source\\mrchecker-framework-modules\\mrchecker-mobile-module\\src\\test\\resources\\Simple App_v2.0.1_apkpure.com.apk",
            "automationName": "UiAutomator1"
            }</pre>
</div>
</div>
</li>
<li>
<p>Run Mobile tests with runtime parameters.
List of supported parameters could be found <a href="https://github.com/devonfw/devonfw-testing/wiki/Run-on-different-mobile-devices">here</a></p>
<div class="ulist">
<ul>
<li>
<p>From command line (as in Jenkins):</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn clean compile test  -Dapp=".\\Simple_App_v2.0.1_apkpure.com.apk" -DautomationName="UiAutomator1" -Dthread.count=1</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>from IDE:</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image00100.jpg" alt="image00100">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image00101.jpg" alt="image00101">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="devops-test-module"><a class="anchor" href="#devops-test-module"></a>26.19. DevOps Test Module</h3>
<!-- toc disabled -->
<div class="sect5">
<h6 id="devops-test-module-2"><a class="anchor" href="#devops-test-module-2"></a>DevOPS Test Module</h6>

</div>
<div class="sect5">
<h6 id="what-does-devops-mean-for-us"><a class="anchor" href="#what-does-devops-mean-for-us"></a>What does DevOps mean for us?</h6>
<div class="paragraph">
<p>DevOps consists of a mixture of three key components in a technical project:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>People&#8217;s skills and mindset</p>
</li>
<li>
<p>Processes</p>
</li>
<li>
<p>Tools</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using E2E MrChecker Test Framework it is possible to cover the majority of these areas.</p>
</div>
</div>
<div class="sect5">
<h6 id="qa-team-goal"><a class="anchor" href="#qa-team-goal"></a>QA Team Goal</h6>
<div class="paragraph">
<p>For QA engineers, it is essential to take care of the product code quality.</p>
</div>
<div class="paragraph">
<p>Therefore, we have to understand, that a <strong>test case is also code which has to be validated</strong> against quality gates. As a result, we must <strong>test our developed test case</strong> like it is done during standard Software Delivery Life Cycle.</p>
</div>
</div>
<div class="sect5">
<h6 id="well-rounded-test-case-production-process"><a class="anchor" href="#well-rounded-test-case-production-process"></a>Well rounded test case production process</h6>
<div class="ulist">
<ul>
<li>
<p>How do we define top-notch test cases development process in <strong>E2E MrChecker Test Framework</strong></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image5.png" alt="image5">
</div>
</div>
</div>
<div class="sect5">
<h6 id="continuous-integration-ci-and-continuous-delivery-cd"><a class="anchor" href="#continuous-integration-ci-and-continuous-delivery-cd"></a>Continuous Integration (CI) and Continuous Delivery (CD)</h6>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/DevOPS-Test-Module-Continuous-Integration-CI.adoc">Continuous Integration (CI)</a> - a procedure where quality gates validate test case creation process</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/DevOPS-Test-Module-Continuous-Delivery-CD.adoc">Continuous Delivery (CD)</a> - a procedure where we include created test cases, validated against CI, as smoke/regression/security</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image6.png" alt="image6">
</div>
</div>
</div>
<div class="sect5">
<h6 id="what-should-you-receive-from-this-devops-module"><a class="anchor" href="#what-should-you-receive-from-this-devops-module"></a>What should you receive from this DevOps module</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image7.png" alt="image7">
</div>
</div>
</div>
<div class="sect5">
<h6 id="what-will-you-gain-with-our-devops-module"><a class="anchor" href="#what-will-you-gain-with-our-devops-module"></a>What will you gain with our DevOps module</h6>
<div class="paragraph">
<p>The CI procedure has been divided into transparent modules. This solution makes configuration and maintenance very easy because everyone is able to manage versions and customize the configuration independently for each module. A separate security module ensures the protection of your credentials and assigned access roles regardless of changes in other modules.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image8.png" alt="image8">
</div>
</div>
<div class="paragraph">
<p>Your CI process will be matched to the current project. You can easily go back to the previous configuration, test a new one or move a selected one to other projects.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image9.png" alt="image9">
</div>
</div>
<div class="paragraph">
<p>DevOps module supports a delivery model in which executors are made available to the user as needed. It has such advantages as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Saving computing resources</p>
</li>
<li>
<p>Eliminating guessing on your infrastructure capacity needs</p>
</li>
<li>
<p>Not spending time on running and maintaining additional executors
==  How to build this DevOps module</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once you have implemented the module, you can learn more about it here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devonfw-testing/blob/develop/documentation/Who-Is-MrChecker/Test-Framework-Modules/DevOPS-Test-Module-Docker-commands.adoc">Docker commands</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="continuous-integration"><a class="anchor" href="#continuous-integration"></a>Continuous Integration</h6>
<div class="paragraph">
<p>Embrace quality with Continuous Integration while you produce test case(s).</p>
</div>
</div>
<div class="sect5">
<h6 id="overview-10"><a class="anchor" href="#overview-10"></a>Overview</h6>
<div class="paragraph">
<p>There are two ways to set up your Continuous Integration environment:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a Jenkins instance from scratch (e.g. by using the Jenkins Docker image)</p>
<div class="paragraph">
<p>Using a clean Jenkins instance requires the installation of additional plugins. The plugins required and their versions can be found on <a href="https://github.com/devonfw/devonfw-testing/wiki/jenkins-plugins">this page</a>.</p>
</div>
</li>
<li>
<p>Use thre pre-configured custom Docker image provided by us</p>
<div class="paragraph">
<p>No more additional configuration is required (but optional) using this custom Docker image. Additionally, this Jenkins setup allows dynamical scaling across multiple machines and even cloud (AWS, Azure, Google Cloud etc.).</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="jenkins-overview"><a class="anchor" href="#jenkins-overview"></a>Jenkins Overview</h6>
<div class="paragraph">
<p>Jenkins is an Open Source Continuous Integration Tool. It allows the user to create automated build jobs which will run remotely on so called Jenkins Slaves. A build job can be triggered by several events, for example on new pull request on specified repositories or timed (e.g. at midnight).</p>
</div>
</div>
<div class="sect5">
<h6 id="jenking-configuration"><a class="anchor" href="#jenking-configuration"></a>Jenking Configuration</h6>
<div class="paragraph">
<p>Tests created by using the testing framework can easily be implemented on a Jenkins instance. The following chapter will describe such a job configuration. If you’re running your own Jenkins instance, you may have to install additional plugins listed on the page <a href="https://github.com/devonfw/devonfw-testing/wiki/jenkins-plugins">Jenkins Plugins</a> for a trouble-free integration of your tests.</p>
</div>
</div>
<div class="sect5">
<h6 id="initial-configuration"><a class="anchor" href="#initial-configuration"></a>==  Initial Configuration</h6>
<div class="paragraph">
<p>The test job is configured as a so-called <em>parameterized</em> job. This means, after starting the job, parameters can be specified, which will then be used in the build process. In this case, <em>branch</em> and <em>testname</em> will be expected when starting the job. These parameters specify which branch in the code repository should be checked out (possibly feature branch) and the name of the test that should be executed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image79.png" alt="image79">
</div>
</div>
</div>
<div class="sect5">
<h6 id="build-process-configuration"><a class="anchor" href="#build-process-configuration"></a>==  Build Process Configuration</h6>
<div class="ulist">
<ul>
<li>
<p>The first step inside the build process configuration is to get the author of the commit that was made. The mail will be extracted and gets stored in a file called <em>build.properties</em>. This way, the author can be notified if the build fails.</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/image80.png" alt="image80">
</div>
</div>
</li>
<li>
<p>Next up, Maven will be used to check if the code can be compiled, without running any tests.</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/image81.png" alt="image81">
</div>
</div>
<div class="paragraph">
<p>After making sure that the code can be compiled, the actual tests will be executed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image82.png" alt="image82">
</div>
</div>
</li>
<li>
<p>Finally, reports will be generated.</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/image83.png" alt="image83">
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="post-build-configuration"><a class="anchor" href="#post-build-configuration"></a>==  Post Build Configuration</h6>
<div class="ulist">
<ul>
<li>
<p>At first, the results will be imported to the <a href="https://github.com/devonfw/devonfw-testing/wiki/Allure-report#allure-reports">Allure System</a></p>
<div class="imageblock">
<div class="content">
<img src="_images/images/image84.png" alt="image84">
</div>
</div>
</li>
<li>
<p>JUnit test results will be reported as well. Using this step, the test result trend graph will be displayed on the Jenkins job overview.</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/image85.png" alt="image85">
</div>
</div>
</li>
<li>
<p>Finally, an E-Mail will be sent to the previously extracted author of the commit.</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/image86.png" alt="image86">
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="using-the-pre-configured-custom-docker-image"><a class="anchor" href="#using-the-pre-configured-custom-docker-image"></a>Using the Pre-Configured Custom Docker Image</h6>
<div class="paragraph">
<p>If you are starting a new Jenkins instance for your tests, we’d suggest using the pre-configured Docker image. This image already contains all the configurations and additional features.</p>
</div>
<div class="paragraph">
<p>The configurations are e.g. Plugins and Pre-Installed job setup samples. This way, you don’t have to set up the entire CI-Environment from the ground up.</p>
</div>
<div class="paragraph">
<p>Additional features from this docker image allow dynamic creation and deletion of Jenkins slaves, by creating Docker containers. Also, Cloud Solutions can be implemented to allow wide-spread load balancing.</p>
</div>
</div>
<div class="sect5">
<h6 id="continuous-delivery"><a class="anchor" href="#continuous-delivery"></a>Continuous Delivery</h6>
<div class="paragraph">
<p>Include quality with Continuous Delivery during product release.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image87.png" alt="image87">
</div>
</div>
</div>
<div class="sect5">
<h6 id="overview-11"><a class="anchor" href="#overview-11"></a>Overview</h6>
<div class="paragraph">
<p>CD from Jenkins point of view does not change a lot from Continuous Integration one.</p>
</div>
</div>
<div class="sect5">
<h6 id="jenkins-overview-2"><a class="anchor" href="#jenkins-overview-2"></a>Jenkins Overview</h6>
<div class="paragraph">
<p>Use the same Jenkins settings for Jenkins CD setup as for CI, please. <a href="https://github.com/devonfw/devonfw-testing/wiki/continuous-integration#jenkins-configuration">link</a>. The only difference is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What type of test you will execute. Before, we have been choosing test case(s), now we will choose test suite(s)</p>
</li>
<li>
<p>Who will trigger the given Smoke/Integration/Performance job</p>
</li>
<li>
<p>What is the name of official branch. This branch ought always to use be used in every CD execution. It will be either <strong>master</strong> or <strong>develop</strong>.</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="jenkins-for-smoke-tests"><a class="anchor" href="#jenkins-for-smoke-tests"></a>Jenkins for Smoke Tests</h6>
<div class="paragraph">
<p>In the $TESTNAME variable, where we input the test name( <a href="https://github.com/devonfw/devonfw-testing/wiki/continuous-integration#initial-configuration">link</a> ), please input the name of a test suite assembled together of tests tagged as smoke tests -( <a href="https://github.com/devonfw/devonfw-testing/wiki/tags-and-test-suites">link</a> ) thus running all the smoke tests.</p>
</div>
</div>
<div class="sect5">
<h6 id="jenkins-for-performance-tests"><a class="anchor" href="#jenkins-for-performance-tests"></a>Jenkins for Performance Tests</h6>
<div class="paragraph">
<p>Under construction - added when WebAPI module is included.</p>
</div>
</div>
<div class="sect5">
<h6 id="pipeline-structure"><a class="anchor" href="#pipeline-structure"></a>Pipeline structure</h6>

</div>
<div class="sect5">
<h6 id="pipeline-configuration"><a class="anchor" href="#pipeline-configuration"></a>Pipeline configuration:</h6>
<div class="paragraph">
<p>The default interaction with Jenkins required manual jobs. This keeps configuration of a job in Jenkins separate from source code. With Pipeline plugin users can implement a pipeline procedure in Jenkinsfile and store it in repository with other code. This approach is used in Mr Checker framework. More info: <a href="https://jenkins.io/solutions/pipeline/" class="bare">https://jenkins.io/solutions/pipeline/</a></p>
</div>
<div class="paragraph">
<p>Our CI &amp; CD processes are divided into a few separate files: Jenkins_node.groovy is the file to manage all processes. It defines all operations executed on a Jenkins node, so all code in this file is closed in node closure. Workflow in Jenkinsfile:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Read all parameters from a Jenkins job</p>
</li>
<li>
<p>Execute stage to prepare the environment</p>
</li>
<li>
<p>Execute git pull command</p>
</li>
<li>
<p>Set Jenkins job description</p>
</li>
<li>
<p>Execute compilation of the project in a special prepared docker container</p>
</li>
<li>
<p>Execute unit tests</p>
</li>
<li>
<p>Execute integration tests</p>
</li>
<li>
<p>Deploy artifacts to a local repository</p>
</li>
<li>
<p>Deploy artifacts to an external repository (nexus/arifactory)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Not all the steps must be present in the Jenkins files. This should be configured for particular job requirements.</p>
</div>
</div>
<div class="sect5">
<h6 id="description-of-stages"><a class="anchor" href="#description-of-stages"></a>Description of stages:</h6>

</div>
<div class="sect5">
<h6 id="stage-prepare-environment"><a class="anchor" href="#stage-prepare-environment"></a>Stage “Prepare environment”</h6>
<div class="paragraph">
<p>First thing to do in this stage is overwriting properties loaded from Jenkins job. It is defined in “overrideProperties” function. The next function, “setJenkinsJobVariables” defines environment variables such as :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JOB_NAME_UPSTREAM</p>
</li>
<li>
<p>BUILD_DISPLAY_NAME_UPSTREAM</p>
</li>
<li>
<p>BUILD_URL_UPSTREAM</p>
</li>
<li>
<p>GIT_CREDENTIALS</p>
</li>
<li>
<p>JENKINS_CREDENTIALS</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The last function in the stage – “setWorkspace”  -creates an environment variable with path to local workspace. This is required beacuse when using pipeline plugin, Jenkins does not create the WORKSPACE env variables.</p>
</div>
</div>
<div class="sect5">
<h6 id="stage-git-pull"><a class="anchor" href="#stage-git-pull"></a>Stage "Git pull"</h6>
<div class="paragraph">
<p>It pulls sources from the repository and loads “git pull” file which contains additional methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>setGitAuthor – setting properties about git author to the file “build.properties” and loading created file</p>
</li>
<li>
<p>tryMergeWithBranch – checking if actual branch can be merged with default main branch</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="stage-build-compile"><a class="anchor" href="#stage-build-compile"></a>Stage “Build compile”</h6>
<div class="paragraph">
<p>Verify with maven that code builds without errors</p>
</div>
</div>
<div class="sect5">
<h6 id="stage-unit-test"><a class="anchor" href="#stage-unit-test"></a>Stage “Unit test”</h6>
<div class="paragraph">
<p>Execute unit tests with mvn surefire test and publish reports in junit and allure format</p>
</div>
</div>
<div class="sect5">
<h6 id="stage-integration-test"><a class="anchor" href="#stage-integration-test"></a>Stage “Integration test”</h6>
<div class="paragraph">
<p>Execute integration tests with mvn surefire test and publish reports in junit and allure format</p>
</div>
</div>
<div class="sect5">
<h6 id="stage-deploy-local-repo"><a class="anchor" href="#stage-deploy-local-repo"></a>Stage “Deploy – local repo”</h6>
<div class="paragraph">
<p>Archive artifacts as a jar file in the local repository</p>
</div>
</div>
<div class="sect5">
<h6 id="stage-deploy-nexu-repo"><a class="anchor" href="#stage-deploy-nexu-repo"></a>Stage ”Deploy – nexu repo”</h6>
<div class="paragraph">
<p>Deploy to the external repository with maven release deploy command with credentials stored in Jenkins machine. Additional files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>mailSender.groovy – contains methods for sending mail with generated content</p>
</li>
<li>
<p>stashNotification.groovy – send job status for bitbucket by a curl command</p>
</li>
<li>
<p>utils.groovy - contains additional functions to load properties, files and generate additional data</p>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="selenium-grid"><a class="anchor" href="#selenium-grid"></a>Selenium Grid</h6>

</div>
<div class="sect5">
<h6 id="what-is-selenium-grid"><a class="anchor" href="#what-is-selenium-grid"></a>What is Selenium Grid</h6>
<div class="paragraph">
<p>Selenium Grid allows running web/mobile browsers test cases to fulfill basic factors, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Independent infrastructure, similar to end-users'</p>
</li>
<li>
<p>Scalable infrastructure (\~50 simultaneous sessions at once)</p>
</li>
<li>
<p>Huge variety of web browsers (from mobile to desktop)</p>
</li>
<li>
<p>Continuous Integration and Continuous Delivery process</p>
</li>
<li>
<p>Supporting multi-type programming languages (java, javascript, python, …​).</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image88.png" alt="image88">
</div>
</div>
<div class="paragraph">
<p>On a daily basis, a test automation engineer uses their local environments for test case execution/development. However, a created browser test case has to be able to run on any  infrastructure. Selenium Grid enables this portability.</p>
</div>
</div>
<div class="sect5">
<h6 id="selenium-grid-structure"><a class="anchor" href="#selenium-grid-structure"></a>Selenium Grid Structure</h6>
<div class="imageblock">
<div class="content">
<img src="_images/images/image89.png" alt="image89">
</div>
</div>
<div class="paragraph">
<p>Full documentation of Selenium Grid can be found <a href="https://github.com/SeleniumHQ/selenium">here</a> and <a href="http://docs.seleniumhq.org/docs/07_selenium_grid.jsp">here</a>.</p>
</div>
<div class="paragraph">
<p>'Vanilla flavour' Selenium Grid is based on two, not very complicated ingredients:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Selenium Hub</strong> - as one machine, accepting connections to grid from test cases executors. It also plays a managerial role in connection to/from Selenium Nodes</p>
</li>
<li>
<p><strong>Selenium Node</strong> - from one to many machines, where on each machine a browser used during test case execution is installed.</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="how-to-setup"><a class="anchor" href="#how-to-setup"></a>How to setup</h6>
<div class="paragraph">
<p>There are two options of Selenium Grid setup:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Classic, static solution - <a href="http://docs.seleniumhq.org/docs/07_selenium_grid.jsp#installation">link</a></p>
</li>
<li>
<p>Cloud, scalable solution - <a href="https://bitbucket.org/lukasz_stefaniszyn/seleniumgriddockercompose/overview">link</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Advantages and disadvantages of both solutions:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image90.png" alt="image90">
</div>
</div>
</div>
<div class="sect5">
<h6 id="how-to-use-selenium-grid-with-e2e-mr-checker-test-frameworks"><a class="anchor" href="#how-to-use-selenium-grid-with-e2e-mr-checker-test-frameworks"></a>How to use Selenium Grid with E2E Mr Checker Test Frameworks</h6>
<div class="paragraph">
<p>Run the following command either in Eclipse or in Jenkins:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&gt; mvn test -Dtest=com.capgemini.ntc.selenium.tests.samples.resolutions.ResolutionTest -DseleniumGrid="http://10.40.232.61:4444/wd/hub" -Dos=LINUX -Dbrowser=chrome</pre>
</div>
</div>
<div class="paragraph">
<p>As a result of this command:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-Dtest=com.capgemini.ntc.selenium.features.samples.resolutions.ResolutionTest</code> - name of test case to execute</p>
</li>
<li>
<p><code>-DseleniumGrid="http://10.40.232.61:4444/wd/hub"</code> - IP address of Selenium Hub</p>
</li>
<li>
<p><code>-Dos=LINUX</code> - what operating system must be assumed during test case execution</p>
</li>
<li>
<p><code>-Dbrowser=chrome</code> - what type of browser will be used during test case execution</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image91.png" alt="image91">
</div>
</div>
</div>
<div class="sect5">
<h6 id="list-of-jenkins-plugins"><a class="anchor" href="#list-of-jenkins-plugins"></a>List of Jenkins Plugins</h6>
<div class="paragraph">
<p>|== =</p>
</div>
<div class="paragraph">
<p>|Plugin Name
|Version</p>
</div>
<div class="paragraph">
<p>|blueocean-github-pipeline
|1.1.4</p>
</div>
<div class="paragraph">
<p>|blueocean-display-url
|2.0</p>
</div>
<div class="paragraph">
<p>|blueocean
|1.1.4</p>
</div>
<div class="paragraph">
<p>|workflow-support
|2.14</p>
</div>
<div class="paragraph">
<p>|workflow-api
|2.18</p>
</div>
<div class="paragraph">
<p>|plain-credentials
|1.4</p>
</div>
<div class="paragraph">
<p>|pipeline-stage-tags-metadata
|1.1.8</p>
</div>
<div class="paragraph">
<p>|credentials-binding
|1.12</p>
</div>
<div class="paragraph">
<p>|git
|3.5.1</p>
</div>
<div class="paragraph">
<p>|maven-plugin
|2.17</p>
</div>
<div class="paragraph">
<p>|workflow-durable-task-step
|2.12</p>
</div>
<div class="paragraph">
<p>|job-dsl
|1.64</p>
</div>
<div class="paragraph">
<p>|git-server
|1.7</p>
</div>
<div class="paragraph">
<p>|windows-slaves
|1.3.1</p>
</div>
<div class="paragraph">
<p>|github
|1.27.0</p>
</div>
<div class="paragraph">
<p>|blueocean-personalization
|1.1.4</p>
</div>
<div class="paragraph">
<p>|jackson2-api
|2.7.3</p>
</div>
<div class="paragraph">
<p>|momentjs
|1.1.1</p>
</div>
<div class="paragraph">
<p>|workflow-basic-steps
|2.6</p>
</div>
<div class="paragraph">
<p>|workflow-aggregator
|2.5</p>
</div>
<div class="paragraph">
<p>|blueocean-rest
|1.1.4</p>
</div>
<div class="paragraph">
<p>|gradle
|1.27.1</p>
</div>
<div class="paragraph">
<p>|pipeline-maven
|3.0.0</p>
</div>
<div class="paragraph">
<p>|blueocean-pipeline-editor
|0.2.0</p>
</div>
<div class="paragraph">
<p>|durable-task
|1.14</p>
</div>
<div class="paragraph">
<p>|scm-api
|2.2.2</p>
</div>
<div class="paragraph">
<p>|pipeline-model-api
|1.1.8</p>
</div>
<div class="paragraph">
<p>|config-file-provider
|2.16.3</p>
</div>
<div class="paragraph">
<p>|github-api
|1.85.1</p>
</div>
<div class="paragraph">
<p>|pam-auth
|1.3</p>
</div>
<div class="paragraph">
<p>|workflow-cps-global-lib
|2.8</p>
</div>
<div class="paragraph">
<p>|github-organization-folder
|1.6</p>
</div>
<div class="paragraph">
<p>|workflow-job
|2.12.1</p>
</div>
<div class="paragraph">
<p>|variant
|1.1</p>
</div>
<div class="paragraph">
<p>|git-client
|2.5.0</p>
</div>
<div class="paragraph">
<p>|sse-gateway
|1.15</p>
</div>
<div class="paragraph">
<p>|script-security
|1.29.1</p>
</div>
<div class="paragraph">
<p>|token-macro
|2.1</p>
</div>
<div class="paragraph">
<p>|jquery-detached
|1.2.1</p>
</div>
<div class="paragraph">
<p>|blueocean-web
|1.1.4</p>
</div>
<div class="paragraph">
<p>|timestamper
|1.8.8</p>
</div>
<div class="paragraph">
<p>|greenballs
|1.15</p>
</div>
<div class="paragraph">
<p>|handlebars
|1.1.1</p>
</div>
<div class="paragraph">
<p>|blueocean-jwt
|1.1.4</p>
</div>
<div class="paragraph">
<p>|pipeline-stage-view
|2.8</p>
</div>
<div class="paragraph">
<p>|blueocean-i18n
|1.1.4</p>
</div>
<div class="paragraph">
<p>|blueocean-git-pipeline
|1.1.4</p>
</div>
<div class="paragraph">
<p>|ace-editor
|1.1</p>
</div>
<div class="paragraph">
<p>|pipeline-stage-step
|2.2</p>
</div>
<div class="paragraph">
<p>|email-ext
|2.58</p>
</div>
<div class="paragraph">
<p>|envinject-api
|1.2</p>
</div>
<div class="paragraph">
<p>|role-strategy
|2.5.1</p>
</div>
<div class="paragraph">
<p>|structs
|1.9</p>
</div>
<div class="paragraph">
<p>|locale
|1.2</p>
</div>
<div class="paragraph">
<p>|docker-workflow
|1.13</p>
</div>
<div class="paragraph">
<p>|ssh-credentials
|1.13</p>
</div>
<div class="paragraph">
<p>|blueocean-pipeline-scm-api
|1.1.4</p>
</div>
<div class="paragraph">
<p>|metrics
|3.1.2.10</p>
</div>
<div class="paragraph">
<p>|external-monitor-job
|1.7</p>
</div>
<div class="paragraph">
<p>|junit
|1.21</p>
</div>
<div class="paragraph">
<p>|github-branch-source
|2.0.6</p>
</div>
<div class="paragraph">
<p>|blueocean-config
|1.1.4</p>
</div>
<div class="paragraph">
<p>|cucumber-reports
|3.8.0</p>
</div>
<div class="paragraph">
<p>|pipeline-model-declarative-agent
|1.1.1</p>
</div>
<div class="paragraph">
<p>|blueocean-dashboard
|1.1.4</p>
</div>
<div class="paragraph">
<p>|subversion
|2.9</p>
</div>
<div class="paragraph">
<p>|blueocean-autofavorite
|1.0.0</p>
</div>
<div class="paragraph">
<p>|pipeline-rest-api
|2.8</p>
</div>
<div class="paragraph">
<p>|pipeline-input-step
|2.7</p>
</div>
<div class="paragraph">
<p>|matrix-project
|1.11</p>
</div>
<div class="paragraph">
<p>|pipeline-github-lib
|1.0</p>
</div>
<div class="paragraph">
<p>|workflow-multibranch
|2.16</p>
</div>
<div class="paragraph">
<p>|docker-plugin
|0.16.2</p>
</div>
<div class="paragraph">
<p>|resource-disposer
|0.6</p>
</div>
<div class="paragraph">
<p>|icon-shim
|2.0.3</p>
</div>
<div class="paragraph">
<p>|workflow-step-api
|2.12</p>
</div>
<div class="paragraph">
<p>|blueocean-events
|1.1.4</p>
</div>
<div class="paragraph">
<p>|workflow-scm-step
|2.6</p>
</div>
<div class="paragraph">
<p>|display-url-api
|2.0</p>
</div>
<div class="paragraph">
<p>|favorite
|2.3.0</p>
</div>
<div class="paragraph">
<p>|build-timeout
|1.18</p>
</div>
<div class="paragraph">
<p>|mapdb-api
|1.0.9.0</p>
</div>
<div class="paragraph">
<p>|pipeline-build-step
|2.5.1</p>
</div>
<div class="paragraph">
<p>|antisamy-markup-formatter
|1.5</p>
</div>
<div class="paragraph">
<p>|javadoc
|1.4</p>
</div>
<div class="paragraph">
<p>|blueocean-commons
|1.1.4</p>
</div>
<div class="paragraph">
<p>|cloudbees-folder
|6.1.2</p>
</div>
<div class="paragraph">
<p>|ssh-slaves
|1.20</p>
</div>
<div class="paragraph">
<p>|pubsub-light
|1.10</p>
</div>
<div class="paragraph">
<p>|pipeline-graph-analysis
|1.4</p>
</div>
<div class="paragraph">
<p>|allure-jenkins-plugin
|2.23</p>
</div>
<div class="paragraph">
<p>|mailer
|1.20</p>
</div>
<div class="paragraph">
<p>|ws-cleanup
|0.33</p>
</div>
<div class="paragraph">
<p>|authentication-tokens
|1.3</p>
</div>
<div class="paragraph">
<p>|blueocean-pipeline-api-impl
|1.1.4</p>
</div>
<div class="paragraph">
<p>|ldap
|1.16</p>
</div>
<div class="paragraph">
<p>|docker-commons
|1.8</p>
</div>
<div class="paragraph">
<p>|branch-api
|2.0.10</p>
</div>
<div class="paragraph">
<p>|workflow-cps
|2.36.1</p>
</div>
<div class="paragraph">
<p>|pipeline-model-definition
|1.1.8</p>
</div>
<div class="paragraph">
<p>|blueocean-rest-impl
|1.1.4</p>
</div>
<div class="paragraph">
<p>|ant
|1.7</p>
</div>
<div class="paragraph">
<p>|credentials
|2.1.14</p>
</div>
<div class="paragraph">
<p>|matrix-auth
|1.7</p>
</div>
<div class="paragraph">
<p>|pipeline-model-extensions
|1.1.8</p>
</div>
<div class="paragraph">
<p>|pipeline-milestone-step
|1.3.1</p>
</div>
<div class="paragraph">
<p>|jclouds-jenkins
|2.14</p>
</div>
<div class="paragraph">
<p>|bouncycastle-api
|2.16.1</p>
</div>
<div class="paragraph">
<p>|== =</p>
</div>
</div>
<div class="sect5">
<h6 id="what-is-docker"><a class="anchor" href="#what-is-docker"></a>What is Docker</h6>
<div class="paragraph">
<p>Docker is an open source software platform to create, deploy and manage virtualized application containers on a common operating system (OS), with an ecosystem of allied tools.</p>
</div>
</div>
<div class="sect5">
<h6 id="where-do-we-use-docker"><a class="anchor" href="#where-do-we-use-docker"></a>Where do we use Docker</h6>
<div class="paragraph">
<p>DevOps module consists of Docker images</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Jenkins image</p>
</li>
<li>
<p>Jenkins job image</p>
</li>
<li>
<p>Jenkins management image</p>
</li>
<li>
<p>Security image</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>in addition, each new node is also based on Docker</p>
</div>
</div>
<div class="sect5">
<h6 id="exploring-basic-docker-options"><a class="anchor" href="#exploring-basic-docker-options"></a>Exploring basic Docker options</h6>
<div class="paragraph">
<p>Let’s show some of the most important commands that are needed when working with our DevOps module based on the Docker platform. Each command given below should be preceded by a sudo call by default. If you don’t want to use <code>sudo</code> command create a Unix group called docker and add a user to it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ sudo groupadd docker
$ sudo usermod -aG docker $USER</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="build-an-image-from-a-dockerfile"><a class="anchor" href="#build-an-image-from-a-dockerfile"></a>Build an image from a Dockerfile</h6>
<div class="listingblock">
<div class="content">
<pre>##docker build [OPTIONS] PATH | URL | -
##
##Options:
## --tag , -t : Name and optionally a tag in the ‘name:tag’ format

$ docker build -t vc_jenkins_jobs .</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="container-start"><a class="anchor" href="#container-start"></a>Container start</h6>
<div class="listingblock">
<div class="content">
<pre>##docker run [OPTIONS] IMAGE[:TAG|@DIGEST] [COMMAND] [ARG...]
#
##Options:
##-d : To start a container in detached mode (background)
##-it : interactive terminal
##--name : assign a container name
##--rm : clean up
##--volumes-from="": Mount all volumes from the given container(s)
##-p : explicitly map a single port or range of ports
##--volume : storage associated with the image

$ docker run -d --name vc_jenkins_jobs vc_jenkins_jobs</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="remove-one-or-more-containers"><a class="anchor" href="#remove-one-or-more-containers"></a>Remove one or more containers</h6>
<div class="listingblock">
<div class="content">
<pre>##docker rm [OPTIONS] CONTAINER
#
##Options:
##--force , -f : Force the removal of a running container

$ docker rm -f jenkins</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="list-containers"><a class="anchor" href="#list-containers"></a>List containers</h6>
<div class="listingblock">
<div class="content">
<pre>##docker ps [OPTIONS]
##--all, -a : Show all containers (default shows just running)

$ docker ps</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="pull-an-image-or-a-repository-from-a-registry"><a class="anchor" href="#pull-an-image-or-a-repository-from-a-registry"></a>Pull an image or a repository from a registry</h6>
<div class="listingblock">
<div class="content">
<pre>##docker pull [OPTIONS] NAME[:TAG|@DIGEST]

$ docker pull jenkins/jenkins:2.73.1</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="push-the-image-or-a-repository-to-a-registry"><a class="anchor" href="#push-the-image-or-a-repository-to-a-registry"></a>Push the image or a repository to a registry</h6>
<div class="paragraph">
<p>Pushing new image takes place in two steps. First save the image by adding container ID to the commit command and next use push:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>##docker push [OPTIONS] NAME[:TAG]

$ docker ps
  # copy container ID from the result
$ docker commit b46778v943fh vc_jenkins_mng:project_x
$ docker push vc_jenkins_mng:project_x</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="return-information-on-docker-object"><a class="anchor" href="#return-information-on-docker-object"></a>Return information on Docker object</h6>
<div class="listingblock">
<div class="content">
<pre>##docker inspect [OPTIONS] NAME|ID [NAME|ID...]
#
##Options:
##--format , -f : output format

$ docker inspect -f '{{ .Mounts }}' vc_jenkins_mng</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="list-images"><a class="anchor" href="#list-images"></a>List images</h6>
<div class="listingblock">
<div class="content">
<pre>##docker images [OPTIONS] [REPOSITORY[:TAG]]
#
##Options:
--all , -a : show all images with intermediate images

$ docker images
$ docker images jenkins</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="remove-one-or-more-images"><a class="anchor" href="#remove-one-or-more-images"></a>Remove one or more images</h6>
<div class="listingblock">
<div class="content">
<pre>##docker rmi [OPTIONS] IMAGE [IMAGE...]
#
##Options:
##  --force , -f : Force removal of the image

$ docker rmi jenkins/jenkins:latest</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="run-a-command-in-a-running-container"><a class="anchor" href="#run-a-command-in-a-running-container"></a>Run a command in a running container</h6>
<div class="listingblock">
<div class="content">
<pre>##docker exec [OPTIONS] CONTAINER COMMAND [ARG...]
##-d : run command in the background
##-it : interactive terminal
##-w : working directory inside the container
##-e : Set environment variables

$ docker exec vc_jenkins_jobs sh -c "chmod 755 config.xml"</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="advanced-commands"><a class="anchor" href="#advanced-commands"></a>Advanced commands</h6>

</div>
<div class="sect5">
<h6 id="remove-dangling-images"><a class="anchor" href="#remove-dangling-images"></a>Remove dangling images</h6>
<div class="listingblock">
<div class="content">
<pre>$ docker rmi $(docker images -f dangling=true -q)</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="remove-all-images"><a class="anchor" href="#remove-all-images"></a>Remove all images</h6>
<div class="listingblock">
<div class="content">
<pre>$ docker rmi $(docker images -a -q)</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="removing-images-according-to-a-pattern"><a class="anchor" href="#removing-images-according-to-a-pattern"></a>Removing images according to a pattern</h6>
<div class="listingblock">
<div class="content">
<pre>$ docker images | grep "pattern" | awk '{print $2}' | xargs docker rm</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="remove-all-exited-containers"><a class="anchor" href="#remove-all-exited-containers"></a>Remove all exited containers</h6>
<div class="listingblock">
<div class="content">
<pre>$ docker rm $(docker ps -a -f status=exited -q)</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="remove-all-stopped-containers"><a class="anchor" href="#remove-all-stopped-containers"></a>Remove all stopped containers</h6>
<div class="listingblock">
<div class="content">
<pre>$ docker rm $(docker ps --no-trunc -aq)</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="remove-containers-according-to-a-pattern"><a class="anchor" href="#remove-containers-according-to-a-pattern"></a>Remove containers according to a pattern</h6>
<div class="listingblock">
<div class="content">
<pre>$ docker ps -a | grep "pattern" | awk '{print $1}' | xargs docker rmi</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="remove-dangling-volumes"><a class="anchor" href="#remove-dangling-volumes"></a>Remove dangling volumes</h6>
<div class="listingblock">
<div class="content">
<pre>$ docker volume rm $(docker volume ls -f dangling=true -q)</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mrchecker-download"><a class="anchor" href="#mrchecker-download"></a>26.20. MrChecker download</h3>

</div>
<div class="sect2">
<h3 id="windows"><a class="anchor" href="#windows"></a>26.21. Windows</h3>
<!-- toc disabled -->
<div class="sect5">
<h6 id="advanced-installation"><a class="anchor" href="#advanced-installation"></a>Advanced installation</h6>

</div>
<div class="sect5">
<h6 id="java-installation"><a class="anchor" href="#java-installation"></a>Java installation</h6>
<div class="paragraph">
<p>There is one important pre-requisite for Mr Checker installation - Java has to be installed on the computer and an environmental variable has to be set in order to obtain optimal functioning of the framework.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install Java 1.8 JDK 64bit</p>
<div class="paragraph">
<p>Download and install <span class="line-through"><a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">Java download link</a></span></p>
</div>
<div class="paragraph">
<p><em>(To download JDK 8 from Oracle you have to have an account. It is recommended to get a JDK build based on OpenJDK from <a href="https://adoptopenjdk.net/">AdoptOpenJDK</a>)</em></p>
</div>
</li>
<li>
<p>Windows Local Environment - <a href="https://www.java.com/en/download/help/path.xml">How to set</a>:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Variable name</strong>: JAVA_HOME | <strong>Variable value</strong>: C:\Where_You’ve_Installed_Java</p>
</li>
<li>
<p><strong>Variable name</strong>: PATH | <strong>Variable value</strong>: %JAVA_HOME%\bin;%JAVA_HOME%\lib</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/install_win03.png" alt="install win03">
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Next, verify it in the command line:</p>
<div class="listingblock">
<div class="content">
<pre>&gt; java --version</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="other-components-installation"><a class="anchor" href="#other-components-installation"></a>Other components installation</h6>
<div class="paragraph">
<p>Install each component separately, or update the existing ones on your PC.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Maven 3.5</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.5.0/apache-maven-3.5.0-bin.zip">Download Maven</a></p>
</li>
<li>
<p>Unzip Maven in following location C:\maven</p>
</li>
<li>
<p>Set Windows Local Environment</p>
<div class="ulist">
<ul>
<li>
<p><strong>Variable name</strong>: M2_HOME | <strong>Variable value</strong>: C:\maven\apache-maven-3.5.0</p>
</li>
<li>
<p><strong>Variable name</strong>: PATH | <strong>Variable value</strong>: %M2_HOME%\bin</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/install_win04.png" alt="install win04">
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Verify it in the command line:</p>
<div class="listingblock">
<div class="content">
<pre>&gt; mvn --version</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>IDE</p>
<div class="ulist">
<ul>
<li>
<p>Download a most recent <a href="https://www.eclipse.org/downloads/packages/">Eclipse</a></p>
</li>
<li>
<p>Download a MrChecker Project <a href="https://downgit.github.io/" class="bare">https://downgit.github.io/</a><mark>/home?url=https://github.com/devonfw/mrchecker/tree/develop/template[Template] to start a new project or Mrchecker Project <a href="https://downgit.github.io/" class="bare">https://downgit.github.io/</a></mark>/home?url=https://github.com/devonfw/mrchecker/tree/develop/example[Example] to get better understanding what we are capable of.</p>
</li>
<li>
<p>You should consider installing some usefull plugins such as: csvedit, cucumber editor.</p>
</li>
<li>
<p>Import:</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/install_win05.png" alt="install win05">
</div>
</div>
</li>
<li>
<p>Projects from folders</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/install_win06.png" alt="install win06">
</div>
</div>
</li>
<li>
<p>Open already created projects:</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/install_win07.png" alt="install win07">
</div>
</div>
</li>
<li>
<p>Update project structure - <em>ALT</em> + <em>F5</em></p>
<div class="imageblock">
<div class="content">
<img src="_images/images/install_win08.png" alt="install win08">
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="mac"><a class="anchor" href="#mac"></a>26.22. Mac</h3>
<!-- toc disabled -->
<div class="sect5">
<h6 id="mrchecker-macos-installation"><a class="anchor" href="#mrchecker-macos-installation"></a>MrChecker macOS installation</h6>
<div class="paragraph">
<p>On this page, you can find all the details regarding MrChecker installation on your Mac.</p>
</div>
</div>
<div class="sect5">
<h6 id="java-installation-2"><a class="anchor" href="#java-installation-2"></a>Java installation</h6>
<div class="paragraph">
<p>There is one important pre-requisite for Mr Checker installation - Java has to be installed on the computer and an environmental variable has to be set in order to obtain optimal functioning of the framework.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install Java 1.8 JDK 64bit</p>
<div class="paragraph">
<p>Download and install <span class="line-through"><a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html">Java download link</a></span></p>
</div>
<div class="paragraph">
<p><em>(To download JDK 8 from Oracle you have to have an account. It is recommended to get a JDK build based on OpenJDK from <a href="https://adoptopenjdk.net/">AdoptOpenJDK</a>)</em></p>
</div>
</li>
<li>
<p>Next, verify thx in the command line:</p>
<div class="literalblock">
<div class="content">
<pre>&gt; java --version</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="other-components-installation-2"><a class="anchor" href="#other-components-installation-2"></a>Other components installation</h6>
<div class="paragraph">
<p>Install each component separately, or update the existing ones on your Mac.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Maven 3.5</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://repo.maven.apache.org/maven2/org/apache/maven/apache-maven/3.5.0/apache-maven-3.5.0-bin.zip">Download Maven</a></p>
</li>
<li>
<p>Unzip Maven in the following location /maven</p>
</li>
<li>
<p>Add Maven to PATH</p>
<div class="literalblock">
<div class="content">
<pre>&gt; $ export PATH=$PATH:/maven/apache-maven-3.5.0/bin/</pre>
</div>
</div>
</li>
<li>
<p>Verify in terminal:</p>
<div class="literalblock">
<div class="content">
<pre>&gt; $ mvn -version</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Eclipse IDE</p>
<div class="ulist">
<ul>
<li>
<p>Download and unzip <a href="https://www.eclipse.org/downloads/download.php?file=/oomph/epp/2019-06/R/eclipse-inst-mac64.dmg">Eclipse</a></p>
</li>
<li>
<p>Download MrCheckerTestFramework <a href="https://github.com/devonfw/devonfw-testing/archive/develop.zip">source code</a></p>
</li>
<li>
<p>Import:</p>
<div class="imageblock">
<div class="content">
<img src="_images/images/image9.png" alt="image9">
</div>
</div>
</li>
<li>
<p>Select Projects from folders:</p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/image10.png" alt="image10"></span></p>
</div>
</li>
<li>
<p>Open already created projects:</p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/image11.png" alt="image11"></span></p>
</div>
</li>
<li>
<p>Update project structure - <em>ALT</em> + <em>F5</em></p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/image12.png" alt="image12"></span></p>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="my-thai-star-2"><a class="anchor" href="#my-thai-star-2"></a>26.23. My Thai Star</h3>
<!-- toc disabled -->
<div class="sect5">
<h6 id="my-thai-star-application-setup"><a class="anchor" href="#my-thai-star-application-setup"></a>My Thai Star application setup</h6>
<div class="paragraph">
<p>My Thai Star is a reference application for DevonFW so it was used extensively in majority of our examples. To make them run properly you definitely should set it up somewhere and configure environment.csv accordingly.
You can get the app from its official repository here <a href="https://github.com/devonfw/my-thai-star" class="bare">https://github.com/devonfw/my-thai-star</a>.</p>
</div>
</div>
<div class="sect5">
<h6 id="setting-up-my-thai-start-app"><a class="anchor" href="#setting-up-my-thai-start-app"></a>Setting up My Thai Start app</h6>
<div class="paragraph">
<p>Most of the important informations are covered in <a href="https://github.com/devonfw/my-thai-star#deployment" class="bare">https://github.com/devonfw/my-thai-star#deployment</a>.</p>
</div>
<div class="olist arabic">
<div class="title">The quick summary would be:</div>
<ol class="arabic">
<li>
<p>Get the machine with docker and docker-compose</p>
</li>
<li>
<p>Download the repository</p>
</li>
<li>
<p>Run docker-compose up</p>
</li>
<li>
<p>Go to your project to set up envrionment.csv</p>
</li>
<li>
<p>The variables we are interested in are MY_THAI_STAR_URL and MY_THAI_STAR_API_URL</p>
</li>
<li>
<p>If you set up My Thai Star application on different host adjust the values accordingly</p>
</li>
<li>
<p>The web aplication should be available using localhost:8081/restaurant</p>
</li>
<li>
<p>The web api should be avaulable using localhost:8081/api</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="tutorials-2"><a class="anchor" href="#tutorials-2"></a>26.24. Tutorials</h3>
<div class="paragraph">
<p>In order to learn more about MrChecker structure, start from Project Organisation section and then check out our fantastic tutorials:</p>
</div>
<div class="paragraph">
<p>This tutorial will guide you through the series of test which perform basic actions on webpages using MrChecker.</p>
</div>
<div class="paragraph">
<p>Make sure you already have MrChecker Test Framework installed on your PC. How to install?</p>
</div>
<div class="paragraph">
<p>Your Product Under Test will be the following website: <a href="http://the-internet.herokuapp.com/" class="bare">http://the-internet.herokuapp.com/</a></p>
</div>
<div class="sect4">
<h5 id="project-organization"><a class="anchor" href="#project-organization"></a>Project organization</h5>

</div>
<div class="sect4">
<h5 id="importing-projects"><a class="anchor" href="#importing-projects"></a>Importing projects</h5>
<div class="paragraph">
<p>Every MrChecker project should be imported as a Maven Project.</p>
</div>
<div class="paragraph">
<p>Example from Eclipse IDE:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/1.png" alt="1">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/2.png" alt="2">
</div>
</div>
<div class="paragraph">
<p>Enter the project path and select projects to import.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/3.png" alt="3">
</div>
</div>
<div class="paragraph">
<p>When the import is finished, update the project structure - ALT + F5</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/4.png" alt="4">
</div>
</div>
</div>
<div class="sect4">
<h5 id="exporting-projects"><a class="anchor" href="#exporting-projects"></a>Exporting projects</h5>
<div class="paragraph">
<p>In order to create a new standalone MrChecker project, you can use template-app-under-test and export it to the new folder:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/5.png" alt="5">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/6.png" alt="6">
</div>
</div>
<div class="paragraph">
<p>Create a new folder for the project and enter its path. Select project and files to export:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/7.png" alt="7">
</div>
</div>
<div class="paragraph">
<p>Change project name and other properties, if necessary, in pom.xml file:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/8.png" alt="8">
</div>
</div>
<div class="paragraph">
<p>Then you can import the project to the workspace and create new packages and classes.</p>
</div>
</div>
<div class="sect4">
<h5 id="creating-new-packages"><a class="anchor" href="#creating-new-packages"></a>Creating new packages</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You will need two new packages: one for the new page classes, the other one for test classes:</p>
<div class="ulist">
<ul>
<li>
<p>Create a package for page classes</p>
<div class="literalblock">
<div class="content">
<pre>Open Eclipse
Use the "Project Explorer" on the left
Navigate to [your-project] → src/main/java → com.capgemini.mrchecker → selenium
Right-click on "selenium"
Click on "New" → New Package
Name the new package "com.capgemini.mrchecker.selenium.pages.[your-product-name]"</pre>
</div>
</div>
</li>
<li>
<p>Create a package for test classes</p>
<div class="literalblock">
<div class="content">
<pre>Navigate to [your-project] → src/test/java → com.capgemini.mrchecker → selenium
Right click on "selenium"
Click on "New" → New Package
Name the new package "com.capgemini.mrchecker.selenium.tests.[your-product-name]"</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/9.png" alt="9">
</div>
</div>
</div>
<div class="sect4">
<h5 id="creating-new-page-classes"><a class="anchor" href="#creating-new-page-classes"></a>Creating new Page Classes</h5>
<div class="literalblock">
<div class="content">
<pre>Navigate to: [your-project] → src/main/java → com.capgemini.mrchecker → selenium.pages.[your-product-name]
Click on "New" → New Class
Enter the name "YourPage"</pre>
</div>
</div>
<div class="paragraph">
<p>Every Page Class should extend BasePage class. Import all necessary packages and override all required methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>public boolean isLoaded() - returns true if the page is loaded and false if not</p>
</li>
<li>
<p>public void load() - loads the page</p>
</li>
<li>
<p>public String pageTitle() - returns page title</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> public class MainPage extends BasePage {

    @Override
    public boolean isLoaded() {
        return false;
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Main Page'");
    }

    @Override
    public String pageTitle() {
        return "Main Page Title";
    }
 }</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="creating-new-test-classes"><a class="anchor" href="#creating-new-test-classes"></a>Creating new Test Classes</h5>
<div class="literalblock">
<div class="content">
<pre>Navigate to  [your-project] → src/test/java → com.capgemini.mrchecker → selenium.tests.[your-product-name]
Click on "New" → New Class
Enter the name "YourCaseTest"</pre>
</div>
</div>
<div class="paragraph">
<p>Test classes should extend BaseTest class, import all necessary packages and override all required methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>public void setUp() - executes before each test</p>
</li>
<li>
<p>public void tearDown() - executes after each test</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Optionally, it is also possible to implement the following methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>@BeforeClass
public static void setUpBeforeClass() - runs only once before all tests</p>
</li>
<li>
<p>@AfterClass
public static void tearDownAfterClass() - runs only once after performing all tests</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Every test method has to be signed with "@Test" parameter.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> public class YourCaseTest extends BaseTest {
    private static MainPage mainPage = new MainPage();

    @BeforeClass
    public static void setUpBeforeClass() {
        mainPage.load();
    }

    @AfterClass
    public static void tearDownAfterClass() {

    }

    @Override
    public void setUp() {
        if (!mainPage.isLoaded()) {
            mainPage.load();
        }
    }

    @Override
    public void tearDown() {

    }

    @Test
    public void shouldTestRunWithoutReturningError {

    }
 }</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running-tests"><a class="anchor" href="#running-tests"></a>Running Tests</h5>
<div class="paragraph">
<p>Run the test by right-clicking on the test method → Run as → JUnit test.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="basic-tutorials"><a class="anchor" href="#basic-tutorials"></a>26.25. Basic Tutorials</h3>

</div>
<div class="sect2">
<h3 id="basic-tests"><a class="anchor" href="#basic-tests"></a>26.26. ==  Basic Tests</h3>
<div class="imageblock">
<div class="content">
<img src="_images/images/example1.png" alt="example1">
</div>
</div>
<div class="paragraph">
<p>The goal of this test is to open A/B Test subpage and redirect to another website.</p>
</div>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Click A/B Testing link and go to A/B Test subpage</p>
</li>
<li>
<p>Click Elemental Selenium link and open it in new tab</p>
</li>
<li>
<p>Switch to Elemental Selenium page and check if it&#8217;s loaded</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example2.png" alt="example2">
</div>
</div>
<div class="sect6">
<h7 id="page-class-2"><a class="anchor" href="#page-class-2"></a>== Page Class</h7>
<div class="paragraph">
<p>Create a Page class for AB Testing page. Override all the required methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> public class ABtestPage extends BasePage {

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.ABTEST.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'A/B Test Control' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.ABTEST.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }
 }</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="how-to-use-enum"><a class="anchor" href="#how-to-use-enum"></a>== How to use Enum?</h7>
<div class="paragraph">
<p>Similarly as in environmental variables case, create an enum for storing values of subURLs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> public enum PageSubURLsProjectYEnum {

    BASIC_AUTH("basic_auth"),
    NEW_WINDOW("windows/new"),
    WINDOW("windows"),
    CHECKBOX("checkboxes"),
    CONTEXT_MENU("context_menu"),
    KEY_PRESS("key_presses"),
    DYNAMIC_CONTENT("dynamic_content"),
    HOVERS("hovers"),
    SORTABLE_DATA_TABLES("tables"),
    REDIRECT("redirector"),
    JAVASCRIPT_ALERTS("javascript_alerts"),
    CHALLENGING_DOM("challenging_dom"),
    STATUS_CODES("status_codes"),
    LOGIN("login"),
    ABTEST("abtest"),
    BROKEN_IMAGES("broken_images"),
    DROPDOWN("dropdown"),
    HORIZONTAL_SLIDER("horizontal_slider"),
    DOWNLOAD("download"),
    FORGOT_PASSWORD("forgot_password"),
    FORGOT_PASSWORD_EMAIL_SENT("email_sent"),
    EXIT_INTENT("exit_intent"),
    DYNAMIC_LOADING("dynamic_loading"),
    DISAPPEARING_ELEMENTS("disappearing_elements"),
    DRAG_AND_DROP("drag_and_drop"),
    DYNAMIC_CONTROLS("dynamic_controls"),
    UPLOAD("upload"),
    FLOATING_MENU("floating_menu"),
    FRAMES("frames"),
    GEOLOCATION("geolocation"),
    INFINITE_SCROLL("infinite_scroll"),
    JQUERY_UI("jqueryui/menu"),
    JAVASCRIPT_ERROR("javascript_error"),
    LARGE_AND_DEEP_DOM("large"),
    NESTED_FRAMES("nested_frames"),
    NOTIFICATION_MESSAGE("notification_message"),
    DOWNLOAD_SECURE("download_secure"),
    SHIFTING_CONTENT("shifting_content"),
    SLOW_RESOURCES("slow"),
    TYPOS("typos"),
    WYSIWYGEDITOR("tinymce");

    /*
     * Sub URLs are used as real locations in the test environment
     */
    private String subURL;

    private PageSubURLsProjectYEnum(String subURL) {
        this.subURL = subURL;
    }

    ;

    private PageSubURLsProjectYEnum() {

    }

    @Override
    public String toString() {
        return getValue();
    }

    public String getValue() {
        return subURL;
    }

}</pre>
</div>
</div>
<div class="paragraph">
<p>Instead of mapping data from an external file, you can store and access them directly from the enum class:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PageSubURLsProjectYEnum.ABTEST.getValue()</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="selector"><a class="anchor" href="#selector"></a>==  Selector</h7>
<div class="paragraph">
<p>In this test case you need selector for only one page element:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>private static final By elementalSeleniumLinkSelector = By.cssSelector("div &gt; div &gt; a");</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="page-methods"><a class="anchor" href="#page-methods"></a>==  Page methods</h7>
<div class="paragraph">
<p>You need two methods for performing page actions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>     /**
     * Clicks 'Elemental Selenium' link at the bottom of the page.
     *
     * @return ElementalSeleniumPage object.
     */
    public ElementalSeleniumPage clickElementalSeleniumLink() {
        getDriver().findElementDynamic(elementalSeleniumLinkSelector)
                .click();
        getDriver().waitForPageLoaded();
        return new ElementalSeleniumPage();
    }

    /**
     * Switches window to the next one - different than the current.
     */
    public void switchToNextTab() {
        ArrayList&lt;String&gt; tabsList = new ArrayList&lt;String&gt;(getDriver().getWindowHandles());
        getDriver().switchTo()
                .window(tabsList.get(1));
    }</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="elemental-selenium-page-class"><a class="anchor" href="#elemental-selenium-page-class"></a>==  Elemental Selenium Page Class</h7>
<div class="paragraph">
<p>To return new Elemental Selenium Page object, implement its class. You only need to write basic methods to check if the page is loaded. There is no need to interact with objects on the site:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> public class ElementalSeleniumPage extends BasePage {

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(GetEnvironmentParam.ELEMENTAL_SELENIUM_PAGE.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Elemental Selenium' page.");
        getDriver().get(GetEnvironmentParam.ELEMENTAL_SELENIUM_PAGE.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="test-class"><a class="anchor" href="#test-class"></a>==  Test Class</h7>
<div class="paragraph">
<p>Create a Test class and write a @Test method to execute the scenario:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> @Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class ABtestingTest extends TheInternetBaseTest {

    private static ABtestPage abTestPage;

    @Test
    public void shouldOpenElementalSeleniumPageWhenClickElementalSeleniumLink() {

        logStep("Click Elemental Selenium link");
        ElementalSeleniumPage elementalSeleniumPage = abTestPage.clickElementalSeleniumLink();

        logStep("Switch browser's tab to newly opened one");
        abTestPage.switchToNextTab();

        logStep("Verify if Elemental Selenium Page is opened");
        assertTrue("Unable to open Elemental Selenium page", elementalSeleniumPage.isLoaded());
    }

}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="assert"><a class="anchor" href="#assert"></a>==  Assert</h7>
<div class="paragraph">
<p>Asserts methods are used for creating test pass or fail conditions. The optional first parameter is a message which will be displayed in the test failure description.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>assertTrue(boolean condition) - test passes if condition returns true</p>
</li>
<li>
<p>assertFalse(boolean condition) - test passes if condition returns false</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also, add the @BeforeClass method to open the tested page:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> @BeforeClass
    public static void setUpBeforeClass() {
        abTestPage = shouldTheInternetPageBeOpened().clickABtestingLink();
        logStep("Verify if ABTest page is opened");
        assertTrue("Unable to open ABTest page", abTestPage.isLoaded());
    }</pre>
</div>
</div>
<div class="paragraph">
<p>@BeforeClass method executes only once before all other
@Test cases in the class. There is also a possibility to create a
@AfterClass method which is performed also once after all @Test cases.</p>
</div>
<div class="paragraph">
<p>You don&#8217;t need to implement @setUp and @tearDown methods because they&#8217;re already in TheInternetBaseTest class which you extend.</p>
</div>
</div>
<div class="sect6">
<h7 id="categories"><a class="anchor" href="#categories"></a>==  Categories</h7>
<div class="paragraph">
<p>You can group tests in categories. It&#8217;s useful when running many tests at once. Use this parameter:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })</pre>
</div>
</div>
<div class="paragraph">
<p>Then create an interface representing each category. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public interface TestsSelenium {
    /* For test which are testing web pages considering UI (user interface) and using selenium webdriver */
}</pre>
</div>
</div>
<div class="paragraph">
<p>To run a test from specified category create Test Suite class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@RunWith(WildcardPatternSuite.class) //search for test files under /src/test/java
@IncludeCategories({ TestsChrome.class }) // search all test files with category TestsChrome.class
@ExcludeCategories({ TestsLocal.class, TestsNONParallel.class }) //exclude all test files with category TestsLocal.class and TestsNONParallel.class
@SuiteClasses({ "../**/*Test.class" }) //search only test files, where file name ends with &lt;anyChar/s&gt;Test.class

public class _TestSuiteChrome {

}</pre>
</div>
</div>
<div class="paragraph">
<p>You can run a Test Suite as a JUnit test.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example3.png" alt="example3">
</div>
</div>
<div class="paragraph">
<p>In this test case, the goal is to pass username and password authorization and login to the next page.</p>
</div>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Click on Basic Auth link</p>
</li>
<li>
<p>Open pop-up login window</p>
</li>
<li>
<p>Enter valid username and password</p>
</li>
<li>
<p>Open next subpage and verify if the user logged in successfully.</p>
</li>
</ol>
</div>
</div>
<div class="sect6">
<h7 id="page-class-3"><a class="anchor" href="#page-class-3"></a>== Page Class</h7>
<div class="paragraph">
<p>Create a page class which represents Basic Auth subpage after proper login.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example4.png" alt="example4">
</div>
</div>
<div class="paragraph">
<p>Override all the required methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class BasicAuthPage extends BasePage {

    public BasicAuthPage() {

    }

    public BasicAuthPage(String login, String password) {
        this.enterLoginAndPasswordByUrl(login, password);
    }

    @Override
    public boolean isLoaded() {
        return true;
    }

    @Override
    public void load() {
        BFLogger.logDebug("load");
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }</pre>
</div>
</div>
<div class="paragraph">
<p>In order to verify a login, create a selector to access the visible message.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> private static final By selectorTextMessage = By.cssSelector("#content &gt; div &gt; p");
Then create a method to get message value:

/**
*       Returns message displayed by system after user's log in.
*      @return String object representing message displayed by system after user's log in
*/
    public String getMessageValue() {
                return getDriver().findElementDynamic(selectorTextMessage)
                    .getText();
}</pre>
</div>
</div>
<div class="paragraph">
<p>Also, create a method to access the pop-up login window and enter user credentials:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    /**
     * Authenticates user using standard simple authentication popup.
     *
     * @param login    User's login
     * @param password User's password
     * @throws AWTException
     * @throws InterruptedException
     */
    public void enterLoginAndPassword(String login, String password) throws AWTException, InterruptedException {
        Robot rb = new Robot();

        Thread.sleep(2000);

        StringSelection username = new StringSelection(login);
        Toolkit.getDefaultToolkit()
                .getSystemClipboard()
                .setContents(username, null);
        rb.keyPress(KeyEvent.VK_CONTROL);
        rb.keyPress(KeyEvent.VK_V);
        rb.keyRelease(KeyEvent.VK_V);
        rb.keyRelease(KeyEvent.VK_CONTROL);

        rb.keyPress(KeyEvent.VK_TAB);
        rb.keyRelease(KeyEvent.VK_TAB);
        Thread.sleep(2000);

        StringSelection pwd = new StringSelection(password);
        Toolkit.getDefaultToolkit()
                .getSystemClipboard()
                .setContents(pwd, null);
        rb.keyPress(KeyEvent.VK_CONTROL);
        rb.keyPress(KeyEvent.VK_V);
        rb.keyRelease(KeyEvent.VK_V);
        rb.keyRelease(KeyEvent.VK_CONTROL);

        rb.keyPress(KeyEvent.VK_ENTER);
        rb.keyRelease(KeyEvent.VK_ENTER);
        Thread.sleep(2000);
    }</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="robot-class"><a class="anchor" href="#robot-class"></a>==  Robot class</h7>
<div class="paragraph">
<p>Creating a Robot object allows performing basic system actions such as pressing keys, moving the mouse or taking screenshots. In this case, it&#8217;s used to paste login and password text from the clipboard using 'Ctrl + V' shortcut, go to the next field using 'Tab' key and submit by clicking 'Enter'.</p>
</div>
</div>
<div class="sect6">
<h7 id="toolkit"><a class="anchor" href="#toolkit"></a>Toolkit</h7>
<div class="paragraph">
<p>Static class Toolkit can perform basic window actions such as scrolling to a specified position or moving context between components. In this case, it&#8217;s used to set clipboard content to username and password value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Thread.sleep(long millis)</pre>
</div>
</div>
<div class="paragraph">
<p>Web drivers like Selenium perform actions much faster than the normal user. This may cause unexpected consequences e.g. some elements may not be loaded before the driver wants to access them. To avoid this problem you can use Thread.sleep(long millis) to wait given time and let browser load wanted component.</p>
</div>
<div class="paragraph">
<p>BEWARE: Using Thread.sleep(long millis) is not the recommended approach. Selenium driver gives methods to wait for a specified element to be enabled or visible with a timeout parameter. This is a more stable and effective way. Also, method waitForPageLoaded() will not solve that issue because it only waits for the ready state from the browser while some javascript actions might be performed after that.</p>
</div>
</div>
<div class="sect6">
<h7 id="test-class-2"><a class="anchor" href="#test-class-2"></a>==  Test Class</h7>
<div class="paragraph">
<p>Create a Test class and write a @Test method to execute the scenario. Save parameters as class fields:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsLocal.class, TestsNONParallel.class })
public class BasicAuthTest extends TheInternetBaseTest {

    private static BasicAuthPage basicAuthPage;

    private String login    = "admin";
    private String password = "admin";
    private String message  = "Congratulations! You must have the proper credentials.";

    @Test
    public void shouldUserLogInWithValidCredentials() throws InterruptedException, AWTException {
        basicAuthPage = shouldTheInternetPageBeOpened().clickBasicAuthLink();

        logStep("Enter login and password");
        basicAuthPage.enterLoginAndPassword(login, password);

        logStep("Verify if user logged in successfully");
        assertEquals("Unable to login user with valid credentials", message,
            basicAuthPage.getMessageValue());
    }

    @Override
    public void tearDown() {
        logStep("Navigate back to The-Internet page");
        theInternetPage.load();
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>assertEquals(Object expected, Object actual) - test passes if parameters are equal .</p>
</div>
</div>
<div class="sect6">
<h7 id="alternative-scenario"><a class="anchor" href="#alternative-scenario"></a>== Alternative scenario:</h7>
<div class="paragraph">
<p>There is also a possibility to log in with credentials as a part of URL: <a href="http://login:password@the-internet.herokuapp.com/basic_auth" class="bare">http://login:password@the-internet.herokuapp.com/basic_auth</a></p>
</div>
<div class="paragraph">
<p>Another page class method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/**
     * Authenticates user passing credentials into URL.
     *
     * @param login    User's login
     * @param password User's password
     */
    private void enterLoginAndPasswordByUrl(String login, String password) {
        getDriver().get("http://" + login + ":" + password + "@" + "the-internet.herokuapp.com/" +
            PageSubURLsProjectYEnum.BASIC_AUTH.getValue());
    }</pre>
</div>
</div>
<div class="paragraph">
<p>Another test class method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@Test
    public void shouldUserLogInWithValidCredentialsSetInURL() {
        logStep("Enter user's credentials into URL to log in");
        basicAuthPage = new BasicAuthPage(login, password);

        logStep("Verify if user logged in successfully");
        assertEquals("Unable to login user with valid credentials", message,
            basicAuthPage.getMessageValue());
    }</pre>
</div>
</div>
<div class="paragraph">
<p>After running test class as a JUnit test, both test cases will be performed.</p>
</div>
<div class="paragraph">
<p>This test goal is to check the dimensions of broken images on the subpage.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example5.png" alt="example5">
</div>
</div>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Click Broken Image link and go to Broken Image subpage</p>
</li>
<li>
<p>Get the 3 images' dimensions and compare them with expected values</p>
</li>
</ol>
</div>
</div>
<div class="sect6">
<h7 id="page-class-4"><a class="anchor" href="#page-class-4"></a>==  Page Class</h7>
<div class="paragraph">
<p>In this case, create an array of selectors to access images by index number:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class BrokenImagePage extends BasePage {

    private static final By[] selectorsImages = { By.cssSelector("div &gt; img:nth-child(2)"),
            By.cssSelector("div &gt; img:nth-child(3)"),
            By.cssSelector("div &gt; img:nth-child(4)") };

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.BROKEN_IMAGES.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Broken Images' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.BROKEN_IMAGES.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Returns an image height in pixels.
     *
     * @param imageIndex An index of given image.
     * @return Height of an image in pixels.
     */
    public int getImageHeight(int imageIndex) {
        return getImageDimension(imageIndex).getHeight();
    }

    /**
     * Returns an image width in pixels.
     *
     * @param imageIndex An index of given image.
     * @return Width of an image in pixels.
     */
    public int getImageWidth(int imageIndex) {
        return getImageDimension(imageIndex).getWidth();
    }

    private Dimension getImageDimension(int imageIndex) {
        return getDriver().findElementDynamic(selectorsImages[imageIndex])
                .getSize();
    }

}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="test-class-3"><a class="anchor" href="#test-class-3"></a>==  Test Class</h7>
<div class="paragraph">
<p>Create @Test and @BeforeClass methods. Save expected images' dimensions in class fields:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class BrokenImagesTest extends TheInternetBaseTest {

    private static BrokenImagePage brokenImagePage;

    private final int expectedHeight = 90;
    private final int expectedWidth  = 120;

    @BeforeClass
    public static void setUpBeforeClass() {
        brokenImagePage = shouldTheInternetPageBeOpened().clickBrokenImageLink();

        logStep("Verify if Broken Image page is opened");
        assertTrue("Unable to open Broken Image page", brokenImagePage.isLoaded());
    }

    @Test
    public void shouldImageSizesBeEqualToExpected() {
        for (int i = 0; i &lt; 3; i++) {
            logStep("Verify size of image with index: " + i);
            assertEquals("Height of image with index: " + i + " is incorrect", expectedHeight,
                   brokenImagePage.getImageHeight(i));
            assertEquals("Width of image with index: " + i + " is incorrect", expectedWidth,
                   brokenImagePage.getImageWidth(i));
        }
    }

}</pre>
</div>
</div>
<div class="paragraph">
<p>The test will pass if every image had the correct width and height.</p>
</div>
<div class="paragraph">
<p>This case goal is to find out how to create stable selectors.</p>
</div>
<div class="paragraph">
<p>In the browser&#8217;s developer mode, you can see how the page is built. Notice, that buttons' IDs change after click and values in the table haven&#8217;t got unique attributes, which might be helpful in order to find them.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example6.png" alt="example6">
</div>
</div>
</div>
<div class="sect6">
<h7 id="dom-document-object-model"><a class="anchor" href="#dom-document-object-model"></a>== DOM - Document Object Model</h7>
<div class="paragraph">
<p>HTML DOM is a model of the page created by the browser. The page could be represented as the tree of objects. Read more.</p>
</div>
<div class="paragraph">
<p>To create locators you can use element attributes such as id, class name etc.</p>
</div>
<div class="paragraph">
<p>It this case, since there are no unique attributes, the best approach is to use HTML document structure and identify page elements by their place in an object hierarchy.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Page Class
public class ChallengingDomPage extends BasePage {

    private final By selectorTableRows   = By.cssSelector(".large-10 &gt; table &gt; tbody &gt; tr");
    private final By selectorFirstButton = By.cssSelector(".large-2.columns &gt; .button:nth-
            child(1)");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.CHALLENGING_DOM.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Challenging DOM' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.CHALLENGING_DOM.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Returns table text content as a list of String objects.
     *
     * @return A list of table values.
     */
    public List&lt;String&gt; getTableValues() {
        return JsoupHelper.findTexts(selectorTableRows);
    }

    /**
     * Clicks top button on the page from available button set.
     */
    public void clickFirstButton() {
        getDriver().elementButton(selectorFirstButton)
                .click();
        getDriver().waitForPageLoaded();
    }

}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="jsoup-helper"><a class="anchor" href="#jsoup-helper"></a>== Jsoup Helper</h7>
<div class="paragraph">
<p>Jsoup Helper is the tool which helps to parse HTML document and get searched values. This is especially useful when values are organized in a generic structure such as a table.</p>
</div>
<div class="paragraph">
<p>JsoupHelper.findTexts(By selector) - this method returns text content of a table as a list of Strings</p>
</div>
</div>
<div class="sect6">
<h7 id="test-class-4"><a class="anchor" href="#test-class-4"></a>== Test Class</h7>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Click Challenging DOM link and go to Challenging DOM subpage</p>
</li>
<li>
<p>Get and save table values</p>
</li>
<li>
<p>Click the first button</p>
</li>
<li>
<p>Get table values again</p>
</li>
<li>
<p>Compare table values before and after button click</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class ChallengingDomTest extends TheInternetBaseTest {

    private static ChallengingDomPage challengingDomPage;

    @BeforeClass
    public static void setUpBeforeClass() {
        challengingDomPage = shouldTheInternetPageBeOpened().clickChallengingDomLink();

        logStep("Verify if Challenging Dom page is opened");
        assertTrue("Unable to open Challenging Dom page", challengingDomPage.isLoaded());
    }

    @Test
    public void shouldValuesInTableCellsStayUnchangedAfterClick() {

        logStep("Get table values (before click any button)");
        List&lt;String&gt; tableValuesBeforeClick = challengingDomPage.getTableValues();

        logStep("Click first button");
        challengingDomPage.clickFirstButton();

        logStep("Get table values (after click first button)");
        List&lt;String&gt; tableValuesAfterClick = challengingDomPage.getTableValues();

        logStep("Verify equality of table values before and after click");
        assertEquals("Values from table cells were changed after click", tableValuesBeforeClick,
                tableValuesAfterClick);
    }

}</pre>
</div>
</div>
<div class="paragraph">
<p>Because values in the table don&#8217;t change, the test should pass if object locators are solid.</p>
</div>
<div class="paragraph">
<p>In this example, you will learn how to test checkboxes on the page.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example7.png" alt="example7">
</div>
</div>
<div class="paragraph">
<p>A checkbox is a simple web element which can be selected or unselected by clicking on it.</p>
</div>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Click Checkboxes link and go to Checkboxes page</p>
</li>
<li>
<p>Test if the first checkbox is unchecked</p>
</li>
<li>
<p>Select the first checkbox</p>
</li>
<li>
<p>Test if the first checkbox is checked</p>
</li>
<li>
<p>Test if the second checkbox is checked</p>
</li>
<li>
<p>Unselect second checkbox</p>
</li>
<li>
<p>Test if the second checkbox is unchecked</p>
</li>
</ol>
</div>
</div>
<div class="sect6">
<h7 id="page-class-5"><a class="anchor" href="#page-class-5"></a>== Page Class</h7>
<div class="paragraph">
<p>Because both checkboxes are in one form, it&#8217;s possible to locate them by one selector and then access each individual one by index.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example8.png" alt="example8">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>public class CheckboxesPage extends BasePage {

    private final static By checkboxesFormSelector = By.cssSelector("#checkboxes");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.CHECKBOX.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Checkboxes' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.CHECKBOX.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Verifies if checkbox form is visible on the page.
     *
     * @return true if checkboxes are present and displayed on the page
     */
    public boolean isElementCheckboxesFormVisible() {
        return getDriver().elementCheckbox(checkboxesFormSelector)
                .isDisplayed();
    }

    /**
     * Verifies if given checkbox is selected or not.
     *
     * @param index The index of given checkbox
     * @return true if given checkbox is selected
     */
    public boolean isCheckboxSelected(int index) {
        return getDriver().elementCheckbox(checkboxesFormSelector)
                .isCheckBoxSetByIndex(index);
    }

    /**
     * Selects given checkbox. Unselects, if it is already selected.
     *
     * @param index The index of given checkbox
     */
    public void selectCheckbox(int index) {
        CheckBox checkbox = getDriver().elementCheckbox(checkboxesFormSelector);
        if (isCheckboxSelected(index)) {
            checkbox.unsetCheckBoxByIndex(index);
        } else {
            checkbox.setCheckBoxByIndex(index);
        }
    }

}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="checkbox"><a class="anchor" href="#checkbox"></a>== CheckBox</h7>
<div class="paragraph">
<p>CheckBox class contains a method to perform actions on checkboxes such as setting and unsetting or verifying if the specified box is checked.
Use method elementCheckbox(By selector) to create CheckBox Object.</p>
</div>
</div>
<div class="sect6">
<h7 id="test-class-5"><a class="anchor" href="#test-class-5"></a>== Test Class</h7>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class CheckboxesTest extends TheInternetBaseTest {

    private static CheckboxesPage checkboxesPage;

    @Override
    public void setUp() {
        checkboxesPage = shouldTheInternetPageBeOpened().clickCheckboxesLink();

        logStep("Verify if Checkboxes page is opened");
        assertTrue("Unable to open Checkboxes page", checkboxesPage.isLoaded());
    }

    @Test
    public void shouldCheckboxBeSelectedAfterClick() {

        logStep("Verify if first checkbox is not selected");
        assertFalse("The checkbox is selected", checkboxesPage.isCheckboxSelected(0));

        logStep("Select first checkbox");
        checkboxesPage.selectCheckbox(0);

        logStep("Verify if first checkbox is selected");
        assertTrue("The checkbox is not selected", checkboxesPage.isCheckboxSelected(0));
    }

    @Test
    public void shouldCheckboxBeUnselectedAfterClick() {

        logStep("Verify if second checkbox is selected");
        assertTrue("The checkbox is not selected", checkboxesPage.isCheckboxSelected(1));

        logStep("Select second checkbox");
        checkboxesPage.selectCheckbox(1);

        logStep("Verify if second checkbox is not selected");
        assertFalse("The checkbox is selected", checkboxesPage.isCheckboxSelected(1));
    }

}</pre>
</div>
</div>
<div class="paragraph">
<p>After running Test Class both @Test cases will be performed. Before each one, overrode setUp method will be executed.</p>
</div>
<div class="paragraph">
<p>This case will show how to test changing website content.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example9.png" alt="example9">
</div>
</div>
<div class="paragraph">
<p>After refreshing page (F5) a few times, a new element should appear:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example10.png" alt="example10">
</div>
</div>
<div class="paragraph">
<p>Then, after another couple of refreshes, it should disappear.</p>
</div>
<div class="paragraph">
<p>You can check in developer mode that Gallery element does not exist in HTML document either, until appearing on the page. The element is created by Javascript.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example11.png" alt="example11">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example12.png" alt="example12">
</div>
</div>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Load The Internet Main Page</p>
</li>
<li>
<p>Click Disappearing Elements link and go to that subpage</p>
</li>
<li>
<p>Check if Menu Buttons exist on the page</p>
</li>
<li>
<p>Refresh the page until a new element appears</p>
</li>
<li>
<p>Check if Gallery Button exists</p>
</li>
<li>
<p>Check if the number of buttons equals the expected value</p>
</li>
<li>
<p>Refresh the page until an element disappears</p>
</li>
<li>
<p>Check if Gallery Button does not exist</p>
</li>
<li>
<p>Check if the number of buttons is smaller than before</p>
</li>
</ol>
</div>
</div>
<div class="sect6">
<h7 id="page-class-6"><a class="anchor" href="#page-class-6"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class DisappearingElementsPage extends BasePage {

    private static final By selectorGalleryMenuButton = By.cssSelector("li &gt; a[href*=gallery]");
    private static final By selectorMenuButtons       = By.cssSelector("li");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.DISAPPEARING_ELEMENTS.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Disappearing Elements' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.DISAPPEARING_ELEMENTS.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Returns a number of WebElements representing menu buttons.
     *
     * @return A number of WebElements.
     */
    public int getNumberOfMenuButtons() {
        return getDriver().findElementDynamics(selectorMenuButtons)
                .size();
    }

    /**
     * Returns WebElement representing disappearing element of menu.
     *
     * @return Disappearing WebElement if visible, null otherwise.
     */
    public WebElement getGalleryMenuElement() {
        return getDriver().findElementQuietly(selectorGalleryMenuButton);
    }

    /**
     * Refreshes web page as many times as it is required to appear/disappear menu button
     * WebElement.
     *
     * @param shouldAppear Determines if element should appear (true) or disappear (false).
     */
    public void refreshPageUntilWebElementAppears(boolean shouldAppear) {
        int numberOfAttempts = 5;
        int counter = 0;
        while (!isVisibilityAsExpected(shouldAppear) || isMaxNumberOfAttemptsReached(counter++,
                numberOfAttempts)) {
            refreshPage();
        }
    }

    /**
     * Verify if visibility of Gallery button is the same as expected
     *
     * @param expected Determines if element should be visible (true) or not visible (false).
     */
    private boolean isVisibilityAsExpected(boolean expected) {
        boolean isVisibilityDifferentThanExpected = isGalleryMenuElementVisible() ^ expected;
        return !isVisibilityDifferentThanExpected;
    }

    private boolean isGalleryMenuElementVisible() {
        boolean result = false;
        WebElement gallery = getGalleryMenuElement();
        if (gallery != null)
            result = gallery.isDisplayed();
        return result;
    }

    private boolean isMaxNumberOfAttemptsReached(int attemptNo, int maxNumberOfAttempts) {
        return attemptNo ==  maxNumberOfAttempts;
    }

}</pre>
</div>
</div>
<div class="paragraph">
<p>findElementQuietly(By selector) works similar as findElementDynamics(By selector) but won&#8217;t throw an exception if an element wasn&#8217;t found. In this case, the searched WebElement will have a NULL value.</p>
</div>
</div>
<div class="sect6">
<h7 id="test-class-6"><a class="anchor" href="#test-class-6"></a>== Test Class</h7>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class DisappearingElementsTest extends TheInternetBaseTest {

    private static final int totalNumberOfMenuButtons = 5;
    private static DisappearingElementsPage disappearingElementsPage;
    private static       int numberOfMenuButtons      = 0;

    @BeforeClass
    public static void setUpBeforeClass() {
        disappearingElementsPage = shouldTheInternetPageBeOpened().clickDisappearingElementsLink();

        logStep("Verify if Disappearing Elements page is opened");
        assertTrue("Unable to open Disappearing Elements page",
                disappearingElementsPage.isLoaded());

        logStep("Verify if menu button elements are visible");
        numberOfMenuButtons = disappearingElementsPage.getNumberOfMenuButtons();
        assertTrue("Unable to display menu", numberOfMenuButtons &gt; 0);
    }

    @Test
    public void shouldMenuButtonElementAppearAndDisappearAfterRefreshTest() {
        logStep("Click refresh button until menu button appears");
        disappearingElementsPage.refreshPageUntilWebElementAppears(true);

        logStep("Verify if menu button element appeared");
        assertNotNull("Unable to disappear menu button element",
                disappearingElementsPage.getGalleryMenuElement());
        assertEquals("The number of button elements after refresh is incorrect",
                totalNumberOfMenuButtons, disappearingElementsPage.getNumberOfMenuButtons());

        logStep("Click refresh button until menu button disappears");
        disappearingElementsPage.refreshPageUntilWebElementAppears(false);

        logStep("Verify if menu button element disappeared");
        assertNull("Unable to appear menu button element",
                disappearingElementsPage.getGalleryMenuElement());
        assertTrue("The number of button elements after refresh is incorrect",
                totalNumberOfMenuButtons &gt; disappearingElementsPage.getNumberOfMenuButtons());
    }

}</pre>
</div>
</div>
<div class="paragraph">
<p>assertNull(Objetc object) - test passes if Object returns NULL
assertNotNull(Objetc object) - test passes if Object does not return NULL</p>
</div>
<div class="paragraph">
<p>This case shows how to move draggable elements on the page.
image::images/example13.png[]</p>
</div>
<div class="paragraph">
<p>Try to move A to B position and see what happens. Also, open browser developer mode and see how the DOM changes.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example14.png" alt="example14">
</div>
</div>
<div class="paragraph">
<p>The page can easily be broken. You can try to do so and check how the page structure changed in browser developer mode.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example15.png" alt="example15">
</div>
</div>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Click Drag and Drop link and open subpage</p>
</li>
<li>
<p>Check if the Drag and Drop message is visible</p>
</li>
<li>
<p>Check if element A is in container A and B in container B</p>
</li>
<li>
<p>Move element A to position B</p>
</li>
<li>
<p>Check if element A is in container B and B in container A</p>
</li>
<li>
<p>Move element B to position A</p>
</li>
<li>
<p>Again check if element A is in container A and B in container B</p>
</li>
</ol>
</div>
</div>
<div class="sect6">
<h7 id="page-class-7"><a class="anchor" href="#page-class-7"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class DragAndDropPage extends BasePage {

    private static final By selectorDragAndDropText    = By.cssSelector("div#content h3");
    private static final By selectorAElementContainer  = By.cssSelector("div#column-a");
    private static final By selectorBElementContainer  = By.cssSelector("div#column-b");
    private static final By selectorDescriptionElement = By.cssSelector("header");

    private static final String dndHelperPath = "src/test/resources/js/drag_and_drop_helper.js";

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.DRAG_AND_DROP.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Drag and Drop' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() + PageSubURLsProjectYEnum.DRAG_AND_DROP.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Returns information if drag and drop message is visible or not.
     *
     * @return true if exit drag and drop message was found on web page.
     */
    public boolean isDragAndDropMessageVisible() {
        return getDriver().findElementDynamic(selectorDragAndDropText)
                .isDisplayed();
    }

    /**
     * Verifies if specified element is placed in designated container.
     *
     * @param element WebElement to be verified.
     * @return true if element described as A exists in container A or element B exists in container B, false otherwise.
     */
    public boolean isElementPlacedInCorrectContainer(String element) {
        return getDescriptionElement(findElementByDescription(element)).getText()
                .equals(element);
    }

    private WebElement findElementByDescription(String element) {
        WebElement result;
        switch (element) {
            case "A":
                result = getContainerElement(selectorAElementContainer);
                break;
            case "B":
                result = getContainerElement(selectorBElementContainer);
                break;
            default:
                result = null;
                BFLogger.logDebug("Chosen element doesn't exist on web page");
        }
        return result;
    }

    private WebElement getContainerElement(By container) {
        return getDriver().findElementDynamic(container);
    }

    private WebElement getDescriptionElement(WebElement container) {
        return container.findElement(selectorDescriptionElement);
    }

    /**
     * Drags element to designated container and drops it.
     *
     * @param element         String describing WebElement expected to be dragged.
     * @param from            String describing WebElement representing container of element expected to be dragged.
     * @param destinationDesc String describing WebElement representing destination container where other element will be dragged.
     */
    public void dragElementToPosition(String element, String from, String destinationDesc) {
        WebElement source = findElementByDescription(from);
        WebElement description = getDescriptionElement(source);
        WebElement destination = findElementByDescription(destinationDesc);
        if (description.getText()
                .equals(element))
            dragElement(source, destination);
    }

}</pre>
</div>
</div>
<div class="paragraph">
<p>Since HTML5, normal Selenium drag-and-drop action stopped working, thus it&#8217;s necessary to execute Javascript which performs the drag-and-drop. To do so, create a JavascriptExecutor object, then read the script from a file drag_and_drop_helper.js and execute it with additional arguments using method executeScript(String script).</p>
</div>
<div class="paragraph">
<p>An example drag-and-drop solution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    /**
     * Drags and drops given WebElement to it's destination location.
     * &lt;p&gt;
     * Since HTML5 all Selenium Actions performing drag and drop operations stopped working as expected, e.g.
     * original implementation, which was:
     * &lt;code&gt;
     * BasePage.getAction()
     * .clickAndHold(draggable)
     * .moveToElement(target)
     * .release()
     * .build()
     * .perform();
     * &lt;/code&gt;
     * finishes with no effect. For this reason, there is javaScript function used, to make sure that
     * drag and drop operation will be successful.
     * JavaScript function is stored under the following path: 'src/test/resources/js/drag_and_drop_helper.js'.
     * Original source of the script:
     * &lt;a href="https://gist.github.com/rcorreia/2362544"&gt;drag_and_drop_helper&lt;/a&gt;
     * &lt;/p&gt;
     *
     * @param draggable A WebElement to be dragged and dropped.
     * @param target    A destination, where element will be dropped.
     * @see JavascriptExecutor
     * @see Actions
     */
    private void dragElement(WebElement draggable, WebElement target) {
        JavascriptExecutor js;
        INewWebDriver driver = getDriver();
        List&lt;String&gt; fileContent;
        String draggableId = draggable.getAttribute("id");
        String targetId = target.getAttribute("id");
        String script = null;
        if (draggable.getAttribute("draggable")
                .contains("true")) {
            if (driver instanceof JavascriptExecutor) {
                js = (JavascriptExecutor) driver;
                Path path = Paths.get(dndHelperPath);
                try {
                    fileContent = Files.readAllLines(path);
                    script = fileContent.stream()
                            .collect(Collectors.joining());
                } catch (IOException e) {
                    BFLogger.logDebug("Unable to read file content: " + e.getMessage());
                }
                if (script != null &amp;&amp; !script.isEmpty()) {
                    String arguments = "$('#%s').simulateDragDrop({ dropTarget: '#%s'});";
                    js.executeScript(script + String.format(arguments, draggableId, targetId));
                }
            }
        }
    }</pre>
</div>
</div>
<div class="paragraph">
<p>Drag and Drop helper file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>(function( $ ) {
        $.fn.simulateDragDrop = function(options) {
                return this.each(function() {
                        new $.simulateDragDrop(this, options);
                });
        };
        $.simulateDragDrop = function(elem, options) {
                this.options = options;
                this.simulateEvent(elem, options);
        };
        $.extend($.simulateDragDrop.prototype, {
                simulateEvent: function(elem, options) {
                        /*Simulating drag start*/
                        var type = 'dragstart';
                        var event = this.createEvent(type);
                        this.dispatchEvent(elem, type, event);

                        /*Simulating drop*/
                        type = 'drop';
                        var dropEvent = this.createEvent(type, {});
                        dropEvent.dataTransfer = event.dataTransfer;
                        this.dispatchEvent($(options.dropTarget)[0], type, dropEvent);

                        /*Simulating drag end*/
                        type = 'dragend';
                        var dragEndEvent = this.createEvent(type, {});
                        dragEndEvent.dataTransfer = event.dataTransfer;
                        this.dispatchEvent(elem, type, dragEndEvent);
                },
                createEvent: function(type) {
                        var event = document.createEvent("CustomEvent");
                        event.initCustomEvent(type, true, true, null);
                        event.dataTransfer = {
                                data: {
                                },
                                setData: function(type, val){
                                        this.data[type] = val;
                                },
                                getData: function(type){
                                        return this.data[type];
                                }
                        };
                        return event;
                },
                dispatchEvent: function(elem, type, event) {
                        if(elem.dispatchEvent) {
                                elem.dispatchEvent(event);
                        }else if( elem.fireEvent ) {
                                elem.fireEvent("on"+type, event);
                        }
                }
        });
})(jQuery);</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="test-class-7"><a class="anchor" href="#test-class-7"></a>== Test Class</h7>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class DragAndDropTest extends TheInternetBaseTest {

    private static final String ELEMENT_A   = "A";
    private static final String CONTAINER_A = "A";
    private static final String ELEMENT_B   = "B";
    private static final String CONTAINER_B = "B";

    private static DragAndDropPage dragAndDropPage;

    @BeforeClass
    public static void setUpBeforeClass() {
        dragAndDropPage = shouldTheInternetPageBeOpened().clickDragAndDropLink();

        logStep("Verify if Drag And Drop page is opened");
        assertTrue("Unable to open Drag And Drop page", dragAndDropPage.isLoaded());

        logStep("Verify if Drag And Drop message is visible");
        assertTrue("Drag And Drop message is not visible", dragAndDropPage.isDragAndDropMessageVisible());
    }

    @Test
    public void shouldDraggableElementBeMovedAndDropped() {
        logStep("Verify if elements are placed in proper containers");
        assertTrue("Element A doesn't exist in container A", dragAndDropPage.isElementPlacedInCorrectContainer(ELEMENT_A));
        assertTrue("Element B doesn't exist in container B", dragAndDropPage.isElementPlacedInCorrectContainer(ELEMENT_B));

        logStep("Step 7: Drag and drop element A into container B");
        dragAndDropPage.dragElementToPosition(ELEMENT_A, CONTAINER_A, CONTAINER_B);

        logStep("Step 8: Verify if elements are placed in improper containers");
        assertFalse("Element A doesn't exist in container B", dragAndDropPage.isElementPlacedInCorrectContainer(ELEMENT_A));
        assertFalse("Element B doesn't exist in container A", dragAndDropPage.isElementPlacedInCorrectContainer(ELEMENT_B));

        logStep("Drag and drop element B back into container B");
        dragAndDropPage.dragElementToPosition(ELEMENT_A, CONTAINER_B, CONTAINER_A);

        logStep("Verify if elements are placed in proper containers");
        assertTrue("Element A doesn't exist in container A", dragAndDropPage.isElementPlacedInCorrectContainer(ELEMENT_A));
        assertTrue("Element B doesn't exist in container B", dragAndDropPage.isElementPlacedInCorrectContainer(ELEMENT_B));
    }

}</pre>
</div>
</div>
<div class="paragraph">
<p>This example shows how to select an element from the dropdown list.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example16.png" alt="example16">
</div>
</div>
<div class="paragraph">
<p>Check in the developer mode how a Dropdown List&#8217;s content has been organized.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example17.png" alt="example17">
</div>
</div>
<div class="paragraph">
<p>Notice that the Dropdown Options have different attributes, such as "disabled" or "selected".</p>
</div>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Click the Dropdown link and go to the subpage</p>
</li>
<li>
<p>Select first dropdown Option</p>
</li>
<li>
<p>Check if Option 1 is selected</p>
</li>
<li>
<p>Select second dropdown Option</p>
</li>
<li>
<p>Check if Option 2 is selected</p>
</li>
</ol>
</div>
</div>
<div class="sect6">
<h7 id="page-class-8"><a class="anchor" href="#page-class-8"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class DropdownPage extends BasePage {

    private static final By dropdownListSelector = By.cssSelector("#dropdown");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.DROPDOWN.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Dropdown List' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.DROPDOWN.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Selects doropdown's value by given index.
     *
     * @param index Index of option to be selected
     */
    public void selectDropdownValueByIndex(int index) {
        getDriver().elementDropdownList(dropdownListSelector)
                .selectDropdownByIndex(index);
    }

    /**
     * Returns text value of first selected dropdown's option.
     *
     * @return String object representing value of dropdown's option
     */
    public String getSelectedDropdownValue() {
        return getDriver().elementDropdownList(dropdownListSelector)
                .getFirstSelectedOptionText();
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="dropdownlistelement-class"><a class="anchor" href="#dropdownlistelement-class"></a>== DropdownListElement class</h7>
<div class="paragraph">
<p>DropdownListElement is MrChecker&#8217;s class, which contains methods for performing the dropdown list of actions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>elementDropdownList() - returns DropdownListElement Object</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="test-class-8"><a class="anchor" href="#test-class-8"></a>== Test Class</h7>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class DropdownTest extends TheInternetBaseTest {

    private static final String expectedFirstOptionValue  = "Option 1";
    private static final String expectedSecondOptionValue = "Option 2";
    private static DropdownPage dropdownPage;

    @BeforeClass
    public static void setUpBeforeClass() {
        dropdownPage = shouldTheInternetPageBeOpened().clickDropdownLink();

        logStep("Verify if Dropdown page is opened");
        assertTrue("Unable to open Dropdown page", dropdownPage.isLoaded());
    }

    @Test
    public void shouldGetExpectedDropdownTextOptionAfterSelection() {

        logStep("Select first drodown option");
        dropdownPage.selectDropdownValueByIndex(1);

        logStep("Verify if selected option text is equal to the expected one");
        assertEquals("Selected value is different than expected", expectedFirstOptionValue,
                dropdownPage.getSelectedDropdownValue());

        logStep("Select first drodown option");
        dropdownPage.selectDropdownValueByIndex(2);

        logStep("Verify if selected option text is equal to the expected one");
        assertEquals("Selected value is different than expected", expectedSecondOptionValue,
                dropdownPage.getSelectedDropdownValue());
    }

}</pre>
</div>
</div>
<div class="paragraph">
<p>This case shows how to compare dynamic content.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example18.png" alt="example18">
</div>
</div>
<div class="paragraph">
<p>Note that after site refresh, some of the content is different. You can see in the browser&#8217;s developer mode how the text and image sources are being changed.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example19.png" alt="example19">
</div>
</div>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Click Dynamic Content link and load subpage</p>
</li>
<li>
<p>Save page images sources and descriptions before the refresh</p>
</li>
<li>
<p>Refresh page</p>
</li>
<li>
<p>Save page images sources and it&#8217;s descriptions after refresh</p>
</li>
<li>
<p>Compare page content before and after refresh and verify if it&#8217;s different</p>
</li>
</ol>
</div>
</div>
<div class="sect6">
<h7 id="page-class-9"><a class="anchor" href="#page-class-9"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class DynamicContentPage extends BasePage {

    private static final By imagesLinksSelector        = By.cssSelector("div#content &gt; div.row img");
    private static final By imagesDescriptionsSelector = By.cssSelector("div#content &gt; div.row div.large-10");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.DYNAMIC_CONTENT.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Dynamic Content' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.DYNAMIC_CONTENT.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Returns list of picture descriptions being present on the web page.
     *
     * @return List of String objects representing descriptions
     */
    public List&lt;String&gt; getDescriptions() {
        return new ListElements(imagesDescriptionsSelector).getTextList();
    }

    /**
     * Returns a list of image links being present on the web page.
     *
     * @return List of String objects representing paths to pictures
     */
    public List&lt;String&gt; getImageLinks() {
        return new ListElements(imagesLinksSelector)
                .getList()
                .stream()
                .map(element -&gt; element.getAttribute("src"))
                .collect(Collectors.toList());
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="listelements"><a class="anchor" href="#listelements"></a>== ListElements</h7>
<div class="paragraph">
<p>ListElements is MrChecker collection which can store WebElement Objects. Constructing ListElements with cssSelector allows you to store every element on the page which fits  the selector. Example methods:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>getList() -  returns WebElements list,
getTextList() - returns list of contents of each Element,
getSize() - returns number of stored Elements
In getImageLinks() example it's shown how to get a list of specified Elements' attributes.</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="test-class-9"><a class="anchor" href="#test-class-9"></a>== Test Class</h7>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class DynamicContentTest extends TheInternetBaseTest {

    private static DynamicContentPage dynamicContentPage;

    @BeforeClass
    public static void setUpBeforeClass() {
        dynamicContentPage = shouldTheInternetPageBeOpened().clickDynamicContentLink();

        logStep("Verify if Dynamic Content page is opened");
        assertTrue("Unable to open Dynamic Content page", dynamicContentPage.isLoaded());
    }

    @Test
    public void shouldImagesAndDescriptionsDifferAfterRefresh() {

        logStep("Read images and descriptions before refresh");
        List&lt;String&gt; descriptionsBeforeRefresh = dynamicContentPage.getDescriptions();
        List&lt;String&gt; imagesBeforeRefresh = dynamicContentPage.getImageLinks();

        logStep("Refres page");
        dynamicContentPage.refreshPage();
        assertTrue("The Dynamic Content page hasn't been refreshed", dynamicContentPage.isLoaded());

        logStep("Read images and descriptions after refresh");
        List&lt;String&gt; descriptionsAfterRefresh = dynamicContentPage.getDescriptions();
        List&lt;String&gt; imagesAfterRefresh = dynamicContentPage.getImageLinks();

        logStep("Verify if descriptions are different after refresh");
        assertEquals("Different number of descriptions before and after refresh",
                descriptionsAfterRefresh.size(), descriptionsBeforeRefresh.size());

        boolean diversity = false;
        for (int i = 0; i &lt; descriptionsAfterRefresh.size(); i++) {
            if (!descriptionsAfterRefresh.get(i)
                    .equals(descriptionsBeforeRefresh.get(i))) {
                diversity = true;
                break;
            }
        }
        assertTrue("There are no differences between descriptions before and after refresh",
                diversity);

        logStep("Verify if images are different after refresh");
        assertEquals("Different number of descriptions before and after refresh",
                imagesAfterRefresh.size(), imagesBeforeRefresh.size());

        diversity = false;
        for (int i = 0; i &lt; imagesAfterRefresh.size(); i++) {
            if (!imagesAfterRefresh.get(i)
                    .equals(imagesBeforeRefresh.get(i))) {
                diversity = true;
                break;
            }
        }
        assertTrue("There are no differences between images before and after refresh", diversity);
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>In the test method, during differences verification, the goal is to compare every element from the first and second list and find first diversity.</p>
</div>
<div class="paragraph">
<p>This example shows how to test a page with dynamically loading content. Some elements don&#8217;t load during page loading, but  during JavaScript execution.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example23.png" alt="example23">
</div>
</div>
<div class="paragraph">
<p>Go to Example 1:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example24.png" alt="example24">
</div>
</div>
<div class="paragraph">
<p>Click "start" and see what happens:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example25.png" alt="example25">
</div>
</div>
<div class="paragraph">
<p>When loading ends, you should see the following message:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example26.png" alt="example26">
</div>
</div>
<div class="paragraph">
<p>In the developer mode, you can see that the element with the "Hello World!" message exists in page DOM but it&#8217;s not displayed. However, the loading bar does not exist there - it&#8217;s created by JavaScript. The script is also visible in developer mode:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example27.png" alt="example27">
</div>
</div>
<div class="paragraph">
<p>After clicking the "Start" button, the element "Loading" is created by the script, and the "Start" button becomes invisible. When loading ends, "Hello World" message is  displayed and the loading bar is hidden. Follow the changes the in developer mode:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example28.png" alt="example28">
</div>
</div>
<div class="paragraph">
<p>Go to example 2:
From a user perspective, there is no difference in page functioning. However, in this case the element with the "Hello World!" message does not exist on the page before clicking "Start". It&#8217;s created by the script.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example29.png" alt="example29">
</div>
</div>
<div class="paragraph">
<p>After clicking "Start", the element with the loading bar is been created.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example30.png" alt="example30">
</div>
</div>
<div class="paragraph">
<p>After a certain time, the loading bar becomes invisible, and then the script creates "Hello World!" element and displays it.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example31.png" alt="example31">
</div>
</div>
</div>
<div class="sect6">
<h7 id="page-class-10"><a class="anchor" href="#page-class-10"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class DynamicLoadingPage extends BasePage {

    private static final By selectorExampleOneLink     =
            By.cssSelector("a[href*='dynamic_loading/1']");
    private static final By selectorExampleTwoLink     =
            By.cssSelector("a[href*='dynamic_loading/2']");
    private static final By selectorDynamicLoadingText = By.cssSelector("div#content h3");
    private static final By selectorStartButton        = By.cssSelector("div#start button");
    private static final By selectorLoadingBar         = By.cssSelector("div#loading");
    private static final By selectorExampleText        = By.cssSelector("div#finish h4");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.DYNAMIC_LOADING.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Dynamically Loaded Page Elements' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.DYNAMIC_LOADING.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Returns information if dynamic loading message is visible or not.
     *
     * @return true if dynamic loading message was found on web page.
     */
    public boolean isDynamicLoadingMessageVisible() {
        return getDriver().findElementDynamic(selectorDynamicLoadingText)
                .isDisplayed();
    }

    /**
     * Clicks Example 1 link.
     */
    public void clickExampleOneLink() {
        getDriver().findElementDynamic(selectorExampleOneLink)
                .click();
    }

    /**
     * Clicks Example 2 link.
     */
    public void clickExampleTwoLink() {
        getDriver().findElementDynamic(selectorExampleTwoLink)
                .click();
    }

    /**
     * Returns information if Start button is visible or not.
     *
     * @return true if Start button was found on web page.
     */
    public boolean isStartButtonVisible() {
        return getDriver().findElementDynamic(selectorStartButton)
                .isDisplayed();
    }

    /**
     * Clicks Start button.
     */
    public void clickStartButton() {
        getDriver().findElementDynamic(selectorStartButton)
                .click();
    }

    /**
     * Waits until WebElement representing waiting bar disappears and returns example text.
     *
     * @param waitTime The amount of time designated for waiting until waiting bar disappears.
     * @return String representing example's text.
     */
    public String getExampleOneDynamicText(int waitTime) {
        WebDriverWait wait = new WebDriverWait(getDriver(), waitTime);
        wait.until((Function&lt;? super WebDriver, Boolean&gt;)
                ExpectedConditions.invisibilityOfElementLocated(selectorLoadingBar));
        return getDriver().findElementDynamic(selectorExampleText)
                .getText();
    }

    /**
     * Returns example text.
     * &lt;p&gt;
     * Waits until WebElement representing waiting bar disappear. Then waits until example text
     * shows up.
     * And after that returns example text.
     * &lt;/p&gt;
     *
     * @param waitTime The amount of time designated for waiting until waiting bar disappears and
     * example text shows.
     * @return String representing example's text.
     */
    public String getExampleTwoDynamicText(int waitTime) {
        WebDriverWait wait = new WebDriverWait(getDriver(), waitTime);
        wait.until((Function&lt;? super WebDriver, Boolean&gt;)
                ExpectedConditions.invisibilityOfElementLocated(selectorLoadingBar));
        wait.until((Function&lt;? super WebDriver, WebElement&gt;)
                ExpectedConditions.visibilityOfElementLocated(selectorExampleText));
        return getDriver().findElementDynamic(selectorExampleText)
                .getText();
    }

}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="webdriverwait"><a class="anchor" href="#webdriverwait"></a>== WebDriverWait</h7>
<div class="paragraph">
<p>This class performs waiting for actions using Selenium Web Driver:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>WebDriverWait(WebDriver driver, long timeOutInSeconds) - constructor, first parameter takes WebDriver, in a second you can specify a timeout in seconds.
FluentWait method:</p>
</li>
<li>
<p>until(Function&lt;? super T, V&gt; isTrue) - waits until condition function given as parameter returns expected value. If waiting time reaches timeout, it throws timeoutException.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>MrChecker implements various condition functions in the ExpectedConditions class :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>visibilityOfElementLocated(By selector) - returns WebElement if it&#8217;s visible</p>
</li>
<li>
<p>invisibilityOfElementLocated(By selector) - returns true if Element under given selector is invisible</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>WebDriver also has methods which wait for some conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>waitForElement(By selector)</p>
</li>
<li>
<p>waitForElementVisible(By selector)</p>
</li>
<li>
<p>waitUntilElementClickable(By selector)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It&#8217;s possible to write your own condition function e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  public static ExpectedCondition&lt;Boolean&gt; invisibilityOfElementLocated(final By locator) {
    return new ExpectedCondition&lt;Boolean&gt;() {
      @Override
      public Boolean apply(WebDriver driver) {
        try {
          return !(findElement(locator, driver).isDisplayed());
        } catch (NoSuchElementException e) {
          return true;
        } catch (StaleElementReferenceException e) {
          return true;
        }
      }
    };
  }</pre>
</div>
</div>
<div class="paragraph">
<p>Or as a lambda expression:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>        WebDriverWait wait = new WebDriverWait(getDriver(), waitTime);
        wait.until((WebDriver driver) -&gt; {
            try {
                return !(driver.findElement(selectorExampleText)
                        .isDisplayed());
            } catch (NoSuchElementException e) {
                return true;
            } catch (StaleElementReferenceException e) {
                return true;
            }
        });</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="test-class-10"><a class="anchor" href="#test-class-10"></a>== Test Class</h7>
<div class="paragraph">
<p>Case 1 steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Click Dynamic Loading link and go to a subpage with examples</p>
</li>
<li>
<p>Check if the page is loaded and "Dynamically Loaded Page Elements" header is visible</p>
</li>
<li>
<p>Click Example 1 link and load site</p>
</li>
<li>
<p>Verify if the "Start" button is visible</p>
</li>
<li>
<p>Click "Start"</p>
</li>
<li>
<p>Wait for the loading bar to disappear and check if the displayed message is as it should be</p>
</li>
<li>
<p>Go back to Dynamic Loading page</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Case 2 steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check if the page is loaded and "Dynamically Loaded Page Elements" header is visible</p>
</li>
<li>
<p>Click Example 2 link and load site</p>
</li>
<li>
<p>Verify if the "Start" button is visible</p>
</li>
<li>
<p>Click "Start"</p>
</li>
<li>
<p>Wait for the loading bar to disappear</p>
</li>
<li>
<p>Wait for the message to appear and check if it is as it should be</p>
</li>
<li>
<p>Go back to Dynamic Loading page</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class DynamicLoadingTest extends TheInternetBaseTest {

    private static final int    EXAMPLE_WAITING_TIME = 30;
    private static final String EXAMPLE_TEXT         = "Hello World!";

    private static DynamicLoadingPage dynamicLoadingPage;

    @BeforeClass
    public static void setUpBeforeClass() {
        dynamicLoadingPage = shouldTheInternetPageBeOpened().clickDynamicLoadingLink();
    }

    @Override
    public void setUp() {

        logStep("Verify if Dynamic Loading page is opened");
        assertTrue("Unable to open Dynamic Loading page", dynamicLoadingPage.isLoaded());

        logStep("Verify if dynamic loading message is visible");
        assertTrue("Dynamic loading message is invisible",
                dynamicLoadingPage.isDynamicLoadingMessageVisible());
    }

    @Test
    public void shouldExampleTextBeDisplayedAterRunExampleOne() {
        logStep("Click Example 1 link");
        dynamicLoadingPage.clickExampleOneLink();

        logStep("Verify if Example 1 link opened content");
        assertTrue("Fail to load Example 1 content", dynamicLoadingPage.isStartButtonVisible());

        logStep("Click Start button");
        dynamicLoadingPage.clickStartButton();

        logStep("Verify if expected text is displayed on the screen");
        assertEquals("Fail to display example text", EXAMPLE_TEXT,
                dynamicLoadingPage.getExampleOneDynamicText(EXAMPLE_WAITING_TIME));
    }

    @Test
    public void shouldExampleTextBeDisplayedAterRunExampleTwo() {
        logStep("Click Example 2 link");
        dynamicLoadingPage.clickExampleTwoLink();

        logStep("Verify if Example 2 link opened content");
        assertTrue("Fail to load Example 2 content", dynamicLoadingPage.isStartButtonVisible());

        logStep("Click Start button");
        dynamicLoadingPage.clickStartButton();

        logStep("Verify if expected text is displayed on the screen");
        assertEquals("Fail to display example text", EXAMPLE_TEXT,
                dynamicLoadingPage.getExampleTwoDynamicText(EXAMPLE_WAITING_TIME));
    }

    @Override
    public void tearDown() {
        logStep("Click back to reset Dynamic Loading page");
        BasePage.navigateBack();
    }

}</pre>
</div>
</div>
<div class="paragraph">
<p>Perform both cases running Test Class as JUnit Test.</p>
</div>
<div class="paragraph">
<p><strong>WARNING:</strong> In this example, there is a visible loading bar signalizing that content is loading.On many websites elements are created by scripts without clear communique. This may cause problems with test stability. When your tests aren&#8217;t finding page elements, try to add wait functions with a short timeout.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example32.png" alt="example32">
</div>
</div>
<div class="paragraph">
<p>This case shows how to perform mouse actions and test modal windows.</p>
</div>
<div class="paragraph">
<p>After you move the mouse cursor out of the website, you should see a new window appearing:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example33.png" alt="example33">
</div>
</div>
<div class="paragraph">
<p>Check in the browser&#8217;s developer mode if this window exists in Page DOM</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example34.png" alt="example34">
</div>
</div>
<div class="paragraph">
<p>Before you move the mouse out, the window exists, but it&#8217;s not displayed.</p>
</div>
<div class="paragraph">
<p>When the mouse is moved, JavaScript changes display attribute. It also hides window after clicking "Close".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example35.png" alt="example35">
</div>
</div>
</div>
<div class="sect6">
<h7 id="page-class-11"><a class="anchor" href="#page-class-11"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class ExitIntentPage extends BasePage {

    private static final String MODAL_WINDOW_HIDDEN           = "display: none;";
    private static final String MODAL_WINDOW_DISPLAYED        = "display: block;";
    private static final String MODAL_WINDOW_STYLE_ATTRIBUTTE = "style";

    private static final By selectorModalWindow            = By.cssSelector("div#ouibounce-modal");
    private static final By selectorExitIntentText         = By.cssSelector("div#content h3");
    private static final By selectorModalWindowTitle       = By.cssSelector("h3");
    private static final By selectorModalWindowCloseButton = By.cssSelector("div.modal-footer &gt; p");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.EXIT_INTENT.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Exit Intent' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.EXIT_INTENT.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Returns information if exit intent message is visible or not.
     *
     * @return true if exit intent message was found on web page.
     */
    public boolean isIntentMessageVisible() {
        return getDriver().findElementDynamic(selectorExitIntentText)
                .isDisplayed();
    }

    /**
     * Returns information if modal window is hidden.
     *
     * @return true if modal window is hidden.
     */
    public boolean isModalWindowHidden() {
        return getDriver().findElementDynamic(selectorModalWindow)
                .getAttribute(MODAL_WINDOW_STYLE_ATTRIBUTTE)
                .equals(MODAL_WINDOW_HIDDEN);
    }

    /**
     * Returns information if modal window is showed on web page.
     *
     * @return true if modal window is displayed.
     */
    public boolean isModalWindowVisible() {
        return getDriver().findElementDynamic(selectorModalWindow)
                .getAttribute(MODAL_WINDOW_STYLE_ATTRIBUTTE)
                .equals(MODAL_WINDOW_DISPLAYED);
    }

    /**
     * Returns information if modal window title is shown and correct.
     *
     * @param expectedValue String representing expected value of modal window's title.
     * @return true if modal window's title is equal to expected value.
     */
    public boolean verifyModalWindowTitle(String expectedValue) {
        return getDriver().elementLabel(new ByChained(selectorModalWindow,
                selectorModalWindowTitle))
                .getText()
                .equals(expectedValue);
    }

    /**
     * Closes modal window by pressing 'close' button.
     */
    public void closeModalWindow() {
        getDriver().elementButton(new ByChained(selectorModalWindow,
                selectorModalWindowCloseButton))
                .click();
    }

    /**
     * Moves mouse pointer to the top middle of screen, then to the centre of screen and
     * again to the top.
     * &lt;p&gt;
     * This move simulates leaving the viewport and encourages the modal to show up. There is
     * java.awt.Robot used
     * to move mouse pointer out of the viewport. There are timeouts used to let the browser detect
     * mouse move.
     * &lt;/p&gt;
     *
     * @see java.awt.Robot
     */
    public void moveMouseOutOfViewport() {
        Robot robot;
        Dimension screenSize = getDriver().manage()
                .window()
                .getSize();
        int halfWidth = new BigDecimal(screenSize.getWidth() / 2).intValue();
        int halfHeight = new BigDecimal(screenSize.getHeight() / 2).intValue();

        try {
            robot = new Robot();
            robot.mouseMove(halfWidth, 1);
            getDriver().manage()
                    .timeouts()
                    .implicitlyWait(1, TimeUnit.SECONDS);
            robot.mouseMove(halfWidth, halfHeight);
            getDriver().manage()
                    .timeouts()
                    .implicitlyWait(1, TimeUnit.SECONDS);
            robot.mouseMove(halfWidth, 1);
        } catch (AWTException e) {
            BFLogger.logError("Unable to connect with remote mouse");
            e.printStackTrace();
        }
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="attributes"><a class="anchor" href="#attributes"></a>== Attributes</h7>
<div class="paragraph">
<p>Elements on pages have attributes like "id", "class", "name", "style" etc. In order to check them, use method <code>getAttribute(String name)</code>. In this case attribute "style" determinates if the element is displayed.</p>
</div>
</div>
<div class="sect6">
<h7 id="robot"><a class="anchor" href="#robot"></a>== Robot</h7>
<div class="paragraph">
<p>Robot class can perform mouse movement. Method <code>mouseMove(int x, int y)</code> moves the remote mouse to given coordinates.</p>
</div>
</div>
<div class="sect6">
<h7 id="manage-timeouts"><a class="anchor" href="#manage-timeouts"></a>== Manage Timeouts</h7>
<div class="paragraph">
<p><code>manage().timeouts()</code> methods allows you to change WebDriver timeouts values such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pageLoadTimeout(long time, TimeUnit unit)</code> - the amount of time to wait for a page to load before throwing an exception</p>
</li>
<li>
<p><code>setScriptTimeout(long time, TimeUnit unit)</code> - the amount of time to wait for finish execution of a script before throwing an exception</p>
</li>
<li>
<p><code>implicitlyWait(long time, TimeUnit unit)</code> - the amount of time the driver should wait when searching for an element if it is not immediately present. After that time, it throws an exception.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Changing timeouts can improve test stability but can also make them run slower.</p>
</div>
</div>
<div class="sect6">
<h7 id="test-class-11"><a class="anchor" href="#test-class-11"></a>== Test Class</h7>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Click Exit Intent link and load subpage</p>
</li>
<li>
<p>Check if the page is loaded and "Exit Intent" message is visible</p>
</li>
<li>
<p>Verify if Modal Window is hidden</p>
</li>
<li>
<p>Move mouse out of the viewport</p>
</li>
<li>
<p>Check if Modal Window is visible</p>
</li>
<li>
<p>Verify if Modal Window title is correct</p>
</li>
<li>
<p>Click 'close' button</p>
</li>
<li>
<p>Again verify if Modal Window is hidden</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsLocal.class, TestsNONParallel.class })
public class ExitIntentTest extends TheInternetBaseTest {

    private static final String MODAL_WINDOW_TITLE = "This is a modal window";

    private static ExitIntentPage exitIntentPage;

    @BeforeClass
    public static void setUpBeforeClass() {
        exitIntentPage = shouldTheInternetPageBeOpened().clickExitIntentLink();

        logStep("Verify if Exit Intent page is opened");
        assertTrue("Unable to open Exit Intent page", exitIntentPage.isLoaded());

        logStep("Verify if exit intent message is visible");
        assertTrue("Exit intent message is not visible", exitIntentPage.isIntentMessageVisible());
    }

    @Test
    public void shouldModalWindowAppearWhenMouseMovedOutOfViewportTest() {

        logStep("Verify if modal window is hidden");
        assertTrue("Fail to hide modal window", exitIntentPage.isModalWindowHidden());

        logStep("Move mouse pointer out of viewport");
        exitIntentPage.moveMouseOutOfViewport();

        logStep("Verify if modal window showed up");
        assertTrue("Fail to show up modal window", exitIntentPage.isModalWindowVisible());

        logStep("Verify if modal window title displays properly");
        assertTrue("Fail to display modal window's title",
                exitIntentPage.verifyModalWindowTitle(MODAL_WINDOW_TITLE.toUpperCase()));

        logStep("Close modal window");
        exitIntentPage.closeModalWindow();

        logStep("Verify if modal window is hidden again");
        assertTrue("Fail to hide modal window", exitIntentPage.isModalWindowHidden());
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Remember not to move mouse manually during test execution.</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example36.png" alt="example36">
</div>
</div>
<div class="paragraph">
<p>This example shows how to check if file downloads properly.</p>
</div>
<div class="paragraph">
<p>After clicking on one of these links, a specific file should be downloaded to your computer.</p>
</div>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Click on the File Download link and open subpage</p>
</li>
<li>
<p>Click on "some-file.txt" download link and download file</p>
</li>
<li>
<p>Check if the file exists in the appropriate folder</p>
</li>
<li>
<p>Delete the file</p>
</li>
<li>
<p>Check if the file doesn&#8217;t exist in the folder</p>
</li>
</ol>
</div>
</div>
<div class="sect6">
<h7 id="page-class-12"><a class="anchor" href="#page-class-12"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class FileDownloadPage extends BasePage {

    private static final By selectorSomeFileTxt = By.cssSelector("a[href*=some-file]");

    private final String DOWNLOAD_DIR = System.getProperty("java.io.tmpdir");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.DOWNLOAD.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'File Downloader' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.DOWNLOAD.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Verifies if the chosen file is already downloaded and if not, downloads it .
     * Throws RuntimeException otherwise.
     *
     * @return Downloaded file
     */
    public File downloadTextFile() {
        String nameOfDownloadFile = getNameOfDownloadFile();
        File fileToDownload = new File(DOWNLOAD_DIR + nameOfDownloadFile);

        if (fileToDownload.exists()) {
            throw new RuntimeException("The file that you want to download already exists. "
                    + "Please remove it manually. Path to the file: " + fileToDownload.getPath());
        }

        getDriver().elementButton(selectorSomeFileTxt)
                .click();

        waitForFileDownload(2000, fileToDownload);
        return fileToDownload;
    }

    private void waitForFileDownload(int totalTimeoutInMillis, File expectedFile) {
        FluentWait&lt;WebDriver&gt; wait = new FluentWait&lt;WebDriver&gt;(getDriver())
                .withTimeout(totalTimeoutInMillis, TimeUnit.MILLISECONDS)
                .pollingEvery(200, TimeUnit.MILLISECONDS);

        wait.until((WebDriver wd) -&gt; expectedFile.exists());
    }

    private String getNameOfDownloadFile() {
        String urlToDownload = getDriver().findElementDynamic(selectorSomeFileTxt)
                .getAttribute("href");
        String[] urlHierachy = urlToDownload.split("/");
        return urlHierachy[urlHierachy.length - 1];
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Use FluentWait class and create an expected condition using a lambda expression to wait until the file downloads.</p>
</div>
<div class="paragraph">
<p>To perform operations on files, use java File class. To get a file name, find it in download URL.</p>
</div>
</div>
<div class="sect6">
<h7 id="test-class-12"><a class="anchor" href="#test-class-12"></a>== Test Class</h7>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsLocal.class, TestsNONParallel.class })
public class FileDownloadTest extends TheInternetBaseTest {

    private static FileDownloadPage fileDownloadPage;

    @BeforeClass
    public static void setUpBeforeClass() {
        fileDownloadPage = shouldTheInternetPageBeOpened().clickFileDownloadLink();

        logStep("Verify if File Download page is opened");
        assertTrue("Unable to open File Download page", fileDownloadPage.isLoaded());
    }

    @Test
    public void shouldfileBeDownloaded() {

        logStep("Download the some-file.txt");
        File downloadedFile = fileDownloadPage.downloadTextFile();

        logStep("Verify if downloaded file exists");
        assertTrue("Downloaded file does not exist", downloadedFile.exists());

        logStep("Remove downloaded file");
        downloadedFile.delete();

        logStep("Verify if downloaded file has been removed");
        assertFalse("Downloaded file still exists", downloadedFile.exists());
    }
}</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example37.png" alt="example37">
</div>
</div>
<div class="paragraph">
<p>This case shows how to pass through the standard authentication page.</p>
</div>
<div class="paragraph">
<p>When you enter the correct credentials, you should see the next page:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example38.png" alt="example38">
</div>
</div>
<div class="paragraph">
<p>If user data is wrong, an appropriate message appears:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example39.png" alt="example39">
</div>
</div>
</div>
<div class="sect6">
<h7 id="page-class-13"><a class="anchor" href="#page-class-13"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class FormAuthenticationPage extends BasePage {

    private final static By selectorInputUsername     = By.cssSelector("#username");
    private final static By selectorInputUserPassword = By.cssSelector("#password");
    private final static By selectorLoginMessage      = By.cssSelector("#flash");
    private final static By selectorLoginButton       = By.cssSelector("#login &gt; button &gt; i");
    private final static By selectorLogoutButton      = By.cssSelector("#content &gt; div &gt; a ");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.LOGIN.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Login Page' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() + PageSubURLsProjectYEnum.LOGIN.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Sets user name to designated form's field.
     *
     * @param username String representing a user's name
     * @return FormAuthenticationPage object with user name set to the given one
     */
    public FormAuthenticationPage setUsername(String username) {
        InputTextElement elementInputUsername = new InputTextElement(selectorInputUsername);
        elementInputUsername.clearInputText();
        elementInputUsername.setInputText(username);
        return this;
    }

    /**
     * Sets user password to designated form's field.
     *
     * @param userPassword String representing a user's password
     * @return FormAuthenticationPage object with user's password set to the given one
     */
    public FormAuthenticationPage setUserPassword(String userPassword) {
        InputTextElement elementInputPassword = new InputTextElement(selectorInputUserPassword);
        elementInputPassword.clearInputText();
        elementInputPassword.setInputText(userPassword);
        return this;
    }

    /**
     * Returns login message.
     *
     * @return String object representing the message returned after login operation is performed
     */
    public String getLoginMessageText() {
        return new LabelElement(selectorLoginMessage).getText();
    }

    /**
     * Clicks 'Login' button.
     */
    public void clickLoginButton() {
        new Button(selectorLoginButton).click();
    }

    /**
     * Clicks 'Logout' button.
     */
    public void clickLogoutButton() {
        new Button(selectorLogoutButton).click();
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="inputtextelement"><a class="anchor" href="#inputtextelement"></a>== ==  InputTextElement</h7>
<div class="paragraph">
<p>Use methods from this class to perform actions on text fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>clearInputText()</code> - remove all text from selected input field</p>
</li>
<li>
<p><code>setInputText(String text)</code> - enter given text</p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="labelelement"><a class="anchor" href="#labelelement"></a>== ==  LabelElement</h7>
<div class="ulist">
<ul>
<li>
<p>String <code>getText()</code> method returns visible text from label</p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="testclass"><a class="anchor" href="#testclass"></a>== TestClass</h7>
<div class="paragraph">
<p>Prepare six test cases:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Try to login with empty user data and check if the error message appears</p>
</li>
<li>
<p>Try to login with empty username and valid password and check if the error message appears</p>
</li>
<li>
<p>Try to login with a valid username and empty password and check if the error message appears</p>
</li>
<li>
<p>Try to login with invalid username and invalid password and check if the error message appears</p>
</li>
<li>
<p>Try to login with a valid username and valid password and check if success login message appears, then log out</p>
</li>
<li>
<p>Try to login with a valid username and valid password and check if success login message appears, then log out and check if success logout message is displayed</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Before all tests: Open The Internet Main Page</p>
</div>
<div class="paragraph">
<p>Before each case: Click on the Form Authentication link and open login page</p>
</div>
<div class="paragraph">
<p>After each case: Go back to The Internet Main Page</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsLocal.class, TestsNONParallel.class })
public class FormAuthenticationTest extends TheInternetBaseTest {

    private static FormAuthenticationPage formAuthenticationPage;

    private String errorUsernameMessage = "Your username is invalid!\n" + "×";
    private String errorPasswordMessage = "Your password is invalid!\n" + "×";
    private String loginMessage         = "You logged into a secure area!\n" + "×";
    private String logoutMessage        = "You logged out of the secure area!\n" + "×";
    private String emptyUsername        = "";
    private String emptyUserPassword    = "";
    private String validUsername        = "tomsmith";
    private String validPassword        = "SuperSecretPassword!";
    private String randomUsername       = UUID.randomUUID()
            .toString();
    private String randomUserPassword   = UUID.randomUUID()
            .toString();

    @BeforeClass
    public static void setUpBeforeClass() {
        logStep("Open the Url http://the-internet.herokuapp.com/");
        theInternetPage = new TheInternetPage();
        theInternetPage.load();

        logStep("Verify if Url http://the-internet.herokuapp.com/ is opened");
        assertTrue("Unable to load The Internet Page", theInternetPage.isLoaded());
    }

    @Override
    public void setUp() {
        logStep("Click subpage link");
        formAuthenticationPage = theInternetPage.clickFormAuthenticationLink();

        logStep("Verify if subpage is opened");
        assertTrue("The Internet subpage: FormAuthenticationPage was not open", formAuthenticationPage.isLoaded());
    }

    @Test
    public void shouldErrorMessageBeDisplayedWhenUserLogsWithEmptyData() {
        logStep("Log user with empty username and password");
        formAuthenticationPage.setUsername(emptyUsername)
                .setUserPassword(emptyUserPassword)
                .clickLoginButton();
        assertEquals("Unexpectedly user logged in with empty data", errorUsernameMessage,
                formAuthenticationPage.getLoginMessageText());
    }

    @Test
    public void shouldErrorMessageBeDisplayedWhenUserLogsWithEmptyUsernameAndValidPassword() {
        logStep("Log user with empty username and valid password");
        formAuthenticationPage.setUsername(emptyUsername)
                .setUserPassword(validPassword)
                .clickLoginButton();
        assertEquals("Unexpectedly user logged in with empty username", errorUsernameMessage,
                formAuthenticationPage.getLoginMessageText());
    }

    @Test
    public void shouldErrorMessageBeDisplayedWhenUserLogsWithValidUsernameAndEmptyPassword() {
        logStep("Log user with valid username and empty password");
        formAuthenticationPage.setUsername(validUsername)
                .setUserPassword(emptyUserPassword)
                .clickLoginButton();
        assertEquals("Unexpectedly user logged in with empty password", errorPasswordMessage,
                formAuthenticationPage.getLoginMessageText());
    }

    @Test
    public void shouldErrorMessageBeDisplayedWhenUserLogsWithInvalidUsernameAndInvalidPassword() {
        logStep("Log user with invalid username and invalid password");
        formAuthenticationPage.setUsername(randomUsername)
                .setUserPassword(randomUserPassword)
                .clickLoginButton();
        assertEquals("Unexpectedly user logged in with random credentials", errorUsernameMessage,
                formAuthenticationPage.getLoginMessageText());
    }

    @Test
    public void shouldUserLogInWithValidCredentials() {
        logStep("Log user with valid username and valid password");
        formAuthenticationPage.setUsername(validUsername)
                .setUserPassword(validPassword)
                .clickLoginButton();
        assertEquals("Unable to login user with valid credentials", loginMessage,
                formAuthenticationPage.getLoginMessageText());
        logStep("Log out user");
        formAuthenticationPage.clickLogoutButton();
    }

    @Test
    public void shouldUserLogOutAfterProperLogInAndClickLogoutButon() {
        logStep("Log user with valid username and valid password");
        formAuthenticationPage.setUsername(validUsername)
                .setUserPassword(validPassword)
                .clickLoginButton();
        assertEquals("Unable to login user with valid credentials", loginMessage,
                formAuthenticationPage.getLoginMessageText());
        logStep("Log out user");
        formAuthenticationPage.clickLogoutButton();
        assertEquals("User cannot log out after prper log in", logoutMessage,
                formAuthenticationPage.getLoginMessageText());
    }

    @Override
    public void tearDown() {
        logStep("Navigate back to The-Internet page");
        theInternetPage.load();
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>After running Test Class, cases might be performed in a different order.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example40.png" alt="example40">
</div>
</div>
<div class="paragraph">
<p>This example shows how to approach elements dynamically appearing after the user&#8217;s action.</p>
</div>
<div class="paragraph">
<p>Move the mouse over an image to see the additional label.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example41.png" alt="example41">
</div>
</div>
<div class="paragraph">
<p>Labels exist in page DOM all the time but their display attributes change. In this case, there is no JavaScript. Elements' visibility is managed by CSS.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example42.png" alt="example42">
</div>
</div>
</div>
<div class="sect6">
<h7 id="page-class-14"><a class="anchor" href="#page-class-14"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class HoversPage extends BasePage {

    private final static By selectorImages = By.cssSelector("div.figure &gt; img");
    private final static By selectorNames  = By.cssSelector("div.figcaption h5");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.HOVERS.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Hovers' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.HOVERS.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Moves mouse pointer over an image with given index.
     *
     * @param index An index of the picture, where mouse pointer should be moved
     */
    public void hoverOverAvatar(int index) {
        Actions action = new Actions(getDriver());
        WebElement avatarImage = getDriver().findElementDynamics(selectorImages)
                .get(index);
        action.moveToElement(avatarImage)
                .perform();
    }

    /**
     * Returns the information displayed under a picture with given index.
     *
     * @param index An index of the picture, where the information should be read
     * @return String object representing picture's information
     */
    public String getAvatarsInformation(int index) {
        return getDriver().findElementDynamics(selectorNames)
                .get(index)
                .getText();
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="actions"><a class="anchor" href="#actions"></a>== ==  Actions</h7>
<div class="paragraph">
<p>Actions class contains methods used to execute basic user actions such as mouse moving and clicking or keys sending. Action or actions series will be performed after calling <code>perform()</code> method.</p>
</div>
</div>
<div class="sect6">
<h7 id="test-class-13"><a class="anchor" href="#test-class-13"></a>== Test Class</h7>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Go to Hovers page</p>
</li>
<li>
<p>Move mouse over random image</p>
</li>
<li>
<p>Check if displayed text is equal to expected.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class HoversTest extends TheInternetBaseTest {

    private static HoversPage    hoversPage;
    private final String        names[]    = { "name: user1", "name: user2", "name: user3" };

    @BeforeClass
    public static void setUpBeforeClass() {
        hoversPage = shouldTheInternetPageBeOpened().clickHoversLink();

        logStep("Verify if Hovers page is opened");
        assertTrue("Unable to open Hovers page", hoversPage.isLoaded());
    }

    @Test
    public void shouldProperInformationBeDisplayedWhenMousePointerHoveredOverRandomElement() {
        logStep("Hover mouse pointer over random element");
        int randomIndex = new Random().nextInt(names.length);
        hoversPage.hoverOverAvatar(randomIndex);
        assertEquals("Picture's information is different than expected", names[randomIndex],
                hoversPage.getAvatarsInformation(randomIndex));
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Because in this case the tested content is being chosen randomly, each test run could check a different element.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example43.png" alt="example43">
</div>
</div>
<div class="paragraph">
<p>This case shows how to test pop-up JS alerts.</p>
</div>
<div class="paragraph">
<p>After clicking one of the buttons, an adequate alert should appear.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example44.png" alt="example44">
</div>
</div>
<div class="paragraph">
<p>Performed action will be displayed under "Result" label.</p>
</div>
<div class="paragraph">
<p>In developer mode, you can view JavaScript which creates alerts.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example45.png" alt="example45">
</div>
</div>
</div>
<div class="sect6">
<h7 id="page-class-15"><a class="anchor" href="#page-class-15"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class JavaScriptAlertsPage extends BasePage {

    private static final By selectorAlertButton   = By.cssSelector("button[onclick*=jsAlert]");
    private static final By selectorConfirmButton = By.cssSelector("button[onclick*=jsConfirm]");
    private static final By selectorPromptButton  = By.cssSelector("button[onclick*=jsPrompt]");
    private static final By resultLabelSelector   = By.cssSelector("p#result");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.JAVASCRIPT_ALERTS.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'JavaScript Alerts' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.JAVASCRIPT_ALERTS.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Clicks 'JS alert' button.
     */
    public void clickAlertButton() {
        new Button(selectorAlertButton).click();
        WebDriverWait wait = new WebDriverWait(getDriver(), 2);
        wait.until(ExpectedConditions.alertIsPresent());
    }

    /**
     * Clicks 'JS confirm' button.
     */
    public void clickConfirmButton() {
        new Button(selectorConfirmButton).click();
        WebDriverWait wait = new WebDriverWait(getDriver(), 2);
        wait.until(ExpectedConditions.alertIsPresent());
    }

    /**
     * Clicks 'JS prompt' button.
     */
    public void clickPromptButton() {
        new Button(selectorPromptButton).click();
        WebDriverWait wait = new WebDriverWait(getDriver(), 2);
        wait.until(ExpectedConditions.alertIsPresent());
    }

    /**
     * Returns message displayed by popup.
     *
     * @return String object representing message displayed by popup
     */
    public String readResultLabel() {
        return new LabelElement(resultLabelSelector).getText();
    }

    /**
     * Clicks alert's 'OK' button.
     */
    public void clickAlertAccept() {
        getDriver().switchTo()
                .alert()
                .accept();
    }

    /**
     * Clicks alert's 'Cancel' button.
     */
    public void clickAlertDismiss() {
        getDriver().switchTo()
                .alert()
                .dismiss();
    }

    /**
     * Types text into alert's text field.
     *
     * @param text String object sent into alert's text field
     */
    public void writeTextInAlert(String text) {
        getDriver().switchTo()
                .alert()
                .sendKeys(text);
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="alert"><a class="anchor" href="#alert"></a>== ==  alert()</h7>
<div class="paragraph">
<p>Using <code>switchTo()</code> method you can change processed content. <code>switchTo().alert()</code> allows performing actions on appearing alerts such as accepting, dismissing or entering keys.</p>
</div>
</div>
<div class="sect6">
<h7 id="test-class-14"><a class="anchor" href="#test-class-14"></a>== Test Class</h7>
<div class="paragraph">
<p>Before all tests: Open The Internet Main Page and go to JavaScript Alert page</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click JS Alert button, accept alert and check if Result message returns performed an action</p>
</li>
<li>
<p>Click JS Confirm button, accept alert and check if Result message returns performed action</p>
</li>
<li>
<p>Click JS Confirm button, dismiss alert and check if Result message returns performed action</p>
</li>
<li>
<p>Click JS Prompt button, write random text, accept alert and check if Result message returns performed action with written text</p>
</li>
<li>
<p>Click JS Prompt button, dismiss the alert and check if Result message returns performed action</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After each case: Refresh Page</p>
</div>
<div class="paragraph">
<p>After all tests:  Navigate back to The Internet Main Page</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class JavaScriptAlertsTest extends TheInternetBaseTest {

    private static JavaScriptAlertsPage javaScriptAlertsPage;

    private final String jsAlertCofirmMessage    = "You successfuly clicked an alert";
    private final String jsConfirmConfirmMessage = "You clicked: Ok";
    private final String jsConfirmCancelMessage  = "You clicked: Cancel";
    private final String jsPromptConfirmMessage  = "You entered: ";
    private final String jsPromptCancelMessage   = "You entered: null";
    private final String randomString            = "random";

    @BeforeClass
    public static void setUpBeforeClass() {
        javaScriptAlertsPage = shouldTheInternetPageBeOpened().clickJavaScriptAlertLink();

        logStep("Verify if JavaScript Alerts page is opened");
        assertTrue("Unable to open JavaScript Alerts page", javaScriptAlertsPage.isLoaded());
    }

    @AfterClass
    public static void tearDownAfterClass() {
        logStep("Navigate back to The-Internet page");
        BasePage.navigateBack();
    }

    @Test
    public void shouldJSAlertCloseWithProperMessageAfterPressOkButton() {
        logStep("Click Alert button");
        javaScriptAlertsPage.clickAlertButton();

        logStep("Click 'OK' button on alert");
        javaScriptAlertsPage.clickAlertAccept();

        logStep("Verify returned message");
        assertEquals("Incorrect message returned after click",
                jsAlertCofirmMessage, javaScriptAlertsPage.readResultLabel());
    }

    @Test
    public void shouldJSConfirmCloseWithProperMessageAfterPressOkButton() {
        logStep("Click Confirm button");
        javaScriptAlertsPage.clickConfirmButton();

        logStep("Click 'OK' button on alert");
        javaScriptAlertsPage.clickAlertAccept();

        logStep("Verify returned message");
        assertEquals("Incorrect message returned after click",
                jsConfirmConfirmMessage, javaScriptAlertsPage.readResultLabel());
    }

    @Test
    public void shouldJSConfirmCloseWithProperMessageAfterPressCancelButton() {
        logStep("Click Confirm button");
        javaScriptAlertsPage.clickConfirmButton();

        logStep("Click 'Cancel' button on alert");
        javaScriptAlertsPage.clickAlertDismiss();

        logStep("Verify returned message");
        assertEquals("Incorrect message returned after click",
                jsConfirmCancelMessage, javaScriptAlertsPage.readResultLabel());
    }

    @Test
    public void shouldJSPromptCloseWithProperMessageAfterPressOKButton() {
        logStep("Click Prompt button");
        javaScriptAlertsPage.clickPromptButton();

        logStep("Insert text to alert: " + randomString);
        javaScriptAlertsPage.writeTextInAlert(randomString);

        logStep("Click 'OK' button on alert");
        javaScriptAlertsPage.clickAlertAccept();

        logStep("Verify returned message");
        assertEquals("Incorrect message returned after click",
                jsPromptConfirmMessage + randomString, javaScriptAlertsPage.readResultLabel());
    }

    @Test
    public void shouldJSPromptCloseWithProperMessageAfterPressCancelButton() {
        logStep("Click Prompt button");
        javaScriptAlertsPage.clickPromptButton();

        logStep("Click 'Cancel' button on alert");
        javaScriptAlertsPage.clickAlertDismiss();

        logStep("Verify returned message");
        assertEquals("Incorrect message returned after click",
                jsPromptCancelMessage, javaScriptAlertsPage.readResultLabel());
    }

    @Override
    public void tearDown() {
        logStep("Refresh JavaScriptAlersPage");
        javaScriptAlertsPage.refreshPage();
    }

}</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example46.png" alt="example46">
</div>
</div>
<div class="paragraph">
<p>This simple case shows how to test key pressing</p>
</div>
<div class="paragraph">
<p>This site uses JavaScript to read the key pressed and display its value.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example47.png" alt="example47">
</div>
</div>
</div>
<div class="sect6">
<h7 id="page-class-16"><a class="anchor" href="#page-class-16"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class KeyPressesPage extends BasePage {

    private static final By selectorResult = By.cssSelector("#result");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.KEY_PRESS.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Key Presses' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.KEY_PRESS.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Presses given keyboard key.
     *
     * @param keyToPress Key to be pressed on keyboard
     */
    public void pressKey(String keyToPress) {
        getAction().sendKeys(keyToPress)
                .perform();
    }

    /**
     * Returns information from web page about pressed keyboard key.
     *
     * @return Information from web page about pressed key
     */
    public String getPressedKeyInformation() {
        return getDriver().findElementDynamic(selectorResult)
                .getText();
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="test-class-15"><a class="anchor" href="#test-class-15"></a>== Test Class</h7>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Go to Key Presses site</p>
</li>
<li>
<p>Press a key</p>
</li>
<li>
<p>Check if a displayed message contains the pressed key</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class KeyPressesTest extends TheInternetBaseTest {

    private static KeyPressesPage keyPressesPage;

    private final String keyToBePressed  = "Q";
    private final String expectedMessage = "You entered: Q";

    @BeforeClass
    public static void setUpBeforeClass() {
        keyPressesPage = shouldTheInternetPageBeOpened().clickKeyPressesLink();

        logStep("Verify if Key Presses page is opened");
        assertTrue("Unable to open Key Presses page", keyPressesPage.isLoaded());
    }

    @Test
    public void shouldWebsiteReturnInformationAboutPressedKey() {
        logStep("Press a keyboard key");
        keyPressesPage.pressKey(keyToBePressed);

        logStep("Verify if website give valid information about pressed keyboard key");
        assertEquals("Information about the pressed key is invalid", expectedMessage,
                keyPressesPage.getPressedKeyInformation());
    }
}</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example48.png" alt="example48">
</div>
</div>
<div class="paragraph">
<p>This simple example shows how operate on many browser tabs</p>
</div>
<div class="paragraph">
<p>When you click the link, a new website will be opened in the second tab.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example49.png" alt="example49">
</div>
</div>
</div>
<div class="sect6">
<h7 id="page-class-17"><a class="anchor" href="#page-class-17"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class MultipleWindowsPage extends BasePage {

    private final static By selectorLink = By.cssSelector("#content &gt; div &gt; a");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.WINDOW.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Opening a new window' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.WINDOW.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Clicks 'click here' link.
     *
     * @return NewWindowPage object
     */
    public NewWindowPage clickHereLink() {
        getDriver().findElementDynamic(selectorLink)
                .click();
        getDriver().waitForPageLoaded();
        return new NewWindowPage();
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>You also need a second page class for New Window Page. Implement only the required methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class NewWindowPage extends BasePage {

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.NEW_WINDOW.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'New window' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.NEW_WINDOW.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="test-class-16"><a class="anchor" href="#test-class-16"></a>== Test Class</h7>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Go to Multiple Windows Page</p>
</li>
<li>
<p>Click the link</p>
</li>
<li>
<p>Check if a new page is opened in the second tab</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class MultipleWindowsTest extends TheInternetBaseTest {

    private static MultipleWindowsPage    multipleWindowsPage;
    private static NewWindowPage        newWindowPage;

    @BeforeClass
    public static void setUpBeforeClass() {
        multipleWindowsPage = shouldTheInternetPageBeOpened().clickmultipleWindowsLink();

        logStep("Verify if Multiple Windows page is opened");
        assertTrue("Unable to open Multiple Windows page", multipleWindowsPage.isLoaded());
    }

    @Test
    public void verifyIfNewBrowserWindowOpen() {
        logStep("Click 'Click here' link");
        newWindowPage = multipleWindowsPage.clickHereLink();

        logStep("Verify if 'New window page' is opened");
        assertTrue("Unable to open a new browser window", newWindowPage.isLoaded());
    }
}</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example50.png" alt="example50">
</div>
</div>
<div class="paragraph">
<p>This simple case shows how to approach redirecting links.</p>
</div>
<div class="paragraph">
<p>After clicking on the link, you will be redirected to Status Codes Page.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example51.png" alt="example51">
</div>
</div>
</div>
<div class="sect6">
<h7 id="page-class-18"><a class="anchor" href="#page-class-18"></a>== Page Class</h7>

</div>
<div class="sect6">
<h7 id="redirect-link-page"><a class="anchor" href="#redirect-link-page"></a>== ==  Redirect Link Page</h7>
<div class="listingblock">
<div class="content">
<pre>public class RedirectLinkPage extends BasePage {

    private static final By selectorRedirectHere = By.cssSelector("a#redirect");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.REDIRECT.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Redirection' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.REDIRECT.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Clicks 'Redirect here' link.
     *
     * @return StatusCodesHomePage object
     */
    public StatusCodesHomePage clickRedirectHereLink() {
        new Button(selectorRedirectHere).click();
        return new StatusCodesHomePage();
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="status-codes-page"><a class="anchor" href="#status-codes-page"></a>== ==  Status Codes Page</h7>
<div class="listingblock">
<div class="content">
<pre>public class StatusCodesHomePage extends BasePage {

    private static final By selectorLink200Code = By.linkText("200");
    private static final By selectorLink301Code = By.linkText("301");
    private static final By selectorLink404Code = By.linkText("404");
    private static final By selectorLink500Code = By.linkText("500");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.STATUS_CODES.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Status Codes' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.STATUS_CODES.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="test-class-17"><a class="anchor" href="#test-class-17"></a>== Test Class</h7>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open The Internet Main Page</p>
</li>
<li>
<p>Go to Redirection Page</p>
</li>
<li>
<p>Click the link</p>
</li>
<li>
<p>Check if Status Codes Page is loaded</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class RedirectLinkTest extends TheInternetBaseTest {

    private static RedirectLinkPage    redirectLinkPage;
    private static StatusCodesHomePage statusCodesHomePage;

    @BeforeClass
    public static void setUpBeforeClass() {
        redirectLinkPage = shouldTheInternetPageBeOpened().clickRedirectLink();

        logStep("Verify if Redirect Link page is opened");
        assertTrue("Unable to open Redirect Link page", redirectLinkPage.isLoaded());
    }

    @Test
    public void shouldUserBeRedirectedToStatusCodePage() {
        logStep("Click 'Redirect here' link");
        statusCodesHomePage = redirectLinkPage.clickRedirectHereLink();

        logStep("Verify redirection to Status Code page");
        assertTrue("User hasn't been redirected to the expected website",
                statusCodesHomePage.isLoaded());
    }
}</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example52.png" alt="example52">
</div>
</div>
<div class="paragraph">
<p>This case shows how to move horizontal slider.</p>
</div>
<div class="paragraph">
<p>You can move the slider by dragging it with a mouse or using arrow keys. The page uses a simple script to get slider position and display set value.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example53.png" alt="example53">
</div>
</div>
</div>
<div class="sect6">
<h7 id="page-class-19"><a class="anchor" href="#page-class-19"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class HorizontalSliderPage extends BasePage {

    private static final By selectorHorizontalSlider = By.cssSelector("div.sliderContainer");
    private static final By sliderSelector           = By.cssSelector("input");
    private static final By valueSelector            = By.cssSelector("#range");

    private HorizontalSliderElement horizontalSlider;

    public HorizontalSliderPage() {
        horizontalSlider = getDriver().elementHorizontalSlider(selectorHorizontalSlider,
                sliderSelector, valueSelector, BigDecimal.ZERO, new BigDecimal(5),
                new BigDecimal(0.5));
    }

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.HORIZONTAL_SLIDER.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Horizontal Slider' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.HORIZONTAL_SLIDER.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Validates if WebElement representing horizontal slider is visible on the page.
     *
     * @return true if horizontal slider is visible, false otherwise.
     */
    public boolean isElementHorizontalSliderVisible() {
        return getDriver().elementHorizontalSlider(selectorHorizontalSlider)
                .isDisplayed();
    }

    /**
     * Returns the value of slider's start position.
     *
     * @return BigDecimal representing the lowest possible value of slider.
     */
    public BigDecimal getStartPosition() {
        return horizontalSlider.getMinRange();
    }

    /**
     * Returns the value of slider's middle position.
     *
     * @return BigDecimal representing the average value between start and end position.
     */
    public BigDecimal getMiddlePosition() {
        return horizontalSlider.getMaxRange()
                .subtract(horizontalSlider.getMinRange())
                .divide(new BigDecimal(2));
    }

    /**
     * Returns the value of slider's end position.
     *
     * @return BigDecimal representing the highest possible value of slider.
     */
    public BigDecimal getEndPosition() {
        return horizontalSlider.getMaxRange();
    }

    /**
     * Returns current value of slider's position.
     *
     * @return BigDecimal representing current value of slider.
     */
    public BigDecimal getCurrentPosition() {
        return horizontalSlider.getCurrentSliderValue();
    }

    /**
     * Sets horizontal slider to a given position using one of the available methods: using keyboard
     * or using mouse move.
     *
     * @param position
     * @param method
     */
    public void setSliderPositionTo(BigDecimal position, int method) {
        horizontalSlider.setSliderPositionTo(position, method);
    }

    /**
     * Verifies the correctness of the given position value and rounds it when necessary.
     *
     * @param position
     * @return Correct value of horizontal slider's position.
     */
    public BigDecimal verifyAndCorrectPositionValue(BigDecimal position) {
        return horizontalSlider.verifyAndCorrectPositionValue(position);
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="horizontal-slider-element"><a class="anchor" href="#horizontal-slider-element"></a>== ==  Horizontal Slider Element</h7>
<div class="paragraph">
<p>This class implements methods wich can perform actions on slider:</p>
</div>
<div class="paragraph">
<p>Create Slider Object using method:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>getDriver().elementHorizontalSlider(By sliderContainerSelector, By sliderSelector, By valueSelector, BigDecimal minRange, BigDecimal maxRange, BigDecimal step)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BigDecimal getMaxRange()</code></p>
</li>
<li>
<p><code>BigDecimal getMinRange()</code></p>
</li>
<li>
<p><code>BigDecimal getCurrentSliderValue()</code></p>
</li>
<li>
<p><code>setSliderPositionTo(BigDecimal position, int method)</code> - moves slider to a given position. If the position is not valid, it changes it to the nearest proper value. Second parameter determinates movement method: 0 - Keyboard, 1 - Mouse</p>
</li>
<li>
<p><code>BigDecimal verifyAndCorrectPositionValue(BigDecimal position)</code> - returns nearest correct position</p>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="test-class-18"><a class="anchor" href="#test-class-18"></a>== Test Class</h7>
<div class="paragraph">
<p>Before all tests: Open The Internet Main Page</p>
</div>
<div class="paragraph">
<p>Before each case:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to Horizontal Slider Page</p>
</li>
<li>
<p>Check if the slider is visible</p>
</li>
<li>
<p>Save start, middle and end position</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Case 1 - Moving with the keyboard:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Move slider to start position, and check if the current position equals the beginning value</p>
</li>
<li>
<p>Move the slider to middle position, and check if the current position equals the middle value</p>
</li>
<li>
<p>Move slider to end position, and check if the current position equals the end value</p>
</li>
<li>
<p>Try to move slider before start position, and check if the current position equals the beginning value</p>
</li>
<li>
<p>Try to move slider after end position, and check if the current position equals the end value</p>
</li>
<li>
<p>Try to move the slider to an improperly defined position between start and middle, and check if the current position equals the corrected value</p>
</li>
<li>
<p>Try to move the slider to an improperly defined random position, and check if the current position equals the corrected value</p>
</li>
<li>
<p>Move the slider back to start position, and check if the current position equals the beginning value</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Case 2 - Moving with a mouse: Repeat each Case 1 step using a mouse instead of keyboard</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class SliderTest extends TheInternetBaseTest {

    private static HorizontalSliderPage horizontalSliderPage;

    BigDecimal startPosition;
    BigDecimal middlePosition;
    BigDecimal endPosition;

    @BeforeClass
    public static void setUpBeforeClass() {
        logStep("Open the Url http://the-internet.herokuapp.com/");
        theInternetPage = new TheInternetPage();
        theInternetPage.load();

        logStep("Verify if Url http://the-internet.herokuapp.com/ is opened");
        assertTrue("Unable to load The Internet Page", theInternetPage.isLoaded());
    }

    @Override
    public void setUp() {
        logStep("Click Horizontal Slider link");
        horizontalSliderPage = theInternetPage.clickHorizontalSliderLink();

        logStep("Verify if Horizontal Slider page is opened");
        assertTrue("Unable to load Horizontal Slider page", horizontalSliderPage.isLoaded());

        logStep("Verify if horizontal slider element is visible");
        assertTrue("Horizontal slider is not visible",
                horizontalSliderPage.isElementHorizontalSliderVisible());

        startPosition = horizontalSliderPage.getStartPosition();
        middlePosition = horizontalSliderPage.getMiddlePosition();
        endPosition = horizontalSliderPage.getEndPosition();
    }

    @Test
    public void shouldHorizontalSliderMoveWhenKeyboardArrowButtonsArePressed() {
        BigDecimal position;
        logStep("Move slider to start position: " + startPosition);
        horizontalSliderPage.setSliderPositionTo(startPosition, HorizontalSliderElement.KEYBOARD);
        assertEquals("Fail to set horizontal sliders position", startPosition,
                horizontalSliderPage.getCurrentPosition());

        logStep("Move slider to middle position: " + middlePosition);
        horizontalSliderPage.setSliderPositionTo(middlePosition, HorizontalSliderElement.KEYBOARD);
        assertEquals("Fail to set horizontal sliders position",
                horizontalSliderPage.verifyAndCorrectPositionValue(middlePosition),
                horizontalSliderPage.getCurrentPosition());

        logStep("Move slider to end position: " + endPosition);
        horizontalSliderPage.setSliderPositionTo(endPosition, HorizontalSliderElement.KEYBOARD);
        assertEquals("Fail to set horizontal sliders position", endPosition,
                horizontalSliderPage.getCurrentPosition());

        position = startPosition.subtract(BigDecimal.ONE);
        logStep("Move slider to position before start position: " + position);
        horizontalSliderPage.setSliderPositionTo(position, HorizontalSliderElement.KEYBOARD);
        assertEquals("Fail to set horizontal sliders position", startPosition,
                horizontalSliderPage.getCurrentPosition());

        position = endPosition.add(BigDecimal.ONE);
        logStep("Move slider to position after end position: " + position);
        horizontalSliderPage.setSliderPositionTo(position, HorizontalSliderElement.KEYBOARD);
        assertEquals("Fail to set horizontal sliders position", endPosition,
                horizontalSliderPage.getCurrentPosition());

        position = middlePosition.divide(new BigDecimal(2));
        logStep("Move slider to improperly defined position: " + position);
        horizontalSliderPage.setSliderPositionTo(position, HorizontalSliderElement.KEYBOARD);
        assertEquals("Fail to set horizontal sliders position",
                horizontalSliderPage.verifyAndCorrectPositionValue(position),
                horizontalSliderPage.getCurrentPosition());

        position = new BigDecimal(new BigInteger("233234"), 5);
        logStep("Move slider to improperly defined random position: " + position);
        horizontalSliderPage.setSliderPositionTo(position, HorizontalSliderElement.KEYBOARD);
        assertEquals("Fail to set horizontal sliders position",
                horizontalSliderPage.verifyAndCorrectPositionValue(position),
                horizontalSliderPage.getCurrentPosition());

        logStep("Move slider back to start position: " + startPosition);
        horizontalSliderPage.setSliderPositionTo(startPosition, HorizontalSliderElement.KEYBOARD);
        assertEquals("Fail to set horizontal sliders position", startPosition,
                horizontalSliderPage.getCurrentPosition());
    }

    @Test
    public void shouldHorizontalSliderMoveWhenMouseButtonIsPressedAndMouseIsMoving() {
        BigDecimal position;
        logStep("Move slider to start position: " + startPosition);
        horizontalSliderPage.setSliderPositionTo(startPosition, HorizontalSliderElement.MOUSE);
        assertEquals("Fail to set horizontal sliders position", startPosition,
                horizontalSliderPage.getCurrentPosition());

        logStep("Move slider to middle position: " + middlePosition);
        horizontalSliderPage.setSliderPositionTo(middlePosition, HorizontalSliderElement.MOUSE);
        assertEquals("Fail to set horizontal sliders position",
                horizontalSliderPage.verifyAndCorrectPositionValue(middlePosition),
                horizontalSliderPage.getCurrentPosition());

        logStep("Move slider to end position: " + endPosition);
        horizontalSliderPage.setSliderPositionTo(endPosition, HorizontalSliderElement.MOUSE);
        assertEquals("Fail to set horizontal sliders position", endPosition,
                horizontalSliderPage.getCurrentPosition());

        position = startPosition.subtract(BigDecimal.ONE);
        logStep("Move slider to position before start position: " + position);
        horizontalSliderPage.setSliderPositionTo(position, HorizontalSliderElement.MOUSE);
        assertEquals("Fail to set horizontal sliders position", startPosition,
                horizontalSliderPage.getCurrentPosition());

        position = endPosition.add(BigDecimal.ONE);
        logStep("Move slider to position after end position: " + position);
        horizontalSliderPage.setSliderPositionTo(position, HorizontalSliderElement.MOUSE);
        assertEquals("Fail to set horizontal sliders position", endPosition,
                horizontalSliderPage.getCurrentPosition());

        position = middlePosition.divide(new BigDecimal(2));
        logStep("Move slider to improperly defined position: " + position);
        horizontalSliderPage.setSliderPositionTo(position, HorizontalSliderElement.MOUSE);
        assertEquals("Fail to set horizontal sliders position",
                horizontalSliderPage.verifyAndCorrectPositionValue(position),
                horizontalSliderPage.getCurrentPosition());

        position = new BigDecimal(new BigInteger("212348"), 5);
        logStep("Move slider to improperly defined random position: " + position);
        horizontalSliderPage.setSliderPositionTo(position, HorizontalSliderElement.MOUSE);
        assertEquals("Fail to set horizontal sliders position",
                horizontalSliderPage.verifyAndCorrectPositionValue(position),
                horizontalSliderPage.getCurrentPosition());

        logStep("Move slider back to start position: " + startPosition);
        horizontalSliderPage.setSliderPositionTo(startPosition, HorizontalSliderElement.MOUSE);
        assertEquals("Fail to set horizontal sliders position", startPosition,
                horizontalSliderPage.getCurrentPosition());
    }
}</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example54.png" alt="example54">
</div>
</div>
<div class="paragraph">
<p>This example shows how to sort and read data from tables.</p>
</div>
<div class="paragraph">
<p>After clicking on a column header, the data will be sorted descending and after another click sorted ascending by selected attribute. Watch how both tables' content changes on page DOM. Sorting is performed by JavaScript functions.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example55.png" alt="example55">
</div>
</div>
</div>
<div class="sect6">
<h7 id="page-class-20"><a class="anchor" href="#page-class-20"></a>== Page Class</h7>
<div class="listingblock">
<div class="content">
<pre>public class SortableDataTablesPage extends BasePage {

    private static final By selectorTable  = By.cssSelector("table.tablesorter");
    private static final By selectorHeader = By.cssSelector("th");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.SORTABLE_DATA_TABLES.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Data Tables' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.SORTABLE_DATA_TABLES.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Sorts data in given column using ascending order.
     *
     * @param columnNumber The number of column where data should be sorted
     * @param tableNumber  The number of table where data should be sorted
     */
    public void sortColumnAscending(int columnNumber, int tableNumber) {
        WebElement header = this.getTableHeaders(columnNumber, tableNumber);
        String className = header.getAttribute("class");
        if (className.contains("headerSortUp") || !className.contains("headerSortDown")) {
            header.click();
        }
    }

    /**
     * Sorts data in given column using descending order.
     *
     * @param columnNumber The number of the column where data should be sorted
     * @param tableNumber  The number of the table where data should be sorted
     */
    public void sortColumnDescending(int columnNumber, int tableNumber) {
        WebElement header = this.getTableHeaders(columnNumber, tableNumber);
        String className = header.getAttribute("class");
        if (!className.contains("headerSortUp")) {
            header.click();
            if (!className.contains("headerSortDown")) {
                header.click();
            }
        }
    }

    /**
     * Return given column values from chosen table.
     *
     * @param columnNumber The number of the column the data should be retrieved from
     * @param tableNumber  The number of the table the data should be retrieved from
     * @return list of values from given column
     */
    public List&lt;String&gt; getColumnValues(int columnNumber, int tableNumber) {
        WebElement table = getTable(tableNumber);
        return JsoupHelper.findTexts(table, By.cssSelector("tr &gt; td:nth-child(" + (columnNumber + 1)
                + ")"));
    }

    /**
     * Returns column's class name.
     *
     * @param columnNumber The number of the column to get class number from
     * @param tableNumber  The number of the table to get column class name from
     * @return String object representing column's class name
     */
    public String readColumnClass(int columnNumber, int tableNumber) {
        return this.getTableHeaders(columnNumber, tableNumber)
                .getAttribute("class");
    }

    private WebElement getTable(int tableNumber) {
        return new ListElements(selectorTable).getList()
                .get(tableNumber);
    }

    private WebElement getTableHeaders(int columnNumber, int tableNumber) {
        return getTable(tableNumber).findElements(selectorHeader)
                .get(columnNumber);
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="finding-values"><a class="anchor" href="#finding-values"></a>== ==  Finding values</h7>
<div class="paragraph">
<p>Using proper selectors, save elements such as tables and their columns' headers as Web Element Lists. Afterwards, you can get the desired element finding it by index (e. g. table or column number). To get column values, use <code>JsoupHelper</code> and to check if the column is sorted get its class attribute.</p>
</div>
</div>
<div class="sect6">
<h7 id="test-class-19"><a class="anchor" href="#test-class-19"></a>== Test Class</h7>
<div class="paragraph">
<p>Before all tests: Open The Internet Main Page</p>
</div>
<div class="paragraph">
<p>Before each case: Go to Sortable Data Tables Page</p>
</div>
<div class="paragraph">
<p>Case 1:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Choose a random table</p>
</li>
<li>
<p>Sort first column "Last Name" in ascending order</p>
</li>
<li>
<p>Check if column header class contains "headerSortDown"</p>
</li>
<li>
<p>Save column content to the List</p>
</li>
<li>
<p>Create List copy and sort it</p>
</li>
<li>
<p>Compare sorted values and values from the table</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Case 2:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Choose a random table</p>
</li>
<li>
<p>Sort second column "First Name" in descending order</p>
</li>
<li>
<p>Check if column header class contains "headerSortUp"</p>
</li>
<li>
<p>Save column content to the List</p>
</li>
<li>
<p>Create List copy and sort it then reverse it</p>
</li>
<li>
<p>Compare reversed sorted values and values from the table</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class SortableDataTablesTest extends TheInternetBaseTest {

    private static SortableDataTablesPage sortableDataTablesPage;

    private List&lt;String&gt; actualValues;
    private List&lt;String&gt; expectedValues;

    @BeforeClass
    public static void setUpBeforeClass() {
        logStep("Open the Url http://the-internet.herokuapp.com/");
        theInternetPage = new TheInternetPage();
        theInternetPage.load();

        logStep("Verify if Url http://the-internet.herokuapp.com/ is opened");
        assertTrue("Unable to load The Internet Page", theInternetPage.isLoaded());
    }

    @Override
    public void setUp() {
        logStep("Click subpage link");
        sortableDataTablesPage = theInternetPage.clickSortableDataTablesLink();

        logStep("Verify if subpage is opened");
        assertTrue("Unable to open Sortable Data Tables page", sortableDataTablesPage.isLoaded());
    }

    @Test
    public void shouldLastNameColumnBeOrderedAscendingAfterSort() {
        int columnNumber = 0;
        int tableNumber = new Random().nextInt(2);

        logStep("Sort 'Last Name' column");
        sortableDataTablesPage.sortColumnAscending(columnNumber, tableNumber);
        assertTrue("Unable to set ascending order for 'Last Name' column",
                sortableDataTablesPage.readColumnClass(columnNumber, tableNumber)
                        .contains("headerSortDown"));

        logStep("Verify data order for 'Last Name' column");
        actualValues = sortableDataTablesPage.getColumnValues(columnNumber, tableNumber);
        expectedValues = new ArrayList&lt;String&gt;(actualValues);
        Collections.sort(expectedValues);
        assertEquals("'Last Name' column is not sorted in ascending order",
                expectedValues, actualValues);
    }

    @Test
    public void shouldFirstNameColumnBeOrderedDescendingAfterSort() {
        int columnNumber = 1;
        int tableNumber = new Random().nextInt(2);

        logStep("Sort 'First Name' column");
        sortableDataTablesPage.sortColumnDescending(columnNumber, tableNumber);
        assertTrue("Unable to set descending order for 'First Name' column",
                sortableDataTablesPage.readColumnClass(columnNumber, tableNumber)
                        .contains("headerSortUp"));

        logStep("Verify data order for 'First Name' column");
        actualValues = sortableDataTablesPage.getColumnValues(columnNumber, tableNumber);
        expectedValues = new ArrayList&lt;String&gt;(actualValues);
        Collections.sort(expectedValues);
        Collections.reverse(expectedValues);
        assertEquals("'First Name' column is not sorted in descending order",
                expectedValues, actualValues);
    }
}</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example56.png" alt="example56">
</div>
</div>
<div class="paragraph">
<p>This example shows how to process HTTP status codes returned by page</p>
</div>
<div class="paragraph">
<p>When you click status code link, you will be redirected to the subpage which returns the proper HTTP status code. In order to check what code was returned:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open developer tools</p>
</li>
<li>
<p>Go to Network tab</p>
</li>
<li>
<p>Click request name</p>
</li>
<li>
<p>Find a code number in Headers section</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/example57.png" alt="example57">
</div>
</div>
</div>
<div class="sect6">
<h7 id="page-class-21"><a class="anchor" href="#page-class-21"></a>== Page Class</h7>
<div class="paragraph">
<p>Add new methods to existing Status Codes Home Page Class</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class StatusCodesHomePage extends BasePage {

    private static final By selectorLink200Code = By.linkText("200");
    private static final By selectorLink301Code = By.linkText("301");
    private static final By selectorLink404Code = By.linkText("404");
    private static final By selectorLink500Code = By.linkText("500");

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.STATUS_CODES.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Status Codes' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.STATUS_CODES.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    /**
     * Verifies if given link is displayed.
     *
     * @param selector Selector of the given link
     * @return true if link is displayed
     */
    public boolean isLinkCodeDisplayed(By selector) {
        return getDriver().findElementDynamic(selector)
                .isDisplayed();

    }

    /**
     * Clicks '200' link.
     *
     * @return StatusCodesCodePage object
     */
    public StatusCodesCodePage clickCode200Link() {
        return clickCodeLink(selectorLink200Code);
    }

    /**
     * Clicks '301' link.
     *
     * @return StatusCodesCodePage object
     */
    public StatusCodesCodePage clickCode301Link() {
        return clickCodeLink(selectorLink301Code);
    }

    /**
     * Clicks '404' link.
     *
     * @return StatusCodesCodePage object
     */
    public StatusCodesCodePage clickCode404Link() {
        return clickCodeLink(selectorLink404Code);
    }

    /**
     * Clicks '500' link.
     *
     * @return StatusCodesCodePage object
     */
    public StatusCodesCodePage clickCode500Link() {
        return clickCodeLink(selectorLink500Code);
    }

    /**
     * Clicks code link according to given code number.
     *
     * @param code Given code
     * @return StatusCodesCodePage object
     */
    public StatusCodesCodePage clickCodeLink(String code) {
        return clickCodeLink(By.linkText(code));
    }

    private StatusCodesCodePage clickCodeLink(By selector) {
        String codeNumber = getCodeNumberToCheck(selector);
        getDriver().findElementDynamic(selector)
                .click();
        return new StatusCodesCodePage(codeNumber);
    }

    private String getCodeNumberToCheck(By selector) {
        return getDriver().findElementDynamic(selector)
                .getText();
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Create a page class for status codes subpages as well. In the class constructor specify which code number should be returned.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class StatusCodesCodePage extends BasePage {

    private static final By selectorDisplayedText   = By.cssSelector("#content &gt; div &gt; p");
    private static final By selectorLinkToCodesPage = By.cssSelector("#content &gt; div &gt; p &gt; a");

    private String codeNumber;

    public StatusCodesCodePage(String codeNumber) {
        this.codeNumber = codeNumber;
    }

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded();
        return getDriver().getCurrentUrl()
                .contains(PageSubURLsProjectYEnum.STATUS_CODES.getValue() + '/');
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'Status Codes' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.STATUS_CODES.getValue() + '/' + codeNumber);
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }

    public String getCodeNumber() {
        return codeNumber;
    }

    /**
     * Verifies if page is loaded with given code number.
     *
     * @param codeNumber Expected code number
     * @return true if expected code number is loaded with web page
     */
    public boolean isLoadedWithStatusCode(String codeNumber) {
        return getDriver().getCurrentUrl()
                .equals(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue() +
                PageSubURLsProjectYEnum.STATUS_CODES.getValue() + "/" + codeNumber);
    }

    /**
     * Returns displayed code number.
     * &lt;p&gt;
     * Code number is retrieved from following text displayed on the page:&lt;b&gt;
     * 'This page returned a *** status code.', where *** represent the code number to be
     * returned.
     * &lt;/p&gt;
     *
     * @return String object representing the displayed code number retrieved from specific sentence.
     */
    public String getDisplayedCodeNumber() {
        return getDriver().findElementDynamic(selectorDisplayedText)
                .getText()
                .substring(21, 24);
    }

    /**
     * Clicks link to return to 'Code Page'.
     *
     * @return StatusCodesHomePage object
     */
    public StatusCodesHomePage clickLinkToCodePage() {
        getDriver().findElementDynamic(selectorLinkToCodesPage)
                .click();
        return new StatusCodesHomePage();
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="test-class-20"><a class="anchor" href="#test-class-20"></a>== Test Class</h7>
<div class="paragraph">
<p>Before all tests: Open The Internet Main Page, go to Status Codes page</p>
</div>
<div class="paragraph">
<p>Steps:</p>
</div>
<div class="paragraph">
<p>For each status code</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click code link</p>
</li>
<li>
<p>Check if the page is loaded with an expected code number</p>
</li>
<li>
<p>Check if the displayed code number equals the expected number</p>
</li>
<li>
<p>Go back to Status Codes Home Page</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>@Category({ TestsSelenium.class, TestsChrome.class, TestsFirefox.class, TestsIE.class })
public class StatusCodeTest extends TheInternetBaseTest {

    private static StatusCodesHomePage statusCodesHomePage;
    private        StatusCodesCodePage statusCodesCodePage;

    private String[] codes = { "200", "301", "404", "500" };

    @BeforeClass
    public static void setUpBeforeClass() {
        statusCodesHomePage = shouldTheInternetPageBeOpened().clickStatusCodesLink();

        logStep("Verify if Status Codes Home page is opened");
        assertTrue("Unable to open Status Codes Home page", statusCodesHomePage.isLoaded());
    }

    @Test
    public void shouldProperCodeBeDisplayedAfterClickCodeLink() {

        for (String code : codes) {
            logStep("Click link to " + code + " code");
            statusCodesCodePage = statusCodesHomePage.clickCodeLink(code);

            logStep("Verify if proper web page corresponding to the code is opened");
            assertTrue("Unable to open proper web page",
                    statusCodesCodePage.isLoadedWithStatusCode(code));

            logStep("Verify if the displayed code is equal to the expected one");
            assertEquals(code, statusCodesCodePage.getDisplayedCodeNumber());

            logStep("Click link to come back to 'Status Codes' page");
            statusCodesCodePage.clickLinkToCodePage();
        }
    }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="first-steps"><a class="anchor" href="#first-steps"></a>26.27. ==  First Steps</h3>
<div class="sect6">
<h7 id="page-object"><a class="anchor" href="#page-object"></a>Page Object</h7>
<div class="paragraph">
<p>Your Product Under Test will be the following website: <a href="http://the-internet.herokuapp.com/" class="bare">http://the-internet.herokuapp.com/</a></p>
</div>
<div class="paragraph">
<p>At first, create an Object to represent The Internet Main Page:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class TheInternetPage extends BasePage</pre>
</div>
</div>
<div class="paragraph">
<p>Each class which extends BasePage class must override three methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>public boolean isLoaded()</code> - returns true if the page is loaded and false if not</p>
</li>
<li>
<p><code>public void load()</code> - loads the page</p>
</li>
<li>
<p><code>public String pageTitle()</code> - returns page title</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>public class TheInternetPage extends BasePage {

    @Override
    public boolean isLoaded() {
        BFLogger.logDebug("The internet page is loaded: " + getDriver().getCurrentUrl());
        return getDriver().getCurrentUrl()
                .equals(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue());
    }

    @Override
    public void load() {
        BFLogger.logDebug("Load 'The internet' page.");
        getDriver().get(GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue());
        getDriver().waitForPageLoaded();
    }

    @Override
    public String pageTitle() {
        return getActualPageTitle();
    }
}</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="environment-variables-2"><a class="anchor" href="#environment-variables-2"></a>Environment Variables</h7>
<div class="paragraph">
<p>In Page classes, when you load/start web, it is uncommon to save fixed main URL.</p>
</div>
<div class="paragraph">
<p>Instead of <em>hardcoded</em> main URL variable, you build your Page class with a dynamic variable.</p>
</div>
</div>
<div class="sect6">
<h7 id="how-to-create-update-system-environment-3"><a class="anchor" href="#how-to-create-update-system-environment-3"></a>How to create / update system environment</h7>
<div class="paragraph">
<p>Dynamic variable values are stored under path <em>\src\resources\enviroments\environments.csv</em>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image1.png" alt="image1">
</div>
</div>
<div class="paragraph">
<p>By default, the environment takes value from DEV column.</p>
</div>
</div>
<div class="sect6">
<h7 id="access-to-the-external-file-variables"><a class="anchor" href="#access-to-the-external-file-variables"></a>==  Access to the external file variables</h7>
<div class="paragraph">
<p>Create a class <em>GetEnvironmentParam</em> to map values from an external file with Page class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public enum GetEnvironmentParam {

    // Name if enum must be in line with cell name in /src/resources/environments/environment.csv
    WWW_FONT_URL,
    TOOLS_QA,
    WEB_SERVICE,
    THE_INTERNET_MAIN_PAGE,
    ELEMENTAL_SELENIUM_PAGE;

    public String getValue() {

        if (null ==  BaseTest.getEnvironmentService()) {
            throw new BFInputDataException("Environment Parameters class wasn't initialized properly");
        }

        return BaseTest.getEnvironmentService()
                .getValue(this.name());

    }

    @Override
    public String toString() {

        return this.getValue();

    }
}</pre>
</div>
</div>
<div class="paragraph">
<p>When you add a new row to <em>environments.csv</em> also add a new variable to <em>GetEnvironmentParam</em> class.</p>
</div>
<div class="paragraph">
<p>In Page class access environmental variable using this method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>GetEnvironmentParam.THE_INTERNET_MAIN_PAGE.getValue();</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="selectors"><a class="anchor" href="#selectors"></a>Selectors</h7>

</div>
<div class="sect6">
<h7 id="create-selectors"><a class="anchor" href="#create-selectors"></a>Create selectors</h7>
<div class="paragraph">
<p>Create a selector for every interactable element on a webpage using By type. Find elements and it&#8217;s attributes using browser developer mode (F12).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image2.png" alt="image2">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>private static final By abTestLinkSelector               = By.cssSelector("li &gt;
            a[href*='abtest']");
    private static final By basicAuthLinkSelector            = By.cssSelector("li &gt;
            a[href*='basic_auth']");
    private static final By brokenImageLinkSelector          = By.cssSelector("li &gt;
            a[href*='broken_images']");
    private static final By challengingDomLinkSelector       = By.cssSelector("li &gt;
            a[href*='challenging_dom']");
    private static final By checkboxesLinkSelector           = By.cssSelector("li &gt;
            a[href*='checkboxes']");
    private static final By contextMenuLinkSelector          = By.cssSelector("li &gt;
            a[href*='context_menu']");
    private static final By disappearingElementsLinkSelector = By.cssSelector("li &gt;
            a[href*='disappearing_elements']");
    private static final By dragAndDropLinkSelector          = By.cssSelector("li &gt;
            a[href*='drag_and_drop']");
    private static final By dropdownLinkSelector             = By.cssSelector("li &gt;
            a[href*='dropdown']");
    private static final By dynamicContentLinkSelector       = By.cssSelector("li &gt;
            a[href*='dynamic_content']");
    private static final By dynamicControlsLinkSelector      = By.cssSelector("li &gt;
            a[href*='dynamic_controls']");
    private static final By dynamicLoadingLinkSelector       = By.cssSelector("li &gt;
            a[href*='dynamic_loading']");
    private static final By exitIntentLinkSelector           = By.cssSelector("li &gt;
            a[href*='exit_intent']");
    private static final By fileDownloadLinkSelector         = By.cssSelector("li &gt;
            a[href$='download']");
    private static final By fileUploadLinkSelector           = By.cssSelector("li &gt;
           a[href*='upload']");
    private static final By floatingMenuLinkSelector         = By.cssSelector("li &gt;
           a[href*='floating_menu']");
    private static final By forgotPasswordLinkSelector       = By.cssSelector("li &gt;
           a[href*='forgot_password']");
    private static final By formAuthenticationLinkSelector   = By.cssSelector("li &gt;
           a[href*='login']");
    private static final By framesLinkSelector               = By.cssSelector("li &gt;
           a[href*='frames']");
    private static final By geolocationLinkSelector          = By.cssSelector("li &gt;
           a[href*='geolocation']");
    private static final By horizontalSliderLinkSelector     = By.cssSelector("li &gt;
           a[href*='horizontal_slider']");
    private static final By hoversLinkSelector               = By.cssSelector("li &gt;
           a[href*='hovers']");
    private static final By infiniteScrollLinkSelector       = By.cssSelector("li &gt;
           a[href*='infinite_scroll']");
    private static final By javaScriptAlertLinkSelector      = By.cssSelector("li &gt;
           a[href*='javascript_alerts']");
    private static final By javaScriptErrorLinkSelector      = By.cssSelector("li &gt;
           a[href*='javascript_error']");
    private static final By jQueryUIMenuLinkSelector         = By.cssSelector("li &gt;
           a[href*='jqueryui/menu']");
    private static final By keyPressesLinkSelector           = By.cssSelector("li &gt;
           a[href*='key_presses']");
    private static final By largeAndDeepDOMLinkSelector      = By.cssSelector("li &gt;
           a[href*='large']");
    private static final By multipleWindowsLinkSelector      = By.cssSelector("li &gt;
           a[href*='windows']");
    private static final By nestedFramesLinkSelector         = By.cssSelector("li &gt;
           a[href*='nested_frames']");
    private static final By notificationMessagesLinkSelector = By.cssSelector("li &gt;
           a[href*='notification_message']");
    private static final By redirectLinkSelector             = By.cssSelector("li &gt;
           a[href*='redirector']");
    private static final By secureFileDownloadLinkSelector   = By.cssSelector("li &gt;
           a[href*='download_secure']");
    private static final By shiftingContentLinkSelector      = By.cssSelector("li &gt;
           a[href*='shifting_content']");
    private static final By slowResourcesLinkSelector        = By.cssSelector("li &gt;
           a[href*='slow']");
    private static final By sortableDataTablesLinkSelector   = By.cssSelector("li &gt;
           a[href*='tables']");
    private static final By statusCodesLinkSelector          = By.cssSelector("li &gt;
           a[href*='status_codes']");
    private static final By typosLinkSelector                = By.cssSelector("li &gt;
           a[href*='typos']");
    private static final By wYSIWYGEditorLinkSelector        = By.cssSelector("li &gt;
           a[href*='tinymce']");</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="implement-methods"><a class="anchor" href="#implement-methods"></a>Implement methods</h7>
<div class="paragraph">
<p>Then use these selectors to create Objects and perform actions on page elements:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public ABtestPage clickABtestingLink() {
        new Button(abTestLinkSelector).click();
        return new ABtestPage();
    }

    public BasicAuthPage clickBasicAuthLink() {
        getDriver().waitForPageLoaded();
        WebElement link = getDriver().findElementDynamic(basicAuthLinkSelector);
        JavascriptExecutor executor = (JavascriptExecutor) getDriver();
        executor.executeScript("var elem=arguments[0]; setTimeout(function() {elem.click();}, 100)",
                link);
        return new BasicAuthPage();
    }

    public BrokenImagePage clickBrokenImageLink() {
        new Button(brokenImageLinkSelector).click();
        return new BrokenImagePage();
    }

    public ChallengingDomPage clickChallengingDomLink() {
        new Button(challengingDomLinkSelector).click();
        return new ChallengingDomPage();
    }

    public CheckboxesPage clickCheckboxesLink() {
        new Button(checkboxesLinkSelector).click();
        return new CheckboxesPage();
    }

    public ContextMenuPage clickContextMenuLink() {
        new Button(contextMenuLinkSelector).click();
        return new ContextMenuPage();
    }

    public DisappearingElementsPage clickDisappearingElementsLink() {
        new Button(disappearingElementsLinkSelector).click();
        return new DisappearingElementsPage();
    }

    public DragAndDropPage clickDragAndDropLink() {
        new Button(dragAndDropLinkSelector).click();
        return new DragAndDropPage();
    }

    public DropdownPage clickDropdownLink() {
        new Button(dropdownLinkSelector).click();
        return new DropdownPage();
    }

    public DynamicContentPage clickDynamicContentLink() {
        new Button(dynamicContentLinkSelector).click();
        return new DynamicContentPage();
    }

    public DynamicControlsPage clickDynamicControlsLink() {
        new Button(dynamicControlsLinkSelector).click();
        return new DynamicControlsPage();
    }

    public DynamicLoadingPage clickDynamicLoadingLink() {
        new Button(dynamicLoadingLinkSelector).click();
        return new DynamicLoadingPage();
    }

    public ExitIntentPage clickExitIntentLink() {
        new Button(exitIntentLinkSelector).click();
        return new ExitIntentPage();
    }

    public FileDownloadPage clickFileDownloadLink() {
        new Button(fileDownloadLinkSelector).click();
        return new FileDownloadPage();
    }

    public FileUploadPage clickFileUploadLink() {
        new Button(fileUploadLinkSelector).click();
        return new FileUploadPage();
    }

    public FloatingMenuPage clickFloatingMenuLink() {
        new Button(floatingMenuLinkSelector).click();
        return new FloatingMenuPage();
    }

    public ForgotPasswordPage clickForgotPasswordLink() {
        new Button(forgotPasswordLinkSelector).click();
        return new ForgotPasswordPage();
    }

    public FormAuthenticationPage clickFormAuthenticationLink() {
        new Button(formAuthenticationLinkSelector).click();
        return new FormAuthenticationPage();
    }

    public FramesPage clickFramesLink() {
        new Button(framesLinkSelector).click();
        return new FramesPage();
    }

    public GeolocationPage clickGeolocationLink() {
        new Button(geolocationLinkSelector).click();
        return new GeolocationPage();
    }

    public HorizontalSliderPage clickHorizontalSliderLink() {
        new Button(horizontalSliderLinkSelector).click();
        return new HorizontalSliderPage();
    }

    public HoversPage clickHoversLink() {
        new Button(hoversLinkSelector).click();
        return new HoversPage();
    }

    public InfiniteScrollPage clickInfiniteScrollLink() {
        new Button(infiniteScrollLinkSelector).click();
        return new InfiniteScrollPage();
    }

    public JavaScriptAlertsPage clickJavaScriptAlertLink() {
        new Button(javaScriptAlertLinkSelector).click();
        return new JavaScriptAlertsPage();
    }

    public JavaScriptErrorPage clickJavaScriptErrorLink() {
        new Button(javaScriptErrorLinkSelector).click();
        return new JavaScriptErrorPage();
    }

    public JQueryUIMenuPage clickJQueryUIMenuLink() {
        new Button(jQueryUIMenuLinkSelector).click();
        return new JQueryUIMenuPage();
    }

    public KeyPressesPage clickKeyPressesLink() {
        new Button(keyPressesLinkSelector).click();
        return new KeyPressesPage();
    }

    public LargeAndDeepDOMPage clickLargeAndDeepDOMLink() {
        new Button(largeAndDeepDOMLinkSelector).click();
        return new LargeAndDeepDOMPage();
    }

    public MultipleWindowsPage clickmultipleWindowsLink() {
        new Button(multipleWindowsLinkSelector).click();
        return new MultipleWindowsPage();
    }

    public NestedFramesPage clickNestedFramesLink() {
        new Button(nestedFramesLinkSelector).click();
        return new NestedFramesPage();
    }

    public NotificationMessagesPage clickNotificationMessagesLink() {
        new Button(notificationMessagesLinkSelector).click();
        return new NotificationMessagesPage();
    }

    public RedirectLinkPage clickRedirectLink() {
        new Button(redirectLinkSelector).click();
        return new RedirectLinkPage();
    }

    public SecureFileDownloadPage clickSecureFileDownloadLink() {
        new Button(secureFileDownloadLinkSelector).click();
        return new SecureFileDownloadPage();
    }

    public ShiftingContentPage clickShiftingContentLink() {
        new Button(shiftingContentLinkSelector).click();
        return new ShiftingContentPage();
    }

    public SlowResourcesPage clickSlowResourcesLink() {
        new Button(slowResourcesLinkSelector).click();
        return new SlowResourcesPage();
    }

    public SortableDataTablesPage clickSortableDataTablesLink() {
        new Button(sortableDataTablesLinkSelector).click();
        return new SortableDataTablesPage();
    }

    public StatusCodesHomePage clickStatusCodesLink() {
        new Button(statusCodesLinkSelector).click();
        return new StatusCodesHomePage();
    }

    public TyposPage clickTyposLink() {
        new Button(typosLinkSelector).click();
        return new TyposPage();
    }

    public WYSIWYGEditorPage clickWYSIWYGEditorLink() {
        new Button(wYSIWYGEditorLinkSelector).click();
        return new WYSIWYGEditorPage();
    }</pre>
</div>
</div>
<div class="paragraph">
<p>These methods create a Button object for every link on The Internet Page and click it to redirect on a different subpage.</p>
</div>
</div>
<div class="sect6">
<h7 id="elements-types"><a class="anchor" href="#elements-types"></a>Elements types</h7>
<div class="paragraph">
<p>MrChecker includes Object types for various elements existing on webpages such as Button, TextBox etc. There is also WebElement class and <code>getDriver().findElementDynamic(By selector)</code> method for creating webpage objects dynamically and performing basic actions:</p>
</div>
<div class="paragraph">
<p>Instead of using static types you can use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    public TyposPage clickTyposLink() {
        WebElement checkboxesLink = getDriver().findElementDynamic(checkboxesLinkSelector);
        checkboxesLink.click();
        return new TyposPage();
    }</pre>
</div>
</div>
<div class="paragraph">
<p>Or perform actions without creating a variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    public TyposPage clickTyposLink() {
        getDriver().findElementDynamic(checkboxesLinkSelector).click();
        return new TyposPage();
    }</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="the-internet-base-test"><a class="anchor" href="#the-internet-base-test"></a>The Internet Base Test</h7>

</div>
<div class="sect6">
<h7 id="test-class-21"><a class="anchor" href="#test-class-21"></a>Test Class</h7>
<div class="paragraph">
<p>Create Test class and override methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>public void setUp()</code> - executes before each test</p>
</li>
<li>
<p><code>public void tearDown()</code> - executes after each test</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>public class TheInternetBaseTest extends BaseTest {
    @Override
    public void setUp() {

    }

    @Override
    public void tearDown() {
        logStep("Navigate back to The-Internet page");
        BasePage.navigateBack();
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p><code>logStep(String message)</code> method doesn&#8217;t exist yet so you should create it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    protected static int             step = 0;

     /**
     * Logs test step including step number calculated individually for each test.
     *
     * @param message Text message representing step description.
     */
    public static void logStep(String message) {
        BFLogger.logInfo("Step " + ++step + ": " + message);
    }</pre>
</div>
</div>
<div class="paragraph">
<p>Write a method for loading The Internet Page and checking if it is properly opened:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    protected static TheInternetPage theInternetPage;

    /**
     * Performs operations required for verifying if The Internet Page is properly opened.
     *
     * @return TheInternetPage
     */
    public static TheInternetPage shouldTheInternetPageBeOpened() {

        logStep("Open the Url http://the-internet.herokuapp.com/");
        theInternetPage = new TheInternetPage();
        theInternetPage.load();

        logStep("Verify if Url http://the-internet.herokuapp.com/ is opened");
        assertTrue("Unable to load The Internet Page", theInternetPage.isLoaded());

        return theInternetPage;
    }</pre>
</div>
</div>
<div class="paragraph">
<p>This Test class can&#8217;t be launched because it doesn&#8217;t contain any @Test methods. It&#8217;s been created only for supporting other Test classes.</p>
</div>
</div>
<div class="sect6">
<h7 id="bflogger"><a class="anchor" href="#bflogger"></a>BFLogger</h7>
<div class="paragraph">
<p>BFLogger is a default MrChecker logging tool. Use it to communicate important information from test execution. There are three basic logging methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>logInfo(String message)</code> - used for test steps</p>
</li>
<li>
<p><code>logDebug(String message)</code> - used for non-official information, either during the test build process or in Page Object files</p>
</li>
<li>
<p><code>logError(String message)</code> - used to emphasize critical information</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Logs will be visible in the console and in the log file under path: MrChecker_Test_Framework\workspace\project-folder\logs</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="e2e-tutorials"><a class="anchor" href="#e2e-tutorials"></a>26.28. E2E Tutorials</h3>
<!-- toc disabled -->
<div class="sect5">
<h6 id="mrchecker-e2e-tutorials"><a class="anchor" href="#mrchecker-e2e-tutorials"></a>MrChecker E2E tutorials</h6>
<div class="paragraph">
<p>In order to learn more about MrChecker structure, start from Project Organisation section and then check out our fantastic tutorials:</p>
</div>
</div>
<div class="sect5">
<h6 id="how-to-create-a-basic-test-in-mrchecker"><a class="anchor" href="#how-to-create-a-basic-test-in-mrchecker"></a>How to create a basic test in MrChecker</h6>

</div>
<div class="sect5">
<h6 id="example-booking-a-table"><a class="anchor" href="#example-booking-a-table"></a>Example: Booking a table</h6>
<div class="paragraph">
<p>As an example to test we will use <a href="https://mts-devonfw-core.cloud.okteto.net/bookTable">MyThaiStar</a> booking page.<br>
In order to book a table, do the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open MyThaiStar Book Table Page</p>
</li>
<li>
<p>Enter booking data: Date and time, Name, Email and number of Table guests</p>
</li>
<li>
<p>Click Accept terms</p>
</li>
<li>
<p>Click Book table</p>
</li>
<li>
<p>Display confirmation box and send booking</p>
</li>
<li>
<p>Check if the booking was successful.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image1.png" alt="image1">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image2.png" alt="image2">
</div>
</div>
<div class="paragraph">
<p>You can go through these steps manually and doublecheck the result.</p>
</div>
</div>
<div class="sect5">
<h6 id="how-to-prepare-a-test"><a class="anchor" href="#how-to-prepare-a-test"></a>How to prepare a test</h6>

</div>
<div class="sect5">
<h6 id="1-create-booktablepage-class"><a class="anchor" href="#1-create-booktablepage-class"></a>==  1. Create BookTablePage class</h6>
<div class="paragraph">
<p>You will need a class which will represent MyThaiStart booking page.<br>
Fill the required methods with the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class BookTablePage extends BasePage {

    @Override
    public boolean isLoaded() {
        getDriver().waitForPageLoaded(); //waits untli the page is loaded
        return getDriver().getCurrentUrl()
                .equals("https://mts-devonfw-core.cloud.okteto.net/bookTable"); //checks if current page address equals MyThaiStar booking page adress
    }

    @Override
    public void load() {
        getDriver().get("https://mts-devonfw-core.cloud.okteto.net/bookTable"); //loads page under specified adress
        getDriver().waitForPageLoaded(); //waits until the page is loaded
    }

    @Override
    public String pageTitle() {
        return "My Thai Star"; //returns page title
    }
}</pre>
</div>
</div>
<div class="paragraph">
<p><code>getDriver()</code> method allows accessing Selenium Web Driver which performs actions on the webpage.</p>
</div>
<div class="paragraph">
<p>As this page class represents the MyThaiStar booking page, you have to set up selectors for web elements required in the test case. In the example you have to create selectors for elements we’ll interact with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Date and time input field</p>
</li>
<li>
<p>Name input field</p>
</li>
<li>
<p>Email input field</p>
</li>
<li>
<p>Table guests input field</p>
</li>
<li>
<p>Accept terms checkbox</p>
</li>
<li>
<p>Book table button</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Selectors will be implemented as fields.</p>
</div>
<div class="paragraph">
<p>Example of the selector for Date and time input field:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/** Date field search criteria */
private static final By dateSearch = By.cssSelector("input[formcontrolname='bookingDate']");</pre>
</div>
</div>
<div class="paragraph">
<p>The input field&#8217;s name "bookingDate" was found by using the developer console in Google Chrome. <a href="https://github.com/devonfw/devonfw-testing/wiki/documentation/cssSelector.docx">How to prepare an everlasting selector?</a></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image3.png" alt="image3">
</div>
</div>
<div class="paragraph">
<p>This selector can be used to create a WebElement object of the said input field. Therefore, you will create a new method and call it "enterTimeAndDate".</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public void enterTimeAndDate(String date) {
    WebElement dateInput = getDriver().findElementDynamic(dateSearch); //creates a new WebElement to access Date and time input field
    dateInput.sendKeys(date); //enters date value
}</pre>
</div>
</div>
<div class="paragraph">
<p>Now you can create other selectors and objects and methods for every element on the webpage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/** Name input field search criteria */
private static final By nameSearch = By.cssSelector("input[formcontrolname='name']");

/** Email input field search criteria */
private static final By emailSearch = By.cssSelector("input[formcontrolname='email']");

/** Number of guests search criteria */
private static final By guestsSearch = By.cssSelector("input[formcontrolname='assistants']");

/** Check box search criteria */
private static final By checkboxSearch = By.cssSelector("mat-checkbox[data-name='bookTableTerms']");

/** Book table button search criteria */
private static By bookTableSearch = By.name("bookTableSubmit");</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>public void enterName(String name) {
    WebElement nameInput = getDriver().findElementDynamic(nameSearch); //creates a new WebElement to access name input field
    nameInput.sendKeys(name); //enters name value
}

public void enterEmail(String email) {
    WebElement emailInput = getDriver().findElementDynamic(emailSearch); //creates a new WebElement to access email input field
    emailInput.sendKeys(email); //enters email value
}

public void enterGuests(int amountOfGuests) {
    WebElement guestsInput = getDriver().findElementDynamic(guestsSearch); //creates a new WebElement to access amount of guests input field
    guestsInput.sendKeys(Integer.toString(amountOfGuests)); //enters the number of guests value converted from integer to string
}

public void acceptTerms() {
    WebElement checkbox = getDriver().findElementDynamic(checkboxSearch); //creates aa new WebElement to access accept terms checkbox
    WebElement square = checkbox.findElement(By.className("mat-checkbox-inner-container")); //creates a new WebElement to access inner square
    JavascriptExecutor js = (JavascriptExecutor) getDriver(); //creates a Javascript executor object
    js.executeScript("arguments[0].click()", square); //executes a script which clicks the square

}

public void clickBookTable() {
    WebElement buttonbutton = getDriver().findElementDynamic(bookTableSearch); //creates a new WebElement to access book table button
    getDriver().waitUntilElementIsClickable(bookTableSearch); //waits until a button might be clicked
    buttonbutton.click(); //clicks the button
}</pre>
</div>
</div>
<div class="paragraph">
<p>You can use those methods in order to create a new method to go through the whole booking process:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public ConfirmBookPage enterBookingData(String date, String name, String email, int guests) {
    enterTimeAndDate(date);
    enterName(name);
    enterEmail(email);
    enterGuests(guests);
    acceptTerms();

    clickBookTable();

    return new ConfirmBookPage();
}</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="2-create-confirmbookpage-class"><a class="anchor" href="#2-create-confirmbookpage-class"></a>==  2. Create ConfirmBookPage class</h6>
<div class="paragraph">
<p>As you can see, this method returns another page object that has not yet been created. This step is required, as the booking information that you would like to check is on another webpage. This means that you will have to create another page class and call it ConfirmBookPage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>public class ConfirmBookPage extends BasePage {

    /** Confirmation dialog search criteria */
    private static final By confirmationDialogSearch = By.className("mat-dialog-container");

    /** Send confirmation button search criteria */
    private static final By sendButtonSearch = By.name("bookTableConfirm");

    /** Cancel confirmation button search criteria */
    private static final By cancelButtonSearch = By.name("bookTableCancel");

    @Override
    public boolean isLoaded() {
        //creates a new WebElement to access confirmation dialog box
        WebElement confirmationDialog = getDriver().findElementDynamic(confirmationDialogSearch);

        return confirmationDialog.isDisplayed(); //checks if the box is displayed
    }

    //this method won't be called because the page is loaded only after clicking book table button
    @Override
    public void load() {
        BFLogger.logError("MyThaiStar booking confirmation page was not loaded."); //logs error
    }

    @Override
    public String pageTitle() {
        return "My Thai Star";
    }

    public void confirmBookingData() {
        WebElement sendButton = getDriver().findElementDynamic(sendButtonSearch); //creates a new WebElement to access confirmation button
        sendButton.click(); //clicks the send button
    }

    public void cancelBookingData() {
        WebElement cancelButton = getDriver().findElementDynamic(cancelButtonSearch); //creates a new WebElement to access resignation button
        cancelButton.click(); //clicks the cancel button
    }
}</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image4.png" alt="image4">
</div>
</div>
<div class="paragraph">
<p>After the click on Send button - the green confirmation dialogue appears with the message "Table successfully booked":</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image5.png" alt="image5">
</div>
</div>
<div class="paragraph">
<p>To be able to check if the booking was successful, you should go back to the BookTablePage class and add one more method in order to check if the green box was displayed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/** Dialog search criteria */
private static final By dialogSearch = By.className("bgc-green-600");

public boolean checkConfirmationDialog() {
    WebElement greenConfirmationDialog = getDriver().findElementDynamic(dialogSearch); //creates a new WebElement to access confirmation dialog

    return greenConfirmationDialog.isDisplayed(); //checks if the dialog is displayed
}</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="3-create-booktabletest-class"><a class="anchor" href="#3-create-booktabletest-class"></a>==  3. Create BookTableTest class</h6>
<div class="paragraph">
<p>At this point you can start creating a test class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>import static org.junit.Assert.assertTrue;

public class BookTableTest extends BaseTest {
    private static BookTablePage bookTablePage = new BookTablePage(); //the field contains book table page object

    @BeforeClass
    public static void setUpBeforeClass() {
        bookTablePage.load(); //loads book table page
    }

    @AfterClass
    public static void tearDownAfterClass() {

    }

    @Override
    public void setUp() {
        if (!bookTablePage.isLoaded()) {
            bookTablePage.load(); //if the page is not loaded, loads it
        }
    }

    @Override
    public void tearDown() {

    }
}</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="4-write-the-first-test"><a class="anchor" href="#4-write-the-first-test"></a>==  4. Write the first test</h6>
<div class="paragraph">
<p>You can prepare our first test method using the methods from page classes</p>
</div>
<div class="listingblock">
<div class="content">
<pre>@Test
public void Test_BookTableAndCheckConfirmation() {
    String date = "07/23/2019 1:00 PM"; //replace with tommorow's date in format "MM/dd/yyyy hh:mm a"
    String name = "Smith"; //name field
    String email = "smith@somemail.com"; //email field
    int guests = 3; //number of guests

    //enters booking data and returns a new confirmation page
    ConfirmBookPage confirmBookPage = bookTablePage.enterBookingData(date, name, email, guests);
    confirmBookPage.confirmBookingData(); //confirms booking

    //checks if the green dialog box appears, if it does, test is passed, if not, the test failed and displays message given in the first argument
    assertTrue("Test failed: Table not booked", bookTablePage.checkConfirmationDialog()); //returns true if dialog box appears and false if not
}</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="5-run-the-test"><a class="anchor" href="#5-run-the-test"></a>==  5. Run the test</h6>
<div class="paragraph">
<p>Run the test by right-clicking on the test method &#8594; Run as &#8594; JUnit test.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/image6.png" alt="image6">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="migration-from-junit4-to-junit5"><a class="anchor" href="#migration-from-junit4-to-junit5"></a>26.29. Migration from JUnit4 to JUnit5</h3>

</div>
<div class="sect2">
<h3 id="migration-guide"><a class="anchor" href="#migration-guide"></a>26.30. Migration guide</h3>
<div class="sect5">
<h6 id="junit4-to-junit5-migration-guide"><a class="anchor" href="#junit4-to-junit5-migration-guide"></a>Junit4 to Junit5 migration guide</h6>
<div class="paragraph">
<p><strong>mrchecker-core-module version 5.6.2.1</strong> features the upgrade of Junit4 to Junit5. Consequently, the Junit4 features are now obsolete and current test projects require migration
in order to use the latest revision of MrChecker. This site provides guidance on the migration.</p>
</div>
<div class="paragraph">
<p>References:
Junit5 User Guide - <a href="https://junit.org/junit5/docs/current/user-guide/#overview" class="bare">https://junit.org/junit5/docs/current/user-guide/#overview</a></p>
</div>
</div>
<div class="sect5">
<h6 id="pom"><a class="anchor" href="#pom"></a>POM</h6>
<div class="paragraph">
<p>The project <code>pom.xml</code> file needs to be adjusted in the first place. An exemplary POM file for download can be found here: <a href="https://github.com/devonfw/mrchecker/blob/develop/template/pom.xml" class="bare">https://github.com/devonfw/mrchecker/blob/develop/template/pom.xml</a></p>
</div>
</div>
<div class="sect5">
<h6 id="test-annotations"><a class="anchor" href="#test-annotations"></a>Test Annotations</h6>
<div class="paragraph">
<p>Junit5 redefines annotations defining a test flow. The annotations need to be adjusted as per the following table.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration01.png" alt="migration01">
</div>
</div>
</div>
<div class="sect5">
<h6 id="rule-classrule-testrule-and-testmethod"><a class="anchor" href="#rule-classrule-testrule-and-testmethod"></a>Rule, ClassRule, TestRule and TestMethod</h6>
<div class="paragraph">
<p>Junit4 <code>@Rule</code> and <code>@ClassRule</code> annoations as well as <code>TestRule</code> and <code>TestMethod</code> interfaces have been replaced
with the Junit5 extension mechanism (<a href="https://junit.org/junit5/docs/current/user-guide/#extensions" class="bare">https://junit.org/junit5/docs/current/user-guide/#extensions</a>).
During the migration to Junit5, all the instances of the mentioned types need to be rewritten according to the Junit5 User Guide.
The extension mechanism is far more flexible than the Junit4 functionality based on rules.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong>: as per Junit5 API spec: <code>ExpectedExceptionSupport, ExternalResourceSupport, VerifierSupport</code>
provide native support of the correspoinding Junit4 rules.</p>
</div>
<div class="paragraph">
<p>Extension registration example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration02.png" alt="migration02">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration03.png" alt="migration03">
</div>
</div>
<div class="paragraph">
<p>TestRule (<code>TestWatcher</code> and <code>ExternalResource</code>) to Extension (<code>TestWatcher</code> and <code>AfterAllCallback</code>) example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration04.png" alt="migration04">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration05.png" alt="migration05">
</div>
</div>
</div>
<div class="sect5">
<h6 id="page-basepageautoregistration-and-pagefactory-classes"><a class="anchor" href="#page-basepageautoregistration-and-pagefactory-classes"></a>Page, BasePageAutoRegistration and PageFactory classes</h6>
<div class="paragraph">
<p><code>Page</code> class is a new MrChecker class. It was introduced to provide common implemenation for its subpages in specific MrChecker modules.
In order to receive test lifecycle notifications, particular <code>Pages</code> need to be registered by calling <code>addToTestExecutionObserver()</code> method.
To facilitate this process, <code>PageFactory</code> class was designed and it’s usage is a recommended way of creating <code>Page</code> objects for tests.
Although in MrChecker based on Junit4, the registration process was done in a specific <code>BasePage</code> constructor, it’s been considered error prone and reimplemented.
Furthermore, to reduce migration cost <code>BasePageAutoRegistration</code> classes are available in MrChceker modules. They use the old way of registration.
Given that three ways of migration are possible.</p>
</div>
<div class="paragraph">
<p>Migration with <code>PageFactory</code> class example <strong>(RECOMMENDED)</strong>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration06.png" alt="migration06">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration07.png" alt="migration07">
</div>
</div>
<div class="paragraph">
<p>Migration with calling <code>addToTestExecutionObserver()</code> method example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration06.png" alt="migration06">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration08.png" alt="migration08">
</div>
</div>
<div class="paragraph">
<p>Migration with <code>BasePageAutoRegistration</code> class example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration09.png" alt="migration09">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration10.png" alt="migration10">
</div>
</div>
</div>
<div class="sect5">
<h6 id="test-suites"><a class="anchor" href="#test-suites"></a>Test suites</h6>
<div class="paragraph">
<p>Test suite migration example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration11.png" alt="migration11">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration12.png" alt="migration12">
</div>
</div>
<div class="paragraph">
<p>Running tests from Maven:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration13.png" alt="migration13">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration14.png" alt="migration14">
</div>
</div>
</div>
<div class="sect5">
<h6 id="concurrency"><a class="anchor" href="#concurrency"></a>Concurrency</h6>
<div class="paragraph">
<p>Junit5 provides native thread count and parallel execution control in contrast to Junit4 where it was controlled by Maven Surefire plugin.
To enable concurrent test execution, <code>junit-platform.properties</code> file needs to placed in the <code>test/resources</code> directory of a project.</p>
</div>
<div class="paragraph">
<p>Exemplary file contents:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration15.png" alt="migration15">
</div>
</div>
<div class="paragraph">
<p>A ready-to-use file can be found here.</p>
</div>
<div class="paragraph">
<p>MrChecker supports only concurrent test class execution.
<code>@ResourceLock</code> can be used to synchronize between classes if needed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration16.png" alt="migration16">
</div>
</div>
</div>
<div class="sect5">
<h6 id="cucumber-2"><a class="anchor" href="#cucumber-2"></a>Cucumber</h6>
<div class="paragraph">
<p>If Cucumber is used in a project, it is neccessary to change a hook class.
An exemplary hook source file for download can be found here.</p>
</div>
</div>
<div class="sect5">
<h6 id="data-driven-tests"><a class="anchor" href="#data-driven-tests"></a>Data driven tests</h6>
<div class="paragraph">
<p>Junit5 implements new approach to data driven tests by various data resolution mechanisms.</p>
</div>
<div class="paragraph">
<p>An example of method source parameters migration version one:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration17.png" alt="migration17">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration18.png" alt="migration18">
</div>
</div>
<div class="paragraph">
<p>An example of method source parameters migration version two:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration17.png" alt="migration17">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration19.png" alt="migration19">
</div>
</div>
<div class="paragraph">
<p>An example of method source in another class parameters migration:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration20.png" alt="migration20">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration21.png" alt="migration21">
</div>
</div>
<div class="paragraph">
<p>Providing parameters directly in annotations has no analogy in Junit5 and needs to be replaced with e.g. method source:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration22.png" alt="migration22">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration23.png" alt="migration23">
</div>
</div>
<div class="paragraph">
<p>An example of csv parameters source with no header line migration:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration24.png" alt="migration24">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration25.png" alt="migration25">
</div>
</div>
<div class="paragraph">
<p>An example of csv parameters source with the header line migration:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration26.png" alt="migration26">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration27.png" alt="migration27">
</div>
</div>
<div class="paragraph">
<p>An example of csv parameters source with object mapping migration step1:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration28.png" alt="migration28">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration29.png" alt="migration29">
</div>
</div>
<div class="paragraph">
<p>An example of csv parameters source with object mapping migration step 2:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration30.png" alt="migration30">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration_arrow_down.png" alt="migration arrow down">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/migration31.png" alt="migration31">
</div>
</div>
</div>
<div class="sect5">
<h6 id="setup-and-teardown"><a class="anchor" href="#setup-and-teardown"></a>setUp() and tearDown()</h6>
<div class="paragraph">
<p><code>BaseTest.setUp()</code> and <code>BaseTest.tearDown()</code> methods are now not abstract and need no implementation in subclasses. <code>@Override</code> when a custom implemenatation is needed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="faq"><a class="anchor" href="#faq"></a>26.31. FAQ</h3>
<div class="paragraph">
<p>Here you can find the most frequently asked questions regarding working with MrChecker and installation problems.</p>
</div>
</div>
<div class="sect2">
<h3 id="common-problems"><a class="anchor" href="#common-problems"></a>26.32. Common problems</h3>
<div class="sect5">
<h6 id="i-cant-find-the-boilerplate-module-has-it-been-removed"><a class="anchor" href="#i-cant-find-the-boilerplate-module-has-it-been-removed"></a>I can&#8217;t find the boilerplate module. Has it been removed?</h6>
<div class="paragraph">
<p>The <em>boilerplate</em> module has been removed from the GitHub project on purpose.</p>
</div>
<div class="paragraph">
<p>There were problems with naming and communication, not everybody was aware of the meaning of the word <em>boilerplate</em>.</p>
</div>
<div class="paragraph">
<p>The name of the folder has been changed to <em>template</em>. It can be found in the GitHub project.</p>
</div>
</div>
<div class="sect5">
<h6 id="is-it-possible-to-use-docker-with-mrchecker"><a class="anchor" href="#is-it-possible-to-use-docker-with-mrchecker"></a>Is it possible to use Docker with MrChecker?</h6>
<div class="paragraph">
<p>MrChecker works seamlessly with Docker.</p>
</div>
<div class="paragraph">
<p>A direct example of how to use it can be found in following JenkinsFile <a href="https://github.com/devonfw/devonfw-testing/blob/develop/mrchecker-app-under-test/pipelines/CI/Jenkinsfile_node.groovy" class="bare">https://github.com/devonfw/devonfw-testing/blob/develop/mrchecker-app-under-test/pipelines/CI/Jenkinsfile_node.groovy</a></p>
</div>
<div class="paragraph">
<p>Note that the structure of the folders can be changed. If that happens - search in repo for  <em>/pipeline/CI/Jenkinsfile_node.groovy</em></p>
</div>
</div>
<div class="sect5">
<h6 id="tests-are-not-stable"><a class="anchor" href="#tests-are-not-stable"></a>Tests are not stable</h6>
<div class="paragraph">
<p>Selenium tests perform actions much faster than a normal user would. Because pages can contain dynamically changing content, some web elements can still not be loaded when Selenium driver tries to access them.</p>
</div>
<div class="paragraph">
<p><code>getDriver().waitForPageLoaded()</code> method checks ready state in the browser, that&#8217;s why stability problems may happen in advanced frontend projects.</p>
</div>
<div class="paragraph">
<p>To improve test stability you can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>add waiting methods before dynamically loading elements e.g. <code>getDriver().waitForElement(By selector)</code></p>
</li>
<li>
<p>add timeout parameter in <code>method getDriver().findElementDynamic(By selector, int timeOut)</code></p>
</li>
<li>
<p>change global waiting timeout value using method <code>getDriver().manage().timeouts().implicitlyWait(long time, TimeUnit unit)</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Furthermore, if the page displays visible loading bars or spinners, create FluentWait method to wait until they disappear.</p>
</div>
<div class="paragraph">
<p>Notice that by increasing timeouts you may improve stability but too long waiting time makes tests run slower.</p>
</div>
<div class="paragraph">
<p>Learn more from tutorials:<br>
<a href="https://capgemini.sharepoint.com/sites/Mr-Checker/SitePages/Example-10&#8212;&#8203;Dynamicly-Loading-Elements.aspx">Example 10: Dynamically loaded Elements</a><br>
<a href="https://capgemini.sharepoint.com/sites/Mr-Checker/SitePages/Example-11&#8212;&#8203;Exit-intent.aspx">Example 11: Exit intent</a><br>
<a href="https://capgemini.sharepoint.com/sites/Mr-Checker/SitePages/Example-12-.aspx">Example 12: File download test</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="how-to-3"><a class="anchor" href="#how-to-3"></a>26.33. How to</h3>
<div class="sect5">
<h6 id="how-to-change-timeouts"><a class="anchor" href="#how-to-change-timeouts"></a>How to: Change timeouts?</h6>
<div class="paragraph">
<p>If you would like to change timeouts - you don&#8217;t have to change them globally.
It is possible to add waiting time parameter to searching methods, such as:</p>
</div>
<div class="paragraph">
<p><code>getDriver().findElementDynamic(By selector, int timeOut)</code><br>
timeout - in seconds</p>
</div>
<div class="paragraph">
<p>It is recommended to use methods that significantly level up the repetitiveness of the code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>getDriver().waitForElement(By selector);

getDriver().waitForElementVisible(By selector);

getDriver().waitForPageLoaded();

getDriver().waitUntilElementIsClickable(By selector);</pre>
</div>
</div>
<div class="paragraph">
<p>Or Fluent Wait methods with changed timeout and interval:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>FluentWait&lt;WebDriver&gt; wait = new FluentWait&lt;WebDriver&gt;(getDriver())
        .withTimeout(long duration, TimeUnit unit)
        .pollingEvery(long duration, TimeUnit unit);
wait.until((WebDriver wd) -&gt; expectedCondition.isTrue());
getWebDriverWait().withTimeout(millis, TimeUnit.MILLISECONDS)
        .withTimeout(long duration, TimeUnit unit)
        .pollingEvery(long duration, TimeUnit unit)
        .until((WebDriver wd) -&gt; expectedCondition.isTrue());</pre>
</div>
</div>
<div class="paragraph">
<p>These methods allow You to change WebDriver timeouts values such as:</p>
</div>
<div class="paragraph">
<p><code>getDriver().manage().timeouts().pageLoadTimeout(long time, TimeUnit unit)</code><br>
the amount of time to wait for a page to load before throwing an exception. This is the default timeout for <code>method getDriver().waitForPageLoaded()</code></p>
</div>
<div class="paragraph">
<p><code>getDriver().manage().timeouts().setScriptTimeout(long time, TimeUnit unit)</code><br>
the amount of time to wait for execution of script to finish before throwing an exception</p>
</div>
<div class="paragraph">
<p><code>getDriver().manage().timeouts().implicitlyWait(long time, TimeUnit unit)</code>
the amount of time the driver should wait when searching for an element if it is not immediately present. After that time, it throws an exception. This the default timeout for methods such as <code>getDriver().findElementDynamic(By selector)</code> or <code>getDriver().waitForElement(By selector)</code></p>
</div>
<div class="paragraph">
<p>Changing timeouts can improve test stability but can also make test run time longer.</p>
</div>
</div>
<div class="sect5">
<h6 id="how-to-start-a-browser-in-incognitoprivate-mode"><a class="anchor" href="#how-to-start-a-browser-in-incognitoprivate-mode"></a>How to: Start a browser in Incognito/Private mode?</h6>
<div class="paragraph">
<p>In MrChecker there is a fpossibility of changing browser options during runtime execution.</p>
</div>
<div class="paragraph">
<p>To run the browser in incognito mode:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In Eclipse - open Run Configurations window:</p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/ht_image1.png" alt="ht image1"></span></p>
</div>
</li>
<li>
<p>Select a test which you want to run and switch to arguments tab:</p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/ht_image2.png" alt="ht image2"></span></p>
</div>
</li>
<li>
<p>Add VM argument:</p>
<div class="ulist">
<ul>
<li>
<p>for the incognito mode in chrome:</p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/ht_image3.png" alt="ht image3"></span></p>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Read more about browsers' options: <a href="https://github.com/devonfw/devonfw-testing/wiki/Run-with-different-browser-options" class="bare">https://github.com/devonfw/devonfw-testing/wiki/Run-with-different-browser-options</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="installation-problems"><a class="anchor" href="#installation-problems"></a>26.34. Installation problems</h3>
<div class="sect5">
<h6 id="chromedriver-version-is-not-compatible-with-chrome-browser"><a class="anchor" href="#chromedriver-version-is-not-compatible-with-chrome-browser"></a>Chromedriver version is not compatible with Chrome browser</h6>
<div class="paragraph">
<p><strong>Problem:</strong></p>
</div>
<div class="paragraph">
<p>During the tests your web browser window opens and immediately closes, all your tests are broken.</p>
</div>
<div class="paragraph">
<p>Following error message is visible in the test description:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>session not created: This version of ChromeDriver only supports Chrome version 76
Build info: version: '&lt;build_version&gt;', revision: '&lt;build_revision&gt;', time: '&lt;time&gt;'
System info: host: '&lt;your_computer_name&gt;', ip: '&lt;your_ip_address&gt;', os.name: '&lt;your_os_name&gt;', os.arch: '&lt;your_os_architecture&gt;', os.version: '&lt;your_os_version&gt;', java.version: '&lt;java_version_installed&gt;'
Driver info: driver.version: NewChromeDriver</pre>
</div>
</div>
<div class="paragraph">
<p><strong>Solution:</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make a change in the following files:</p>
<div class="ulist">
<ul>
<li>
<p><code>MrChecker_Test_Framework\workspace\devonfw-testing\src\resources\settings.properties</code></p>
</li>
<li>
<p>For project template-app-under-test: <code>MrChecker_Test_Framework\workspace\devonfw-testing\template\src\resources\settings.properties</code></p>
</li>
<li>
<p>For project example-app-under-test: <code>MrChecker_Test_Framework\workspace\devonfw-testing\example\src\resources\settings.properties</code></p>
<div class="paragraph">
<p>Change the value of <code>selenium.driverAutoUpdate</code> field form <code>true</code> to <code>false</code></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Replace the following file with a version compatible with your browser:
<code>MrChecker_Test_Framework\workspace\devonfw-testing\example\lib\webdrivers\chrome\chromedriver.exe</code> .</p>
</li>
</ol>
</div>
</div>
<div class="sect5">
<h6 id="my-browser-opens-up-in-german-by-default"><a class="anchor" href="#my-browser-opens-up-in-german-by-default"></a>My browser opens up in German by default</h6>
<div class="paragraph">
<p><strong>Problem:</strong></p>
</div>
<div class="paragraph">
<p>I would like my browser to use the English language, but the default language for the browser is German. How can I change the settings?</p>
</div>
<div class="paragraph">
<p><strong>Solution:</strong></p>
</div>
<div class="paragraph">
<p>There is a Properties file installed together with MrCheker installation. It is possible to set the language in which a browser could be opened for testing purposes in <em>Properties &gt; Selenium configuration</em>,.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-dashboard"><a class="anchor" href="#devonfw-dashboard"></a>26.35. devonfw dashboard</h3>

</div>
<div class="sect2">
<h3 id="landing-page"><a class="anchor" href="#landing-page"></a>26.36. Landing page</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Landing page</p>
</div>
<div class="paragraph">
<p>This is the entry point of the devonfw dashboard. Click on <strong>GET STARTED NOW</strong> to start using it.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/landing_page/get_started.png"><img src="_images/images/landing_page/get_started.png" alt="Get Started" width="600"></a>
</div>
<div class="title">Figure 80. Get Started</div>
</div>
<div class="sect4">
<h5 id="your-devonfw-distributions"><a class="anchor" href="#your-devonfw-distributions"></a>Your devonfw distributions</h5>
<div class="paragraph">
<p>The first time you open the application you will get a dialog with all the devonfw distributions found on your machine. Click on <strong>OK GOT IT</strong> to continue.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/landing_page/devonfw_distributions_dialog.png"><img src="_images/images/landing_page/devonfw_distributions_dialog.png" alt="devon-ide distributions" width="450"></a>
</div>
<div class="title">Figure 81. devon-ide distributions</div>
</div>
</div>
<div class="sect4">
<h5 id="profile-form"><a class="anchor" href="#profile-form"></a>Profile form</h5>
<div class="paragraph">
<p>Here you will find a screen that allows you to create a profile. This is just for the purpose of customizing your dashboard.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/landing_page/profile_form.png"><img src="_images/images/landing_page/profile_form.png" alt="Profile" width="600"></a>
</div>
<div class="title">Figure 82. Profile</div>
</div>
<div class="paragraph">
<p>Fill the data and click on <strong>CREATE MY PROFILE</strong> if you want to create the profile at the moment or click <strong>WILL DO IT LATER</strong> to skip the creation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="home"><a class="anchor" href="#home"></a>26.37. Home</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Home page</p>
</div>
<div class="paragraph">
<p>This is the main page that you will find after your profile creation and the page where you will start from henceforth.</p>
</div>
<div class="paragraph">
<p>It contains three sections as below:<br></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Toolbar<br></p>
</li>
<li>
<p>Sidebar<br></p>
</li>
<li>
<p>Content<br></p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="topbar"><a class="anchor" href="#topbar"></a>Topbar<br></h5>
<div class="paragraph">
<p>This section is at the top of the page, it contains <strong>devonfw instance</strong> dropdown to select devonfw-ide that can be used as a base for the projects.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/home_page/toolbar.png"><img src="_images/images/home_page/toolbar.png" alt="Toolbar" width="600"></a>
</div>
</div>
<div class="paragraph">
<p>Next to the <strong>devonfw instance</strong> dropdown, there is a <strong>quick help</strong> icon, clicking on it will open a popup which gives some tips for how to use Devon Dashboard IDE.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/home_page/quick_help"><img src="_images/images/home_page/quick_help.png" alt="Quick Help" width="300"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="sidebar"><a class="anchor" href="#sidebar"></a>Sidebar<br></h5>
<div class="paragraph">
<p>The sidebar has divided into two sections:<br></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User Profile - Users can see his/her pic, name, and role.<br></p>
</li>
<li>
<p>Links to access to different sections of the dashboard.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/home_page/sidebar.png"><img src="_images/images/home_page/sidebar.png" alt="Sidebar" width="200"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="content-section"><a class="anchor" href="#content-section"></a>Content Section</h5>
<div class="paragraph">
<p>The Content section has also divided into three sections:<br></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A small introduction about the devonfw IDE<br></p>
</li>
<li>
<p>A button to <strong>Download latest version</strong> of devonfw IDE<br></p>
</li>
<li>
<p>A "Project" block which shows the total number of Projects which are available in different devonfw IDE<br></p>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="steps-to-download-and-install-devonfw-ide"><a class="anchor" href="#steps-to-download-and-install-devonfw-ide"></a>Steps to download and Install devonfw IDE<br></h5>
<div class="paragraph">
<p><strong>Step 1:</strong> Click on <strong>Download latest version</strong> button which is in the Content section. Check the below screen for the reference.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/home_page/download_latest_version.png"><img src="_images/images/home_page/download_latest_version.png" alt="Download Latest Version" width="600"></a>
</div>
</div>
<div class="paragraph">
<p><strong>Step 2:</strong> By clicking <strong>Download latest version</strong> button, <strong>Installing devonfw</strong> popup will open.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/home_page/installing_devonfw.png"><img src="_images/images/home_page/installing_devonfw.png" alt="Installing Devonfw" width="600"></a>
</div>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> <strong>Installing devonfw</strong> popup will automatically trigger one more popup to specify the location for downloading Devonfw IDE. Specify the location and click the <strong>Save</strong> button to download.<br></p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/home_page/installing_devonfw_download_location_set.png"><img src="_images/images/home_page/installing_devonfw_download_location_set.png" alt="Download location popup" width="600"></a>
</div>
</div>
<div class="paragraph">
<p><strong>Step 3:</strong> Once the download completes successfully, the <strong>Next</strong> button will be enabled for the further installation process.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/home_page/installing_devonfw_download_completes.png"><img src="_images/images/home_page/installing_devonfw_download_completes.png" alt="Download Devonfw Completed" width="600"></a>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4:</strong> By Clicking <strong>Next</strong> button in the <strong>Installing devonfw</strong> pop up, two options are shown:<br>
1: Select the Git url for the installation setup.<br>
2: Skip this process.<br></p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/home_page/installation_options.png"><img src="_images/images/home_page/installation_options.png" alt="Installation Options" width="600"></a>
</div>
</div>
<div class="paragraph">
<p><strong>Step 5:</strong> Select one of the above options.<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the selection is <strong>Git url</strong>, then <strong>Configuration file url</strong> should be filled in the input box and needs to click <strong>Next</strong> button to start the further installation process.<br></p>
</li>
<li>
<p>In case the user doesn&#8217;t have <strong>Git url</strong>, then simply <strong>Skip the process</strong> and click the <strong>Next</strong> button to start the further installation process.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Step 6</strong>: Click on the <strong>Next</strong> button for the final installation process. Wait for some time to complete the installation setup. Once the installation setup completes, the <strong>Close</strong> button will appear. Just click on it and go to the specified folder location.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/home_page/installation_setup.png"><img src="_images/images/home_page/installation_setup.png" alt="Installation Setup" width="600"></a>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="projects"><a class="anchor" href="#projects"></a>26.38. Projects</h3>
<!-- toc disabled -->
<div class="sect4">
<h5 id="introduction-to-project-management-in-the-dashboard"><a class="anchor" href="#introduction-to-project-management-in-the-dashboard"></a>Introduction to project management in the dashboard</h5>
<div class="ulist">
<ul>
<li>
<p>The <strong>dashboard</strong> manages multiple projects in multiple workspaces that include Angular, JAVA, and Node.<br></p>
</li>
<li>
<p>The <strong>dashboard</strong> provides rich UI for creating multiple projects, abstracting all the functionality which is usually required while creating an application like opening a command terminal, specifying workspace, and executing commands.<br></p>
</li>
<li>
<p>The <strong>dashboard</strong> makes it easy to see all the projects which are in different devonfw-ide workspace, just by changing the "devonfw Instance" dropdown.</p>
</li>
<li>
<p>The <strong>dashboard</strong> makes it very easy to open a project in a different IDE like Visual Studio or Eclipse respectively just by right click on the Project folder and open option.</p>
</li>
<li>
<p>The <strong>dashboard</strong> also makes it easy to delete the project, explore the project location.<br></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="projects-2"><a class="anchor" href="#projects-2"></a>Projects</h5>
<div class="paragraph">
<p>Click on the <strong>Projects</strong> link on the sidebar to navigate to the project&#8217;s screen. The screen displays all the projects in the currently selected devonfw-ide, grouped by the workspaces in which they exist.<br>
Note: Currently it only displays projects created through the dashboard.<br></p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/project_page/project_page.png"><img src="_images/images/project_page/project_page.png" alt="Project Screen" width="600"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>It shows the total number of projects available in each <strong>devonfw-ide</strong>.</p>
</li>
<li>
<p>Filtering and searching the projects.</p>
</li>
<li>
<p><strong>Add New Project</strong> - For creating a Project.</p>
</li>
<li>
<p>Project folder which gives information about the project like which technology the project belongs to, the name of the project, and when it has created.</p>
</li>
<li>
<p>There are many operations that are available on right-click on <strong>Project folder</strong> they are :</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Opening a project in different IDE ( Visual Studio or Eclipse )</p>
</li>
<li>
<p>Enclosing Folder, and</p>
</li>
<li>
<p>Deleting the project.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Users can see projects of different <strong>devonfw-ide</strong> workspace just by changing the option in the <strong>devonfw instance</strong> dropdown which is set globally at the top of the screen.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Click on <strong>Add New Project</strong> to start creating a new project.<br></p>
</div>
</div>
<div class="sect4">
<h5 id="how-to-create-a-project"><a class="anchor" href="#how-to-create-a-project"></a>How to create a project</h5>
<div class="paragraph">
<p>Three main steps are involved in creating any devonfw project. They are:<br></p>
</div>
<div class="paragraph">
<p><strong>Step 1. Project Type</strong><br></p>
</div>
<div class="paragraph">
<p>In this first step the user has to choose the language technology to start the project with, e.g. <strong>Angular</strong>, <strong>Java</strong> or <strong>Node</strong> and click the <strong>Next</strong> button for to continue to the next step.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/project_page/project_type.png"><img src="_images/images/project_page/project_type.png" alt="Project Type" width="600"></a>
</div>
</div>
<div class="paragraph">
<p><strong>Step 2. Project Data</strong><br></p>
</div>
<div class="paragraph">
<p>After the <strong>Project type</strong> selection, the second screen will appear for the user to fill up all the required fields. User can select the workspace in the active devonfw-ide for the project in this step. Once the user enters all the required fields, the <strong>Next</strong> button will be enabled for the final step.<br></p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/project_page/project_data.png"><img src="_images/images/project_page/project_data.png" alt="Project Data" width="600"></a>
</div>
</div>
<div class="paragraph">
<p>User can change the <strong>devonfw-ide</strong> workspace where the project is going to generate, just by changing the option in the <strong>devonfw instance</strong> dropdown which is set globally in the header of the dashboard.<br></p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/home_page/toolbar_workspace.png"><img src="_images/images/home_page/toolbar_workspace.png" alt="Toolbar" width="600"></a>
</div>
</div>
<div class="paragraph">
<p><strong>Step 3. Execution</strong><br></p>
</div>
<div class="paragraph">
<p>The execution step takes all the user entered data from the <strong>Project Data</strong> step and executes the respective commands to generate the project.<br></p>
</div>
<div class="paragraph">
<p><strong>Execution</strong> has divided into two sections:<br>
- Creation<br>
- Setup Installation</p>
</div>
<div class="sect6">
<h7 id="3-1-creation"><a class="anchor" href="#3-1-creation"></a>3.1 Creation</h7>
<div class="ulist">
<ul>
<li>
<p>Creates only source code and notify the user if the project creation fails or success.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/project_page/creation.png"><img src="_images/images/project_page/creation.png" alt="Creation" width="600"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>In case any network issue or technical issue and the user wants to re-run the <strong>Project execution</strong> process, then the <strong>Retry</strong> button will help to start the process again.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/project_page/retry.png"><img src="_images/images/project_page/retry.png" alt="Retry" width="600"></a>
</div>
</div>
</div>
<div class="sect6">
<h7 id="3-2-setup-installation"><a class="anchor" href="#3-2-setup-installation"></a>3.2 Setup installation</h7>
<div class="paragraph">
<p>Allows user to install the dependencies of application (maven modules for java, node modules for node, angular) by clicking <strong>Proceed</strong> button.<br></p>
</div>
<div class="paragraph">
<p>The installation can be skipped by clicking <strong>cancel</strong> button.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/project_page/installation.png"><img src="_images/images/project_page/installation.png" alt="Installation" width="600"></a>
</div>
</div>
<div class="paragraph">
<p><strong>Step 4.</strong> Click on <strong>Finish</strong> button to go to <strong>Project Details Screen</strong>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="repositories"><a class="anchor" href="#repositories"></a>26.39. Repositories</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Repositories</p>
</div>
<div class="paragraph">
<p>This page lists the different repositories under devonfw organization.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/repositories_page/repositories.png"><img src="_images/images/repositories_page/repositories.png" alt="Repositories" width="600"></a>
</div>
<div class="title">Figure 83. Repositories</div>
</div>
<div class="paragraph">
<p>The list updates as you type in the search bar.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/repositories_page/repositories_search.png"><img src="_images/images/repositories_page/repositories_search.png" alt="Search Repositories" width="600"></a>
</div>
<div class="title">Figure 84. Search Repositories</div>
</div>
<div class="ulist">
<ul>
<li>
<p>You can click <strong>COPY GITHUB URL</strong> for any of the repository list item to copy its github URL to your clipboard and clone it locally.</p>
</li>
<li>
<p>You can also click the <strong>OPEN REPOSITORY</strong> button to view its github repository page in your default browser.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="wiki"><a class="anchor" href="#wiki"></a>26.40. Wiki</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Wiki page.</p>
</div>
<div class="paragraph">
<p>This page displays the documentation of devonfw. You can also find it at <a href="https://devonfw.com/" class="bare">https://devonfw.com/</a></p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/wiki_page/wiki.png"><img src="_images/images/wiki_page/wiki.png" alt="Wiki" width="600"></a>
</div>
<div class="title">Figure 85. Wiki</div>
</div>
</div>
<div class="sect2">
<h3 id="settings-2"><a class="anchor" href="#settings-2"></a>26.41. Settings</h3>
<!-- toc disabled -->
<div class="paragraph">
<p>==Settings</p>
</div>
<div class="sect4">
<h5 id="account-settings"><a class="anchor" href="#account-settings"></a>Account settings</h5>
<div class="paragraph">
<p>Here you get a screen that allows you to create a profile. This is the same screen which you see during the initial setup of the dashboard. It is completely optional.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/settings_page/account-settings.png"><img src="_images/images/settings_page/account-settings.png" alt="Account settings" width="600"></a>
</div>
<div class="title">Figure 86. Account settings</div>
</div>
<div class="paragraph">
<p>Fill the data and click on <strong>Save</strong> if you want to create the profile.</p>
</div>
</div>
<div class="sect4">
<h5 id="installed-versions"><a class="anchor" href="#installed-versions"></a>Installed versions</h5>
<div class="paragraph">
<p>The installed versions subsection allows you to manage the different versions of devonfw-ide available.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/settings_page/installed-versions.png"><img src="_images/images/settings_page/installed-versions.png" alt="Installed versions" width="600"></a>
</div>
<div class="title">Figure 87. Installed versions</div>
</div>
<div class="ulist">
<ul>
<li>
<p>It lists the devonfw-ide you have installed in your system, along with the ones available for download from our maven repository</p>
</li>
<li>
<p>If you want to install specific version, you can search it here and <strong>DOWNLOAD</strong> it</p>
</li>
<li>
<p>To check the release notes for a version, simply click on <strong>Consolidated list of features</strong></p>
</li>
<li>
<p>For the installed versions:</p>
<div class="ulist">
<ul>
<li>
<p>Hovering over the eye icon shows you the path for the devonfw-ide in a tooltip</p>
</li>
<li>
<p>You can view it in your system explorer by clicking the eye icon</p>
</li>
<li>
<p>You can update its settings and softwares by clicking on <strong>UPDATE</strong></p>
</li>
<li>
<p>You can also <strong>UNINSTALL</strong> an installed version, after which the dashboard will no longer keep track of the projects and IDEs belonging to that devonfw-ide</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="solicitor-user-guide"><a class="anchor" href="#solicitor-user-guide"></a>26.42. Solicitor User Guide</h3>
<div class="paragraph">
<p>SPDX-License-Identifier: Apache-2.0</p>
</div>
</div>
<div class="sect2">
<h3 id="introduction-10"><a class="anchor" href="#introduction-10"></a>26.43. Introduction</h3>
<div class="paragraph">
<p>Todays software projects often make use of large amounts of Open Source software. Being
compliant with the license obligations of the used software components is a prerequisite for every such project. This results in different requirements that the project might need to fulfill. Those requirements can be grouped into two main categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Things that need to be done to actually fulfill license obligations</p>
</li>
<li>
<p>Things that need to be done to monitor / report fulfillment of license obligations</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Most of the above activities share common points:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The need to have an inventory of used (open source) components and their licenses</p>
</li>
<li>
<p>Some rule based evaluation and reporting based on this inventory</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In practice these easy looking tasks might get complex due to various aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The number of open source components might be quite large (&gt;&gt; 100 for a typical webapplication based on state of the art programming frameworks)</p>
</li>
<li>
<p>Agile development and rapid changes of used components result in frequent changes of the inventory</p>
</li>
<li>
<p>Open Source usage scenarios and license obligations might be OK in one context (e.g. in the relation between a software developer and his client) but might be completely inacceptable in another context (e.g. when the client distributes the same software to end customers)</p>
</li>
<li>
<p>Legal interpretation of license conditions often differ from organisation to organisation and result in different compliance rules to be respected.</p>
</li>
<li>
<p>License information for components is often not available in a standardized form which would allow automatic processing</p>
</li>
<li>
<p>Tools for supporting the license management processes are often specific to a technology or build tool and do not support all aspects of OSS license management.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Of course there are specific commercial tool suites which address the IP rights and license domain. But due to high complexity and license costs those tools are out of reach for most projects - at least for permanent use.</p>
</div>
<div class="paragraph">
<p><em>Solicitor</em> tries to address some of the issues hightlighted above. In its initial version it is a tool for programmatically executing a process which was originally defined as an Excel-supported manual process.</p>
</div>
<div class="paragraph">
<p>When running <em>Solicitor</em> three subsequent processing steps are executed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Creating an initial component and license inventory based on technology specific input files</p>
</li>
<li>
<p>Rule based normalization and evaluation of licenses</p>
</li>
<li>
<p>Generation of output documents</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<code>Solicitor</code> comes with a set of <strong>sample</strong> rules for the normalization and evaluation of licenses.
Even though these included rules are not "intentionally wrong" they are only samples and <strong>you should never rely on these builtin rules without checking and possibly modifying their content and consulting your lawyer</strong>. <em>Solicitor</em> is a tool
for technically supporting the management of OSS licenses within your project. <em>Solicitor</em> neither gives legal advice nor is a replacement for a lawyer.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="licensing-of-solicitor"><a class="anchor" href="#licensing-of-solicitor"></a>26.44. Licensing of Solicitor</h3>
<div class="paragraph">
<p>The <em>Solicitor</em> code and accompanying resources (including this userguide) as stored in the GIT Repository <a href="https://github.com/devonfw/solicitor" class="bare">https://github.com/devonfw/solicitor</a> are licensed as Open Source under Apache 2 license (<a href="https://www.apache.org/licenses/LICENSE-2.0" class="bare">https://www.apache.org/licenses/LICENSE-2.0</a>).</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Specifically observe the "Disclaimer of Warranty" and "Limitation of Liability" which are part of the license.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The executable JAR file which is created by the Maven based build process includes numerous other Open Source components which are subject to different Open Source licenses. Any distribution of the <em>Solicitor</em> executable JAR file needs to comply with the license conditions of all those components.
If you are running <em>Solicitor</em> from the executable JAR you might use the <code>-eug</code> option to store detailed license information as file <code>solicitor_licenseinfo.html</code> in your current working directory (together with a copy of this user guide).
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="architecture-4"><a class="anchor" href="#architecture-4"></a>26.45. Architecture</h3>
<div class="paragraph">
<p>The following picture show a business oriented view of <em>Solicitor</em>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/domain_model.png" alt="domain model" width="50%"></span></p>
</div>
<div class="paragraph">
<p>Raw data about the components and attached licenses within an application is gathered by <em>scanning</em> with technology and build chain specific tools. This happens outside <em>Solicitor</em>.</p>
</div>
<div class="paragraph">
<p>The <em>import</em> step reads this data and transforms it into a common technology independent internal format.</p>
</div>
<div class="paragraph">
<p>In the <em>normalization</em> step the license information is completed and unified. Information not contained in the raw data is added. Where possible the applicable licenses are expressed by <a href="https://spdx.org/">SPDX-IDs</a>.</p>
</div>
<div class="paragraph">
<p>Many open source compontents are available via multi licensing models. Within <em>qualification</em> the finally applicable licenses are selected.</p>
</div>
<div class="paragraph">
<p>In the <em>legal assessment</em> the compliance of applicable licenses will be checked based on generic rules defined in company wide policies and possibly project specific project specific extensions. Defining those rules is considered as "legal advice" and possibly needs to be done by lawyers which are authorized to do so. For this step <em>Solicitor</em> only provides a framework / tool to support the process here but does not deliver any predefined rules.</p>
</div>
<div class="paragraph">
<p>The final <em>export</em> step produces documents based on the internal data model. This might be the list of licenses to be forwarded to the customer or a license compliance report. Data might also be fed into other systems.</p>
</div>
<div class="paragraph">
<p>A more technical oriented view of <em>Solicitor</em> is given below.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/solution.png" alt="solution" width="100%"></span></p>
</div>
<div class="paragraph">
<p>There are three major technical components: The <em>reader</em> and <em>writer</em> components are performing import and export of data. The business logic - doing <em>normalization</em>, <em>qualification</em> and <em>legal assessment</em> is done by a <em>rule engine</em>. Rules are mainly defined via <em>decision tables</em>. <em>Solicitor</em> comes with a starting set of rules for <em>normalization</em> and <em>qualification</em> but these rulesets need to be extended within the projects. Rules for legal evaluation need to be completely defined by the user.</p>
</div>
<div class="paragraph">
<p><em>Solicitor</em> is working without additional persisted data: When being executed it generates the output direcly from the read input data after processing the business rules.</p>
</div>
</div>
<div class="sect2">
<h3 id="data-model"><a class="anchor" href="#data-model"></a>26.46. Data Model</h3>
<div class="paragraph">
<p><span class="image"><img src="_images/datamodel.png" alt="datamodel" width="50%"></span></p>
</div>
<div class="paragraph">
<p>The internal business data model consists of 6 entities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong><code>ModelRoot</code></strong>: root object of the business data model which holds metadata about the data processing</p>
</li>
<li>
<p><strong><code>Engagement</code></strong>: the masterdata of the overall project</p>
</li>
<li>
<p><strong><code>Application</code></strong>: a deliverable within the <code>Engagement</code></p>
</li>
<li>
<p><strong><code>ApplicationComponent</code></strong>: component within an <code>Application</code></p>
</li>
<li>
<p><strong><code>RawLicense</code></strong>: License info attached to an <code>ApplicationComponent</code> as it is read from the input data</p>
</li>
<li>
<p><strong><code>NormalizedLicense</code></strong>: License info attached to an <code>ApplicationComponent</code> processed by the business rules</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="modelroot"><a class="anchor" href="#modelroot"></a>26.47. ==  ModelRoot</h3>
<div class="paragraph">
<p>|== =
| Property | Type | Description
| modelVersion | int | version number of the data model
| executionTime | String | timestamp when the data was processed
| solicitorVersion | String | Solicitor version which processed the model
| solicitorGitHash | String | buildnumber / GitHash of the Solicitor build
| solicitorBuilddate | String | build date of the Solicitor build
| extensionArtifactId | String | artifactId of the active <em>Solicitor</em> Extension ("NONE" if no extension)
| extensionVersion | String | Version of the active Extension (or "NONE")
| extensionGitHash | String | Buildnumber / GitHash of the Extension (or "NONE")
| extensionBuilddate | String build date of the Extension (or "NONE")
|== =</p>
</div>
</div>
<div class="sect2">
<h3 id="engagement"><a class="anchor" href="#engagement"></a>26.48. ==  Engagement</h3>
<div class="paragraph">
<p>|== =
| Property | Type | Description
| engagementName | String | the engagement name
| engagementType | EngagementType | the engagement type; possible values: INTERN, EXTERN
| clientName | String | name of the client
| goToMarketModel | GoToMarketModel | the go-to-market-model; possible values: LICENSE
| contractAllowsOss | boolean | does the contract explicitely allow OSS?
| ossPolicyFollowed | boolean | is the companies OSS policy followed?
| customerProvidesOss | boolean | does the customer provide the OSS?
|== =</p>
</div>
</div>
<div class="sect2">
<h3 id="application-2"><a class="anchor" href="#application-2"></a>26.49. ==  Application</h3>
<div class="paragraph">
<p>|== =
| Property | Type | Description
| applicationName | String | the name of the application / deliverable
| releaseId | String | version identifier of the application
| releaseDate | Sting | release data of the application
| sourceRepo | String | URL of the source repo of the application (should be an URL)
| programmingEcosystem | String | programming ecosystem (e.g. Java8; Android/Java, iOS / Objective C)
|== =</p>
</div>
</div>
<div class="sect2">
<h3 id="applicationcomponent"><a class="anchor" href="#applicationcomponent"></a>26.50. ==  ApplicationComponent</h3>
<div class="paragraph">
<p>|== =
| Property | Type | Description
| usagePattern | UsagePattern | possible values: DYNAMIC_LINKING, STATIC_LINKING, STANDALONE_PRODUCT
| ossModified | boolean | is the OSS modified?
| ossHomepage | String | URL of the OSS homepage
| groupId | String | component identifier: maven group
| artifactId | String | component identifier: maven artifactId
| version | String | component identifier: Version
| repoType | String | component identifier: RepoType
|== =</p>
</div>
</div>
<div class="sect2">
<h3 id="rawlicense"><a class="anchor" href="#rawlicense"></a>26.51. ==  RawLicense</h3>
<div class="paragraph">
<p>|== =
| Property | Type | Description
| declaredLicense | String | name of the declared license
| licenseUrl | String | URL of the declared license
| trace | String | detail info of history of this data record
| specialHandling | boolean | <em>(for controlling rule processing)</em>
|== =</p>
</div>
</div>
<div class="sect2">
<h3 id="normalizedlicense"><a class="anchor" href="#normalizedlicense"></a>26.52. ==  NormalizedLicense</h3>
<div class="paragraph">
<p>|== =
| Property | Type | Description
| declaredLicense | String | name of the declared license (copied from RawLicense)
| licenseUrl | String | URL of the declared license (copied from RawLicense
| declaredLicenseContent | String | resolved content of licenseUrl
| normalizedLicenseType | String | type of the license, see <a href="#License types">[License types]</a>
| normalizedLicense | String | name of the license in normalized form (SPDX-Id) or special "pseudo license id", see <a href="#Pseudo License Ids">[Pseudo License Ids]</a>
| normalizedLicenseUrl | String | URL pointing to a normalized form of the license
| normalizedLicenseType | String | type of the license, see <a href="#License types">[License types]</a>
| effectiveNormalizedLicenseType | String | type of the effective license, see <a href="#License types">[License types]</a>| effectiveNormalizedLicense | String | effective normalized license (SPDX-Id) or "pseudo license id"; this is the information after selecting the right license in case of multi licensing or any license override due to a component being redistributed under a different license
| effectiveNormalizedLicenseUrl | String | URL pointing to the effective normalized license
| effectiveNormalizedLicenseContent | String | resolved content of effectiveNormalizedLicenseUrl
| legalPreApproved | String | indicates whether the license is pre approved based on company standard policy
| copyLeft | String | indicates the type of copyleft of the license
| licenseCompliance | String | indicates if the license is compliant according to the default company policy
| licenseRefUrl | String | URL to the reference license information (TBD)
| licenseRefContent | String | resolved content of licenseRefUrl
| includeLicense | String | does the license require to include the license text ?
| includeSource | String | does the license require to deliver source code of OSS component ?
| reviewedForRelease | String | for which release was the legal evaluation done?
| comments | String | comments on the component/license (mainly as input to legal)
| legalApproved | String | indicates whether this usage is legally approved
| legalComments | String | comments from legal, possibly indicating additional conditions to be fulfilled
| trace | String | detail info of history of this data record (rule executions)
|== =</p>
</div>
<div class="paragraph">
<p>For the mechanism how <em>Solicitor</em> resolves the content of URLs and how the result
might be influenced see <a href="#resolving-of-license-urls">Resolving of License URLs</a></p>
</div>
</div>
<div class="sect2">
<h3 id="license-types"><a class="anchor" href="#license-types"></a>26.53. == License types</h3>
<div class="paragraph">
<p>Defines the type of license</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>OSS-SPDX</code> - An OSS license which has a corresponding SPDX-Id</p>
</li>
<li>
<p><code>OSS-OTHER</code> - An OSS license which has no SPDX-Id</p>
</li>
<li>
<p><code>COMMERCIAL</code> - Commercial (non OSS) license; this might also include code which is owned by the project</p>
</li>
<li>
<p><code>UNKNOWN</code>- License is unknown</p>
</li>
<li>
<p><code>IGNORED</code>- license will be ignored (non selected license in multi licensing case; only to be used as "Effective Normalized License Type")</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="pseudo-license-ids"><a class="anchor" href="#pseudo-license-ids"></a>26.54. == Pseudo License Ids</h3>
<div class="paragraph">
<p>A "normalized" license id might be either a SPDX-Id or a "pseudo license id" which is used to indicate a specific situation. The following pseudo license ids are used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>OSS specific</code> - a nonstandard OSS license which could not be mapped to a SPDX-Id</p>
</li>
<li>
<p><code>PublicDomain</code> - any form of public domain which is not represented by an explicit SPDX-Id</p>
</li>
<li>
<p><code>Ignored</code> - license will be ignored (non selected license in multi licensing case; only to be used as "Effective Normalized License")</p>
</li>
<li>
<p><code>NonOSS</code> - commercial license, not OSS</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="usage-9"><a class="anchor" href="#usage-9"></a>26.55. Usage</h3>

</div>
<div class="sect2">
<h3 id="executing-solicitor"><a class="anchor" href="#executing-solicitor"></a>26.56. Executing Solicitor</h3>
<div class="paragraph">
<p><em>Solicitor</em> is a standalone Java (Spring Boot) application. Prerequisite for running it is an existing Java 8 or 11 runtime environment. If you do not yet have a the <em>Solicitor</em> executable JAR (<code>solicitor.jar</code>) you need to build it as given on the project GitHub homepage <a href="https://github.com/devonfw/solicitor" class="bare">https://github.com/devonfw/solicitor</a> .</p>
</div>
<div class="paragraph">
<p><em>Solicitor</em> is executed with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -jar solicitor.jar -c &lt;configfile&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>&lt;configfile&gt;</code> is to be replaced by the location of the <a href="#Configuration File">[Configuration File]</a>.</p>
</div>
<div class="paragraph">
<p>To get a first idea on what <em>Solicitor</em> does you might call</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -jar solicitor.jar -c classpath:samples/solicitor_sample.cfg</pre>
</div>
</div>
<div class="paragraph">
<p>This executes <em>Solicitor</em> with default configuration on it own list of internal components and produces sample output.</p>
</div>
<div class="paragraph">
<p>To get an overview of the available command line options use</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -jar solicitor.jar -h</pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Adressing of resources</div>
<div class="paragraph">
<p>For unique adressing of resources <strong>to be read</strong> (configuration files, input data, rule templates and decision tables) <em>Solicitor</em> makes use of the Spring ResourceLoader functionality, see <a href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#resources-resourceloader" class="bare">https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/core.html#resources-resourceloader</a> . This allows to load from the classpath, the filesystem or even via http get.</p>
</div>
<div class="paragraph">
<p>If you want to reference a file in the filesystem you need to write it as follows: <code>file:path/to/file.txt</code></p>
</div>
<div class="paragraph">
<p>Note that this only applies to resources being read. Output files are adressed without that prefix.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="project-configuration-file"><a class="anchor" href="#project-configuration-file"></a>26.57. Project Configuration File</h3>
<div class="paragraph">
<p>The project configuration of <em>Solicitor</em> is done via a configuration file in
JSON format. This configuration file defines the engagements and applications master data, configures the readers for importing component and license information, references the business rules to be applied and defines the exports to be done.</p>
</div>
<div class="paragraph">
<p>The config file has the following skeleton:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>{
  "version" : 1,
  "comment" : "Sample Solicitor configuration file",
  "engagementName" : "DevonFW", <i class="conum" data-value="1"></i><b>(1)</b>
  .
  .
  .
  "applications" : [ ... ], <i class="conum" data-value="2"></i><b>(2)</b>
  "rules" : [ ... ],  <i class="conum" data-value="3"></i><b>(3)</b>
  "writers" : [ ... ] <i class="conum" data-value="4"></i><b>(4)</b>
}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The leading data defines the engagement master data, see <a href="#Header and Engagement Master Data">[Header and Engagement Master Data]</a></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>applications</code>  defines the applications within the engagement and configures the readers to import the component/license information, see <a href="#Readers / Applications">[Readers / Applications]</a></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>rules</code> references the rules to apply to the imported data, see <a href="#Business Rules">[Business Rules]</a></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>writers</code> configures how the processed data should be exported, see <a href="#Writers / Reporting">[Writers / Reporting]</a></td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The following section describes all sections of the <em>Solicitor</em> configuration file format. Often the configuration of <code>writers</code> and especially <code>rules</code> will be identical for projects. To facilitate the project specific configuration setup <em>Solicitor</em> internally provides a base configuration which contains reasonable defaults for the <code>rules</code> and <code>writers</code> section. If the project specific configuration file omits the <code>rules</code> and/or <code>writers</code> sections then the corresponding settings from the base configuration will be taken. For details see <a href="#default-base-configuration">Default Base Configuration</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
If locations of files are specified within the configuration files as relative
pathnames then this is always evaluated relative to the current working directory (which
might differ from the location of the configuration file). If some file location
should be given relative to the location of the configuration file this might be done
using the special placeholder <code>${cfgdir}</code> as described in the following.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="placeholders-within-the-configuration-file"><a class="anchor" href="#placeholders-within-the-configuration-file"></a>26.58. ==  Placeholders within the configuration file</h3>
<div class="paragraph">
<p>Within certain parts of the configuration file (path and filenames) special placeholders might be used to parameterize the configuration. These areas are explicitely marked in the following
description.</p>
</div>
<div class="paragraph">
<p>These placeholders are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>${project}</code> - A simplified project name (taking the engagement name,
removing all non-word characters and converting to lowercase).</p>
</li>
<li>
<p><code>${cfgdir}</code> -  If the config file was loaded from the filesystem this denotes the directory where the config file resides, <code>.</code>  otherwise. This can be used to reference locations relative to the location of the config file.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="header-and-engagement-master-data"><a class="anchor" href="#header-and-engagement-master-data"></a>26.59. ==  Header and Engagement Master Data</h3>
<div class="paragraph">
<p>The leading section of the config file defines some metadata and the engagement master data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  "version" : 1, <i class="conum" data-value="1"></i><b>(1)</b>
  "comment" : "Sample Solicitor configuration file", <i class="conum" data-value="2"></i><b>(2)</b>
  "engagementName" : "DevonFW", <i class="conum" data-value="3"></i><b>(3)</b>
  "engagementType" : "INTERN", <i class="conum" data-value="4"></i><b>(4)</b>
  "clientName" : "none", <i class="conum" data-value="5"></i><b>(5)</b>
  "goToMarketModel" : "LICENSE", <i class="conum" data-value="6"></i><b>(6)</b>
  "contractAllowsOss" : true, <i class="conum" data-value="7"></i><b>(7)</b>
  "ossPolicyFollowed" : true, <i class="conum" data-value="8"></i><b>(8)</b>
  "customerProvidesOss" : false, <i class="conum" data-value="9"></i><b>(9)</b></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>version of the config file format (currently needs to be 1)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>is a free text comment (no further function at the moment)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>the engagement name (any string)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>the engagement type; possible values: INTERN, EXTERN</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>name of the client (any string)</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>the go-to-market-model; possible values: LICENSE</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>does the contract explicitely allow OSS? (boolean)</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>is the companies OSS policy followed? (boolean)</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>does the customer provide the OSS? (boolean)</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="applications"><a class="anchor" href="#applications"></a>26.60. ==  Applications</h3>
<div class="paragraph">
<p>Within this section the different applications (=deliverables) of the engagement are defined. Furtheron for each application at least one reader needs to be defined which imports the component and license information.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> "applications" : [ {
    "name" : "Devon4J", <i class="conum" data-value="1"></i><b>(1)</b>
    "releaseId" : "3.1.0-SNAPSHOT", <i class="conum" data-value="2"></i><b>(2)</b>
    "sourceRepo" : "https://github.com/devonfw/devon4j.git", <i class="conum" data-value="3"></i><b>(3)</b>
    "programmingEcosystem" : "Java8", <i class="conum" data-value="4"></i><b>(4)</b>
    "readers" : [ { <i class="conum" data-value="5"></i><b>(5)</b>
      "type" : "maven", <i class="conum" data-value="6"></i><b>(6)</b>
      "source" : "classpath:samples/licenses_devon4j.xml", <i class="conum" data-value="7"></i><b>(7)</b> <i class="conum" data-value="10"></i><b>(10)</b>
      "usagePattern" : "DYNAMIC_LINKING", <i class="conum" data-value="8"></i><b>(8)</b>
      "repoType" : "maven" <i class="conum" data-value="9"></i><b>(9)</b>
    } ]
  } ],</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The name of the application / deliverable (any string)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Version identifier of the application (any string)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>URL of the source repo of the application (string; should be an URL)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>programming ecosystem (any string; e.g. Java8; Android/Java, iOS / Objective C)</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>multiple readers might be defined per application</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>the type of reader; for possible values see <a href="#reading-license-information-with-readers">Reading License Information with Readers</a></td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>location of the source file to read (ResourceLoader-URL)</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>usage pattern; possible values: DYNAMIC_LINKING, STATIC_LINKING, STANDALONE_PRODUCT</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>repoType: Repository to download the sources from: currently possible values: maven, npm; if omitted then "maven" will be taken as default</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td><em>placeholder patterns might be used here</em></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The different readers are described in chapter <a href="#reading-license-information-with-readers">Reading License Information with Readers</a></p>
</div>
</div>
<div class="sect2">
<h3 id="business-rules"><a class="anchor" href="#business-rules"></a>26.61. ==  Business Rules</h3>
<div class="paragraph">
<p>Business rules are executed within a <a href="https://www.drools.org/">Drools</a> rule engine. They are defined as a sequence of rule templates and corresponding XLS files which together represent decision tables.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  "rules" : [ {
    "type" : "dt", <i class="conum" data-value="1"></i><b>(1)</b>
    "optional" : false, <i class="conum" data-value="2"></i><b>(2)</b>
    "ruleSource" : "classpath:samples/LicenseAssignmentSample.xls", <i class="conum" data-value="3"></i><b>(3)</b> <i class="conum" data-value="7"></i><b>(7)</b>
    "templateSource" : "classpath:com/.../rules/rule_templates/LicenseAssignment.drt", <i class="conum" data-value="4"></i><b>(4)</b> <i class="conum" data-value="7"></i><b>(7)</b>
    "ruleGroup" : "LicenseAssignment", <i class="conum" data-value="5"></i><b>(5)</b>
    "description" : "setting license in case that no one was detected" <i class="conum" data-value="6"></i><b>(6)</b>
  },
  .
  .
  .
,{
    "type" : "dt",
    "optional" : false,
    "ruleSource" : "classpath:samples/LegalEvaluationSample.xls",
    "templateSource" : "classpath:com/.../rules/rule_templates/LegalEvaluation.drt",
    "ruleGroup" : "LegalEvaluation",
    "decription" : "final legal evaluation based on the rules defined by legal"
  } ],</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>type of the rule; only possible value: <code>dt</code> which stands for "decision table"</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>if set to <code>true</code> the processing of this group of rules will be skipped if the XLS with table
data (given by <code>ruleSource</code>) does not exist; if set to <code>false</code> a missing XLS table will result
in program termination</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>location of the tabular decision table data</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>location of the drools rule template to be used to define the rules together with the decision table data</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>id of the group of rules; used to reference it e.g. when doing logging</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>some textual description of the rule group</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td><em>placeholder patterns might be used here</em></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When running, <em>Solicitor</em> will execute the rules of each rule group separately and in the order
given by the configuration. Only if there are no more rules to fire in a group <em>Solicitor</em> will
move to the next rule group and start firing those rules.</p>
</div>
<div class="paragraph">
<p>Normally a project will only customize (part of) the data of the decision tables and thus will only change the <code>ruleSource</code> and the data in the XLS. All other configuration (the different templates and processing order) is part of the <em>Solicitor</em> application itself and should not be changed by end users.</p>
</div>
<div class="paragraph">
<p>See <a href="#working-with-decision-tables">Working with Decision Tables</a> and <a href="#standard-business-rules">Standard Business Rules</a> for further information on the business rules.</p>
</div>
</div>
<div class="sect2">
<h3 id="writers-reporting"><a class="anchor" href="#writers-reporting"></a>26.62. ==  Writers / Reporting</h3>
<div class="paragraph">
<p>The writer configuration defines how the processed data will be exported and/or reported.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  "writers" : [ {
    "type" : "xls", <i class="conum" data-value="1"></i><b>(1)</b>
    "templateSource" : "classpath:samples/Solicitor_Output_Template_Sample.xlsx", <i class="conum" data-value="2"></i><b>(2)</b> <i class="conum" data-value="6"></i><b>(6)</b>
    "target" : "OSS-Inventory-DevonFW.xlsx", <i class="conum" data-value="3"></i><b>(3)</b> <i class="conum" data-value="6"></i><b>(6)</b>
    "description" : "The XLS OSS-Inventory document", <i class="conum" data-value="4"></i><b>(4)</b>
    "dataTables" : { <i class="conum" data-value="5"></i><b>(5)</b>
      "ENGAGEMENT"  : "classpath:com/devonfw/tools/solicitor/sql/allden_engagements.sql",
      "LICENSE" : "classpath:com/devonfw/tools/solicitor/sql/allden_normalizedlicenses.sql"
    }
  } ]</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>type of writer to be selected; possible values: <code>xls</code>, <code>velo</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>path to the template to be used</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>location of the output file</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>some textual description</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>reference to SQL statements used to transform the internal data model to data tables used for reporting</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><em>placeholder patterns might be used here</em></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For details on the writer configuration see <a href="#reporting-creating-output-documents">Reporting / Creating output documents</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="starting-a-new-project"><a class="anchor" href="#starting-a-new-project"></a>26.63. Starting a new project</h3>
<div class="paragraph">
<p>To simplify setting up a new project <em>Solicitor</em> provides an option to create a project starter configuration in a given directory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -jar solicitor.jar -wiz some/directory/path</pre>
</div>
</div>
<div class="paragraph">
<p>Besides the necessary configuration file this includes also empty XLS files for defining project
specific rules which amend the builtin rules. Furtheron a sample <code>license.xml</code> file is provided to
directly enable execution of solicitor and check functionality.</p>
</div>
<div class="paragraph">
<p>This configuration then serves as starting point for project specific configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="exporting-the-builtin-configuration"><a class="anchor" href="#exporting-the-builtin-configuration"></a>26.64. Exporting the Builtin Configuration</h3>
<div class="paragraph">
<p>When working with <em>Solicitor</em> it might be necessary to get access to the builtin base configuration, e.g. for reviewing the builtin sample rules or using builtin reporting templates as starting point for the creation of own templates.</p>
</div>
<div class="paragraph">
<p>The command</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -jar solicitor.jar -ec some/directory/path</pre>
</div>
</div>
<div class="paragraph">
<p>will export all internal configuration to the given directory. This includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The base configuration file, see <a href="#Configuration File">[Configuration File]</a></p>
</li>
<li>
<p>The Drools Rule Templates</p>
</li>
<li>
<p>The the builtin decision tables which are referenced in the base configuration, see <a href="#standard-business-rules">Standard Business Rules</a></p>
</li>
<li>
<p>The SQL statements which are used for <a href="#sql-transformation-and-filtering">SQL transformation and filtering</a></p>
</li>
<li>
<p>The referenced templates for the <a href="#Velocity Writer">[Velocity Writer]</a> and <a href="#Excel Writer">[Excel Writer]</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="configuration-of-technical-properties"><a class="anchor" href="#configuration-of-technical-properties"></a>26.65. Configuration of Technical Properties</h3>
<div class="paragraph">
<p>Besides the project configuration done via the above described file there are a set of technical settings in <em>Solicitor</em> which are done via properties. <em>Solicitor</em> is implemented as a <a href="https://spring.io/projects/spring-boot">Spring Boot Application</a> and makes use
of the <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-external-config">standard configuration mechanism provided by the Spring Boot Platform</a> which provides several ways to define/override properties.</p>
</div>
<div class="paragraph">
<p>The default property values are given in <a href="#built-in-default-properties">Built in Default Properties</a>.</p>
</div>
<div class="paragraph">
<p>In case that a property shall be overridden when executing <em>Solicitor</em> this can easiest be done via the command line when executing
<em>Solicitor</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -Dsome.property.name1=value -Dsome.property.name2=another_value -jar solicitor.jar &lt;any other arguments&gt;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="reading-license-information-with-readers"><a class="anchor" href="#reading-license-information-with-readers"></a>26.66. Reading License Information with Readers</h3>
<div class="paragraph">
<p>Different Readers are available to import raw component / license information for different
technologies. This chapter describes how to setup the different build / dependency management systems to create the required input and how to configure the corresponding reader.</p>
</div>
</div>
<div class="sect2">
<h3 id="maven"><a class="anchor" href="#maven"></a>26.67. Maven</h3>
<div class="paragraph">
<p>For the export of the licenses from a maven based project the license-maven-plugin is used, which can directly be called without the need to change anything in the pom.xml.</p>
</div>
<div class="paragraph">
<p>To generate the input file required for <em>Solicitor</em> the License Plugin needs to be executed with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn org.codehaus.mojo:license-maven-plugin:1.14:aggregate-download-licenses -Dlicense.excludedScopes=test,provided</pre>
</div>
</div>
<div class="paragraph">
<p>The generated output file named <code>licenses.xml</code> (in the directory specified in the
plugin config) should look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Unresolved include directive in modules/ROOT/pages/solicitor.wiki/master-solicitor.adoc - include::licenses.xml[]</pre>
</div>
</div>
<div class="paragraph">
<p>In <em>Solicitor</em> the data is read with the following reader config:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"readers" : [ {
  "type" : "maven",
  "source" : "file:target/generated-resouces/licenses.xml",
  "usagePattern" : "DYNAMIC_LINKING"
} ]</pre>
</div>
</div>
<div class="paragraph">
<p>(the above assumes that <em>Solicitor</em> is executed in the maven projects main directory)</p>
</div>
</div>
<div class="sect2">
<h3 id="csv"><a class="anchor" href="#csv"></a>26.68. CSV</h3>
<div class="paragraph">
<p>The CSV input is normally manually generated and should look like this (The csv File is ";" separated):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Unresolved include directive in modules/ROOT/pages/solicitor.wiki/master-solicitor.adoc - include::csvlicenses.csv[]</code></pre>
</div>
</div>
<div class="paragraph">
<p>In <em>Solicitor</em> the data is read with the following part of the config</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"readers" : [ {
  "type" : "csv",
  "source" : "file:path/to/the/file.csv",
  "usagePattern" : "DYNAMIC_LINKING"
} ]</pre>
</div>
</div>
<div class="paragraph">
<p>The following 5 columns need to be contained:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>groupId</p>
</li>
<li>
<p>artifactId</p>
</li>
<li>
<p>version</p>
</li>
<li>
<p>license name</p>
</li>
<li>
<p>license URL</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In case that a component has multiple licenses attached, there needs to be a separate
line in the file for each license.</p>
</div>
</div>
<div class="sect2">
<h3 id="npm-5"><a class="anchor" href="#npm-5"></a>26.69. NPM</h3>
<div class="paragraph">
<p>For NPM based projects either the NPM License Crawler (<a href="https://www.npmjs.com/package/npm-license-crawler" class="bare">https://www.npmjs.com/package/npm-license-crawler</a>) or the NPM License Checker (<a href="https://www.npmjs.com/package/license-checker" class="bare">https://www.npmjs.com/package/license-checker</a>) might be used. The NPM License Crawler can process several node packages in one run.</p>
</div>
</div>
<div class="sect2">
<h3 id="npm-license-crawler"><a class="anchor" href="#npm-license-crawler"></a>26.70. ==  NPM License Crawler</h3>
<div class="paragraph">
<p>To install the NPM License Crawler the following command needs to be executed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>npm i npm-license-crawler -g</pre>
</div>
</div>
<div class="paragraph">
<p>To get the licenses, the crawler needs to be executed like the following example</p>
</div>
<div class="listingblock">
<div class="content">
<pre>npm-license-crawler --dependencies --csv licenses.csv</pre>
</div>
</div>
<div class="paragraph">
<p>The export should look like the following (The csv file is "," separated)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Unresolved include directive in modules/ROOT/pages/solicitor.wiki/master-solicitor.adoc - include::licenses.csv[]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Source: <a href="https://www.npmjs.com/package/npm-license-crawler" class="bare">https://www.npmjs.com/package/npm-license-crawler</a></p>
</div>
<div class="paragraph">
<p>In <em>Solicitor</em> the data is read with the following part of the config</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"readers" : [ {
  "type" : "npm-license-crawler-csv",
  "source" : "file:path/to/licenses.csv",
  "usagePattern" : "DYNAMIC_LINKING",
  "repoType" : "npm"
} ]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="npm-license-checker"><a class="anchor" href="#npm-license-checker"></a>26.71. ==  NPM License Checker</h3>
<div class="paragraph">
<p>To install the NPM License Checker the following command needs to be executed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>npm i license-checker -g</pre>
</div>
</div>
<div class="paragraph">
<p>To get the licenses, the checker needs to be executed like the following example (we require JSON output here)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>license-checker --json &gt; /path/to/licenses.json</pre>
</div>
</div>
<div class="paragraph">
<p>The export should look like the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>Unresolved include directive in modules/ROOT/pages/solicitor.wiki/master-solicitor.adoc - include::licensesNpmLicenseChecker.json[]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Source: <a href="https://www.npmjs.com/package/license-checker" class="bare">https://www.npmjs.com/package/license-checker</a></p>
</div>
<div class="paragraph">
<p>In <em>Solicitor</em> the data is read with the following part of the config</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"readers" : [ {
  "type" : "npm-license-checker",
  "source" : "file:path/to/licenses.json",
  "usagePattern" : "DYNAMIC_LINKING",
  "repoType" : "npm"
} ]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="gradle-windows"><a class="anchor" href="#gradle-windows"></a>26.72. Gradle (Windows)</h3>
<div class="paragraph">
<p>For the export of the licenses from a Gradle based project the Gradle License Plugin is used.</p>
</div>
<div class="paragraph">
<p>To install the plugin some changes need to be done in <code>build.gradle</code>, like following example</p>
</div>
<div class="listingblock">
<div class="content">
<pre>buildscript {
  repositories {
    maven { url 'https://oss.jfrog.org/artifactory/oss-snapshot-local/' }
  }

  dependencies {
    classpath 'com.jaredsburrows:gradle-license-plugin:0.8.5-SNAPSHOT'
  }
}

apply plugin: 'java-library'
apply plugin: 'com.jaredsburrows.license'</pre>
</div>
</div>
<div class="paragraph">
<p>Afterwards execute the following command in the console:</p>
</div>
<div class="paragraph">
<p>For Windows (Java Application)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gradlew licenseReport</pre>
</div>
</div>
<div class="paragraph">
<p>The Export should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Unresolved include directive in modules/ROOT/pages/solicitor.wiki/master-solicitor.adoc - include::licenses.json[]</pre>
</div>
</div>
<div class="paragraph">
<p>Source: <a href="https://github.com/jaredsburrows/gradle-license-plugin" class="bare">https://github.com/jaredsburrows/gradle-license-plugin</a></p>
</div>
<div class="paragraph">
<p>In <em>Solicitor</em> the data is read with the following part of the config</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"readers" : [ {
  "type" : "gradle2",
  "source" : "file:path/to/licenses.json",
  "usagePattern" : "DYNAMIC_LINKING"
} ]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The former reader of type <code>gradle</code> is deprecated and should no longer be used. See <a href="#list-of-deprecated-features">List of Deprecated Features</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="gradle-android"><a class="anchor" href="#gradle-android"></a>26.73. Gradle (Android)</h3>
<div class="paragraph">
<p>For the Export of the the Licenses from a Gradle based Android Projects the Gradle License Plugin is used.</p>
</div>
<div class="paragraph">
<p>To install the Plugin some changes need to be done in the build.gradle of the Project, like following example</p>
</div>
<div class="listingblock">
<div class="content">
<pre>buildscript {
  repositories {
    jcenter()
  }

  dependencies {
    classpath 'com.jaredsburrows:gradle-license-plugin:0.8.5'
  }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Also there is a change in the build.gradle of the App. Add the line in the second line</p>
</div>
<div class="listingblock">
<div class="content">
<pre>apply plugin: 'com.android.application'</pre>
</div>
</div>
<div class="paragraph">
<p>Afterwards execute the following command in the Terminal of Android studio:
For Windows(Android Application)</p>
</div>
<div class="listingblock">
<div class="content">
<pre>gradlew licenseDebugReport</pre>
</div>
</div>
<div class="paragraph">
<p>The Export is in the following folder</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$Projectfolder\app\build\reports\licenses</pre>
</div>
</div>
<div class="paragraph">
<p>It should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Unresolved include directive in modules/ROOT/pages/solicitor.wiki/master-solicitor.adoc - include::licenseDebugReport.json[]</pre>
</div>
</div>
<div class="paragraph">
<p>Source: <a href="https://github.com/jaredsburrows/gradle-license-plugin" class="bare">https://github.com/jaredsburrows/gradle-license-plugin</a></p>
</div>
<div class="paragraph">
<p>In Solicitor the Data is read with the following part of the config</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"readers" : [ {
      "type" : "gradle2",
      "source" : "file:$/input/licenses.json",
      "usagePattern" : "DYNAMIC_LINKING"
   	} ]</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The former reader of type <code>gradle</code> is deprecated and should no longer be used. See <a href="#list-of-deprecated-features">List of Deprecated Features</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="working-with-decision-tables"><a class="anchor" href="#working-with-decision-tables"></a>26.74. Working with Decision Tables</h3>
<div class="paragraph">
<p>Solicitor uses the Drools rule engine to execute business rules. Business rules are
defined as "extended" decision tables. Each such decision table consists of two artifacts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A rule template file in specific drools template format</p>
</li>
<li>
<p>An Excel (XLSX) table which defines the decision table data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When processing, <em>Solicitor</em> will internally use the rule template to create one or multiple rules for every record found in the Excel sheet. The following points are important here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Rule templates:</p>
<div class="ulist">
<ul>
<li>
<p>Rule templates should be regarded as part of the <em>Solicitor</em> implementation and should not be changed on an engagement level.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Excel decision table data</p>
<div class="ulist">
<ul>
<li>
<p>The Excel tables might be extended or changed on a per project level.</p>
</li>
<li>
<p>The rules defined by the tabular data will have decreasing "salience" (priority) from top to bottom</p>
</li>
<li>
<p>In general multiple rules defined within a table might fire for the same data to be processed; the definition of the rules within the rule template will normally ensure that once a rule from the decision table was processed no other rule from that table will be processed for the same data</p>
</li>
<li>
<p>The excel tables contain header information in the first row which is only there for documentation purposes; the first row is completely ignored when creating rules from the xls</p>
</li>
<li>
<p>The rows starting from the second row contain decision table data</p>
</li>
<li>
<p>The first "empty" row (which does not contain data in any of the defined columns) ends the decision table</p>
</li>
<li>
<p>Decision tables might use multiple condition columns which define the data that a rule matches. Often such conditions are optional: If left free in the Excel table the condition will be omitted from the rule conditions. This allows to define very specific rules (which only fire on exact data patterns) or quite general rules which get activated on large groups of data. Defining general rules further down in the table (with lower salience/priority) ensures that more specific rules get fired earlier. This even allows to define a default rule at the end of the table which gets fired if no other rule could be applied.</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>rule groups</em>: Business rules are executed within groups. All rules resulting from a single decision table are assigned to the same <em>rule group</em>. The order of execution of the <em>rule groups</em>
is defined by the sequence of declaration in the config file. Processing of the current group will
be finished when there are no more rules to fire in that group. Processing of the next group will then start. Rule groups which have been finished processing will not be resumed even if rules within that group might have been activated again due to changes of the facts.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="extended-comparison-syntax"><a class="anchor" href="#extended-comparison-syntax"></a>26.75. Extended comparison syntax</h3>
<div class="paragraph">
<p>By default any condtions given in the fields of decision tables are simple textual comparisons: The condition
is true if the property of the model is identical to the given value in the XLS sheet.</p>
</div>
<div class="paragraph">
<p>Depending on the configuration of the rule templates for some fields, an extended syntax might be available. For those fields the following syntax applies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the given value of the XLS field starts with the prefix <code>NOT:</code> then the outcome of the remaining condition is logically negated, i.e. this field condition is  <code>true</code> if the rest of the condition is NOT fulfilled.</p>
</li>
<li>
<p>A prefix of <code>REGEX:</code> indicates that the remainder of the field defines a <a href="https://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html">Java Regular Expression</a>. For the condition to become true the whole property needs to match the given regular expression.</p>
</li>
<li>
<p>The prefix <code>RANGE:</code> indicates that the remainder of the field defines
a <a href="https://maven.apache.org/ref/3.5.0/maven-artifact/apidocs/org/apache/maven/artifact/versioning/VersionRange.html#createFromVersionSpec(java.lang.String)">Maven Version Range</a>. Using this makes only sense on the artifact version property.</p>
</li>
<li>
<p>If no such prefix is detected, then the behavior is identical to the normal (verbatim) comparison logic</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Fields which are subject to this extended syntax are marked explicitly in the following section.</p>
</div>
</div>
<div class="sect2">
<h3 id="standard-business-rules"><a class="anchor" href="#standard-business-rules"></a>26.76. Standard Business Rules</h3>
<div class="paragraph">
<p>The processing of business rules is organized in different phases. Each phase might consist of multiple decision tables to be processed in order.</p>
</div>
</div>
<div class="sect2">
<h3 id="phase-1-determining-assigned-licenses"><a class="anchor" href="#phase-1-determining-assigned-licenses"></a>26.77. Phase 1: Determining assigned Licenses</h3>
<div class="paragraph">
<p>In this phase the license data imported via the readers is cleaned and normalized. At the end of this phase the internal data model should clearly represent all components and their assigned licenses in normalized form.</p>
</div>
<div class="paragraph">
<p>The phase itself consists of two decision tables / rule groups:</p>
</div>
</div>
<div class="sect2">
<h3 id="decision-table-explicitely-setting-licenses"><a class="anchor" href="#decision-table-explicitely-setting-licenses"></a>26.78. ==  Decision Table: Explicitely setting Licenses</h3>
<div class="paragraph">
<p>With this decision table is is possible to explicitely assign NormalizedLicenses to components. This will be used if the imported RawLicense data is either incomplete or incorrect. Items which have been processed by rules of this group will not be reprocessed by the next rule group.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>LHS conditions:</p>
<div class="ulist">
<ul>
<li>
<p><code>Engagement.clientName</code></p>
</li>
<li>
<p><code>Engagement.engagementName</code></p>
</li>
<li>
<p><code>Application.applicationName</code></p>
</li>
<li>
<p><code>ApplicationComponent.groupId</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>ApplicationCompomnent.artifactId</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>ApplicationComponent.version</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>RawLicense.declaredLicense</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>RawLicense.url</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>RHS result:</p>
<div class="ulist">
<ul>
<li>
<p><code>NormalizedLicense.normalizedLicenseType</code></p>
</li>
<li>
<p><code>NormalizedLicense.normalizedLicense</code></p>
</li>
<li>
<p><code>NormalizedLicense.normalizedLicenseUrl</code></p>
</li>
<li>
<p><code>NormalizedLicense.comment</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-magic"></i></span>: On these fields the <a href="#extended-comparison-syntax">Extended comparison syntax</a> might be used</p>
</div>
<div class="paragraph">
<p>All RawLicenses which are in scope of fired rules will be marked so that they do not get reprocessed by the following decision table.</p>
</div>
</div>
<div class="sect2">
<h3 id="decision-table-detecting-licenses-from-imported-data"><a class="anchor" href="#decision-table-detecting-licenses-from-imported-data"></a>26.79. ==  Decision Table: Detecting Licenses from Imported Data</h3>
<div class="paragraph">
<p>With this decision table the license info from the RawLicense is mapped to the NormalizedLicense. This is based on the name and/or URL of the license as imported via the readers.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>LHS conditions:</p>
<div class="ulist">
<ul>
<li>
<p><code>RawLicense.declaredLicense</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>RawLicense.url</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
</ul>
</div>
</li>
<li>
<p>RHS result:</p>
<div class="ulist">
<ul>
<li>
<p><code>NormalizedLicense.normalizedLicenseType</code></p>
</li>
<li>
<p><code>NormalizedLicense.normalizedLicense</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-magic"></i></span>: On these fields the <a href="#extended-comparison-syntax">Extended comparison syntax</a> might be used</p>
</div>
</div>
<div class="sect2">
<h3 id="phase-2-selecting-applicable-licenses"><a class="anchor" href="#phase-2-selecting-applicable-licenses"></a>26.80. Phase 2: Selecting applicable Licenses</h3>
<div class="paragraph">
<p>Within this phase the actually applicable licenses will be selected for each component.</p>
</div>
<div class="paragraph">
<p>This phase consists of two decision tables.</p>
</div>
</div>
<div class="sect2">
<h3 id="choosing-specific-license-in-case-of-multi-licensing"><a class="anchor" href="#choosing-specific-license-in-case-of-multi-licensing"></a>26.81. ==  Choosing specific License in case of Multi-Licensing</h3>
<div class="paragraph">
<p>This group of rules has the speciality that it might match to a group of NormalizedLicenses associated to an ApplicationComponent. In case that multiple licenses are associated to an ApplicationComponent one of them might be selected as "effective" license and the others might be marked as <code>Ignored</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>LHS conditions:</p>
<div class="ulist">
<ul>
<li>
<p><code>ApplicationComponent.groupId</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>ApplicationComponent.artifactId</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>ApplicationComponent.version</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>NormalizedLicense.normalizedLicense</code> (licenseToTake; mandatory)</p>
</li>
<li>
<p><code>NormalizedLicense.normalizedLicense</code> (licenseToIgnore1; mandatory)</p>
</li>
<li>
<p><code>NormalizedLicense.normalizedLicense</code> (licenseToIgnore2; optional)</p>
</li>
<li>
<p><code>NormalizedLicense.normalizedLicense</code> (licenseToIgnore3; optional)</p>
</li>
</ul>
</div>
</li>
<li>
<p>RHS result</p>
<div class="ulist">
<ul>
<li>
<p>license matching "licenseToTake" will get this value assigned to <code>effectiveNormalizedLicense</code></p>
</li>
<li>
<p>licenses matching "licenseToIgnoreN" will get <code>IGNORED</code> assigned to <code>effectiveNormalizedLicenseType</code> <code>Ignored</code> assigned to <code>effectiveNormalizedLicense</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-magic"></i></span>: On these fields the <a href="#extended-comparison-syntax">Extended comparison syntax</a> might be used</p>
</div>
<div class="paragraph">
<p>It is important to note that the rules only match, if all licenses given in the conditions actually exist and are assigned to the same ApplicationComponent.</p>
</div>
</div>
<div class="sect2">
<h3 id="selecting-overriding-applicable-license"><a class="anchor" href="#selecting-overriding-applicable-license"></a>26.82. ==  Selecting / Overriding applicable License</h3>
<div class="paragraph">
<p>The second decision table in this group is used to define the <code>effectiveNormalizedLicense</code> (if not already handled by the decision table before).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>LHS conditions:</p>
<div class="ulist">
<ul>
<li>
<p><code>ApplicationComponent.groupId</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>ApplicationComponent.artifactId</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>ApplicationComponent.version</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>NormalizedLicense.normalizedLicenseType</code></p>
</li>
<li>
<p><code>NormalizedLicense.normalizedLicense</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>RHS result:</p>
<div class="ulist">
<ul>
<li>
<p><code>NormalizedLicense.effectiveNormalizedLicenseType</code> (if empty in the decision table then the value of <code>normalizedLicenseType</code> will be taken)</p>
</li>
<li>
<p><code>NormalizedLicense.effectiveNormalizedLicense</code> (if empty in the decision table then the value of <code>normalizedLicense</code> will be taken)</p>
</li>
<li>
<p><code>NormalizedLicense.effectiveNormalizedLicenseUrl</code> (if empty in the decision table then the value of <code>normalizedLicenseUrl</code> will be taken)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-magic"></i></span>: On these fields the <a href="#extended-comparison-syntax">Extended comparison syntax</a> might be used</p>
</div>
</div>
<div class="sect2">
<h3 id="phase-3-legal-evaluation"><a class="anchor" href="#phase-3-legal-evaluation"></a>26.83. Phase 3: Legal evaluation</h3>
<div class="paragraph">
<p>The third phase ist the legal evaluation of the licenses and the check, whether OSS usage is according to defined legal policies. Again this phase comprises two decision tables.</p>
</div>
</div>
<div class="sect2">
<h3 id="pre-evaluation-based-on-common-rules"><a class="anchor" href="#pre-evaluation-based-on-common-rules"></a>26.84. ==  Pre-Evaluation based on common rules</h3>
<div class="paragraph">
<p>Within the pre evaluation the license info is checked against standard OSS usage policies. This roughly qualifies the usage and might already determine licenses which are OK in any case or which need to be further evaluated. Furtheron they qualify whether the license text or source code needs to be included in the distribution. The rules in this decision table are only based on the <code>effectiveNormalizedLicense</code> and do not consider any project, application of component information.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>LHS condition:</p>
<div class="ulist">
<ul>
<li>
<p><code>NormalizedLicense.effectiveNormalizedLicenseType</code></p>
</li>
<li>
<p><code>NormalizedLicense.effectiveNormalizedLicense</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>RHS result:</p>
<div class="ulist">
<ul>
<li>
<p><code>NormalizedLicense.legalPreApproved</code></p>
</li>
<li>
<p><code>NormalizedLicense.copyLeft</code></p>
</li>
<li>
<p><code>NormalizedLicense.licenseCompliance</code></p>
</li>
<li>
<p><code>NormalizedLicense.licenseRefUrl</code></p>
</li>
<li>
<p><code>NormalizedLicense.includeLicense</code></p>
</li>
<li>
<p><code>NormalizedLicense.includeSource</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="final-evaluation"><a class="anchor" href="#final-evaluation"></a>26.85. ==  Final evaluation</h3>
<div class="paragraph">
<p>The decision table for final legal evaluation defines all rules which are needed
to create the result of the legal evaluation. Rules here might be general for all projects or even very specific to a project if the rule can not be applied to other projects.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>LHS condition:</p>
<div class="ulist">
<ul>
<li>
<p><code>Engagement.clientName</code></p>
</li>
<li>
<p><code>Engagement.engagementName</code></p>
</li>
<li>
<p><code>Engagement.customerProvidesOss</code></p>
</li>
<li>
<p><code>Application.applicationName</code></p>
</li>
<li>
<p><code>ApplicationComponent.groupId</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>ApplicationComponent.artifactId</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>ApplicationComponent.version</code> <span class="icon"><i class="fa fa-magic"></i></span></p>
</li>
<li>
<p><code>ApplicationComponent.usagePattern</code></p>
</li>
<li>
<p><code>ApplicationComponent.ossModified</code></p>
</li>
<li>
<p><code>NormalizedLicense.effectiveNormalizedLicenseType</code></p>
</li>
<li>
<p><code>NormalizedLicense.effectiveNormalizedLicense</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>RHS result:</p>
<div class="ulist">
<ul>
<li>
<p><code>NormalizedLicense.legalApproved</code></p>
</li>
<li>
<p><code>NormalizedLicense.legalComments</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-magic"></i></span>: On these fields the <a href="#extended-comparison-syntax">Extended comparison syntax</a> might be used</p>
</div>
</div>
<div class="sect2">
<h3 id="amending-the-builtin-decision-tables-with-own-rules"><a class="anchor" href="#amending-the-builtin-decision-tables-with-own-rules"></a>26.86. Amending the builtin decision tables with own rules</h3>
<div class="paragraph">
<p>The standard process as described before consists of 6 decision tables / rule
groups to be processed in sequence. When using the builtin base configuration all those decision tables use the internal sample data / rules as contained in <em>Solicitor</em>.</p>
</div>
<div class="paragraph">
<p>To use your own rule data there are three approaches:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Include your own <code>rules</code> section in the project configuration file (so not inheriting from
the builtin base configuration file) and reference your own decision tables there.</p>
</li>
<li>
<p>Create your own "Solicitor Extension" which might completely redefine/replace the buitin <code>Solicitor</code> setup including all decision tables and the base configuration file. See <a href="#extending-solicitor">Extending Solicitor</a> for details.</p>
</li>
<li>
<p>Make use of the optional project specific decision tables which are defined in the default base configuration: For every builtin decision table there is an optional external decision table (expected in the filesystem) which will be checked for existence. If such external decision table exists it will be processed first - before processing the builtin decision table. Thus is it possible to amend / override the builtin rules by project specific rules. When you create the starter configuration of your project as described in <a href="#starting-a-new-project">Starting a new project</a>, those project specific decision tables are automatically created.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="reporting-creating-output-documents"><a class="anchor" href="#reporting-creating-output-documents"></a>26.87. Reporting / Creating output documents</h3>
<div class="paragraph">
<p>After applying the business rules the resulting data can can be used to create reports and
other output documents.</p>
</div>
<div class="paragraph">
<p>Creating such reports consists of three steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>transform and filter the model data by using an embedded SQL database</p>
</li>
<li>
<p>determining difference to previously stored model (optional)</p>
</li>
<li>
<p>Template based reporting via</p>
<div class="ulist">
<ul>
<li>
<p>Velocity templates (for textual output like e.g. HTML)</p>
</li>
<li>
<p>Excel templates</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="sql-transformation-and-filtering"><a class="anchor" href="#sql-transformation-and-filtering"></a>26.88. SQL transformation and filtering</h3>

</div>
<div class="sect2">
<h3 id="database-structure"><a class="anchor" href="#database-structure"></a>26.89. ==  Database structure</h3>
<div class="paragraph">
<p>After the business rules have been processed (or a Solicitor data model has been loaded via
command line option <code>-l</code>) the model data is stored in a dynamically created internal SQL database.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For each type of model object a separate table is created. The tablename is the name of model object type written in uppercase characters. (E.g. type <code>NormalizedLicense</code> stored in table <code>NORMALIZEDLICENSE</code>)</p>
</li>
<li>
<p>All properties of the model objects are stored as strings in fields named like the properties within the database table. Field names are case sensitive (see note below for handling this in SQL statements).</p>
</li>
<li>
<p>An additional primary key is defined for each table, named <code>ID_&lt;TABLENAME&gt;</code>.</p>
</li>
<li>
<p>For all model elements that belong to some parent in the object hierarchy (i.e. all objects except <code>ModelRoot</code>) a foreign key field is added named <code>PARENT_&lt;TABLENAME&gt;</code> which contains the unique key of the corresponding parent</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="sql-queries-for-filtering-and-transformation"><a class="anchor" href="#sql-queries-for-filtering-and-transformation"></a>26.90. ==  SQL queries for filtering and transformation</h3>
<div class="paragraph">
<p>Each Writer configuration (see <a href="#Writers / Reporting">[Writers / Reporting]</a>) includes a section which references SQL select statements that are applied on the database data. The result of the SQL select statements is made accessible for the subsequent processing of the Writer via the dataTable name given in the configuration.</p>
</div>
</div>
<div class="sect2">
<h3 id="postprocessing-of-data-selected-from-the-database-tables"><a class="anchor" href="#postprocessing-of-data-selected-from-the-database-tables"></a>26.91. ==  Postprocessing of data selected from the database tables</h3>
<div class="paragraph">
<p>Before the result of the SQL select statement is handed over to the Writer the following postprocessing
is done:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <code>rowCount</code> column is added to the result which gives the position of the entry in the result set (starting with 1).</p>
</li>
<li>
<p>Columns named <code>ID_&lt;TABLENAME&gt;</code> are replaced with columns named <code>OBJ_&lt;TABLENAME&gt;</code>. The fields of those columns are filled with the corresponding original model objects (java objects).</p>
</li>
</ul>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The result table column <code>OBJ_&lt;TABLENAME&gt;</code> gives access to the native Solicitor data model (java objects), e.g. in the Velocity writer. As this breaks the decoupling done via the SQL database using this feature is explicitely discouraged. It should only be used with high caution and in exceptional situations. The feature might be discontinued in future versions without prior notice.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="determining-difference-to-previously-stored-model"><a class="anchor" href="#determining-difference-to-previously-stored-model"></a>26.92. Determining difference to previously stored model</h3>
<div class="paragraph">
<p>When using the command line option <code>-d</code> <em>Solicitor</em> can determine difference information between two different data models (e.g. the difference between the licenses of the current release and a former release.) The difference is calculated on the result of the above described SQL statements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First the internal reporting database is created for the current data model and all defined SQL statements are executed</p>
</li>
<li>
<p>Then the internal database is recreated for the "old" data model and all defined SQL stements are executed again</p>
</li>
<li>
<p>Finally for each defined result table the difference between the current result and the "old" result
is calculated</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To correctly correlate corresponding rows of the two different versions of table data it is necessary to define explicit correlation keys for each table in the SQL select statement.
It is possible to define up to 10 correlation keys named <code>CORR_KEY_X</code> with X in the range from 0 to 9. <code>CORR_KEY_0</code> has highest priority, <code>CORR_KEY_9</code> has lowest priority.</p>
</div>
<div class="paragraph">
<p>The correlation algorithm will first try to match rows using <code>CORR_KEY_0</code>. It will then attempt to correlate unmatched rows using <code>CORR_KEY_1</code> e.t.c.. Correlation will stop, when</p>
</div>
<div class="ulist">
<ul>
<li>
<p>all correlations keys <code>CORR_KEY_0</code> to <code>CORR_KEY_9</code> have been processed OR</p>
</li>
<li>
<p>the required correlation key column does not exist in the SQL select result OR</p>
</li>
<li>
<p>there are no unmatched "new" rows OR</p>
</li>
<li>
<p>there are no unmatched "old" rows</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The result of the correlation / difference calulation is stored in the reporting table data structure. For each row the status is accessible if</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The row is "new" (did not exist in the old data)</p>
</li>
<li>
<p>The row is unchanged (no changes in the field values representing the properties of the <em>Solicitor</em> data model)</p>
</li>
<li>
<p>The row is changed (at least one field corresponding to the <em>Solicitor</em> data model changed)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For each field of "changed" or "unchanged" rows the following status is available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Field is "changed"</p>
</li>
<li>
<p>Field is "unchanged"</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For each field of such rows it is furtheron possible to access the new and the old field value.</p>
</div>
</div>
<div class="sect2">
<h3 id="sample-sql-statement"><a class="anchor" href="#sample-sql-statement"></a>26.93. Sample SQL statement</h3>
<div class="paragraph">
<p>The following shows a sample SQL statement showing some join over multiple tables and the use of
correlations keys.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">Unresolved include directive in modules/ROOT/pages/solicitor.wiki/master-solicitor.adoc - include::../resources/com/devonfw/tools/solicitor/sql/allden_normalizedlicenses.sql[]</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Above example also shows how the case sensitive column names have to be handled within the SQL
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="writers"><a class="anchor" href="#writers"></a>26.94. Writers</h3>
<div class="paragraph">
<p>The above dscribed SQL processing is identical for all Writers. Writers only differ in the
way how the output document is created based on a template and the reporting table data
obtained by the SQL transformation.</p>
</div>
</div>
<div class="sect2">
<h3 id="velocity-writer"><a class="anchor" href="#velocity-writer"></a>26.95. ==  Velocity Writer</h3>
<div class="paragraph">
<p>The Velocity Writer uses the <a href="https://velocity.apache.org/">Apache Velocity Templating Engine</a>
to create text based reports. The reporting data tables created by the SQL transformation are
directly put to the into Velocity Context.</p>
</div>
<div class="paragraph">
<p>For further information see the</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Velocity Documentation</p>
</li>
<li>
<p>The <em>Solicitor</em> JavaDoc (which also includes datails on how to access the diff information for rows and fields of reporting data tables)</p>
</li>
<li>
<p>The samples included in <em>Solicitor</em></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="excel-writer"><a class="anchor" href="#excel-writer"></a>26.96. ==  Excel Writer</h3>

</div>
<div class="sect2">
<h3 id="using-placeholders-in-excel-spreadsheets"><a class="anchor" href="#using-placeholders-in-excel-spreadsheets"></a>26.97. == Using Placeholders in Excel Spreadsheets</h3>
<div class="paragraph">
<p>Within Excel spreadsheet templates there are two kinds of placeholders / markers possible, which control the processing:</p>
</div>
</div>
<div class="sect2">
<h3 id="iterator-control"><a class="anchor" href="#iterator-control"></a>26.98. == Iterator Control</h3>
<div class="paragraph">
<p>The templating logic searches within the XLSX workbook for fields containing the names of the
reporting data tables as defined in the Writer configuration like e.g.:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>#ENGAGEMENT#</code></p>
</li>
<li>
<p><code>#LICENSE#</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Whenever such a string is found in a cell this indicates that this row is a template row. For each entry in the respective resporting data table a copy of this row is created and the attribute replacement will be done with the data from that reporting table. (The pattern <code>#&#8230;&#8203;#</code> will be removed when copying.)</p>
</div>
</div>
<div class="sect2">
<h3 id="attribute-replacement"><a class="anchor" href="#attribute-replacement"></a>26.99. == Attribute replacement</h3>
<div class="paragraph">
<p>Within each row which was copied in the previous step the templating logic searches for the string pattern <code>$someAttributeName$</code> where <code>someAttributeName</code> corresponds to the column names of the reporting table. Any such occurence is replaced with the corresponding data value.</p>
</div>
</div>
<div class="sect2">
<h3 id="representation-of-diff-information"><a class="anchor" href="#representation-of-diff-information"></a>26.100. == Representation of Diff Information</h3>
<div class="paragraph">
<p>In case that a difference processing (new vs. old model data) was done this will be represented
as follows when using the XLS templating:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For rows that are "new" (so no corresponding old row available) an Excel note indicating that this row is new will be attached to the field that contained the <code>#&#8230;&#8203;#</code> placeholder.</p>
</li>
<li>
<p>Fields in non-new rows that have changed their value will be marked with an Excel note indicating the old value.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="resolving-of-license-urls"><a class="anchor" href="#resolving-of-license-urls"></a>26.101. Resolving of License URLs</h3>
<div class="paragraph">
<p>Resolving of the content of license texts which are referenced by the URLs given in <code>NormalizedLicense</code> is done in the following way:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the content is found as a resource in the classpath under <code>licenses</code> this will be taken. (The <em>Solicitor</em> application might include a set of often used license texts and thus it is not necessary to fetch those via the net.) If the classpath does not contain the content of the URL the next step is taken.</p>
</li>
<li>
<p>If the content is found as a file in subdirectory <code>licenses</code> of the current working directory this is taken. If no such file exists the content is fetched via the net. The result will be written to the file directory, so any content will only be fetched once. (The user might alter the files in that directory to change/correct its content.) A file of length zero indicates that no content could be fetched.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="encoding-of-urls"><a class="anchor" href="#encoding-of-urls"></a>26.102. Encoding of URLs</h3>
<div class="paragraph">
<p>When creating the resource or filename for given URLs in the above steps the following encoding scheme will be applied to ensure that always a valid name can be created:</p>
</div>
<div class="paragraph">
<p>All "non-word" characters (i.e. characters outside the set <code>[a-zA-Z_0-9]</code>) are replaced by underscores (&#8220;_&#8221;).</p>
</div>
</div>
<div class="sect2">
<h3 id="feature-deprecation"><a class="anchor" href="#feature-deprecation"></a>26.103. Feature Deprecation</h3>
<div class="paragraph">
<p>Within the lifecycle of the <em>Solicitor</em> development features might be discontinued due
to various reasons. In case that such discontinuation is expected to break existing projects
a two stage deprecation mechanism is used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Stage 1: Usage of a deprecated feature will produce a <em>warning only</em> giving details on
what needs to be changed.</p>
</li>
<li>
<p>Stage 2: When a deprecated feature is used <em>Solicitor</em> by default will terminate with an error
message giving information about the deprecation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By setting the property <code>solicitor.deprecated-features-allowed</code> to <code>true</code>
(e.g. via the command line, see <a href="#configuration-of-technical-properties">Configuration of Technical Properties</a>), even in second stage
the feature will still be available and only a warning will be logged. The project setup should in any
case ASAP be changed to no longer use the feature as it might soon be removed without further
notice.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Enabling the use of deprecated feature via the above property should only be
a temporary workaround and not a standard setting.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If usage of a feature should be discontinued immediately (e.g. because it might lead to
wrong/misleading output) the first stage of deprecation will be skipped.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="list-of-deprecated-features"><a class="anchor" href="#list-of-deprecated-features"></a>26.104. List of Deprecated Features</h3>
<div class="paragraph">
<p>The following features are deprecated via the above mechanism:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reader of type "gradle"  (use Reader of type "gradle2" instead); Stage 2 from Version 1.0.5 on; see <a href="https://github.com/devonfw/solicitor/issues/58" class="bare">https://github.com/devonfw/solicitor/issues/58</a></p>
</li>
<li>
<p>Reader of type "npm" (use type "npm-license-crawler-csv" instead); Stage 1 from Version 1.0.8 on; see <a href="https://github.com/devonfw/solicitor/issues/62" class="bare">https://github.com/devonfw/solicitor/issues/62</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="default-base-configuration"><a class="anchor" href="#default-base-configuration"></a>Appendix A: Default Base Configuration</h3>
<div class="paragraph">
<p>The builtin default base configuration contains settings for the <code>rules</code> and <code>writers</code> section
of the <em>Solicitor</em> configuration file which will be used if the project specific config file omits those sections.</p>
</div>
<div class="listingblock">
<div class="title">Listing 152. Default Configuration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">Unresolved include directive in modules/ROOT/pages/solicitor.wiki/master-solicitor.adoc - include::../resources/com/devonfw/tools/solicitor/config/solicitor_base.cfg[]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="built-in-default-properties"><a class="anchor" href="#built-in-default-properties"></a>Appendix B: Built in Default Properties</h3>
<div class="paragraph">
<p>The following lists the default settings of technical properties as given by the built in <code>application.properties</code> file.</p>
</div>
<div class="paragraph">
<p>If required these values might be overridden on the command line when starting <code>Solicitor</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -Dpropertyname1=value1 -Dpropertyname2=value2 -jar solicitor.jar &lt;any other arguments&gt;</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Listing 153. application.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">Unresolved include directive in modules/ROOT/pages/solicitor.wiki/master-solicitor.adoc - include::../resources/application.properties[]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="extending-solicitor"><a class="anchor" href="#extending-solicitor"></a>Appendix C: Extending Solicitor</h3>
<div class="paragraph">
<p><code>Solicitor</code> comes with a sample rule data set and sample reporting templates. In general it will
be required to correct, supplement and extend this data sets and templates. This can be done straightforward
by creating copies of the appropriate resources (rule data XLS and template files), adopting them and furtheron referencing those copies instead of the original resources from the project configuration file.</p>
</div>
<div class="paragraph">
<p>Even though this approach is possible it will result in hard to maintain configurations,
especially in the case of multiple projects using <code>Solicitor</code> in parallel.</p>
</div>
<div class="paragraph">
<p>To support such scenarios <code>Solicitor</code> provides an easy extension mechanism which allows
to package all those customized configurations into a single archive and reference it from the
command line when starting <code>Solicitor</code>.</p>
</div>
<div class="paragraph">
<p>This facilitates configuration management, distribution and deployment of such extensions.</p>
</div>
</div>
<div class="sect2">
<h3 id="format-of-the-extension-file"><a class="anchor" href="#format-of-the-extension-file"></a>26.105. Format of the extension file</h3>
<div class="paragraph">
<p>The extensions might be provided as JAR file or even as a simple ZIP file. There is only
one mandatory file which contains (at least metadata) about the extension and which needs
to be included in this archive <em>in the root folder</em>.</p>
</div>
<div class="listingblock">
<div class="title">Listing 154. application-extension.properties</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">Unresolved include directive in modules/ROOT/pages/solicitor.wiki/master-solicitor.adoc - include::../resources/samples/application-extension.properties[]</code></pre>
</div>
</div>
<div class="paragraph">
<p>This file is included via the standard Spring Boot profile mechanism. Besides containing
naming and version info on the extension this file might override any
property values defined within <code>Solicitor</code>.</p>
</div>
<div class="paragraph">
<p>Any other resources (like rule data or templates) which need to be part of the Extension
can be included in the archive as well - either in the root directory or any subdirectories.
If the extension is active those resources will be available <em>on the classpath</em> like any
resources included in the <em>Solicitor</em> jar.</p>
</div>
<div class="paragraph">
<p>Overriding / redefining the default base configuration within the Extension enables to
update all rule data and templates without the need to touch the projects configuration
file.</p>
</div>
</div>
<div class="sect2">
<h3 id="activating-the-extension"><a class="anchor" href="#activating-the-extension"></a>26.106. Activating the Extension</h3>
<div class="paragraph">
<p>The Extension will be activated by referencing it as follows when starting <em>Solicitor</em>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>java -Dloader.path=path/to/the/extension.zip -jar solicitor.jar &lt;any other arguments&gt;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="release-notes"><a class="anchor" href="#release-notes"></a>Appendix D: Release Notes</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Changes in 1.1.1</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>Corrected order of license name mapping which prevented Unlicense, The W3C License, WTFPL, Zlib and
Zope Public License 2.1 to be mapped.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Changes in 1.1.0</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/solicitor/issues/67" class="bare">https://github.com/devonfw/solicitor/issues/67</a>: Inclusion of detailed license information for the
dependencies included in the executable JAR. Use the '-eug' command line option to store this file
(together with a copy of the user guide) in the current work directory.</p>
</li>
<li>
<p>Additional rules for license name mappings in decision table LicenseNameMappingSample.xls.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/solicitor/pull/61" class="bare">https://github.com/devonfw/solicitor/pull/61</a>: Solicitor can now run with Java 8 or Java 11.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Changes in 1.0.8</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/solicitor/issues/62" class="bare">https://github.com/devonfw/solicitor/issues/62</a>: New Reader of type <code>npm-license-checker</code>
for reading component/license data collected by NPM License Checker (<a href="https://www.npmjs.com/package/license-checker" class="bare">https://www.npmjs.com/package/license-checker</a>).
The type of the existing Reader for reading CSV data from the NPM License Crawler has been changed from <code>npm</code>
to <code>npm-license-crawler-csv</code>. (<code>npm</code> is still available but deprecated.) Projects should adopt their Reader
configuration and replace type <code>npm</code> by <code>npm-license-crawler-csv</code>.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Changes in 1.0.7</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/solicitor/issues/56" class="bare">https://github.com/devonfw/solicitor/issues/56</a>: Enable continuing analysis in
multiapplication projects even is some license files are unavailable.</p>
</li>
<li>
<p>Described simplified usage of license-maven-plugin without need to change pom.xml. (Documentation only)</p>
</li>
<li>
<p>Ensure consistent sorting even in case that multiple "Ignored" licenses exist for a component</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-shop-floor"><a class="anchor" href="#devonfw-shop-floor"></a>26.107. devonfw shop floor</h3>
<div class="paragraph internal">
<p>devonfw-shop-floor</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cicd"><a class="anchor" href="#cicd"></a>27. CI/CD</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are different CICD tools:</p>
</div>
<div class="paragraph internal">
<p>production-line-link</p>
</div>
<div class="paragraph">
<p>==cicdgen</p>
</div>
<!-- toc disabled -->
<div class="paragraph">
<p>==CICDGEN</p>
</div>
<div class="paragraph">
<p>cicdgen is a devonfw tool for generate all code/files related to CICD. It will include/modify into your project all files that the project needs run a Jenkins cicd pipeline, to create a docker image based on your project, etc. It’s based on angular schematics, so you can add it as a dependency into your project and generate the code using ng generate. In addition, it has its own CLI for those projects that are not angular based.</p>
</div>
<div class="sect3">
<h4 id="what-is-angular-schematics"><a class="anchor" href="#what-is-angular-schematics"></a>27.1. What is angular schematics?</h4>
<div class="paragraph">
<p>Schematics are generators that transform an existing <code>filesystem</code>. They can create files, refactor existing files, or move files from one place to another.</p>
</div>
<div class="paragraph">
<p>What distinguishes Schematics from other generators, such as Yeoman or Yarn Create, is that schematics are purely descriptive; no changes are applied to the actual <code>filesystem</code> until everything is ready to be committed. There is no side effect, by design, in Schematics.</p>
</div>
</div>
<div class="sect3">
<h4 id="cicdgen-cli"><a class="anchor" href="#cicdgen-cli"></a>27.2. cicdgen CLI</h4>
<div class="paragraph">
<p>In order to know more about how to use the cicdgen CLI, you can check the <a href="cicdgen-cli.adoc">CLI page</a></p>
</div>
</div>
<div class="sect3">
<h4 id="cicdgen-schematics"><a class="anchor" href="#cicdgen-schematics"></a>27.3. cicdgen Schematics</h4>
<div class="paragraph">
<p>In order to know more about how to use the cicdgen schematics, you can check the <a href="cicdgen-schematics.adoc">schematics page</a></p>
</div>
</div>
<div class="sect3">
<h4 id="usage-example"><a class="anchor" href="#usage-example"></a>27.4. Usage example</h4>
<div class="paragraph">
<p>A <a href="usage-example.adoc">specific page</a> about how to use cicdgen is also available.</p>
</div>
</div>
<div class="sect2">
<h3 id="cicdgen-cli-2"><a class="anchor" href="#cicdgen-cli-2"></a>27.5. cicdgen CLI</h3>
<!-- toc disabled -->
<div class="sect4">
<h5 id="cicdgen-cli-3"><a class="anchor" href="#cicdgen-cli-3"></a>CICDGEN CLI</h5>
<div class="paragraph">
<p>cicdgen is a command line interface that helps you with some CICD in a devonfw project. At this moment we can only generate files related to CICD in a project but we plan to add more functionality in a future.</p>
</div>
<div class="sect5">
<h6 id="installation"><a class="anchor" href="#installation"></a>Installation</h6>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ npm i -g @devonfw/cicdgen</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="usage-10"><a class="anchor" href="#usage-10"></a>Usage</h6>
<div class="sect6">
<h7 id="global-arguments"><a class="anchor" href="#global-arguments"></a>Global arguments</h7>
<div class="ulist">
<ul>
<li>
<p>--version</p>
<div class="literalblock">
<div class="content">
<pre>Prints the cicdgen version number</pre>
</div>
</div>
</li>
<li>
<p>--help</p>
<div class="literalblock">
<div class="content">
<pre>Shows the usage of the command</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect6">
<h7 id="commands"><a class="anchor" href="#commands"></a>Commands</h7>
<div class="sect7">
<h8 id="generate"><a class="anchor" href="#generate"></a>Generate.</h8>
<div class="paragraph">
<p>This command wraps the usage of angular schematics CLI. With this we generate files in a easy way and also print a better help about usage.</p>
</div>
<div class="paragraph">
<p>Available schematics that generate the code:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="devon4j/devon4j-schematic.adoc">devon4j</a></p>
</li>
<li>
<p><a href="devon4j/devon4ng-schematic.adoc">devon4ng</a></p>
</li>
<li>
<p><a href="devon4j/devon4net-schematic.adoc">devon4net</a></p>
</li>
<li>
<p><a href="devon4j/devon4node-schematic.adoc">devon4node</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect6">
<h7 id="examples-2"><a class="anchor" href="#examples-2"></a>Examples</h7>
<div class="ulist">
<ul>
<li>
<p>Generate all CICD files related to a devon4j project</p>
<div class="listingblock">
<div class="content">
<pre>$ cicdgen generate devon4j</pre>
</div>
</div>
</li>
<li>
<p>Generate all CICD files related to a devon4ng project with docker deployment.</p>
<div class="listingblock">
<div class="content">
<pre>$ cicdgen generate devon4ng --groupid com.devonfw --docker --registryurl docker-registry-devon.s2-eu.capgemini.com</pre>
</div>
</div>
</li>
<li>
<p>Generate all CICD files related to a devon4node project with OpenShift deployment.</p>
<div class="listingblock">
<div class="content">
<pre>$ cicdgen generate devon4ng --groupid com.devonfw --openshift --registryurl docker-registry-devon.s2-eu.capgemini.com --ocname default --ocn devonfw</pre>
</div>
</div>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect4">
<h5 id="cicdgen-usage-example"><a class="anchor" href="#cicdgen-usage-example"></a>cicdgen usage example</h5>
<div class="paragraph">
<p>In this example we are going to show how to use cicdgen step by step in a devon4ng project.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install cicdgen</p>
<div class="paragraph">
<p>cicdgen is already included in the devonfw distribution, but if you want to use it outside the devonfw console you can execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ npm i -g cicdgen</pre>
</div>
</div>
</li>
<li>
<p>Generate a new devon4ng project using devonfw ide.</p>
<div class="paragraph">
<p>Inside a devonfw ide distribution execute the command (<code>devon ng create &lt;app-name&gt;</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ devon ng create devon4ng</pre>
</div>
</div>
</li>
<li>
<p>Execute cicdgen generate command</p>
<div class="paragraph">
<p>As we want to send notifications to MS Teams, we need to create the connector first:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Go to a channel in teams and click at the connectors button. Then click at the jenkins configure button.</p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/teams-1.png" alt="teams 1"></span></p>
</div>
</li>
<li>
<p>Put a name for the connector</p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/teams-2.png" alt="teams 2"></span></p>
</div>
</li>
<li>
<p>Copy the name and the Webhook URL, we will use it later.</p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/teams-3.png" alt="teams 3"></span></p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>With the values that we get in the previous steps, we will execute the cicdgen command inside the project folder. If you have any doubt you can use the help.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/help-1.png" alt="help 1"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/help-2.png" alt="help 2"></span></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cicdgen generate devon4ng --groupid com.devonfw --docker --dockerurl tpc://127.0.0.1:2376 `--registryurl docker-registry-devon.s2-eu.capgemini.com --teams --teamsname devon4ng --teamsurl https://outlook.office.com/webhook/...`</pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/cicdgen-command.png" alt="cicdgen command"></span></p>
</div>
</li>
<li>
<p>Create a git repository and upload the code</p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/gitlab.png" alt="gitlab"></span></p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/gitlab-2.png" alt="gitlab 2"></span></p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ git remote add origin https://devon.s2-eu.capgemini.com/gitlab/darrodri/devon4ng.git
$ git push -u origin master</pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/push-code.png" alt="push code"></span></p>
</div>
<div class="paragraph">
<p>As you can see, no git init or git commit is required, cicdgen do it for you.</p>
</div>
</li>
<li>
<p>Create a multibranch-pipeline in Jenkins</p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/new-pipeline.png" alt="new pipeline"></span></p>
</div>
<div class="paragraph">
<p>When you push the save button, it will download the repository and execute the pipeline defined in the Jenkinsfile. If you get any problem, check the environment variables defined in the Jenkinsfile. Here we show all variables related with Jenkins:</p>
</div>
<div class="openblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>chrome</p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/chrome-stable.png" alt="chrome stable"></span></p>
</div>
</li>
<li>
<p><code>sonarTool</code></p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/sonar-tool.png" alt="sonar tool"></span></p>
</div>
</li>
<li>
<p><code>sonarEnv</code></p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/sonar-env.png" alt="sonar env"></span></p>
</div>
</li>
<li>
<p><code>repositoryId</code></p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/repository-id.png" alt="repository id"></span></p>
</div>
</li>
<li>
<p><code>globalSettingsId</code></p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/global-settings-id.png" alt="global settings id"></span></p>
</div>
</li>
<li>
<p><code>mavenInstallation</code></p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/maven-installation.png" alt="maven installation"></span></p>
</div>
</li>
<li>
<p><code>dockerTool</code></p>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/docker-global.png" alt="docker global"></span></p>
</div>
</li>
</ul>
</div>
</div>
</div>
</li>
<li>
<p>Add a <code>webhook</code> in GitLab</p>
<div class="paragraph">
<p>In order to run the pipeline every time that you push code to GitLab, you need to configure a <code>webhook</code> in your repository.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/example/gitlab-webhook.png" alt="gitlab webhook"></span></p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now your project is ready to work following a CICD strategy.</p>
</div>
<div class="paragraph">
<p>The last thing to take into account is the branch naming. We prepare the pipeline in order to work following the git-flow strategy. So all stages of the pipeline will be executed for the branches: develop, release/*, master. For the branches: feature/*, <code>hotfix</code>/*, bugfix/* only the steps related to unit testing will be executed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cicdgen-schematics-2"><a class="anchor" href="#cicdgen-schematics-2"></a>27.6. cicdgen Schematics</h3>
<!-- toc disabled -->
<div class="sect4">
<h5 id="cicdgen-schematics-3"><a class="anchor" href="#cicdgen-schematics-3"></a>CICDGEN SCHEMATICS</h5>
<div class="paragraph">
<p>We use angular schematics to create and update an existing devonfw project in order to adapt it to a CICD environment. All schematics are prepared to work with Production Line, a Capgemini CICD platform, but it can also work in other environment which have the following tools:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Jenkins</p>
</li>
<li>
<p>GitLab</p>
</li>
<li>
<p>Nexus 3</p>
</li>
<li>
<p>SonarQube</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The list of available schematics are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="./devon4j-schematic.adoc">devon4j</a></p>
</li>
<li>
<p><a href="./devon4ng-schematic.adoc">devon4ng</a></p>
</li>
<li>
<p><a href="./devon4net-schematic.adoc">devon4net</a></p>
</li>
<li>
<p><a href="./devon4node-schematic.adoc">devon4node</a></p>
</li>
</ul>
</div>
<div class="sect5">
<h6 id="how-to-run-the-schematics"><a class="anchor" href="#how-to-run-the-schematics"></a>How to run the schematics</h6>
<div class="paragraph">
<p>You can run the schematics using the schematics CLI provided by the angular team, but the easiest way to run it is using the <a href="cicdgen-cli">cicdgen CLI</a> which is a wrapper for the schematics CLI in order to use it in a easy way.</p>
</div>
<div class="paragraph">
<p>To generate files you only need to run the command</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cicdgen generate &lt;schematic-name&gt; [arguments]</pre>
</div>
</div>
<div class="paragraph">
<p>&lt;schematic-name&gt; is the name of the schematic that you want to execute.</p>
</div>
<div class="paragraph">
<p>You can find all information about arguments in the schematic section.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect5">
<h6 id="merge-strategies"><a class="anchor" href="#merge-strategies"></a>Merge Strategies</h6>
<div class="paragraph">
<p>When you execute cicdgen in a project, is possible that you already have some files that cicdgen will generate. Until version 1.5 the behaviour in these cases was to throw an error and not create/modify any file. Since version 1.6 you can choose what to do in case of conflict. In this page we will explain who to choose one merge strategy and how it works.</p>
</div>
<div class="sect6">
<h7 id="choose-a-merge-strategy"><a class="anchor" href="#choose-a-merge-strategy"></a>Choose a merge strategy</h7>
<div class="paragraph">
<p>To choose a merge strategy, you must pass to cicdgen the merge parameter followed by the name of the strategy. The strategies available are: <strong>error</strong>, <strong>keep</strong>, <strong>override</strong>, <strong>combine</strong>.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cicdgen generate devon4j --merge keep</pre>
</div>
</div>
</div>
<div class="sect6">
<h7 id="merge-strategies-2"><a class="anchor" href="#merge-strategies-2"></a>Merge strategies</h7>
<div class="ulist">
<ul>
<li>
<p><strong>error</strong>: The <strong>error</strong> strategy is the same as until version 1.5, throwing an error and do not create/modify any file. This is the default value, if you do not pass the merge parameter this value will be taken.</p>
</li>
<li>
<p><strong>keep</strong>: The <strong>keep</strong> strategy will keep the actual content of your files in case of conflict. If there is no conflict, the file will be created with the new content.</p>
</li>
<li>
<p><strong>override</strong>: The <strong>override</strong> strategy will override your current files, without throwing any error, and create a new ones with the new content. If there is no conflict, the file will be created with the new content.</p>
</li>
<li>
<p><strong>combine</strong>: The <strong>combine</strong> strategy will create a new file combining the current content with the new content. In order to combine both files, it will apply a diff algorithm and it will show the conflicts in the same way that git does. If there is no conflict, the file will be created with the new content.</p>
<div class="paragraph">
<p>By resolving the conflicts in the same way as git, you can use the same tools in order to solve them. For example, you can use VSCode:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/images/merge-combine-vscode.png" alt="merge combine vscode"></span></p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="paragraph">
<p><strong>keep</strong>
Current file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Line 1
Line 2
Line 3
Line 4</pre>
</div>
</div>
<div class="paragraph">
<p>New file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Line 5
Line 2
Line 3
Line 4</pre>
</div>
</div>
<div class="paragraph">
<p>The result will be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Line 1
Line 2
Line 3
Line 4</pre>
</div>
</div>
<div class="paragraph">
<p><strong>override</strong>
Current file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Line 1
Line 2
Line 3
Line 4</pre>
</div>
</div>
<div class="paragraph">
<p>New file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Line 5
Line 2
Line 3
Line 4</pre>
</div>
</div>
<div class="paragraph">
<p>The result will be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Line 5
Line 2
Line 3
Line 4</pre>
</div>
</div>
<div class="paragraph">
<p><strong>combine</strong>
Current file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Line 1
Line 2
Line 3
Line 4</pre>
</div>
</div>
<div class="paragraph">
<p>New file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Line 5
Line 2
Line 3
Line 4</pre>
</div>
</div>
<div class="paragraph">
<p>The result will be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
Line 1
=======
Line 5
&gt;&gt;&gt;&gt;&gt;&gt;&gt; new_content
Line 2
Line 3
Line 4</pre>
</div>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect4">
<h5 id="devon4j-schematic"><a class="anchor" href="#devon4j-schematic"></a>devon4j schematic</h5>
<div class="paragraph">
<p>With the <code>cicdgen generate devon4j</code> command you will be able to generate some files required for CICD. In this section we will explain the arguments of this command and also the files that will be generated.</p>
</div>
<div class="sect5">
<h6 id="devon4j-schematic-arguments"><a class="anchor" href="#devon4j-schematic-arguments"></a>devon4j schematic arguments</h6>
<div class="paragraph">
<p>When you execute the <code>cicdgen generate devon4j</code> command you can also add some arguments in order to modify the behaviour of the command. Those arguments are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>--docker</p>
<div class="paragraph">
<p>The type of this parameter if boolean. If it is present, docker related files and pipeline stage will be also generated. For more details see docker section of Jenkinsfile and <a href="#devon4j-docker-generated-files">files generated for docker</a></p>
</div>
</li>
<li>
<p><code>--dockerurl</code></p>
<div class="paragraph">
<p>The URL of your external docker daemon. Example: tcp://127.0.0.1:2376</p>
</div>
</li>
<li>
<p><code>--dockercertid</code></p>
<div class="paragraph">
<p>The Jenkins credential id for your docker daemon certificate. It is only required when your docker daemon is secure.</p>
</div>
</li>
<li>
<p><code>--registryurl</code></p>
<div class="paragraph">
<p>Your docker registry URL. It is required when <code>--docker</code> is true, and it will be used to know where the docker image will be uploaded.</p>
</div>
</li>
<li>
<p><code>--openshift</code></p>
<div class="paragraph">
<p>The type of this parameter if boolean. If it is present, OpenShift related files and pipeline stage will be also generated. For more details see OpenShift section of Jenkinsfile and <a href="#devon4j-docker-generated-files">files generated for docker</a> (same as <code>--docker</code>)</p>
</div>
</li>
<li>
<p><code>--ocname</code></p>
<div class="paragraph">
<p>The name used for register your OpenShift cluster in Jenkins.</p>
</div>
</li>
<li>
<p><code>--ocn</code></p>
<div class="paragraph">
<p>OpenShift cluster namespace</p>
</div>
</li>
<li>
<p>--teams</p>
<div class="paragraph">
<p>With this argument we can add the teams notification option in the <a href="#jenkinsfile-teams">Jenkinsfile</a>.</p>
</div>
</li>
<li>
<p><code>--teamsname</code></p>
<div class="paragraph">
<p>The name of the Microsoft Teams <code>webhook</code>. It is defined at Microsoft Teams connectors.</p>
</div>
</li>
<li>
<p><code>--teamsurl</code></p>
<div class="paragraph">
<p>The url of the Microsoft Teams <code>webhook</code>. It is returned by Microsoft Teams when you create a connector.</p>
</div>
</li>
<li>
<p>--merge</p>
<div class="paragraph">
<p>If you have used cicdgen previously, you can choose what you want to do in case of file conflict. The default behavior is to throw an error and not modify any file. You can see the other strategies on their <a href="merge-strategies.adoc">specific page</a>.</p>
</div>
</li>
<li>
<p>--commit</p>
<div class="paragraph">
<p>If true, all changes will be committed at the end of the process (if possible). In order to send a false value, you need to write <code>--commit=false</code></p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="devon4ng-generated-files"><a class="anchor" href="#devon4ng-generated-files"></a>Devon4ng generated files</h6>
<div class="paragraph">
<p>When you execute the generate devon4ng command, some files will be added/updated in your project.</p>
</div>
<div class="sect6">
<h7 id="files"><a class="anchor" href="#files"></a>Files</h7>
<div class="ulist">
<ul>
<li>
<p>.gitignore</p>
<div class="paragraph">
<p>Defines all files that git will ignore. e.g: compiled files, IDE configurations. It will download the content from: <a href="https://gitignore.io/api/java,maven,eclipse,intellij,intellij+all,intellij+iml,visualstudiocode" class="bare">https://gitignore.io/api/java,maven,eclipse,intellij,intellij+all,intellij+iml,visualstudiocode</a></p>
</div>
</li>
<li>
<p>pom.xml</p>
<div class="paragraph">
<p>The pom.xml is modified in order to add, if needed, the <code>distributionManagement</code>.</p>
</div>
</li>
<li>
<p>Jenkinsfile</p>
<div class="paragraph">
<p>The Jenkinsfile is the file which define the Jenkins pipeline of our project. With this we can execute the test, build the application and deploy it automatically following a CICD methodology. This file is prepared to work with the Production Line default values, but it is also fully configurable to your needs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prerequisites</p>
<div class="ulist">
<ul>
<li>
<p>A Production Line instance. It can works also if you have a Jenkins, SonarQube and Nexus3, but in this case maybe you need to configure them properly.</p>
</li>
<li>
<p>Java 11 installed in Jenkins as a global tool.</p>
</li>
<li>
<p>SonarQube installed in Jenkins as a global tool.</p>
</li>
<li>
<p>Maven3 installed in Jenkins as a global tool.</p>
</li>
<li>
<p>A maven global settings properly configured in Jenkins.</p>
</li>
<li>
<p>If you will use docker to deploy:</p>
<div class="ulist">
<ul>
<li>
<p>Docker installed in Jenkins as a global custom tool.</p>
</li>
<li>
<p>The Nexus3 with a docker repository.</p>
</li>
<li>
<p>A machine with docker installed where the build and deploy will happen.</p>
</li>
<li>
<p>A docker network called application.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If you will use OpenShift to deploy:</p>
<div class="ulist">
<ul>
<li>
<p>An OpenShift instance</p>
</li>
<li>
<p>The OpenShift projects created</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>The Jenkins syntax</p>
<div class="paragraph">
<p>In this section we will  explain a little bit the syntax of the Jenkins, so if you need to change something you will be able to do it properly.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>agent: Here you can specify the Jenkins agent where the pipeline will be executed. The default value is any.</p>
</li>
<li>
<p>options: Here you can set global options to the pipeline. By default, we add a build discarded to delete old artifacts/build of the pipeline and also we disable the concurrent builds.</p>
<div id="jenkinsfile-teams" class="paragraph">
<p>If the teams option is passed to cicdgen, we add a new option in order to send notifications to Microsoft Teams with the status of the pipeline executions.</p>
</div>
</li>
<li>
<p>environment: Here all environment variables are defined. All values defined here matches with the Production Line defaults. If you Jenkins has other values, you need to update it manually.</p>
</li>
<li>
<p>stages: Here are defined all stages that our pipeline will execute. Those stages are:</p>
<div class="ulist">
<ul>
<li>
<p>Loading Custom Tools: Load some custom tools that can not be loaded in the tools section. Also set some variables depending on the git branch which you are executing. Also, we set properly the version number in all pom files. It means that if your branch is develop, your version should end with the word <code>-SNAPSHOT</code>, in order case, if <code>-SNAPSHOT</code> is present it will be removed.</p>
</li>
<li>
<p>Fresh Dependency Installation: install all packages need to build/run your java project.</p>
</li>
<li>
<p>Unit Tests: execute the <code>mvn test</code> command.</p>
</li>
<li>
<p>SonarQube code analysis: send the project to SonarQube in order to get the static code analysis of your project.</p>
</li>
<li>
<p>Deliver application into Nexus: build the project and send all bundle files to Nexsus3.</p>
</li>
<li>
<p>If <code>--docker</code> is present:</p>
<div class="ulist">
<ul>
<li>
<p>Create the Docker image: build a new docker image that contains the new version of the project.</p>
</li>
<li>
<p>Deploy the new image: deploy a new version of the application using the image created in the previous stage. The previous version is removed.</p>
<div class="paragraph">
<p><code><a id="jenkinsfile-openshift"></a></code></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>--openshift</code> is present:</p>
<div class="ulist">
<ul>
<li>
<p>Create the Docker image: build a new docker image that contains the new version of the project using a OpenShift build config.</p>
</li>
<li>
<p>Deploy the new image: deploy a new version of the application in OpenShift.</p>
</li>
<li>
<p>Check pod status: checks that the application deployed in the previous stage is running properly. If the application does not run the pipeline will fail.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>post: actions that will be executed after the stages. We use it to clean up all files.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devon4j-docker-generated-files"><a class="anchor" href="#devon4j-docker-generated-files"></a>devon4j Docker generated files</h6>
<div class="paragraph">
<p>When you generate the files for a devon4ng you can also pass the option <code>--docker</code>. It will generate also some extra files related to docker.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you pass the <code>--docker</code> option the option <code>--registryurl</code> is also required. It will be used to upload the images to a docker registry. Example: if your registry url is <code>docker-registry-test.s2-eu.capgemini.com</code> you should execute the command in this way: <code>cicdgen generate devon4node --groupid com.devonfw --docker --registryurl docker-registry-test.s2-eu.capgemini.com</code>.
</td>
</tr>
</table>
</div>
<div class="sect6">
<h7 id="files-2"><a class="anchor" href="#files-2"></a>Files</h7>
<div class="ulist">
<ul>
<li>
<p>Dockerfile</p>
<div class="paragraph">
<p>This file contains the instructions to build a docker image for you project. This Dockerfile is for local development purposes, you can use it in your machine executing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd &lt;path-to-your-project&gt;
$ docker build -t &lt;project-name&gt;/&lt;tag&gt; .</pre>
</div>
</div>
<div class="paragraph">
<p>This build is using a multi-stage build. First, it use a maven image in order to compile the source code, then it will use a java image to run the application. With the multi-stage build we keep the final image as clean as possible.</p>
</div>
</li>
<li>
<p><code>Dockerfile.ci</code></p>
<div class="paragraph">
<p>This file contains the instructions to create a docker image for you project. The main difference with the Dockerfile is that this file will be only used in the Jenkins pipeline. Instead of compiling again the code, it takes the compiled war from Jenkins to the image.</p>
</div>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect4">
<h5 id="devon4ng-schematic"><a class="anchor" href="#devon4ng-schematic"></a>devon4ng schematic</h5>
<div class="paragraph">
<p>With the <code>cicdgen generate devon4ng</code> command you can generate some files required for CICD. In this section we will explain the arguments of this command and also the files that will be generated.</p>
</div>
<div class="sect5">
<h6 id="devon4ng-schematic-arguments"><a class="anchor" href="#devon4ng-schematic-arguments"></a>devon4ng schematic arguments</h6>
<div class="paragraph">
<p>When you execute the <code>cicdgen generate devon4ng</code> command you can also add some arguments in order to modify the behaviour of the command. Those arguments are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>--docker</p>
<div class="paragraph">
<p>The type of this parameter if boolean. If it is present, docker related files and pipeline stage will be also generated. For more details see docker section of Jenkinsfile and <a href="#devon4ng-docker-generated-files">files generated for docker</a></p>
</div>
</li>
<li>
<p><code>--dockerurl</code></p>
<div class="paragraph">
<p>The URL of your external docker daemon. Example: tcp://127.0.0.1:2376</p>
</div>
</li>
<li>
<p><code>--dockercertid</code></p>
<div class="paragraph">
<p>The Jenkins credential id for your docker daemon certificate. It is only required when your docker daemon is secure.</p>
</div>
</li>
<li>
<p><code>--registryurl</code></p>
<div class="paragraph">
<p>Your docker registry URL. It is required when <code>--docker</code> is true, and it will be used to know where the docker image will be uploaded.</p>
</div>
</li>
<li>
<p><code>--openshift</code></p>
<div class="paragraph">
<p>The type of this parameter if boolean. If it is present, OpenShift related files and pipeline stage will be also generated. For more details see OpenShift section of Jenkinsfile and <a href="#devon4ng-docker-generated-files">files generated for OpenShift</a> (same as <code>--docker</code>)</p>
</div>
</li>
<li>
<p><code>--ocname</code></p>
<div class="paragraph">
<p>The name used for register your OpenShift cluster in Jenkins.</p>
</div>
</li>
<li>
<p><code>--ocn</code></p>
<div class="paragraph">
<p>OpenShift cluster namespace</p>
</div>
</li>
<li>
<p>--groupid</p>
<div class="paragraph">
<p>The project <code>groupId</code>. This argument is required. It will be used for store the project in a maven repository at Nexus 3. Why maven? Because is the kind of repository where we can upload/download a zip file easily. Npm repository needs a package.json file but, as we compile the angular application to static javascript and html files, the package.json is no needed anymore.</p>
</div>
</li>
<li>
<p>--teams</p>
<div class="paragraph">
<p>With this argument we can add the teams notification option in the <code><a href="#jenkinsfile-teams</code>">Jenkinsfile</a>.</p>
</div>
</li>
<li>
<p><code>--teamsname</code></p>
<div class="paragraph">
<p>The name of the Microsoft Teams <code>webhook</code>. It is defined at Microsoft Teams connectors.</p>
</div>
</li>
<li>
<p><code>--teamsurl</code></p>
<div class="paragraph">
<p>The url of the Microsoft Teams <code>webhook</code>. It is returned by Microsoft Teams when you create a connector.</p>
</div>
</li>
<li>
<p>--merge</p>
<div class="paragraph">
<p>If you have used cicdgen previously, you can choose what you want to do in case of file conflict. The default behavior is to throw an error and not modify any file. You can see the other strategies on their <a href="merge-strategies.adoc">specific page</a>.</p>
</div>
</li>
<li>
<p>--commit</p>
<div class="paragraph">
<p>If true, all changes will be committed at the end of the process (if possible). In order to send a false value, you need to write <code>--commit=false</code></p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="devon4ng-generated-files-2"><a class="anchor" href="#devon4ng-generated-files-2"></a>devon4ng generated files</h6>
<div class="paragraph">
<p>When you execute the generate devon4ng command, some files will be added/updated in your project.</p>
</div>
<div class="sect6">
<h7 id="files-3"><a class="anchor" href="#files-3"></a>Files</h7>
<div class="ulist">
<ul>
<li>
<p>angular.json</p>
<div class="paragraph">
<p>The angular.json is modified in order to change the compiled files destination folder. Now, when you make a build of your project, the compiled files will be generated into dist folder instead of dist/&lt;project-name&gt; folder.</p>
</div>
</li>
<li>
<p>package.json</p>
<div class="paragraph">
<p>The package.json is modified in order to add a script for test the application using Chrome Headless instead of a regular chrome. This script is called <code>test:ci</code>.</p>
</div>
</li>
<li>
<p><code>karma.conf.js</code></p>
<div class="paragraph">
<p>The <code>karma.conf.js</code> is also modified in order to add the Chrome Headless as a browser to execute test. The coverage output folder is change to <code>./coverage</code> instead of <code>./coverage/&lt;project-name&gt;</code></p>
</div>
</li>
<li>
<p>Jenkinsfile</p>
<div class="paragraph">
<p>The Jenkinsfile is the file which define the Jenkins pipeline of our project. With this we can execute the test, build the application and deploy it automatically following a CICD methodology. This file is prepared to work with the Production Line default values, but it is also fully configurable to your needs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prerequisites</p>
<div class="ulist">
<ul>
<li>
<p>A Production Line instance. It can works also if you have a Jenkins, SonarQube and Nexus3, but in this case maybe you need to configure them properly.</p>
</li>
<li>
<p>NodeJS installed in Jenkins as a global tool.</p>
</li>
<li>
<p>Google Chrome installed in Jenkins as a global custom tool.</p>
</li>
<li>
<p>SonarQube installed in Jenkins as a global tool.</p>
</li>
<li>
<p>Maven3 installed in Jenkins as a global tool.</p>
</li>
<li>
<p>A maven global settings properly configured in Jenkins.</p>
</li>
<li>
<p>If you will use docker :</p>
<div class="ulist">
<ul>
<li>
<p>Docker installed in Jenkins as a global custom tool.</p>
</li>
<li>
<p>The Nexus3 with a docker repository.</p>
</li>
<li>
<p>A machine with docker installed where the build and deploy will happen.</p>
</li>
<li>
<p>A docker network called application.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If you will use OpenShift :</p>
<div class="ulist">
<ul>
<li>
<p>An OpenShift instance</p>
</li>
<li>
<p>The OpenShift projects created</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>The Jenkins syntax</p>
<div class="paragraph">
<p>In this section we will  explain a little bit the syntax of the Jenkins, so if you need to change something you will be able to do it properly.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>agent: Here you can specify the Jenkins agent where the pipeline will be executed. The default value is any.</p>
</li>
<li>
<p>options: Here you can set global options for the pipeline. By default, we add a build discarded to delete old artifacts/build of the pipeline and also we disable the concurrent builds.</p>
<div class="paragraph">
<p>[[<code>jenkinsfile-teams</code>]]
If the teams option is passed to cicdgen, we add a new option in order to send notifications to Microsoft Teams with the status of the pipeline executions.</p>
</div>
</li>
<li>
<p>tools: Here we define the global tools configurations. By default a version of nodejs is added here.</p>
</li>
<li>
<p>environment: Here all environment variables are defined. All values defined here matches with the Production Line defaults. If you Jenkins has other values, you need to update it manually.</p>
</li>
<li>
<p>stages: Here are defined all stages that our pipeline will execute. Those stages are:</p>
<div class="ulist">
<ul>
<li>
<p>Loading Custom Tools: in this stage some custom tools are loaded. Also we set some variables depending on the git branch which you are executing.</p>
</li>
<li>
<p>Fresh Dependency Installation: install all packages need to build/run your angular project.</p>
</li>
<li>
<p>Code Linting: execute the linter analysis.</p>
</li>
<li>
<p>Execute Angular tests: execute the angular test in a Chrome Headless.</p>
</li>
<li>
<p>SonarQube code analysis: send the project to SonarQube in order to get the static code analysis of your project.</p>
</li>
<li>
<p>Build Application: compile the application to be ready to deploy in a web server.</p>
</li>
<li>
<p>Deliver application into Nexus: store all compiled files in Nexus3 as a zip file.</p>
<div class="paragraph">
<p>[[<code>jenkinsfile-docker</code>]]</p>
</div>
</li>
<li>
<p>If <code>--docker</code> is present:</p>
<div class="ulist">
<ul>
<li>
<p>Create the Docker image: build a new docker image that contains the new version of the project.</p>
</li>
<li>
<p>Deploy the new image: deploy a new version of the application using the image created in the previous stage. The previous version is removed.</p>
<div class="paragraph">
<p>[[<code>jenkinsfile-openshift</code>]]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>--openshift</code> is present:</p>
<div class="ulist">
<ul>
<li>
<p>Create the Docker image: build a new docker image that contains the new version of the project using a OpenShift build config.</p>
</li>
<li>
<p>Deploy the new image: deploy a new version of the application in OpenShift.</p>
</li>
<li>
<p>Check pod status: checks that the application deployed in the previous stage is running properly. If the application does not run the pipeline will fail.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>post: actions that will be executed after the stages. We use it to clean up all files.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devon4ng-docker-generated-files"><a class="anchor" href="#devon4ng-docker-generated-files"></a>devon4ng Docker generated files</h6>
<div class="paragraph">
<p>When you generate the files for a devon4ng you can also pass the option <code>--docker</code>. It will generate also some extra files related to docker.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you pass the <code>--docker</code> option the option <code>--registryurl</code> is also required. It will be used to upload the images to a docker registry. Example: if your registry url is <code>docker-registry-test.s2-eu.capgemini.com</code> you should execute the command in this way: <code>cicdgen generate devon4node --groupid com.devonfw --docker `--registryurl</code> docker-registry-test.s2-eu.capgemini.com`.
</td>
</tr>
</table>
</div>
<div class="sect6">
<h7 id="files-4"><a class="anchor" href="#files-4"></a>Files</h7>
<div class="ulist">
<ul>
<li>
<p>.dockerignore</p>
<div class="paragraph">
<p>In this files are defined the folders that will not be copied to the docker image. Fore more information read the <a href="https://docs.docker.com/engine/reference/builder/#dockerignore-file">official documentation</a>.</p>
</div>
</li>
<li>
<p>Dockerfile</p>
<div class="paragraph">
<p>This file contains the instructions to build a docker image for you project. This Dockerfile is for local development purposes, you can use it in your machine executing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd &lt;path-to-your-project&gt;
$ docker build -t &lt;project-name&gt;/&lt;tag&gt; .</pre>
</div>
</div>
<div class="paragraph">
<p>This build is using a multi-stage build. First, it use a node image in order to compile the source code, then it will use a nginx image as a web server for our devon4ng application. With the multi-stage build we avoid everything related to <code>node.js</code> in our final image, where we only have a nginx with our application compiled.</p>
</div>
</li>
<li>
<p>Dockerfile.ci</p>
<div class="paragraph">
<p>This file contains the instructions to create a docker image for you project. The main difference with the Dockerfile is that this file will be only used in the Jenkins pipeline. Instead of compiling again the code, it takes all compiled files and the nginx.conf from Jenkins to the image.</p>
</div>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect4">
<h5 id="devon4net-schematic"><a class="anchor" href="#devon4net-schematic"></a>devon4net schematic</h5>
<div class="paragraph">
<p>With the <code>cicdgen generate devon4net</code> command you can generate some files required for CICD. In this section we will explain the arguments of this command and also the files that will be generated.</p>
</div>
<div class="sect5">
<h6 id="devon4net-schematic-arguments"><a class="anchor" href="#devon4net-schematic-arguments"></a>devon4net schematic arguments</h6>
<div class="paragraph">
<p>When you execute the <code>cicdgen generate devon4net</code> command you can also add some arguments in order to modify the behaviour of the command. Those arguments are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>--appname</code></p>
<div class="paragraph">
<p>The name of your devon4net application.</p>
</div>
</li>
<li>
<p><code>--appversion</code></p>
<div class="paragraph">
<p>The initial version of your devon4net application</p>
</div>
</li>
<li>
<p>--docker</p>
<div class="paragraph">
<p>The type of this parameter if boolean. If it is present, docker related files and pipeline stage will be also generated. For more details see docker section of Jenkinsfile and <a href="#devon4net-docker-generated-files">files generated for docker</a></p>
</div>
</li>
<li>
<p><code>--dockerurl</code></p>
<div class="paragraph">
<p>The URL of your external docker daemon. Example: tcp://127.0.0.1:2376</p>
</div>
</li>
<li>
<p><code>--dockercertid</code></p>
<div class="paragraph">
<p>The Jenkins credential id for your docker daemon certificate. It is only required when your docker daemon is secure.</p>
</div>
</li>
<li>
<p><code>--registryurl</code></p>
<div class="paragraph">
<p>Your docker registry URL. It is required when <code>--docker</code> is true, and it will be used to know where the docker image will be uploaded.</p>
</div>
</li>
<li>
<p><code>--openshift</code></p>
<div class="paragraph">
<p>The type of this parameter if boolean. If it is present, OpenShift related files and pipeline stage will be also generated. For more details see OpenShift section of Jenkinsfile and <a href="#devon4net-docker-generated-files">files generated for OpenShift</a> (same as <code>--docker</code>)</p>
</div>
</li>
<li>
<p><code>--ocname</code></p>
<div class="paragraph">
<p>The name used for register your OpenShift cluster in Jenkins.</p>
</div>
</li>
<li>
<p><code>--ocn</code></p>
<div class="paragraph">
<p>OpenShift cluster namespace</p>
</div>
</li>
<li>
<p>--groupid</p>
<div class="paragraph">
<p>The project <code>groupId</code>. This argument is required. It will be used for store the project in a maven repository at Nexus 3. Why maven? Because is the kind of repository where we can upload/download a zip file easily. Npm repository needs a package.json file but, as we compile the angular application to static javascript and html files, the package.json is no needed anymore.</p>
</div>
</li>
<li>
<p>--teams</p>
<div class="paragraph">
<p>With this argument we can add the teams notification option in the xref:`jenkinsfile-teams`[Jenkinsfile].</p>
</div>
</li>
<li>
<p><code>--teamsname</code></p>
<div class="paragraph">
<p>The name of the Microsoft Teams <code>webhook</code>. It is defined at Microsoft Teams connectors.</p>
</div>
</li>
<li>
<p><code>--teamsurl</code></p>
<div class="paragraph">
<p>The url of the Microsoft Teams <code>webhook</code>. It is returned by Microsoft Teams when you create a connector.</p>
</div>
</li>
<li>
<p>--merge</p>
<div class="paragraph">
<p>If you have used cicdgen previously, you can choose what you want to do in case of file conflict. The default behavior is to throw an error and not modify any file. You can see the other strategies on their <a href="merge-strategies.adoc">specific page</a>.</p>
</div>
</li>
<li>
<p>--commit</p>
<div class="paragraph">
<p>If true, all changes will be committed at the end of the process (if possible). In order to send a false value, you need to write <code>--commit=false</code></p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="devon4net-generated-files"><a class="anchor" href="#devon4net-generated-files"></a>devon4net generated files</h6>
<div class="paragraph">
<p>When you execute the generate devon4net command, some files will be added/updated in your project.</p>
</div>
<div class="sect6">
<h7 id="files-5"><a class="anchor" href="#files-5"></a>Files</h7>
<div class="ulist">
<ul>
<li>
<p>Jenkinsfile</p>
<div class="paragraph">
<p>The Jenkinsfile is the file which define the Jenkins pipeline of our project. With this we can execute the test, build the application and deploy it automatically following a CICD methodology. This file is prepared to work with the Production Line default values, but it is also fully configurable to your needs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prerequisites</p>
<div class="ulist">
<ul>
<li>
<p>A Production Line instance. It can works also if you have a Jenkins, SonarQube and Nexus3, but in this case maybe you need to configure them properly.</p>
</li>
<li>
<p>dotnet core installed in Jenkins as a global tool.</p>
</li>
<li>
<p>SonarQube installed in Jenkins as a global tool.</p>
</li>
<li>
<p>Maven3 installed in Jenkins as a global tool.</p>
</li>
<li>
<p>A maven global settings properly configured in Jenkins.</p>
</li>
<li>
<p>If you will use docker :</p>
<div class="ulist">
<ul>
<li>
<p>Docker installed in Jenkins as a global custom tool.</p>
</li>
<li>
<p>The Nexus3 with a docker repository.</p>
</li>
<li>
<p>A machine with docker installed where the build and deploy will happen.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If you will use OpenShift :</p>
<div class="ulist">
<ul>
<li>
<p>An OpenShift instance</p>
</li>
<li>
<p>The OpenShift projects created</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>The Jenkins syntax</p>
<div class="paragraph">
<p>In this section we will  explain a little bit the syntax of the Jenkins, so if you need to change something you will be able to do it properly.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>agent: Here you can specify the Jenkins agent where the pipeline will be executed. The default value is any.</p>
</li>
<li>
<p>options: Here you can set global options for the pipeline. By default, we add a build discarded to delete old artifacts/build of the pipeline and also we disable the concurrent builds.</p>
<div class="paragraph">
<p>[[<code>jenkinsfile-teams</code>]]
If the teams option is passed to cicdgen, we add a new option in order to send notifications to Microsoft Teams with the status of the pipeline executions.</p>
</div>
</li>
<li>
<p>tools: Here we define the global tools configurations. By default a version of nodejs is added here.</p>
</li>
<li>
<p>environment: Here all environment variables are defined. All values defined here matches with the Production Line defaults. If you Jenkins has other values, you need to update it manually.</p>
</li>
<li>
<p>stages: Here are defined all stages that our pipeline will execute. Those stages are:</p>
<div class="ulist">
<ul>
<li>
<p>Loading Custom Tools: in this stage some custom tools are loaded. Also we set some variables depending on the git branch which you are executing.</p>
</li>
<li>
<p>Fresh Dependency Installation: install all dependencies need to build/run your dotnet project.</p>
</li>
<li>
<p>Execute dotnet tests: execute the tests.</p>
</li>
<li>
<p>SonarQube code analysis: send the project to SonarQube in order to get the static code analysis of your project.</p>
</li>
<li>
<p>Build Application: compile the application to be ready to deploy in a web server.</p>
</li>
<li>
<p>Deliver application into Nexus: store all compiled files in Nexus3 as a zip file.</p>
<div class="paragraph">
<p>[[<code>jenkinsfile-docker</code>]]</p>
</div>
</li>
<li>
<p>If <code>--docker</code> is present:</p>
<div class="ulist">
<ul>
<li>
<p>Create the Docker image: build a new docker image that contains the new version of the project.</p>
</li>
<li>
<p>Deploy the new image: deploy a new version of the application using the image created in the previous stage. The previous version is removed.</p>
<div class="paragraph">
<p>[[<code>jenkinsfile-openshift</code>]]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>--openshift</code> is present:</p>
<div class="ulist">
<ul>
<li>
<p>Create the Docker image: build a new docker image that contains the new version of the project using a OpenShift build config.</p>
</li>
<li>
<p>Deploy the new image: deploy a new version of the application in OpenShift.</p>
</li>
<li>
<p>Check pod status: checks that the application deployed in the previous stage is running properly. If the application does not run the pipeline will fail.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>post: actions that will be executed after the stages. We use it to clean up all files.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devon4net-docker-generated-files"><a class="anchor" href="#devon4net-docker-generated-files"></a>devon4net Docker generated files</h6>
<div class="paragraph">
<p>When you generate the files for devon4net you can also pass the option <code>--docker</code>. It will generate also some extra files related to docker.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you pass the <code>--docker</code> option the option <code>--registryurl</code> is also required. It will be used to upload the images to a docker registry. Example: if your registry url is <code>docker-registry-test.s2-eu.capgemini.com</code> you should execute the command in this way: <code>cicdgen generate devon4net --groupid com.devonfw --docker `--registryurl</code> docker-registry-test.s2-eu.capgemini.com`.
</td>
</tr>
</table>
</div>
<div class="sect6">
<h7 id="files-6"><a class="anchor" href="#files-6"></a>Files</h7>
<div class="ulist">
<ul>
<li>
<p>.dockerignore</p>
<div class="paragraph">
<p>In this files are defined the folders that will not be copied to the docker image. Fore more information read the <a href="https://docs.docker.com/engine/reference/builder/#dockerignore-file">official documentation</a>.</p>
</div>
</li>
<li>
<p>Dockerfile</p>
<div class="paragraph">
<p>This file contains the instructions to build a docker image for your project. This Dockerfile is for local development purposes, you can use it in your machine executing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd &lt;path-to-your-project&gt;
$ docker build -t &lt;project-name&gt;/&lt;tag&gt; .</pre>
</div>
</div>
</li>
<li>
<p>Dockerfile.ci</p>
<div class="paragraph">
<p>This file contains the instructions to create a docker image for you project. The main difference with the Dockerfile is that this file will be only used in the Jenkins pipeline. Instead of compiling again the code, it takes all compiled files from Jenkins to the image.</p>
</div>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect4">
<h5 id="devon4node-schematic"><a class="anchor" href="#devon4node-schematic"></a>devon4node schematic</h5>
<div class="paragraph">
<p>With the <code>cicdgen generate devon4node</code> command you can generate some files required for CICD. In this section we will explain the arguments of this command and also the files that will be generated.</p>
</div>
<div class="sect5">
<h6 id="devon4node-schematic-arguments"><a class="anchor" href="#devon4node-schematic-arguments"></a>devon4node schematic arguments</h6>
<div class="paragraph">
<p>When you execute the <code>cicdgen generate devon4node</code> command you can also add some arguments in order to modify the behaviour of the command. Those arguments are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>--docker</p>
<div class="paragraph">
<p>The type of this parameter if boolean. If it is present, docker related files and pipeline stage will be also generated. For more details see docker section of Jenkinsfile and <a href="#devon4node-docker-generated-files">files generated for docker</a></p>
</div>
</li>
<li>
<p><code>--dockerurl</code></p>
<div class="paragraph">
<p>The URL of your external docker daemon. Example: tcp://127.0.0.1:2376</p>
</div>
</li>
<li>
<p><code>--dockercertid</code></p>
<div class="paragraph">
<p>The Jenkins credential id for your docker daemon certificate. It is only required when your docker daemon is secure.</p>
</div>
</li>
<li>
<p><code>--registryurl</code></p>
<div class="paragraph">
<p>Your docker registry URL. It is required when <code>--docker</code> is true, and it will be used to know where the docker image will be uploaded.</p>
</div>
</li>
<li>
<p><code>--openshift</code></p>
<div class="paragraph">
<p>The type of this parameter if boolean. If it is present, OpenShift related files and pipeline stage will be also generated. For more details see OpenShift section of Jenkinsfile and <a href="#devon4node-docker-generated-files">files generated for OpenShift</a> (same as <code>--docker</code>)</p>
</div>
</li>
<li>
<p><code>--ocname</code></p>
<div class="paragraph">
<p>The name used for register your OpenShift cluster in Jenkins.</p>
</div>
</li>
<li>
<p><code>--ocn</code></p>
<div class="paragraph">
<p>OpenShift cluster namespace</p>
</div>
</li>
<li>
<p>--groupid</p>
<div class="paragraph">
<p>The project <code>groupId</code>. This argument is required. It will be used for store the project in a maven repository at Nexus 3. Why maven? Because is the kind of repository where we can upload/download a zip file easily. Npm repository needs a package.json file but, as we compile the angular application to static javascript and html files, the package.json is no needed anymore.</p>
</div>
</li>
<li>
<p>--teams</p>
<div class="paragraph">
<p>With this argument we can add the teams notification option in the <code><a href="#jenkinsfile-teams</code>">Jenkinsfile</a>.</p>
</div>
</li>
<li>
<p><code>--teamsname</code></p>
<div class="paragraph">
<p>The name of the Microsoft Teams <code>webhook</code>. It is defined at Microsoft Teams connectors.</p>
</div>
</li>
<li>
<p><code>--teamsurl</code></p>
<div class="paragraph">
<p>The url of the Microsoft Teams <code>webhook</code>. It is returned by Microsoft Teams when you create a connector.</p>
</div>
</li>
<li>
<p>--merge</p>
<div class="paragraph">
<p>If you have used cicdgen previously, you can choose what you want to do in case of file conflict. The default behavior is to throw an error and not modify any file. You can see the other strategies on their <a href="merge-strategies.adoc">specific page</a>.</p>
</div>
</li>
<li>
<p>--commit</p>
<div class="paragraph">
<p>If true, all changes will be committed at the end of the process (if possible). In order to send a false value, you need to write <code>--commit=false</code></p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="devon4node-generated-files"><a class="anchor" href="#devon4node-generated-files"></a>devon4node generated files</h6>
<div class="paragraph">
<p>When you execute the generate devon4node command, some files will be added/updated in your project.</p>
</div>
<div class="sect6">
<h7 id="files-7"><a class="anchor" href="#files-7"></a>Files</h7>
<div class="ulist">
<ul>
<li>
<p>package.json</p>
<div class="paragraph">
<p>The package.json is modified in order to add a script for run the linter and generate the json report. This script is called <code>lint:ci</code>.</p>
</div>
</li>
<li>
<p>Jenkinsfile</p>
<div class="paragraph">
<p>The Jenkinsfile is the file which define the Jenkins pipeline of our project. With this we can execute the test, build the application and deploy it automatically following a CICD methodology. This file is prepared to work with the Production Line default values, but it is also fully configurable to your needs.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prerequisites</p>
<div class="ulist">
<ul>
<li>
<p>A Production Line instance. It can works also if you have a Jenkins, SonarQube and Nexus3, but in this case maybe you need to configure them properly.</p>
</li>
<li>
<p>NodeJS installed in Jenkins as a global tool.</p>
</li>
<li>
<p>SonarQube installed in Jenkins as a global tool.</p>
</li>
<li>
<p>Maven3 installed in Jenkins as a global tool.</p>
</li>
<li>
<p>A maven global settings properly configured in Jenkins.</p>
</li>
<li>
<p>If you will use docker :</p>
<div class="ulist">
<ul>
<li>
<p>Docker installed in Jenkins as a global custom tool.</p>
</li>
<li>
<p>The Nexus3 with a docker repository.</p>
</li>
<li>
<p>A machine with docker installed where the build and deploy will happen.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If you will use OpenShift :</p>
<div class="ulist">
<ul>
<li>
<p>An OpenShift instance</p>
</li>
<li>
<p>The OpenShift projects created</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>The Jenkins syntax</p>
<div class="paragraph">
<p>In this section we will  explain a little bit the syntax of the Jenkins, so if you need to change something you will be able to do it properly.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>agent: Here you can specify the Jenkins agent where the pipeline will be executed. The default value is any.</p>
</li>
<li>
<p>options: Here you can set global options for the pipeline. By default, we add a build discarded to delete old artifacts/build of the pipeline and also we disable the concurrent builds.</p>
<div class="paragraph">
<p>[[<code>jenkinsfile-teams</code>]]
If the teams option is passed to cicdgen, we add a new option in order to send notifications to Microsoft Teams with the status of the pipeline executions.</p>
</div>
</li>
<li>
<p>tools: Here we define the global tools configurations. By default a version of nodejs is added here.</p>
</li>
<li>
<p>environment: Here all environment variables are defined. All values defined here matches with the Production Line defaults. If you Jenkins has other values, you need to update it manually.</p>
</li>
<li>
<p>stages: Here are defined all stages that our pipeline will execute. Those stages are:</p>
<div class="ulist">
<ul>
<li>
<p>Loading Custom Tools: in this stage some custom tools are loaded. Also we set some variables depending on the git branch which you are executing.</p>
</li>
<li>
<p>Fresh Dependency Installation: install all packages need to build/run your node project.</p>
</li>
<li>
<p>Code Linting: execute the linter analysis.</p>
</li>
<li>
<p>Execute tests: execute the tests.</p>
</li>
<li>
<p>SonarQube code analysis: send the project to SonarQube in order to get the static code analysis of your project.</p>
</li>
<li>
<p>Build Application: compile the application to be ready to deploy in a web server.</p>
</li>
<li>
<p>Deliver application into Nexus: store all compiled files in Nexus3 as a zip file.</p>
<div class="paragraph">
<p>[[<code>jenkinsfile-docker</code>]]</p>
</div>
</li>
<li>
<p>If <code>--docker</code> is present:</p>
<div class="ulist">
<ul>
<li>
<p>Create the Docker image: build a new docker image that contains the new version of the project.</p>
</li>
<li>
<p>Deploy the new image: deploy a new version of the application using the image created in the previous stage. The previous version is removed.</p>
<div class="paragraph">
<p>[[<code>jenkinsfile-openshift</code>]]</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>If <code>--openshift</code> is present:</p>
<div class="ulist">
<ul>
<li>
<p>Create the Docker image: build a new docker image that contains the new version of the project using a OpenShift build config.</p>
</li>
<li>
<p>Deploy the new image: deploy a new version of the application in OpenShift.</p>
</li>
<li>
<p>Check pod status: checks that the application deployed in the previous stage is running properly. If the application does not run the pipeline will fail.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>post: actions that will be executed after the stages. We use it to clean up all files.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect5">
<h6 id="devon4node-docker-generated-files"><a class="anchor" href="#devon4node-docker-generated-files"></a>devon4node Docker generated files</h6>
<div class="paragraph">
<p>When you generate the files for a devon4node you can also pass the option <code>--docker</code>. It will generate also some extra files related to docker.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you pass the <code>--docker</code> option the option <code>--registryurl</code> is also required. It will be used to upload the images to a docker registry. Example: if your registry url is <code>docker-registry-test.s2-eu.capgemini.com</code> you should execute the command in this way: <code>cicdgen generate devon4node --groupid com.devonfw --docker `--registryurl</code> docker-registry-test.s2-eu.capgemini.com`.
</td>
</tr>
</table>
</div>
<div class="sect6">
<h7 id="files-8"><a class="anchor" href="#files-8"></a>Files</h7>
<div class="ulist">
<ul>
<li>
<p>.dockerignore</p>
<div class="paragraph">
<p>In this files are defined the folders that will not be copied to the docker image. Fore more information read the <a href="https://docs.docker.com/engine/reference/builder/#dockerignore-file">official documentation</a>.</p>
</div>
</li>
<li>
<p>Dockerfile</p>
<div class="paragraph">
<p>This file contains the instructions to build a docker image for you project. This Dockerfile is for local development purposes, you can use it in your machine executing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ cd &lt;path-to-your-project&gt;
$ docker build -t &lt;project-name&gt;/&lt;tag&gt; .</pre>
</div>
</div>
<div class="paragraph">
<p>This build is installs all dependencies in ordre to build the project and then remove all devDependencies in order to keep only the production dependencies.</p>
</div>
</li>
<li>
<p>.dockerignore.ci</p>
<div class="paragraph">
<p>Another .dockerignore. The purpose of this one is to define de file exclusions in your CI pipeline.</p>
</div>
</li>
<li>
<p>Dockerfile.ci</p>
<div class="paragraph">
<p>This file contains the instructions to create a docker image for you project. The main difference with the Dockerfile is that this file will be only used in the Jenkins pipeline. Instead of compiling again the code, it takes all compiled files from Jenkins to the image.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="hangar"><a class="anchor" href="#hangar"></a>27.7. Hangar</h3>
<!-- toc disabled -->
</div>
</div>
</div>
<div class="sect1">
<h2 id="mythaistar"><a class="anchor" href="#mythaistar"></a>28. MyThaiStar</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="1-my-thai-star-agile-framework"><a class="anchor" href="#1-my-thai-star-agile-framework"></a>28.1. 1.	My Thai Star – Agile Framework</h3>

</div>
<div class="sect2">
<h3 id="1-1-team-setup"><a class="anchor" href="#1-1-team-setup"></a>28.2. 1.1 Team Setup</h3>
<div class="paragraph">
<p>The team working on the development of the My Thai Star app and the documentation beside the technical development works distributed in various locations across Germany, the Netherlands, Spain and Poland. For the communication part the team uses the two channels Skype and Mail and for the documentation part the team makes usage mainly of GitHub and JIRA.</p>
</div>
</div>
<div class="sect2">
<h3 id="1-2-scrum-events"><a class="anchor" href="#1-2-scrum-events"></a>28.3. 1.2 Scrum events</h3>

</div>
<div class="sect2">
<h3 id="sprint-planning"><a class="anchor" href="#sprint-planning"></a>28.4. Sprint Planning</h3>
<div class="paragraph">
<p>Within the My Thai Star project we decided on having one hour Sprint Planning meetings for a four-week Sprints. This decision is based on the fact that this project is not the main project of the team members. As the backlog refinement is done during the Sprint Planning we make usage of the planningpoker.com tool for the estimation of the tasks.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/methodology_01.png"><img src="_images/images/methodology_1.png" alt="Screenshot of planningpoker.com" width="450"></a>
</div>
<div class="title">Figure 88. Screenshot of planningpoker.com during Sprint 1 Planning</div>
</div>
<div class="paragraph">
<p>During the Sprint Planning meeting the team receives support from Devon colleagues outside the development. This feedback helps the team to focus on important functionalities and task by keeping the eyes on the overall aim which is to have a working application by the end of June 2017.</p>
</div>
</div>
<div class="sect2">
<h3 id="sprint-review"><a class="anchor" href="#sprint-review"></a>28.5. Sprint Review</h3>
<div class="paragraph">
<p>The Sprint Review meetings are time boxed to one hour for the four week Sprint. Within the Sprint Review meeting the team plans to do a retrospective of the finished Sprint. As well as it is done during the Sprint Planning the team receives support from Devon colleagues.</p>
</div>
</div>
<div class="sect2">
<h3 id="sprint-retrospective"><a class="anchor" href="#sprint-retrospective"></a>28.6. Sprint Retrospective</h3>
<div class="paragraph">
<p>For this project the team aligned on not having a specific Sprint Retrospective meeting. The team is going to have a retrospective of a finished Sprint during the Sprint Review.</p>
</div>
</div>
<div class="sect2">
<h3 id="daily-stand-ups"><a class="anchor" href="#daily-stand-ups"></a>28.7. Daily Stand-ups</h3>
<div class="paragraph">
<p>The team aligned on having two weekly Stand-up meetings instead of a Daily Stand-up meeting. In comparison with the time boxed length of 15mins described in the CAF for this project the team extended the Stand-up meeting to 30mins. The content of the meetings remains the same.</p>
</div>
</div>
<div class="sect2">
<h3 id="backlog-refinement"><a class="anchor" href="#backlog-refinement"></a>28.8. Backlog refinement</h3>
<div class="paragraph">
<p>The team decided that the backlog refinement meeting is part of the Sprint Planning meeting.</p>
</div>
</div>
<div class="sect2">
<h3 id="1-3-establish-product-backlog"><a class="anchor" href="#1-3-establish-product-backlog"></a>28.9. 1.3 Establish Product Backlog</h3>
<div class="paragraph">
<p>For the My Thai Stair project the team decided on using the JIRA agile documentation which is one of the widely used agile tools. JIRA is equipped with several of useful tools regarding the agile software development (e.g. Scrum-Board). One of the big advantages of JIRA are the extensive configuration and  possibilities to personalize.</p>
</div>
<div class="paragraph">
<p>With having a list of the Epics and User Stories for the My Thai Star development in GitHub, the team transferred the User Stories into the JIRA backlog as it is shown in the screenshot below. All User Stories are labeled colorfully with the related Epic which shapes the backlog in clearly manner.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/methodology_02.png"><img src="_images/images/methodology_2.png" alt="Screenshot of planningpoker.com" width="450"></a>
</div>
<div class="title">Figure 89. Screenshot of the JIRA backlog during Sprint 2</div>
</div>
<div class="paragraph">
<p>We decided on working with Sub-task as a single user story comprised a number of single and separated tasks. Another benefit of working with sub-task is that every single sub-task can be assigned to a single team member whereas a user story can only be assigned to one team member. By picking single sub-task the whole process of a user story is better organized.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/methodology_03.png"><img src="_images/images/methodology_3.png" alt="Screenshot of Sub-tasks" width="450"></a>
</div>
<div class="title">Figure 90. Screenshots of Sub-tasks during Sprint 2</div>
</div>
</div>
<div class="sect2">
<h3 id="2-my-thai-star-agile-diary"><a class="anchor" href="#2-my-thai-star-agile-diary"></a>28.10. 2.	My Thai Star – Agile Diary</h3>
<div class="paragraph">
<p>In parallel to the <code>Diary Ideation</code> we use this Agile Diary to document our Scrum events. The target of this diary is to describe the differences to the Scrum methodology as well as specific characteristics of the project. We also document the process on how we approach the Scrum methodology over the length of the project.</p>
</div>
</div>
<div class="sect2">
<h3 id="24-03-2017-sprint-1-planning"><a class="anchor" href="#24-03-2017-sprint-1-planning"></a>28.11. 24.03.2017 Sprint 1 Planning</h3>
<div class="paragraph">
<p>Within the Sprint 1 Planning we used planning poker.com for the estimation of the user stories. The estimation process usually is part of the backlog refinement meeting. Regarding the project circumstances we decided to estimate the user stories during the Sprint Planning. Starting the estimation process we noticed that we had to align our interpretation of the estimation effort as these story points are not equivalent to a certain time interval. The story points are relative values to compare the effort of the user stories. With this in mind we proceeded with the estimation of the user stories. We decided to start Sprint 1 with the following user stories and the total amount of 37 story points:
•	<code>ICSDSHOW-2</code>	Create invite for friends	(8  Story Points)
•	<code>ICSDSHOW-4</code>	Create reservation		(3)
•	<code>ICSDSHOW-5</code>	Handle invite			(3)
•	<code>ICSDSHOW-6</code>	Revoke accepted invite 	(5)
•	<code>ICSDSHOW-9</code>	Cancel invite			(3)
•	<code>ICSDSHOW-11</code>	Filter menu			(5)
•	<code>ICSDSHOW-12</code>	Define order			(5)
•	<code>ICSDSHOW-13</code>	Order the order		(5)
As the Sprint Planning is time boxed to one hour we managed to hold this meeting within this time window.</p>
</div>
</div>
<div class="sect2">
<h3 id="27-04-2017-sprint-1-review"><a class="anchor" href="#27-04-2017-sprint-1-review"></a>28.12. 27.04.2017 Sprint 1 Review</h3>
<div class="paragraph">
<p>During the Sprint 1 Review we had a discussion about the data model proposal. For the discussion we extended this particular Review meeting to 90min. As this discussion took almost 2/3 of the Review meeting we only had a short time left for our review of Sprint 1. For the following scrum events we decided to focus on the primary target of these events and have discussions needed for alignments in separate meetings.
Regarding the topic of splitting user stories we had the example of a certain user story which included a functionality of a twitter integration (<code>ICSDSHOW-17</code> User Profile and Twitter integration). As the twitter functionality could not have been implemented at this early point of time we thought about cutting the user story into two user stories. We aligned on mocking the twitter functionality until the dependencies are developed in order to test the components. As this user story is estimated with 13 story points it is a good example for the question whether to cut a user story into multiple user stories or not.
Unfortunately not all user stories of Sprint 1 could have been completed. Due this situation we discussed on whether pushing all unfinished user stories into the status done or moving them to Sprint 2. We aligned on transferring the unfinished user stories into the next Sprint. During the Sprint 1 the team underestimated that a lot of holidays crossed the Sprint 1 goals. As taking holidays and absences of team members into consideration is part of a Sprint Planning we have a learning effect on setting a Sprint Scope.</p>
</div>
</div>
<div class="sect2">
<h3 id="03-05-2017-sprint-2-planning"><a class="anchor" href="#03-05-2017-sprint-2-planning"></a>28.13. 03.05.2017 Sprint 2 Planning</h3>
<div class="paragraph">
<p>As we aligned during the Sprint 1 Review on transferring unfinished user stories into Sprint 2 the focus for Sprint 2 was on finishing these transferred user stories. During our discussion on how many user stories we could work on in Sprint 2 we needed to remind ourselves that the overall target is to develop an example application for the devonfw. Considering this we aligned on a clear target for Sprint 2: To focus on finishing User Stories as we need to aim for a practicable and realizable solution. Everybody aligned on the aim of having a working application at the end of Sprint 2.
For the estimation process of user stories we make again usage of planningpoker.com as the team prefers this “easy-to-use” tool. During our second estimation process we had the situation in which the estimated story points differs strongly from one team member to another. In this case the team members shortly explains how the understood and interpreted the user story. It turned out that team members misinterpreted the user stories. With having this discussion all team members got the same understanding of the specific functionality and scope of a user story. After the alignment the team members adjusted their estimations.
Beside this need for discussion the team estimated most of the user stories with very similar story points. This fact shows the increase within the effort estimation for each team member in comparison to Sprint 1 planning. Over the short time of two Sprint planning the team received a better understanding and feeling for the estimation with story points.</p>
</div>
</div>
<div class="sect2">
<h3 id="01-06-2017-sprint-2-review"><a class="anchor" href="#01-06-2017-sprint-2-review"></a>28.14. 01.06.2017 Sprint 2 Review</h3>
<div class="paragraph">
<p>As our Sprint 1 Review four weeks ago was not completely structured like a Sprint Review meeting we focused on the actual intention of a Sprint Review meeting during Sprint 2 Review. This means we demonstrated the completed and implemented functionalities with screen sharing and the product owner accepted the completed tasks.
Within the User Story <code>ICSDSHOW-22</code> “See all orders/reservations” the functionality “filtering the list by date” could have not been implemented during Sprint 2. The team was unsure on how to proceed with this task. One team member added that especially in regards of having a coherent release, implementing less but working functionalities is much better than implementing more but not working functionalities. For this the team reminded itself focusing on completing functionalities and not working straight to a working application.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="user-stories"><a class="anchor" href="#user-stories"></a>28.15. User Stories</h3>
<div class="paragraph">
<p>The list of user stories, exported from JIRA, can be downloaded from <a href="resources/us_export_jira.xlsx">here</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="epic-invite-friends"><a class="anchor" href="#epic-invite-friends"></a>28.16. Epic: Invite friends</h3>

</div>
<div class="sect2">
<h3 id="us-create-invite-for-friends"><a class="anchor" href="#us-create-invite-for-friends"></a>28.17. US: create invite for friends</h3>
<div class="paragraph">
<p>Epic: Invite friends</p>
</div>
<div class="paragraph">
<p>As a guest I want to create an dinner event by entering date and time and adding potential guests by their emails so that each potential guest will receives an email in order to confirm or decline my invite.</p>
</div>
</div>
<div class="sect2">
<h3 id="acceptance-criteria"><a class="anchor" href="#acceptance-criteria"></a>28.18. == Acceptance criteria</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>only date and time in future possible and both required</p>
</li>
<li>
<p>only valid email addresses: <a href="mailto:text@text.xx">text@text.xx</a>, one entered email-address is required</p>
</li>
<li>
<p>if <code>AGB</code> are not checked, an error message is shown</p>
</li>
<li>
<p>after the invite is done</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>I see the confirmation screen of my invite (see wireframe)</p>
</li>
<li>
<p>I receive a confirmation email about my invite containing date, time and invited guests</p>
</li>
<li>
<p>all guests receive a mail with my invite</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="us-create-reservation"><a class="anchor" href="#us-create-reservation"></a>28.19. US: create reservation</h3>
<div class="paragraph">
<p>Epic: Invite friends</p>
</div>
<div class="paragraph">
<p>As a guest I want to create a reservation by entering date and time and number of adults and kids</p>
</div>
</div>
<div class="sect2">
<h3 id="acceptance-criteria-2"><a class="anchor" href="#acceptance-criteria-2"></a>28.20. == Acceptance criteria</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>only date and time in future possible and both required</p>
</li>
<li>
<p>only valid email addresses: <a href="mailto:text@text.xx">text@text.xx</a>, one entered email-address is required</p>
</li>
<li>
<p>if <code>AGB</code> are not checked, an error message is shown</p>
</li>
<li>
<p>after the reservation is done</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>I see a confirmation screen of my reservation with date-time, number of persons and kids</p>
</li>
<li>
<p>I receive a confirmation email about my reservation</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="wireframes"><a class="anchor" href="#wireframes"></a>28.21. == Wireframes</h3>
<div class="paragraph">
<p>see real time board</p>
</div>
</div>
<div class="sect2">
<h3 id="us-handle-invite"><a class="anchor" href="#us-handle-invite"></a>28.22. US: handle invite</h3>
<div class="paragraph">
<p>As an invited guest I would like to receive an email - after somebody as invited me - with the option to accept or decline the invite so that the system knows about my participation</p>
</div>
</div>
<div class="sect2">
<h3 id="ac"><a class="anchor" href="#ac"></a>28.23. == AC:</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the mail contains the following information about the invite</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>who has invited</p>
</li>
<li>
<p>who else is invited</p>
</li>
<li>
<p>date and time of the invite</p>
</li>
<li>
<p>button to accept or decline</p>
</li>
<li>
<p>after pressing the buttons the system will store the status (yes/no) of my invite</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="us-revoke-accepted-invite"><a class="anchor" href="#us-revoke-accepted-invite"></a>28.24. US: revoke accepted invite</h3>
<div class="paragraph">
<p>As an invited guest I would like to revoke my previous answer in order to inform the system and the inviter about my no showup</p>
</div>
</div>
<div class="sect2">
<h3 id="ac-2"><a class="anchor" href="#ac-2"></a>28.25. ==  AC:</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the inviter and myself receives an email about my cancellation</p>
</li>
<li>
<p>the system sets my status of my invite to no</p>
</li>
<li>
<p>in case I have placed an order, the order is also removed from the system.</p>
</li>
<li>
<p>the cancellation is only possible 10 minutes before the event takes place. The system shows a message that cancellation is not possible anymore.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="us-calculate-best-table"><a class="anchor" href="#us-calculate-best-table"></a>28.26. US: calculate best table</h3>
<div class="paragraph">
<p>As a guest I would like the system to check (1 hour before my invite) all my invites and to reserve a table fitting the number of accepted users</p>
</div>
</div>
<div class="sect2">
<h3 id="details"><a class="anchor" href="#details"></a>28.27. == Details</h3>
<div class="paragraph">
<p>Pseudo-algorithm for reservation:
Find table for given date and time where seats of guests &gt;= Count of invited guests plus one. In case no results, decline request and show error message to user. In case of any result, make a reservation for table&#8230;&#8203;.
For each decline of a guest remove guest and search with reduced number for new table. In case table is found, reserve it and remove reservation from previous table. In case not, do not change reservations.</p>
</div>
</div>
<div class="sect2">
<h3 id="us-find-table-by-reservation-info"><a class="anchor" href="#us-find-table-by-reservation-info"></a>28.28. US: find table by reservation info</h3>
<div class="paragraph">
<p>As a waiter I would like to search by reference number or email address for the reserved table in order to know the table for my visit. (when arriving at the restaurant)</p>
</div>
</div>
<div class="sect2">
<h3 id="ac-3"><a class="anchor" href="#ac-3"></a>28.29. == AC:</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After entering the email the systems shows the number of the table. In case no reservation found, a message is shown.</p>
</li>
<li>
<p>Entered email address could be email of inviter or any invited guest.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="us-cancel-invite"><a class="anchor" href="#us-cancel-invite"></a>28.30. US: cancel invite</h3>
<div class="paragraph">
<p>Epic: Invite friends</p>
</div>
<div class="paragraph">
<p>As a guests who has sent an invite I want to be able to cancel my previous invite in order to inform the restaurant and my invited guests that I will not show up</p>
</div>
</div>
<div class="sect2">
<h3 id="ac-4"><a class="anchor" href="#ac-4"></a>28.31. == AC:</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the option to cancel the invite is available in the confirmation-mail about my invite</p>
</li>
<li>
<p>after my cancellation all invited guests receives a mail about the cancellation</p>
</li>
<li>
<p>I see a confirmation that my invite was canceled successfully</p>
</li>
<li>
<p>after my cancellation my invite and reservation and all orders related to it are deleted from the system and no one can accept or decline any invite for it</p>
</li>
<li>
<p>the cancellation is only possible one hour before the invite takes place. After that I am not allowed to cancel it any more.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="epic-digital-menu"><a class="anchor" href="#epic-digital-menu"></a>28.32. Epic: Digital Menu</h3>

</div>
<div class="sect2">
<h3 id="us-filter-menu"><a class="anchor" href="#us-filter-menu"></a>28.33. US: filter menu</h3>
<div class="paragraph">
<p>As a guest I want to filter the menu so that I only see the dishes I am interested in</p>
</div>
</div>
<div class="sect2">
<h3 id="ac-5"><a class="anchor" href="#ac-5"></a>28.34. == AC:</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the guest can filter by</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>type: starter | main dish | dessert; XOR; if nothing is selected all are shown (default value)</p>
</li>
<li>
<p>veggy (yes|no|does not matter (default))</p>
</li>
<li>
<p>vegan (yes|no|does not matter (default))</p>
</li>
<li>
<p>rice (yes|no|does not matter (default))</p>
</li>
<li>
<p>curry (yes|no|does not matter (default))</p>
</li>
<li>
<p>noodle (yes|no|does not matter (default))</p>
</li>
<li>
<p>price (range)</p>
</li>
<li>
<p>ratings (range)</p>
</li>
<li>
<p>my favorite (yes|no|does not matter (default))&#8201;&#8212;&#8201;free text (search in title and description)</p>
</li>
</ol>
</div>
</li>
<li>
<p>the guest can sort by price asc, rating asc</p>
</li>
<li>
<p>after setting the filter only dishes are shown which fulfills those criteria</p>
</li>
<li>
<p>by pressing the button reset filter all filter are reset to the initial value</p>
</li>
<li>
<p>by pressing the filter button the filter is applied [or is it triggered after each change?]</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="us-define-order"><a class="anchor" href="#us-define-order"></a>28.35. US: Define order</h3>
<div class="paragraph">
<p>As a guest I want to define my order by selecting dishes from the menu</p>
</div>
</div>
<div class="sect2">
<h3 id="ac-6"><a class="anchor" href="#ac-6"></a>28.36. == AC:</h3>
<div class="ulist">
<ul>
<li>
<p>The guest can add each dish to the order</p>
</li>
<li>
<p>In case the guest adds the same dish multiple times, a counter in the order for this dish is increased for this dish</p>
</li>
<li>
<p>The guest can remove the dish from the order</p>
</li>
<li>
<p>The guest can add for each main dish the type of meat (pork, chicken, tofu)</p>
</li>
<li>
<p>The guest can add for each dish a free-text-comment</p>
</li>
<li>
<p>After adding/removing any dish the price is calculated including VAT</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="us-order-the-order"><a class="anchor" href="#us-order-the-order"></a>28.37. US: Order the order</h3>
<div class="paragraph">
<p>As a guest I want to order my selected dishes (order)</p>
</div>
<div class="paragraph">
<p>AC:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>I receive a mail containing my order with all dishes and the final price</p>
</li>
<li>
<p>precondition for ordering:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Each order must be associated with a reservation / invite. Without any reference no order could be placed. The reference could be obtained from a previous reservation/invite (created during same session) or by the previous accepted invite (link in email) or by entering the reference id when asked by the system.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>In case precondition is not fulfilled, the guest is asked</p>
<div class="olist upperalpha">
<ol class="upperalpha" type="A">
<li>
<p>whether he/she would like to create a reservation/invite and is forwarded to US Invite Friends. Only after finalizing the reservation the order is accepted.</p>
</li>
<li>
<p>or he/she would enter previous created reservation-id he/she knows in order to associate his/her order with this reservation</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="us-cancel-order"><a class="anchor" href="#us-cancel-order"></a>28.38. US: Cancel order</h3>
<div class="paragraph">
<p>As a guest I want to cancel my order.</p>
</div>
<div class="paragraph">
<p>AC:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>in my received confirmation mail I have the option to cancel my order</p>
</li>
<li>
<p>the cancellation is only possible one hour before my reservation takes place</p>
</li>
<li>
<p>my order is deleted from the system</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Remark: Changing the order is not possible. For that the order must be canceled and created from scratch again</p>
</div>
</div>
<div class="sect2">
<h3 id="us-read-twitter-rating-for-dishes"><a class="anchor" href="#us-read-twitter-rating-for-dishes"></a>28.39. US: Read twitter rating for dishes</h3>
<div class="paragraph">
<p>As a guest I want to read for all dishes the rating done be twitter because I would like to know the opinion of others</p>
</div>
<div class="paragraph">
<p>AC:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>For each dish I see the latest 3 comments done by twitter for this vote (text, username, avatar)</p>
</li>
<li>
<p>For each dish I see the number of likes done by twitter</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="epic-user-profile"><a class="anchor" href="#epic-user-profile"></a>28.40. Epic: User Profile</h3>

</div>
<div class="sect2">
<h3 id="us-user-profile"><a class="anchor" href="#us-user-profile"></a>28.41. US: User Profile</h3>
<div class="paragraph">
<p>As a guest I want to have a user profile to associate it with my twitter account to be able to like/rate dishes</p>
</div>
<div class="paragraph">
<p>AC:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Username of my profile is my email address</p>
</li>
<li>
<p>My profile is protected by password</p>
</li>
<li>
<p>I can log in and log out to my profile</p>
</li>
<li>
<p>I can reset my password by triggering the reset by mail</p>
</li>
<li>
<p>I can associate my profile with my twitter account in order to rate dishes and store my favorites by liking posts associated to dishes</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="epic-rate-by-twitter"><a class="anchor" href="#epic-rate-by-twitter"></a>28.42. Epic: Rate by twitter</h3>

</div>
<div class="sect2">
<h3 id="us-receive-mail-to-rate-your-dish"><a class="anchor" href="#us-receive-mail-to-rate-your-dish"></a>28.43. US: Receive mail to rate your dish</h3>
<div class="paragraph">
<p>As a guest I want to receive a mail by the system in order to rate my dish</p>
</div>
</div>
<div class="sect2">
<h3 id="us-rate-your-dish"><a class="anchor" href="#us-rate-your-dish"></a>28.44. US: Rate your dish</h3>
<div class="paragraph">
<p>As a guest I want to add a comment or a like via my twitter account for a dish</p>
</div>
<div class="paragraph">
<p>AC:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Before I write my rate I would like to be able to read all tweets of other users for this dish</p>
</li>
<li>
<p>I would like to see the number of likes for a dish</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="epic-waiter-cockpit"><a class="anchor" href="#epic-waiter-cockpit"></a>28.45. Epic: Waiter Cockpit</h3>

</div>
<div class="sect2">
<h3 id="us-see-all-ordersreservations"><a class="anchor" href="#us-see-all-ordersreservations"></a>28.46. US: See all orders/reservations</h3>
<div class="paragraph">
<p>As a waiter I want to see all orders/reservation in order to know what is going on in my restaurant</p>
</div>
<div class="paragraph">
<p>AC:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>all orders/reservations are shown in a list view (read-only). Those list can be filtered and sorted (similar to excel-data-filters)</p>
</li>
<li>
<p>orders/reservations are shown in separate lists.</p>
</li>
<li>
<p>for each order the dish, meat, comment, item, reservation-id, reservation date-time, creation-date-time is shown</p>
</li>
<li>
<p>for each reservation the inviters email, the guests-emails, the number of accepts and declines, calculated table number, the reservation-id, reservation date-time and creation-date-time are shown</p>
</li>
<li>
<p>the default filter for all lists is the today&#8217;s date for reservation date-time. this filter can be deleted.</p>
</li>
<li>
<p>only reservations and orders with reservation date in the future shall be available in this view. All other orders and reservation shall not be deleted; for data Analytics those orders and reservation shall still exist in the system.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>checklist:</p>
</div>
<div class="paragraph">
<p>talk about:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>who?</p>
</li>
<li>
<p>what?</p>
</li>
<li>
<p>why (purpose)</p>
</li>
<li>
<p>why (objective)</p>
</li>
<li>
<p>what happens outside the software</p>
</li>
<li>
<p>what might go wrong</p>
</li>
<li>
<p>any question or assumptions (write them down) , DoR should check that those sections are empty.</p>
</li>
<li>
<p>is there any better solution?</p>
</li>
<li>
<p>how (technical perspective)</p>
</li>
<li>
<p>do a rough estimate</p>
</li>
<li>
<p>check INVEST</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="technical-design"><a class="anchor" href="#technical-design"></a>29. Technical design</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="data-model-2"><a class="anchor" href="#data-model-2"></a>30. Data Model</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect4">
<h5 id="data-model-3"><a class="anchor" href="#data-model-3"></a>Data Model</h5>
<div class="imageblock">
<div class="content">
<a class="image" href="images/mts_datamodel.png"><img src="_images/images/mts_datamodel.png" alt="mts datamodel"></a>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="nosql-data-model"><a class="anchor" href="#nosql-data-model"></a>NoSQL Data Model</h5>
<div class="imageblock">
<div class="content">
<a class="image" href="images/nodejs/dynamodb-data-model-1.4.1.png"><img src="_images/images/nodejs/dynamodb-data-model-1.4.1.png" alt="dynamodb data model 1.4.1"></a>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="server-side"><a class="anchor" href="#server-side"></a>31. Server Side</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect4">
<h5 id="java-design"><a class="anchor" href="#java-design"></a>Java design</h5>

</div>
<div class="sect4">
<h5 id="introduction-11"><a class="anchor" href="#introduction-11"></a>Introduction</h5>
<div class="paragraph">
<p>The Java back-end for My Thai Star application is going to be based on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>DEVON4J</strong> as the Java framework</p>
</li>
<li>
<p><strong>Devonfw</strong> as the Development environment</p>
</li>
<li>
<p><strong>CobiGen</strong> as code generation tool</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To know more details about the above technologies please visit the following documentation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4j/wiki">DEVON4J</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon/wiki">Devonfw</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/wiki">CobiGen</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="basic-architecture-details-2"><a class="anchor" href="#basic-architecture-details-2"></a>Basic architecture details</h5>
<div class="paragraph">
<p>Following the DEVON4J conventions the Java My Thai Star back-end is going to be developed dividing the application in <em>Components</em> and using a three layers architecture.</p>
</div>
</div>
<div class="sect4">
<h5 id="project-modules"><a class="anchor" href="#project-modules"></a>Project modules</h5>
<div class="paragraph">
<p>Using the DEVON4J approach for the Java back-end project we will have a structure of a <em>Maven</em> project formed by three projects</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/java/project_modules.png"><img src="_images/images/java/project_modules.png" alt="project modules"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>api</em></code>: Stores all the REST interfaces and corresponding Request/Response objects.</p>
</li>
<li>
<p><em>core</em>: Stores all the logic and functionality of the application.</p>
</li>
<li>
<p><em>server</em>: Configures the packaging of the application.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We can automatically generate this project structure <a href="https://github.com/devonfw/devon/wiki/getting-started-creating-new-devonfw-application#running-the-archetype">using the DEVON4J <em>Maven</em> archetype</a></p>
</div>
</div>
<div class="sect4">
<h5 id="components-2"><a class="anchor" href="#components-2"></a>Components</h5>
<div class="paragraph">
<p>The application is going to be divided in different components to encapsulate the different domains of the application functionalities.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/java/mtsj_components.png"><img src="_images/images/java/mtsj_components.png" alt="mtsj components"></a>
</div>
</div>
<div class="paragraph">
<p>As <em>main components</em> we will find:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>Bookingmanagement</em></code>: Manages the bookings part of the application. With this component the users (anonymous/logged in) can create new bookings or cancel an existing booking. The users with waiter role can see all scheduled bookings.</p>
</li>
<li>
<p><code><em>Ordermanagement</em></code>: This component handles the process to order dishes (related to bookings). A user (as a host or as a guest) can create orders (that contain dishes) or cancel an existing one. The users with waiter role can see all ordered orders.</p>
</li>
<li>
<p><code><em>Dishmanagement</em></code>: This component groups the logic related to the menu (dishes) view. Its main feature is to provide the client with the data of the available dishes but also can be used by other components <code>(Ordermanagement)</code> as a data provider in some processes.</p>
</li>
<li>
<p><code><em>Usermanagement</em></code>: Takes care of the User Profile management, allowing to create and update the data profiles.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As <em>common components</em> (that don&#8217;t exactly represent an application&#8217;s area but provide functionalities that can be used by the <em>main components</em>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>Imagemanagement</em></code>: Manages the images of the application. In a first approach the` <em>Dishmanagement</em>` component and the <code><em>Usermanagement</em></code> component will have an image as part of its data. The <code><em>Imagemanagement</em></code> component will expose the functionality to store and retrieve this kind of data.</p>
</li>
<li>
<p><code><em>Mailservice</em></code>: with this service we will provide the functionality for sending email notifications. This is a shared service between different app components such as <code><em>bookingmanagement</em></code> or <code><em>ordercomponent</em></code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Other components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Security (will manage the access to the <em>private</em> part of the application using a <code><a href="https://jwt.io/">jwt</a></code> implementation).</p>
</li>
<li>
<p>Twitter integration: planned as a <em>Microservice</em> will provide the twitter integration needed for some specific functionalities of the application.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="layers-9"><a class="anchor" href="#layers-9"></a>Layers</h5>
<div class="ulist">
<ul>
<li>
<p><code><a href="https://github.com/devonfw/devon4j/wiki/guide-service-layer">Service Layer</a></code>: this layer will expose the REST API to exchange information with the client applications.</p>
</li>
<li>
<p><code><a href="https://github.com/devonfw/devon4j/wiki/guide-logic-layer">Logic Layer</a></code>: the layer in charge of hosting the business logic of the application.</p>
</li>
<li>
<p><code><a href="https://github.com/devonfw/devon4j/wiki/guide-dataaccess-layer">Data Access Layer</a></code>: the layer to communicate with the data base.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This architecture is going to be reflected dividing each component of the application in different packages to match those three layers.</p>
</div>
</div>
<div class="sect4">
<h5 id="component-structure"><a class="anchor" href="#component-structure"></a>Component structure</h5>
<div class="paragraph">
<p>Each one of the components defined previously are going to be structured using the <em>three-layers</em> architecture. In each case we will have a <em>service</em> package, a <em>logic</em> package and a <code><em>dataaccess</em></code> package to fit the layers definition.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/java/component_structure.png"><img src="_images/images/java/component_structure.png" alt="component structure"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="dependency-injection-3"><a class="anchor" href="#dependency-injection-3"></a>Dependency injection</h5>
<div class="paragraph">
<p>As it is explained in the <code><a href="https://github.com/devonfw/devon4j/wiki/guide-dependency-injection">devonfw documentation</a></code> we are going to implement the <em>dependency injection</em> pattern basing our solution on <em>Spring</em> and the Java standards: <em>java.inject</em> (JSR330) combined with JSR250.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/java/dependency_injection.png"><img src="_images/images/java/dependency_injection.png" alt="dependency injection"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Separation of API and implementation: Inside each layer we will separate the elements in different packages: <code><em>api</em></code> and <code><em>impl</em></code>. The <code><em>api</em></code> will store the <code><em>interface</em></code> with the methods definition and inside the <code><em>impl</em></code> we will store the class that implements the <code><em>interface</em></code>.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/java/layer_api_impl.png"><img src="_images/images/java/layer_api_impl.png" alt="layer api impl"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Usage of JSR330: The Java standard set of annotations for <em>dependency injection</em> (<code>@Named</code>, <code>@Inject</code>, <code>@PostConstruct</code>, <code>@PreDestroy</code>, etc.) provides us with all the needed annotations to define our beans and inject them.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named
public class MyBeanImpl implements MyBean {
  @Inject
  private MyOtherBean myOtherBean;

  @PostConstruct
  public void init() {
    // initialization if required (otherwise omit this method)
  }

  @PreDestroy
  public void dispose() {
    // shutdown bean, free resources if required (otherwise omit this method)
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="layers-communication"><a class="anchor" href="#layers-communication"></a>Layers communication</h5>
<div class="paragraph">
<p>The connection between layers, to access to the functionalities of each one, will be solved using the <em>dependency injection</em> and the JSR330 annotations.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/java/layers_impl.png"><img src="_images/images/java/layers_impl.png" alt="layers impl"></a>
</div>
</div>
<div class="paragraph">
<p><strong>Connection Service - Logic</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named("DishmanagementRestService")
public class DishmanagementRestServiceImpl implements DishmanagementRestService {

  @Inject
  private Dishmanagement dishmanagement;

  // use the 'this.dishmanagement' object to access to the functionalities of the logic layer of the component

  ...

}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Connection Logic - Data Access</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named
public class DishmanagementImpl extends AbstractComponentFacade implements Dishmanagement {

  @Inject
  private DishDao dishDao;

  // use the 'this.dishDao' to access to the functionalities of the data access layer of the component
  ...

}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="service-layer-4"><a class="anchor" href="#service-layer-4"></a>Service layer</h5>
<div class="paragraph">
<p>The services layer will be solved using REST services with the <a href="https://github.com/devonfw/devon4j/wiki/guide-rest#jax-rs">JAX-RS implementation</a>.</p>
</div>
<div class="paragraph">
<p>To give service to the defined <em>User Stories</em> we will need to implement the following services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>provide all available dishes.</p>
</li>
<li>
<p>save a booking.</p>
</li>
<li>
<p>save an order.</p>
</li>
<li>
<p>provide a list of bookings (only for waiters) and allow filtering.</p>
</li>
<li>
<p>provide a list of orders (only for waiters) and allow filtering.</p>
</li>
<li>
<p>login service (see the <em>Security</em> section).</p>
</li>
<li>
<p>provide the <em>current user</em> data (see the <em>Security</em> section)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Following the <a href="https://github.com/devonfw/devon4j/wiki/guide-rest">naming conventions</a> proposed for <em>Devon4j</em> applications we will define the following <em>end points</em> for the listed services.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(POST) <code>/mythaistar/services/rest/dishmanagement/v1/dish/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/bookingmanagement/v1/booking</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/bookingmanagement/v1/booking/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/filter</code> (to filter with fields that does not belong to the Order entity).</p>
</li>
<li>
<p>(POST) <code>/mythaistar/login</code>.</p>
</li>
<li>
<p>(GET) <code>/mythaistar/services/rest/security/v1/currentuser/</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find all the details for the services implementation in the <a href="https://github.com/devonfw/my-thai-star/blob/develop/swagger/mythaistar.yaml">Swagger definition</a> included in the My Thai Star project on Github.</p>
</div>
</div>
<div class="sect4">
<h5 id="service-api"><a class="anchor" href="#service-api"></a>Service API</h5>
<div class="paragraph">
<p>The <code><em>api.rest</em></code> package in the <em>service</em> layer of a <em>component</em> will store the definition of the service by a  <em>Java interface</em>. In this definition of the service we will set-up the <em>endpoints</em> of the service, the type of data expected and returned, the <em>HTTP</em> method for each endpoint of the service and other configurations if needed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Path("/dishmanagement/v1")
@Consumes(MediaType.APPLICATION_JSON)
@Produces(MediaType.APPLICATION_JSON)
public interface DishmanagementRestService {

  @GET
  @Path("/dish/{id}/")
  public DishCto getDish(@PathParam("id") long id);

  ...

}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="service-impl"><a class="anchor" href="#service-impl"></a>Service <code>impl</code></h5>
<div class="paragraph">
<p>Once the service <code><em>api</em></code> is defined we need to implement it using the <em>Java interface</em> as reference. We will add the <em>service implementation</em> class to the <code><em>impl.rest</em></code> package and implement the <code><em>RestService interface</em></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named("DishmanagementRestService")
public class DishmanagementRestServiceImpl implements DishmanagementRestService {

  @Inject
  private Dishmanagement dishmanagement;

  @Override
  public DishCto getDish(long id) {
    return this.dishmanagement.findDish(id);
  }

  ...

}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="-16"><a class="anchor" href="#-16"></a>==</h5>
<div class="paragraph">
<p>You can see the Devon4j conventions for REST services <a href="https://github.com/devonfw/devon4j/wiki/guide-rest">here</a>. And the My Thai Star services definition <a href="https://github.com/devonfw/my-thai-star/blob/develop/swagger/mythaistar.yaml">here</a> as part of the <a href="https://github.com/devonfw/my-thai-star">My Thai Star</a> project.
== ==</p>
</div>
</div>
<div class="sect4">
<h5 id="logic-layer-2"><a class="anchor" href="#logic-layer-2"></a>Logic layer</h5>
<div class="paragraph">
<p>In the <em>logic</em> layer we will locate all the <em>business logic</em> of the application. We will keep the same schema as we have done for the <em>service</em> layer, having an <code><em>api</em></code> package with the definition of the methods and a <code><em>impl</em></code> package for the implementation.</p>
</div>
<div class="paragraph">
<p>Also, inside the <code><em>api</em></code> package, a <em>to</em> package will be the place to store the <code><a href="https://github.com/devonfw/devon4j/wiki/guide-transferobject"><em>transfer objects</em></a></code> needed to pass data through the layers of the component.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/java/logic_layer.png"><img src="_images/images/java/logic_layer.png" alt="logic layer"></a>
</div>
</div>
<div class="paragraph">
<p>The logic <code><em>api</em></code> definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public interface Dishmanagement {

  DishCto findDish(Long id);

  ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The logic <code><em>impl</em></code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Named
public class DishmanagementImpl extends AbstractComponentFacade implements Dishmanagement {

  @Inject
  private DishDao dishDao;


  @Override
  public DishCto findDish(Long id) {

    return getBeanMapper().map(this.dishDao.findOne(id), DishCto.class);
  }

  ...

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code><em>BeanMapper</em></code> will provide the needed transformations between <em>entity</em> and <em>transfer objects</em>.</p>
</div>
<div class="paragraph">
<p>Also, the <em>logic</em> layer is the place to add validation for <em>Authorization</em> based on <em>roles</em> as we will see later.</p>
</div>
</div>
<div class="sect4">
<h5 id="data-access-layer-3"><a class="anchor" href="#data-access-layer-3"></a>Data Access layer</h5>
<div class="paragraph">
<p>The data-access layer is responsible for managing the connections to access and process data. The mapping between java objects to a relational database is done in <em>Devon4j</em> with the <a href="https://spring.io/projects/spring-data-jpa">spring-data-jpa</a>.</p>
</div>
<div class="paragraph">
<p>As in the previous layers, the <em>data-access</em> layer will have both <code><em>api</em></code> and <code><em>impl</em></code> packages. However, in this case, the implementation will be slightly different. The <code><em>api</em></code> package will store the <em>component</em> main <em>entities and, inside the <code>_api</em></code> package, another <code><em>api.repo</em></code> package will store the Repositories. The <em>repository</em> interface will extend <code>DefaultRepository</code> interface (located in <code>com.devonfw.module.jpa.dataaccess.api.data</code> package of <a href="http://repo1.maven.org/maven2/com/devonfw/java/starters/devon4j-starter-spring-data-jpa/3.0.0/">devon4j-starter-spring-data-jpa</a> ).</p>
</div>
<div class="paragraph">
<p>For queries we will differentiate between <em>static queries</em> (that will be located in a mapped file) and <em>dynamic queries</em> (implemented with <a href="http://www.querydsl.com/">QueryDsl</a>). You can find all the details about how to manage queries with <em>Devon4j</em> <a href="https://github.com/devonfw/devon4j/wiki/guide-jpa-query">here</a>.</p>
</div>
<div class="paragraph">
<p>The default data base included in the project will be the <a href="http://www.h2database.com/html/main.html">H2</a> instance included with the <em>Devon4j</em> projects.</p>
</div>
<div class="paragraph">
<p>To get more details about <em>pagination</em>, <em>data base security, _concurrency control</em>, <em>inheritance</em> or how to solve the different <em>relationships</em> between entities visit the official <code><a href="https://github.com/devonfw/devon4j/wiki/guide-dataaccess-layer">devon4j dataaccess documentation</a></code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="security-with-json-web-token"><a class="anchor" href="#security-with-json-web-token"></a>Security with Json Web Token</h5>
<div class="paragraph">
<p>For the <em>Authentication</em> and <em>Authorization</em> the app will implement the <code><a href="https://jwt.io/">json web token</code></a> protocol.</p>
</div>
</div>
<div class="sect4">
<h5 id="jwt-basics-2"><a class="anchor" href="#jwt-basics-2"></a>JWT basics</h5>
<div class="ulist">
<ul>
<li>
<p>A user will provide a username / password combination to our Auth server.</p>
</li>
<li>
<p>The Auth server will try to identify the user and, if the credentials match, will issue a token.</p>
</li>
<li>
<p>The user will send the token as the <em>Authorization</em> header to access resources on server protected by JWT Authentication.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/java/jwt_schema.png"><img src="_images/images/java/jwt_schema.png" alt="jwt schema"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="jwt-implementation-details-2"><a class="anchor" href="#jwt-implementation-details-2"></a>JWT implementation details</h5>
<div class="paragraph">
<p>The <em>Json Web Token</em> pattern will be implemented based on the <a href="https://docs.spring.io/spring-security/site/docs/4.0.x/reference/htmlsingle/"><em>Spring Security</em></a> framework that is provided by default in the <em>Devon4j</em> projects.</p>
</div>
</div>
<div class="sect4">
<h5 id="authentication-4"><a class="anchor" href="#authentication-4"></a>==  Authentication</h5>
<div class="paragraph">
<p>Based on the <em>Spring Security</em> approach, we will implement a class extending <code><em>WebSecurityConfigurerAdapter</em></code> (<em>Devon4j</em> already provides the` <em>BaseWebSecurityConfig</em>` class) to define the security <em>entry point</em> and filters. Also, as <em>My Thai Star</em> is a mainly <em>public</em> application, we will define here the resources that won&#8217;t be secured.</p>
</div>
<div class="paragraph">
<p>List of <em>unsecured resources</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>/services/rest/dishmanagement/**</em></code>: to allow anonymous users to see the dishes info in the <em>menu</em> section.</p>
</li>
<li>
<p><code><em>/services/rest/ordermanagement/v1/order</em></code>: to allow anonymous users to save an order. They will need a <em>booking token</em> but they won&#8217;t be authenticated to do this task.</p>
</li>
<li>
<p><code><em>/services/rest/bookingmanagement/v1/booking</em></code>: to allow anonymous users to create a booking. Only a <em>booking token</em> is necessary to accomplish this task.</p>
</li>
<li>
<p><code><em>/services/rest/bookingmanagement/v1/booking/cancel/**</em></code>: to allow canceling a booking from an email. Only the <em>booking token</em> is needed.</p>
</li>
<li>
<p><code><em>/services/rest/bookingmanagement/v1/invitedguest/accept/**</em></code>: to allow guests to accept an invite. Only a <em>guest token</em> is needed.</p>
</li>
<li>
<p><code><em>/services/rest/bookingmanagement/v1/invitedguest/decline/**</em></code>: to allow guests to reject an invite. Only a <em>guest token</em> is needed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure the <em>login</em> we will set up the <code><em>HttpSecurity</em></code> object in the <em>configure</em> method of the class. We will define a <code><em>JWTLoginFilter</em></code> class that will handle the requests to the <code>/login</code> <em>endpoint</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">http.[...].antMatchers(HttpMethod.POST, "/login").permitAll().[...].addFilterBefore(new JWTLoginFilter("/login", authenticationManager()), UsernamePasswordAuthenticationFilter.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the same <code><em>HttpSecurity</em></code> object we will set up the filter for the rest of the requests, to check the presence of the JWT token in the header. First we will need to create a <code><em>JWTAuthenticationFilter</em></code> class extending the <code><em>GenericFilterBean</em></code> class. Then we can add the filter to the <code><em>HttpSecurity</em></code> object</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">http.[...].addFilterBefore(new `JWTAuthenticationFilter()`, UsernamePasswordAuthenticationFilter.class);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, as default users to start using the <em>My Thai Star</em> app we are going to define two profiles using the <code><em>inMemoryAuthentication</em></code> of the <em>Spring Security</em> framework. In the <code>configure(AuthenticationManagerBuilder Auth)</code> method we will create:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>user: <em>waiter</em></p>
</li>
<li>
<p>password: <em>waiter</em></p>
</li>
<li>
<p>role: <em>Waiter</em></p>
</li>
<li>
<p>user: <em>user0</em></p>
</li>
<li>
<p>password: <em>password</em></p>
</li>
<li>
<p>role: <em>Customer</em></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">auth.inMemoryAuthentication().withUser("waiter").password("waiter").roles("Waiter").and().withUser("user0").password("password").roles("Customer");</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="token-set-up"><a class="anchor" href="#token-set-up"></a>==  Token set up</h5>
<div class="paragraph">
<p>Following the <code><a href="https://jwt.io/introduction/">official documentation</a></code> the implementation details for the MyThaiStar&#8217;s JWT will be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Secret</em>: Used as part of the signature of the token, acting as a private key. For the showcase purposes we will use simply <code>"ThisIsASecret"</code>.</p>
</li>
<li>
<p><em>Token Prefix</em> schema: Bearer. The token will look like <code>Bearer &lt;token&gt;</code></p>
</li>
<li>
<p><em>Header</em>: Authorization. The response header where the token will be included. Also, in the requests, when checking the token it will be expected to be in the same header.</p>
</li>
<li>
<p>The <em>Authorization</em> header should be part of the <code>Access-Control-Expose-Headers</code> header to allow clients access to the <em>Authorization</em> header content (the token);</p>
</li>
<li>
<p>The <em>claims</em> are the content of the <em>payload</em> of the token. The <em>claims</em> are statements about the user, so we will include the user info in this section.</p>
<div class="ulist">
<ul>
<li>
<p><em>subject</em>: "sub". The username.</p>
</li>
<li>
<p><em>issuer</em>: <code>"iss"</code>. Who creates the token. We could use the <code><em>url</em></code> of our service but, as this is a showcase app, we simply will use <code>"MyThaiStarApp"</code></p>
</li>
<li>
<p><em>expiration date</em>: "exp". Defines when the token expires.</p>
</li>
<li>
<p><em>creation date</em>: <code>"iat"</code>. Defines when the token has been created.</p>
</li>
<li>
<p><em>scope</em>: "scope". Array of strings to store the user roles.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Signature Algorithm: To encrypt the token we will use the default algorithm HS512.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example of a token claims before encryption would be:</p>
</div>
<div class="paragraph">
<p><code>{sub=waiter, scope=[ROLE_Waiter], iss=MyThaiStarApp, exp=1496920280, iat=1496916680}</code></p>
</div>
</div>
<div class="sect4">
<h5 id="current-user-request"><a class="anchor" href="#current-user-request"></a>==  Current User request</h5>
<div class="paragraph">
<p>To provide to the client with the current user data our application should expose a service to return the user details. In <em>Devon4j</em> applications the <code>/general/service/impl/rest/SecurityRestServiceImpl.java</code> class is ready to do that.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Path("/security/v1")
@Named("SecurityRestService")
public class SecurityRestServiceImpl {

  @Produces(MediaType.APPLICATION_JSON)
  @GET
  @Path("/currentuser/")
  public UserDetailsClientTo getCurrentUserDetails(@Context HttpServletRequest request) {

  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>we only will need to implement the <code>getCurrentUserDetails</code> method.</p>
</div>
</div>
<div class="sect4">
<h5 id="authorization-2"><a class="anchor" href="#authorization-2"></a>==  Authorization</h5>
<div class="paragraph">
<p>We need to secure three services, that only should be accessible for users with role <em>Waiter</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(POST) <code>/mythaistar/services/rest/bookingmanagement/v1/booking/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/filter</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As part of the token we are providing the user <em>Role</em>. So, when validating the token, we can obtain that same information and build a <code>UsernamePasswordAuthenticationToken</code> with username and the roles as collection of <em>Granted Authorities</em>.</p>
</div>
<div class="paragraph">
<p>Doing so, afterwards, in the implementation class of the <em>logic</em> layer we can set up the related methods with the <em>java security</em> <code>'@RolesAllowed'</code> annotation to block the access to the resource to users that does not match the expected roles.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">`@RolesAllowed(Roles.WAITER)`
public PaginatedListTo&lt;BookingEto&gt; findBookings(BookingSearchCriteriaTo criteria) {
  return findBookings(criteria);
}</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="net-design"><a class="anchor" href="#net-design"></a>.NET design</h5>
<div class="paragraph">
<p>TODO</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="nodejs-design-deprecated"><a class="anchor" href="#nodejs-design-deprecated"></a>NodeJS design (deprecated)</h5>

</div>
<div class="sect4">
<h5 id="introduction-12"><a class="anchor" href="#introduction-12"></a>Introduction</h5>
<div class="paragraph">
<p>The NodeJS back-end for My Thai Star application is going to be based on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ExpressJS</strong> as the web application framework</p>
</li>
<li>
<p><strong>devon4node</strong> as data access layer framework</p>
</li>
<li>
<p><strong>DynamoDB</strong> as NoSQL Database</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To know more details about the above technologies please visit the following documentation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://expressjs.com">ExpressJS</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4node/wiki">devon4node</a></p>
</li>
<li>
<p><a href="https://aws.amazon.com/dynamodb/developer-resources/">DynamoDB</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="basic-architecture-details-3"><a class="anchor" href="#basic-architecture-details-3"></a>Basic architecture details</h5>
<div class="paragraph">
<p>This structure can be shown in the following example image:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/nodejs/folder_organization.png"><img src="_images/images/nodejs/folder_organization.png" alt="folder organization"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>public - All files which be exposed on the server directly</p>
</li>
<li>
<p><code>src</code></p>
<div class="ulist">
<ul>
<li>
<p>database folder - Folder with scripts to create/delete/seed the database</p>
</li>
<li>
<p>model - Folder with all data model</p>
</li>
<li>
<p>routes - Folder with all ExpressJS routers</p>
</li>
<li>
<p>utils - Folder with all utils like classes and functions</p>
</li>
<li>
<p><em>app.ts</em> - File with ExpressJS declaration</p>
</li>
<li>
<p><em>config.ts</em> - File with server configs</p>
</li>
<li>
<p><em>logic.ts</em> - File with the business logic</p>
</li>
</ul>
</div>
</li>
<li>
<p>test - Folder with all tests</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="layers-10"><a class="anchor" href="#layers-10"></a>Layers</h5>
<div class="ulist">
<ul>
<li>
<p>Service Layer: this layer will expose the REST API to exchange information with the client applications.</p>
</li>
<li>
<p>Logic Layer: the layer in charge of hosting the business logic of the application.</p>
</li>
<li>
<p>Data Access Layer: the layer to communicate with the data base.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="service-layer-5"><a class="anchor" href="#service-layer-5"></a>Service layer</h5>
<div class="paragraph">
<p>The services layer will be solved using REST services with <a href="https://expressjs.com">ExpressJS</a></p>
</div>
<div class="paragraph">
<p>To give service to the defined <em>User Stories</em> we will need to implement the following services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>provide all available dishes.</p>
</li>
<li>
<p>save a booking.</p>
</li>
<li>
<p>save an order.</p>
</li>
<li>
<p>provide a list of bookings (only for waiters) and allow filtering.</p>
</li>
<li>
<p>provide a list of orders (only for waiters) and allow filtering.</p>
</li>
<li>
<p>login service (see the <em>Security</em> section).</p>
</li>
<li>
<p>provide the <em>current user</em> data (see the <em>Security</em> section)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to be compatible with the other back-end implementations, we must follow the <code><a href="https://github.com/devonfw/devon4j/wiki/guide-rest">naming conventions</a></code> proposed for <em>Devon4j</em> applications. We will define the following <em>end points</em> for the listed services.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(POST) <code>/mythaistar/services/rest/dishmanagement/v1/dish/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/bookingmanagement/v1/booking</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/bookingmanagement/v1/booking/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/filter</code> (to filter with fields that does not belong to the Order entity).</p>
</li>
<li>
<p>(POST) <code>/mythaistar/login</code>.</p>
</li>
<li>
<p>(GET) <code>/mythaistar/services/rest/security/v1/currentuser/</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find all the details for the services implementation in the <a href="https://github.com/devonfw/my-thai-star/blob/develop/swagger/mythaistar.yaml">Swagger definition</a> included in the My Thai Star project on Github.</p>
</div>
<div class="paragraph">
<p>To treat these services separately, the following routers were created:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>bookingmanagement</code>: will answer all requests with the prefix <code>/mythaistar/services/rest/bookingmanagement/v1</code></p>
</li>
<li>
<p><code>dishmanagement</code>: will answer all requests with the prefix <code>/mythaistar/services/rest/dishmanagement/v1</code></p>
</li>
<li>
<p><code>ordermanagement</code>: will answer all requests with the prefix <code>/mythaistar/services/rest/ordermanagement/v1</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These routers will define the behavior for each service and use the logical layer.</p>
</div>
<div class="paragraph">
<p>An example of service definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">router.post('/booking/search', (req: types.CustomRequest, res: Response) =&gt; {
    try {
        // body content must be SearchCriteria
        if (!types.isSearchCriteria(req.body)) {
            throw {code: 400, message: 'No booking token given' };
        }

        // use the searchBooking method defined at business logic
        business.searchBooking(req.body, (err: types.Error | null, bookingEntity: types.PaginatedList) =&gt; {
            if (err) {
                res.status(err.code || 500).json(err.message);
            } else {
                res.json(bookingEntity);
            }
        });
    } catch (err) {
        res.status(err.code || 500).json({ message: err.message });
    }
});</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="logic-layer-and-data-access-layer"><a class="anchor" href="#logic-layer-and-data-access-layer"></a>Logic layer and Data access layer</h5>
<div class="paragraph">
<p>In the <em>logic</em> layer we will locate all the <em>business logic</em> of the application. It will be located in the file logic.ts. If in this layer we need to get access to the data, we make use of data access layer directly, in this case using devon4node with the DynamoDB adapter.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">export async function cancelOrder(orderId: string, callback: (err: types.Error | null) =&gt; void) {
    let order: dbtypes.Order;

    try {
        // Data access
        order = await oasp4fn.table('Order', orderId).promise() as dbtypes.Order;

        [...]
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We could define the data access layer separately, but devon4node allows us to do this in a simple and clear way. So, we decided  to not separate the access layer to the logic business.</p>
</div>
</div>
<div class="sect4">
<h5 id="security-with-json-web-token-2"><a class="anchor" href="#security-with-json-web-token-2"></a>Security with Json Web Token</h5>
<div class="paragraph">
<p>For the <em>Authentication</em> and <em>Authorization</em> the app will implement the <code><a href="https://jwt.io/">json web token</a></code> protocol.</p>
</div>
</div>
<div class="sect4">
<h5 id="jwt-basics-3"><a class="anchor" href="#jwt-basics-3"></a>JWT basics</h5>
<div class="paragraph">
<p>Refer to <a href="java-design#jwt-basics">JWT basics</a> for more information.</p>
</div>
</div>
<div class="sect4">
<h5 id="jwt-implementation-details-3"><a class="anchor" href="#jwt-implementation-details-3"></a>JWT implementation details</h5>
<div class="paragraph">
<p>The <em>Json Web Token</em> pattern will be implemented based on the <code><a href="https://github.com/auth0/node-jsonwebtoken"><em>JSON web token</em></a></code> library available on npm.</p>
</div>
</div>
<div class="sect4">
<h5 id="authentication-5"><a class="anchor" href="#authentication-5"></a>==  Authentication</h5>
<div class="paragraph">
<p>Based on the <em>JSON web token</em> approach, we will implement a class <em>Authentication</em> to define the security <em>entry point</em> and filters. Also, as <em>My Thai Star</em> is a mainly <em>public</em> application, we will define here the resources that won&#8217;t be secured.</p>
</div>
<div class="paragraph">
<p>List of <em>unsecured resources</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>/services/rest/dishmanagement/\**</em></code>: to allow anonymous users to see the dishes info in the <em>menu</em> section.</p>
</li>
<li>
<p><code><em>/services/rest/ordermanagement/v1/order</em></code>: to allow anonymous users to save an order. They will need a <em>booking token</em> but they won&#8217;t be authenticated to do this task.</p>
</li>
<li>
<p><code><em>/services/rest/bookingmanagement/v1/booking</em></code>: to allow anonymous users to create a booking. Only a <em>booking token</em> is necessary to accomplish this task.</p>
</li>
<li>
<p><code><em>/services/rest/bookingmanagement/v1/booking/cancel/\**</em></code>: to allow canceling a booking from an email. Only the <em>booking token</em> is needed.</p>
</li>
<li>
<p><code><em>/services/rest/bookingmanagement/v1/invitedguest/accept/\**</em></code>: to allow guests to accept an invite. Only a <em>guest token</em> is needed.</p>
</li>
<li>
<p><code><em>/services/rest/bookingmanagement/v1/invitedguest/decline/\**</em></code>: to allow guests to reject an invite. Only a <em>guest token</em> is needed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure the <em>login</em> we will create an instance of <em>Authentication</em> in the app file and then we will use the method <code><em>auth</em></code> for handle the requests to the /login endpoint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">app.post('/mythaistar/login', auth.auth);</code></pre>
</div>
</div>
<div class="paragraph">
<p>To verify the presence of the <em>Authorization token</em> in the headers, we will register in the express the <code><em>Authentication.registerAuthentication</em></code> middleware. This middleware will check if the token is correct, if so, it will place the user in the request and continue to process it. If the token is not correct it will continue processing the request normally.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">app.use(auth.registerAuthentication);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, we have two default users created in the database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>user: <em>waiter</em></p>
</li>
<li>
<p>password: <em>waiter</em></p>
</li>
<li>
<p>role: <em>WAITER</em></p>
</li>
<li>
<p>user: <em>user0</em></p>
</li>
<li>
<p>password: <em>password</em></p>
</li>
<li>
<p>role: <em>CUSTOMER</em></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="token-set-up-2"><a class="anchor" href="#token-set-up-2"></a>==  Token set up</h5>
<div class="paragraph">
<p>Following <code>the <a href="https://jwt.io/introduction/">official documentation</a></code> the implementation details for the MyThaiStar&#8217;s JWT will be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Secret</em>: Used as part of the signature of the token, acting as a private key. It can be modified at config.ts file.</p>
</li>
<li>
<p><em>Token Prefix</em> schema: Bearer. The token will look like <code>Bearer &lt;token&gt;</code></p>
</li>
<li>
<p><em>Header</em>: Authorization. The response header where the token will be included. Also, in the requests, when checking the token it will be expected to be in the same header.</p>
</li>
<li>
<p>The <em>Authorization</em> header should be part of the <code>Access-Control-Expose-Headers</code> header to allow clients access to the <em>Authorization</em> header content (the token);</p>
</li>
<li>
<p>Signature Algorithm: To encrypt the token we will use the default algorithm HS512.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="current-user-request-2"><a class="anchor" href="#current-user-request-2"></a>==  Current User request</h5>
<div class="paragraph">
<p>To provide to the client with the current user data our application should expose a service to return the user details. In this case the <em>Authentication</em> has a method called <code><em>getCurrentUser</em></code> which will return the user data. We only need register it at express.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">app.get('/mythaistar/services/rest/security/v1/currentuser', auth.getCurrentUser);</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="authorization-3"><a class="anchor" href="#authorization-3"></a>==  Authorization</h5>
<div class="paragraph">
<p>We need to secure three services, that only should be accessible for users with role <em>Waiter</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(POST) <code>/mythaistar/services/rest/bookingmanagement/v1/booking/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/filter</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To ensure this, the <em>Authorization</em> class has the <code><em>securizedEndpoint</em></code> method that guarantees access based on the role. This method can be used as middleware in secure services. As the role is included in the token, once validated we will have this information in the request and the middleware can guarantee access or return a 403 error.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">app.use('/mythaistar/services/rest/ordermanagement/v1/order/filter', auth.securizedEndpoint('WAITER'));
app.use('/mythaistar/services/rest/ordermanagement/v1/order/search', auth.securizedEndpoint('WAITER'));
app.use('/mythaistar/services/rest/bookingmanagement/v1/booking/search', auth.securizedEndpoint('WAITER'));</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="serverless-design-deprecated"><a class="anchor" href="#serverless-design-deprecated"></a>Serverless design (deprecated)</h5>

</div>
<div class="sect4">
<h5 id="introduction-13"><a class="anchor" href="#introduction-13"></a>Introduction</h5>
<div class="paragraph">
<p>The NodeJS back-end for My Thai Star application is going to be based on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Serverless</strong> as serverless framework</p>
</li>
<li>
<p><strong>devon4node</strong> as data access layer framework</p>
</li>
<li>
<p><strong>DynamoDB</strong> as NoSQL Database</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To know more details about the above technologies please visit the following documentation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://serverless.com/">Serverless</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4node/wiki">devon4node</a></p>
</li>
<li>
<p><a href="https://aws.amazon.com/dynamodb/developer-resources/">DynamoDB</a></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="basic-architecture-details-4"><a class="anchor" href="#basic-architecture-details-4"></a>Basic architecture details</h5>
<div class="paragraph">
<p>This structure can be shown in the following example image:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/serverless/folder_organization.png"><img src="_images/images/serverless/folder_organization.png" alt="folder organization"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>handlers - All function handlers following devon4node structure</p>
</li>
<li>
<p><code>src</code></p>
<div class="ulist">
<ul>
<li>
<p>model - Folder with all data model</p>
</li>
<li>
<p>utils - Folder with all utils like classes and functions</p>
</li>
<li>
<p><em>config.ts</em> - File with server configs</p>
</li>
<li>
<p><em>logic.ts</em> - File with the business logic</p>
</li>
</ul>
</div>
</li>
<li>
<p>test - Folder with all tests</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="layers-11"><a class="anchor" href="#layers-11"></a>Layers</h5>
<div class="ulist">
<ul>
<li>
<p>Service Layer: this layer will expose the REST API to exchange information with the client applications.</p>
</li>
<li>
<p>Logic Layer: the layer in charge of hosting the business logic of the application.</p>
</li>
<li>
<p>Data Access Layer: the layer to communicate with the data base.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="service-layer-6"><a class="anchor" href="#service-layer-6"></a>Service layer</h5>
<div class="paragraph">
<p>The services layer will be solved using REST services with <a href="https://serverless.com/">Serverless</a></p>
</div>
<div class="paragraph">
<p>To give service to the defined <em>User Stories</em> we will need to implement the following services:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>provide all available dishes.</p>
</li>
<li>
<p>save a booking.</p>
</li>
<li>
<p>save an order.</p>
</li>
<li>
<p>provide a list of bookings (only for waiters) and allow filtering.</p>
</li>
<li>
<p>provide a list of orders (only for waiters) and allow filtering.</p>
</li>
<li>
<p>login service (see the <em>Security</em> section).</p>
</li>
<li>
<p>provide the <em>current user</em> data (see the <em>Security</em> section)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In order to be compatible with the other back-end implementations, we must follow the <a href="https://github.com/devonfw/devon4j/wiki/guide-rest">naming conventions</a> proposed for <em>Devon4j</em> applications. We will define the following <em>end points</em> for the listed services.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(POST) <code>/mythaistar/services/rest/dishmanagement/v1/dish/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/bookingmanagement/v1/booking</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/bookingmanagement/v1/booking/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/filter</code> (to filter with fields that does not belong to the Order entity).</p>
</li>
<li>
<p>(POST) <code>/mythaistar/login</code>.</p>
</li>
<li>
<p>(GET) <code>/mythaistar/services/rest/security/v1/currentuser/</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find all the details for the services implementation in the <a href="https://github.com/devonfw/my-thai-star/blob/develop/swagger/mythaistar.yaml">Swagger definition</a> included in the My Thai Star project on Github.</p>
</div>
<div class="paragraph">
<p>To treat these Http services, we must define the handlers following the <a href="https://github.com/devonfw/devon4node/wiki">devon4node convention</a>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(handlers/Http/POST/dish-search-handler) <code>/mythaistar/services/rest/dishmanagement/v1/dish/search</code>.</p>
</li>
<li>
<p>(handlers/Http/POST/booking-handler) <code>/mythaistar/services/rest/bookingmanagement/v1/booking</code>.</p>
</li>
<li>
<p>(handlers/Http/POST/order-handler) <code>/mythaistar/services/rest/ordermanagement/v1/order</code>.</p>
</li>
<li>
<p>(handlers/Http/POST/booking-search-handler) <code>/mythaistar/services/rest/bookingmanagement/v1/booking/search</code>.</p>
</li>
<li>
<p>(handlers/Http/POST/order-search-handler) <code>/mythaistar/services/rest/ordermanagement/v1/order/search</code>.</p>
</li>
<li>
<p>(handlers/Http/POST/order-filter-handler) <code>/mythaistar/services/rest/ordermanagement/v1/order/filter</code> (to filter with fields that does not belong to the Order entity).</p>
</li>
<li>
<p>(handlers/Http/POST/login-handler) <code>/mythaistar/login</code>.</p>
</li>
<li>
<p>(handlers/Http/GET/current-user-handler) <code>/mythaistar/services/rest/security/v1/currentuser/</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These handlers will define the behavior for each service and use the logical layer.</p>
</div>
<div class="paragraph">
<p>An example of handler definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">oasp4fn.config({ path: '/mythaistar/services/rest/bookingmanagement/v1/booking/search' });
export async function bookingSearch(event: HttpEvent, context: Context, callback: Function) {
    try {
        const search = &lt;types.SearchCriteria&gt;event.body;
        const authToken = event.headers.Authorization;
        // falta lo que viene siendo comprobar el token y eso

        auth.decode(authToken, (err, decoded) =&gt; {
            if (err || decoded.role !==  'WAITER') {
                throw { code: 403, message: 'Forbidden'};
            }

            // body content must be SearchCriteria
            if (!types.isSearchCriteria(search)) {
                throw { code: 400, message: 'No booking token given' };
            }

            business.searchBooking(search, (err: types.Error | null, bookingEntity: types.PaginatedList) =&gt; {
                if (err) {
                    callback(new Error(`[${err.code || 500}] ${err.message}`));
                } else {
                    callback(null, bookingEntity);
                }
            });
        });
    } catch (err) {
        callback(new Error(`[${err.code || 500}] ${err.message}`));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default integration for a handler is <em>lambda</em>. See <a href="https://github.com/devonfw/devon4node/wiki/guides-configuration-module">devon4node documentation</a> for more information about default values and how to change it.</p>
</div>
</div>
<div class="sect4">
<h5 id="-17"><a class="anchor" href="#-17"></a>==</h5>
<div class="paragraph">
<p>If you change the integration to lambda-proxy, you must take care that in this case the data will not be parsed. You must do JSON.parse explicitly
== ==</p>
</div>
<div class="paragraph">
<p>After defining all the handlers, we must execute the <em>fun</em> command, which will generate the files serverless.yml and <code>webpack.config.js</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="logic-layer-and-data-access-layer-2"><a class="anchor" href="#logic-layer-and-data-access-layer-2"></a>Logic layer and Data access layer</h5>
<div class="paragraph">
<p><a href="NodeJS-design#logic-layer-and-data-access-layer">See in NodeJS section</a></p>
</div>
</div>
<div class="sect4">
<h5 id="security-with-json-web-token-3"><a class="anchor" href="#security-with-json-web-token-3"></a>Security with Json Web Token</h5>
<div class="paragraph">
<p>For the <em>Authentication</em> and <em>Authorization</em> the app will implement the <a href="https://jwt.io/">json web token</a> protocol.</p>
</div>
</div>
<div class="sect4">
<h5 id="jwt-basics-4"><a class="anchor" href="#jwt-basics-4"></a>JWT basics</h5>
<div class="paragraph">
<p>Refer to <a href="java-design#jwt-basics">JWT basics</a> for more information.</p>
</div>
</div>
<div class="sect4">
<h5 id="jwt-implementation-details-4"><a class="anchor" href="#jwt-implementation-details-4"></a>JWT implementation details</h5>
<div class="paragraph">
<p>The <em>Json Web Token</em> pattern will be implemented based on the <a href="https://github.com/auth0/node-jsonwebtoken"><em>JSON web token</em></a> library available on npm.</p>
</div>
</div>
<div class="sect4">
<h5 id="authentication-6"><a class="anchor" href="#authentication-6"></a>==  Authentication</h5>
<div class="paragraph">
<p>Based on the <em>JSON web token</em> approach, we will implement two methods in order to verify and user + generate the token and decode the token + return the user data. Also, as <em>My Thai Star</em> is a mainly <em>public</em> application, we will define here the resources that won&#8217;t be secured.</p>
</div>
<div class="paragraph">
<p>List of <em>unsecured resources</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>/services/rest/dishmanagement/**</em></code>: to allow anonymous users to see the dishes info in the <em>menu</em> section.</p>
</li>
<li>
<p><code><em>/services/rest/ordermanagement/v1/order</em></code>: to allow anonymous users to save an order. They will need a <em>booking token</em> but they won&#8217;t be authenticated to do this task.</p>
</li>
<li>
<p><code><em>/services/rest/bookingmanagement/v1/booking</em></code>: to allow anonymous users to create a booking. Only a <em>booking token</em> is necessary to accomplish this task.</p>
</li>
<li>
<p><code><em>/services/rest/bookingmanagement/v1/booking/cancel/**</em></code>: to allow canceling a booking from an email. Only the <em>booking token</em> is needed.</p>
</li>
<li>
<p><code><em>/services/rest/bookingmanagement/v1/invitedguest/accept/**</em></code>: to allow guests to accept an invite. Only a <em>guest token</em> is needed.</p>
</li>
<li>
<p><code><em>/services/rest/bookingmanagement/v1/invitedguest/decline/**</em></code>: to allow guests to reject an invite. Only a <em>guest token</em> is needed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure the <em>login</em> we will create a handler called login and then we will use the method <em>code</em> to verify the user and generate the token.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">app.post(oasp4fn.config({ integration: 'lambda-proxy', path: '/mythaistar/login' });
export async function login(event: HttpEvent, context: Context, callback: Function) {
.
.
.
.
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We have two default users created in the database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>user: <em>waiter</em></p>
</li>
<li>
<p>password: <em>waiter</em></p>
</li>
<li>
<p>role: <em>WAITER</em></p>
</li>
<li>
<p>user: <em>user0</em></p>
</li>
<li>
<p>password: <em>password</em></p>
</li>
<li>
<p>role: <em>CUSTOMER</em></p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="token-set-up-3"><a class="anchor" href="#token-set-up-3"></a>==  Token set up</h5>
<div class="paragraph">
<p><a href="NodeJS-design#token-set-up">See in NodeJS section</a></p>
</div>
</div>
<div class="sect4">
<h5 id="current-user-request-3"><a class="anchor" href="#current-user-request-3"></a>==  Current User request</h5>
<div class="paragraph">
<p>To provide the client with the current user data our application should expose a service to return the user details. In order to do this, we must define a handler called current-user-handler. This handler must decode the <em>Authorization token</em> and return the user data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">oasp4fn.config({
    path: '/mythaistar/services/rest/security/v1/currentuser',
});
export async function currentUser(event: HttpEvent, context: Context, callback: Function) {
    let authToken = event.headers.Authorization;
    try {
        auth.decode(authToken, (err: any, decoded?: any) =&gt; {
            if (err) {
                callback(new Error(`[403] Forbidden`));
            } else {
                callback(null, decoded);
            }
        });
    } catch (err) {
        callback(new Error(`[${err.code || 500}] ${err.message}`));
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="authorization-4"><a class="anchor" href="#authorization-4"></a>==  Authorization</h5>
<div class="paragraph">
<p>We need to secure three services, that only should be accessible for users with role <em>Waiter</em>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(POST) <code>/mythaistar/services/rest/bookingmanagement/v1/booking/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/search</code>.</p>
</li>
<li>
<p>(POST) <code>/mythaistar/services/rest/ordermanagement/v1/order/filter</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To ensure this, we must decode the <em>Authorization token</em> and check the result. As the role is included in the token, once validated we will have this information and can guarantee access or return a 403 error.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">oasp4fn.config({ path: '/mythaistar/services/rest/bookingmanagement/v1/booking/search' });
export async function bookingSearch(event: HttpEvent, context: Context, callback: Function) {
    const authToken = event.headers.Authorization;
    auth.decode(authToken, (err, decoded) =&gt; {
        try {
            if (err || decoded.role !==  'WAITER') {
                throw { code: 403, message: 'Forbidden' };
            }

            [...]

        } catch (err) {
            callback(new Error(`[${err.code || 500}] ${err.message}`));
        }
    });
}</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="graphql-design"><a class="anchor" href="#graphql-design"></a>GraphQL design</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="client-side"><a class="anchor" href="#client-side"></a>32. Client Side</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect4">
<h5 id="angular-design"><a class="anchor" href="#angular-design"></a>Angular design</h5>

</div>
<div class="sect4">
<h5 id="introduction-14"><a class="anchor" href="#introduction-14"></a>Introduction</h5>
<div class="paragraph">
<p><code>MyThaiStar</code> client side has been built using latest frameworks, component libraries and designs:</p>
</div>
<div class="paragraph">
<p><strong>Angular</strong> <em>4</em> as main front-end Framework. <a href="https://angular.io/" class="bare">https://angular.io/</a></p>
</div>
<div class="paragraph">
<p><strong>Angular/CLI</strong> <em>1.0.5</em> as Angular tool helper. <a href="https://github.com/angular/angular-cli" class="bare">https://github.com/angular/angular-cli</a></p>
</div>
<div class="paragraph">
<p><strong>Covalent Teradata</strong> <em>1.0.0-beta4</em> as Angular native component library based on Material Design. <a href="https://teradata.github.io/covalent/#/" class="bare">https://teradata.github.io/covalent/#/</a></p>
</div>
<div class="paragraph">
<p><strong>Angular/Material2</strong> <em>1.0.0-beta5</em> used by Covalent Teradata. <a href="https://github.com/angular/material2" class="bare">https://github.com/angular/material2</a></p>
</div>
<div class="paragraph">
<p><em>Note: this dependencies are evolving at this moment and if it is possible, we are updating it on the project.</em></p>
</div>
</div>
<div class="sect4">
<h5 id="basic-project-structure"><a class="anchor" href="#basic-project-structure"></a>Basic project structure</h5>
<div class="paragraph">
<p>The project is using the basic project seed that Angular/CLI provides with “ng new &lt;project name&gt;”. Then the app folder has been organized as Angular recommends and goes as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>app</p>
<div class="ulist">
<ul>
<li>
<p>components</p>
<div class="ulist">
<ul>
<li>
<p>sub-components</p>
</li>
<li>
<p>shared</p>
</li>
<li>
<p>component files</p>
</li>
</ul>
</div>
</li>
<li>
<p>main app component</p>
</li>
</ul>
</div>
</li>
<li>
<p>assets folder</p>
</li>
<li>
<p>environments folder</p>
</li>
<li>
<p>rest of angular files</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This structure can be shown in the following example image:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/angular/folder_organization.png"><img src="_images/images/angular/folder_organization.png" alt="folder organization"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="main-views-and-components"><a class="anchor" href="#main-views-and-components"></a>Main Views and components</h5>
<div class="paragraph">
<p>List of components that serve as a main view to navigate or components developed to make atomically a group of functionalities which given their nature, can be highly reusable through the app.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/angular/routes.png"><img src="_images/images/angular/routes.png" alt="routes"></a>
</div>
</div>
<div class="paragraph">
<p><em>Note: no-name-route corresponds to whatever URL the user introduced and does not exist, it redirects to Home-Component.</em></p>
</div>
</div>
<div class="sect4">
<h5 id="public-area"><a class="anchor" href="#public-area"></a>Public area</h5>

</div>
<div class="sect4">
<h5 id="app-component-2"><a class="anchor" href="#app-component-2"></a>==  App Component</h5>
<div class="paragraph">
<p>Contains the components that are on top of all views, including:</p>
</div>
</div>
<div class="sect4">
<h5 id="order-sidenav"><a class="anchor" href="#order-sidenav"></a>== Order sidenav</h5>
<div class="paragraph">
<p>Sidenav where selected orders are displayed with their total price and some comments.</p>
</div>
</div>
<div class="sect4">
<h5 id="navigation-sidenav-only-for-mobile"><a class="anchor" href="#navigation-sidenav-only-for-mobile"></a>== Navigation sidenav (only for mobile)</h5>
<div class="paragraph">
<p>This sidenav proposal is to let user navigate through the app when the screen is too small to show the navigation buttons on the header.</p>
</div>
</div>
<div class="sect4">
<h5 id="header"><a class="anchor" href="#header"></a>== Header</h5>
<div class="paragraph">
<p>It contains the title, and some other basic functions regarding open and close sidenavs.</p>
</div>
</div>
<div class="sect4">
<h5 id="footer-only-for-desktop"><a class="anchor" href="#footer-only-for-desktop"></a>== Footer (only for desktop)</h5>
<div class="paragraph">
<p>At the end of the page that shows only when open on desktop.</p>
</div>
</div>
<div class="sect4">
<h5 id="home-component"><a class="anchor" href="#home-component"></a>==  Home-Component</h5>
<div class="paragraph">
<p>Main view that shows up when the app initializes.</p>
</div>
</div>
<div class="sect4">
<h5 id="menu-component"><a class="anchor" href="#menu-component"></a>==  Menu-Component</h5>
<div class="paragraph">
<p>View where the users can view, filter and select the dishes (with their extras) they want to order it contains a component to each menu entry:</p>
</div>
</div>
<div class="sect4">
<h5 id="menu-card"><a class="anchor" href="#menu-card"></a>== Menu-card</h5>
<div class="paragraph">
<p>This component composes all the data of a dish in a card. Component made to display indeterminate number of dishes easily.</p>
</div>
</div>
<div class="sect4">
<h5 id="book-table-component"><a class="anchor" href="#book-table-component"></a>==  Book Table Component</h5>
<div class="paragraph">
<p>View to make book a table in a given data with a given number of assistants or create a reservation with a number of invitations via email.</p>
</div>
</div>
<div class="sect4">
<h5 id="book-table-dialog"><a class="anchor" href="#book-table-dialog"></a>== Book-table-dialog</h5>
<div class="paragraph">
<p>Dialog which opens as a result of fulfilling the booking form, it displays all the data of the booking attempt, if everything is correct, the user can send the information or cancel if something is wrong.</p>
</div>
</div>
<div class="sect4">
<h5 id="invitation-dialog"><a class="anchor" href="#invitation-dialog"></a>== Invitation-dialog</h5>
<div class="paragraph">
<p>Dialog which opens as a result of fulfilling the invitation form, it displays all the data of the booking with friends attempt, if everything is correct, the user can send the information or cancel if something is wrong.</p>
</div>
</div>
<div class="sect4">
<h5 id="user-area"><a class="anchor" href="#user-area"></a>==  User Area</h5>
<div class="paragraph">
<p>Group of dialogs with the proposal of giving some functionalities to the user, as login, register, change password or connect with Twitter.</p>
</div>
</div>
<div class="sect4">
<h5 id="login-dialog"><a class="anchor" href="#login-dialog"></a>== Login-dialog</h5>
<div class="paragraph">
<p>Dialog with a tab to navigate between login and register.</p>
</div>
</div>
<div class="sect4">
<h5 id="password-dialog"><a class="anchor" href="#password-dialog"></a>== Password-dialog</h5>
<div class="paragraph">
<p>Functionality reserved to already logged users, in this dialog the user can change freely their password.</p>
</div>
</div>
<div class="sect4">
<h5 id="twitter-dialog"><a class="anchor" href="#twitter-dialog"></a>== Twitter-dialog</h5>
<div class="paragraph">
<p>Dialog designed specifically to connect your user account with Twitter.</p>
</div>
</div>
<div class="sect4">
<h5 id="waiter-cockpit-area"><a class="anchor" href="#waiter-cockpit-area"></a>Waiter cockpit area</h5>
<div class="paragraph">
<p>Restricted area to workers of the restaurant, here we can see all information about booked tables with the selected orders and the reservations with all the guests and their acceptance or decline of the event.</p>
</div>
</div>
<div class="sect4">
<h5 id="order-cockpit-component"><a class="anchor" href="#order-cockpit-component"></a>==  Order Cockpit Component</h5>
<div class="paragraph">
<p>Data table with all the booked tables and a filter to search them, to show more info about that table you can click on it and open a dialog.</p>
</div>
</div>
<div class="sect4">
<h5 id="order-dialog"><a class="anchor" href="#order-dialog"></a>== Order-dialog</h5>
<div class="paragraph">
<p>Complete display of data regarding the selected table and its orders.</p>
</div>
</div>
<div class="sect4">
<h5 id="reservation-cockpit-component"><a class="anchor" href="#reservation-cockpit-component"></a>==  Reservation Cockpit Component</h5>
<div class="paragraph">
<p>Data table with all the reservations and a filter to search them, to show more info about that table you can click on it and open a dialog.</p>
</div>
</div>
<div class="sect4">
<h5 id="reservation-dialog"><a class="anchor" href="#reservation-dialog"></a>== Reservation-dialog</h5>
<div class="paragraph">
<p>Complete display of data regarding the selected table and its guests.</p>
</div>
</div>
<div class="sect4">
<h5 id="email-management"><a class="anchor" href="#email-management"></a>Email Management</h5>
<div class="paragraph">
<p>As the application send emails to both guests and hosts, we choose an approach based on URL where the email contain a button with an URL to a service in the app and a token, front-end read that token and depending on the URL, will redirect to one service or another. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>`http://localhost:4200/booking/cancel/CB_20170605_8fb5bc4c84a1c5049da1f6beb1968afc`</code></pre>
</div>
</div>
<div class="paragraph">
<p>This URL will tell the app that is a cancellation of a booking with the token <code><em>CB_20170605_8fb5bc4c84a1c5049da1f6beb1968afc</em></code>. The app will process this information, send it to back-end with the correct headers, show the confirmation of the event and redirect to home page.</p>
</div>
<div class="paragraph">
<p>The main cases at the moment are:</p>
</div>
</div>
<div class="sect4">
<h5 id="accept-invite"><a class="anchor" href="#accept-invite"></a>==  Accept Invite</h5>
<div class="paragraph">
<p>A guest accept an invitation sent by a host. It will receive another email to decline if it change its mind later on.</p>
</div>
</div>
<div class="sect4">
<h5 id="reject-invite"><a class="anchor" href="#reject-invite"></a>==  Reject Invite</h5>
<div class="paragraph">
<p>A guest decline the invitation.</p>
</div>
</div>
<div class="sect4">
<h5 id="cancel-reservation"><a class="anchor" href="#cancel-reservation"></a>==  Cancel Reservation</h5>
<div class="paragraph">
<p>A host cancel the reservation, everybody that has accepted or not already answered will receive an email notifying this event is canceled. Also all the orders related to this reservations will be removed.</p>
</div>
</div>
<div class="sect4">
<h5 id="cancel-orders"><a class="anchor" href="#cancel-orders"></a>==  Cancel Orders</h5>
<div class="paragraph">
<p>When you have a reservation, you will be assigned to a token, with that token you can save your order in the restaurant. When sent, you will receive an email confirming the order and the possibility to remove it.</p>
</div>
</div>
<div class="sect4">
<h5 id="services-and-directives"><a class="anchor" href="#services-and-directives"></a>Services and directives</h5>
<div class="paragraph">
<p>Services are where all the main logic between components of that view should be. This includes calling a remote server, composing objects, calculate prices, etc.</p>
</div>
<div class="paragraph">
<p>Directives are a single functionality that are related to a component.</p>
</div>
<div class="paragraph">
<p>As it can be seen in the basic structure, every view that has a minimum of logic or need to call a server has its own service located in the shared folder.</p>
</div>
<div class="paragraph">
<p>Also, services and directives can be created to compose a reusable piece of code that will be reused in some parts of the code:</p>
</div>
</div>
<div class="sect4">
<h5 id="price-calculator-service"><a class="anchor" href="#price-calculator-service"></a>Price-calculator-service</h5>
<div class="paragraph">
<p>This service located in the shared folder of sidenav contains the basic logic to calculate the price of a single order (with all the possibilities) and to calculate the price of a full list of orders for a table. As this is used in the sidenav and in the waiter cockpit, it has been exported as a service to be imported where needed and easily testable.</p>
</div>
</div>
<div class="sect4">
<h5 id="authentication-7"><a class="anchor" href="#authentication-7"></a>Authentication</h5>
<div class="paragraph">
<p>Authentication services serves as a validator of roles and login and, at the same time, stores the basic data regarding security and authentication.</p>
</div>
<div class="paragraph">
<p>Main task of this services is to provide visibility at app level of the current user information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Check if the user is logged or not.</p>
</li>
<li>
<p>Check the permissions of the current user.</p>
</li>
<li>
<p>Store the username and the JWT token.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="snack-service"><a class="anchor" href="#snack-service"></a>Snack Service</h5>
<div class="paragraph">
<p>Service created to serve as a factory of Angular Material <code>Snackbars</code>, which are used commonly through the app. This service accepts some parameters to customize the <code>snackBar</code> and opens it with this parameters.</p>
</div>
</div>
<div class="sect4">
<h5 id="window-service"><a class="anchor" href="#window-service"></a>Window Service</h5>
<div class="paragraph">
<p>For responsiveness reasons, the dialogs have to accept a width parameter to adjust to screen width and this information is given by Window object, as it is a good practice to have it in an isolated service, which also calculates the width percentage to apply on the dialogs.</p>
</div>
</div>
<div class="sect4">
<h5 id="equal-validator-directive"><a class="anchor" href="#equal-validator-directive"></a>Equal-validator-directive</h5>
<div class="paragraph">
<p>This directive located in the shared folder of <code>userArea</code> is used in 2 fields to make sure they have the same value. This directive is used in confirm password fields in register and change password.</p>
</div>
</div>
<div class="sect4">
<h5 id="mock-back-end"><a class="anchor" href="#mock-back-end"></a>Mock Back-end</h5>
<div class="paragraph">
<p>To develop meanwhile a real back-end is being developed let us to make a more realistic application and to make easier the adaptation when the back-end is able to be connected and called. Its structure is as following:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/angular/back-end.png"><img src="_images/images/angular/back-end.png" alt="back end"></a>
</div>
</div>
<div class="paragraph">
<p>Contains the three main groups of functionalities in the application. Every group is composed by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An <strong>interface</strong> with all the methods to implement.</p>
</li>
<li>
<p>A <strong>service</strong> that implements that interface, the main task of this service is to choose between real back-end and mock back-end depending on an environment variable.</p>
</li>
<li>
<p><strong>Mock back-end service</strong> which implements all the methods declared in the interface using mock data stored in a local file and mainly uses Lodash to operate the arrays.</p>
</li>
<li>
<p><strong>Real back-end service</strong> works as Mock back-end but in this case the methods call for server rest services through Http.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="booking"><a class="anchor" href="#booking"></a>Booking</h5>
<div class="paragraph">
<p>The booking group of functionalities manages the calls to reserve a table with a given time and assistants or with guests, get reservations filtered, accept or decline invitations or cancel the reservation.</p>
</div>
</div>
<div class="sect4">
<h5 id="orders"><a class="anchor" href="#orders"></a>Orders</h5>
<div class="paragraph">
<p>Management of the orders, including saving, filtering and cancel an order.</p>
</div>
</div>
<div class="sect4">
<h5 id="dishes"><a class="anchor" href="#dishes"></a>Dishes</h5>
<div class="paragraph">
<p>The dishes group of functionalities manages the calls to get and filter dishes.</p>
</div>
</div>
<div class="sect4">
<h5 id="login"><a class="anchor" href="#login"></a>Login</h5>
<div class="paragraph">
<p>Login manages the <code>userArea</code> logic: login, register and change password.</p>
</div>
</div>
<div class="sect4">
<h5 id="security-9"><a class="anchor" href="#security-9"></a>Security</h5>
<div class="paragraph">
<p>My Thai Star security is composed by two main security services:</p>
</div>
</div>
<div class="sect4">
<h5 id="auth-guard"><a class="anchor" href="#auth-guard"></a>Auth-guard</h5>
<div class="paragraph">
<p>Front-end security approach, this service implements an interface called <code>CanActivate</code> that comes from angular/router module. <code>CanActivate</code> interface forces you to implement a <code>canActivate()</code> function which returns a Boolean.
This service checks with the Auth-Service stored data if the user is logged and if he has enough permission to access the waiter cockpit. This prevents that a forbidden user could access to waiter cockpit just by editing the URL in the browser.</p>
</div>
</div>
<div class="sect4">
<h5 id="jwt"><a class="anchor" href="#jwt"></a>JWT</h5>
<div class="paragraph">
<p>JSON Web Token consists of a token that is generated by the server when the user logs in. Once provided, the token has to be included in an Authentication header on every Http call to the rest service, otherwise the call will be forbidden.
JWT also has an expiration date and a role checking, so if a user has not enough permissions or keeps logged for a long certain amount of time that exceeds this expiration date, the next time he calls for a service call, the server will return an error and forbid the call. You can log again to restore the token.</p>
</div>
</div>
<div class="sect4">
<h5 id="httpclient"><a class="anchor" href="#httpclient"></a>==  HttpClient</h5>
<div class="paragraph">
<p>To implement this Authorization header management, an HttpClient service has been implemented.
This services works as an envelope of Http, providing some more functionalities, likes a header management and an automatically management of a server token error in case the JWT has expired, corrupted or not permitted.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="xamarin-design"><a class="anchor" href="#xamarin-design"></a>Xamarin design</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="security-10"><a class="anchor" href="#security-10"></a>33. Security</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="two-factor-authentication"><a class="anchor" href="#two-factor-authentication"></a>33.1. Two-Factor Authentication</h4>
<div class="paragraph">
<p>Two-factor Authentication (2FA) provides an additional level of security to your account. Once enabled, in addition to supplying your username and password to login, you’ll be prompted for a code generated by your Google Authenticator. For example, a password manager on one of your devices.</p>
</div>
<div class="paragraph">
<p>By enabling 2FA, to log into your account an additional one-time password is required what requires access to your paired device. This massively increases the barrier for an attacker to break into your account.</p>
</div>
</div>
<div class="sect3">
<h4 id="back-end-mechanism"><a class="anchor" href="#back-end-mechanism"></a>33.2. Back-end mechanism</h4>
<div class="paragraph">
<p>In the back-end, we utilize Spring Security for any authentication.</p>
</div>
<div class="paragraph">
<p>Following the arrows, one can see all processes regarding authentication. The main idea is to check all credentials depending on their 2FA status and then either grand access to the specific user or deny access. This picture illustrates a normal authentication with username and password.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/security/security_cross_component.png" alt="security cross component">
</div>
</div>
<div class="paragraph">
<p>When dealing with 2FA, another provider and filter is handling the request from <strong>/verify</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/security/security_cross_component_twofactor.png" alt="security cross component twofactor">
</div>
</div>
<div class="paragraph">
<p>Here you can observe which filter will be used.
<strong>JWT-Authentication-Filter</strong> does intercept any request, which enforces being authenticated via JWT</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/security/filters_png.png" alt="filters png">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Whenever the secret or qr code gets transferred between two parties, one must enforce <a href="https://tools.ietf.org/html/rfc5246">SSL/TLS</a> or <a href="https://tools.ietf.org/html/rfc4301">IPsec</a> to be comply with <a href="https://tools.ietf.org/html/rfc6238#page-5">RFC 6238</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="activating-two-factor-authentication"><a class="anchor" href="#activating-two-factor-authentication"></a>33.3. Activating Two-Factor Authentication</h4>
<div class="paragraph">
<p>In the current state, <a href="https://en.wikipedia.org/wiki/Time-based_One-time_Password_algorithm">TOTP</a>
will be used for OTP generation. For this purpose we recommend the <strong>Google Authenticator</strong> or any TOTP generator out there.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Login with your account</p>
</li>
<li>
<p>Open the 2FA settings</p>
</li>
<li>
<p>Activate the 2FA Status</p>
</li>
<li>
<p>Initialize your device with either a <strong>QR-Code</strong> or a <strong>secret</strong></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="frontend"><a class="anchor" href="#frontend"></a>33.4. Frontend</h4>
<div class="paragraph">
<p>These are the two main options, which you can obtain my toggling between <strong>QR-Code</strong> and <strong>secret</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/security/2FA_qr_code_menu.png" alt="2FA qr code menu">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/security/2FA_secret_menu.png" alt="2FA secret menu">
</div>
</div>
<div class="paragraph">
<p>After an activation and logout. This prompt will ask you to enter the OTP given from your device.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/security/otp_prompt.png" alt="otp prompt">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing-2"><a class="anchor" href="#testing-2"></a>34. Testing</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="server-side-2"><a class="anchor" href="#server-side-2"></a>35. Server Side</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect4">
<h5 id="java-testing"><a class="anchor" href="#java-testing"></a>Java testing</h5>

</div>
<div class="sect4">
<h5 id="component-testing"><a class="anchor" href="#component-testing"></a>Component testing</h5>
<div class="paragraph">
<p>We are going to test our components as a unit using <em>Spring Test</em> and <em>Devon4j-test</em> modules.</p>
</div>
<div class="paragraph">
<p>In order to test a basic component of the app first we will create a test class in the <code>src/test/java</code> folder and inside the main package of the test module. We will name the class following the convention.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[Component]Test</pre>
</div>
</div>
<div class="paragraph">
<p>Then, in the declaration of the test class, we will use the <code>@SpringBootTest</code> annotation to run the application context. In addition, we will extend the <code>ComponentTest</code> from <code>Devon4j-test</code> module to have access to the main functionalities of the module, <a href="https://github.com/devonfw/devon4j/wiki/guide-testing">see more details here</a>.</p>
</div>
<div class="paragraph">
<p><em>Spring Test</em> allows us to use <em>Dependency Injection</em> so we can inject our component directly using the <code>@Inject</code> annotation.</p>
</div>
<div class="paragraph">
<p>Each test will be represented by a method annotated with <code>@Test</code>. Inside the method we will test one functionality, evaluating the result thanks to the <em>asserts</em> provided by the <code><em>ComponentTest</em></code> class that we are extending.</p>
</div>
<div class="paragraph">
<p>A simple test example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@SpringBootTest(classes = SpringBootApp.class)
public class DishmanagementTest extends `ComponentTest` {

  @Inject
  private Dishmanagement dishmanagement;

  @Test
  public void findAllDishes() {

    PaginatedListTo&lt;DishCto&gt; result = this.dishmanagement.findDishes();
    assertThat(result).isNotNull();
  }

  ...
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="running-the-tests"><a class="anchor" href="#running-the-tests"></a>Running the tests</h5>

</div>
<div class="sect4">
<h5 id="from-eclipse-2"><a class="anchor" href="#from-eclipse-2"></a>From Eclipse</h5>
<div class="paragraph">
<p>We can run the test from within <em>Eclipse</em> with the contextual menu <em>Run As &gt; JUnit Test</em>. This functionality can be launched from method level, class level or even package level. The results will be shown in the <em>JUnit</em> tab.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/java/test_results_eclipse.PNG"><img src="_images/images/java/test_results_eclipse.PNG" alt="test results eclipse"></a>
</div>
</div>
</div>
<div class="sect4">
<h5 id="from-command-line-using-maven"><a class="anchor" href="#from-command-line-using-maven"></a>From command line using Maven</h5>
<div class="paragraph">
<p>We can also run tests using <em>Maven</em> and the command line, using the command <code><em>mvn test</em></code> (or <code><em>mvn clean test</em></code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>`C:\MyThaiStar&gt;mvn clean test`</pre>
</div>
</div>
<div class="paragraph">
<p>Doing this we will run all the tests of the project (recognized by the <em>Test</em> word at the end of the classes) and the results will be shown by sub-project.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>...

[D: 2017-07-17 09:30:08,457] [P: INFO ] [C: ] [T: Thread-5] [L: org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean] - [M: Closing JPA EntityManagerFactory for persistence unit 'default']

Results :

Tests run: 11, Failures: 0, Errors: 0, Skipped: 1

...

[INFO]
[INFO] --- maven-compiler-plugin:3.1:testCompile (default-testCompile) @ mtsj-server ---
[INFO] No sources to compile
[INFO]
[INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ mtsj-server ---
[INFO] No tests to run.
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary:
[INFO]
[INFO] mtsj ............................................... SUCCESS [  0.902 s]
[INFO] mtsj-core .......................................... SUCCESS [02:30 min]
[INFO] mtsj-server ........................................ SUCCESS [  1.123 s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 02:35 min
[INFO] Finished at: 20XX-07-17T09:30:13+02:00
[INFO] Final Memory: 39M/193M
[INFO] ------------------------------------------------------------------------</pre>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="net-testing"><a class="anchor" href="#net-testing"></a>.NET testing</h5>
<div class="paragraph">
<p>TODO</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="nodejs-testing"><a class="anchor" href="#nodejs-testing"></a>NodeJS testing</h5>
<div class="paragraph">
<p>TODO</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="graphql-testing"><a class="anchor" href="#graphql-testing"></a>GraphQL testing</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="client-side-2"><a class="anchor" href="#client-side-2"></a>36. Client Side</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect4">
<h5 id="angular-testing"><a class="anchor" href="#angular-testing"></a>Angular testing</h5>
<div class="imageblock">
<div class="content">
<a class="image" href="images/angular/testing.JPG"><img src="_images/images/angular/testing.JPG" alt="testing"></a>
</div>
</div>
<div class="paragraph">
<p><code>MyThaiStar</code> testing is made using Angular default testing environment and syntax language: <a href="https://karma-runner.github.io/1.0/index.html"><strong>Karma</strong></a> and <a href="https://jasmine.github.io/"><strong>Jasmine</strong></a></p>
</div>
<div class="paragraph">
<p>To test an element of the application, you indicate that tests are a special type of files with the extension <strong>.spec.ts</strong>, then, in MyThaiStar angular/CLI config you can notice that there is an array with only one entry, Karma, with at the same time has one entry to <code>Karma.config.js</code>.</p>
</div>
<div class="paragraph">
<p>In the configuration of Karma we indicate which syntax language we are going to use (currently Jasmine as said before) between some other configurations, it is remarkable the last one: <em>browsers</em>. By default, the only available browser is chrome, that is because Karma works opening a chrome view to run all the tests, in that same window, Karma shows the result or errors of the test run. But we can add some other browser to adjust to our necessities, for example, in some automatic processes that run from console, it is not an option to open a chrome window, in that case, <code>MyThaiStar</code> used PhantomJS and ChromeHeadless.</p>
</div>
<div class="paragraph">
<p>Taking all of this into account, to run the test in <code>MyThaiStar</code> we need to move to project root folder and run this command : <code>ng test --browser &lt;browser&gt;</code></p>
</div>
</div>
<div class="sect4">
<h5 id="-18"><a class="anchor" href="#-18"></a>==</h5>
<div class="paragraph">
<p>If you run just <code>ng test</code> it will run the three browser options <strong>simultaneously</strong>, giving as a result three test runs and outputs, it can cause timeouts and unwanted behaviors, if you want a shortcut to run the test with chrome window you can just run <code>yarn test</code> so we really encourage to <strong>not use</strong> just <code>ng test</code>.
== ==</p>
</div>
<div class="paragraph">
<p>Here we are going to see how Client side testing of <code>MyThaiStar</code> has been done.</p>
</div>
</div>
<div class="sect4">
<h5 id="testing-components"><a class="anchor" href="#testing-components"></a>Testing Components</h5>
<div class="paragraph">
<p>Angular components were created using angular/CLI <code>ng create component</code> so they already come with an spec file to test them. The only thing left to do is to add the providers and imports needed in the component to work as the component itself, once this is done, the most basic test is to be sure that all the dependencies and the component itself can be correctly created.</p>
</div>
<div class="paragraph">
<p>As an example, this is the <em>spec.ts</em> of the menu view component:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">all the imports...

describe('MenuComponent', () =&gt; {
  let component: MenuComponent;
  let fixture: ComponentFixture&lt;MenuComponent&gt;;

  beforeEach(async(() =&gt; {
    TestBed.configureTestingModule({
      declarations: [ MenuComponent, MenuCardComponent ],
      providers: [SidenavService, MenuService, SnackBarService],
      imports: [
        BrowserAnimationsModule,
        BackendModule.forRoot({environmentType: 0, restServiceRoot: 'v1'}),
        CovalentModule,
      ],
    })
    .compileComponents();
  }));

  beforeEach(() =&gt; {
    fixture = TestBed.createComponent(MenuComponent);
    component = fixture.componentInstance;
    fixture.detectChanges();
  });

  it('should create', () =&gt; {
    expect(component).toBeTruthy();
  });
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>First we declare the component to be tested and a Fixture object, then, we configure the <code>testingModule</code> right in the same way we could configure the MenuModule with the difference here that tests always have to use the mock back-end because we do not want to really depend on a server to test our components.</p>
</div>
<div class="paragraph">
<p>Once configured the test module, we have to prepare the context of the test, in this case we create the component, that is exactly what is going on in the <code>beforeEach()</code> function.</p>
</div>
<div class="paragraph">
<p>Finally, we are ready to use the component and it&#8217;s fixture to check if the component has bee correctly created.</p>
</div>
<div class="paragraph">
<p>At this moment this is the case for most of the components, in the future, some work would be applied on this matter to have a full testing experience in <code>MyThaiStar</code> components.</p>
</div>
</div>
<div class="sect4">
<h5 id="dialog-components"><a class="anchor" href="#dialog-components"></a>Dialog components</h5>
<div class="paragraph">
<p>Dialog components are in a special category because they can not be tested normally. In the way Material implements the opening of dialogs, you have to create a component that will load into a dialog, to tell the module to load this components when needed, they have to be added into a special array category: <code><em>EntryComponents</em></code>. So, to test them, we need to import them in the test file as well.</p>
</div>
<div class="paragraph">
<p>Also, the testing code to open the component is a bit different too:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">...
  beforeEach(() =&gt; {
    dialog = TestBed.get(MdDialog);
    component = dialog.open(CommentDialogComponent).componentInstance;
  });
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>That is right, the <code>beforeEach()</code> function is slightly different from the the example above, in this case we have to force to the test to know that the component is only displayed in a dialog, so we have to open a dialog with this component in order to access it.</p>
</div>
</div>
<div class="sect4">
<h5 id="testing-services-2"><a class="anchor" href="#testing-services-2"></a>Testing Services</h5>
<div class="paragraph">
<p>As well as components, services can be tested too, actually, they are even more necessary to be tested because they have inside more complex logic and data management.</p>
</div>
<div class="paragraph">
<p>As an example of testing services i am going to use a well done services, with a specific purpose and with its logic completely tested, the price-calculator service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-JavaScript hljs" data-lang="JavaScript">...

describe('PriceCalculatorService', () =&gt; {

  beforeEach(() =&gt; {
    TestBed.configureTestingModule({
      providers: [PriceCalculatorService],
    });
  });

  it('should be properly injected', inject([PriceCalculatorService], (service: PriceCalculatorService) =&gt; {
    expect(service).toBeTruthy();
  }));

  describe('check getPrice method', () =&gt; {

    it('should calculate price for single order without extras', inject([PriceCalculatorService], (service: PriceCalculatorService) =&gt; {
      const order: OrderView = {
        dish: {
          id: 0,
          price: 12.50,
          name: 'Order without extras',
        },
        orderLine: {
          comment: '',
          amount: 1,
        },
        extras: [],
      };

      expect(service.getPrice(order)).toEqual(order.dish.price);
    }));
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>In services test, we have to inject the service in order to use it, then we can define some initializing contexts to test if the functions of the services returns the expected values, in the example we can see how an imaginary order is created and expected the function <code>getPrice()</code> to correctly calculate the price of that order.</p>
</div>
<div class="paragraph">
<p>In this same test file you can find some more test regarding all the possibilities of use in that services: orders with and without extras, single order, multiple orders and so on.</p>
</div>
<div class="paragraph">
<p>Some services as well as the components have only tested that they are correctly created and they dependencies properly injected, in the future, will be full covering regarding this services test coverage.</p>
</div>
</div>
<div class="sect4">
<h5 id="testing-in-a-ci-environment"><a class="anchor" href="#testing-in-a-ci-environment"></a>Testing in a CI environment</h5>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="xamarin-testing"><a class="anchor" href="#xamarin-testing"></a>Xamarin testing</h5>
<div class="paragraph">
<p>TODO</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="end-to-end"><a class="anchor" href="#end-to-end"></a>37. End to end</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect4">
<h5 id="mrchecker-e2e-testing"><a class="anchor" href="#mrchecker-e2e-testing"></a>MrChecker E2E Testing</h5>

</div>
<div class="sect4">
<h5 id="introduction-15"><a class="anchor" href="#introduction-15"></a>Introduction</h5>
<div class="paragraph">
<p>MrChecker is a testing framework included in devonfw with several useful modules, from which we will focus on the Selenium Module, a module designed to make end-to-end testing easier to implement.</p>
</div>
</div>
<div class="sect4">
<h5 id="how-to-use-it"><a class="anchor" href="#how-to-use-it"></a>How to use it</h5>
<div class="paragraph">
<p>First of all download the repository.</p>
</div>
<div class="paragraph">
<p>You must run My Thai Star front-end and back-end application and modify your URL to the front in <code>mrchecker/endtoend-test/src/resources/settings.properties</code></p>
</div>
<div class="paragraph">
<p>Now you can run end to end test to <strong>check</strong> if the application works properly.</p>
</div>
<div class="paragraph">
<p>To run the e2e test you have two options:</p>
</div>
<div class="paragraph">
<p><strong>The first option is using the command line in devonfw distribution</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>cd mrchecker/endtoend-test/
mvn test -Dtest=MyThaiStarTest -Dbrowser=Chrome</code></pre>
</div>
</div>
<div class="paragraph">
<p>optionally you can use it with a headless version or using another navigator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>// chrome headless (without visual component)
mvn test -Dtest=MyThaiStarTest -Dbrowser=ChromeHeadless// use firefox navigator
mvn test -Dtest=MyThaiStarTest -Dbrowser=FireFox</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>The second is importing the project in devonfw Eclipse and running <code><em>MyThaiStarTest.java</em></code> as JUnit (right click, run as JUnit)</strong></p>
</div>
<div class="paragraph">
<p>They can be executed one by one or all in one go, comment or uncomment <em>@Test</em> before those tests to enable or disable them.</p>
</div>
<div class="paragraph">
<p>For more information about how to use MrChecker and build your own end to end test read:
 * MrChecker documentation
 * MrChecker tutorial for My Thai Star</p>
</div>
</div>
<div class="sect4">
<h5 id="end-to-end-tests-in-my-thai-star"><a class="anchor" href="#end-to-end-tests-in-my-thai-star"></a>End to end tests in My Thai Star</h5>
<div class="paragraph">
<p>We have included a test suite with four tests to run in My Thai Star to verify everything works properly.</p>
</div>
<div class="paragraph">
<p>The included tests do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>Test_loginAndLogOut</em></code>: Log in and log out.</p>
</li>
<li>
<p><code><em>Test_loginFake</em></code>: Attempt to log in with a fake user.</p>
</li>
<li>
<p><code><em>Test_bookTable</em></code>: Log in and book a table, then login with a waiter and check if the table was successfully booked.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>*` <em>Test_orderMenu</em>`: Log in and order food for a certain booked table.</p>
</div>
<div class="paragraph">
<p>These four tests can be found inside <strong><code>MyThaiStarTest.java</code></strong> located <a href="https://github.com/devonfw/my-thai-star/tree/develop/mrchecker/endtoend-test/src/test/java/com/devonfw/mts/tests">here</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ui-design"><a class="anchor" href="#ui-design"></a>38. UI design</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="style-guide"><a class="anchor" href="#style-guide"></a>38.1. Style guide</h4>
<div class="imageblock">
<div class="content">
<a class="image" href="images/mts_styleguide.png"><img src="_images/images/mts_styleguide.png" alt="mts styleguide"></a>
</div>
</div>
</div>
<div class="sect3">
<h4 id="low-and-high-fidelity-wireframes"><a class="anchor" href="#low-and-high-fidelity-wireframes"></a>38.2. Low and high fidelity wireframes</h4>
<div class="paragraph">
<p>History of Mockup designs for My Thai Star.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="resources/MTS_Wireframes_Low_Fidelity.pdf">MTS Wireframes Low Fidelity</a></p>
</li>
<li>
<p><a href="resources/MTS_Wireframes_High_Fidelity_(Sprint_1).pdf">MTS Wireframes High Fidelity (Sprint 1)</a></p>
</li>
<li>
<p><a href="resources/MTS_Wireframes_High_Fidelity_(Sprint_1)-Copy.pdf">MTS Wireframes High Fidelity (Sprint 1) - Copy</a></p>
</li>
<li>
<p><a href="resources/MTS_Wireframes_High_Fidelity_(Sprint_1)-Mobile.pdf">MTS Wireframes High Fidelity (Sprint 1) - Mobile</a></p>
</li>
<li>
<p><a href="resources/MTS_Wireframes_High_Fidelity_(Sprint_2).pdf">MTS Wireframes High Fidelity (Sprint 2)</a></p>
</li>
<li>
<p><a href="resources/MTS_Wireframes_High_Fidelity_(Sprint_2)-Modifications.pdf">MTS Wireframes High Fidelity (Sprint 2) - Modifications</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cicd-2"><a class="anchor" href="#cicd-2"></a>39. CI/CD</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect3">
<h4 id="my-thai-star-in-production-line"><a class="anchor" href="#my-thai-star-in-production-line"></a>39.1. My Thai Star in Production Line</h4>

</div>
<div class="sect3">
<h4 id="what-is-pl"><a class="anchor" href="#what-is-pl"></a>39.2. What is PL?</h4>
<div class="paragraph">
<p>The Production Line Project is a set of server-side collaboration tools for Capgemini engagements. It has been developed for supporting project engagements with individual tools like issue tracking, continuous integration, continuous deployment, documentation, binary storage and much more!</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ci/pl_logo.png"><img src="_images/images/ci/pl_logo.png" alt="pl logo"></a>
</div>
</div>
</div>
<div class="sect3">
<h4 id="introduction-16"><a class="anchor" href="#introduction-16"></a>39.3. Introduction</h4>
<div class="paragraph">
<p>Although the PL Project is a wide set of tools, only 3 are going to be mainly used for My Thai Star projects to build a Continuous Integration and Continuos Delivery environment. All three are available in the <a href="https://devon.s2-eu.capgemini.com/#https://devon.s2-eu.capgemini.com/jenkins/">PL instance</a> used for this project.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Jenkins</p>
<div class="paragraph">
<p>This is going to be the "main tool". Jenkins helps to automate the non-human part of the development with Continuos Integration and is going to host all Pipelines (and, obviously, execute them).</p>
</div>
</li>
<li>
<p>Nexus</p>
<div class="paragraph">
<p>Nexus manages software "artifacts" required for development. It is possible to both download dependencies from Nexus and publish artifacts as well. It allows to share resources within an organization.</p>
</div>
</li>
<li>
<p>SonarQube</p>
<div class="paragraph">
<p>It is a platform for continuous inspection of the code. It is going to be used for the Java back-end.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="where-can-i-find-all-my-thai-star-pipelines"><a class="anchor" href="#where-can-i-find-all-my-thai-star-pipelines"></a>39.4. Where can I find all My Thai Star Pipelines?</h4>
<div class="paragraph">
<p>They are located under the <strong>MTS</strong> folder of the PL instance:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/jenkins/mts-pipelines.png"><img src="_images/images/jenkins/mts-pipelines.png" alt="mts pipelines"></a>
</div>
</div>
<div class="paragraph">
<p>Those Jenkins Pipelines will not have any code to execute. They&#8217;re just pointing to all <strong>Jenkinsfiles</strong> under the <code>/jenkins</code> folder of the repository. They can be found <a href="https://github.com/devonfw/my-thai-star/tree/develop/jenkins">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="ci-in-my-thai-star-stack"><a class="anchor" href="#ci-in-my-thai-star-stack"></a>39.5. CI in My Thai Star stack</h4>
<div class="ulist">
<ul>
<li>
<p><a href="angular-ci">Angular CI</a></p>
</li>
<li>
<p><a href="java-ci">Java CI</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="how-to-configure-everything-out-of-the-box"><a class="anchor" href="#how-to-configure-everything-out-of-the-box"></a>39.6. How to configure everything out of the box</h4>
<div class="paragraph">
<p>Production Line currently has a template to integrate My Thai Star. All information can be found at <a href="https://github.com/devonfw/production-line">devonfw production line repository</a></p>
</div>
<!-- toc disabled -->
<div class="sect4">
<h5 id="angular-ci"><a class="anchor" href="#angular-ci"></a>Angular CI</h5>
<div class="paragraph">
<p>The Angular client-side of My Thai Star is going to have some specific needs for the CI-CD Pipeline to perform mandatory operations.</p>
</div>
</div>
<div class="sect4">
<h5 id="pipeline"><a class="anchor" href="#pipeline"></a>Pipeline</h5>
<div class="paragraph">
<p>The Pipeline for the Angular client-side is going to be called <strong>MyThaiStar_FRONT-END_BUILD</strong>. It is located in the PL instance, under the <a href="https://devon.s2-eu.capgemini.com/jenkins/job/MTS/">MTS folder</a> (as previously explained). It is going to follow a process flow like this one:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="angular_pipeline_flow.PNG"><img src="_images/images/ci/angular/angular_pipeline_flow.PNG" alt="angular pipeline flow"></a>
</div>
</div>
<div class="paragraph">
<p>Each of those steps are called <em>stages</em> in the Jenkins context.Let&#8217;s see what those steps mean in the context of the Angular application:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Declarative: Checkout SCM</strong></p>
<div class="paragraph">
<p>Retrieves the project from the GitHub repository which it&#8217;s located. This step is not defined directly in our pipeline, but as it is loaded from the repository this step should always be done at the beginning.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="pipeline_config.PNG"><img src="_images/images/ci/angular/pipeline-config.png" alt="pipeline config"></a>
</div>
</div>
</li>
<li>
<p><strong>Declarative: Tool Install</strong></p>
<div class="paragraph">
<p>The Pipeline needs some Tools to perform some operations with the Angular project. These tool is a correct version of <strong>NodeJS</strong> (10.17.0 LTS) with <strong>Yarn</strong> installed as global package.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tools {
    nodejs "NodeJS 10.14.0"
}</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Loading Custom Tools</strong></p>
<div class="paragraph">
<p>The Pipeline also needs a browser in order to execute the tests, so in this step the chrome-stable will be loaded. We will use it in a headless mode.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tool chrome</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Fresh Dependency Installation</strong></p>
<div class="paragraph">
<p>The script <code>$ yarn</code> does a package installation. As we always clean the workspace after the pipeline, all packages must be installed in every execution.</p>
</div>
</li>
<li>
<p><strong>Code Linting</strong></p>
<div class="paragraph">
<p>This script executes a linting process of TypeScript. Rules can be defined in the <code>tslint.json</code> file of the project. It throws an exception whenever a file contains a non-compliant piece of code.</p>
</div>
</li>
<li>
<p><strong>Execute Angular tests</strong></p>
<div class="paragraph">
<p>The CI testing of the Angular client is different than the standard local testing (adapted to CI environments, as specified in the <strong>Adaptation</strong> section of document). This script just executes the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">ng test --browsers ChromeHeadless --watch=false</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Check dependencies</strong></p>
<div class="paragraph">
<p>Before continue, we print the result of <code>yarn audit</code>. It shows the vulnerabilities in the dependencies. It do not process the response. The purpose is only to track the result of the command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">yarn audit</code></pre>
</div>
</div>
</li>
<li>
<p><strong>SonarQube code analysis</strong></p>
<div class="paragraph">
<p>The script load and execute the tool <code>sonar-scanner</code>. This tool is loaded here because it&#8217;s not used in any other part of the pipeline. The <code>sonar-scanner</code> will take all code, upload it to SonarQube and wait until SonarQube send us a response with the quality of our code. If the code do not pass the quality gate, the pipeline will stop at this point.</p>
</div>
</li>
<li>
<p><strong>Build Application</strong></p>
<div class="paragraph">
<p>The building process of the Angular client would result in a folder called <code>/dist</code> in the main Angular&#8217;s directory. That folder is the one that is going to be served afterwards as an artifact. This process has also been adapted to some Deployment needs. This building script executes the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">ng build --configuration=docker</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Deliver application into Nexus</strong></p>
<div class="paragraph">
<p>Once the scripts produce the Angular artifact (<code>/dist</code> folder), it&#8217;s time to package it and store into nexus.</p>
</div>
</li>
<li>
<p>Declarative: Post Actions</p>
<div class="paragraph">
<p>At the end, this step is always executed, even if a previous stage fail. We use this step to clean up the workspace for future executions</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">post {
    always {
        cleanWs()
    }
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="adjustments"><a class="anchor" href="#adjustments"></a>Adjustments</h5>
<div class="paragraph">
<p>The Angular project Pipeline needed some "extra" features to complete all planned processes. Those features resulted in some additions to the project.</p>
</div>
</div>
<div class="sect4">
<h5 id="pipeline-environment"><a class="anchor" href="#pipeline-environment"></a>Pipeline Environment</h5>
<div class="paragraph">
<p>In order to easily reuse the pipeline in other angular projects, all variables have been defined in the block environment. All variables have the default values that Production Line uses, so if you&#8217;re going to work in production line you won&#8217;t have to change anything. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>environment {
    // Script for build the application. Defined at package.json
    buildScript = 'build --configuration=docker'
    // Script for lint the application. Defined at package.json
    lintScript = 'lint'
    // Script for test the application. Defined at package.json
    testScript = 'test:ci'
    // Angular directory
    angularDir = 'angular'
    // SRC folder. It will be angularDir/srcDir
    srcDir = 'src'
    // Name of the custom tool for chrome stable
    chrome = 'Chrome-stable'

    // SonarQube
    // Name of the SonarQube tool
    sonarTool = 'SonarQube'
    // Name of the SonarQube environment
    sonarEnv = "SonarQube"

    // Nexus
    // Artifact groupId
    groupId = 'com.devonfw.mythaistar'
    // Nexus repository ID
    repositoryId= 'pl-nexus'
    // Nexus internal URL
    repositoryUrl = 'http://nexus3-core:8081/nexus3/repository/maven-snapshots'
    // Maven global settings configuration ID
    globalSettingsId = 'MavenSettings'
    // Maven tool id
    mavenInstallation = 'Maven3'
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="description-16"><a class="anchor" href="#description-16"></a>==  Description</h5>
<div class="ulist">
<ul>
<li>
<p><strong>build Script</strong>: script for build the application. It must be defined at package.json.</p>
<div class="paragraph">
<p>Example (package.json):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>{
    "name": "mythaistar-restaurant",
    ...
    "scripts": {
        ...
        "build": "ng build",
        ...
    }
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will be used as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">sh """yarn ${buildScript}"""</code></pre>
</div>
</div>
</li>
<li>
<p><strong>lint Script</strong>: Script for lint the application. Defined at package.json</p>
<div class="paragraph">
<p>Example (package.json):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "name": "mythaistar-restaurant",
    ...
    "scripts": {
        ...
        "lint": "ng lint",
        ...
    }
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will be used as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>sh """yarn ${lintScript}"""</code></pre>
</div>
</div>
</li>
<li>
<p><strong>test Script</strong>: Script for test the application. Defined at package.json</p>
<div class="paragraph">
<p>Example (package.json):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "name": "mythaistar-restaurant",
    ...
    "scripts": {
        ...
        "test:ci": "npm run postinstall:web &amp;&amp; ng test --browsers ChromeHeadless --watch=false",
        ...
    }
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will be used as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>sh """yarn ${testScript}"""</code></pre>
</div>
</div>
</li>
<li>
<p><strong>angular-Dir</strong>: Relative route to angular application. In My Thai Star this is the angular folder. The actual directory (.) is also allowed.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="angular_directory.PNG"><img src="_images/images/ci/angular/angular_directory.png" alt="angular directory"></a>
</div>
</div>
</li>
<li>
<p><strong><code>srcDir</code></strong>: Directory where you store the source code. For angular applications the default value is <code>src</code></p>
<div class="imageblock">
<div class="content">
<a class="image" href="src_directory.PNG"><img src="_images/images/ci/angular/src_directory.png" alt="src directory"></a>
</div>
</div>
</li>
<li>
<p><strong>chrome</strong>: Since you need a browser to run your tests, we must provide one. This variable contains the name of the custom tool for google chrome.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="chrome_installation.PNG"><img src="_images/images/ci/angular/chrome_installation.png" alt="chrome installation"></a>
</div>
</div>
</li>
<li>
<p><strong>sonar-Tool</strong>: Name of the SonarQube scanner installation.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="sonar-scanner.PNG"><img src="_images/images/ci/angular/sonar-scanner.png" alt="sonar scanner"></a>
</div>
</div>
</li>
<li>
<p><strong>sonar-Env</strong>: Name of the SonarQube environment. SonarQube is the default value for PL.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="sonar-env.PNG"><img src="_images/images/ci/angular/sonar-env.png" alt="sonar env"></a>
</div>
</div>
</li>
<li>
<p><strong>group-Id</strong>: Group id of the application. It will be used to storage the application in nexus3</p>
<div class="imageblock">
<div class="content">
<a class="image" href="nexus3_groupid.PNG"><img src="_images/images/ci/angular/nexus3_groupid.png" alt="nexus3 groupid"></a>
</div>
</div>
</li>
<li>
<p><strong>repository-Id</strong>: Id of the nexus3 repository. It must be defined at maven global config file.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="nexus3_id.PNG"><img src="_images/images/ci/angular/nexus3_id.png" alt="nexus3 id"></a>
</div>
</div>
</li>
<li>
<p><strong>repository URL</strong>: The URL of the repository.</p>
</li>
<li>
<p><strong>global Settings Id</strong>: The id of the global settings file.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="nexus3_global_config.PNG"><img src="_images/images/ci/angular/nexus3_global_config.png" alt="nexus3 global config"></a>
</div>
</div>
</li>
<li>
<p>maven Installation: The name of the maven tool.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="maven_tool.PNG"><img src="_images/images/ci/angular/maven_tool.png" alt="maven tool"></a>
</div>
</div>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="java-ci"><a class="anchor" href="#java-ci"></a>Java CI</h5>
<div class="paragraph">
<p>The Java server-side of My Thai Star is an <strong>devon4j</strong>-based application. As long as <strong>Maven</strong> and a <strong>Java 8</strong> are going to be needed, the Pipeline should have those tools available as well.</p>
</div>
</div>
<div class="sect4">
<h5 id="pipeline-2"><a class="anchor" href="#pipeline-2"></a>Pipeline</h5>
<div class="paragraph">
<p>This Pipeline is called <strong>MyThaiStar_SERVER_BUILD</strong>, and it is located exactly in the same PL instance&#8217;s folder than <code><strong>MyThaiStar_FRONTEND_BUILD</strong></code>. Let&#8217;s see how the Pipeline&#8217;s flow behaves.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="java_pipeline_flow.PNG"><img src="_images/images/ci/java/java_pipeline_flow.PNG" alt="java pipeline flow"></a>
</div>
</div>
<div class="paragraph">
<p>Check those Pipeline stages with more detail:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Declarative: Checkout SCM</strong></p>
<div class="paragraph">
<p>Gets the code from <a href="https://github.com/devonfw/my-thai-star" class="bare">https://github.com/devonfw/my-thai-star</a> . This step is not defined directly in our pipeline, but as it is loaded from the repository this step should always be done at the beginning.</p>
</div>
</li>
<li>
<p><strong>Declarative: Tool Install</strong></p>
<div class="paragraph">
<p>The My Thai Star application works with JDK11. In this step, if JDK11 is not installed, we install it and then put the JDK folder into PATH.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tools {
  jdk 'OpenJDK11'
}</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Loading Custom Tools</strong></p>
<div class="paragraph">
<p>In this step we load the tools that can not be loaded in the previous step. As My Thai Star is delivered as docker container, in this step we load docker as custom tool.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">tool dockerTool</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Install dependencies</strong></p>
<div class="paragraph">
<p>This step will download all project dependencies.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">mvn clean install -Dmaven.test.skip=true</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Unit Tests</strong></p>
<div class="paragraph">
<p>This step will execute the project unit test with maven.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">mvn clean test</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Dependency Checker</strong></p>
<div class="paragraph">
<p>Execute the OWASP Dependency Checker in order to validate the project dependencies. It will generate a report that can be used in SonarQube</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">dependencyCheck additionalArguments: '--project "MTSJ" --scan java/mtsj --format XML', odcInstallation: 'dependency-check'
dependencyCheckPublisher pattern: ''</code></pre>
</div>
</div>
</li>
<li>
<p><strong>SonarQube analysis</strong></p>
<div class="paragraph">
<p>The code is evaluated using the integrated PL instance&#8217;s SonarQube. Also, it will wait for the quality gate status. If the status is failing, the pipeline execution will be stopped.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">withSonarQubeEnv(sonarEnv) {
    sh "mvn sonar:sonar"
}

def qg = waitForQualityGate()
if (qg.status != 'OK') {
    error "Pipeline aborted due to quality gate failure: ${qg.status}"
}</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Deliver application into Nexus</strong></p>
<div class="paragraph">
<p>Store all artifacts into nexus.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">mvn deploy -Dmaven.test.skip=true</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Create the Docker image</strong></p>
<div class="paragraph">
<p>Create the docker image and then publish the image into a docker registry.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="adjustments-2"><a class="anchor" href="#adjustments-2"></a>Adjustments</h5>

</div>
<div class="sect4">
<h5 id="pipeline-environment-2"><a class="anchor" href="#pipeline-environment-2"></a>Pipeline Environment</h5>
<div class="paragraph">
<p>In order to easily reuse the pipeline in other java projects, all variables have been defined in the block environment. All variables have the default values that Production Line uses, so if you&#8217;re going to work in production line you won&#8217;t have to change anything. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">environment {
    // Directory with java project
    javaDir = 'java/mtsj'

    // SonarQube
    // Name of the SonarQube environment
    sonarEnv = "SonarQube"

    // Nexus 3
    // Maven global settings configuration ID
    `globalSettingsId = 'MavenSettings'`
    // Maven tool id
    `mavenInstallation = 'Maven3'`

    // Docker
    dockerRegistryCredentials = 'nexus-api'
    dockerRegistryProtocol = 'https://\'
    dockerTool = 'docker-global
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="description-17"><a class="anchor" href="#description-17"></a>==  Description</h5>
<div class="ulist">
<ul>
<li>
<p><strong>java Dir</strong>: Relative route to java application. In My Thai Star this is the <code>java/mtsj</code> folder. The actual directory (.) is also allowed.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="java_directory.png"><img src="_images/images/ci/java/java_directory.png" alt="java directory"></a>
</div>
</div>
</li>
<li>
<p><strong>sonar Env</strong>: Name of the SonarQube environment. SonarQube is the default value for PL.</p>
</li>
<li>
<p><strong>global Settings Id</strong>: The id of the global settings file. <code>MavenSettings</code> is the default value for PL.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="nexus3_global_config.PNG"><img src="_images/images/ci/angular/nexus3_global_config.png" alt="nexus3 global config"></a>
</div>
</div>
</li>
<li>
<p><strong>maven Installation</strong>: The name of the maven tool. Maven3 is the default value for PL.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="maven_tool.PNG"><img src="_images/images/ci/angular/maven_tool.png" alt="maven tool"></a>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="distribution-management"><a class="anchor" href="#distribution-management"></a>Distribution management</h5>
<div class="paragraph">
<p>The only <em>extra</em> thing that needs to be added to the Java server-side is some information that determines where the artifact of the project is going to be stored in <strong>Nexus</strong>. This is going to be a section in the main <code>pom.xml</code> file called <code>&lt;distributionManagement&gt;</code>. This section will point to the PL instance&#8217;s Nexus. Let&#8217;s have a look at it. It&#8217;s already configured with the PL default values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;distributionManagement&gt;
    &lt;repository&gt;
      &lt;id&gt;pl-nexus&lt;/id&gt;
      &lt;name&gt;PL Releases&lt;/name&gt;
      &lt;url&gt;http://nexus3-core:8081/nexus/content/repositories/maven-releases/&lt;/url&gt;
    &lt;/repository&gt;
    &lt;snapshotRepository&gt;
      &lt;id&gt;pl-nexus&lt;/id&gt;
      &lt;name&gt;PL Snapshots&lt;/name&gt;
      &lt;url&gt;http://nexus3-core:8081/nexus3/repository/maven-snapshots&lt;/url&gt;
    &lt;/snapshotRepository&gt;
&lt;/distributionManagement&gt;</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect3">
<h4 id="deployment-4"><a class="anchor" href="#deployment-4"></a>39.7. Deployment</h4>
<div class="paragraph">
<p>The main deployment tool used for <strong>My Thai Star</strong> is be <strong>Docker</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://www.docker.com/"><img src="_images/images/ci/deployment/docker.png" alt="docker"></a>
</div>
</div>
<div class="paragraph">
<p>It is a tool to run application in isolated environments. Those <em>isolated environments</em> will be what we call <strong>Docker containers</strong>. For instance, it won&#8217;t be necessary any installation of <strong>Nginx</strong> or <strong>Apache tomcat</strong> or anything necessary to deploy, because there will be some containers that actually <em>have</em> those technologies inside.</p>
</div>
</div>
<div class="sect3">
<h4 id="where-docker-containers-will-be-running"><a class="anchor" href="#where-docker-containers-will-be-running"></a>39.8. Where Docker containers will be running?</h4>
<div class="paragraph">
<p>Of course, it is necessary to have an external Deployment Server. Every Docker process will run in it. It will be accessed from Production Line pipelines via <strong>SSH</strong>. Thus, the pipeline itself will manage the scenario of, if every previous process like testing passes as OK, stop actual containers and create new ones.</p>
</div>
<div class="paragraph">
<p>This external server will be located in <a href="https://mts-devonfw-core.cloud.okteto.net/" class="bare">https://mts-devonfw-core.cloud.okteto.net/</a></p>
</div>
</div>
<div class="sect3">
<h4 id="container-schema"><a class="anchor" href="#container-schema"></a>39.9. Container Schema</h4>
<div class="paragraph">
<p>3 Docker containers are being used for the deployment of My Thai Star:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Nginx</strong> for the Reverse Proxy</p>
</li>
<li>
<p><strong>tomcat</strong> for the Java Server</p>
</li>
<li>
<p><strong>Nginx</strong> for the Angular Client</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The usage of the <strong>Reverse Proxy</strong> will allow the client to call via <code>/api</code> every single Java Server&#8217;s REST operation. Moreover, there will only be 1 port in usage in the remote Docker host, the one mapped for the Reverse Proxy: <code>8080</code>.
Besides the deployment itself using <strong>Nginx</strong> and <strong>tomcat</strong>, both client and server are previously built using <strong>NodeJS</strong> and <strong>maven</strong> images. Artifacts produced by them will be pasted in servers' containers using multi-stage docker builds. It will all follow this schema:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="https://user-images.githubusercontent.com/20857839/36028242-8998f41c-0d9e-11e8-93b3-6bfe50152bf8.png"><img src="https://user-images.githubusercontent.com/20857839/36028242-8998f41c-0d9e-11e8-93b3-6bfe50152bf8.png" alt="36028242 8998f41c 0d9e 11e8 93b3 6bfe50152bf8"></a>
</div>
</div>
<div class="paragraph">
<p>This orchestration of all 3 containers will be done by using a <code>docker-compose.yml</code> file. To redirect traffic from one container to another (i.e. reverse-proxy to angular client or angular client to java server) will be done by using, as host names, the service name <code>docker-compose</code> defines for each of them, followed by the internally exposed port:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="http://reverse-proxy:80" class="bare">http://reverse-proxy:80</a></code></p>
</li>
<li>
<p><code><a href="http://angular:80" class="bare">http://angular:80</a></code></p>
</li>
<li>
<p><code><a href="http://java:8080" class="bare">http://java:8080</a></code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A implementation using <a href="traefik-reverse-proxy">Traefik as reverse proxy</a> instead of NGINX is also available.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="run-my-thai-star"><a class="anchor" href="#run-my-thai-star"></a>39.10. Run My Thai Star</h4>
<div class="paragraph">
<p>The steps to run <strong>My Thai Star</strong> are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the repository <code>$ git clone <a href="https://github.com/devonfw/my-thai-star.git" class="bare">https://github.com/devonfw/my-thai-star.git</a></code></p>
</li>
<li>
<p>Run the docker compose command: <code>$ docker-compose up</code></p>
</li>
</ol>
</div>
<!-- toc disabled -->
<div class="sect4">
<h5 id="deployment-pipelines"><a class="anchor" href="#deployment-pipelines"></a>Deployment Pipelines</h5>
<div class="paragraph">
<p>As PL does not support deployments, we have created separate pipelines for this purpose. Those pipelines are: <strong>MyThaiStar_REVERSE-PROXY_DEPLOY</strong>, <strong>MyThaiStar_FRONT-END_DEPLOY</strong> and <strong>MyThaiStar_SERVER_DEPLOY</strong>.</p>
</div>
<div class="paragraph">
<p>The application will be deployed using docker on a remote machine. The architecture is as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ci/deployment/deployment_arch.png"><img src="_images/images/ci/deployment/deployment_arch.png" alt="deployment arch"></a>
</div>
</div>
<div class="paragraph">
<p>The parts to be deployed are: an NGINX reverse proxy, the java application and the angular application.</p>
</div>
</div>
<div class="sect4">
<h5 id="mythaistar_server_deploy-pipeline"><a class="anchor" href="#mythaistar_server_deploy-pipeline"></a><code>MyThaiStar_SERVER_DEPLOY Pipeline</code></h5>
<div class="paragraph">
<p>Deploys on the server the Java part of My Thai Star.</p>
</div>
</div>
<div class="sect4">
<h5 id="parameters"><a class="anchor" href="#parameters"></a>Parameters</h5>
<div class="ulist">
<ul>
<li>
<p><code><strong>registryUrl</strong></code>: The URL to the docker registry where the image is stored.</p>
</li>
<li>
<p><code><strong>registryCredentialsId</strong></code>: Credentials to publish/download images from registry.</p>
</li>
<li>
<p><code><strong>dockerNetwork</strong></code>: Network of your My Thai Star application. You can deploy several versions of MTS in the same server by changing the <code>dockerNetwork</code>.</p>
</li>
<li>
<p><strong>VERSION</strong>: The version that you can to deploy.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="pipeline-steps"><a class="anchor" href="#pipeline-steps"></a>Pipeline steps</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Create docker network</strong>: Create the docker network with the name provided as parameter.</p>
</li>
<li>
<p><strong>Deploy new image</strong>: Deploy a new java container. If it already exists, first it delete the previous one.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="mythaistar_front-end_deploy"><a class="anchor" href="#mythaistar_front-end_deploy"></a>MyThaiStar_FRONT-END_DEPLOY</h5>
<div class="paragraph">
<p>Deploys on the server the Angular part of My Thai Star</p>
</div>
</div>
<div class="sect4">
<h5 id="parameters-2"><a class="anchor" href="#parameters-2"></a>Parameters</h5>
<div class="ulist">
<ul>
<li>
<p><code><strong>registryUrl</strong></code>: The URL to the docker registry where the image is stored.</p>
</li>
<li>
<p><code><strong>registryCredentialsId</strong></code>: Credentials to publish/download images from registry.</p>
</li>
<li>
<p><code><strong>dockerNetwork</strong></code>: Network of your My Thai Star application. You can deploy several versions of MTS in the same server by changing the <code>dockerNetwork</code>.</p>
</li>
<li>
<p><strong>VERSION</strong>: The version that you can to deploy.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="pipeline-steps-2"><a class="anchor" href="#pipeline-steps-2"></a>Pipeline steps</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Create docker network</strong>: Create the docker network with the name provided as parameter.</p>
</li>
<li>
<p><strong>Deploy new image</strong>: Deploy a new angular container. If it already exists, first it delete the previous one.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="mythaistar_reverse-proxy_deploy-pipeline"><a class="anchor" href="#mythaistar_reverse-proxy_deploy-pipeline"></a><code>MyThaiStar_REVERSE-PROXY_DEPLOY Pipeline</code></h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As reverse proxy connects to the Java and Angular application, both must be deployed before you execute this pipeline.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>MyThaiStar_REVERSE-PROXY_DEPLOY</code> pipeline will deploy the My Thai Star reverse proxy into a remote machine using docker.</p>
</div>
</div>
<div class="sect4">
<h5 id="parameters-3"><a class="anchor" href="#parameters-3"></a>Parameters</h5>
<div class="ulist">
<ul>
<li>
<p><code><strong>registryUrl</strong></code>: The URL to the docker registry where the image is stored.</p>
</li>
<li>
<p><code><strong>registryCredentialsId</strong></code>: Credentials to publish/download images from registry.</p>
</li>
<li>
<p><code><strong>buildReverseProxy</strong></code>: If yes, it will build and publish a new version of reverse-proxy.</p>
</li>
<li>
<p><strong>port</strong>: Port of the MTS application. You must ensure that those port is available in the deployment machine.</p>
</li>
<li>
<p><strong>docker Network</strong>: Network of your My Thai Star application. You can deploy several versions of MTS in the same server by changing the port and the docker Network.</p>
</li>
<li>
<p><strong>VERSION</strong>: The version that you can to deploy.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="pipeline-steps-3"><a class="anchor" href="#pipeline-steps-3"></a>Pipeline steps</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Create docker network</strong>: Create the docker network with the name provided as parameter.</p>
</li>
<li>
<p><strong>Create the Docker image</strong>: If build-Reverse-Proxy is enabled, this step will create a new docker image and publish it to the docker registry.</p>
</li>
<li>
<p><strong>Deploy new image</strong>: Deploy a new reverse proxy container. If it already exists, first it delete the previous one.</p>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="deployment-strategies"><a class="anchor" href="#deployment-strategies"></a>Deployment Strategies</h5>
<div class="paragraph">
<p>In this chapter different way of deploying My Thai Star are explained. Everything will be based in Docker.</p>
</div>
</div>
<div class="sect4">
<h5 id="independent-docker-containers"><a class="anchor" href="#independent-docker-containers"></a>Independent Docker containers</h5>
<div class="paragraph">
<p>The first way of deployment will use isolated Docker containers. That means that if the client-side container is deployed, it does not affect the server-side container&#8217;s life cycle and vice versa.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s show how the containers will behave during their life cycle.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>0) Copy everything you need into the Deployment Server directory</p>
</li>
<li>
<p>1) Remove existing container (Nginx or Tomcat)</p>
<div class="imageblock">
<div class="content">
<a class="image" href="container1.png"><img src="_images/images/ci/angular/container1.png" alt="container1"></a>
</div>
</div>
</li>
<li>
<p>2) Run new one from the Docker images collection of the external Deployment Server.</p>
<div class="imageblock">
<div class="content">
<a class="image" href="container2.png"><img src="_images/images/ci/angular/container2.png" alt="container2"></a>
</div>
</div>
</li>
<li>
<p>3) Add the artifact <code>/dist</code> to the "deployable" folder of the Docker container (<code>/usr/share/nginx/html/</code>)</p>
<div class="imageblock">
<div class="content">
<a class="image" href="container3.png"><img src="_images/images/ci/angular/container3.png" alt="container3"></a>
</div>
</div>
<div class="paragraph">
<p>Now, let&#8217;s see how it&#8217;s being executed in the command line (simplified due to documentation purposes). The next block of code represents what is inside of the last stage of the Pipeline.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">sshagent (credentials: ['my_ssh_token']) {
    sh """
        // Copy artifact from workspace to deployment server

        // Manage container:
        docker rm -f [mts-container]
        docker run -itd --name=[mts-container] [base_image]
        docker exec [mts-container] bash -C \\"rm [container_deployment_folder]/*\\"
        docker cp [artifact] [mts-container]:[container_deployment_folder]
    """
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For every operation performed in the external Deployment Server, it is necessary to define <em>where</em> those commands are going to be executed. So, for each one of previous <code>docker</code> commands, this should appear before:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>`ssh -o StrictHostKeyChecking=no root@10.40.235.244`</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="docker-compose"><a class="anchor" href="#docker-compose"></a>Docker Compose</h5>
<div class="paragraph">
<p>The second way of deployment will be by orchestrating both elements of the application: The Angular client-side and the Java server-side. Both elements will be running in Docker containers as well, but in this case they won&#8217;t be independent anymore. <strong>Docker Compose</strong> will be in charge of keeping both containers up, or to put them down.</p>
</div>
</div>
<div class="sect4">
<h5 id="project-adjustment"><a class="anchor" href="#project-adjustment"></a>Project adjustment</h5>
<div class="paragraph">
<p>In order to perform this second way of deployment, some files will be created in the project. The first one is the <strong>Dockerfile</strong> for the Angular client-side. This file will pull (if necessary) an <strong>Nginx</strong> Docker image and copy the Angular artifact (<code>/dist</code> folder) inside of the deployment folder of the image. It will be located in the main directory of the Angular client-side project.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="dockerfile-angular.PNG"><img src="_images/images/ci/deployment/dockerfile-angular.PNG" alt="dockerfile angular"></a>
</div>
</div>
<div class="paragraph">
<p>The second file is the <strong>Dockerfile</strong> for the Java server-side. Its function will be quite similar to the Angular one. It will run a <strong>tomcat</strong> Docker image and copy the Java artifact (<code>mythaistar.war</code> file) in its deployment folder.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="dockerfile-java.PNG"><img src="_images/images/ci/deployment/dockerfile-java.PNG" alt="dockerfile java"></a>
</div>
</div>
<div class="paragraph">
<p>Finally, as long as the <strong>docker-compose</strong> is being used, a file containing its configuration will be necessary as well. A new folder one the main My That Star&#8217;s directory is created, and it&#8217;s called <code>/docker</code>. Inside there is just a <code>docker-compose.yml</code> file. It contains all the information needed to orchestrate the deployment process. For example, which port both containers are going to be published on, and so on. This way of deployment will allow the application to be published or not just with one action.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>docker-compose rm -f            # down
docker-compose up --build -d    # up fresh containers</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="docker-compose.PNG"><img src="_images/images/ci/deployment/docker-compose.PNG" alt="docker compose"></a>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s have a look at the file itself:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">version: '3'
services:
  client_compose:
    build: "angular"
    ports:
      - "8091:80"
    depends_on:
      - server_compose
  server_compose:
    build: "java"
    ports:
      - "9091:8080"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This Orchestrated Deployment will offer some interesting possibilities for <a href="future-deployment">the future of the application</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="future-deployment"><a class="anchor" href="#future-deployment"></a>Future Deployment</h5>
<div class="paragraph">
<p>The <strong>My Thai Star</strong> project is going to be built in many technologies. Thus, let&#8217;s think about one deployment schema that allow the Angular client to communicate to all three back ends: <strong>Java</strong>, <strong>Node</strong> and <strong>.NET</strong>.</p>
</div>
<div class="paragraph">
<p>As long as <strong>Docker containers</strong> are being used, it shouldn&#8217;t be that hard to deal with this "distributed" deployment. The schema represents 6 Docker containers that will have client-side(s) and server-side(s). Each of 3 Angular client containers (those in red) are going to communicate with different back-ends. So, when the deployment is finished, it would be possible to use all three server-sides just by changing the "port" in the URL.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see how it would look like:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/ci/future/deployment_schema.PNG"><img src="_images/images/ci/future/deployment_schema.PNG" alt="deployment schema"></a>
</div>
</div>
<!-- toc disabled -->
</div>
<div class="sect4">
<h5 id="reverse-proxy-strategy-using-traefik"><a class="anchor" href="#reverse-proxy-strategy-using-traefik"></a>Reverse proxy strategy using Traefik</h5>
<div class="paragraph">
<p>This implementation is the same as described at <a href="deployment.adoc">My Thai Star deployment wiki page</a>. The only thing that changes is that Traefik is used instead of NGINX.</p>
</div>
<div class="paragraph">
<p>Using Traefik as reverse proxy, we can define the routes using labels in the docker containers instead of using a <code>nginx.conf</code> file. With this, it is not necessary to modify the reverse proxy container for each application. In addition, as Traefik is listening to the docker daemon, it can detect new containers and create routes for them without rebooting.</p>
</div>
<div class="paragraph">
<p>Example of labels:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">labels:
    - "traefik.http.routers.angular.rule=PathPrefix(`/`)"
    - "traefik.http.services.angular.loadBalancer.healthcheck.path=/health"
    - "traefik.http.services.angular.loadBalancer.healthcheck.interval=10s"
    - "traefik.http.services.angular.loadBalancer.healthcheck.scheme=http"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="how-to-use-it-2"><a class="anchor" href="#how-to-use-it-2"></a>How to use it</h5>
<div class="paragraph">
<p>If you want to build the images from code, change to My Thai Star root folder and execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ docker-compose -f docker-compose.traefik.yml up -d --build</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to build the images from artifacts, change to Traefik folder <code>(reverse-proxy/traefik)</code> and execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ docker-compose up -d --build</code></pre>
</div>
</div>
<div class="paragraph">
<p>After a seconds, when the healthcheck detects that containers are running, your application will be available at <a href="http://localhost:8090" class="bare">http://localhost:8090</a>. Also, the Traefik dashboard is available at <a href="http://localhost:8080" class="bare">http://localhost:8080</a>.</p>
</div>
<div class="paragraph">
<p>If you want to check the behavior of the application when you scale up the back-end, you can execute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ docker-compose scale java=5</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this, the access to the java back-end will be using the load balancing method: Weighted Round Robin.</p>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect3">
<h4 id="mythaistar-on-native-kubernetes-as-a-service-nkaas"><a class="anchor" href="#mythaistar-on-native-kubernetes-as-a-service-nkaas"></a>39.11. <code>MyThaiStar</code> on Native Kubernetes as a Service (nKaaS)</h4>
<div class="paragraph">
<p>The <code>MyThaiStar</code> sample application can be deployed on a nKaaS environment. The required Kubernetes configuration files can be found in the <code>MyThaiStar</code> repository. There are no additional changes required in order to deploy the application.</p>
</div>
</div>
<div class="sect3">
<h4 id="setting-up-the-environment-2"><a class="anchor" href="#setting-up-the-environment-2"></a>39.12. Setting up the environment</h4>

</div>
<div class="sect3">
<h4 id="following-the-nkaas-guide"><a class="anchor" href="#following-the-nkaas-guide"></a>39.13. Following the nKaaS guide</h4>
<div class="paragraph">
<p>After requesting access to the nKaaS platform you&#8217;ll be greeted with a welcome mail which contains your personal credentials. Make sure to change the given password to a personal one within the 24 hour time period, otherwise the  credentials will expire.</p>
</div>
<div class="paragraph">
<p>After successfully following the <a href="https://portal.capgemini-ips.com/native-kubernetes/getting-started">guide</a> mentioned in the welcome mail you should be able to establish a connection to the nKaaS VPN and have access to all their services (Jenkins, BitBucket, etc.). You should also be able to communicate with Kubernetes using kubectl.</p>
</div>
<div class="paragraph">
<p><strong>Known issues:</strong> The nKaaS guide provides a download link for <strong>OpenVPN Connect</strong>. However, some users experienced connection issues with this client. If you&#8217;re having issues connecting to the VPN with OpenVPN Connect, you may try out the client by <a href="https://www.ovpn.com/en/guides/windows-openvpn-gui">OVPN</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="requesting-a-namespace"><a class="anchor" href="#requesting-a-namespace"></a>39.14. Requesting a namespace</h4>
<div class="paragraph">
<p>Initially, you won&#8217;t be able to edit anything on Kubernetes, as you don&#8217;t have any privileges on any namespace. To request your own namespace you should raise a ticket at the <a href="https://servicedesk.capgemini-ips.com/servicedesk/customer/portal/143">Customer Support Portal</a> containing your desired name for the namespace.</p>
</div>
<div class="paragraph">
<p>As soon as the namespace was created you can change your kubectl context:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>kubectl config set-context --current -namespace=YOUR-NAMESPACE</code></pre>
</div>
</div>
<div class="paragraph">
<p>On your own namespace you should have permissions to create/delete deployments/services etc. and perform other actions.</p>
</div>
</div>
<div class="sect3">
<h4 id="setting-up-harbor"><a class="anchor" href="#setting-up-harbor"></a>39.15. Setting up Harbor</h4>
<div class="paragraph">
<p>Jenkins will build the <code>MyThaiStar</code> Docker images and push them to the nKaaS <a href="http://harbor.demo.xpaas.io">Harbor registry</a>. The Jenkinsfile defaults to a Harbor project called "my-thai-star". If there&#8217;s no such project on Harbor, simply create a new one.</p>
</div>
</div>
<div class="sect3">
<h4 id="setting-up-jenkins"><a class="anchor" href="#setting-up-jenkins"></a>39.16. Setting up Jenkins</h4>
<div class="paragraph">
<p>As <code>MyThaiStar</code> includes all required Jenkinsfiles for nKaaS, almost no configurations have to be performed by the user.
Create a new Pipeline on <a href="http://jenkins.demo.xpaas.io">Jenkins</a> and configure its definition to be a "Pipeline script from SCM". The SCM used is "Git" and the repository URL is the <code>MyThaiStar</code> repository <a href="https://github.com/devonfw/my-thai-star.git" class="bare">https://github.com/devonfw/my-thai-star.git</a> or your fork of it.</p>
</div>
<div class="paragraph">
<p>The Branch Specifier should point to <code>*/develop</code>, the Script Path is <code>jenkins/nKaaS/Jenkinsfile</code> as that&#8217;s where the Jenkinsfile is located at the <code>MyThaiStar</code> repository.
Checking the "Lightweight checkout" could speed up the Pipeline.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> If you&#8217;re using the nKaaS <a href="http://bitbucket.demo.xpaas.io">Bitbucket</a> as repository for your <code>MyThaiStar</code> clone you have to perform some additional configurations. First you&#8217;ll have to create a new SSH keypair, for example with <code>ssh-keygen</code>. Add the public key to the Bitbucket authentication methods and the private key in Jenkins to a new pair of credentials. This step is required for Jenkins to be able to authenticate against Bitbucket.
Afterwards, instead of the official <code>MyThaiStar</code> repository, specify your Bitbucket repository:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>ssh://git@bitbucket.demo.xpaas.io:7999/YOUR-PROJECT/YOUR-MTS-REPO.git</code></pre>
</div>
</div>
<div class="paragraph">
<p>Under "Credentials" choose the credentials that contain your Bitbucket private key you&#8217;ve created earlier.</p>
</div>
</div>
<div class="sect3">
<h4 id="deploying-mts"><a class="anchor" href="#deploying-mts"></a>39.17. Deploying MTS</h4>
<div class="paragraph">
<p>After setting up the Jenkins Pipeline, you can simply run it by clicking on the "Build" button. This will trigger the pipeline, Jenkins will:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check out the MTS project</p>
</li>
<li>
<p>Build the docker images</p>
</li>
<li>
<p>Push the docker images to the Harbor registry</p>
</li>
<li>
<p>Deploy the MTS application onto Kubernetes</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Finally, the applications should be available at <a href="http://my-thai-star.demo.xpaas.io" class="bare">http://my-thai-star.demo.xpaas.io</a>.</p>
</div>
<div class="paragraph">
<p>The first part, <code>my-thai-star</code>, IST specified in the MTS <a href="https://github.com/devonfw/my-thai-star/blob/develop/jenkins/nKaaS/ingress.yaml">ingress</a> configuration at <code>host</code>. The second part, <code>demo.xpaas.io</code>, is the host of the nKaaS you&#8217;re working on.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributing-2"><a class="anchor" href="#contributing-2"></a>40. Contributing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/general/master-contributing.adoc - include::../devonfw-github/CONTRIBUTING.adoc[]</p>
</div>
<div class="paragraph">
<p>Unresolved include directive in modules/ROOT/pages/general/master-contributing.adoc - include::../devonfw-github/CODE_OF_CONDUCT.adoc[]</p>
</div>
<!-- toc disabled -->
<div class="sect2">
<h3 id="oss-compliance"><a class="anchor" href="#oss-compliance"></a>40.1. OSS Compliance</h3>
<div class="paragraph">
<p>This chapter helps you to gain transparency on OSS usage and reach OSS compliance in your project.</p>
</div>
</div>
<div class="sect2">
<h3 id="preface"><a class="anchor" href="#preface"></a>40.2. Preface</h3>
<div class="paragraph">
<p>devonfw, as most Java software, makes strong use of Open Source Software (OSS). It is using about 150 OSS products on the server only and on the client even more. Using a platform like devonfw to develop your own custom solution requires handling contained OSS correctly, i.e acting <em>OSS-compliant</em>.</p>
</div>
<div class="paragraph">
<p>Please read the Open Source policy of your company first, e.g. the <a href="https://talent.capgemini.com/media_library/Medias/Common_images/OSS_Policy__Final.pdf">Capgemini OSS Policy</a> which contains a short, comprehensive and well written explanation on relevant OSS-knowledge. Make sure you:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>understand the copyleft effect and its effect in commercial projects</p>
</li>
<li>
<p>understand the 3 license categories: "permissive", "weak copyleft" and "strong copyleft"</p>
</li>
<li>
<p>know prominent license types as e.g. "Apache-2.0" or GPL-3.0" and what copyleft-category they are in</p>
</li>
<li>
<p>are aware that some OSS offer dual/multi-licenses</p>
</li>
<li>
<p>Understand that OSS libraries often come with sub-dependencies of other OSS carrying licenses themselves</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To define sufficient OSS compliance measures, contact your IP officer or legal team as early as possible, especially if you develop software for clients.</p>
</div>
</div>
<div class="sect2">
<h3 id="obligations-when-using-oss"><a class="anchor" href="#obligations-when-using-oss"></a>40.3. Obligations when using OSS</h3>
<div class="paragraph">
<p>If you create a custom solution containing OSS, this in legal sense is a "derived" work. If you distribute your derived work to your business client or any other legal entity in binary packaged form, the license obligations of contained OSS get into effect. Ignoring these leads to a license infringement which can create high damage.</p>
</div>
<div class="paragraph">
<p>To carefully handle these obligations you must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>maintain an OSS inventory (to gain transparency on OSS usage and used licenses)</p>
</li>
<li>
<p>check license conformity depending on usage/distribution in a commercial scenario</p>
</li>
<li>
<p>check license compatibility between used OSS-licenses</p>
</li>
<li>
<p>fulfill obligations defined by the OSS-licenses</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Obligations need to be checked per license. Frequent obligations are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>deliver the license terms of all used versions of the OSS licenses</p>
</li>
<li>
<p>not to change any copyright statements or warranty exclusions contained in the used OSS components</p>
</li>
<li>
<p>deliver the source code of the OSS components (e.g. on a data carrier)</p>
</li>
<li>
<p>when modifying OSS, track any source code modification (including date and name of the employee/company)</p>
</li>
<li>
<p>display OSS license notice in a user frontend (if any)</p>
</li>
<li>
<p>other obligations depending on individual license</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="automate-oss-handling"><a class="anchor" href="#automate-oss-handling"></a>40.4. Automate OSS handling</h3>
<div class="paragraph">
<p>Carefully judging the OSS usage in your project is a MANUAL activity! However, collecting OSS information and fulfilling license obligations should be automated as much as possible. A prominent professional tool to automate OSS compliance is the commercial software "Black Duck". Unfortunately it is rather expensive - either purchased or used as SaaS.</p>
</div>
<div class="paragraph">
<p>The most recommended lightweight tooling is a combination of Maven plugins. We will mainly use the <a href="http://www.mojohaus.org/license-maven-plugin/">Mojo Maven License Plugin</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="configure-the-mojo-maven-license-plugin"><a class="anchor" href="#configure-the-mojo-maven-license-plugin"></a>40.5. Configure the Mojo Maven License Plugin</h3>
<div class="paragraph">
<p>You can use it from command line but this will limit the ability to sustainably configure it (shown later).
Therefore we add it permanently as a build-plugin to the project parent-pom like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;plugin&gt;
  &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
  &lt;artifactId&gt;license-maven-plugin&lt;/artifactId&gt;
  &lt;version&gt;1.14&lt;/version&gt;

  &lt;configuration&gt;
    &lt;outputDirectory&gt;${project.build.directory}/generated-resources&lt;/outputDirectory&gt;
    &lt;sortArtifactByName&gt;true&lt;/sortArtifactByName&gt;
    &lt;includeTransitiveDependencies&gt;true&lt;/includeTransitiveDependencies&gt;
    &lt;!-- the "missing file" declares licenses for dependencies that could not be detected automatically --&gt;
    &lt;useMissingFile&gt;true&lt;/useMissingFile&gt;
    &lt;!-- find the "missing files" in all child-projects at the following location --&gt;
    &lt;missingFile&gt;src/license/THIRD-PARTY.properties&lt;/missingFile&gt;
    &lt;!-- if the "missing files" are not yet existing in child-projects they will be created automatically --&gt;
    &lt;failOnMissing&gt;false&lt;/failOnMissing&gt;
    &lt;overrideFile&gt;src/license/override-THIRD-PARTY.properties&lt;/overrideFile&gt;
    &lt;!-- harmonize different ways of writing license names --&gt;
    &lt;licenseMerges&gt;
      &lt;licenseMerge&gt;Apache-2.0|Apache 2.0&lt;/licenseMerge&gt;
      &lt;licenseMerge&gt;Apache-2.0|Apache License, Version 2.0&lt;/licenseMerge&gt;
      &lt;licenseMerge&gt;Apache-2.0|Apache Software License, Version 2.0&lt;/licenseMerge&gt;
      &lt;licenseMerge&gt;Apache-2.0|The Apache Software License, Version 2.0&lt;/licenseMerge&gt;
    &lt;/licenseMerges&gt;
    &lt;encoding&gt;utf-8&lt;/encoding&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the config above there are several settings that help to permanently improve the result of an automated OSS scan. We explain these now.</p>
</div>
</div>
<div class="sect2">
<h3 id="declare-additional-licenses"><a class="anchor" href="#declare-additional-licenses"></a>40.6. Declare additional licenses</h3>
<div class="paragraph">
<p>Sometimes the licenses of used OSS cannot be resolved automatically. That is not the mistake of the maven-license-tool, but the mistake of the OSS author who didn&#8217;t make the respective license-information properly available.</p>
</div>
<div class="paragraph">
<p>Declare additional licenses in a "missing file" within <em>each</em> maven-subproject: /src/license/THIRD-PARTY.properties.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">##Generated by org.codehaus.mojo.license.AddThirdPartyMojo
#-------------------------------------------------------------------------------
##Already used licenses in project :
##- ASF 2.0
##- Apache 2
...
#-------------------------------------------------------------------------------
##Please fill the missing licenses for dependencies :
...
dom4j--dom4j--1.6.1=BSD 3-Clause
javax.servlet--jstl--1.2=CDDL
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>In case the use of "missing files" is activated, but the THIRD-PARTY.properties-file is not yet existing, the first run of an "aggregate-add-third-party" goal (see below) will fail. Luckily the license-plugin just helped us and created the properties-files automatically (in each maven-subproject) and prefilled it with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a list of all detected licenses within the maven project</p>
</li>
<li>
<p>all OSS libraries where a license could not be detected automatically.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You now need to fill in missing license information and rerun the plugin.</p>
</div>
</div>
<div class="sect2">
<h3 id="redefine-wrongly-detected-licenses"><a class="anchor" href="#redefine-wrongly-detected-licenses"></a>40.7. Redefine wrongly detected licenses</h3>
<div class="paragraph">
<p>In case automatically detected licenses proof to be wrong by closer investigation, this wrong detection can be overwritten. Add a configuration to declare alternative licenses within each maven-subproject: /src/license/override-THIRD-PARTY.properties</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">com.sun.mail--javax.mail--1.5.6=Common Development and Distribution License 1.1</code></pre>
</div>
</div>
<div class="paragraph">
<p>This can be also be useful for OSS that provides a multi-license to make a decision which license to actually choose .</p>
</div>
</div>
<div class="sect2">
<h3 id="merge-licenses"><a class="anchor" href="#merge-licenses"></a>40.8. Merge licenses</h3>
<div class="paragraph">
<p>You will see that many prominent licenses come in all sorts of notations, e.g. Apache-2.0 as: "Apache 2" or "ASL-2.0" or "The Apache License, Version 2.0". The Mojo Maven License Plugin allows to harmonize different forms of a license-naming like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;!-- harmonize different ways of writing license names --&gt;
    &lt;licenseMerges&gt;
      &lt;licenseMerge&gt;Apache-2.0|Apache 2.0&lt;/licenseMerge&gt;
      &lt;licenseMerge&gt;Apache-2.0|Apache License, Version 2.0&lt;/licenseMerge&gt;
      &lt;licenseMerge&gt;Apache-2.0|Apache Software License, Version 2.0&lt;/licenseMerge&gt;
      &lt;licenseMerge&gt;Apache-2.0|The Apache Software License, Version 2.0&lt;/licenseMerge&gt;
    &lt;/licenseMerges&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>License-names will be harmonized in the OSS report to one common term. We propose to harmonize to short-license-IDs defined by the <a href="https://spdx.org/">SPDX</a> standard.</p>
</div>
</div>
<div class="sect2">
<h3 id="retrieve-licenses-list"><a class="anchor" href="#retrieve-licenses-list"></a>40.9. Retrieve licenses list</h3>
<div class="paragraph">
<p>For a quick initial judgement of OSS license situation run the following maven command from command line:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ mvn license:license-list</code></pre>
</div>
</div>
<div class="paragraph">
<p>You receive the summary list of all used OSS licenses on the cmd-out.</p>
</div>
</div>
<div class="sect2">
<h3 id="create-an-oss-inventory"><a class="anchor" href="#create-an-oss-inventory"></a>40.10. Create an OSS inventory</h3>
<div class="paragraph">
<p>To create an OSS inventory means to report on the overall bill of material of used OSS and corresponding licenses.
Within the parent project, run the following maven goal from command line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ mvn license:aggregate-download-licenses -Dlicense.excludedScopes=test,provided</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running the aggregate-download-licenses goal creates two results.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>a license.xml that contains all used OSS dependencies (even sub-dependencies) with respective license information</p>
</li>
<li>
<p>puts all used OSS-license-texts as html files into folder target/generated resources</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Carefully validate and judge the outcome of the license list. It is recommended to copy the license.xml to the project documentation and hand it over to your client. You may also import it into a spreadsheet to get a better overview.</p>
</div>
</div>
<div class="sect2">
<h3 id="create-a-third-party-file"><a class="anchor" href="#create-a-third-party-file"></a>40.11. Create a THIRD PARTY file</h3>
<div class="paragraph">
<p>Within Java software it is a common practice to add a "THIRD-PARTY" text file to the distribution. Contained is a summary-list of all used OSS and respective licenses. This can also be achieved with the Mojo Maven License Plugin.</p>
</div>
<div class="paragraph">
<p>Within the parent project, run the following maven goal from command line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ mvn license:aggregate-add-third-party -Dlicense.excludedScopes=test,provided</code></pre>
</div>
</div>
<div class="paragraph">
<p>Find the THIRD-PARTY.txt in the folder: target\generated-resources. The goal aggregate-add-third-party also profits from configuration as outlined above.</p>
</div>
</div>
<div class="sect2">
<h3 id="download-and-package-oss-sourcecode"><a class="anchor" href="#download-and-package-oss-sourcecode"></a>40.12. Download and package OSS SourceCode</h3>
<div class="paragraph">
<p>Some OSS licenses require handing over the OSS source code which is packaged with your custom software to the client the solution is distributed to. It is a good practice to hand over the source code of <em>all</em> used OSS to your client. Collecting all source code can be accomplished by another Maven plugin: Apache Maven Dependency Plugin.</p>
</div>
<div class="paragraph">
<p>It downloads all OSS Source Jars into the folder: \target\sources across the parent and all child maven projects.</p>
</div>
<div class="paragraph">
<p>You configure the plugin like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;plugin&gt;
  &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
  &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;
  &lt;version&gt;3.0.2&lt;/version&gt;

  &lt;configuration&gt;
    &lt;classifier&gt;sources&lt;/classifier&gt;
    &lt;failOnMissingClassifierArtifact&gt;false&lt;/failOnMissingClassifierArtifact&gt;
    &lt;outputDirectory&gt;${project.build.directory}/sources&lt;/outputDirectory&gt;
  &lt;/configuration&gt;
  &lt;executions&gt;
    &lt;execution&gt;
      &lt;id&gt;src-dependencies&lt;/id&gt;
      &lt;phase&gt;package&lt;/phase&gt;
      &lt;goals&gt;
        &lt;!-- use unpack-dependencies instead if you want to explode the sources --&gt;
        &lt;goal&gt;copy-dependencies&lt;/goal&gt;
      &lt;/goals&gt;
    &lt;/execution&gt;
  &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You run the plugin from command line like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ mvn dependency:copy-dependencies -Dclassifier=sources</code></pre>
</div>
</div>
<div class="paragraph">
<p>The plugin provides another goal that also unzips the jars, which is not recommended, since contents get mixed up.</p>
</div>
<div class="paragraph">
<p>Deliver the OSS source jars to your client with the release of your custom solution. This has been done physically - e.g. on DVD.</p>
</div>
</div>
<div class="sect2">
<h3 id="handle-oss-within-ci-process"><a class="anchor" href="#handle-oss-within-ci-process"></a>40.13. Handle OSS within CI-process</h3>
<div class="paragraph">
<p>To automate OSS handling in the regular build-process (which is not recommended to start with) you may declare the following executions and goals in your maven-configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;plugin&gt;
  ...

  &lt;executions&gt;
    &lt;execution&gt;
      &lt;id&gt;aggregate-add-third-party&lt;/id&gt;
      &lt;phase&gt;generate-resources&lt;/phase&gt;
      &lt;goals&gt;
        &lt;goal&gt;aggregate-add-third-party&lt;/goal&gt;
      &lt;/goals&gt;
    &lt;/execution&gt;

    &lt;execution&gt;
      &lt;id&gt;aggregate-download-licenses&lt;/id&gt;
      &lt;phase&gt;generate-resources&lt;/phase&gt;
      &lt;goals&gt;
        &lt;goal&gt;aggregate-download-licenses&lt;/goal&gt;
      &lt;/goals&gt;
    &lt;/execution&gt;
  &lt;/executions&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the build may fail in case the OSS information was not complete. Check the build-output to understand and resolve the issue - like e.g. add missing license information in the "missing file".</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="release-notes-2"><a class="anchor" href="#release-notes-2"></a>41. Release Notes</h2>
<div class="sectionbody">
<!-- toc disabled -->
<div class="sect2">
<h3 id="devonfw-release-notes-2021-04"><a class="anchor" href="#devonfw-release-notes-2021-04"></a>41.1. devonfw Release notes 2021.04</h3>

</div>
<div class="sect2">
<h3 id="introduction-17"><a class="anchor" href="#introduction-17"></a>41.2. Introduction</h3>
<div class="paragraph">
<p>We are proud to announce the release of devonfw version 2021.04.</p>
</div>
<div class="paragraph">
<p>This release includes lots of addition of new features, updates and bug fixes but it is very important to highlight the following improvements:</p>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-ide-4"><a class="anchor" href="#devonfw-ide-4"></a>41.3. devonfw IDE</h3>
<div class="paragraph">
<p>The consolidated list of features for this devonfw IDE release is as it follows.</p>
</div>
</div>
<div class="sect2">
<h3 id="2021-04-001"><a class="anchor" href="#2021-04-001"></a>41.4. 2021.04.001</h3>
<div class="paragraph">
<p>Update with the following bugfixes and improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide/issues/537">#537</a>: Update eclipse to 2021-03</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/287">#287</a>: Command autocompletion</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/536">#536</a>: Improve handling of aborted downloads</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/542">#542</a>: Support placeholders in settings.xml template</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/557">#557</a>: minimize setup by reducing DEVON_IDE_TOOLS</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/550">#550</a>: update maven to 3.8.1</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/545">#545</a>: update devon4j to 2021.04.002 and add migration</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/575">#575</a>: jasypt support for password encryption and decryption</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/546">#546</a>: Problems with tm-terminal Eclipse plugin</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/553">#553</a>: VSCode user-data-dir shall be part of workspace config</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/513">#513</a>: Configurable generation of IDE start scripts</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The full list of changes for this release can be found in <a href="https://github.com/devonfw/ide/milestone/18?closed=1">milestone 2021.04.001</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4j-2"><a class="anchor" href="#devon4j-2"></a>41.5. devon4j</h3>
<div class="paragraph">
<p>The consolidated list of features for this devon4j release is as it follows.</p>
</div>
</div>
<div class="sect2">
<h3 id="2021-04-002"><a class="anchor" href="#2021-04-002"></a>41.6. 2021.04.002</h3>
<div class="paragraph">
<p>Bugfix release of with the following stories:
* <a href="https://github.com/devonfw/devon4j/issues/389">#389</a>: archetype build broken with ci-friendly-maven
* <a href="https://github.com/devonfw/devon4j/pull/391">#391</a>: jasypt documentation improvements
* <a href="https://github.com/devonfw/devon4j/pull/387">#387</a>: rebuild and updated diagram with drawio</p>
</div>
<div class="paragraph">
<p>Documentation is available at <a href="https://repo.maven.apache.org/maven2/com/devonfw/java/doc/devon4j-doc/2021.04.002/devon4j-doc-2021.04.002.pdf">devon4j guide 2021.04.002</a>.
The full list of changes for this release can be found in <a href="https://github.com/devonfw/devon4j/milestone/18?closed=1">milestone devon4j 2020.04.002</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="2021-04-001-2"><a class="anchor" href="#2021-04-001-2"></a>41.7. 2021.04.001</h3>
<div class="paragraph">
<p>New release of <code>devon4j</code> with fixes, updates and improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/370">#370</a>: Minor updates (spring-boot 2.4.4, jackson 2.12.2, CXF 3.4.3, etc.)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/366">#366</a>: BaseTest.isInitialSetup() broken</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/85">#85</a>: ci-friendly-maven also for archetype</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/373">#373</a>: CORS starter not part of devon4j release</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/164">#164</a>: Flattened pom for core project invalid</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/323">#323</a>: Add spring integration test to archetype</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/351">#351</a>: improved error handling of service client</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/71">#71</a>: improve documentation for strong password encryption</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/354">#354</a>: JMS senders should not be part of data access layer, but logical layer</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/337">#377</a>: updated T-Architecture</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/294">#294</a>: integrate sonarcloud analysis into devon4j CI pipeline</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Documentation is available at <a href="https://repo.maven.apache.org/maven2/com/devonfw/java/doc/devon4j-doc/2021.04.001/devon4j-doc-2021.04.001.pdf">devon4j guide 2021.04.001</a>.
The full list of changes for this release can be found in <a href="https://github.com/devonfw/devon4j/milestone/15?closed=1">milestone devon4j 2020.04.001</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4ng-2"><a class="anchor" href="#devon4ng-2"></a>41.8. devon4ng</h3>
<div class="paragraph">
<p>Updated template and samples to Angular 11.
Updated guide of devon4ng.</p>
</div>
</div>
<div class="sect2">
<h3 id="mrchecker"><a class="anchor" href="#mrchecker"></a>41.9. MrChecker</h3>
<div class="paragraph">
<p>MrChecker Test Framework is an end to end test automation framework written in Java. It is an automated testing framework for functional testing of web applications, API web services, Service Virtualization, Security, native mobile apps and, in the near future, databases. All modules have tangible examples of how to build resilient integration test cases based on delivered functions. Two new modules are added to MrChecker:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DB Module - we have created a module intended to make testing efforts on DBs easier. It is founded on JPA in conjunction with Hibernate and therefore supports both high level, object based access to DB entities via the IDao interface and low level, native SQL commands via the EntityManager class .</p>
</li>
<li>
<p>CLI Module - we have created a module intended to make testing command line applications like compilers or batches easier and faster. Huge success here is that, team using this solution was able to prepare a test suite, without app provided, basing only on documentation and using mocking technique.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="trainingstutorials"><a class="anchor" href="#trainingstutorials"></a>41.10. Trainings/tutorials</h3>
<div class="ulist">
<ul>
<li>
<p>Katakoda tutorials : <a href="https://katacoda.com/devonfw" class="bare">https://katacoda.com/devonfw</a></p>
</li>
<li>
<p>Youtube tutorials : <a href="https://www.youtube.com/channel/UCtb1p-24jus-QoXy49t9Xzg" class="bare">https://www.youtube.com/channel/UCtb1p-24jus-QoXy49t9Xzg</a></p>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="devonfw-release-notes-2020-12"><a class="anchor" href="#devonfw-release-notes-2020-12"></a>41.11. devonfw Release notes 2020.12</h3>

</div>
<div class="sect2">
<h3 id="introduction-18"><a class="anchor" href="#introduction-18"></a>41.12. Introduction</h3>
<div class="paragraph">
<p>We are proud to announce the release of devonfw version 2020.12.</p>
</div>
<div class="paragraph">
<p>This release includes lots of addition of new features, updates and bug fixes but it is very important to highlight the following improvements:</p>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-ide-5"><a class="anchor" href="#devonfw-ide-5"></a>41.13. devonfw IDE</h3>
<div class="paragraph">
<p>The consolidated list of features for this devonfw IDE release is as it follows.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-12-001"><a class="anchor" href="#2020-12-001"></a>41.14. 2020.12.001</h3>
<div class="paragraph">
<p>Update with the following bugfixes and improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide/pull/495">#495</a>: Documentation corrections</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/491">#491</a>: Consider lombok support</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/489">#489</a>: Update node to v12.19.0 and VS Code to 1.50.1</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/470">#470</a>: reverse merge of workspace settings not sorting properties anymore</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/483">#483</a>: Error during installation when npm is already installed</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/415">#415</a>: documentation to customize settings</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/479">#479</a>: Error for vscode plugin installation</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/471">#471</a>: Preconfigure Project Explorer with Hierarchical Project Presentation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The full list of changes for this release can be found in <a href="https://github.com/devonfw/ide/milestone/16?closed=1">milestone 2020.12.001</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-08-001"><a class="anchor" href="#2020-08-001"></a>41.15. 2020.08.001</h3>
<div class="paragraph">
<p>Update with the following bugfixes and improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide/pull/454">#454</a>: update to eclipse 2020.06</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/442">#442</a>: update nodejs and vscode</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/432">#432</a>: vsCode settings are not updated</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/446">#446</a>: intellij: doConfigureEclipse: command not found</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/440">#440</a>: Software update may lead to inconsistent state due to windows file locks</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/427">#427</a>: release: keep leading zeros</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/450">#450</a>: update settings</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/431">#431</a>: devon build command not working correct for yarn or npm</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/449">#449</a>: update to devon4j 2020.08.001</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The full list of changes for this release can be found in <a href="https://github.com/devonfw/ide/milestone/12?closed=1">milestone 2020.08.001</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-04-004"><a class="anchor" href="#2020-04-004"></a>41.16. 2020.04.004</h3>
<div class="paragraph">
<p>Minor update with the following bugfixes and improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide/issues/433">#433</a>: Windows: devon command line sets wrong environment variables (with tilde symbol)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/435">#435</a>: fix variable resolution on bash</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The full list of changes for this release can be found in <a href="https://github.com/devonfw/ide/milestone/14?closed=1">milestone 2020.04.004</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-04-003"><a class="anchor" href="#2020-04-003"></a>41.17. 2020.04.003</h3>
<div class="paragraph">
<p>Minor update with the following bugfixes and improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide/issues/395">#395</a>: variable from devon.properites unset if value is in double quotes</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/429">#429</a>: Added script to create a meta file in the users directory after setup</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The full list of changes for this release can be found in <a href="https://github.com/devonfw/ide/milestone/13?closed=1">milestone 2020.04.003</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-04-002"><a class="anchor" href="#2020-04-002"></a>41.18. 2020.04.002</h3>
<div class="paragraph">
<p>Minor update with the following bugfixes and improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide/issues/418">#418</a>: Make projects optional</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/421">#421</a>: update devon4j to 2020.04.002</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/413">#413</a>: Update Eclipse to 2020-03</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/424">#424</a>: Strange errors on windows if devon.properties contains mixed line endings</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/399">#399</a>: launching of Intellij fails with No such file or directory error.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/410">#410</a>: fix jsonmerge for boolean and null values</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The full list of changes for this release can be found in <a href="https://github.com/devonfw/ide/milestone/11?closed=1">milestone 2020.04.002</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4j-3"><a class="anchor" href="#devon4j-3"></a>41.19. devon4j</h3>
<div class="paragraph">
<p>The consolidated list of features for this devon4j release is as it follows.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-12-001-2"><a class="anchor" href="#2020-12-001-2"></a>41.20. 2020.12.001</h3>
<div class="paragraph">
<p>New release of <code>devon4j</code> with pluggable web security (CSRF starter) and <code>CompletableFuture</code> support for async REST service client as well as other improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/283">#283</a>: Support for CompletableFuture in async service client</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/307">#307</a>: Fix CSRF protection support</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/287">#287</a>: spring-boot update to 2.3.3</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/288">#288</a>: Update jackson to 2.11.2</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/293">#293</a>: Update owasp-dependency-check plugin version to 5.3.2</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/302">#302</a>: added guide for project/app structure</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/315">#315</a>: devon4j documentation correction</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/306">#306</a>: improve documentation to launch app</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Documentation is available at <a href="https://repo.maven.apache.org/maven2/com/devonfw/java/doc/devon4j-doc/2020.12.001/devon4j-doc-2020.12.001.pdf">devon4j guide 2020.12.001</a>.
The full list of changes for this release can be found in <a href="https://github.com/devonfw/devon4j/milestone/14?closed=1">milestone devon4j 2020.12.001</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-08-001-2"><a class="anchor" href="#2020-08-001-2"></a>41.21. 2020.08.001</h3>
<div class="paragraph">
<p>New release of <code>devon4j</code> with async REST service client support and other improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/279">#279</a>: support for async service clients</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/277">#277</a>: Update Security-Guide to recent OWASP Top (2017)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/281">#281</a>: cleanup documentation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Documentation is available at <a href="https://repo.maven.apache.org/maven2/com/devonfw/java/doc/devon4j-doc/2020.08.001/devon4j-doc-2020.08.001.pdf">devon4j guide 2020.08.001</a>.
The full list of changes for this release can be found in <a href="https://github.com/devonfw/devon4j/milestone/12?closed=1">milestone devon4j 2020.08.001</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-04-002-2"><a class="anchor" href="#2020-04-002-2"></a>41.22. 2020.04.002</h3>
<div class="paragraph">
<p>Minor update of <code>devon4j</code> with the following bugfixes and small improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/261">#261</a>: JUnit4 backward compatibility</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/267">#267</a>: Fix JWT permission expansion</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/254">#254</a>: JWT Authentication support for devon4j-kafka</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/258">#258</a>: archetype is still lacking a .gitignore</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/273">#273</a>: Update libs</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/271">#271</a>: Do not enable resource filtering by default</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/255">#255</a>: Kafka: Support different retry configuration for different topics</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Documentation is available at <a href="https://repo.maven.apache.org/maven2/com/devonfw/java/doc/devon4j-doc/2020.04.002/devon4j-doc-2020.04.002.pdf">devon4j guide 2020.04.002</a>.
The full list of changes for this release can be found in <a href="https://github.com/devonfw/devon4j/milestone/11?closed=1">milestone devon4j 2020.04.002</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4node"><a class="anchor" href="#devon4node"></a>41.23. devon4node</h3>
<div class="paragraph">
<p>New <code>devon4node</code> version is published, the changes are:</p>
</div>
<div class="paragraph">
<p>On this release we have deprecated devon4node cli, now we use nest cli, and we have added a GraphQL sample.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4node/pull/375">#375</a>: GraphQL Sample.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4node/pull/357">#257</a>: D4N cli remove</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cobigen-4"><a class="anchor" href="#cobigen-4"></a>41.24. CobiGen</h3>
<div class="paragraph">
<p>Various bugfixes were made as well as consolidating behavior of eclipse vs maven vs cli by properly sharing more code across the different clients.
Also properly takes into account a files line delimiter instead of defaulting to those of the host system.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/devonfw/cobigen/milestone/181?closed=1">CobiGen CLI v7.1.0</a>
<a href="https://github.com/devonfw/cobigen/milestone/172?closed=1">CobiGen Maven Plug-in v7.1.0</a>
<a href="https://github.com/devonfw/cobigen/milestone/170?closed=1">CobiGen Eclipse Plug-in v7.1.0</a></p>
</div>
</div>
<div class="sect2">
<h3 id="templates-3"><a class="anchor" href="#templates-3"></a>41.25. Templates</h3>
<div class="ulist">
<ul>
<li>
<p>Removed environment.ts from the crud_angular_client_app/CRUD devon4ng Angular App increment since Cobigen did not make any changes in it</p>
</li>
<li>
<p>Removed cross referencing between template increments since there is currently no useful use case for it and it leads to a few problems</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/milestone/182?closed=1">v2020.12.001</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="java-plug-in"><a class="anchor" href="#java-plug-in"></a>41.26. Java Plug-in</h3>
<div class="ulist">
<ul>
<li>
<p>Now properly merges using the input files line delimiters instead of defaulting to those of the host system.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/milestone/169?closed=1">v7.1.0</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="typescript-plug-in"><a class="anchor" href="#typescript-plug-in"></a>41.27. TypeScript Plug-in</h3>
<div class="ulist">
<ul>
<li>
<p>Fixed NPE Added the option to read a path from an object input</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/milestone/185?closed=1">v7.1.0</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="property-plug-in"><a class="anchor" href="#property-plug-in"></a>41.28. Property Plug-in</h3>
<div class="ulist">
<ul>
<li>
<p>Now properly merges using the input files line delimiters instead of defaulting to those of the host system.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/milestone/178?closed=1">v7.1.0</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="openapi-plug-in"><a class="anchor" href="#openapi-plug-in"></a>41.29. OpenAPI Plug-in</h3>
<div class="ulist">
<ul>
<li>
<p>Fixed an issue where nullable enums lead to errors</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/milestone/176?closed=1">7.1.0</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="textmerger"><a class="anchor" href="#textmerger"></a>41.30. Textmerger</h3>
<div class="ulist">
<ul>
<li>
<p>Now properly merges using the input files line delimiters instead of defaulting to those of the host system.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/milestone/179?closed=1">v7.1.0</a></p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/milestone/177?closed=1">v7.1.1</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="sonar-devon4j-plugin"><a class="anchor" href="#sonar-devon4j-plugin"></a>41.31. Sonar devon4j plugin</h3>
<div class="paragraph">
<p>With this release, we made the package structure configurable and did some other improvements and fixes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/117">#117</a>: Rule from checkstyle plugin could not be instantiated in our quality profile</p>
</li>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/118">#118</a>: NPE during project analysis</p>
</li>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/97">#97</a>: Custom configuration for architecture</p>
</li>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/92">#92</a>: Display warnings on the 'devonfw' config page in the 'Administration' section of SonarQube</p>
</li>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/95">#95</a>: Add 3rd Party rule to avoid Immutable annotation from wrong package</p>
</li>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/94">#94</a>: Add 3rd Party rule to avoid legacy date types</p>
</li>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/93">#93</a>: Improve devonfw Java quality profile</p>
</li>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/pull/114">#114</a>: Deleted unused architecture config from SonarQube settings to avoid confusion</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Changes for this release can be found in <a href="https://github.com/devonfw/sonar-devon4j-plugin/milestone/8?closed=1">milestone 2020.12.001</a> and
 <a href="https://github.com/devonfw/sonar-devon4j-plugin/milestone/7?closed=1">milestone 2020.12.002</a></p>
</div>
</div>
<div class="sect2">
<h3 id="devon4net"><a class="anchor" href="#devon4net"></a>41.32. devon4net</h3>
<div class="paragraph">
<p>The consolidated list of features for <code>devon4net</code> is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>LiteDb: - Support for LiteDB - Provided basic repository for CRUD operations.</p>
</li>
<li>
<p>RabbitMq: - Use of EasyQNet library to perform CQRS main functions between different microservices - Send commands / Subscribe queues with one C# sentence - Events management: Handled received commands to subscribed messages - Automatic messaging backup when sent and handled (Internal database via LiteDB and database backup via Entity Framework)</p>
</li>
<li>
<p>MediatR: - Use of MediatR library to perform CQRS main functions in memory - Send commands / Subscribe queues with one C# sentence - Events management: Handled received commands to subscribed messages - Automatic messaging backup when sent and handled (Internal database via LiteDB and database backup via Entity Framework)</p>
</li>
<li>
<p>SmaxHcm: - Component to manage Microfocus SMAX for cloud infrastructure services management</p>
</li>
<li>
<p>CyberArk: - Manage safe credentials with CyberArk</p>
</li>
<li>
<p>AnsibleTower: - Ansible automates the cloud infrastructure. devon4net integrates with Ansible Tower via API consumption endpoints</p>
</li>
<li>
<p>gRPC+Protobuf: - Added Client + Server basic templates sample gRPC with Google&#8217;s Protobuf protocol using devon4net</p>
</li>
<li>
<p>Kafka: - Added Apache Kafka support for deliver/consume messages and create/delete topics as well</p>
</li>
<li>
<p>AWS support</p>
<div class="ulist">
<ul>
<li>
<p>AWS Template to create serverless applications with auto generation of an APIGateway using AWS base template</p>
</li>
<li>
<p>AWS template to create pure Lambda functions and manage SQS Events, SNS Events, Generic Events, CloudWatch, S3 Management, AWS Secrets management as a configuration provider in .NET life cycle</p>
</li>
<li>
<p>AWS CDK integration component to create/manage AWS infrastructures (Infra As Code): Database, Database cluster, VPC, Secrets, S3 buckets, Roles…</p>
</li>
</ul>
</div>
</li>
<li>
<p>Minor performance and stability improvements such Entity framework migration integration</p>
</li>
<li>
<p>Updated to the latest .net Core 3.1 TLS</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="dashboard-beta-version"><a class="anchor" href="#dashboard-beta-version"></a>41.33. dashboard (beta version)</h3>
<div class="paragraph">
<p>We are adding dashboard beta version as part of this release. Dashboard is a tool that allows you to create and manage devonfw projects.It makes it easy to onboard a new person with devonfw.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Dashboard list all ide available on user system or if no ide is availble it will provide option to download latest version of ide.</p>
</li>
<li>
<p>Project creation and management: Project page list all projects created by user using dahboard. User will be able to create devon4j, devon4ng and devon4node projects using dashboard.</p>
</li>
<li>
<p>Support for Eclipse and VSCode IDE</p>
</li>
<li>
<p>Integrated devonfw-ide usage guide from the website</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="solicitor"><a class="anchor" href="#solicitor"></a>41.34. Solicitor</h3>
<div class="paragraph">
<p>Solicitor is a tool which helps managing Open Source Software used within projects. Below is consolidated feature list of solicitor:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standalone Command Line Java Tool</p>
</li>
<li>
<p>Importers for component/license information from</p>
</li>
<li>
<p>Maven</p>
</li>
<li>
<p>Gradle</p>
</li>
<li>
<p>NPM</p>
</li>
<li>
<p>CSV (e.g. for manual entry of data)</p>
</li>
<li>
<p>Rules processing (using Drools Rule Engine) controls the the different phases:</p>
</li>
<li>
<p>Normalizing / Enhancing of license information</p>
</li>
<li>
<p>Handling of multilicensing (including selection of applicable licenses) and re-licensing</p>
</li>
<li>
<p>Legal evaluation</p>
</li>
<li>
<p>Rules to be defined as Decision Tables</p>
</li>
<li>
<p>Sample Decision Tables included</p>
</li>
<li>
<p>Automatic download and file based caching of license texts</p>
</li>
<li>
<p>Allows manual editing / reformatting of license text</p>
</li>
<li>
<p>Output processing</p>
</li>
<li>
<p>Template based text (Velocity) and XLS generation</p>
</li>
<li>
<p>SQL based pre-processor (e.g. for filtering, aggregation)</p>
</li>
<li>
<p>Audit log which documents all applied rules for every item might be included in report</p>
</li>
<li>
<p>"Diff Mode" allows to mark data which has changed as compared to a previous run of Solicitor (in Velocity and XLS reporting)</p>
</li>
<li>
<p>Customization</p>
</li>
<li>
<p>Project specific configuration (containing e.g. reporting templates, decision tables) allows to override/amend builtin configuration</p>
</li>
<li>
<p>Builtin configuration might be overridden/extended by configuration data contained in a single extension file (ZIP format)</p>
</li>
<li>
<p>This allows to safely provide organization specific rules and reporting templates to all projects of an organization (e.g. to reflect the specific OSS usage policy of the organization)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="mrchecker-2"><a class="anchor" href="#mrchecker-2"></a>41.35. MrChecker</h3>
<div class="paragraph">
<p>MrChecker Test Framework is an end to end test automation framework written in Java. It is an automated testing framework for functional testing of web applications, API web services, Service Virtualization, Security, native mobile apps and, in the near future, databases. All modules have tangible examples of how to build resilient integration test cases based on delivered functions. Below is consolidated list of updates in MrChecker:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Migration of core module to junit5</p>
</li>
<li>
<p>Extension of MrCheckers tests harness</p>
</li>
<li>
<p>Migration of mrchecker-example-module to junit 5</p>
</li>
<li>
<p>Migration guide <a href="https://devonfw.com/website/pages/docs/master-mrchecker.asciidoc_migration-from-junit4-to-junit5.html" class="bare">https://devonfw.com/website/pages/docs/master-mrchecker.asciidoc_migration-from-junit4-to-junit5.html</a></p>
</li>
<li>
<p>Upgrade to cucumber 6.7.0</p>
</li>
<li>
<p>Release of the 3.0.1 version to maven-central</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="trainingstutorials-2"><a class="anchor" href="#trainingstutorials-2"></a>41.36. Trainings/tutorials</h3>
<div class="ulist">
<ul>
<li>
<p>Katakoda tutorials : <a href="https://katacoda.com/devonfw" class="bare">https://katacoda.com/devonfw</a></p>
</li>
<li>
<p>Youtube tutorials : <a href="https://www.youtube.com/channel/UCtb1p-24jus-QoXy49t9Xzg" class="bare">https://www.youtube.com/channel/UCtb1p-24jus-QoXy49t9Xzg</a></p>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="devonfw-release-notes-2020-08"><a class="anchor" href="#devonfw-release-notes-2020-08"></a>41.37. devonfw Release notes 2020.08</h3>

</div>
<div class="sect2">
<h3 id="introduction-19"><a class="anchor" href="#introduction-19"></a>41.38. Introduction</h3>
<div class="paragraph">
<p>We are proud to announce the release of devonfw version 2020.08.</p>
</div>
<div class="paragraph">
<p>This release includes lots of addition of new features, updates and bug fixes but it is very important to highlight the following improvements:</p>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-ide-6"><a class="anchor" href="#devonfw-ide-6"></a>41.39. devonfw IDE</h3>
<div class="paragraph">
<p>The consolidated list of features for this devonfw IDE release is as it follows.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-08-001-3"><a class="anchor" href="#2020-08-001-3"></a>41.40. 2020.08.001</h3>
<div class="paragraph">
<p>Update with the following bugfixes and improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide/pull/454">#454</a>: update to eclipse 2020.06</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/442">#442</a>: update nodejs and vscode</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/432">#432</a>: vsCode settings are not updated</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/446">#446</a>: intellij: doConfigureEclipse: command not found</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/440">#440</a>: Software update may lead to inconsistent state due to windows file locks</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/427">#427</a>: release: keep leading zeros</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/450">#450</a>: update settings</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/431">#431</a>: devon build command not working correct for yarn or npm</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/449">#449</a>: update to devon4j 2020.08.001</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The full list of changes for this release can be found in <a href="https://github.com/devonfw/ide/milestone/12?closed=1">milestone 2020.08.001</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-04-004-2"><a class="anchor" href="#2020-04-004-2"></a>41.41. 2020.04.004</h3>
<div class="paragraph">
<p>Minor update with the following bugfixes and improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide/issues/433">#433</a>: Windows: devon command line sets wrong environment variables (with tilde symbol)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/435">#435</a>: fix variable resolution on bash</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The full list of changes for this release can be found in <a href="https://github.com/devonfw/ide/milestone/14?closed=1">milestone 2020.04.004</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-04-003-2"><a class="anchor" href="#2020-04-003-2"></a>41.42. 2020.04.003</h3>
<div class="paragraph">
<p>Minor update with the following bugfixes and improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide/issues/395">#395</a>: variable from devon.properites unset if value is in double quotes</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/429">#429</a>: Added script to create a meta file in the users directory after setup</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The full list of changes for this release can be found in <a href="https://github.com/devonfw/ide/milestone/13?closed=1">milestone 2020.04.003</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-04-002-3"><a class="anchor" href="#2020-04-002-3"></a>41.43. 2020.04.002</h3>
<div class="paragraph">
<p>Minor update with the following bugfixes and improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide/issues/418">#418</a>: Make projects optional</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/421">#421</a>: update devon4j to 2020.04.002</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/413">#413</a>: Update Eclipse to 2020-03</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/424">#424</a>: Strange errors on windows if devon.properties contains mixed line endings</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/399">#399</a>: launching of Intellij fails with No such file or directory error.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/410">#410</a>: fix jsonmerge for boolean and null values</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The full list of changes for this release can be found in <a href="https://github.com/devonfw/ide/milestone/11?closed=1">milestone 2020.04.002</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4j-4"><a class="anchor" href="#devon4j-4"></a>41.44. devon4j</h3>
<div class="paragraph">
<p>The consolidated list of features for this devon4j release is as it follows.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-08-001-4"><a class="anchor" href="#2020-08-001-4"></a>41.45. 2020.08.001</h3>
<div class="paragraph">
<p>New release of <code>devon4j</code> with async REST service client support and other improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/279">#279</a>: support for async service clients</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/277">#277</a>: Update Security-Guide to recent OWASP Top (2017)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/281">#281</a>: cleanup documentation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Documentation is available at <a href="https://repo.maven.apache.org/maven2/com/devonfw/java/doc/devon4j-doc/2020.08.001/devon4j-doc-2020.08.001.pdf">devon4j guide 2020.08.001</a>.
The full list of changes for this release can be found in <a href="https://github.com/devonfw/devon4j/milestone/12?closed=1">milestone devon4j 2020.08.001</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-04-002-4"><a class="anchor" href="#2020-04-002-4"></a>41.46. 2020.04.002</h3>
<div class="paragraph">
<p>Minor update of <code>devon4j</code> with the following bugfixes and small improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/261">#261</a>: JUnit4 backward compatibility</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/267">#267</a>: Fix JWT permission expansion</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/254">#254</a>: JWT Authentication support for devon4j-kafka</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/258">#258</a>: archetype is still lacking a .gitignore</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/273">#273</a>: Update libs</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/271">#271</a>: Do not enable resource filtering by default</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/255">#255</a>: Kafka: Support different retry configuration for different topics</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Documentation is available at <a href="https://repo.maven.apache.org/maven2/com/devonfw/java/doc/devon4j-doc/2020.04.002/devon4j-doc-2020.04.002.pdf">devon4j guide 2020.04.002</a>.
The full list of changes for this release can be found in <a href="https://github.com/devonfw/devon4j/milestone/11?closed=1">milestone devon4j 2020.04.002</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4ng-3"><a class="anchor" href="#devon4ng-3"></a>41.47. devon4ng</h3>
<div class="paragraph">
<p>This release is focused mainly on the <strong>Angular 10 upgrade</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4ng/pull/176">#176</a>: Template submodules updated to Angular 10 and NgRx 10.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4ng/pull/167">#167</a>, <a href="https://github.com/devonfw/devon4ng/pull/168">#168</a>, <a href="https://github.com/devonfw/devon4ng/pull/174">#174</a> and <a href="https://github.com/devonfw/devon4ng/pull/175">#175</a>: Updated electron (sample and documentation).</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4ng/pull/166">#166</a>: Update error handler.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4ng/pull/165">#165</a>: Cypress sample.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4ng/pull/164">#164</a>: Update to Angular 10 (samples and documentation).</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4node-2"><a class="anchor" href="#devon4node-2"></a>41.48. devon4node</h3>
<div class="paragraph">
<p>New <code>devon4node</code> version is published, the changes are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Updated dependencies.</p>
</li>
<li>
<p>Solved bug when you introduce a name with dashes in new command.</p>
</li>
<li>
<p>Add more options to the non-interactive new command.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cobigen-5"><a class="anchor" href="#cobigen-5"></a>41.49. CobiGen</h3>
<div class="paragraph">
<p>CobiGen version numbers have been consolidated to now represent plug-in compatibility in the major release number (7.x.x).</p>
</div>
</div>
<div class="sect2">
<h3 id="cli"><a class="anchor" href="#cli"></a>41.50. CLI</h3>
<div class="ulist">
<ul>
<li>
<p>CLI increments can be referenced by name and description.</p>
</li>
<li>
<p>Ability to configure logging.</p>
</li>
<li>
<p>Fixed error on code formatting.</p>
</li>
<li>
<p>Improved Performance by lazy plug-in loading.</p>
</li>
<li>
<p>Possibility to prefer custom plug-ins over CobiGen ones.</p>
</li>
<li>
<p>Fixed bug, which broke whole CobiGen execution in case a custom CobiGen Plug-in was throwing an arbitrary exception.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="eclipse-6"><a class="anchor" href="#eclipse-6"></a>41.51. Eclipse</h3>
<div class="ulist">
<ul>
<li>
<p>Improved Performance by lazy plug-in loading.</p>
</li>
<li>
<p>Possibility to prefer custom plug-ins over CobiGen ones.</p>
</li>
<li>
<p>Fixed bug, which broke whole CobiGen execution in case a custom CobiGen Plug-in was throwing an arbitrary exception.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="maven-2"><a class="anchor" href="#maven-2"></a>41.52. Maven</h3>
<div class="ulist">
<ul>
<li>
<p>Fixed bug to properly load template util classes.</p>
</li>
<li>
<p>Improved Performance by lazy plug-in loading.</p>
</li>
<li>
<p>Possibility to prefer custom plug-ins over CobiGen ones.</p>
</li>
<li>
<p>Fixed bug, which broke whole CobiGen execution in case a custom CobiGen Plug-in was throwing an arbitrary exception.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="xml-plug-in"><a class="anchor" href="#xml-plug-in"></a>41.53. XML Plug-in</h3>
<div class="ulist">
<ul>
<li>
<p>Added ability to provide custom merge schemas as part of the template folder.</p>
</li>
<li>
<p>Added further merge strategies for merging including XML validation.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="java-plug-in-2"><a class="anchor" href="#java-plug-in-2"></a>41.54. Java Plug-in</h3>
<div class="ulist">
<ul>
<li>
<p>Fixed NPE for annotated constructors.</p>
</li>
<li>
<p>Fixed line separator handling to now prefer the file&#8217;s one instead of the system ones.</p>
</li>
<li>
<p>Fixed unwanted new lines in constructors after merging.</p>
</li>
<li>
<p>Fixed annotation formatting after merge.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="typescript-plug-in-2"><a class="anchor" href="#typescript-plug-in-2"></a>41.55. TypeScript Plug-in</h3>
<div class="ulist">
<ul>
<li>
<p>Fixed issue on automatic update of the ts-merger bundle.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="sonar-devon4j-plugin-2"><a class="anchor" href="#sonar-devon4j-plugin-2"></a>41.56. Sonar devon4j plugin</h3>
<div class="paragraph">
<p>The consolidated list of features for this <code>Sonar devon4j plugin</code> release is as it follows.</p>
</div>
<div class="paragraph">
<p>With this release, we added our own quality profile:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/16">#16</a>: Install devon4j quality profile</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Changes for this release can be found in <a href="https://github.com/devonfw/sonar-devon4j-plugin/milestone/6?closed=1">milestone 2020.08.001</a></p>
</div>
</div>
<div class="sect2">
<h3 id="my-thai-star-with-microservices-and-istio-service-mesh-implementation"><a class="anchor" href="#my-thai-star-with-microservices-and-istio-service-mesh-implementation"></a>41.57. My Thai Star with Microservices and ISTIO Service Mesh Implementation</h3>
<div class="paragraph">
<p>As always, our reference application, <code>My Thai Star</code> now has been implemented with Microservices and ISTIO Service Mesh features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>devon4j - Java</p>
<div class="ulist">
<ul>
<li>
<p>My Thai Star now has a sample version on Microservices architecture.</p>
</li>
<li>
<p>The github repository for the microservices version of My Thai Star is hosted at <a href="https://github.com/devonfw-sample/my-thai-star-microservices/tree/dev_mtsj_microservices">My Thai Star with Microservices</a></p>
</li>
<li>
<p>My Thai Star Microservices now has a multi stage docker build which generates the respective docker images for all the My Thai Star services.</p>
</li>
<li>
<p>My Thai Star microservices has the Kubernetes artifacts available to be able to deploy into Kubernetes pods.</p>
</li>
<li>
<p>My Thai Star microservices has ISTIO the service mesh implementation.</p>
</li>
<li>
<p>Check out the guides to implement or configure ISTIO features such as Traffic Routing, Network Resiliency features(RequestRouting, RequestTimeouts, Fault Injection, Circuit Breaker), Canary Deployments.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="devonfw-release-notes-2020-04"><a class="anchor" href="#devonfw-release-notes-2020-04"></a>41.58. devonfw Release notes 2020.04</h3>

</div>
<div class="sect2">
<h3 id="introduction-20"><a class="anchor" href="#introduction-20"></a>41.59. Introduction</h3>
<div class="paragraph">
<p>We are proud to announce the immediate release of devonfw version 2020.04. This version is the first one with the new versioning that will make easier to the community to identify when it was released since we use the year and month as many other software distributions.</p>
</div>
<div class="paragraph">
<p>This release includes lots of bug fixes and many version updates, but it is very important to highlight the following improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>New devonfw IDE auto-configure project feature.</p>
</li>
<li>
<p>Improved devonfw IDE plugin configuration.</p>
</li>
<li>
<p>New devon4j kafka module.</p>
</li>
<li>
<p>New devon4j JWT module.</p>
</li>
<li>
<p>New devon4j authorization of batches feature.</p>
</li>
<li>
<p>Dozer replaced with Orika in devon4j.</p>
</li>
<li>
<p>Support for composite keys in devon4j and CobiGen.</p>
</li>
<li>
<p>Multiple enhancements for project specific plugin development and usage of project specific template sets in CobiGen.</p>
</li>
<li>
<p>Ability to adapt your own templates by making use of CobiGen CLI.</p>
</li>
<li>
<p>Better responsiveness in eclipse and bugfixes in all assets in CobiGen.</p>
</li>
<li>
<p>devon4ng updated to Angular 9, NgRx 9 and Ionic 5, including documentation, samples and templates.</p>
</li>
<li>
<p>Yarn 2 support in devon4ng.</p>
</li>
<li>
<p>devon4node updated to NestJS 7 (packages, samples and documentation)</p>
</li>
<li>
<p>devon4node TSLint replaced with ESLint.</p>
</li>
<li>
<p>@devon4node/config package added.</p>
</li>
<li>
<p>devon4net updated to latest .NET Core 3.1.3 LTS version.</p>
</li>
<li>
<p>Update of the Production Line templates for devonfw projects in devonfw shop floor.</p>
</li>
<li>
<p>New merge feature included in the devonfw shop floor cicdgen tool.</p>
</li>
<li>
<p>Updated sonar-devon4j-plugin:</p>
<div class="ulist">
<ul>
<li>
<p>Improved coloring and other visual cues to our rule descriptions to highlight good and bad code examples.</p>
</li>
<li>
<p>Improved the locations of issues thrown on method- and class-level.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please check the detailed list below.</p>
</div>
<div class="paragraph">
<p>This would have not been possible without the commitment and hard work of the devonfw core team, German, Indian and ADCenter Valencia colleagues and collaborators as, among many others, the Production Line team.</p>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-ide-7"><a class="anchor" href="#devonfw-ide-7"></a>41.60. devonfw IDE</h3>
<div class="paragraph">
<p>The consolidated list of features for this devonfw IDE release is as it follows.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-04-001"><a class="anchor" href="#2020-04-001"></a>41.61. 2020.04.001</h3>
<div class="paragraph">
<p>Starting with this release we have changed the versioning schema in <code>devonfw</code> to <code>yyyy.mm.NNN</code> where <code>yyyy.mm</code> is the date of the planned milestone release and <code>NNN</code> is a running number increased with every bug- or security-fix update.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide/issues/394">#394</a> variable from devon.properties not set if not terminated with newline</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/399">#399</a> launching of Intellij fails with No such file or directory error.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/371">#371</a> Eclipse plugin installation broke</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/390">#390</a> maven get/set-version buggy</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/397">#397</a> migration support for devon4j 2020.04.001</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/400">#400</a> allow custom args for release</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The full list of changes for this release can be found in <a href="https://github.com/devonfw/ide/milestone/9?closed=1">milestone 2020.04.001</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="3-3-1"><a class="anchor" href="#3-3-1"></a>41.62. 3.3.1</h3>
<div class="paragraph">
<p>New release with bugfixes and new ide plugin feature:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide/issues/343">#343</a>: Setup can&#8217;t find Bash nor Git</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/369">#369</a>: Fix flattening of POMs</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/386">#386</a>: Feature/clone recursive</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/379">#379</a>: Use own extensions folder in devonfw-ide</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/381">#381</a>: Add ability to configure VS Code plugins via settings</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/376">#376</a>: Improve Eclipse plugin configuration</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/373">#373</a>: Fix project import on windows</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/374">#374</a>: Rework build on import</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The full list of changes for this release can be found in <a href="https://github.com/devonfw/ide/milestone/10?closed=1">milestone 3.3.1</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="3-3-0"><a class="anchor" href="#3-3-0"></a>41.63. 3.3.0</h3>
<div class="paragraph">
<p>New release with bugfixes and new project import feature:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/ide/pull/343">#343</a>: Detect non-admin GitForWindows and Cygwin</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/175">#175</a>: Ability to clone projects and import into Eclipse automatically</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/346">#346</a>: devon eclipse add-plugin parameters swapped</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/issues/363">#363</a>: devon ide update does not pull latest project settings</p>
</li>
<li>
<p><a href="https://github.com/devonfw/ide/pull/366">#366</a>: update java versions to latest fix releases</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The full list of changes for this release can be found in <a href="https://github.com/devonfw/ide/milestone/5?closed=1">milestone 3.3.0</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4j-5"><a class="anchor" href="#devon4j-5"></a>41.64. devon4j</h3>
<div class="paragraph">
<p>The consolidated list of features for this devon4j release is as it follows.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-04-001-2"><a class="anchor" href="#2020-04-001-2"></a>41.65. 2020.04.001</h3>
<div class="paragraph">
<p>Starting with this release we have changed the versioning schema in <code>devonfw</code> to <code>yyyy.mm.NNN</code> where <code>yyyy.mm</code> is the date of the planned milestone release and <code>NNN</code> is a running number increased with every bug- or security-fix update.</p>
</div>
<div class="paragraph">
<p>The following changes have been incorporated in devon4j:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/233">#233</a>: Various version updates</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/241">#241</a>: Add module to support JWT and parts of OAuth</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/147">#147</a>: Switch from dozer to orika</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/180">#180</a>: Cleanup archtype</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/240">#240</a>: Add unreferenced guides</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/202">#202</a>: Architecture documentation needs update for components</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/145">#145</a>: Add a microservices article in the documentation</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/198">#198</a>: Deploy SNAPSHOTs to OSSRH in travis CI</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/90">#90</a>: Authorization of batches</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/221">#221</a>: Wrote monitoring guide</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/213">#213</a>: Document logging of custom field in json</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/138">#138</a>: Remove deprecated RevisionMetadata[Type]</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/211">#211</a>: Archetype: security config broken</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/109">#109</a>: LoginController not following devon4j to use JAX-RS but uses spring-webmvc instead</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/52">#52</a>: Improve configuration</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/39">#39</a>: Ability to log custom fields via SLF4J</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/204">#204</a>: Slf4j version</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/190">#190</a>: Rework of spring-batch integration</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/210">#210</a>: Rework documentation for blob support</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/191">#191</a>: Rework of devon4j-batch module</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/209">#209</a>: Include performance info in separate fields</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/207">#207</a>: Use more specific exception for not found entity</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/208">#208</a>: Remove unnecesary clone</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/116">#116</a>: Bug in JSON Mapping for ZonedDateTime</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/184">#184</a>: Fixed BOMs so devon4j and archetype can be used again</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/183">#183</a>: Error in executing the project created with devon4j</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/issues/177">#177</a>: Switch to new maven-parent</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4j/pull/169">169</a>: Provide a reason, why unchecked exceptions are used in devon4j</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Documentation is available at <a href="https://repo.maven.apache.org/maven2/com/devonfw/java/doc/devon4j-doc/2020.04.001/devon4j-doc-2020.04.001.pdf">devon4j guide 2020.04.001</a>.
The full list of changes for this release can be found in <a href="https://github.com/devonfw/devon4j/milestone/8?closed=1">milestone devon4j 2020.04.001</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4ng-4"><a class="anchor" href="#devon4ng-4"></a>41.66. devon4ng</h3>
<div class="paragraph">
<p>The consolidated list of features for this devon4ng release is as it follows.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-04-001-3"><a class="anchor" href="#2020-04-001-3"></a>41.67. 2020.04.001</h3>
<div class="paragraph">
<p>Starting with this release we have changed the versioning schema in <code>devonfw</code> to <code>yyyy.mm.NNN</code> where <code>yyyy.mm</code> is the date of the planned milestone release and <code>NNN</code> is a running number increased with every bug- or security-fix update.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/devon4ng/pull/111">#111</a>: Yarn 2 support included</p>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4ng/pull/96">#96</a>: devon4ng upgrade to Angular 9</p>
<div class="ulist">
<ul>
<li>
<p>Templates and samples updated to Angular 9, NgRx 9 and Ionic 5.</p>
</li>
<li>
<p>New internationalization module.</p>
</li>
<li>
<p>Documentation updates and improvements.</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://github.com/devonfw/devon4ng/pull/95">#95</a>: Added token management info in documentation</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4net-2"><a class="anchor" href="#devon4net-2"></a>41.68. devon4net</h3>
<div class="paragraph">
<p>The consolidated list of features for this devon4net release is as it follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Updated to latest .NET Core 3.1.3 LTS version</p>
</li>
<li>
<p>Dependency Injection Autoregistration for services and repositories</p>
</li>
<li>
<p>Added multiple role managing claims in JWT</p>
</li>
<li>
<p>Added custom headers to circuit breaker</p>
</li>
<li>
<p>Reviewed default log configuration</p>
</li>
<li>
<p>Added support to order query results from database via lambda expression</p>
</li>
<li>
<p>Updated template and nuget packages</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4node-3"><a class="anchor" href="#devon4node-3"></a>41.69. devon4node</h3>
<div class="paragraph">
<p>The consolidated list of features for this devon4node release is as it follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Upgrade to NestJS 7 (packages, samples and documentation)</p>
</li>
<li>
<p>TSLint replaced with ESLint</p>
</li>
<li>
<p>Add lerna to project to manage all the packages</p>
</li>
<li>
<p>Add @devon4node/config package</p>
</li>
<li>
<p>Add new schematics: Repository</p>
</li>
<li>
<p>Improve WinstonLogger</p>
</li>
<li>
<p>Improve documentation</p>
</li>
<li>
<p>Update dependencies to latest versions</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cobigen-6"><a class="anchor" href="#cobigen-6"></a>41.70. CobiGen</h3>
<div class="paragraph">
<p>New release with updates and bugfixes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>devonfw templates:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/1063">#1063</a>: Upgrade devon4ng Ionic template to latest version</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1065">#1065</a>: devon4ng templates for devon4node</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1128">#1128</a>: update java templates for composite keys</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/1130">#1130</a>: Update template for devon4ng application template</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/1131">#1131</a>: Update template for devon4ng NgRx template</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1139">#1149</a>: .NET templates</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1146">#1146</a>: Dev ionic template update bug fix</p>
</li>
</ul>
</div>
</li>
<li>
<p>TypeScript plugin:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/1126">#1126</a>: OpenApi parse/merge issues (ionic List templates)</p>
</li>
</ul>
</div>
</li>
<li>
<p>Eclipse plugin:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/412">#412</a>: Write UI Test for HealthCheck use</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/867">#867</a>: Cobigen processbar</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1069">#1069</a>: #953 dot path</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/1099">#1099</a>: NPE on HealthCheck</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1100">#1100</a>: 1099 NPE on health check</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1101">#1101</a>: #867 fix import of core and api</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/1102">#1102</a>: eclipse_plugin doesn&#8217;t accept folders as input</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1134">#1134</a>: (Eclipse-Plugin) Resolve Template utility classes from core</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1142">#1142</a>: #1102 accept all kinds of input</p>
</li>
</ul>
</div>
</li>
<li>
<p>CobiGen core:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/429">#429</a>: Reference external template files</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1143">#1143</a>: Abort generation if external trigger does not match</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/1125">#1125</a>: Generation of templates from external increments does not work</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/747">#747</a>: Variable assignment for external increments throws exception</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1133">#1133</a>: Bugfix/1125 generation of templates from external increments does not work</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1127">#1127</a>: #1119 added new TemplatesUtilsClassesUtil class to core</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/953">#953</a>: NPE bug if foldername contains a dot</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1067">#1067</a>: Feature/158 lat variables syntax</p>
</li>
</ul>
</div>
</li>
<li>
<p>CobiGen CLI:</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/1111">#1111</a>: Infinity loop in mmm-code (MavenDependencyCollector.collectWithReactor)</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/1113">#1113</a>: cobigen-cli does not seem to properly resolve classes from dependencies</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1120">#1120</a>: Feature #1108 custom templates folder</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1115">#1115</a>: Fixing CLI bugs related to dependencies and custom templates jar</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/1108">#1108</a>: CobiGen CLI: Allow easy use of user&#8217;s templates</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/issues/1110">#1110</a>: FileSystemNotFoundException blocking cobigen-cli</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1138">#1138</a>: #1108 dev cli feature custom templates folder</p>
</li>
<li>
<p><a href="https://github.com/devonfw/cobigen/pull/1136">#1136</a>: (Cobigen-CLI) Resolve Template utility classes from core</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-shop-floor-2"><a class="anchor" href="#devonfw-shop-floor-2"></a>41.71. devonfw-shop-floor</h3>
<div class="ulist">
<ul>
<li>
<p>Add documentation for deploy jenkins slaves</p>
</li>
<li>
<p>Improve documentation</p>
</li>
<li>
<p>Add devon4net Openshift template</p>
</li>
<li>
<p>Add nginx docker image for devon4ng</p>
</li>
<li>
<p>Add Openshift provisioning</p>
</li>
<li>
<p>Production Line:</p>
<div class="ulist">
<ul>
<li>
<p>Updated MTS template: add step for dependency check and change the deployment method</p>
</li>
<li>
<p>Add template utils: initialize instance, openshift configuration, docker configuration and install sonar plugin</p>
</li>
<li>
<p>Add devon4net template</p>
</li>
<li>
<p>Add from existing template</p>
</li>
<li>
<p>Improve documentation</p>
</li>
<li>
<p>Refactor the documentation in order to follow the devonfw wiki workflow</p>
</li>
<li>
<p>Update devon4j, devon4ng, devon4net and devon4node in order to be able to choose the deployment method: none, docker or openshift.</p>
</li>
<li>
<p>Update the tools version in order to use the latest.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Production Line Shared Lib</p>
<div class="ulist">
<ul>
<li>
<p>Add more fuctionality to the existing classes.</p>
</li>
<li>
<p>Add classes: DependencyCheckConfiguration, DockerConfiguration and OpenshiftConfiguration</p>
</li>
</ul>
</div>
</li>
<li>
<p>CICDGEN</p>
<div class="ulist">
<ul>
<li>
<p>Add devon4net support</p>
</li>
<li>
<p>Update tools versions in Jenkinsfiles to align with Production Line templates</p>
</li>
<li>
<p>Add merge strategies: error, keep, override, combine</p>
</li>
<li>
<p>Add lerna to the project</p>
</li>
<li>
<p>Minor improvements in the code</p>
</li>
<li>
<p>Add GitHub actions workflow to validate the new changes</p>
</li>
<li>
<p>Improve documentation</p>
</li>
<li>
<p>Breaking changes:</p>
<div class="ulist">
<ul>
<li>
<p>Remove the following parameters: plurl, ocurl</p>
</li>
<li>
<p>Add the following parameters: dockerurl, dockercertid, registryurl, ocname and merge</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="sonar-devon4j-plugin-3"><a class="anchor" href="#sonar-devon4j-plugin-3"></a>41.72. Sonar devon4j plugin</h3>
<div class="paragraph">
<p>The consolidated list of features for this Sonar devon4j plugin release is as it follows.</p>
</div>
</div>
<div class="sect2">
<h3 id="2020-04-001-4"><a class="anchor" href="#2020-04-001-4"></a>41.73. 2020.04.001</h3>
<div class="paragraph">
<p>This is the first version using our new versioning scheme. Here, the following issues were resolved:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/60">#60</a>: Fixed a bug in the naming check for Use-Case implementation classes</p>
</li>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/67">#67</a>: Fixed a bug where the whole body of a method or a class was marked as the issue location. Now only the method / class headers will be highlighted.</p>
</li>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/68">#68</a>: Made our rule descriptions more accessible by using better readable colors as well as alternative visual cues</p>
</li>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/71">#71</a>: Fixed a bug where a NPE could be thrown</p>
</li>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/74">#74</a>: Fixed a bug where a method always returned null</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Unrelated to any specific issues, there was some refactoring and cleaning up done with the following two PRs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/66">PR #66</a>: Refactored the prefixes of our rule names from 'Devon' to 'devonfw'</p>
</li>
<li>
<p><a href="https://github.com/devonfw/sonar-devon4j-plugin/issues/65">PR #65</a>: Sorted security-related test files into their own package</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Changes for this release can be found in <a href="https://github.com/devonfw/sonar-devon4j-plugin/milestone/3?closed=1">milestone 2020.04.001</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="my-thai-star-3"><a class="anchor" href="#my-thai-star-3"></a>41.74. My Thai Star</h3>
<div class="paragraph">
<p>As always, our reference application, My Thai Star, contains some interesting improvements that come from the new features and bug fixes from the other assets. The list is as it follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>devon4j - Java</p>
<div class="ulist">
<ul>
<li>
<p>Implement example batches with modified devon-batch</p>
</li>
<li>
<p>Upgrade spring boot version to 2.2.6 and devon4j 2020.004.001</p>
</li>
<li>
<p>Migrate from dozer to orika</p>
</li>
</ul>
</div>
</li>
<li>
<p>devon4ng - Angular</p>
<div class="ulist">
<ul>
<li>
<p>Move configuration to NgRx store</p>
</li>
</ul>
</div>
</li>
<li>
<p>devonfw shop floor - Jenkins</p>
<div class="ulist">
<ul>
<li>
<p>Update tools versions in order to align with Production Line templates</p>
</li>
<li>
<p>Add dependency check step (using dependency checker and yarn audit)</p>
</li>
<li>
<p>Send dependency checker reports to SonarQube</p>
</li>
<li>
<p>Changed deployment pipelines. Now pipelines are able to deploy docker containers using docker directly. No more ssh connections to execute commands in a remote machine are required.</p>
</li>
<li>
<p>Update documentation in order to reflect all changes</p>
</li>
</ul>
</div>
</li>
<li>
<p>devon4nde - Node.js</p>
<div class="ulist">
<ul>
<li>
<p>Upgrade to NestJS 7</p>
</li>
<li>
<p>Add custom repositories</p>
</li>
<li>
<p>Add exceptions and exception filters</p>
</li>
<li>
<p>Add tests (missing in the previous version)</p>
</li>
<li>
<p>Split logic into use cases in order to make the test process easier</p>
</li>
<li>
<p>Minor patches and improvemets</p>
</li>
<li>
<p>Documentation updated in order to reflect the new implementation</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="devonfw-release-notes-3-2-homer"><a class="anchor" href="#devonfw-release-notes-3-2-homer"></a>41.75. devonfw Release notes 3.2 “Homer”</h3>

</div>
<div class="sect2">
<h3 id="introduction-21"><a class="anchor" href="#introduction-21"></a>41.76. Introduction</h3>
<div class="paragraph">
<p>We are proud to announce the immediate release of devonfw version 3.2 (code named “Homer” during development). This version is the first one that contains the <strong>new devonfw IDE</strong> by default, so there is no need to download a huge ZIP with the whole distribution regardless of the use to which it will be put. The new devonfw IDE CLI will allow any user to setup a customized development environment completely configured with access to all the devonfw features, frameworks and tools. As we access to the official IDEs this is also the first version macOS compatible.</p>
</div>
<div class="paragraph">
<p>This release consolidates the documentation workflow adding the contents dynamically to the new devonfw website at the same time the PDF is generated. This have been achieved using a new GitHub action that takes the contents and builds the HTML files for the documentation section of the website. The documentation workflow proposed in the following picture is now complete:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/documentation_workflow.png"><img src="_images/images/documentation_workflow.png" alt="documentation workflow"></a>
</div>
</div>
<div class="paragraph">
<p>This release also includes the <strong>first version of devon4node</strong>. We consider that node.js should be a first-class citizen inside the devonfw platform and for that reason we have included the latest development technologies for this ecosystem. The devon4node CLI, schematics and other tools will allow our users to create powerful node.js applications with the same philosophy you may find in the other languages and frameworks included. More information at its section below.</p>
</div>
<div class="paragraph">
<p>The new <strong>devon4net 3.2.0 version</strong> is also included in this release. Based on the .NET Core 3.0 and containing lots of new features gathered from important and recent projects, it represents a great improvement and an intermediate step to provide support for the incoming .NET Core 3.1 LTS. More information at its section below.</p>
</div>
<div class="paragraph">
<p>This release includes the final version of the <strong>new CobiGen CLI</strong> and completely integrated with the new devonfw IDE. Now using commands, you will be able to generate code the same way as you do with Eclipse. This means that you can use CobiGen on other IDEs like Visual Studio Code or IntelliJ. Besides the Update command has been implemented. Now you will be able to update easily all your CobiGen plug-ins and templates inside the CLI.</p>
</div>
<div class="paragraph">
<p>On the other hand, the refactoring process has been completely developed, improving the mergers and including input readers for any other languages and frameworks, allowing the creation of models to generate code from them. Last, but not least, this new version includes the new templates for devon4net, devon4ng and devon4j generation.</p>
</div>
<div class="paragraph">
<p>And as always, <strong>My Thai Star</strong> has been updated to the latest versions of devon4j, devon4node and devon4net including completely State Management with NgRx in its devon4ng implementation upgrade.</p>
</div>
<div class="paragraph">
<p>This is the last release with the current semantic versioning number and without a fixed release calendar. From now on the new devonfw releases will happen in April, August and December and will be named <strong>YYYY.MM.NN</strong>, being the first release of the next year the 2020.04.00.</p>
</div>
</div>
<div class="sect2">
<h3 id="changes-and-new-features"><a class="anchor" href="#changes-and-new-features"></a>41.77. Changes and new features</h3>

</div>
<div class="sect2">
<h3 id="devonfw-ide-8"><a class="anchor" href="#devonfw-ide-8"></a>41.78. devonfw-ide</h3>
<div class="paragraph">
<p>We have entirely rewritten our automated solution for your local IDE (integrated desktop environment). The former oasp4j-ide and devonfw distributions with their extra-large gigabyte zip files are not entirely replaced with devonfw-ide. This new solution is provided as a small *.tar.gz file that is publicly available. It works on all platforms and has been tested on Windows, MacOS, and Linux. After extraction you only need to run a <code>setup</code> script. Here you provide a settings git URL for your customer project or simply hit return for testing or small projects. After reading and confirming the terms of use it will download all required tools in the proper versions for your operating system and configure them. Instead of various confusing scripts there is now only one CLI command <code>devon</code> for all use-cases what gives a much better user experience.</p>
</div>
<div class="paragraph">
<p>To get started go to the <a href="https://github.com/devonfw/ide/blob/master/documentation/Home.adoc#devon-ide">home page</a>. There is even a <a href="https://github.com/devonfw/ide/blob/master/documentation/migration-from-devonfw-3.0.0-or-lower.adoc#migration-from-oasp4j-ide">migration-guide</a> if you are currently used to the old approach and want to quickly jump into the new solution.</p>
</div>
</div>
<div class="sect2">
<h3 id="my-thai-star-sample-application"><a class="anchor" href="#my-thai-star-sample-application"></a>41.79. My Thai Star Sample Application</h3>
<div class="paragraph">
<p>The new release of My Thai Star has focused on the following improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Release 3.2.0.</p>
</li>
<li>
<p>devon4j:</p>
<div class="ulist">
<ul>
<li>
<p>devon4j 3.2.0 integrated.</p>
</li>
<li>
<p>Spring Boot 2.1.9 integrated.</p>
</li>
<li>
<p>SAP 4/HANA prediction use case.</p>
</li>
<li>
<p>Bug fixes.</p>
</li>
</ul>
</div>
</li>
<li>
<p>devon4ng:</p>
<div class="ulist">
<ul>
<li>
<p>SAP 4/HANA prediction use case.</p>
</li>
<li>
<p>2FA toggleable (two factor authentication).</p>
</li>
<li>
<p>NgRx full integrated (PR #285).</p>
</li>
</ul>
</div>
</li>
<li>
<p>devon4net</p>
<div class="ulist">
<ul>
<li>
<p>devon4net for dotnet core 3.0 updated</p>
</li>
<li>
<p>Updated the API contract compatible with the other stacks</p>
</li>
<li>
<p>JWT implementation reviewed to increase security</p>
</li>
<li>
<p>ASP.NET user database dependencies removed</p>
</li>
<li>
<p>HTTP2 support</p>
</li>
<li>
<p>Clearer CRUD pattern implementation</p>
</li>
</ul>
</div>
</li>
<li>
<p>devon4node</p>
<div class="ulist">
<ul>
<li>
<p>TypeScript 3.6.3.</p>
</li>
<li>
<p>Based on Nest framework.</p>
</li>
<li>
<p>Configuration Module</p>
</li>
<li>
<p>Added cors and security headers</p>
</li>
<li>
<p>Added mailer module and email templates.</p>
</li>
<li>
<p>Built in winston logger</p>
</li>
<li>
<p>Custom ClassSerializerInterceptor</p>
</li>
</ul>
</div>
</li>
<li>
<p>MrChecker</p>
<div class="ulist">
<ul>
<li>
<p>Example cases for end-to-end test.</p>
</li>
<li>
<p>Production line configuration.</p>
</li>
</ul>
</div>
</li>
<li>
<p>CICD</p>
<div class="ulist">
<ul>
<li>
<p>Improved integration with Production Line</p>
</li>
<li>
<p>New Traefik load balancer and reverse proxy</p>
</li>
<li>
<p>New deployment from artifact</p>
</li>
<li>
<p>New CICD pipelines</p>
</li>
<li>
<p>New deployment pipelines</p>
</li>
<li>
<p>Automated creation of pipelines in Jenkins</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="documentation-updates"><a class="anchor" href="#documentation-updates"></a>41.80. Documentation updates</h3>
<div class="paragraph">
<p>This release addresses the new documentation workflow, being now possible to keep the documentation synced with any change. The new documentation includes the following contents:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Getting started</p>
</li>
<li>
<p>devonfw ide</p>
</li>
<li>
<p>devon4j documentation</p>
</li>
<li>
<p>devon4ng documentation</p>
</li>
<li>
<p>devon4net documentation</p>
</li>
<li>
<p>devon4node documentation</p>
</li>
<li>
<p>CobiGen documentation</p>
</li>
<li>
<p>devonfw-shop-floor documentation</p>
</li>
<li>
<p>cicdgen documentation</p>
</li>
<li>
<p>devonfw testing with MrChecker</p>
</li>
<li>
<p>My Thai Star documentation</p>
</li>
<li>
<p>Contribution guide</p>
</li>
<li>
<p>Release notes</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4j-6"><a class="anchor" href="#devon4j-6"></a>41.81. devon4j</h3>
<div class="paragraph">
<p>The following changes have been incorporated in devon4j:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Completed full support from Java8 to Java11</p>
</li>
<li>
<p>Several security fixes</p>
</li>
<li>
<p>Upgrade to Spring Boot 2.1.9</p>
</li>
<li>
<p>Upgrade to Spring 5.1.8</p>
</li>
<li>
<p>Upgrade to JUnit 5 (requires migration via devonfw-ide)</p>
</li>
<li>
<p>Improved JPA support for IdRef</p>
</li>
<li>
<p>Improved auditing metadata support</p>
</li>
<li>
<p>Many improvements to documentation (added JDK guide, architecture-mapping, JMS, etc.)</p>
</li>
<li>
<p>For all details see <a href="https://github.com/devonfw/devon4j/milestone/6?closed=1">milestone</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4ng-5"><a class="anchor" href="#devon4ng-5"></a>41.82. devon4ng</h3>
<div class="paragraph">
<p>The following changes have been incorporated in devon4ng:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Angular CLI 8.3.1,</p>
</li>
<li>
<p>Angular 8.2.11,</p>
</li>
<li>
<p>Angular Material 8.2.3,</p>
</li>
<li>
<p>Ionic 4.11.1,</p>
</li>
<li>
<p>Capacitor 1.2.1 as Cordova replacement,</p>
</li>
<li>
<p>NgRx 8.3 support for State Management,</p>
</li>
<li>
<p>devon4ng Angular application template updated to Angular 8.2.11 with visual improvements and bugfixes <a href="https://github.com/devonfw/devon4ng-application-template" class="bare">https://github.com/devonfw/devon4ng-application-template</a></p>
</li>
<li>
<p>devon4ng Ionic application template updated to 4.11.1 and improved <a href="https://github.com/devonfw/devon4ng-ionic-application-template" class="bare">https://github.com/devonfw/devon4ng-ionic-application-template</a></p>
</li>
<li>
<p>Improved devon4ng Angular application template with state management using Angular 8 and NgRx 8 <a href="https://github.com/devonfw/devon4ng-ngrx-template" class="bare">https://github.com/devonfw/devon4ng-ngrx-template</a></p>
</li>
<li>
<p>Documentation and samples updated to latest versions:</p>
<div class="ulist">
<ul>
<li>
<p>Web Components with Angular Elements</p>
</li>
<li>
<p>Initial configuration with App Initializer pattern</p>
</li>
<li>
<p>Error Handling</p>
</li>
<li>
<p>PWA with Angular and Ionic</p>
</li>
<li>
<p>Lazy Loading</p>
</li>
<li>
<p>Library construction</p>
</li>
<li>
<p>Layout with Angular Material</p>
</li>
<li>
<p>Theming with Angular Material</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4net-3"><a class="anchor" href="#devon4net-3"></a>41.83. devon4net</h3>
<div class="paragraph">
<p>The following changes have been incorporated in devon4net:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Updated to latest .net core 3.0 version</p>
</li>
<li>
<p>Template</p>
<div class="ulist">
<ul>
<li>
<p>Global configuration automated. devon4net can be instantiated on any .net core application template with no effort</p>
</li>
<li>
<p>Added support for HTTP2</p>
</li>
<li>
<p>Number of libraries minimized</p>
</li>
<li>
<p>Architecture layer review. More clear and scalable</p>
</li>
<li>
<p>Added red button functionality (aka killswitch) to stop attending API request with custom error</p>
</li>
<li>
<p>Improved API error management</p>
</li>
<li>
<p>Added support to only accept request from clients with a specific client certificate on Kestrel server. Special thanks to Bart Roozendaal (Capgemini NL)</p>
</li>
<li>
<p>All components use IOptions pattern to be set up properly</p>
</li>
<li>
<p>Swagger generation compatible with OpenAPI v3</p>
</li>
</ul>
</div>
</li>
<li>
<p>Modules</p>
<div class="ulist">
<ul>
<li>
<p>The devon4net netstandard libraries have been updated to netstandard 2.1</p>
</li>
<li>
<p>JWT:</p>
<div class="ulist">
<ul>
<li>
<p>Added token encryption (token cannot be decrypted anymore by external parties). Now You can choose the encryption algorithm depending on your needs</p>
</li>
<li>
<p>Added support for secret key or certificate encryption</p>
</li>
<li>
<p>Added authorization for swagger portal</p>
</li>
</ul>
</div>
</li>
<li>
<p>Circuit breaker</p>
<div class="ulist">
<ul>
<li>
<p>Added support to bypass certificate validation</p>
</li>
<li>
<p>Added support to use a certificate for https communications using Microsoft&#8217;s httpclient factory</p>
</li>
</ul>
</div>
</li>
<li>
<p>Unit of Work</p>
<div class="ulist">
<ul>
<li>
<p>Repository classes unified and reviewed for increasing performance and reduce the consumed memory</p>
</li>
<li>
<p>Added support for different database servers: In memory, Cosmos, MySQL + MariaDB, Firebird, PostgreSQL, Oracle, SQLite, Access, MS Local.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4node-4"><a class="anchor" href="#devon4node-4"></a>41.84. devon4node</h3>
<div class="paragraph">
<p>The following changes have been incorporated in devon4node:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TypeScript 3.6.3.</p>
</li>
<li>
<p>Based on Nest framework.</p>
</li>
<li>
<p>Complete backend implementation.</p>
</li>
<li>
<p>New devon4node CLI. It will provide you some commands</p>
<div class="ulist">
<ul>
<li>
<p>new: create a new devon4node interactively</p>
</li>
<li>
<p>generate: generate code based on schematics</p>
</li>
<li>
<p>db: manage the database</p>
</li>
</ul>
</div>
</li>
<li>
<p>New devon4node schematics</p>
<div class="ulist">
<ul>
<li>
<p>application: create a new devon4node application</p>
</li>
<li>
<p>config-module: add a configuration module to the project</p>
</li>
<li>
<p>mailer: install and configure the devon4node mailer module</p>
</li>
<li>
<p>typeorm: install TypeORM in the project</p>
</li>
<li>
<p>auth-jwt: add users and auth-jwt modules to the project</p>
</li>
<li>
<p>swagger: expose an endpoint with the auto-generated swagger</p>
</li>
<li>
<p>security: add cors and other security headers to the project.</p>
</li>
<li>
<p>crud: create all CRUD for an entity</p>
</li>
<li>
<p>entity: create an entity</p>
</li>
</ul>
</div>
</li>
<li>
<p>New mailer module</p>
</li>
<li>
<p>New common library</p>
</li>
<li>
<p>Build in winston logger</p>
</li>
<li>
<p>Custom ClassSerializerInterceptor</p>
</li>
<li>
<p>Extendable base entity</p>
</li>
<li>
<p>New application samples</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cobigen-7"><a class="anchor" href="#cobigen-7"></a>41.85. CobiGen</h3>
<div class="ulist">
<ul>
<li>
<p>CobiGen core new features:</p>
<div class="ulist">
<ul>
<li>
<p>CobiGen CLI: Update command implemented. Now you will be able to update easily all your CobiGen plug-ins and templates inside the CLI. Please take a look into the <a href="https://github.com/devonfw/cobigen/wiki/howto_Cobigen-CLI-generation">documentation</a> for more info.</p>
<div class="ulist">
<ul>
<li>
<p>CobiGen CLI is now JDK11 compatible.</p>
</li>
<li>
<p>CobiGen CLI commandlet for devonfw-ide has been added. You can use it to setup easily your CLI and to run CobiGen related commands.</p>
</li>
<li>
<p>Added a version provider so that you will be able to know all the CobiGen plug-ins versions.</p>
</li>
<li>
<p>Added a process bar when the CLI is downloading the CobiGen plug-ins.</p>
</li>
</ul>
</div>
</li>
<li>
<p>CobiGen refactoring finished: With this refactoring we have been able to decouple CobiGen completely from the target and input language. This facilitates the creation of parsers and mergers for any language. For more information please take a look <a href="https://github.com/devonfw/cobigen/wiki/howto_create-external-plugin">here</a>.</p>
<div class="ulist">
<ul>
<li>
<p>New TypeScript input reader: We are now able to parse any TypeScript class and generate code using the parsed information. We currently use <a href="https://github.com/typeorm/typeorm/blob/master/docs/entities.md#what-is-entity">TypeORM</a> entities as a base for generation.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Improving CobiGen templates:</p>
<div class="ulist">
<ul>
<li>
<p>Updated devon4ng-NgRx templates to NgRx 8.</p>
</li>
<li>
<p>Generation of an Angular client using as input a <a href="https://github.com/typeorm/typeorm/blob/master/docs/entities.md#what-is-entity">TypeORM</a> entity. This is possible thanks to the new TypeScript input reader.</p>
</li>
<li>
<p>.Net templates have been upgraded to .Net Core 3.0</p>
</li>
</ul>
</div>
</li>
<li>
<p>CobiGen for Eclipse is now JDK11 compatible.</p>
</li>
<li>
<p>Fixed bugs when adapting templates and other bugs on the CobiGen core.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-shop-floor-3"><a class="anchor" href="#devonfw-shop-floor-3"></a>41.86. devonfw shop floor</h3>
<div class="ulist">
<ul>
<li>
<p>Added devon4ng OpenShift templates</p>
</li>
<li>
<p>Added devon4j OpenShift templates</p>
</li>
<li>
<p>Added devon4node OpenShift templates</p>
</li>
<li>
<p>Added more methods to link <a href="https://github.com/devonfw-forge/devon-production-line-shared-lib" class="bare">https://github.com/devonfw-forge/devon-production-line-shared-lib</a> [devonfw Production Line shared library]</p>
</li>
<li>
<p>Updated link: <a href="https://github.com/devonfw-forge/devon-production-line">devonfw Production Line templates</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cicdgen"><a class="anchor" href="#cicdgen"></a>41.87. ==  cicdgen</h3>
<div class="ulist">
<ul>
<li>
<p>Patched minor bugs</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="sonar-devon4j-plugin-4"><a class="anchor" href="#sonar-devon4j-plugin-4"></a>41.88. sonar-devon4j-plugin</h3>
<div class="paragraph">
<p>sonar-devon4j-plugin is a SonarQube plugin for architecture governance of devon4j applications. It verifies the architecture and conventions of devon4j, the Java stack of devonfw. The following changes have been incorporated:
* Plugin was renamed from sonar-devon-plugin to sonar-devon4j-plugin
* Rules/checks have been added to verify naming conventions
* New rule for proper JPA datatype mapping
* Proper tagging of rules as architecture-violation and not as bug, etc.
* Several improvements have been made to prepare the plugin to enter the SonarQube marketplace, what will happen with the very next release.
* Details can be found here: <a href="https://github.com/devonfw/sonar-devon4j-plugin/milestone/2?closed=1" class="bare">https://github.com/devonfw/sonar-devon4j-plugin/milestone/2?closed=1</a></p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="devonfw-release-notes-3-1-goku"><a class="anchor" href="#devonfw-release-notes-3-1-goku"></a>41.89. devonfw Release notes 3.1 “Goku”</h3>

</div>
<div class="sect2">
<h3 id="introduction-22"><a class="anchor" href="#introduction-22"></a>41.90. Introduction</h3>
<div class="paragraph">
<p>We are proud to announce the immediate release of devonfw version 3.1 (code named “Goku” during development). This version is the first one that implements our new documentation workflow, that will allow users to get the updated documentation at any moment and not to wait for the next devonfw release.</p>
</div>
<div class="paragraph">
<p>This is now possible as we have established a new workflow and rules during development of our assets. The idea behind this is that all the repositories contain a <code>documentation</code> folder and, in any pull request, the developer must include the related documentation change. A new Travis CI configuration added to all these repositories will automatically take the changes and publish them in the wiki section of every repository and in the new devonfw-guide repository that consolidates all the changes from all the repositories. Another pipeline will take changes from this consolidated repository and generate dynamically the devonfw guide in PDF and in the next weeks in HTML for the new planned devonfw website. The following schema explains this process:</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/documentation_workflow.png"><img src="_images/images/documentation_workflow.png" alt="documentation workflow"></a>
</div>
</div>
<div class="paragraph">
<p>This release includes the very first version of the new CobiGen CLI. Now using commands, you will be able to generate code the same way as you do with Eclipse. This means that you can use CobiGen on other IDEs like Visual Studio Code or IntelliJ. Please take a look at <a href="https://github.com/devonfw/cobigen/wiki/howto_Cobigen-CLI-generation" class="bare">https://github.com/devonfw/cobigen/wiki/howto_Cobigen-CLI-generation</a> for more info.</p>
</div>
<div class="paragraph">
<p>The devonfw-shop-floor project has got a lot of updates in order to make even easier the creation of devonfw projects with CICD pipelines that run on the Production Line, deploy on Red Hat OpenShift Clusters and in general Docker environments. See the details below.</p>
</div>
<div class="paragraph">
<p>This release includes the very first version of our devonfw-ide tool that will allow users to automate devonfw setup and update the development environment. This tool will become the default devonfw setup tool in future releases. For more information please visit the repository <a href="https://github.com/devonfw/devon-ide" class="bare">https://github.com/devonfw/devon-ide</a>.</p>
</div>
<div class="paragraph">
<p>Following the same collaboration model we used in order to improve the integration of devonfw with Red Hat OpenShift and which allowed us to get the Red Hat Open Shift Primed certification, we have been working alongside with SAP HANA developers in order to support this database in the devon4j. This model was based on the contribution and review of pull requests in our reference application My Thai Star. In this case, SAP developers collaborated with us in the following two new use cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prediction of future demand</p>
</li>
<li>
<p>Geospatial analysis and clustering of customers</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More info at <a href="https://blogs.sap.com/2019/06/17/introducing-devonfw-support-for-sap-hana/" class="bare">https://blogs.sap.com/2019/06/17/introducing-devonfw-support-for-sap-hana/</a>.</p>
</div>
<div class="paragraph">
<p>Last but not least the devonfw extension pack for VS Code has been improved with the latest extensions and helpers for this IDE. Among many others you can now use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Remote development on Docker containers and VMs <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack" class="bare">https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack</a></p>
</li>
<li>
<p>Dependency Analysis for maven and npm <a href="https://marketplace.visualstudio.com/items?itemName=redhat.fabric8-analytics" class="bare">https://marketplace.visualstudio.com/items?itemName=redhat.fabric8-analytics</a></p>
</li>
<li>
<p>React Native Tools <a href="https://marketplace.visualstudio.com/items?itemName=msjsdiag.vscode-react-native" class="bare">https://marketplace.visualstudio.com/items?itemName=msjsdiag.vscode-react-native</a></p>
</li>
<li>
<p>NgRx Snippets <a href="https://marketplace.visualstudio.com/itemdetails?itemName=hardikpthv.NgRxSnippets" class="bare">https://marketplace.visualstudio.com/itemdetails?itemName=hardikpthv.NgRxSnippets</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also it is worth the try of the updated support for Java and Spring Boot development in VS Code. Check it out for yourself!</p>
</div>
<div class="paragraph">
<p>More information at <a href="https://marketplace.visualstudio.com/items?itemName=devonfw.devonfw-extension-pack" class="bare">https://marketplace.visualstudio.com/items?itemName=devonfw.devonfw-extension-pack</a>. Also, you can contribute to this extension in this GitHub repository <a href="https://github.com/devonfw/devonfw-extension-pack-vscode" class="bare">https://github.com/devonfw/devonfw-extension-pack-vscode</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="changes-and-new-features-2"><a class="anchor" href="#changes-and-new-features-2"></a>41.91. Changes and new features</h3>

</div>
<div class="sect2">
<h3 id="devonfw-dist"><a class="anchor" href="#devonfw-dist"></a>41.92. Devonfw dist</h3>
<div class="ulist">
<ul>
<li>
<p>Eclipse 2018.12 integrated</p>
<div class="ulist">
<ul>
<li>
<p>CheckStyle Plugin updated.</p>
</li>
<li>
<p>SonarLint Plugin updated.</p>
</li>
<li>
<p>Git Plugin updated.</p>
</li>
<li>
<p>FindBugs Plugin updated.</p>
</li>
<li>
<p>CobiGen plugin updated.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Other Software</p>
<div class="ulist">
<ul>
<li>
<p>Visual Studio Code latest version included and pre-configured with the devonfw Platform Extension Pack.</p>
</li>
<li>
<p>Ant updated to latest.</p>
</li>
<li>
<p>Maven updated to latest.</p>
</li>
<li>
<p>Java updated to latest.</p>
</li>
<li>
<p>Nodejs LTS updated to latest.</p>
</li>
<li>
<p>@angular/cli included.</p>
</li>
<li>
<p>@devonfw/cicdgen included.</p>
</li>
<li>
<p>Yarn package manager updated.</p>
</li>
<li>
<p>Python3 updated.</p>
</li>
<li>
<p>Spyder3 IDE integrated in python3 installation updated.</p>
</li>
<li>
<p>devon4ng-application-template for Angular 8 at workspaces/examples</p>
</li>
<li>
<p>devon4ng-ionic-application-template for Ionic 4 at workspace/samples</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="my-thai-star-sample-application-2"><a class="anchor" href="#my-thai-star-sample-application-2"></a>41.93. My Thai Star Sample Application</h3>
<div class="paragraph">
<p>The new release of My Thai Star has focused on the following improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Release 3.1.0.</p>
</li>
<li>
<p>devon4j:</p>
<div class="ulist">
<ul>
<li>
<p>devon4j 3.1.0 integrated.</p>
</li>
<li>
<p>Spring Boot 2.1.6 integrated.</p>
</li>
<li>
<p>SAP 4/HANA prediction use case.</p>
</li>
<li>
<p>Bug fixes.</p>
</li>
</ul>
</div>
</li>
<li>
<p>devon4ng:</p>
<div class="ulist">
<ul>
<li>
<p>SAP 4/HANA prediction use case.</p>
</li>
<li>
<p>2FA toggleable (two factor authentication).</p>
</li>
<li>
<p>NgRx integration in process (PR #234).</p>
</li>
</ul>
</div>
</li>
<li>
<p>devon4node</p>
<div class="ulist">
<ul>
<li>
<p>TypeScript 3.1.3.</p>
</li>
<li>
<p>Based on Nest framework.</p>
</li>
<li>
<p>Aligned with devon4j.</p>
</li>
<li>
<p>Complete backend implementation.</p>
</li>
<li>
<p>TypeORM integrated with SQLite database configuration.</p>
</li>
<li>
<p>Webpack bundler.</p>
</li>
<li>
<p>Nodemon runner.</p>
</li>
<li>
<p>Jest unit tests.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Mr.Checker</p>
<div class="ulist">
<ul>
<li>
<p>Example cases for end-to-end test.</p>
</li>
<li>
<p>Production line configuration.</p>
</li>
<li>
<p>CICD</p>
</li>
<li>
<p>Improved integration with Production Line</p>
</li>
<li>
<p>New Traefik load balancer and reverse proxy</p>
</li>
<li>
<p>New deployment from artifact</p>
</li>
<li>
<p>New CICD pipelines</p>
</li>
<li>
<p>New deployment pipelines</p>
</li>
<li>
<p>Automated creation of pipelines in Jenkins</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="documentation-updates-2"><a class="anchor" href="#documentation-updates-2"></a>41.94. Documentation updates</h3>
<div class="paragraph">
<p>This release addresses the new documentation workflow, being now possible to keep the documentation synced with any change. The new documentation includes the following contents:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Getting started</p>
</li>
<li>
<p>Contribution guide</p>
</li>
<li>
<p>Devcon</p>
</li>
<li>
<p>Release notes</p>
</li>
<li>
<p>devon4j documentation</p>
</li>
<li>
<p>devon4ng documentation</p>
</li>
<li>
<p>devon4net documentation</p>
</li>
<li>
<p>devonfw-shop-floor documentation</p>
</li>
<li>
<p>cicdgen documentation</p>
</li>
<li>
<p>devonfw testing with MrChecker</p>
</li>
<li>
<p>My Thai Star documentation</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4j-7"><a class="anchor" href="#devon4j-7"></a>41.95. devon4j</h3>
<div class="paragraph">
<p>The following changes have been incorporated in devon4j:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Added Support for Java8 up to Java11</p>
</li>
<li>
<p>Upgrade to Spring Boot 2.1.6.</p>
</li>
<li>
<p>Upgrade to Spring 5.1.8</p>
</li>
<li>
<p>Upgrade to JPA 2.2</p>
</li>
<li>
<p>Upgrade to Hibernate 5.3</p>
</li>
<li>
<p>Upgrade to Dozer 6.4.1 (ATTENTION: Requires Migration, use devon-ide for automatic upgrade)</p>
</li>
<li>
<p>Many improvements to documentation (added JDK guide, architecture-mapping, JMS, etc.)</p>
</li>
<li>
<p>Completed support (JSON, Beanmapping) for pagination, IdRef, and java.time</p>
</li>
<li>
<p>Added MasterCto</p>
</li>
<li>
<p>For all details see <a href="https://github.com/devonfw/devon4j/milestone/3?closed=1">milestone</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4ng-6"><a class="anchor" href="#devon4ng-6"></a>41.96. devon4ng</h3>
<div class="paragraph">
<p>The following changes have been incorporated in devon4ng:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Angular CLI 8,</p>
</li>
<li>
<p>Angular 8,</p>
</li>
<li>
<p>Angular Material 8,</p>
</li>
<li>
<p>Ionic 4,</p>
</li>
<li>
<p>Capacitor 1.0 as Cordova replacement,</p>
</li>
<li>
<p>NgRx 8 support for State Management,</p>
</li>
<li>
<p>devon4ng Angular application template updated to Angular 8 with visual improvements and bugfixes <a href="https://github.com/devonfw/devon4ng-application-template" class="bare">https://github.com/devonfw/devon4ng-application-template</a></p>
</li>
<li>
<p>devon4ng Ionic application template updated and improved <a href="https://github.com/devonfw/devon4ng-ionic-application-template" class="bare">https://github.com/devonfw/devon4ng-ionic-application-template</a></p>
</li>
<li>
<p>New devon4ng Angular application template with state management using Angular 8 and NgRx 8 <a href="https://github.com/devonfw/devon4ng-ngrx-template" class="bare">https://github.com/devonfw/devon4ng-ngrx-template</a></p>
</li>
<li>
<p>New devon4ng library <a href="https://github.com/devonfw/devon4ng-library" class="bare">https://github.com/devonfw/devon4ng-library</a> that includes the following libraries:</p>
<div class="ulist">
<ul>
<li>
<p>Cache Module for Angular 7+ projects.</p>
</li>
<li>
<p>Authorization Module for Angular 7+ projects.</p>
</li>
</ul>
</div>
</li>
<li>
<p>New use cases with documentation and samples:</p>
<div class="ulist">
<ul>
<li>
<p>Web Components with Angular Elements</p>
</li>
<li>
<p>Initial configuration with App Initializer pattern</p>
</li>
<li>
<p>Error Handling</p>
</li>
<li>
<p>PWA with Angular and Ionic</p>
</li>
<li>
<p>Lazy Loading</p>
</li>
<li>
<p>Library construction</p>
</li>
<li>
<p>Layout with Angular Material</p>
</li>
<li>
<p>Theming with Angular Material</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4net-4"><a class="anchor" href="#devon4net-4"></a>41.97. devon4net</h3>
<div class="paragraph">
<p>The following changes have been incorporated in devon4net:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>New circuit breaker component to communicate microservices via HTTP</p>
</li>
<li>
<p>Resolved the update packages issue</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="appsec-quick-solution-guide"><a class="anchor" href="#appsec-quick-solution-guide"></a>41.98. AppSec Quick Solution Guide</h3>
<div class="paragraph">
<p>This release incorporates a new Solution Guide for Application Security based on the state of the art in OWASP based application security. The purpose of this guide is to offer quick solutions for common application security issues for all applications based on devonfw. It’s often the case that we need our systems to comply to certain sets of security requirements and standards. Each of these requirements needs to be understood, addressed and converted to code or project activity. We want this guide to prevent the wheel from being reinvented over and over again and to give clear hints and solutions to common security problems.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The wiki can be accessed here: <a href="https://github.com/devonfw/devonfw-security/wiki" class="bare">https://github.com/devonfw/devonfw-security/wiki</a></p>
</li>
<li>
<p>The PDF can be accessed here: <a href="https://github.com/devonfw/devonfw-security" class="bare">https://github.com/devonfw/devonfw-security</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cobigen-8"><a class="anchor" href="#cobigen-8"></a>41.99. CobiGen</h3>
<div class="ulist">
<ul>
<li>
<p>CobiGen core new features:</p>
<div class="ulist">
<ul>
<li>
<p>CobiGen CLI: New command line interface for CobiGen. Using commands, you will be able to generate code the same way as you do with Eclipse. This means that you can use CobiGen on other IDEs like Visual Studio Code or IntelliJ. Please take a look into the documentation for more info.</p>
<div class="ulist">
<ul>
<li>
<p>Performance improves greatly in the CLI thanks to the lack of GUI.</p>
</li>
<li>
<p>You will be able to use path globs for selecting multiple input files.</p>
</li>
<li>
<p>We have implemented a search functionality so that you can easily search for increments or templates.</p>
</li>
</ul>
</div>
</li>
<li>
<p>First steps taken on CobiGen refactoring: With the new refactoring we will be able to decouple CobiGen completely from the target and input language. This will facilitate the creation of parsers and mergers for any language.</p>
<div class="ulist">
<ul>
<li>
<p>NashornJS has been deprecated: It was used for executing JavaScript code inside JVM. With the refactoring, performance has improved on the TypeScript merger.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Improving CobiGen templates:</p>
<div class="ulist">
<ul>
<li>
<p>Removed Covalent from Angular templates as it is not compatible with Angular 8.</p>
</li>
<li>
<p>Added devon4ng-NgRx templates that implement reactive state management. Note: The TypeScript merger is currently being improved in order to accept NgRx. The current templates are set as overridable by default.</p>
</li>
<li>
<p>Test data builder templates now make use of Lambdas and Consumers.</p>
</li>
<li>
<p>CTOs and ETOs increments have been correctly separated.</p>
</li>
</ul>
</div>
</li>
<li>
<p>TypeScript merger has been improved: Now it is possible to merge comments (like tsdoc) and enums.</p>
</li>
<li>
<p>OpenAPI parsing extended to read enums. Also fixed some bugs when no properties were set or when URLs were too short.</p>
</li>
<li>
<p>Java static and object initializers now get merged.</p>
</li>
<li>
<p>Fixed bugs when downloading and adapting templates.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devcon"><a class="anchor" href="#devcon"></a>41.100. Devcon</h3>
<div class="paragraph">
<p>A new version of Devcon has been released. Fixes and new features include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Updated to match current devon4j</p>
</li>
<li>
<p>Update to download Linux distribution.</p>
</li>
<li>
<p>Custom modules creation improvements.</p>
</li>
<li>
<p>Code Migration feature added.</p>
</li>
<li>
<p>Bugfixes.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-oss-modules"><a class="anchor" href="#devonfw-oss-modules"></a>41.101. Devonfw OSS Modules</h3>
<div class="paragraph">
<p>Modules upgraded to be used in new devon4j projects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reporting module</p>
</li>
<li>
<p>WinAuth AD Module</p>
</li>
<li>
<p>WinAuth SSO Module</p>
</li>
<li>
<p>I18n Module</p>
</li>
<li>
<p>Async Module</p>
</li>
<li>
<p>Integration Module</p>
</li>
<li>
<p>Microservice Module</p>
</li>
<li>
<p>Compose for Redis Module
See: <a href="https://github.com/devonfw/devon/wiki#devonfw-modules" class="bare">https://github.com/devonfw/devon/wiki#devonfw-modules</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-shop-floor-4"><a class="anchor" href="#devonfw-shop-floor-4"></a>41.102. devonfw shop floor</h3>
<div class="ulist">
<ul>
<li>
<p>Industrialization oriented to configure the provisioning environment provided by Production Line and deploy applications on an OpenShift cluster.</p>
</li>
<li>
<p>Added Jenkinsfiles to configure automatically OpenShift environments to deploy devonfw applications.</p>
</li>
<li>
<p>Industrialization to start new projects and configure them with CICD.</p>
</li>
<li>
<p>Upgrade the documentation with getting started guide to configure CICD in any devonfw project and deploy it.</p>
</li>
<li>
<p>Added new tool cicdgen to generate CICD code/files.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cicdgen-2"><a class="anchor" href="#cicdgen-2"></a>41.103. ==  cicdgen</h3>
<div class="paragraph">
<p>cicdgen is a devonfw tool to generate all code/files related to CICD in your project. It&#8217;s based on angular schematics and it has its own CLI.
More information <a href="https://github.com/devonfw/cicdgen">here</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CICD configuration for devon4j, devon4ng and devon4node projects</p>
</li>
<li>
<p>Option to deploy devonfw projects with Docker</p>
</li>
<li>
<p>Option to deploy devonfw projects with OpenShift</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-testing"><a class="anchor" href="#devonfw-testing"></a>41.104. Devonfw Testing</h3>

</div>
<div class="sect2">
<h3 id="mr-checker"><a class="anchor" href="#mr-checker"></a>41.105. ==  Mr.Checker</h3>
<div class="paragraph">
<p>The Mr.Checker Test Framework is an automated testing framework for functional testing of web applications, API web services, Service Virtualization, Security and in coming future native mobile apps, and databases. All modules have tangible examples of how to build resilient integration test cases based on delivered functions. Mr.Checker updates and improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Examples available under embedded project “MrChecker-App-Under-Test” and in project wiki: <a href="https://github.com/devonfw/devonfw-testing/wiki" class="bare">https://github.com/devonfw/devonfw-testing/wiki</a></p>
</li>
<li>
<p>How to install:</p>
<div class="ulist">
<ul>
<li>
<p>Wiki : <a href="https://github.com/devonfw/devonfw-testing/wiki/How-to-install" class="bare">https://github.com/devonfw/devonfw-testing/wiki/How-to-install</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Release Note:</p>
<div class="ulist">
<ul>
<li>
<p>module selenium - 3.8.2.1:</p>
<div class="ulist">
<ul>
<li>
<p>possibility to define version of driver in properties.file</p>
</li>
<li>
<p>automatic driver download if the version is not specified</p>
</li>
<li>
<p>possibility to run with different browser options</p>
</li>
<li>
<p>module webAPI – 1.2.1:</p>
</li>
<li>
<p>possibility to connect to the remote WireMock server</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="devonfw-release-notes-3-0-fry"><a class="anchor" href="#devonfw-release-notes-3-0-fry"></a>41.106. devonfw Release notes 3.0 “Fry”</h3>

</div>
<div class="sect2">
<h3 id="introduction-23"><a class="anchor" href="#introduction-23"></a>41.107. Introduction</h3>
<div class="paragraph">
<p>We are proud to announce the immediate release of devonfw version 3.0 (code named “Fry” during development). This version is the consolidation of Open Source, focused on the major namespace change ever in the platform, removing the OASP references and adopting the new devonfw names for each technical stack or framework.</p>
</div>
<div class="paragraph">
<p>The new stack names are the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>devon4j, former devon4j, is the new name for Java.</p>
</li>
<li>
<p>devon4ng, former devon4ng, is the new one for Angular.</p>
</li>
<li>
<p>devon4net, is the new .NET stack.</p>
</li>
<li>
<p>devon4X, is the new stack for Xamarin development.</p>
</li>
<li>
<p>devon4node, is the new devonfw incubator for node.js.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The new devon4j version was created directly from the latest devon4j version (3.0.0). Hence it brings all the features and values that devon4j offered. However, the namespace migration was used to do some housekeeping and remove deprecated code as well as reduce dependencies. Therefore your data-access layer will no longer have to depend on any third party except for devon4j as well as of course the JPA. We also have improved the application template that now comes with a modern JSON logging ready for docker and logstash based environments.</p>
</div>
<div class="paragraph">
<p>To help you upgrading we introduced a migration feature in devcon. This can automatically migrate your code from devon4j (even older versions starting from 2.4.0) to the latest version of devon4j. There might be some small manual changes left to do but 90% of the migration will be done automatically for you.</p>
</div>
<div class="paragraph">
<p>Besides, the first version of the devonfw plugin for SonarQube has been released. It extends SonarQube with the ability to validate your code according to the devon4j architecture. More details at <a href="https://github.com/devonfw/sonar-devon-plugin" class="bare">https://github.com/devonfw/sonar-devon-plugin</a>.</p>
</div>
<div class="paragraph">
<p>This is the first release that integrates the new devonfw .NET framework, called devon4net, and Xamarin for mobile native development, devon4X. devon4NET and devon4X are the Capgemini standard frameworks for .NET and Xamarin software development. With the two new family members devonfw provides guidance and acceleration for the major software development platforms in our industry. Their interoperability provides you the assurance your multichannel solution will be consistent across web and mobile channels.</p>
</div>
<div class="paragraph">
<p>“Fry” release contains lots of improvements in our Mr.Checker E2E Testing Framework, including a complete E2E sample inside our reference application My Thai Star. Besides Mr.Checker, we include as an incubator Testar, a test tool (and framework)  to test applications at the GUI level whose objective is to solve part of the maintenance problem affecting tests by automatically generating test cases based on a structure that is automatically derived from the GUI. Testar is not included to replace Mr.Checker but rather to provide development teams with a series of interesting options which go beyond what Mr.Checker already provides.</p>
</div>
<div class="paragraph">
<p>Apart from Mr.Checker, engagements can now use Testar as an extra option for testing. This is a tool that enables the automated system testing of desktop, web and mobile applications at the GUI level. Testar has been added as an incubator to the platform awaiting further development during 2019.</p>
</div>
<div class="paragraph">
<p>The new incubator for node.js, called devon4node, has been included and implemented in several internal projects. This incubator is based on the Nest framework <a href="https://www.nestjs.com/" class="bare">https://www.nestjs.com/</a>. Nest is a framework for building efficient, scalable Node.js server-side applications. It uses progressive JavaScript, is built with TypeScript (preserves compatibility with pure JavaScript) and combines elements of OOP (Object Oriented Programming), FP (Functional Programming), and FRP (Functional Reactive Programming). Under the hood, Nest makes use of Express, but also provides compatibility with a wide range of other libraries (e.g. Fastify). This allows for easy use of the myriad third-party plugins which are available.</p>
</div>
<div class="paragraph">
<p>In order to facilitate the utilization of Microsoft Visual Studio Code in devonfw, we have developed and included the new devonfw Platform Extension Pack with lots of features to develop and test applications with this IDE in languages and frameworks such as TypeScript, JavaScript, .NET, Java, Rust, C++ and many more. More information at <a href="https://marketplace.visualstudio.com/items?itemName=devonfw.devonfw-extension-pack" class="bare">https://marketplace.visualstudio.com/items?itemName=devonfw.devonfw-extension-pack</a>. Also, you can contribute to this extension in this GitHub repository <a href="https://github.com/devonfw/devonfw-extension-pack-vscode" class="bare">https://github.com/devonfw/devonfw-extension-pack-vscode</a>.</p>
</div>
<div class="paragraph">
<p>There is a whole range of new features and improvements which can be seen in that light. The My Thai Star sample app has now been upgraded to devon4j and devon4ng, a new devon4node backend implementation has been included that is seamless interchangeable, an E2E MrChecker sample project, CICD and deployment scripts and lots of bugs have been fixed.</p>
</div>
<div class="paragraph">
<p>Last but not least, the projects wikis and the devonfw Guide has once again been updated accordingly before the big refactor that will be addressed in the following release in 2019.</p>
</div>
</div>
<div class="sect2">
<h3 id="changes-and-new-features-3"><a class="anchor" href="#changes-and-new-features-3"></a>41.108. Changes and new features</h3>

</div>
<div class="sect2">
<h3 id="devonfw-dist-2"><a class="anchor" href="#devonfw-dist-2"></a>41.109. Devonfw dist</h3>
<div class="ulist">
<ul>
<li>
<p>Eclipse 2018.9 integrated</p>
<div class="ulist">
<ul>
<li>
<p>CheckStyle Plugin updated.</p>
</li>
<li>
<p>SonarLint Plugin updated.</p>
</li>
<li>
<p>Git Plugin updated.</p>
</li>
<li>
<p>FindBugs Plugin updated.</p>
</li>
<li>
<p>CobiGen plugin updated.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Other Software</p>
<div class="ulist">
<ul>
<li>
<p>Visual Studio Code latest version included and pre-configured with the devonfw Platform Extension Pack.</p>
</li>
<li>
<p>Ant updated to latest.</p>
</li>
<li>
<p>Maven updated to latest.</p>
</li>
<li>
<p>Java updated to latest.</p>
</li>
<li>
<p>Nodejs LTS updated to latest.</p>
</li>
<li>
<p>@angular/cli included.</p>
</li>
<li>
<p>Yarn package manager updated.</p>
</li>
<li>
<p>Python3 updated.</p>
</li>
<li>
<p>Spyder3 IDE integrated in python3 installation updated.</p>
</li>
<li>
<p>devon4ng-application-template for Angular 7 at workspaces/examples</p>
</li>
<li>
<p>devon4ng-ionic-application-template for Ionic 3.20 at workspace/samples</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="my-thai-star-sample-application-3"><a class="anchor" href="#my-thai-star-sample-application-3"></a>41.110. My Thai Star Sample Application</h3>
<div class="paragraph">
<p>The new release of My Thai Star has focused on the following improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Release 1.12.2.</p>
</li>
<li>
<p>devon4j:</p>
<div class="ulist">
<ul>
<li>
<p>devon4j 3.0.0 integrated.</p>
</li>
<li>
<p>Spring Boot 2.0.4 integrated.</p>
</li>
<li>
<p>Spring Data integration.</p>
</li>
<li>
<p>New pagination and search system.</p>
</li>
<li>
<p>Bug fixes.</p>
</li>
</ul>
</div>
</li>
<li>
<p>devon4ng:</p>
<div class="ulist">
<ul>
<li>
<p>Client devon4ng updated to Angular 7.</p>
</li>
<li>
<p>Angular Material and Covalent UI frameworks updated.</p>
</li>
<li>
<p>Electron framework integrated.</p>
</li>
</ul>
</div>
</li>
<li>
<p>devon4node</p>
<div class="ulist">
<ul>
<li>
<p>TypeScript 3.1.3.</p>
</li>
<li>
<p>Based on Nest framework.</p>
</li>
<li>
<p>Aligned with devon4j.</p>
</li>
<li>
<p>Complete backend implementation.</p>
</li>
<li>
<p>TypeORM integrated with SQLite database configuration.</p>
</li>
<li>
<p>Webpack bundler.</p>
</li>
<li>
<p>Nodemon runner.</p>
</li>
<li>
<p>Jest unit tests.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Mr.Checker</p>
<div class="ulist">
<ul>
<li>
<p>Example cases for end-to-end test.</p>
</li>
<li>
<p>Production line configuration.</p>
</li>
<li>
<p>CICD</p>
</li>
<li>
<p>Improved integration with Production Line</p>
</li>
<li>
<p>New deployment from artifact</p>
</li>
<li>
<p>New CICD pipelines</p>
</li>
<li>
<p>New deployment pipelines</p>
</li>
<li>
<p>Automated creation of pipelines in Jenkins</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="documentation-updates-3"><a class="anchor" href="#documentation-updates-3"></a>41.111. Documentation updates</h3>
<div class="paragraph">
<p>The following contents in the devonfw guide have been updated:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Upgrade of all the new devonfw named assets.</p>
<div class="ulist">
<ul>
<li>
<p>devon4j</p>
</li>
<li>
<p>devon4ng</p>
</li>
<li>
<p>Mr.Checker</p>
</li>
</ul>
</div>
</li>
<li>
<p>Electron integration cookbook.</p>
</li>
<li>
<p>Updated cookbook about Swagger.</p>
</li>
<li>
<p>Removed deprecated entries.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Apart from this the documentation has been reviewed and some typos and errors have been fixed.</p>
</div>
<div class="paragraph">
<p>The current development of the guide has been moved to <a href="https://github.com/devonfw-forge/devon-guide/wiki" class="bare">https://github.com/devonfw-forge/devon-guide/wiki</a> in order to be available as the rest of OSS assets.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4j-8"><a class="anchor" href="#devon4j-8"></a>41.112. devon4j</h3>
<div class="paragraph">
<p>The following changes have been incorporated in devon4j:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Spring Boot 2.0.4 Integrated.</p>
</li>
<li>
<p>Spring Data layer Integrated.</p>
</li>
<li>
<p>Decouple mmm.util.*</p>
</li>
<li>
<p>Removed depreciated restaurant sample.</p>
</li>
<li>
<p>Updated Pagination support for Spring Data</p>
</li>
<li>
<p>Add support for hana as dbType.</p>
</li>
<li>
<p>Bugfixes.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4ng-7"><a class="anchor" href="#devon4ng-7"></a>41.113. devon4ng</h3>
<div class="paragraph">
<p>The following changes have been incorporated in devon4ng:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>New client application architecture guide <a href="https://github.com/devonfw/devon4ng/wiki" class="bare">https://github.com/devonfw/devon4ng/wiki</a></p>
</li>
<li>
<p>Angular CLI 7,</p>
</li>
<li>
<p>Angular 7,</p>
</li>
<li>
<p>Angular Material 7 and Covalent 2.0.0-beta.7,</p>
</li>
<li>
<p>Ionic 3.20.0,</p>
</li>
<li>
<p>Cordova 8.0.0,</p>
</li>
<li>
<p>devon4ng Angular application template updated to Angular 7 with visual improvements and bugfixes <a href="https://github.com/devonfw/devon4ng-application-template" class="bare">https://github.com/devonfw/devon4ng-application-template</a></p>
</li>
<li>
<p>devon4ng Ionic application template updated and improved <a href="https://github.com/devonfw/devon4ng-ionic-application-template" class="bare">https://github.com/devonfw/devon4ng-ionic-application-template</a></p>
</li>
<li>
<p>PWA enabled.</p>
</li>
<li>
<p>Electron integrated to run My Thai Star as a desktop application in Windows, Linux or macOS.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4net-5"><a class="anchor" href="#devon4net-5"></a>41.114. devon4net</h3>
<div class="paragraph">
<p>Some of the highlights of devon4net 1.0 are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>External configuration file for each environment.</p>
</li>
<li>
<p>.NET Core 2.1.X working solution (Latest 2.1.402).</p>
</li>
<li>
<p>Packages and solution templates published on nuget.org.</p>
</li>
<li>
<p>Full components customization by config file.</p>
</li>
<li>
<p>Docker ready (My Thai Star sample fully working on docker).</p>
</li>
<li>
<p>Port specification by configuration.</p>
</li>
<li>
<p>Dependency injection by Microsoft .NET Core.</p>
</li>
<li>
<p>Automapper support.</p>
</li>
<li>
<p>Entity framework ORM (Unit of work, async methods).</p>
</li>
<li>
<p>.NET Standard library 2.0 ready.</p>
</li>
<li>
<p>Multi-platform support: Windows, Linux, Mac.</p>
</li>
<li>
<p>Samples: My Thai Star back-end, Google API integration, Azure login, AOP with Castle.</p>
</li>
<li>
<p>Documentation site.</p>
</li>
<li>
<p>SPA page support.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And included the following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Logging:</p>
<div class="ulist">
<ul>
<li>
<p>Text File.</p>
</li>
<li>
<p>Sqlite database support.</p>
</li>
<li>
<p>Serilog Seq Server support.</p>
</li>
<li>
<p>Graylog integration ready through TCP/UDP/HTTP protocols.</p>
</li>
<li>
<p>API Call params interception (simple and compose objects).</p>
</li>
<li>
<p>API error exception management.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Swagger:</p>
<div class="ulist">
<ul>
<li>
<p>Swagger auto generating client from comments and annotations on controller classes.</p>
</li>
<li>
<p>Full swagger client customization (Version, Title, Description, Terms, License, Json endpoint definition).</p>
</li>
</ul>
</div>
</li>
<li>
<p>JWT:</p>
<div class="ulist">
<ul>
<li>
<p>Issuer, audience, token expiration customization by external file configuration.</p>
</li>
<li>
<p>Token generation via certificate.</p>
</li>
<li>
<p>MVC inherited classes to access JWT user properties.</p>
</li>
<li>
<p>API method security access based on JWT Claims.</p>
</li>
</ul>
</div>
</li>
<li>
<p>CORS:</p>
<div class="ulist">
<ul>
<li>
<p>Simple CORS definition ready.</p>
</li>
<li>
<p>Multiple CORS domain origin definition with specific headers and verbs.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Headers:</p>
<div class="ulist">
<ul>
<li>
<p>Automatic header injection with middleware.</p>
</li>
<li>
<p>Supported header definitions: AccessControlExposeHeader, StrictTransportSecurityHeader, XFrameOptionsHeader, XssProtectionHeader, XContentTypeOptionsHeader, ContentSecurityPolicyHeader, PermittedCrossDomainPoliciesHeader, ReferrerPolicyHeader.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Reporting server:</p>
<div class="ulist">
<ul>
<li>
<p>Partial implementation of reporting server based on My-FyiReporting (now runs on linux container).</p>
</li>
</ul>
</div>
</li>
<li>
<p>Testing:</p>
<div class="ulist">
<ul>
<li>
<p>Integration test template with sqlite support.</p>
</li>
<li>
<p>Unit test template.</p>
</li>
<li>
<p>Moq, xunit frameworks integrated.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4x"><a class="anchor" href="#devon4x"></a>41.115. devon4X</h3>
<div class="paragraph">
<p>Some of the highlights of the new devonfw Xamarin framework are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Based on Excalibur framework by Hans Harts (<a href="https://github.com/Xciles/Excalibur" class="bare">https://github.com/Xciles/Excalibur</a>).</p>
</li>
<li>
<p>Updated to latest MVVMCross 6 version.</p>
</li>
<li>
<p>My Thai Star Excalibur forms sample.</p>
</li>
<li>
<p>Xamarin Forms template available on nuget.org.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="appsec-quick-solution-guide-2"><a class="anchor" href="#appsec-quick-solution-guide-2"></a>41.116. AppSec Quick Solution Guide</h3>
<div class="paragraph">
<p>This release incorporates a new Solution Guide for Application Security based on the state of the art in OWASP based application security. The purpose of this guide is to offer quick solutions for common application security issues for all applications based on devonfw.  It’s often the case that we need our systems to comply to certain sets of security requirements and standards. Each of these requirements needs to be understood, addressed and converted to code or project activity. We want this guide to prevent the wheel from being reinvented over and over again and to give clear hints and solutions to common security problems.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The wiki can be accessed here: <a href="https://github.com/devonfw/devonfw-security/wiki" class="bare">https://github.com/devonfw/devonfw-security/wiki</a></p>
</li>
<li>
<p>The PDF can be accessed here: <a href="https://github.com/devonfw/devonfw-security" class="bare">https://github.com/devonfw/devonfw-security</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cobigen-9"><a class="anchor" href="#cobigen-9"></a>41.117. CobiGen</h3>
<div class="ulist">
<ul>
<li>
<p>CobiGen core new features:</p>
<div class="ulist">
<ul>
<li>
<p>CobiGen_Templates will not need to be imported into the workspace anymore. However, If you want to adapt them, you can still click on a button that automatically imports them for you.</p>
</li>
<li>
<p>CobiGen_Templates can be updated by one-click whenever the user wants to have the latest version.</p>
</li>
<li>
<p>Added the possibility to reference external increments on configuration level. This is used for reducing the number of duplicated templates.</p>
</li>
</ul>
</div>
</li>
<li>
<p>CobiGen_Templates project and docs updated:</p>
<div class="ulist">
<ul>
<li>
<p>Spring standard has been followed better than ever.</p>
</li>
<li>
<p>Interface templates get automatically relocated to the api project. Needed for following the new devon4j standard.</p>
</li>
</ul>
</div>
</li>
<li>
<p>CobiGen Angular:</p>
<div class="ulist">
<ul>
<li>
<p>Angular 7 generation improved based on the updated application template.</p>
</li>
<li>
<p>Pagination changed to fit Spring standard.</p>
</li>
</ul>
</div>
</li>
<li>
<p>CobiGen Ionic: Pagination changed to fit Spring standard.</p>
</li>
<li>
<p>CobiGen OpenAPI plugin released with multiple bug-fixes and other functionalities like:</p>
<div class="ulist">
<ul>
<li>
<p>Response and parameter types are parsed properly when they are a reference to an entity.</p>
</li>
<li>
<p>Parameters defined on the body of a request are being read correctly.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devcon-2"><a class="anchor" href="#devcon-2"></a>41.118. Devcon</h3>
<div class="paragraph">
<p>A new version of Devcon has been released. Fixes and new features include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Updated to match current devon4j</p>
</li>
<li>
<p>Update to download Linux distribution.</p>
</li>
<li>
<p>Custom modules creation improvements.</p>
</li>
<li>
<p>Code Migration feature added</p>
</li>
<li>
<p>Bugfixes.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-oss-modules-2"><a class="anchor" href="#devonfw-oss-modules-2"></a>41.119. Devonfw OSS Modules</h3>
<div class="paragraph">
<p>Modules upgraded to be used in new devon4j projects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reporting module</p>
</li>
<li>
<p>WinAuth AD Module</p>
</li>
<li>
<p>WinAuth SSO Module</p>
</li>
<li>
<p>I18n Module</p>
</li>
<li>
<p>Async Module</p>
</li>
<li>
<p>Integration Module</p>
</li>
<li>
<p>Microservice Module</p>
</li>
<li>
<p>Compose for Redis Module</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/devonfw/devon/wiki#devonfw-modules" class="bare">https://github.com/devonfw/devon/wiki#devonfw-modules</a></p>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-testing-2"><a class="anchor" href="#devonfw-testing-2"></a>41.120. Devonfw Testing</h3>

</div>
<div class="sect2">
<h3 id="mr-checker-2"><a class="anchor" href="#mr-checker-2"></a>41.121. ==  Mr.Checker</h3>
<div class="paragraph">
<p>The Mr.Checker Test Framework is an automated testing framework for functional testing of web applications, API web services, Service Virtualization, Security and in coming future native mobile apps, and databases. All modules have tangible examples of how to build resilient integration test cases based on delivered functions. Mr.Checker updates and improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Examples available under embedded project “MrChecker-App-Under-Test” and in project wiki: <a href="https://github.com/devonfw/devonfw-testing/wiki" class="bare">https://github.com/devonfw/devonfw-testing/wiki</a></p>
</li>
<li>
<p>How to install:</p>
<div class="ulist">
<ul>
<li>
<p>Wiki : <a href="https://github.com/devonfw/devonfw-testing/wiki/How-to-install" class="bare">https://github.com/devonfw/devonfw-testing/wiki/How-to-install</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Release Note:</p>
<div class="ulist">
<ul>
<li>
<p>module selenium - 3.8.1.13:</p>
<div class="ulist">
<ul>
<li>
<p>headless browser</p>
</li>
<li>
<p>enable browser options</p>
</li>
</ul>
</div>
</li>
<li>
<p>module DevOps :</p>
<div class="ulist">
<ul>
<li>
<p>Jenkinsfile align with ProductionLine</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="testar"><a class="anchor" href="#testar"></a>41.122. ==  Testar</h3>
<div class="paragraph">
<p>We have added Test*, Testar, as an incubator to the available test tools within devonfw. This ground-breaking tool is being developed by the Technical University of Valencia (UPV). In 2019 Capgemini will co-develop Testar with the UPV.</p>
</div>
<div class="paragraph">
<p>Testar is a tool that enables the automated system testing of desktop, web and mobile applications at the GUI level.</p>
</div>
<div class="paragraph">
<p>With Testar, you can start testing immediately. It automatically generates and executes test sequences based on a structure that is automatically derived from the UI through the accessibility API. Testar can detect the violation of general-purpose system requirements and you can use plugins to customize your tests.</p>
</div>
<div class="paragraph">
<p>You do not need test scripts and maintenance of it. The tests are random and are generated and executed automatically.</p>
</div>
<div class="paragraph">
<p>If you need to do directed tests you can create scripts to test specific requirements of your application.</p>
</div>
<div class="paragraph">
<p>Testar is included in the devonfw distro or can be downloaded from <a href="https://testar.org/download/" class="bare">https://testar.org/download/</a>.</p>
</div>
<div class="paragraph">
<p>The Github repository can be found at o: <a href="https://github.com/TESTARtool/TESTAR" class="bare">https://github.com/TESTARtool/TESTAR</a>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="devonfw-release-notes-2-4-eve"><a class="anchor" href="#devonfw-release-notes-2-4-eve"></a>41.123. devonfw Release notes 2.4 “EVE”</h3>

</div>
<div class="sect2">
<h3 id="introduction-24"><a class="anchor" href="#introduction-24"></a>41.124. Introduction</h3>
<div class="paragraph">
<p>We are proud to announce the immediate release of devonfw version 2.4 (code named “EVE” during development). This version is the first one that fully embraces Open Source, including components like the documentation assets and CobiGen. Most of the IP (Intellectual Property or proprietary) part of devonfw are now published under the Apache License version 2.0 (with the documentation under the Creative Commons License (Attribution-NoDerivatives)). This includes the GitHub repositories where all the code and documentation is located. All of these repositories are now open for public viewing as well.</p>
</div>
<div class="paragraph">
<p>“EVE” contains a slew of new features but in essence it is already driven by what we expect to be the core focus of 2018: strengthening the platform and improving quality.</p>
</div>
<div class="paragraph">
<p>This release is also fully focused on deepening the platform rather than expanding it. That is to say: we have worked on improving existing features rather than adding new ones and strengthen the qualitative aspects of the software development life cycle, i.e. security, testing, infrastructure (CI, provisioning) etc.</p>
</div>
<div class="paragraph">
<p>“EVE” already is very much an example of this. This release contains the Allure Test Framework (included as an incubator in version 2.3) update called MrChecker Test Framework. MrChecker is an automated testing framework for functional testing of web applications, API web services, Service Virtualization, Security and in coming future native mobile apps, and databases. All modules have tangible examples of how to build resilient integration test cases based on delivered functions.</p>
</div>
<div class="paragraph">
<p>Another incubator being updated is the devonfw Shop Floor which intended to be a compilation of DevOps experiences from the devonfw perspective. A new part of the release is the new Solution Guide for Application Security based on the state of the art in OWASP based application security.</p>
</div>
<div class="paragraph">
<p>There is a whole range of new features and improvements which can be seen in that light. devon4j 2.6 changes and improves the package structure of the core Java framework. The My Thai Star sample app has now been upgraded to Angular 6, lots of bugs have been fixed and the devonfw Guide has once again been improved.</p>
</div>
<div class="paragraph">
<p>Last but not least, this release contains the formal publication of the devonfw Methodology or The Accelerated Solution Design - an Industry Standards based solution design and specification (documentation) methodology for Agile (and less-than-agile) projects.</p>
</div>
</div>
<div class="sect2">
<h3 id="changes-and-new-features-4"><a class="anchor" href="#changes-and-new-features-4"></a>41.125. Changes and new features</h3>

</div>
<div class="sect2">
<h3 id="devonfw-2-4-is-open-source"><a class="anchor" href="#devonfw-2-4-is-open-source"></a>41.126. devonfw 2.4 is Open Source</h3>
<div class="paragraph">
<p>This version is the first release of devonfw that fully embraces Open Source, including components like the documentation assets and CobiGen. This is done in response to intensive market pressure and demands from the MU´s (Public Sector France, Netherlands)</p>
</div>
<div class="paragraph">
<p>Most of the IP (Intellectual Property or proprietary) part of devonfw are now published under the Apache License version 2.0 (with the documentation under the Creative Commons License (Attribution-NoDerivatives)).</p>
</div>
<div class="paragraph">
<p>So you can now use the devonfw distribution (the "zip" file), CobiGen, the devonfw modules and all other components without any worry to expose the client unwittingly to Capgemini IP.</p>
</div>
<div class="paragraph">
<p><strong>Note:</strong> there are still some components which are IP and are not published under an OSS license. The class room trainings, the Sencha components and some CobiGen templates. But these are not includes in the distribution nor documentation and are now completely maintained separately.</p>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-dist-3"><a class="anchor" href="#devonfw-dist-3"></a>41.127. devonfw dist</h3>
<div class="ulist">
<ul>
<li>
<p>Eclipse Oxygen integrated</p>
<div class="ulist">
<ul>
<li>
<p>CheckStyle Plugin updated.</p>
</li>
<li>
<p>SonarLint Plugin updated.</p>
</li>
<li>
<p>Git Plugin updated.</p>
</li>
<li>
<p>FindBugs Plugin updated.</p>
</li>
<li>
<p>CobiGen plugin updated.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Other Software</p>
<div class="ulist">
<ul>
<li>
<p>Visual Studio Code latest version included and pre-configured with <a href="https://devonfw.com/website/pages/docs/cli.adoc.html#vscode.adoc" class="bare">https://devonfw.com/website/pages/docs/cli.adoc.html#vscode.adoc</a></p>
</li>
<li>
<p>Ant updated to latest.</p>
</li>
<li>
<p>Maven updated to latest.</p>
</li>
<li>
<p>Java updated to latest.</p>
</li>
<li>
<p>Nodejs LTS updated to latest.</p>
</li>
<li>
<p>@angular/cli included.</p>
</li>
<li>
<p>Yarn package manager updated.</p>
</li>
<li>
<p>Python3 updated.</p>
</li>
<li>
<p>Spyder3 IDE integrated in python3 installation updated.</p>
</li>
<li>
<p>devon4ng-application-template for Angular 6 at workspaces/examples</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="my-thai-star-sample-application-4"><a class="anchor" href="#my-thai-star-sample-application-4"></a>41.128. My Thai Star Sample Application</h3>
<div class="paragraph">
<p>The new release of My Thai Star has focused on the following improvements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Release 1.6.0.</p>
</li>
<li>
<p>Travis CI integration with Docker. Now we get a valuable feedback of the current status and when collaborators make pull requests.</p>
</li>
<li>
<p>Docker compose deployment.</p>
</li>
<li>
<p>devon4j:</p>
<div class="ulist">
<ul>
<li>
<p>Flyway upgrade from 3.2.1 to 4.2.0</p>
</li>
<li>
<p>Bug fixes.</p>
</li>
</ul>
</div>
</li>
<li>
<p>devon4ng:</p>
<div class="ulist">
<ul>
<li>
<p>Client devon4ng updated to Angular 6.</p>
</li>
<li>
<p>Frontend translated into 9 languages.</p>
</li>
<li>
<p>Improved mobile and tablet views.</p>
</li>
<li>
<p>Routing fade animations.</p>
</li>
<li>
<p>Compodoc included to generate dynamically frontend documentation.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="documentation-updates-4"><a class="anchor" href="#documentation-updates-4"></a>41.129. Documentation updates</h3>
<div class="paragraph">
<p>The following contents in the devonfw guide have been updated:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>devonfw OSS modules documentation.</p>
</li>
<li>
<p>Creating a new devon4j application.</p>
</li>
<li>
<p>How to update Angular CLI in devonfw.</p>
</li>
<li>
<p>Include Angular i18n.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Apart from this the documentation has been reviewed and some typos and errors have been fixed.</p>
</div>
<div class="paragraph">
<p>The current development of the guide has been moved to <a href="https://github.com/devonfw/devonfw-guide/wiki" class="bare">https://github.com/devonfw/devonfw-guide/wiki</a> in order to be available as the rest of OSS assets.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4j-9"><a class="anchor" href="#devon4j-9"></a>41.130. devon4j</h3>
<div class="paragraph">
<p>The following changes have been incorporated in devon4j:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Integrate batch with archetype.</p>
</li>
<li>
<p>Application module structure and dependencies improved.</p>
</li>
<li>
<p>Issues with Application Template fixed.</p>
</li>
<li>
<p>Solved issue where Eclipse maven template devon4j-template-server version 2.4.0 produced pom with missing dependency spring-boot-starter-jdbc.</p>
</li>
<li>
<p>Solved datasource issue with project archetype 2.4.0.</p>
</li>
<li>
<p>Decouple archetype from sample (restaurant).</p>
</li>
<li>
<p>Upgrade to Flyway 4.</p>
</li>
<li>
<p>Fix for issue with Java 1.8 and QueryDSL #599.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4ng-8"><a class="anchor" href="#devon4ng-8"></a>41.131. devon4ng</h3>
<div class="paragraph">
<p>The following changes have been incorporated in devon4ng:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First version of the new client application architecture guide <a href="https://github.com/devonfw/devon4ng/wiki/meta-architecture#devonfw-reference-client-architecture" class="bare">https://github.com/devonfw/devon4ng/wiki/meta-architecture#devonfw-reference-client-architecture</a></p>
</li>
<li>
<p>Angular CLI 6,</p>
</li>
<li>
<p>Angular 6,</p>
</li>
<li>
<p>Angular Material 6 and Covalent 2.0.0-beta.1,</p>
</li>
<li>
<p>Ionic 3.20.0,</p>
</li>
<li>
<p>Cordova 8.0.0,</p>
</li>
<li>
<p>devon4ng Angular application template updated to Angular 6 with visual improvements and bugfixes <a href="https://github.com/devonfw/devon4ng-application-template" class="bare">https://github.com/devonfw/devon4ng-application-template</a></p>
</li>
<li>
<p>devon4ng Ionic application template updated and improved <a href="https://github.com/devonfw/devon4ng-ionic-application-template" class="bare">https://github.com/devonfw/devon4ng-ionic-application-template</a></p>
</li>
<li>
<p>PWA enabled.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="appsec-quick-solution-guide-3"><a class="anchor" href="#appsec-quick-solution-guide-3"></a>41.132. AppSec Quick Solution Guide</h3>
<div class="paragraph">
<p>This release incorporates a new Solution Guide for Application Security based on the state of the art in OWASP based application security. The purpose of this guide is to offer quick solutions for common application security issues for all applications based on devonfw.  It’s often the case that we need our systems to comply to certain sets of security requirements and standards. Each of these requirements needs to be understood, addressed and converted to code or project activity. We want this guide to prevent the wheel from being reinvented over and over again and to give clear hints and solutions to common security problems.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The wiki can be accessed here: <a href="https://github.com/devonfw/devonfw-security/wiki" class="bare">https://github.com/devonfw/devonfw-security/wiki</a></p>
</li>
<li>
<p>The PDF can be accessed here: <a href="https://github.com/devonfw/devonfw-security" class="bare">https://github.com/devonfw/devonfw-security</a></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="cobigen-10"><a class="anchor" href="#cobigen-10"></a>41.133. CobiGen</h3>
<div class="ulist">
<ul>
<li>
<p>CobiGen_Templates project and docs updated.</p>
</li>
<li>
<p>CobiGen Angular 6 generation improved based on the updated application template</p>
</li>
<li>
<p>CobiGen Ionic CRUD App generation based on Ionic application template. Although a first version was already implemented, it has been deeply improved:</p>
<div class="ulist">
<ul>
<li>
<p>Changed the code structure to comply with Ionic standards.</p>
</li>
<li>
<p>Added pagination.</p>
</li>
<li>
<p>Pull-to-refresh, swipe and attributes header implemented.</p>
</li>
<li>
<p>Code documented and JSDoc enabled (similar to Javadoc)</p>
</li>
</ul>
</div>
</li>
<li>
<p>CobiGen TSPlugin Interface Merge support.</p>
</li>
<li>
<p>CobiGen XML plugin comes out with new cool features:</p>
<div class="ulist">
<ul>
<li>
<p>Enabled the use of XPath within variable assignment. You can now retrieve almost any data from an XML file and store it on a variable for further processing on the templates. Documented here.</p>
</li>
<li>
<p>Able to generate multiple output files per XML input file.</p>
</li>
<li>
<p>Generating code from UML diagrams. XMI files (standard XML for UML) can be now read and processed. This means that you can develop templates and generate code from an XMI like class diagrams.</p>
</li>
</ul>
</div>
</li>
<li>
<p>CobiGen OpenAPI plugin released with multiple bug-fixes and other functionalities like:</p>
<div class="ulist">
<ul>
<li>
<p>Assigning global and local variables is now possible. Therefore you can set any string for further processing on the templates. For instance, changing the root package name of the generated files. Documented here.</p>
</li>
<li>
<p>Enabled having a class with more than one relationship to another class (more than one property of the same type).</p>
</li>
</ul>
</div>
</li>
<li>
<p>CobiGen Text merger plugin has been extended and now it is able to merge text blocks. This means, for example, that the generation and merging of adoc documentation is possible. Documented here.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devcon-3"><a class="anchor" href="#devcon-3"></a>41.134. Devcon</h3>
<div class="paragraph">
<p>A new version of Devcon has been released. Fixes and new features include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Now Devcon is OSS, with public repository at <a href="https://github.com/devonfw/devcon" class="bare">https://github.com/devonfw/devcon</a></p>
</li>
<li>
<p>Updated to match current devon4j</p>
</li>
<li>
<p>Update to download Linux distribution.</p>
</li>
<li>
<p>Custom modules creation improvements.</p>
</li>
<li>
<p>Bugfixes.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-oss-modules-3"><a class="anchor" href="#devonfw-oss-modules-3"></a>41.135. devonfw OSS Modules</h3>
<div class="ulist">
<ul>
<li>
<p>Existing devonfw IP modules have been moved to OSS.</p>
<div class="ulist">
<ul>
<li>
<p>They can now be accessed in any devon4j project as optional dependencies from Maven Central.</p>
</li>
<li>
<p>The repository now has public access <a href="https://github.com/devonfw/devon" class="bare">https://github.com/devonfw/devon</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Starters available for modules:</p>
<div class="ulist">
<ul>
<li>
<p>Reporting module</p>
</li>
<li>
<p>WinAuth AD Module</p>
</li>
<li>
<p>WinAuth SSO Module</p>
</li>
<li>
<p>I18n Module</p>
</li>
<li>
<p>Async Module</p>
</li>
<li>
<p>Integration Module</p>
</li>
<li>
<p>Microservice Module</p>
</li>
<li>
<p>Compose for Redis Module</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/devonfw/devon/wiki#devonfw-modules" class="bare">https://github.com/devonfw/devon/wiki#devonfw-modules</a></p>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-shop-floor-5"><a class="anchor" href="#devonfw-shop-floor-5"></a>41.136. devonfw Shop Floor</h3>
<div class="ulist">
<ul>
<li>
<p>devonfw Shop Floor 4 Docker</p>
<div class="ulist">
<ul>
<li>
<p>Docker-based CICD environment</p>
<div class="ulist">
<ul>
<li>
<p>docker-compose.yml (installation file)</p>
</li>
<li>
<p>dsf4docker.sh (installation script)</p>
</li>
<li>
<p>Service Integration (documentation in Wiki)</p>
</li>
</ul>
</div>
</li>
<li>
<p>devonfw projects build and deployment with Docker</p>
<div class="ulist">
<ul>
<li>
<p>Dockerfiles (multi-stage building)</p>
<div class="ulist">
<ul>
<li>
<p>Build artifact (NodeJS for Angular and Maven for Java)</p>
</li>
<li>
<p>Deploy built artifact (NGINX for Angular and Tomcat for Java)</p>
</li>
<li>
<p>NGINX Reverse-Proxy to redirect traffic between both Angular client and Java server containers.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>devonfw Shop Floor 4 OpenShift</p>
<div class="ulist">
<ul>
<li>
<p>devonfw projects deployment in OpenShift cluster</p>
<div class="ulist">
<ul>
<li>
<p>s2i images</p>
</li>
<li>
<p>OpenShift templates</p>
</li>
<li>
<p>Video showcase (OpenShift Origin 3.6)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This incubator is intended to be a compilation of DevOps experiences from the devonfw perspective. “How we use our devonfw projects in DevOps environments”. Integration with the Production Line, creation and service integration of a Docker-based CI environment and deploying devonfw applications in an OpenShift Origin cluster using devonfw templates.
See: <a href="https://github.com/devonfw/devonfw-shop-floor" class="bare">https://github.com/devonfw/devonfw-shop-floor</a></p>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-testing-3"><a class="anchor" href="#devonfw-testing-3"></a>41.137. devonfw Testing</h3>
<div class="paragraph">
<p>The MrChecker Test Framework is an automated testing framework for functional testing of web applications, API web services, Service Virtualization, Security and in coming future native mobile apps, and databases. All modules have tangible examples of how to build resilient integration test cases based on delivered functions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Examples available under embedded project “MrChecker-App-Under-Test” and in project wiki: <a href="https://github.com/devonfw/devonfw-testing/wiki" class="bare">https://github.com/devonfw/devonfw-testing/wiki</a></p>
</li>
<li>
<p>How to install:</p>
<div class="ulist">
<ul>
<li>
<p>Wiki : <a href="https://github.com/devonfw/devonfw-testing/wiki/How-to-install" class="bare">https://github.com/devonfw/devonfw-testing/wiki/How-to-install</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Release Note:</p>
<div class="ulist">
<ul>
<li>
<p>module core - 4.12.0.8:</p>
<div class="ulist">
<ul>
<li>
<p>fixes on getting Environment values</p>
</li>
<li>
<p>top notch example how to keep vulnerable data in repo , like passwords</p>
</li>
</ul>
</div>
</li>
<li>
<p>module selenium - 3.8.1.8:</p>
<div class="ulist">
<ul>
<li>
<p>browser driver auto downloader</p>
</li>
<li>
<p>list of out off the box examples to use in any web page</p>
</li>
</ul>
</div>
</li>
<li>
<p>module webAPI - ver. 1.0.2 :</p>
<div class="ulist">
<ul>
<li>
<p>api service virtualization with REST and SOAP examples</p>
</li>
<li>
<p>api service virtualization with dynamic arguments</p>
</li>
<li>
<p>REST working test examples with page object model</p>
</li>
</ul>
</div>
</li>
<li>
<p>module security - 1.0.1 (security tests against My Thai Start)</p>
</li>
<li>
<p>module DevOps :</p>
<div class="ulist">
<ul>
<li>
<p>dockerfile for Test environment execution</p>
</li>
<li>
<p>CI + CD as Jenkinsfile code</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-methodology-accelerated-solution-design"><a class="anchor" href="#devonfw-methodology-accelerated-solution-design"></a>41.138. devonfw methodology: Accelerated Solution Design</h3>
<div class="paragraph">
<p>One of the prime challenges in Distributed Agile Delivery is the maintenance of a common understanding and unity of intent among all participants in the process of creating a product. That is: how can you guarantee that different parties in the client, different providers, all in different locations and time zones during a particular period of time actually understand the requirements of the client, the proposed solution space and the state of implementation.</p>
</div>
<div class="paragraph">
<p>We offer the Accelerated Solution Design as a possible answer to these challenges. The ASD is carefully designed to be a practical guideline that fosters and ensures the collaboration and communication among all team members.</p>
</div>
<div class="paragraph">
<p>The Accelerated Solution Design is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A practical guideline rather than a “methodology”</p>
</li>
<li>
<p>Based on industry standards rather than proprietary methods</p>
</li>
<li>
<p>Consisting of an evolving, “living”, document set rather than a static, fixed document</p>
</li>
<li>
<p>Encapsulating the business requirements, functional definitions as well as Architecture design</p>
</li>
<li>
<p>Based on the intersection of Lean, Agile, DDD and User Story Mapping</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And further it is based on the essential belief or paradigm that ASD should be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Focused on the design (definition) of the “externally observable behavior of a system”</p>
</li>
<li>
<p>Promoting communication and collaboration between team members</p>
</li>
<li>
<p>Guided by prototypes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more on the devonfw Methodology / ASD, see:
<a href="https://github.com/devonfw/devon-methodology/blob/master/design-guidelines/Accelerated_Solution_Design.adoc" class="bare">https://github.com/devonfw/devon-methodology/blob/master/design-guidelines/Accelerated_Solution_Design.adoc</a></p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="devonfw-release-notes-2-3-dash"><a class="anchor" href="#devonfw-release-notes-2-3-dash"></a>41.139. devonfw Release notes 2.3 "Dash"</h3>

</div>
<div class="sect2">
<h3 id="release-improving-and-strengthening-the-platform"><a class="anchor" href="#release-improving-and-strengthening-the-platform"></a>41.140. Release: improving and strengthening the Platform</h3>
<div class="paragraph">
<p>We are proud to announce the immediate release of <strong>devonfw version 2.3</strong> (code named “<em>Dash</em>” during development).  This release comes with a bit of a delay as we decided to wait for the publication of devon4j 2.5. “Dash” contains a slew of new features but in essence it is already driven by what we expect to be the core focus of 2018: strengthening the platform and improving quality.</p>
</div>
<div class="paragraph">
<p>After one year and a half of rapid expansion, we expect the next release(s) of the devonfw 2.x series to be fully focused on deepening the platform rather than expanding it. That is to say: we should work on improving existing features rather than adding new ones and strengthen the qualitative aspects of the software development life cycle, i.e. testing, infrastructure (CI, provisioning) etc.</p>
</div>
<div class="paragraph">
<p>“Dash” already is very much an example of this. This release contains the Allure Test Framework as an incubator. This is an automated testing framework for functional testing of web applications. Another incubator is the devonfw Shop Floor which intended to be a compilation of DevOps experiences from the devonfw perspective. And based on this devonfw has been <em>OpenShift Primed</em> (“certified”) by Red Hat.</p>
</div>
<div class="paragraph">
<p>There is a whole range of new features and improvements which can be seen in that light. devon4j 2.5 changes and improves the package structure of the core Java framework. The My Thai Star sample app has now been fully integrated in the different frameworks and the devonfw Guide has once again been significantly expanded and improved.</p>
</div>
</div>
<div class="sect2">
<h3 id="an-industrialized-platform-for-the-adcenter"><a class="anchor" href="#an-industrialized-platform-for-the-adcenter"></a>41.141. An industrialized platform for the ADcenter</h3>
<div class="paragraph">
<p>Although less visible to the overall devonfw community, an important driving force was (meaning that lots of work has been done in the context of) the creation of the ADcenter concept towards the end of 2017. Based on a radical transformation of on/near/offshore software delivery, the focus of the ADcenters is to deliver agile &amp; accelerated “Rightshore” services with an emphasis on:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Delivering Business Value and optimized User Experience</p>
</li>
<li>
<p>Innovative software development with state of the art technology</p>
</li>
<li>
<p>Highly automated devops; resulting in lower costs &amp; shorter time-to-market</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first two ADcenters, in Valencia (Spain) and Bangalore (India), are already servicing clients all over Europe - Germany, France, Switzerland  and the Netherlands - while ADcenter aligned production teams are currently working for Capgemini UK as well (through Spain).Through the ADcenter, Capgemini establishes industrialized innovation; designed for &amp; with the user. The availability of platforms for industrialized software delivery like devonfw and the Production Line has allowed us to train and make available over a 150 people in very short time.</p>
</div>
<div class="paragraph">
<p>The creation of the ADcenter is such a short time is visible proof that we´re getting closer to a situation where devonfw and Production Line are turning into the default development platform for APPS2, thereby standardizing all aspects of the software development life cycle: from training and design, architecture, devops and development,  all the way up to QA and deployment.</p>
</div>
</div>
<div class="sect2">
<h3 id="changes-and-new-features-5"><a class="anchor" href="#changes-and-new-features-5"></a>41.142. Changes and new features</h3>

</div>
<div class="sect2">
<h3 id="devonfw-dist-4"><a class="anchor" href="#devonfw-dist-4"></a>41.143. devonfw dist</h3>
<div class="paragraph">
<p>The <strong>devonfw dist</strong>, or distribution, i.e. the central zip file which contains the main working environment for the devonfw developer, has been significantly enhanced. New features include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Eclipse Oxygen integrated</p>
<div class="ulist">
<ul>
<li>
<p>CheckStyle Plugin installed and configured</p>
</li>
<li>
<p>SonarLint Plugin installed and configured</p>
</li>
<li>
<p>Git Plugin installed</p>
</li>
<li>
<p>FindBugs replaced by SpotBugs and configured</p>
</li>
<li>
<p>Tomcat8 specific Oxygen configuration</p>
</li>
<li>
<p>CobiGen Plugin installed</p>
</li>
</ul>
</div>
</li>
<li>
<p>Other Software</p>
<div class="ulist">
<ul>
<li>
<p>Cmder integrated (when console.bat launched)</p>
</li>
<li>
<p>Visual Studio Code latest version included and pre-configured with <a href="https://github.com/devonfw/extension-pack-vscode" class="bare">https://github.com/devonfw/extension-pack-vscode</a></p>
</li>
<li>
<p>Ant updated to latest.</p>
</li>
<li>
<p>Maven updated to latest.</p>
</li>
<li>
<p>Java updated to latest.</p>
</li>
<li>
<p>Nodejs LTS updated to latest.</p>
</li>
<li>
<p>@angular/cli included.</p>
</li>
<li>
<p>Yarn package manager included.</p>
</li>
<li>
<p>Python3 integrated</p>
</li>
<li>
<p>Spyder3 IDE integrated in python3 installation</p>
</li>
<li>
<p>devon4ng-application-template for Angular5 at workspaces/examples</p>
</li>
<li>
<p>Devon4sencha starter templates updated</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devon4j-2-5"><a class="anchor" href="#devon4j-2-5"></a>41.144. devon4j 2.5</h3>

</div>
<div class="sect2">
<h3 id="support-for-jax-rs-jax-ws-clients"><a class="anchor" href="#support-for-jax-rs-jax-ws-clients"></a>41.145. ==  Support for JAX-RS &amp; JAX-WS clients</h3>
<div class="paragraph">
<p>With the aim to enhance the ease in consuming RESTful and SOAP web services, JAX-RS and JAX-WS clients have been introduced. They enable developers to concisely and efficiently implement portable client-side solutions that leverage existing and well-established client-side HTTP connector implementations. Furthermore, the getting started time for consuming web services has been considerably reduced with the default configuration out-of-the-box which can be tweaked as per individual project requirements.</p>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/devonfw/devon4j/issues/358" class="bare">https://github.com/devonfw/devon4j/issues/358</a></p>
</div>
</div>
<div class="sect2">
<h3 id="separate-security-logs-for-devon4j-log-component"><a class="anchor" href="#separate-security-logs-for-devon4j-log-component"></a>41.146. ==  Separate security logs for devon4j log component</h3>
<div class="paragraph">
<p>Based on OWASP(Open Web Application Security Project), devon4j aims to give developers more control and flexibility with the logging of security events and tracking of forensic information. Furthermore, it helps classifying the information in log messages and applying masking when necessary. It provides powerful security features while based on set of logging APIs developers are already familiar with over a decade of their experience with Log4J and its successors.</p>
</div>
</div>
<div class="sect2">
<h3 id="support-for-microservices"><a class="anchor" href="#support-for-microservices"></a>41.147. ==  Support for Microservices</h3>
<div class="paragraph">
<p>Integration of an devon4j application to a Microservices environment can now be leveraged with this release of devon4j. Introduction of service clients for RESTful and SOAP web services based on Java EE give developers agility and ease to access microservices in the Devon framework. It significantly cuts down the efforts on part of developers around boilerplate code and stresses more focus on the business code improving overall efficiency and quality of deliverables.</p>
</div>
</div>
<div class="sect2">
<h3 id="cobigen-11"><a class="anchor" href="#cobigen-11"></a>41.148. Cobigen</h3>
<div class="paragraph">
<p>A new version of Cobigen has been included. New features include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Swagger/Yaml Plugin for CobiGen. CobiGen is able to read a swagger definition file that follows the OpenAPI 3.0 spec and generate code. A preliminary release was already included in 2.2.1 but the current version is much more mature and stable. See: <a href="https://github.com/devonfw/cobigen/wiki/howto_openapi_generation" class="bare">https://github.com/devonfw/cobigen/wiki/howto_openapi_generation</a></p>
</li>
<li>
<p>Integration of CobiGen into Maven build process. This already existed but has been improved. It consists mainly of documentation + better log output and bug fixes. See: <a href="https://github.com/devonfw/cobigen/wiki/cobigen-maven_configuration" class="bare">https://github.com/devonfw/cobigen/wiki/cobigen-maven_configuration</a></p>
</li>
<li>
<p>CobiGen Ionic CRUD App generation based on <a href="https://github.com/devonfw/devon4ng-ionic-application-template" class="bare">https://github.com/devonfw/devon4ng-ionic-application-template</a></p>
</li>
<li>
<p>Cobigen_Templates project and docs updated</p>
</li>
<li>
<p>Bugfixes and Hardening</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="my-thai-star-sample-application-5"><a class="anchor" href="#my-thai-star-sample-application-5"></a>41.149. My Thai Star Sample Application</h3>
<div class="paragraph">
<p>From this release on the My Thai Star application has been fully integrated in the different frameworks in the platform. Further more, a more modularized approach has been followed in the current release of My Thai star application to decouple client from implementation details. Which provides better encapsulation of code and dependency management for API and implementation classes. This has been achieved with creation of a new “API” module that contain interfaces for REST services and corresponding Request/Response objects. With existing “Core” module being dependent on “API” module. To read further you can follow the link <a href="https://github.com/devonfw/my-thai-star/wiki/java-design#basic-architecture-details" class="bare">https://github.com/devonfw/my-thai-star/wiki/java-design#basic-architecture-details</a></p>
</div>
<div class="paragraph">
<p>Furthermore: an email and Twitter micro service were integrated in my-thai-star. This is just for demonstration purposes. A full micro service framework is already part of devon4j 2.5.0</p>
</div>
</div>
<div class="sect2">
<h3 id="documentation-refactoring"><a class="anchor" href="#documentation-refactoring"></a>41.150. Documentation refactoring</h3>
<div class="paragraph">
<p>The complete devonfw guide is restructured and refactored. Getting started guides are added for easy start with devonfw.Integration of the new Tutorial with the existing devonfw Guide whereby existing chapters of the previous tutorial were converted to Cookbook chapters. Asciidoctor is used for devonfw guide PDF generation.
See: <a href="https://github.com/devonfw/devonfw-guide/wiki" class="bare">https://github.com/devonfw/devonfw-guide/wiki</a></p>
</div>
</div>
<div class="sect2">
<h3 id="devon4ng-9"><a class="anchor" href="#devon4ng-9"></a>41.151. devon4ng</h3>
<div class="paragraph">
<p>The following changes have been incorporated in devon4ng:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Angular CLI 1.6.0,</p>
</li>
<li>
<p>Angular 5.1,</p>
</li>
<li>
<p>Angular Material 5 and Covalent 1.0.0 RC1,</p>
</li>
<li>
<p>PWA enabled,</p>
</li>
<li>
<p>Core and Shared Modules included to follow the recommended Angular projects structure,</p>
</li>
<li>
<p>Yarn and NPM compliant since both lock files are included in order to get a stable installation.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="admin-interface-for-devon4j-apps"><a class="anchor" href="#admin-interface-for-devon4j-apps"></a>41.152. Admin interface for devon4j apps</h3>
<div class="paragraph">
<p>The new version includes an Integration of an admin interface for devon4j apps (Spring Boot). This module is based on CodeCentric´s Spring Boot Admin (<a href="https://github.com/codecentric/spring-boot-admin" class="bare">https://github.com/codecentric/spring-boot-admin</a>).</p>
</div>
</div>
<div class="sect2">
<h3 id="devcon-4"><a class="anchor" href="#devcon-4"></a>41.153. Devcon</h3>
<div class="paragraph">
<p>A new version of Devcon has been released. Fixes and new features include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Renaming of system Commands.</p>
</li>
<li>
<p>New menu has been added - “other modules”, if menus are more than 10, other modules will display some menus.</p>
</li>
<li>
<p>A progress bar has been added for installing the distribution</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-modules"><a class="anchor" href="#devonfw-modules"></a>41.154. devonfw Modules</h3>
<div class="paragraph">
<p>Existing devonfw modules can now be accessed with the help of starters following namespace devonfw-&lt;module_name&gt;-starter. Starters available for modules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Reporting module</p>
</li>
<li>
<p>WinAuth AD Module</p>
</li>
<li>
<p>WinAuth SSO Module</p>
</li>
<li>
<p>I18n Module</p>
</li>
<li>
<p>Async Module</p>
</li>
<li>
<p>Integration Module</p>
</li>
<li>
<p>Microservice Module</p>
</li>
<li>
<p>Compose for Redis Module</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/devonfw/devon/wiki#ip-modules" class="bare">https://github.com/devonfw/devon/wiki#ip-modules</a></p>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-shop-floor-6"><a class="anchor" href="#devonfw-shop-floor-6"></a>41.155. devonfw Shop Floor</h3>
<div class="paragraph">
<p>This incubator is intended to be a compilation of DevOps experiences from the devonfw perspective. “How we use our devonfw projects in DevOps environments”. Integration with the Production Line, creation and service integration of a Docker-based CI environment and deploying devonfw applications in an OpenShift Origin cluster using devonfw templates.</p>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/devonfw/devonfw-shop-floor" class="bare">https://github.com/devonfw/devonfw-shop-floor</a></p>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-testing-4"><a class="anchor" href="#devonfw-testing-4"></a>41.156. devonfw-testing</h3>
<div class="paragraph">
<p>The Allure Test Framework is an automated testing framework for functional testing of web applications and in coming future native mobile apps, web services and databases. All modules have tangible examples of how to build resilient integration test cases based on delivered functions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Examples available under embedded project “Allure-App-Under-Test” and in project wiki: <a href="https://github.com/devonfw/devonfw-testing/wiki" class="bare">https://github.com/devonfw/devonfw-testing/wiki</a></p>
</li>
<li>
<p>How to install: <a href="https://github.com/devonfw/devonfw-testing/wiki/How-to-install" class="bare">https://github.com/devonfw/devonfw-testing/wiki/How-to-install</a></p>
</li>
<li>
<p>Release Notes:</p>
<div class="ulist">
<ul>
<li>
<p>Core Module – ver.4.12.0.3:</p>
<div class="ulist">
<ul>
<li>
<p>Test report with logs and/or screenshots</p>
</li>
<li>
<p>Test groups/tags</p>
</li>
<li>
<p>Data Driven (inside test case, external file)</p>
</li>
<li>
<p>Test case parallel execution</p>
</li>
<li>
<p>Run on independent Operating System (Java)</p>
</li>
<li>
<p>Externalize test environment (DEV, QA, PROD)</p>
</li>
</ul>
</div>
</li>
<li>
<p>UI Selenium module – ver. 3.4.0.3:</p>
<div class="ulist">
<ul>
<li>
<p>Malleable resolution ( Remote Web Design, Mobile browsers)</p>
</li>
<li>
<p>Support for many browsers( Internet Explorer, Edge, Chrome, Firefox, Safari)</p>
</li>
<li>
<p>User friendly actions ( elementCheckBox, elementDropdown, etc. )</p>
</li>
<li>
<p>Ubiquese test execution (locally, against Selenium Grid through Jenkins)</p>
</li>
<li>
<p>Page Object Model architecture</p>
</li>
<li>
<p>Selenium WebDriver library ver. 3.4.0</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>See:  <a href="https://github.com/devonfw/devonfw-testing/wiki" class="bare">https://github.com/devonfw/devonfw-testing/wiki</a></p>
</div>
</div>
<div class="sect2">
<h3 id="dot-net-framework-incubators"><a class="anchor" href="#dot-net-framework-incubators"></a>41.157. DOT.NET Framework incubators</h3>
<div class="paragraph">
<p>The .NET Core and Xamarin frameworks are still under development by a workgroup from The Netherlands, Spain, Poland, Italy, Norway and Germany. The 1.0 release is expected to be coming soon but the current incubator frameworks are already being used in several engagements.  Some features to highlight are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Full .NET implementation with multi-platform support</p>
</li>
<li>
<p>Detailed documentation for developers</p>
</li>
<li>
<p>Docker ready</p>
</li>
<li>
<p>Web API server side template :</p>
<div class="ulist">
<ul>
<li>
<p>Swagger auto-generation</p>
</li>
<li>
<p>JWT security</p>
</li>
<li>
<p>Entity Framework Support</p>
</li>
<li>
<p>Advanced log features</p>
</li>
</ul>
</div>
</li>
<li>
<p>Xamarin Templates based on Excalibur framework</p>
</li>
<li>
<p>My Thai Star implementation:</p>
<div class="ulist">
<ul>
<li>
<p>Backend (.NET Core)</p>
</li>
<li>
<p>FrontEnd (Xamarin)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-has-been-primed-by-red-hat-for-openshift"><a class="anchor" href="#devonfw-has-been-primed-by-red-hat-for-openshift"></a>41.158. devonfw has been Primed by Red Hat for OpenShift</h3>
<div class="paragraph">
<p>OpenShift is a supported distribution of Kubernetes from Red Hat for container-based software deployment and management. It is using Docker containers and DevOps tools for accelerated application development. Using OpenShift allows Capgemini to avoid Cloud Vendor lock-in. OpenShift provides devonfw with a state of the art CI/CD environment (devonfw Shop Floor), providing devonfw with a platform for the whole development life cycle: from development to staging / deploy.</p>
</div>
<div class="paragraph">
<p>See <a href="https://hub.openshift.com/primed/120-capgemini" class="bare">https://hub.openshift.com/primed/120-capgemini</a></p>
</div>
</div>
<div class="sect2">
<h3 id="harvested-components-and-modules"><a class="anchor" href="#harvested-components-and-modules"></a>41.159. Harvested components and modules</h3>
<div class="paragraph">
<p>The devonfw Harvesting process continues to add valuable components and modules to the devonfw platform. The last months the following elements were contributed:</p>
</div>
</div>
<div class="sect2">
<h3 id="service-client-support-for-micro-service-projects"><a class="anchor" href="#service-client-support-for-micro-service-projects"></a>41.160. ==  Service Client support (for Micro service Projects).</h3>
<div class="paragraph">
<p>This client is for consuming microservices from other application.This solution is already very flexible and customizable.As of now,this is suitable for small and simple project where two or three microservices are invoked. Donated by Jörg Hohwiller. See: <a href="https://github.com/devonfw-forge/devonfw-microservices" class="bare">https://github.com/devonfw-forge/devonfw-microservices</a></p>
</div>
</div>
<div class="sect2">
<h3 id="jhipster-devonfw-code-generation"><a class="anchor" href="#jhipster-devonfw-code-generation"></a>41.161. ==  JHipster devonfw code generation</h3>
<div class="paragraph">
<p>This component was donated by the ADcenter in Valencia. It was made in order to comply with strong requirements (especially from the French BU) to use jHipster for code generation.</p>
</div>
<div class="paragraph">
<p>JHipster is a code generator based on Yeoman generators. Its default generator generator-jhipster generates a specific JHipster structure. The purpose of generator-jhipster-DevonModule is to generate the structure and files of a typical devon4j project. It is therefore equivalent to the standard devon4j application template based CobiGen code generation.</p>
</div>
</div>
<div class="sect2">
<h3 id="simple-jenkins-task-status-dashboard"><a class="anchor" href="#simple-jenkins-task-status-dashboard"></a>41.162. ==  Simple Jenkins task status dashboard</h3>
<div class="paragraph">
<p>This component has been donated by, has been harvested from system in use by, Capgemini  Valencia. This dashboard, apart from an optional gamification element, allows the display of multiple Jenkins instances.</p>
</div>
</div>
<div class="sect2">
<h3 id="and-lots-more-among-others"><a class="anchor" href="#and-lots-more-among-others"></a>41.163. And lots more, among others:</h3>
<div class="ulist">
<ul>
<li>
<p>devon4j/devonfw docker based build in a docker process.</p>
</li>
<li>
<p>CI test boot archetype. This is for unit testing.This will create a sample project and add sample web service to it. A Jenkins job will start devon4j server and will call web service.</p>
</li>
<li>
<p>CI test Angular starterTemplate. Testing automation for Angular applications (My Thai Star) in Continuous Integration environments by using Headless browsers and creating Node.js scripts. See: <a href="https://github.com/devonfw/my-thai-star/blob/develop/angular/package.json#L8-L12" class="bare">https://github.com/devonfw/my-thai-star/blob/develop/angular/package.json#L8-L12</a> and <a href="https://github.com/devonfw/my-thai-star/blob/develop/angular/karma.conf.js" class="bare">https://github.com/devonfw/my-thai-star/blob/develop/angular/karma.conf.js</a></p>
</li>
</ul>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="devonfw-release-notes-2-2-courage"><a class="anchor" href="#devonfw-release-notes-2-2-courage"></a>41.164. devonfw Release notes 2.2 "Courage"</h3>

</div>
<div class="sect2">
<h3 id="production-line-integration"><a class="anchor" href="#production-line-integration"></a>41.165. Production Line Integration</h3>
<div class="paragraph">
<p>devonfw is now fully supported on the Production Line v1.3 and the coming v2.0. Besides that, we now "eat our own dogfood" as the whole devonfw project, all "buildable assets", now run on the Production Line.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4ng-2-0"><a class="anchor" href="#devon4ng-2-0"></a>41.166. devon4ng 2.0</h3>
<div class="paragraph">
<p>The main focus of the Courage release is the renewed introduction of "devonfw for JavaScript", or devon4ng. This new version is a completely new implementation based on Angular (version 4). This new "stack" comes with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>New application templates for Angular 4 application (as well as Ionic 3)</p>
</li>
<li>
<p>A new reference application</p>
</li>
<li>
<p>A new tutorial (and Architecture Guide following soon)</p>
</li>
<li>
<p>Component Gallery</p>
</li>
<li>
<p>New CobiGen templates for generation of both Angular 4 and Ionic 3 UI components ("screens")</p>
</li>
<li>
<p>Integration of Covalent and Bootstrap offering a large number of components</p>
</li>
<li>
<p>my-thai-star, a showcase and reference implementation in Angular of a real, responsive usable app using recommended architecture and patterns</p>
</li>
<li>
<p>A new Tutorial using my-thai-star as a starting point</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See:
<a href="https://github.com/devonfw/devon4ng-application-template" class="bare">https://github.com/devonfw/devon4ng-application-template</a>
<a href="https://github.com/devonfw/my-thai-star/tree/develop/angular" class="bare">https://github.com/devonfw/my-thai-star/tree/develop/angular</a></p>
</div>
</div>
<div class="sect2">
<h3 id="new-cobigen"><a class="anchor" href="#new-cobigen"></a>41.167. New Cobigen</h3>
<div class="paragraph">
<p>Major changes in this release:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Support for multi-module projects</p>
</li>
<li>
<p>Client UI Generation:</p>
<div class="ulist">
<ul>
<li>
<p>New Angular 4 templates based on the latest - angular project seed</p>
</li>
<li>
<p>Basic Typescript Merger</p>
</li>
<li>
<p>Basic Angular Template Merger</p>
</li>
<li>
<p>JSON Merger</p>
</li>
</ul>
</div>
</li>
<li>
<p>Refactored devon4j templates to make use of Java template logic feature</p>
</li>
<li>
<p>Bugfixes:</p>
<div class="ulist">
<ul>
<li>
<p>Fixed merging of nested Java annotations including array values</p>
</li>
<li>
<p>more minor issues</p>
</li>
</ul>
</div>
</li>
<li>
<p>Under the hood:</p>
<div class="ulist">
<ul>
<li>
<p>Large refactoring steps towards language agnostic templates formatting sensitive placeholder descriptions automatically formatting camelCase to TrainCase to snake-case, etc.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Easy setup of CobiGen IDE to enable fluent contribution</p>
</li>
<li>
<p>CI integration improved to integrate with GitHub for more valuable feedback</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/devonfw/cobigen/releases" class="bare">https://github.com/devonfw/cobigen/releases</a></p>
</div>
</div>
<div class="sect2">
<h3 id="mythaistar-new-restaurant-example-reference-implementation-methodology-showcase"><a class="anchor" href="#mythaistar-new-restaurant-example-reference-implementation-methodology-showcase"></a>41.168. MyThaiStar: New Restaurant Example, reference implementation &amp; Methodology showcase</h3>
<div class="paragraph">
<p>A major part of the new devonfw release is the incorporation of a new application, "my-thai-star" which among others:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>serve as an example of how to make a "real" devonfw application (i.e. the application could be used for real)</p>
</li>
<li>
<p>Serves  as an attractive showcase</p>
</li>
<li>
<p>Serves as a reference application of devonfw patterns and practices as well as the standard example in the new devonfw tutorial</p>
</li>
<li>
<p>highlights modern security option like JWT Integration</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The application is  accompanied by a substantial new documentation asset, the devonfw methodology, which described in detail the whole lifecycle of the development of a devonfw application, from requirements gathering to technical design. Officially my-that-star is still considered to be an incubator as especially this last part is still not as mature as it could be. But the example application and tutorial are 100% complete and functional and form a marked improvement over the "old" restaurant example app. My-Thai-star will become the standard example app from devonfw 3.0 onwards.</p>
</div>
<div class="paragraph">
<p>See:     <a href="https://github.com/devonfw/my-thai-star" class="bare">https://github.com/devonfw/my-thai-star</a>
         <a href="https://github.com/devonfw/my-thai-star/wiki" class="bare">https://github.com/devonfw/my-thai-star/wiki</a></p>
</div>
</div>
<div class="sect2">
<h3 id="the-new-devonfw-tutorial"><a class="anchor" href="#the-new-devonfw-tutorial"></a>41.169. The new devonfw Tutorial</h3>
<div class="paragraph">
<p>The devonfw Tutorial is a new part of the devonfw documentation which changes the focus of how people can get started with the platform</p>
</div>
<div class="paragraph">
<p>There are tutorials for devon4j, devon4ng (Angular) and more to come. My-Thai-Star is used throughout the tutorial series to demonstrate the basic principles, architecture, and good practices of the different devonfw "stacks". There is an elaborated exercise where the readers get to write their own application "JumpTheQueue".</p>
</div>
<div class="paragraph">
<p>We hope that the new tutorial offers a better, more efficient way for people to get started with devonfw. Answering especially the question: how to make a devonfw application.</p>
</div>
<div class="paragraph">
<p>devon4j tutorial: <a href="https://devonfw.com/website/pages/docs/devon4j.asciidoc_tutorials.html" class="bare">https://devonfw.com/website/pages/docs/devon4j.asciidoc_tutorials.html</a>
devon4ng tutorial: <a href="https://github.com/devonfw/devon4ng/wiki" class="bare">https://github.com/devonfw/devon4ng/wiki</a></p>
</div>
</div>
<div class="sect2">
<h3 id="devon4j-2-4-0"><a class="anchor" href="#devon4j-2-4-0"></a>41.170. devon4j 2.4.0</h3>
<div class="paragraph">
<p>"devonfw for Java" or devon4j now includes updated versions of the latest stable versions of Spring Boot and the Spring Framework and all related dependencies. This allows guaranteed, stable, execution of any devonfw 2.X application on the latest versions of the Industry Standard Spring stack.
Another important new feature is a new testing architecture/infrastructure. All database options are updated to the latest versions as well as guaranteed to function on all Application Servers which should cause less friction and configuration time when starting a new devon4j project.</p>
</div>
<div class="paragraph">
<p>Details:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Spring Boot Upgrade to 1.5.3</p>
</li>
<li>
<p>Updated all underlying dependencies</p>
</li>
<li>
<p>Spring version is 4.3.8</p>
</li>
<li>
<p>Exclude Third Party Libraries that are not needed from sample restaurant application</p>
</li>
<li>
<p>Bugfix:Fixed the 'WhiteLabel' error received when tried to login to the sample restaurant application that is deployed onto external Tomcat</p>
</li>
<li>
<p>Bugfix:Removed the API api.org.apache.catalina.filters.SetCharacterEncodingFilter and used spring framework&#8217;s API org.springframework.web.filter.CharacterEncodingFilter instead</p>
</li>
<li>
<p>Bugfix:Fixed the error "class file for javax.interceptor.InterceptorBinding not found" received when executing the command 'mvn site' when trying to generate javadoc using Maven javadoc plugin</p>
</li>
<li>
<p>Documentation of the usage of UserDetailsService of Spring Security</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/devonfw/devon4j" class="bare">https://github.com/devonfw/devon4j</a></p>
</div>
<div class="paragraph">
<p>Wiki: <a href="https://github.com/devonfw/devon4j/wiki" class="bare">https://github.com/devonfw/devon4j/wiki</a></p>
</div>
</div>
<div class="sect2">
<h3 id="microservices-netflix"><a class="anchor" href="#microservices-netflix"></a>41.171. Microservices Netflix</h3>
<div class="paragraph">
<p>devonfw now includes a microservices implementation based on Spring Cloud Netflix. It provides a Netflix OSS integrations for Spring Boot apps through auto-configuration and binding to the Spring Environment. It  offers microservices archetypes and a complete user guide with all the details to start creating microservices with devonfw.</p>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/devonfw-forge/devonfw-microservices" class="bare">https://github.com/devonfw-forge/devonfw-microservices</a></p>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-distribution-based-on-eclipse-oomph"><a class="anchor" href="#devonfw-distribution-based-on-eclipse-oomph"></a>41.172. devonfw distribution based on Eclipse OOMPH</h3>
<div class="paragraph">
<p>The new Eclipse devonfw distribution is now based on Eclipse OOMPH, which allows us, an any engagement, to create and manage the distribution more effectively by formalizing the setup instructions so they can be performed automatically (due to a blocking issue postponed to devonfw 2.2.1 which will be released a few weeks after 2.2.0)</p>
</div>
</div>
<div class="sect2">
<h3 id="visual-studio-code-or-atom"><a class="anchor" href="#visual-studio-code-or-atom"></a>41.173. Visual Studio Code or Atom</h3>
<div class="paragraph">
<p>The devonfw distro now contains Visual Studio Code alongside Eclipse in order to provide a default, state of the art, environment for web based development.</p>
</div>
<div class="paragraph">
<p>See: <a href="https://devonfw.com/website/pages/docs/cli.adoc.html#vscode.adoc" class="bare">https://devonfw.com/website/pages/docs/cli.adoc.html#vscode.adoc</a></p>
</div>
</div>
<div class="sect2">
<h3 id="more-i18n-options"><a class="anchor" href="#more-i18n-options"></a>41.174. More I18N options</h3>
<div class="paragraph">
<p>The platform now contains more documentation and a conversion utility which makes it easier to share i18n resource files between the different frameworks.</p>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/devonfw/devon/wiki/cookbook-i18n-resource-converter" class="bare">https://github.com/devonfw/devon/wiki/cookbook-i18n-resource-converter</a></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-integration-as-devonfw-module"><a class="anchor" href="#spring-integration-as-devonfw-module"></a>41.175. Spring Integration as devonfw Module</h3>
<div class="paragraph">
<p>This release includes a new module based on the Java Message Service (JMS) and Spring Integration which provides a communication system (sender/subscriber) out-of-the-box with simple channels (only to send and read messages), request and reply channels (to send messages and responses) and request &amp; reply asynchronously channels.</p>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/devonfw/devon/wiki/cookbook-integration-module" class="bare">https://github.com/devonfw/devon/wiki/cookbook-integration-module</a></p>
</div>
</div>
<div class="sect2">
<h3 id="devonfw-harvest-contributions"><a class="anchor" href="#devonfw-harvest-contributions"></a>41.176. devonfw Harvest contributions</h3>
<div class="paragraph">
<p>devonfw contains a whole series of new components obtained through the Harvesting process. Examples are :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>New backend IP module Compose for Redis: management component for cloud environments. Redis is an open-source, blazingly fast, key/value low maintenance store. Compose&#8217;s platform gives you a configuration pre-tuned for high availability and locked down with additional security features. The component will manage the service connection and the main methods to manage the key/values on the storage. The library used is "lettuce".</p>
</li>
<li>
<p>Sencha component for extending GMapPanel with the following functionality :</p>
<div class="ulist">
<ul>
<li>
<p>Markers management</p>
</li>
<li>
<p>Google Maps options management</p>
</li>
<li>
<p>Geoposition management</p>
</li>
<li>
<p>Search address and coordinates management</p>
</li>
<li>
<p>Map events management</p>
</li>
<li>
<p>Map life cycle and behavior management</p>
</li>
</ul>
</div>
</li>
<li>
<p>Sencha responsive Footer that moves from horizontal to vertical layout depending on the screen resolution or the device type. It is a simple functionality but we consider it very useful and reusable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/devonfw/devon/wiki/cookbook-compose-for-redis-module" class="bare">https://github.com/devonfw/devon/wiki/cookbook-compose-for-redis-module</a></p>
</div>
</div>
<div class="sect2">
<h3 id="more-deployment-options-to-jee-application-servers-and-dockercloudfoundry"><a class="anchor" href="#more-deployment-options-to-jee-application-servers-and-dockercloudfoundry"></a>41.177. More Deployment options to JEE Application Servers and Docker/CloudFoundry</h3>
<div class="paragraph">
<p>The platform now fully supports deployment on the latest version of Weblogic, WebSphere, Wildfly (JBoss) as well as Docker and Cloud Foundry.</p>
</div>
<div class="paragraph">
<p>See:    <a href="https://github.com/devonfw/devon/wiki/Deployment-on-WebLogic" class="bare">https://github.com/devonfw/devon/wiki/Deployment-on-WebLogic</a>
    <a href="https://github.com/devonfw/devon/wiki/cookbook-Deployment-on-WebSphere" class="bare">https://github.com/devonfw/devon/wiki/cookbook-Deployment-on-WebSphere</a>
    <a href="https://github.com/devonfw/devon/wiki/cookbook-Deployment-on-Wildfly" class="bare">https://github.com/devonfw/devon/wiki/cookbook-Deployment-on-Wildfly</a></p>
</div>
</div>
<div class="sect2">
<h3 id="devcon-on-linux"><a class="anchor" href="#devcon-on-linux"></a>41.178. Devcon on Linux</h3>
<div class="paragraph">
<p>Devcon is now fully supported on Linux which, together with the devonfw distro running on Linux, makes devonfw fully multi-platform and Cloud compatible (as Linux is the default OS in the Cloud!)</p>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/devonfw/devcon/releases" class="bare">https://github.com/devonfw/devcon/releases</a></p>
</div>
</div>
<div class="sect2">
<h3 id="new-devonfw-incubators"><a class="anchor" href="#new-devonfw-incubators"></a>41.179. New devonfw Incubators</h3>
<div class="paragraph">
<p>From different Business Units (countries) have contributed "incubator" frameworks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>devon4NET (Stack based on .NET Core / .NET "Classic" (4.6))</p>
</li>
<li>
<p>devon4X (Stack based on Xamarin)</p>
</li>
<li>
<p>devon4node (Stack based on Node-js/Serverless): <a href="https://github.com/devonfw/devon4node" class="bare">https://github.com/devonfw/devon4node</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An "incubator" status means that the frameworks are production ready, all are actually already used in production, but  are still not fully compliant with the devonfw definition of a "Minimally Viable Product".</p>
</div>
<div class="paragraph">
<p>During this summer devon4NET will be properly installed. In the mean time, if you want to have access to the source code, please contact the <em>devonfw Core Team</em>.</p>
</div>
<!-- toc disabled -->
</div>
<div class="sect2">
<h3 id="release-notes-devonfw-2-1-1-balu"><a class="anchor" href="#release-notes-devonfw-2-1-1-balu"></a>41.180. Release notes devonfw 2.1.1 "Balu"</h3>

</div>
<div class="sect2">
<h3 id="version-2-1-2-devon4j-updates-and-some-new-features"><a class="anchor" href="#version-2-1-2-devon4j-updates-and-some-new-features"></a>41.181. Version 2.1.2: devon4j updates and some new features</h3>
<div class="paragraph">
<p>We&#8217;ve released the latest update release of devonfw in the <em>Balu</em> series: version 2.1.2. The next major release, code named <em>Courage</em>, will be released approximately the end of June. This current release contains the following items:</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4j-2-3-0-release"><a class="anchor" href="#devon4j-2-3-0-release"></a>41.182. devon4j 2.3.0 Release</h3>
<div class="paragraph">
<p>Friday the 12th of May 2017 devon4j version 2.3.0 was released. Major features added are :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Database Integration with PostGres, MSSQL Server, MariaDB</p>
</li>
<li>
<p>Added docs folder for gh pages and added oomph setups</p>
</li>
<li>
<p>Refactored Code</p>
</li>
<li>
<p>Refactored Test Infrastructure</p>
</li>
<li>
<p>Added Documentation on debugging tests</p>
</li>
<li>
<p>Added Two Batch Job tests in the restaurant sample</p>
</li>
<li>
<p>Bugfix: Fixed the error received when the Spring Boot Application from sample application that is created from maven archetype is launched</p>
</li>
<li>
<p>Bugfix: Fix for 404 error received when clicked on the link '1. Table' in index.html of the sample application created from maven archetype</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The devon4j wiki and other documents are updated for release 2.3.0.</p>
</div>
</div>
<div class="sect2">
<h3 id="cobigen-enhancements"><a class="anchor" href="#cobigen-enhancements"></a>41.183. CobiGen Enhancements</h3>
<div class="paragraph">
<p>Previous versions of CobiGen are able to generate code for REST services only. Now it is possible to generate the code for SOAP services as well. There are two use cases available in CobiGen:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SOAP without nested data</p>
</li>
<li>
<p>SOAP nested data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The "nested data" use case is when there are 3 or more entities which are interrelated with each other. CobiGen will generate code which will return the nested data. Currently CobiGen services return ETO classes, CobiGen has been enhanced as to return CTO classes (ETO + relationship).</p>
</div>
<div class="paragraph">
<p>Apart from the SOAP code generation, the capability to express nested relationships have been added to the existing ReST code generator as well.</p>
</div>
</div>
<div class="sect2">
<h3 id="micro-services-module-spring-cloudnetflix-oss"><a class="anchor" href="#micro-services-module-spring-cloudnetflix-oss"></a>41.184. Micro services module (Spring Cloud/Netflix OSS)</h3>
<div class="paragraph">
<p>To make it easier for devonfw users to design and develop applications based on microservices, this release provides a series of archetypes and resources based on <em>Spring Cloud Netflix</em> to automate the creation and configuration of microservices.</p>
</div>
<div class="paragraph">
<p>New documentation ind de devonfw Guide contains all the details to start <a href="https://github.com/devonfw-forge/devonfw-microservices">creating microservices with devonfw</a></p>
</div>
</div>
<div class="sect2">
<h3 id="spring-integration-module"><a class="anchor" href="#spring-integration-module"></a>41.185. Spring Integration Module</h3>
<div class="paragraph">
<p>Based on the <em>Java Message Service</em> (JMS) and <em>Spring Integration</em>, the devonfw <em>Integration module</em> provides a communication system (sender/subscriber) out-of-the-box with simple channels (only to send and read messages), request and reply channels (to send messages and responses) and request &amp; reply asynchronously channels.</p>
</div>
</div>
<div class="sect2">
<h3 id="version-2-1-1-updates-fixes-and-some-new-features"><a class="anchor" href="#version-2-1-1-updates-fixes-and-some-new-features"></a>41.186. Version 2.1.1 Updates, fixes and some new features</h3>

</div>
<div class="sect2">
<h3 id="cobigen-code-generator-fixes"><a class="anchor" href="#cobigen-code-generator-fixes"></a>41.187. CobiGen code-generator fixes</h3>
<div class="paragraph">
<p>The CobiGen incremental code generator released in the previous version contained a regression which has now been fixed. Generating services in Batch mode whereby a package can be given as an input, using all Entities contained in that package, works again as expected.</p>
</div>
<div class="paragraph">
<p>For more information see: <a href="https://github.com/devonfw/cobigen/wiki">The CobiGen documentation</a></p>
</div>
</div>
<div class="sect2">
<h3 id="devcon-enhancements"><a class="anchor" href="#devcon-enhancements"></a>41.188. Devcon enhancements</h3>
<div class="paragraph">
<p>In this new release we have added devcon to the devonfw distribution itself so one can directly use devcon from the console.bat or ps-console.bat windows. It is therefore no longer necessary to independently install devcon. However, as devcon is useful outside of the devonfw distribution, this remains a viable option.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4sencha"><a class="anchor" href="#devon4sencha"></a>41.189. Devon4Sencha</h3>
<div class="paragraph">
<p>in Devon4Sencha there are changes in the sample application. It now complies fully with the architecture which is known as "universal app", so now it has screens custom tailored for desktop and mobile devices. All the basic logic remains the same for both versions. (The StarterTemplate is still only for creating a desktop app. This will be tackled in the next release.)</p>
</div>
</div>
<div class="sect2">
<h3 id="new-winauth-modules"><a class="anchor" href="#new-winauth-modules"></a>41.190. New Winauth modules</h3>
<div class="paragraph">
<p>The original <em>winauth</em> module that, in previous Devon versions, implemented the <em>Active Directory</em> authentication and the <em>Single Sign-on</em> authentication now has been divided in two independent modules. The <em>Active Directory</em> authentication now is included in the new <em>Winauth-ad</em> module whereas the <em>Single Sign-on</em> implementation is included in a separate module called <em>Winauth-sso</em>.
Also some improvements have been added to <em>Winauth-sso</em> module to ease the way in which the module can be injected.</p>
</div>
</div>
<div class="sect2">
<h3 id="general-updates"><a class="anchor" href="#general-updates"></a>41.191. General updates</h3>
<div class="paragraph">
<p>There are a series of updates to the devonfw documentation, principally the devonfw Guide. Further more, from this release on, you can find the devonfw guide in the <em>doc</em> folder of the distribution.</p>
</div>
<div class="paragraph">
<p>Furthermore, the devon4j and devonfw source-code in the "examples" workspace, have been updated to the latest version.</p>
</div>
</div>
<div class="sect2">
<h3 id="version-2-1-new-features-improvements-and-updates"><a class="anchor" href="#version-2-1-new-features-improvements-and-updates"></a>41.192. Version 2.1 New features, improvements and updates</h3>

</div>
<div class="sect2">
<h3 id="introduction-25"><a class="anchor" href="#introduction-25"></a>41.193. Introduction</h3>
<div class="paragraph">
<p>We are proud to present the new release of devonfw, version "2.1" which we&#8217;ve baptized "Balu". A major focus for this release is developer productivity. So that explains the name, as Balu is not just big, friendly and cuddly but also was very happy to let Mowgli do the work for him.</p>
</div>
</div>
<div class="sect2">
<h3 id="cobigen-code-generator-ui-code-generation-and-more"><a class="anchor" href="#cobigen-code-generator-ui-code-generation-and-more"></a>41.194. Cobigen code-generator UI code generation and more</h3>
<div class="paragraph">
<p>The Cobigen incremental code generator which is part of devonfw has been significantly improved. Based on a single data schema it can generate the JPA/Hibernate code for the whole service layer (from data-access code to web services) for all CRUD operations. When generating code, Cobigen is able to detect and leave untouched any code which developers have added manually.</p>
</div>
<div class="paragraph">
<p>In the new release it supports Spring Data for data access and it is now capable of generating the whole User Interface as well: data-grids and individual rows/records with support for filters, pagination etc.  That is to say: Cobigen can now generate automatically all the code from the server-side database access layer all the way up to the UI "screens" in the web browser.</p>
</div>
<div class="paragraph">
<p>Currently we support Sencha Ext JS with support for Angular 2 coming soon. The code generated by Cobigen can be opened and used by Sencha Architect, the visual design tool, which enables the programmer to extend and enhance the generated UI non-programmatically. When Cobigen regenerates the code, even those additions are left intact. All these features combined allow for an iterative, incremental way of development which can be up to an order of an magnitude more productive than "programming manual"</p>
</div>
<div class="paragraph">
<p>Cobigen can now also be used for code-generation within the context of an engagement. It is easily extensible and the process of how to extend it for your own project is well documented. This becomes already worthwhile ("delivers ROI") when having 5+ identical elements within the project.</p>
</div>
<div class="paragraph">
<p>For more information see: <a href="https://github.com/devonfw/cobigen/wiki">The Cobigen documentation</a></p>
</div>
</div>
<div class="sect2">
<h3 id="angular-2-2"><a class="anchor" href="#angular-2-2"></a>41.195. Angular 2</h3>
<div class="paragraph">
<p>With the official release of Angular 2 and TypeScript 2, we&#8217;re slowly but steadily moving to embrace  these important new players in the  web development scene. We keep supporting the Angular 1 based devon4ng framework and are planning a migration of this framework to Angular 2 in the near future. For "Balu" we&#8217;ve have decided to integrate "vanilla" Angular 2.</p>
</div>
<div class="paragraph">
<p>We have migrated the Restaurant Sample application to serve as a, documented and supported, blueprint for Angular 2 applications. Furthermore, we support three "kickstarter" projects which help engagement getting started with Angular2 - either using Bootstrap or Google´s Material Design - or, alternatively, Ionic 2 (the mobile framework on top of Angular 2).</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4j-2-2-0-release"><a class="anchor" href="#devon4j-2-2-0-release"></a>41.196. devon4j 2.2.0 Release</h3>
<div class="paragraph">
<p>A new release of devon4j, version 2.2.0, is included in this release of devonfw. This release mainly focuses on server side of devonfw. i.e devon4j.</p>
</div>
<div class="paragraph">
<p>Major features added are :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Upgrade to Spring Boot 1.3.8.RELEASE</p>
</li>
<li>
<p>Upgrade to Apache CXF 3.1.8</p>
</li>
<li>
<p>Database Integration with Oracle 11g</p>
</li>
<li>
<p>Added Servlet for HTTP-Debugging</p>
</li>
<li>
<p>Refactored code and improved JavaDoc</p>
</li>
<li>
<p>Bugfix: mvn spring-boot:run executes successfully for devon4j application created using devon4j template</p>
</li>
<li>
<p>Added subsystem tests of SalesmanagementRestService and several other tests</p>
</li>
<li>
<p>Added Tests to test java packages conformance to devonfw conventions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More details on features added can be found at <a href="https://github.com/devonfw/devon4j/milestone/19?closed=1(here" class="bare">https://github.com/devonfw/devon4j/milestone/19?closed=1(here</a>). The devon4j wiki and other documents are updated for release 2.2.0.</p>
</div>
</div>
<div class="sect2">
<h3 id="devon4sencha-2"><a class="anchor" href="#devon4sencha-2"></a>41.197. Devon4Sencha</h3>
<div class="paragraph">
<p>Devon4Sencha is an alternative view layer for web applications developed with devonfw. It is based on Sencha Ext JS. As it requires a license for commercial applications it is not provided as Open Source and is considered to be part of the IP of Capgemini.</p>
</div>
<div class="paragraph">
<p>These libraries provide support for creating SPA (Single Page Applications) with a very rich set of components for both desktop and mobile. In the new version we extend this functionality to support for "Universal Apps", the Sencha specific term for true multi-device applications which make it possible to develop a single application for desktop, tablet as well as mobile devices. In the latest version Devon4Sencha has been upgraded to support Ext JS 6.2 and we now support the usage of Cobigen as well as Sencha Architect as extra option to improve developer productivity.</p>
</div>
</div>
<div class="sect2">
<h3 id="devcon-enhancements-2"><a class="anchor" href="#devcon-enhancements-2"></a>41.198. Devcon enhancements</h3>
<div class="paragraph">
<p>The Devon Console, Devcon, is a cross-platform command line tool running on the JVM that provides many automated tasks around the full life-cycle of Devon applications, from installing the basic working environment and generating a new project, to running a test server and deploying an application to production. It can be used by the engagements to integrate with their proprietary tool chain.</p>
</div>
<div class="paragraph">
<p>In this new release we have added an optional graphical user interface (with integrated help) which makes using Devcon even easier to use. Another new feature is that it is now possible to easily extend it with commands just by adding your own or project specific Javascript files. This makes it an attractive option for project task automation.</p>
</div>
</div>
<div class="sect2">
<h3 id="ready-for-the-cloud"><a class="anchor" href="#ready-for-the-cloud"></a>41.199. Ready for the Cloud</h3>
<div class="paragraph">
<p>devonfw is in active use in the Cloud, with projects running on IBM Bluemix and on Amazon AWS. The focus is very much to keep Cloud-specific functionality decoupled from the devonfw core. The engagement can choose between - and easily configure the use of - either CloudFoundry or Spring Cloud (alternatively, you can run devonfw in Docker containers in the Cloud as well. See elsewhere in the release notes).</p>
</div>
</div>
<div class="sect2">
<h3 id="spring-data-4"><a class="anchor" href="#spring-data-4"></a>41.200. Spring Data</h3>
<div class="paragraph">
<p>The java server stack within devonfw, devon4j,  is build on a very solid DDD architecture  which uses JPA for its data access layer. We now offer integration of Spring Data as an alternative or to be used in conjunction with JPA. Spring Data offers significant advantages over JPA through its query mechanism which allows the developer to specify complex queries in an easy way. Overall working with Spring Data should be quite more productive compared with JPA for the average or junior developer. And extra advantage is that Spring Data also allows - and comes with support for - the usage of NoSQL databases like MongoDB, Cassandra, DynamoDB etc. THis becomes especially critical in the Cloud where NoSQL databases typically offer better scalability than relational databases.</p>
</div>
</div>
<div class="sect2">
<h3 id="videos-content-in-the-devonfw-guide"><a class="anchor" href="#videos-content-in-the-devonfw-guide"></a>41.201. Videos content in the devonfw Guide</h3>
<div class="paragraph">
<p>The devonfw Guide is the single, authoritative tutorial and reference ("cookbook") for all things devonfw, targeted at the general developer working with the platform (there is another document for Architects).  It is clear and concise but because of the large scope and wide reach of devonfw, it comes with a hefty 370+ pages. For the impatient - and sometimes images do indeed say more than words - we&#8217;ve added videos to the Guide which significantly speed up getting started with the diverse aspects of devonfw.</p>
</div>
<div class="paragraph">
<p>For more information on videos check out our <a href="https://www.youtube.com/channel/UCtb1p-24jus-QoXy49t9Xzg">devonfw Youtube channel</a></p>
</div>
</div>
<div class="sect2">
<h3 id="containerisation-with-docker-and-the-production-line"><a class="anchor" href="#containerisation-with-docker-and-the-production-line"></a>41.202. Containerisation with Docker and the Production Line</h3>
<div class="paragraph">
<p>Docker (see: <a href="https://www.docker.com/" class="bare">https://www.docker.com/</a>) containers wrap a piece of software in a complete filesystem that contains everything needed to run: code, runtime, system tools, system libraries – anything that can be installed on a server. Docker containers resemble virtual machines but are far more resource efficient. Because of this, Docker and related technologies like Kubernetes are taking the Enterprise and Cloud by storm. We have certified and documented the usage of devonfw on Docker so we can now firmly state that "devonfw is Docker" ready. All the more so as the iCSD Production Line is now supporting devonfw as well. The Production Line is a Docker based set of methods and tools that make possible to develop custom software to our customers on time and with the expected quality. By having first-class support for devonfw on the Production Line, iCSD has got an unified, integral solution which covers all the phases involved on the application development cycle from requirements to testing and hand-off to the client.</p>
</div>
</div>
<div class="sect2">
<h3 id="eclipse-neon"><a class="anchor" href="#eclipse-neon"></a>41.203. Eclipse Neon</h3>
<div class="paragraph">
<p>devonfw comes with its own pre configured and enhanced Eclipse based IDE:  the Open Source "devonfw IDE" and "devonfw Distr" which falls under Capgemini IP. We&#8217;ve updated both versions to the latest stable version of Eclipse, Neon. From Balu onwards we support the IDE on Linux as well and we offer downloadable versions for both Windows and Linux.</p>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/devonfw/ide/wiki">The Devon IDE</a></p>
</div>
</div>
<div class="sect2">
<h3 id="default-java-8-with-java-7-compatibility"><a class="anchor" href="#default-java-8-with-java-7-compatibility"></a>41.204. Default Java 8 with Java 7 compatibility</h3>
<div class="paragraph">
<p>From version 2.1. "Balu" onwards, devonfw is using by default Java 8 for both the tool-chain as well as the integrated development environments. However, both the framework as well as the IDE and tool-set remain fully backward compatible with Java 7. We have added documentation to help configuring aspects of the framework to use Java 7 or to upgrade existing projects to Java 8. See: <a href="https://github.com/devonfw/devon/wiki/Compatibility-guide-for-Java7,-Java8-and-Tomcat7,-Tomcat8">Compatibility guide for Java7, Java8 and Tomcat7, Tomcat8</a></p>
</div>
</div>
<div class="sect2">
<h3 id="full-linux-support"><a class="anchor" href="#full-linux-support"></a>41.205. Full Linux support</h3>
<div class="paragraph">
<p>In order to fully support the move towards the Cloud, from version 2.1. "Balu" onwards, devonfw is fully supported on Linux. Linux is the de-facto standard for most Cloud providers. We currently only offer first-class support for Ubuntu 16.04 LTS onward but most aspects of devonfw should run without problems on other and older distributions as well.</p>
</div>
</div>
<div class="sect2">
<h3 id="initial-atom-support"><a class="anchor" href="#initial-atom-support"></a>41.206. Initial ATOM support</h3>
<div class="paragraph">
<p>Atom is a text editor that&#8217;s modern, approachable, yet hackable to the core - a tool you can customize to do anything but also use productively without ever touching a config file. It is turning into a standard for modern web development. In devonfw 2.1 "Balu" we provide a script which installs automatically the most recent version of Atom in the devonfw distribution with a pre-configured set of essential plugins.</p>
</div>
</div>
<div class="sect2">
<h3 id="database-support"><a class="anchor" href="#database-support"></a>41.207. Database support</h3>
<div class="paragraph">
<p>Through JPA (and now Spring Data as well) devonfw supports many databases. In Balu we&#8217;ve extended this support to prepared configuration, extensive documentations and supporting examples for all major "Enterprise" DB servers. So it becomes even easier for engagements to start using these standard database options. Currently we provide this extended support for Oracle, Microsoft SQL Server, MySQL and PostgreSQL.
For more information see: <a href="https://github.com/devonfw/devon4j/wiki/guide-database-migration">devonfw Database Migration Guide</a></p>
</div>
</div>
<div class="sect2">
<h3 id="internationalisation-i18n-improvements"><a class="anchor" href="#internationalisation-i18n-improvements"></a>41.208. Internationalisation (I18N) improvements</h3>
<div class="paragraph">
<p>Likewise, existing basic Internationalisation (I18N) support has been significantly enhanced through an new devonfw module and extended to support Ext JS and Angular 2 apps as well. This means that both server as well as client side applications can be made easily to support multiple languages ("locales"), using industry standard tools and without touching programming code (essential when working with teams of translators).</p>
</div>
</div>
<div class="sect2">
<h3 id="asynchronous-http-support"><a class="anchor" href="#asynchronous-http-support"></a>41.209. Asynchronous HTTP support</h3>
<div class="paragraph">
<p>Asynchronous HTTP is an important feature allowing so-called "long polling" HTTP Requests (for streaming applications, for example) or with requests sending large amounts of data. By making HTTP Requests asynchronous, devonfw server instances can better support these types of use-cases while offering far better performance.</p>
</div>
</div>
<div class="sect2">
<h3 id="security-and-license-guarantees"><a class="anchor" href="#security-and-license-guarantees"></a>41.210. Security and License guarantees</h3>
<div class="paragraph">
<p>In devonfw security comes first. The components of the framework are designed and implemented according to the recommendations and guidelines as specified by OWASP in order to confront the top 10 security vulnerabilities.</p>
</div>
<div class="paragraph">
<p>From version 2.1 "Balu" onward we certify that devonfw has been scanned by software from "Black Duck". This verifies that devonfw is based on 100% Open Source Software (non Copyleft) and demonstrates that at moment of release there are no known, critical security flaws. Less critical issues are clearly documented.</p>
</div>
</div>
<div class="sect2">
<h3 id="documentation-improvements"><a class="anchor" href="#documentation-improvements"></a>41.211. Documentation improvements</h3>
<div class="paragraph">
<p>Apart from the previously mentioned additions and improvements to diverse aspects of the devonfw documentation, principally the devonfw Guide,  there are a number of other important changes. We&#8217;ve incorporated the Devon Modules Developer´s Guide which describes how to extend devonfw with its Spring-based module system. Furthermore we&#8217;ve significantly improved the Guide to the usage of web services. We&#8217;ve included a Compatibility Guide which details a series of considerations related with different version of the framework as well as Java 7 vs 8. And finally, we&#8217;ve extended the F.A.Q. to provide the users with direct answers to common, Frequently Asked Questions.</p>
</div>
</div>
<div class="sect2">
<h3 id="contributors"><a class="anchor" href="#contributors"></a>41.212. Contributors</h3>
<div class="paragraph">
<p>Many thanks to adrianbielewicz, aferre777, amarinso, arenstedt, azzigeorge, cbeldacap, cmammado, crisjdiaz, csiwiak, Dalgar, drhoet, Drophoff, dumbNickname, EastWindShak, fawinter, fbougeno, fkreis, GawandeKunal, henning-cg, hennk, hohwille, ivanderk, jarek-jpa, jart, jensbartelheimer, jhcore, jkokoszk, julianmetzler, kalmuczakm, kiran-vadla, kowalj, lgoerlach, ManjiriBirajdar, MarcoRose, maybeec, mmatczak, nelooo, oelsabba, pablo-parra, patrhel, pawelkorzeniowski, PriyankaBelorkar, RobertoGM, sekaiser, sesslinger, SimonHuber, sjimenez77, sobkowiak, sroeger, ssarmokadam, subashbasnet, szendo, tbialecki, thoptr, tsowada, znazir and anyone who we may have forgotten to add!</p>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. "Stammdaten" in German.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. Whether to use checked exceptions or not is a controversial topic. Arguments for both sides can be found under <a href="https://www.artima.com/intv/handcuffs.html">The Trouble with Checked Exceptions</a>, <a href="https://docs.oracle.com/javase/tutorial/essential/exceptions/runtime.html">Unchecked Exceptions — The Controversy</a>, and <a href="https://phauer.com/2015/checked-exceptions-are-evil/">Checked Exceptions are Evil</a>. The arguments in favor of unchecked exceptions tend to prevail for applications built with devon4j. Therefore, unchecked exceptions should be used for a consistent style.
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. A package is a file or directory that is described by a package.json. .
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
