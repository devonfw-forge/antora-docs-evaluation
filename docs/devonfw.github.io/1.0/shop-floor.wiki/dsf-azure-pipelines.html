<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Devonfw.github.io Docs</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">Devonfw.github.io Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="devonfw.github.io" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">devonfw.github.io</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../architecture-guidelines/1.0/index.html">Architecture-guidelines</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../architecture-guidelines/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../cicdgen/1.0/index.html">Cicdgen</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../cicdgen/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../cobigen/1.0/index.html">Cobigen</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../cobigen/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../dashboard/1.0/index.html">Dashboard</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../dashboard/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4j/1.0/index.html">Devon4j</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4j/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4net/1.0/index.html">Devon4net</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4net/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4ng/1.0/index.html">Devon4ng</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4ng/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4node/1.0/index.html">Devon4node</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4node/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4quarkus/1.0/index.html">Devon4quarkus</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4quarkus/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4ts/1.0/index.html">Devon4ts</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4ts/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">devonfw.github.io</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../getting-started/1.0/index.html">Getting-started</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../getting-started/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../github/1.0/index.html">Github</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../github/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../hangar/1.0/index.html">Hangar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../hangar/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../ide/1.0/index.html">IDE</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../ide/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../jump-the-queue/1.0/index.html">Jump-the-queue</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../jump-the-queue/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../mrchecker/1.0/index.html">Mrchecker</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../mrchecker/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../my-thai-star/1.0/index.html">My-thai-star</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../my-thai-star/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../production-line/1.0/index.html">Production-line</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../production-line/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../shop-floor/1.0/index.html">Shop-floor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../shop-floor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../solicitor/1.0/index.html">Solicitor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../solicitor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../sonar-devon4j-plugin/1.0/index.html">Sonar-devon4j-plugin</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../sonar-devon4j-plugin/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/marvdan/devonfw.github.io/edit/developAntoraGhPage/docs/modules/ROOT/pages/shop-floor.wiki/dsf-azure-pipelines.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="sect1">
<h2 id="_create_an_azure_pipeline_from_scratch"><a class="anchor" href="#_create_an_azure_pipeline_from_scratch"></a>Create an Azure pipeline from scratch</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following steps will allow you to create a basic pipeline in Azure Devops from scratch</p>
</div>
<div class="paragraph">
<p>In order to deploy in Azure, we&#8217;ve created an automatic pipeline in Azure Devops that will be executed automaticaly when  developers make a push to the Azure repositories, the pipeline will compile the code, build the application and ensure with automatic tests that the build is not going to break the application, to ensure a good quality code the code will be analyzed by sonar as well as your code coverage and last but not least, your application will be deployed using Azure App Services.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_steps"><a class="anchor" href="#_steps"></a>Steps</h2>
<div class="sectionbody">
<div class="paragraph">
<p>1- Sign in to your Azure DevOps organization and navigate to your project.</p>
</div>
<div class="paragraph">
<p>2- Go to Pipelines, and then select New Pipeline.</p>
</div>
<div class="paragraph">
<p>3- Choose the location of your source code(Github, Bitbucket,Azure repos..etc), in this case we have our code in Azure Repos Git.</p>
</div>
<div class="paragraph">
<p>A list of your repositories will be shown here:</p>
</div>
<div class="paragraph">
<p>4- When the list of repositories appears, select your repository.</p>
</div>
<div class="paragraph">
<p>Depending on your project type(Java, .NET, Python or JavaScript) the following configuration will change, in this case our project is a .NET, for more type of projects please follow the <a href="https://docs.microsoft.com/es-es/azure/devops/pipelines/create-first-pipeline?view=azure-devops&amp;tabs=net%2Ctfs-2018-2%2Cbrowser">official documentation</a>.</p>
</div>
<div class="paragraph">
<p>5- When the Configure tab appears, select ASP.NET Core(or the one according to your project)</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/images/others/azure-pipelines/configuration.png" alt="configuration">
</div>
</div>
<div class="paragraph">
<p>6- A .yaml file in your ./ location will be generated with all the required steps to run your pipeline.
The name of this .yaml file is 'azure-pipelines.yaml' wich is the default name that will be used in your pipeline settings.</p>
</div>
<div class="paragraph">
<p><em>Note:If you change the name or the location, you will need to specify in the pipeline settings the new name or location:</em></p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/images/others/azure-pipelines/pipeline-settings.png" alt="pipeline settings">
</div>
</div>
<div class="paragraph">
<p>The pipeline is created with the minimum required steps to run it which are the following:</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_triggers"><a class="anchor" href="#_triggers"></a>TRIGGERS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Triggers that will activate the pipeline execution</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">trigger:
- master
- develop</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_variables"><a class="anchor" href="#_variables"></a>VARIABLES</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Variables that will be used in the next steps</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">variables:
  solution: '**/*.sln'
  buildPlatform: 'Any CPU'
  buildConfiguration: 'Release'</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tools_and_libraries"><a class="anchor" href="#_tools_and_libraries"></a>TOOLS AND LIBRARIES</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For .NET:</p>
</div>
<div class="paragraph">
<p><strong>-NuGet Tool Installer task</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- task: NuGetToolInstaller@1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use this task to find, download, and cache a specified version of NuGet and add it to the PATH.</p>
</div>
<div class="paragraph">
<p><strong>-The NuGet command to run</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- task: NuGetCommand@2
  inputs:
    restoreSolution: '$(solution)'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The NuGet command to run.</p>
</div>
<div class="paragraph">
<p>For more info use the official <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/tool/nuget?view=azure-devops">documentation</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_build"><a class="anchor" href="#_build"></a>BUILD</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>-Visual Studio Build task</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- task: VSBuild@1
  inputs:
    solution: '$(solution)'
    msbuildArgs: '/p:DeployOnBuild=true /p:WebPublishMethod=Package /p:PackageAsSingleFile=true /p:SkipInvalidConfigurations=true /p:DesktopBuildPackageLocation="$(build.artifactStagingDirectory)\WebApp.zip" /p:DeployIisAppPath="Default Web Site"'
    platform: '$(buildPlatform)'
    configuration: '$(buildConfiguration)'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use this task to build with MSBuild and set the Visual Studio version property.</p>
</div>
<div class="paragraph">
<p>For more info use the official <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/build/visual-studio-build?view=azure-devops">documentation</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test"><a class="anchor" href="#_test"></a>TEST</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>-Visual Studio Test task</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- task: DotNetCoreCLI@2
  inputs:
    command: 'test'
    arguments: '/p:CollectCoverage=true /p:CoverletOutputFormat=opencover /p:CoverletOutput=$(Agent.TempDirectory)/'
    projects: '$(solution)'
    publishTestResults: true
  continueOnError: false
  displayName: 'Dot Net Core CLI Test'</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use this task to run unit and functional tests (Selenium, Appium, Coded UI test, and more) using the Visual Studio Test Runner.</p>
</div>
<div class="paragraph">
<p>For more info use the official <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/test/vstest?view=azure-devops">documentation</a></p>
</div>
<div class="paragraph">
<p>This steps are the ones generated when your pipeline is created, we can create the ones we need using the Azure Devops wizard in an easy way.</p>
</div>
<div class="paragraph">
<p>In our case, apart from build and test, we also need to deploy</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deploy"><a class="anchor" href="#_deploy"></a>DEPLOY</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_app_services"><a class="anchor" href="#_app_services"></a>App Services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>While deploying with App Services, 2 steps are required:</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_step_1_publish"><a class="anchor" href="#_step_1_publish"></a>==  Step 1: Publish</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use this task in a pipeline to publish artifacts for the Azure Pipeline</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- task: PublishPipelineArtifact@0
  inputs:
    artifactName: 'Bad_Weather_Backend'
    targetPath: '$(Build.ArtifactStagingDirectory)'</code></pre>
</div>
</div>
<div class="paragraph">
<p>To know more about the use of predefined variables in azure take a look at the <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/build/variables?view=azure-devops&amp;tabs=yaml">documentation</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_step_2_deployment"><a class="anchor" href="#_step_2_deployment"></a>==  Step 2: Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use this task to deploy to a range of App Services on Azure</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- task: AzureRmWebAppDeployment@4
  inputs:
    ConnectionType: 'AzureRM'
    azureSubscription: 'bad-weather-poc-rs-bw-dev'
    appType: 'webApp'
    WebAppName: 'bwbackendbe'
    packageForLinux: '$(build.artifactStagingDirectory)\WebApp.zip'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This task has 2 prerequisites:</p>
</div>
<div class="paragraph">
<p>1-App Service instance:</p>
</div>
<div class="paragraph">
<p>The task is used to deploy a Web App project or Azure Function project to an existing Azure App Service instance, which must exist before the task runs.</p>
</div>
<div class="paragraph">
<p>2-Azure Subscription:</p>
</div>
<div class="paragraph">
<p>In order to deploy to Azure, an Azure subscription must be <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/library/connect-to-azure?view=azure-devops">linked to the pipeline</a>.</p>
</div>
<div class="paragraph">
<p>To know more about the input arguments for this task, make use of the offcial <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/tasks/deploy/azure-rm-web-app-deployment?view=azure-devops">documentation</a></p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
