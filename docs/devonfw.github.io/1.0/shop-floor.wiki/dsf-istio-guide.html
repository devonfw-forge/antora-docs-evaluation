<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Devonfw.github.io Docs</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">Devonfw.github.io Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="devonfw.github.io" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">devonfw.github.io</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../architecture-guidelines/1.0/index.html">Architecture-guidelines</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../architecture-guidelines/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../cicdgen/1.0/index.html">Cicdgen</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../cicdgen/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../cobigen/1.0/index.html">Cobigen</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../cobigen/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../dashboard/1.0/index.html">Dashboard</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../dashboard/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4j/1.0/index.html">Devon4j</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4j/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4net/1.0/index.html">Devon4net</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4net/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4ng/1.0/index.html">Devon4ng</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4ng/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4node/1.0/index.html">Devon4node</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4node/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4quarkus/1.0/index.html">Devon4quarkus</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4quarkus/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4ts/1.0/index.html">Devon4ts</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4ts/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">devonfw.github.io</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../getting-started/1.0/index.html">Getting-started</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../getting-started/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../github/1.0/index.html">Github</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../github/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../hangar/1.0/index.html">Hangar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../hangar/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../ide/1.0/index.html">IDE</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../ide/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../jump-the-queue/1.0/index.html">Jump-the-queue</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../jump-the-queue/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../mrchecker/1.0/index.html">Mrchecker</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../mrchecker/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../my-thai-star/1.0/index.html">My-thai-star</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../my-thai-star/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../production-line/1.0/index.html">Production-line</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../production-line/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../shop-floor/1.0/index.html">Shop-floor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../shop-floor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../solicitor/1.0/index.html">Solicitor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../solicitor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../sonar-devon4j-plugin/1.0/index.html">Sonar-devon4j-plugin</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../sonar-devon4j-plugin/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/marvdan/devonfw.github.io/edit/developAntoraGhPage/docs/modules/ROOT/pages/shop-floor.wiki/dsf-istio-guide.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="sect1">
<h2 id="_istio_service_mesh_implementation_guide"><a class="anchor" href="#_istio_service_mesh_implementation_guide"></a>ISTIO Service Mesh Implementation Guide</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A service mesh separating applications from network functions like resilience, fault tolerance, etc,.</p>
</div>
<div class="paragraph">
<p>A service mesh addresses the below functions without changing the application code.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Test the new versions of services without impacting the users.</p>
</li>
<li>
<p>Scale the services.</p>
</li>
<li>
<p>Find the services with the help of service registry.</p>
</li>
<li>
<p>Test against failures.</p>
</li>
<li>
<p>Secure service-to-service communication.</p>
</li>
<li>
<p>Route traffic to a specific way.</p>
</li>
<li>
<p>Circuit breaking and fault injection.</p>
</li>
<li>
<p>Monitor the services and collect matrices.</p>
</li>
<li>
<p>Tracing.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ISTIO service mesh is an open environment for Connecting, Securing, Monitoring services across the environments.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_istio_architecture"><a class="anchor" href="#_istio_architecture"></a>ISTIO Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image1.png" alt="image" width="373" height="277"></span></p>
</div>
<div class="paragraph">
<p>ISTIO is split into data plane and control plane. Refer <a href="https://istio.io/latest/docs/ops/deployment/architecture">ISTIO Architecture</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_plane"><a class="anchor" href="#_data_plane"></a>Data Plane</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The data plane is a set of intelligent proxies (Envoy) deployed as sidecars that mediate and control all network communication among microservices.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image2.png" alt="image" width="199" height="185"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_control_plane"><a class="anchor" href="#_control_plane"></a>Control Plane</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The control plane is managing and configuring proxies to route traffic and enforcing policies.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pilot manages all the proxies and responsible for routing</p>
</li>
<li>
<p>Mixer collects telemetry and policy check</p>
</li>
<li>
<p>Citadel does Certificate management (TLS certs to Envoys)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_istio_installation"><a class="anchor" href="#_istio_installation"></a>ISTIO installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Download ISTIO from <a href="https://github.com/istio/istio/releases/">releases</a></p>
</div>
<div class="paragraph">
<p><code>istioctl install --set profile=demo</code></p>
</div>
<div class="paragraph">
<p>Here used demo profile, there are other profiles for production.</p>
</div>
<div class="paragraph">
<p>Verify installation:</p>
</div>
<div class="paragraph">
<p><code>kubectl get all -n istio-system</code></p>
</div>
<div class="paragraph">
<p>Inject sidecar container automatically by issuing the below command.</p>
</div>
<div class="paragraph">
<p><code>kubectl label namespace default istio-injection=enabled</code></p>
</div>
<div class="paragraph">
<p>Verify:</p>
</div>
<div class="paragraph">
<p><code>kubectl get namespace -L istio-injection</code></p>
</div>
<div class="paragraph">
<p>For more installation guides, refer <a href="https://istio.io/latest/docs/setup/install/">ISTIO Installation</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_traffic_management"><a class="anchor" href="#_traffic_management"></a>Traffic Management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ISITO&#8217;s traffic management model relies on the Envoy proxies which deployed as sidecars to services.</p>
</div>
<div class="paragraph">
<p>Below are the traffic management API resources</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Virtual Services</p>
</li>
<li>
<p>Destination Rules</p>
</li>
<li>
<p>Gateways</p>
</li>
<li>
<p>Service Entries</p>
</li>
<li>
<p>Sidecars</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A virtual service, higher level abstraction of Kubernetes Service, lets you configure how requests are routed to a service within an Istio service mesh. Your mesh may have multiple virtual services or none. Virtual service consists of routing rules that are evaluated in order.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dark_launch"><a class="anchor" href="#_dark_launch"></a>Dark Launch</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following virtual service routes requests to different versions of a service depending on whether the request comes from a testuser. If the testuser calls then version v1 will be used, and for others version v2.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image3.png" alt="image" width="601" height="124"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bluegreen_deployment"><a class="anchor" href="#_bluegreen_deployment"></a>Blue/Green deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In blue/green deployment two versions of the application running. Both versions are live on different domain names, in this example it is mtsj.com and test.mtsj.com.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define 2 virtual services for mtsj v1 and v2 versions.</p>
</li>
<li>
<p>Define DestinationRule and configure the subsets for v1 and v2.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image4.png" alt="image" width="601" height="139"></span></p>
</div>
<div class="paragraph">
<p>When end user browses <em>mtsj.com</em>, the gateway call goes to subset v1 of the virtual service and redirects to destination version v1, and for <em>test.mtsj.com</em> to version v2.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_canary_deployment_traffic_splitting"><a class="anchor" href="#_canary_deployment_traffic_splitting"></a>Canary Deployment (Traffic Splitting)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In canary deployment old and new versions of the application alive. ISTIO can be configured, how much percentage of traffic can go to each version.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image5.png" alt="image" width="601" height="123"></span></p>
</div>
<div class="paragraph">
<p>Here, the traffic is divided 75% to the version V1, and 25% to the version V2, as we gain confidence the percentage can be increased the latest version and gradually the traffic to the old version can be reduced and removed.</p>
</div>
<div class="paragraph">
<p>You may refer <a href="https://istio.io/latest/docs/concepts/traffic-management">ISTIO Traffic Management</a> for more details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mythaistar_implementation"><a class="anchor" href="#_mythaistar_implementation"></a>==  MyThaiStar Implementation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this example dish will have two versions and the traffic will be routed alternately using the ISTIO configuration.</p>
</div>
<div class="paragraph">
<p>Find all configuration files in istio/trafficmanagement/canary directory under mythaistarmicroservices example.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>MyThaiStar defines below</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Service</p>
</li>
<li>
<p>Service Account</p>
</li>
<li>
<p>Deployment</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The above configurations are defined in a single yaml file for all the different services like angular, dish, image etc.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>dish-v2: Dish Version 2 can be kept separately in different yaml file.</p>
</li>
<li>
<p>mts-gateway defines the ingress gateway which routes the outbound request to each service.</p>
</li>
<li>
<p>destination-rule-all defines the subsets here for later traffic routing</p>
</li>
<li>
<p>dish-50-50: traffic routing for different versions of dishmanagement.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_network_resilience"><a class="anchor" href="#_network_resilience"></a>Network Resilience</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_timeout"><a class="anchor" href="#_timeout"></a>==  Timeout</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Istio lets you adjust the timeouts using virtual services. The default timeout is 15 seconds.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image6.png" alt="image" width="185" height="155"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_retry"><a class="anchor" href="#_retry"></a>==  Retry</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A retry setting specifies the maximum number of times an Envoy proxy attempts to connect to a service if the initial call fails.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image7.png" alt="image" width="211" height="152"></span></p>
</div>
<div class="paragraph">
<p>Retries can also be configured on Gateway Error, Connection failure, Connection Refused or any 5xx error from the application.</p>
</div>
<div class="paragraph">
<p>retryOn: gateway-error,connect-failure,refused-stream,5xx</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_circuit_breakers"><a class="anchor" href="#_circuit_breakers"></a>==  Circuit Breakers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By defining the destination rule, set limits for calls to individual hosts within a service, such as the number of concurrent connections or how many times calls to this host have failed once the limit reached.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Outlier Detection is an ISTIO Resiliency strategy to detect unusual host behaviour and evict the unhealthy hosts from the set of load balanced healthy hosts inside a cluster.</p>
</li>
<li>
<p>If a request is sent to a service instance and it fails (returns a 50X error code), then ISTIO ejects the instance from the load balanced pool for a specified duration.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image8.png" alt="image" width="182" height="150"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fault_injection"><a class="anchor" href="#_fault_injection"></a>==  Fault Injection</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Two types of faults can be generated using ISTIO. This is useful for the testing.</p>
</div>
<div class="paragraph">
<p>Delays: timing failures.</p>
</div>
<div class="paragraph">
<p>Aborts: crash failures.</p>
</div>
<div class="paragraph">
<p>Below example is a crash failure Virtual Service. The below example configured to receive http status 500 error for the testuser. The application works fine for all other users.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image9.png" alt="image" width="229" height="377"></span></p>
</div>
<div class="paragraph">
<p>The below virtual service configured to wait 10s for all requests.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image10.png" alt="image" width="254" height="217"></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_security"><a class="anchor" href="#_security"></a>Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ISTIO provides security solution has the below functions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Traffic encryption</p>
</li>
<li>
<p>Mutual TLS and fine-grained access policies.</p>
</li>
<li>
<p>Auditing tools</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authentication"><a class="anchor" href="#_authentication"></a>Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ISTIO provides two types of authentication.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Peer authentication, secures service to service authentication</p>
</li>
<li>
<p>Request authentication is end user authentication to verify credential attached to the request.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mutual_tls_authentication"><a class="anchor" href="#_mutual_tls_authentication"></a>Mutual TLS Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, the TLS protocol only proves the identity of the server to the client. Mutual TLS authentication ensures that traffic has been traffic is secure and trusted in both the directions between the client and server.</p>
</div>
<div class="paragraph">
<p>All traffic between services with proxies uses mutual TLS by default.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_peer_authentication"><a class="anchor" href="#_peer_authentication"></a>Peer Authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Peer authentication has Permissive, Strict and Disabled mode. With permissive mode, a service accepts both plain text and mutual TLS traffic. Permissive mode is good at the time of onboarding and should switch to Strict later.</p>
</div>
<div class="paragraph">
<p>The authentication policy can be applied to mesh-wide, namespace wide or workload specific using the selector field.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image11.png" alt="image" width="275" height="148"></span></p>
</div>
<div class="paragraph">
<p>Here the policy applied to the workload bookings.</p>
</div>
<div class="paragraph">
<p>Check the default mesh policy:</p>
</div>
<div class="paragraph">
<p><code>kubectl describe meshpolicy default</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_request_authentication"><a class="anchor" href="#_request_authentication"></a>Request authentication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Request authentication policies specify the values needed to validate JWT tokens.</p>
</div>
<div class="paragraph">
<p>|== =
|<strong>Authentication</strong> |<strong>Applies to</strong> |<strong>Uses</strong> |<strong>Identity</strong>
|Peer authentication |Service to service |mTLS |source.principal
|Request authentication |End User authentication |JWT |request.auth.principal
|== =</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_authorization"><a class="anchor" href="#_authorization"></a>Authorization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Apply an authorization policy to the workload/namespace/mesh to enforce the access control. Supports ALLOW and DENY actions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deny_all"><a class="anchor" href="#_deny_all"></a>==  Deny All</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Below example authorization policy without any rules denies access to all workloads in admin namespace.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image12.png" alt="image" width="221" height="97"></span></p>
</div>
<div class="paragraph">
<p>Example below allowing the GET methods from order service.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image13.png" alt="image" width="247" height="174"></span></p>
</div>
<div class="paragraph">
<p>Example below denies the request to the /registered path for requests without request principals.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/images/others/istio/media/image14.png" alt="image" width="236" height="166"></span></p>
</div>
<div class="paragraph">
<p>You may refer <a href="https://istio.io/latest/docs/concepts/security">ISTIO Security</a> for more details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_observability"><a class="anchor" href="#_observability"></a>Observability</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ISTIO generates</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Metrics - for monitor latency, traffic, errors and saturation.</p>
</li>
<li>
<p>Distributed Traces to identify call flows and service dependencies</p>
</li>
<li>
<p>Access Logs enables audit service behaviour to the individual service level.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_grafana_dashboard"><a class="anchor" href="#_grafana_dashboard"></a>Grafana dashboard</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Grafana and Prometheus are preconfigured addons on ISTIO. To enable, choose the configuration profile which has Prometheus and Grafana enabled. Eg: Demo profile</p>
</div>
<div class="paragraph">
<p>Verify Prometheus and Grafana running in the cluster.</p>
</div>
<div class="paragraph">
<p><code>kubectl get pods -n istio-system</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kiali_dashboard"><a class="anchor" href="#_kiali_dashboard"></a>Kiali dashboard</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Kiali dashboard helps you understand the structure of your service mesh by displaying the topology. The demo profile enables Kiali dashboard also.</p>
</div>
<div class="paragraph">
<p>Access the Kiali dashboard. The default user name is admin and default password is admin.</p>
</div>
<div class="paragraph">
<p><code>istioctl dashboard kiali</code></p>
</div>
<div class="paragraph">
<p>You may refer <a href="https://istio.io/latest/docs/concepts/observability">ISTIO Observability</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_minikube_troubleshooting_tips"><a class="anchor" href="#_minikube_troubleshooting_tips"></a>Minikube Troubleshooting Tips</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This documentation provides the troubleshooting tips while working with minikube in a local machine.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Always start minikube with a minimum of 4GB of memory or more if available. Using command <code>minikube start --memory=4096</code></p>
</li>
<li>
<p>If minikube is not starting or throwing any error even after multiple attempts. Try the below tips:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Delete the minikube in your local machine using <code>minikube delete</code> and do a fresh minikube start.</p>
</li>
<li>
<p>In any case, if minikube is not starting even after the above step, go to .minikube folder under the users directory and delete it manually. Now try starting minikube.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Set docker environment in minikube using <code>minikube docker-env</code>. Now all the docker commands that are run will be on the docker inside minikube. So building your application after executing the above command will have the application docker images available to minikube.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>To exit minikube docker environment use <code>minikube docker-env -u</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>In any case, if you face any error related to docker image such as <code>Failed to pull image</code>, or <code>image not found</code> errors we will have to manually push the application docker image to minikube docker cache using the below commands.</p>
</li>
<li>
<p>For better results - stop minikube using <code>minikube stop</code> command.</p>
</li>
<li>
<p>Execute the command <code>minikube cache add imageName/tagName</code>.</p>
</li>
<li>
<p>Now start the minikube. To verify if the docker image has been added to minikube docker execute <code>minikube ssh docker images</code>.</p>
</li>
<li>
<p>To remove any docker image from minikube docker stop any containers running that docker image and then execute <code>minikube cache delete imageName/tagName</code>.</p>
</li>
<li>
<p>To reload any docker image to minikube docker environment, execute <code>minikube cache reload</code>.</p>
</li>
<li>
<p>In any case, if the docker images are not getting removed from minikube docker environment then navigate to .minikube/cache/images and then delete the particular image.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Execute the below command to make the Grafana available.</p>
</div>
<div class="paragraph">
<p><code>kubectl -n istio-system port-forward $(kubectl -n istio-system get pod -l app=grafana -o jsonpath='\{.items[0].metadata.name}') 3000:3000 &amp;</code></p>
</div>
<div class="paragraph">
<p>Use the below URLs to view the dashboard in local machine.</p>
</div>
<div class="paragraph">
<p><a href="http://localhost:3000/dashboard/db/istio-mesh-dashboard" class="bare">http://localhost:3000/dashboard/db/istio-mesh-dashboard</a></p>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
