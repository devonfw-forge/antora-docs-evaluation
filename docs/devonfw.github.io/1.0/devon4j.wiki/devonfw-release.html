<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Devonfw.github.io Docs</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">Devonfw.github.io Docs</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="devonfw.github.io" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-explore is-active" data-panel="explore">
  <div class="context">
    <span class="title">devonfw.github.io</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../architecture-guidelines/1.0/index.html">Architecture-guidelines</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../architecture-guidelines/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../cicdgen/1.0/index.html">Cicdgen</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../cicdgen/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../cobigen/1.0/index.html">Cobigen</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../cobigen/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../dashboard/1.0/index.html">Dashboard</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../dashboard/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4j/1.0/index.html">Devon4j</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4j/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4net/1.0/index.html">Devon4net</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4net/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4ng/1.0/index.html">Devon4ng</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4ng/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4node/1.0/index.html">Devon4node</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4node/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4quarkus/1.0/index.html">Devon4quarkus</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4quarkus/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../devon4ts/1.0/index.html">Devon4ts</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../devon4ts/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">devonfw.github.io</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../getting-started/1.0/index.html">Getting-started</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../getting-started/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../github/1.0/index.html">Github</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../github/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../hangar/1.0/index.html">Hangar</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../hangar/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../ide/1.0/index.html">IDE</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../ide/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../jump-the-queue/1.0/index.html">Jump-the-queue</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../jump-the-queue/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../mrchecker/1.0/index.html">Mrchecker</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../mrchecker/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../my-thai-star/1.0/index.html">My-thai-star</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../my-thai-star/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../production-line/1.0/index.html">Production-line</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../production-line/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../shop-floor/1.0/index.html">Shop-floor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../shop-floor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../solicitor/1.0/index.html">Solicitor</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../solicitor/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../sonar-devon4j-plugin/1.0/index.html">Sonar-devon4j-plugin</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../sonar-devon4j-plugin/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/marvdan/devonfw.github.io/edit/developAntoraGhPage/docs/modules/ROOT/pages/devon4j.wiki/devonfw-release.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_releasing_the_code">Releasing the code</a>
<ul class="sectlevel2">
<li><a href="#_configure_ossrh">Configure OSSRH</a></li>
<li><a href="#_configure_pgp">Configure PGP</a></li>
<li><a href="#_deploy_to_ossrh">Deploy to OSSRH</a></li>
</ul>
</li>
<li><a href="#_releasing_the_maven_site">Releasing the maven-site</a></li>
<li><a href="#_finalize_the_release">Finalize the Release</a></li>
</ul>
</div>
<div class="paragraph">
<p>==Creating a Release</p>
</div>
<div class="paragraph">
<p>This page documents how to create and publish a release of devon4j.</p>
</div>
<div class="paragraph">
<p>For each release there is a <a href="https://github.com/devonfw/devon4j/milestones">milestone</a> that contains an issue for creating the release itself (the github issue of that issue is referred as <code>«issue»</code>). The release version is referred as «x.y.z».</p>
</div>
<div class="sect1">
<h2 id="_releasing_the_code"><a class="anchor" href="#_releasing_the_code"></a>Releasing the code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To release the code follow these steps.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a clean clone of the repository:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git clone https://github.com/devonfw/devon4j.git</code></pre>
</div>
</div>
</li>
<li>
<p>In case you want to build a (bug fix) release from a different branch, switch to that branch:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout -b develop-«x.y» origin/develop-«x.y»</code></pre>
</div>
</div>
</li>
<li>
<p>Ensure your branch is up-to-date:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git pull</code></pre>
</div>
</div>
</li>
<li>
<p>Ensure that the result is what you want to release (<code>mvn clean install</code>).</p>
</li>
<li>
<p>Bump the release version by removing the <code>-SNAPSHOT</code> from <code>devon4j.version</code> property in top-level <code>pom.xml</code>.</p>
</li>
<li>
<p>Create an annotated tag for your release:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git tag -a release/x.y.z -m "#«issue»: tagged x.y.z"</code></pre>
</div>
</div>
<div class="paragraph">
<p>e.g For release 2.5.0 the command would look like</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git tag -a release/2.5.0 -m "#618: tagged 2.5.0"</code></pre>
</div>
</div>
<div class="paragraph">
<p>where #618 is the issue number created for release itself under release milestone.
You can confirm if the tag is created by listing out the tags with the following command</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>git tag</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_configure_ossrh"><a class="anchor" href="#_configure_ossrh"></a>Configure OSSRH</h3>
<div class="paragraph">
<p>For publishing artifacts to OSSRH, we need an OSSRH account with necessary rights for publishing and managing staging repositories. And configure this account in devonfw distribution to create connection and deploy to OSSRH.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you do not already have an account on OSSRH, create an account on the link below
<a href="https://issues.sonatype.org/secure/Signup!default.jspa" class="bare">https://issues.sonatype.org/secure/Signup!default.jspa</a></p>
</li>
<li>
<p>You need manager access to deploy artifacts to OSSRH. For same contact devonfw administrators for OSSRH.</p>
</li>
<li>
<p>Open file <code>conf/.m2/setting.xml</code> in your devon distribution (devon-ide) and add a new server with following details</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;server&gt;
   &lt;id&gt;ossrh&lt;/id&gt;
   &lt;username&gt;«ossrh_username»&lt;/username&gt;
   &lt;password&gt;«ossrh_password»&lt;/password&gt;
&lt;/server&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here <code>«ossrh_username»</code> and <code>«ossrh_password»</code> are the account details used to login into OSSRH and should have rights to publish artifacts to OSSRH for <code>groupId</code> name <code>com.devonfw</code> (and its children).
Please use <a href="http://maven.apache.org/guides/mini/guide-encryption.html">password encryption</a> and prevent
storing passwords in plain text.
The id <code>ossrh</code> points to the OSSRH repository for snaphost and release declared in the  <code>&lt;distributionManagement&gt;</code> section of the <code>devon4j/pom.xml</code>.</p>
</div>
</li>
<li>
<p>Optionally you may want to explicitly define PGP key via the associated email-address:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;profile&gt;
  &lt;id&gt;devon.ossrh&lt;/id&gt;
  &lt;activation&gt;
    &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;
  &lt;/activation&gt;
  &lt;properties&gt;
    &lt;gpg.keyname&gt;your.email@address.com&lt;/gpg.keyname&gt;
  &lt;/properties&gt;
&lt;/profile&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_configure_pgp"><a class="anchor" href="#_configure_pgp"></a>Configure PGP</h3>
<div class="paragraph">
<p>Artifacts should be PGP signed before they can be deployed to OSSRH. Artifacts can be signed either by using command line tool GnuPG or GUI based tool Gpg4win Kleopetra (preferred). Follow the steps below to sign artifacts using either of the two tools.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Download tools
GnuPg - <a href="https://www.gnupg.org/download/" class="bare">https://www.gnupg.org/download/</a>
gpg4win - <a href="https://www.gpg4win.org/download.html" class="bare">https://www.gpg4win.org/download.html</a></p>
</li>
<li>
<p>Installation
Installation is self explanatory for GnuPG and gpg4win. To verify installation of GnuPg, open windows command line and run "gpg --version or gpg2 --version"</p>
</li>
<li>
<p>Generate PGP key pair for signing artifacts.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Remember the passphrase set for PGP keys as it will be used later for authentication during signing of artifacts by maven.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Using GnuPg follow either of the link below</p>
</div>
<div class="paragraph">
<p><a href="http://central.sonatype.org/pages/working-with-pgp-signatures.html#generating-a-key-pair" class="bare">http://central.sonatype.org/pages/working-with-pgp-signatures.html#generating-a-key-pair</a></p>
</div>
<div class="paragraph">
<p><a href="https://www.youtube.com/watch?v=DE3FVty3NgE&amp;feature=youtu.be" class="bare">https://www.youtube.com/watch?v=DE3FVty3NgE&amp;feature=youtu.be</a></p>
</div>
<div class="paragraph">
<p>Using Kleopetra follow link below</p>
</div>
<div class="paragraph">
<p><a href="https://www.deepdotweb.com/2015/02/21/pgp-tutorial-for-windows-kleopatra-gpg4win/" class="bare">https://www.deepdotweb.com/2015/02/21/pgp-tutorial-for-windows-kleopatra-gpg4win/</a></p>
</div>
<div class="paragraph">
<p>Exporting PGP key to public key-server</p>
</div>
<div class="paragraph">
<p>Using GnuPg - <a href="http://central.sonatype.org/pages/working-with-pgp-signatures.html#distributing-your-public-key" class="bare">http://central.sonatype.org/pages/working-with-pgp-signatures.html#distributing-your-public-key</a></p>
</div>
<div class="paragraph">
<p>Using Kleopetra, click on the certificate entry you want to publish to OpenPGP certificate servers and select File &gt; Publish on Server as shown below. These instructions are as per Kleopatra 3.0.1-gpg4win-3.0.2, for latest versions there might be some variation.</p>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/release/pgp_key_publish.png"><img src="../_images/images/release/pgp_key_publish.png" alt="pgp key publish" width="450"></a>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deploy_to_ossrh"><a class="anchor" href="#_deploy_to_ossrh"></a>Deploy to OSSRH</h3>
<div class="ulist">
<ul>
<li>
<p>Go to the root of devon4j project and run following command. Make sure there are no spaces between comma separated profiles.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn clean deploy -P deploy</code></pre>
</div>
</div>
</li>
<li>
<p>A pop will appear asking for passphrase for PGP key. Enter the passphrase and press "OK".</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/release/pgpkey_passphrase.png"><img src="../_images/images/release/pgpkey_passphrase.png" alt="pgpkey passphrase" width="950"></a>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you face the error below, contact one of the people who have access to the repository for access rights.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<a class="image" href="images/release/ossrh_publish_error_forbidden.png"><img src="../_images/images/release/ossrh_publish_error_forbidden.png" alt="ossrh publish error forbidden" width="950"></a>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Open <a href="https://oss.sonatype.org/">OSSRH</a>, login and open staging repositories.</p>
</li>
<li>
<p>Find your deployment repository as <code>comdevonfw-NNNN</code> and check its <code>Content</code>.</p>
</li>
<li>
<p>Then click on <code>Close</code> to close the repository and wait a minute.</p>
</li>
<li>
<p>Refresh the repository and copy the URL.</p>
</li>
<li>
<p>Create a vote for the release and paste the URL of the staging repository.</p>
</li>
<li>
<p>After the vote has passed with success go back to OSSRH and and click on <code>Release</code> to publish the release and stage to maven central.</p>
</li>
<li>
<p>Edit the top-level <code>pom.xml</code> and change <code>devon4j.version</code> property to the next planned release version including the <code>-SNAPSHOT</code> suffix.</p>
</li>
<li>
<p>Commit and push the changes:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git commit -m "#«issue»: open next snapshot version"
git push</code></pre>
</div>
</div>
</li>
<li>
<p>In case you build the release from a branch other that <code>develop</code> ensure to follow the next steps. Otherwise you are done here and can continue to the next section. To merge the changes (bug fixes) onto develop do:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git checkout develop
git merge develop-«x.y»</code></pre>
</div>
</div>
</li>
<li>
<p>You most probably will have a conflict in the top-level <code>pom.xml</code>. Then resolve this conflict. In any case edit this <code>pom.xml</code> and ensure that it is still pointing to the latest planned <code>SNAPSHOT</code> for the <code>develop</code> branch.</p>
</li>
<li>
<p>If there are local changes to the top-level <code>pom.xml</code>, commit them:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git commit -m "#«issue»: open next snapshot version"</code></pre>
</div>
</div>
</li>
<li>
<p>Push the changes of your <code>develop</code> branch:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git push</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_releasing_the_maven_site"><a class="anchor" href="#_releasing_the_maven_site"></a>Releasing the maven-site</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Create a new folder for your version in your checkout of <a href="https://github.com/devonfw/devonfw.github.io/tree/master/devon4j">devonfw.github.io/devon4j</a> (as <code>«x.y.z»</code>).</p>
</li>
<li>
<p>Copy the just generated <code>devon4j-doc.pdf</code> into the new release version folder.</p>
</li>
<li>
<p>Copy the <code>index.html</code> from the previous release to the new release version folder.</p>
</li>
<li>
<p>Edit the new copy of <code>index.html</code> and replace all occurrences of the version to the new release as well as the release date.</p>
</li>
<li>
<p>Generate the maven site from the <code>devon4j</code> release checkout (see <a href="#releasing-the-core">code release</a>):</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn site
mvn site:deploy</code></pre>
</div>
</div>
</li>
<li>
<p>Review that the maven site is intact and copy it to the new release version folder (from <code>devon4j/target/devon4j/maven</code> to <code>devonfw.github.io/devon4j/«x.y.z»/maven</code>).</p>
</li>
<li>
<p>Update the link in the <code>devon4j/index.html</code> to the latest stable documentation.</p>
</li>
<li>
<p>Add, commit and push the new release version folder.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">git add «x.y.z»
git commit -m "devonfw/devon4j#«issue»: released documentation"
git push</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_finalize_the_release"><a class="anchor" href="#_finalize_the_release"></a>Finalize the Release</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Close the issue of the release.</p>
</li>
<li>
<p>Close the milestone of the release (if necessary correct the release date).</p>
</li>
<li>
<p>Ensure that the new release is available in maven central.</p>
</li>
<li>
<p>Write an announcement for the new release.</p>
</li>
</ul>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
